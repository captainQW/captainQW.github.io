{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"about/","text":"\u5173\u6ce8\u4e92\u8054\u7f51,\u7528\u6237\u4f53\u9a8c,\u8ffd\u6c42\u7f16\u7a0b\u4e4b\u7f8e\uff0cless write, do more\u3002 \u559c\u6b22Drupal,Wordpress,Python,JavaScript,Linux\u3002 \u51fa\u6ca1\u5730 \u00b6 Blog\uff1a http://verynull.com OsChina: http://my.oschina.net/aboutblankchina GitHub: https://github.com/RamboLau Drupal: https://drupal.org/user/1981814","title":"\u5173\u4e8e\u6211"},{"location":"about/#_1","text":"Blog\uff1a http://verynull.com OsChina: http://my.oschina.net/aboutblankchina GitHub: https://github.com/RamboLau Drupal: https://drupal.org/user/1981814","title":"\u51fa\u6ca1\u5730"},{"location":"book/","text":"\u6280\u672f\u7c7b \u00b6 \u4e00\u3001C\u8bed\u8a00 \u00b6 1\u3001C\u548c\u6307\u9488 POINTERS ON C http://book.douban.com/subject/3012360/ 2\u3001C\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 http://book.douban.com/subject/1882483/ \u4e8c\u3001linux/unix \u00b6 1\u3001UNIX\u73af\u5883\u9ad8\u7ea7\u7f16\u7a0b\uff08\u7b2c3\u7248\uff09 http://book.douban.com/subject/25900403/ \u4e09\u3001javascript \u00b6 1\u3001XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u5256\u6790\u4e0e\u9632\u5fa1 http://book.douban.com/subject/25711796/ 2\u3001JavaScript\u6743\u5a01\u6307\u5357(\u7b2c6\u7248) http://book.douban.com/subject/10549733/ \u56db\u3001\u5176\u4ed6 \u00b6 1\u3001\u4f18\u8d28\u4ee3\u7801 http://book.douban.com/subject/26301904/ 2\u3001\u7f16\u7a0b\u73e0\u7391 http://book.douban.com/subject/3227098/ \u6587\u53f2\u7c7b \u00b6 1\u3001\u6218\u5929\u4eac http://book.douban.com/subject/1027725/ 2\u3001\u7518\u5357\u8bb0\u4e8b https://book.douban.com/subject/6840152/ 3\u3001\u5939\u8fb9\u6c9f\u8bb0\u4e8b http://book.douban.com/subject/1064223/ 4\u3001\u5b9a\u897f\u5b64\u513f\u9662 http://baike.baidu.com/view/1390137.htm","title":"\u8bfb\u4e66"},{"location":"book/#_1","text":"","title":"\u6280\u672f\u7c7b"},{"location":"book/#c","text":"1\u3001C\u548c\u6307\u9488 POINTERS ON C http://book.douban.com/subject/3012360/ 2\u3001C\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 http://book.douban.com/subject/1882483/","title":"\u4e00\u3001C\u8bed\u8a00"},{"location":"book/#linuxunix","text":"1\u3001UNIX\u73af\u5883\u9ad8\u7ea7\u7f16\u7a0b\uff08\u7b2c3\u7248\uff09 http://book.douban.com/subject/25900403/","title":"\u4e8c\u3001linux/unix"},{"location":"book/#javascript","text":"1\u3001XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u5256\u6790\u4e0e\u9632\u5fa1 http://book.douban.com/subject/25711796/ 2\u3001JavaScript\u6743\u5a01\u6307\u5357(\u7b2c6\u7248) http://book.douban.com/subject/10549733/","title":"\u4e09\u3001javascript"},{"location":"book/#_2","text":"1\u3001\u4f18\u8d28\u4ee3\u7801 http://book.douban.com/subject/26301904/ 2\u3001\u7f16\u7a0b\u73e0\u7391 http://book.douban.com/subject/3227098/","title":"\u56db\u3001\u5176\u4ed6"},{"location":"book/#_3","text":"1\u3001\u6218\u5929\u4eac http://book.douban.com/subject/1027725/ 2\u3001\u7518\u5357\u8bb0\u4e8b https://book.douban.com/subject/6840152/ 3\u3001\u5939\u8fb9\u6c9f\u8bb0\u4e8b http://book.douban.com/subject/1064223/ 4\u3001\u5b9a\u897f\u5b64\u513f\u9662 http://baike.baidu.com/view/1390137.htm","title":"\u6587\u53f2\u7c7b"},{"location":"drupal/Drupal-apc%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E7%AD%96%E7%95%A5/","tags":"[apc]","text":"\u4eca\u5929\u53d1\u73b0\u5728\u5982\u679c\u5f00\u8d77\u6765 apc\u7f13\u5b58\u3002\u5e76\u5f00\u542f\u7f13\u5b58\u9875\u9762\uff08\u4e0d\u4ece\u6570\u636e\u5e93\u62ff\uff09,\u533f\u540d\u7528\u6237\u4f1a\u8fd4\u56de500\u3002\u3002\u3002\u3002 \u914d\u7f6e\u4ee3\u7801\u5982\u4e0b\uff1a $conf['page_cache_without_database'] = TRUE; \u901a\u8fc7\u8ffd\u8e2a\u4ee3\u7801\uff0c\u53d1\u73b0drupal\u9488\u5bf9\u533f\u540d\u7528\u6237\u5e76\u6ca1\u6709\u8bbe\u7f6e\u7f13\u5b58\u3002\u90a3\u7528apc\u7f13\u5b58\u4e86\u5f53\u7136\u4f1a\u6709\u95ee\u9898\uff0c\u4fee\u6539\u4ee3\u7801\u5982\u4e0b\uff1a if (1) { $conf['cache_backends'] = array('sites/all/modules/apc/drupal_apc_cache.inc'); if (1) { // Use APC by default (cache everything.) $conf['cache_default_class'] = 'DrupalAPCCache'; if (1) { // Page cache without database and module hooks (approx twice as fast.) $conf['page_cache_invoke_hooks'] = FALSE; $conf['page_cache_without_database'] = TRUE; } } else { // Use APC for \"cache\" and \"bootstrap\" only. $conf['cache_class_cache'] = 'DrupalAPCCache'; $conf['cache_class_cache_bootstrap'] = 'DrupalAPCCache'; } } \u95ee\u9898\u89e3\u51b3.","title":"Drupal apc\u7f13\u5b58\u914d\u7f6e\u7b56\u7565"},{"location":"drupal/Drupal-code-review/","tags":"[code_review]","text":"\u5982\u4f55\u4f60\u7684\u6a21\u5757\u5df2\u7ecf\u5728\u7ebf\u4e0a\uff0c\u6bd4\u5982github\u6216\u8005Drupal\u7684git\u4ed3\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u7684 pareview.sh \u5de5\u5177\u3002 1\u3001\u5b89\u88c5composer \u00b6 $ curl -sS https://getcomposer.org/installer | php $ mv composer.phar /usr/local/bin/composer 2\u3001\u5b89\u88c5Coder (reference: https://www.drupal.org/node/1419988#coder-composer ) \u00b6 $ composer global require drupal/coder $ sudo ln -s ~/.composer/vendor/bin/phpcs /usr/local/bin $ sudo ln -s ~/.composer/vendor/bin/phpcbf /usr/local/bin $ phpcs --config-set installed_paths ~/.composer/vendor/drupal/coder/coder_sniffer 3\u3001\u5b89\u88c5codespell (reference: https://github.com/lucasdemarchi/codespell ) \u00b6 $ sudo apt-get help2man -y $ cd /usr/local/src $ git clone https://github.com/lucasdemarchi/codespell.git $ cd codespell && sudo make install $ sudo cp codespell /usr/local/bin \u6ce8\uff1aMAC\u4e0b\u5b89\u88c5codespell sudo python setup.py install 4\u3001\u5b89\u88c5DrupalSecure (reference: https://www.drupal.org/sandbox/coltrane/1921926 ) \u00b6 $ sudo apt-get update && sudo apt-get install php-pear $ sudo pear install PHP_CodeSniffer $ cd $( pear config-get php_dir ) /PHP/CodeSniffer/Standards/ $ git clone git://git.drupal.org/sandbox/coltrane/1921926.git secure_cs $ sudo ln -sv ./secure_cs/DrupalSecure ./DrupalSecure \u6ce8\uff1aMAC\u4e0b\u5b89\u88c5php-pear wget http://pear.php.net/go-pear.phar php go-pear.phar 5\u3001\u5b89\u88c5ESLint \u00b6 $ sudo npm install -g eslint \u5728Ubuntu precise \uff0812.04\uff09, \u4f60\u6709\u53ef\u80fd\u4f1a\u9047\u5230\u4ee5\u4e0b\u9519\u8bef\uff1a npm http GET https://registry.npmjs.org/ npm ERR! Error: failed to fetch from registry: This is because the version supplied by Ubuntu 12 .04 is no longer supported, updating node ( and npm with it ) resolved the issue. \u9996\u5148, \u5378\u8f7dnodejs\u7248\u672c sudo apt-get purge nodejs npm \u542f\u7528nodesource's\u4ed3\u5e93\u5e76\u8fdb\u884c\u5b89\u88c5: curl -sL https://deb.nodesource.com/setup | sudo bash - sudo apt-get install -y nodejs $ sudo apt-get install nodejs $ eslint --init # run for the first time 6\u3001\u5b89\u88c5pareviewsh \u00b6 $ cd /usr/local/src $ sudo wget http://ftp.drupal.org/files/projects/pareviewsh-7.x-1.7.tar.gz $ sudo tar xzf pareviewsh-7.x-1.7.tar.gz $ sudo ln -s /usr/local/src/pareviewsh/pareview.sh /usr/local/bin/pareviewsh \u67e5\u770bpareview\u662f\u5426\u5df2\u7ecf\u5b89\u88c5\u6210\u529f $ pareviewsh /path/to/module or /path/to/git-repos.git phpcs\u81ea\u52a8\u4fee\u590d\u4ee3\u7801\u6807\u51c6 phpcbf --standard = Drupal --extensions = php,module,inc,install,test,profile,theme,js,css,info,txt,md /file/to/drupal/example_module \u5728~/.bash_profile\u4e2d\u6dfb\u52a0\u522b\u540d // Check Drupal coding standards alias drupalcs = \"phpcs --standard=Drupal --extensions='php,module,inc,install,test,profile,theme,js,css,info,txt,md'\" // Check Drupal best practices alias drupalpractice = \"phpcs --standard=DrupalPractice --extensions='php,module,inc,install,test,profile,theme,js,css,info,txt,md'\" // Automatically fix coding standards alias drupalcbf = \"phpcbf --standard=Drupal --extensions='php,module,inc,install,test,profile,theme,js,css,info,txt,md'\" \u53c2\u7167\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/1587138 2\u3001 https://www.drupal.org/node/1419988 3\u3001 https://www.drupal.org/node/172169 4\u3001 https://www.drupal.org/project/pareviewsh 5\u3001 https://www.drupal.org/project/coder","title":"\"Drupal code review\""},{"location":"drupal/Drupal-code-review/#1composer","text":"$ curl -sS https://getcomposer.org/installer | php $ mv composer.phar /usr/local/bin/composer","title":"1\u3001\u5b89\u88c5composer"},{"location":"drupal/Drupal-code-review/#2coder-reference-httpswwwdrupalorgnode1419988coder-composer","text":"$ composer global require drupal/coder $ sudo ln -s ~/.composer/vendor/bin/phpcs /usr/local/bin $ sudo ln -s ~/.composer/vendor/bin/phpcbf /usr/local/bin $ phpcs --config-set installed_paths ~/.composer/vendor/drupal/coder/coder_sniffer","title":"2\u3001\u5b89\u88c5Coder (reference: https://www.drupal.org/node/1419988#coder-composer)"},{"location":"drupal/Drupal-code-review/#3codespell-reference-httpsgithubcomlucasdemarchicodespell","text":"$ sudo apt-get help2man -y $ cd /usr/local/src $ git clone https://github.com/lucasdemarchi/codespell.git $ cd codespell && sudo make install $ sudo cp codespell /usr/local/bin \u6ce8\uff1aMAC\u4e0b\u5b89\u88c5codespell sudo python setup.py install","title":"3\u3001\u5b89\u88c5codespell (reference: https://github.com/lucasdemarchi/codespell)"},{"location":"drupal/Drupal-code-review/#4drupalsecure-reference-httpswwwdrupalorgsandboxcoltrane1921926","text":"$ sudo apt-get update && sudo apt-get install php-pear $ sudo pear install PHP_CodeSniffer $ cd $( pear config-get php_dir ) /PHP/CodeSniffer/Standards/ $ git clone git://git.drupal.org/sandbox/coltrane/1921926.git secure_cs $ sudo ln -sv ./secure_cs/DrupalSecure ./DrupalSecure \u6ce8\uff1aMAC\u4e0b\u5b89\u88c5php-pear wget http://pear.php.net/go-pear.phar php go-pear.phar","title":"4\u3001\u5b89\u88c5DrupalSecure (reference: https://www.drupal.org/sandbox/coltrane/1921926)"},{"location":"drupal/Drupal-code-review/#5eslint","text":"$ sudo npm install -g eslint \u5728Ubuntu precise \uff0812.04\uff09, \u4f60\u6709\u53ef\u80fd\u4f1a\u9047\u5230\u4ee5\u4e0b\u9519\u8bef\uff1a npm http GET https://registry.npmjs.org/ npm ERR! Error: failed to fetch from registry: This is because the version supplied by Ubuntu 12 .04 is no longer supported, updating node ( and npm with it ) resolved the issue. \u9996\u5148, \u5378\u8f7dnodejs\u7248\u672c sudo apt-get purge nodejs npm \u542f\u7528nodesource's\u4ed3\u5e93\u5e76\u8fdb\u884c\u5b89\u88c5: curl -sL https://deb.nodesource.com/setup | sudo bash - sudo apt-get install -y nodejs $ sudo apt-get install nodejs $ eslint --init # run for the first time","title":"5\u3001\u5b89\u88c5ESLint"},{"location":"drupal/Drupal-code-review/#6pareviewsh","text":"$ cd /usr/local/src $ sudo wget http://ftp.drupal.org/files/projects/pareviewsh-7.x-1.7.tar.gz $ sudo tar xzf pareviewsh-7.x-1.7.tar.gz $ sudo ln -s /usr/local/src/pareviewsh/pareview.sh /usr/local/bin/pareviewsh \u67e5\u770bpareview\u662f\u5426\u5df2\u7ecf\u5b89\u88c5\u6210\u529f $ pareviewsh /path/to/module or /path/to/git-repos.git phpcs\u81ea\u52a8\u4fee\u590d\u4ee3\u7801\u6807\u51c6 phpcbf --standard = Drupal --extensions = php,module,inc,install,test,profile,theme,js,css,info,txt,md /file/to/drupal/example_module \u5728~/.bash_profile\u4e2d\u6dfb\u52a0\u522b\u540d // Check Drupal coding standards alias drupalcs = \"phpcs --standard=Drupal --extensions='php,module,inc,install,test,profile,theme,js,css,info,txt,md'\" // Check Drupal best practices alias drupalpractice = \"phpcs --standard=DrupalPractice --extensions='php,module,inc,install,test,profile,theme,js,css,info,txt,md'\" // Automatically fix coding standards alias drupalcbf = \"phpcbf --standard=Drupal --extensions='php,module,inc,install,test,profile,theme,js,css,info,txt,md'\" \u53c2\u7167\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/1587138 2\u3001 https://www.drupal.org/node/1419988 3\u3001 https://www.drupal.org/node/172169 4\u3001 https://www.drupal.org/project/pareviewsh 5\u3001 https://www.drupal.org/project/coder","title":"6\u3001\u5b89\u88c5pareviewsh"},{"location":"drupal/Drupal%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/","tags":"[\u52a8\u9759\u5206\u79bb]","text":"/** * Implements hook_file_url_alter(). */ function modulename_file_url_alter(&$uri) { if ($resource_server = variable_get('static_server', '')) { $resource_extensions = array('css', 'js', 'gif', 'jpg', 'jpeg', 'png'); // Most CDNs don't support private file transfers without a lot of hassle, // so don't support this in the common case. $schemes = array('public'); $scheme = file_uri_scheme($uri); // Only serve shipped files and public created files from the static_server. if (!$scheme || in_array($scheme, $schemes)) { // Shipped files. if (!$scheme) { $path = $uri; } // Public created files. else { $wrapper = file_stream_wrapper_get_instance_by_scheme($scheme); $path = $wrapper->getDirectoryPath() . '/' . file_uri_target($uri); } // Clean up Windows paths. $path = str_replace('\\\\', '/', $path); // Serve files with one of the resource extensions from resource_server $pathinfo = pathinfo($path); if (isset($pathinfo['extension']) && in_array($pathinfo['extension'], $resource_extensions)) { $uri = $resource_server . '/' . $path; } } } }","title":"drupal\u52a8\u9759\u5206\u79bb"},{"location":"drupal/Drupal%E7%9A%84gitignore%E6%96%87%E4%BB%B6/","tags":"[gitignore]","text":"# Ignore configuration files that may contain sensitive information. #sites/*/*settings*.php settings.php default.settings.php *~ *.*~ *.lock *.DS_Store *.swp *.out *.swo # Ignore paths that contain generated content. cache/ files/ sites/*/files sites/*/private files/.htaccess # Ignore default text files .htaccess robots.txt /CHANGELOG.txt /COPYRIGHT.txt /INSTALL*.txt /LICENSE.txt /MAINTAINERS.txt /UPGRADE.txt /README.txt sites/all/README.txt sites/all/modules/README.txt sites/all/themes/README.txt # Ignore everything but the \"sites\" folder ( for non core developer ) web.config authorize.php cron.php index.php install.php update.php xmlrpc.php /includes /misc /modules /profiles /scripts /themes \u628a\u8be5\u6587\u4ef6\u653e\u5728/root/\u76ee\u5f55\u4e0b\u3002\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u8bbe\u7f6e\u5230\u5168\u5c40\u9009\u9879\u91cc\u3002 git config --global core.excludesfile /root/.gitignore","title":"drupal\u7684.gitignore\u6587\u4ef6"},{"location":"drupal/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/","tags":"[drush]","text":"\u5b89\u88c5\u65b9\u6cd5 \u00b6 pear channel-update pear.php.net pear channel-discover pear.drush.org pear install drush/drush \u7528drush help\u5373\u53ef\u67e5\u770b\u76f8\u5173\u547d\u4ee4\u3002 \u7ecf\u5e38\u4f7f\u7528\u7684\u51e0\u4e2a\u547d\u4ee4 \u00b6 drush cc all: \u6e05\u9664\u7f13\u5b58 drush updb: \u66f4\u65b0\u6570\u636e\u5e93. drush up\u6216\u8005 drush pm-update\u66f4\u65b0\u6838\u5fc3\u4ee3\u7801\u6216\u8005\u6a21\u5757. drush up\u7684\u5907\u4efd\u4ee3\u7801\u9ed8\u8ba4\u5728 ~/drush-backups cd ~/drush-backups \u5373\u53ef\u770b\u5230\u539f\u6765\u7684\u4ee3\u7801 \u6253\u5370Drupal\u51fd\u6570 \u00b6 drush ev \"print_r(module_implements('menu'))\" \u6267\u884cphp\u4ee3\u7801 \u00b6 drush php-eval 'print_r(file(\"/xxxx.log\"));'","title":"Drush\u7684\u5b89\u88c5\u914d\u7f6e\u548c\u5e94\u7528"},{"location":"drupal/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/#_1","text":"pear channel-update pear.php.net pear channel-discover pear.drush.org pear install drush/drush \u7528drush help\u5373\u53ef\u67e5\u770b\u76f8\u5173\u547d\u4ee4\u3002","title":"\u5b89\u88c5\u65b9\u6cd5"},{"location":"drupal/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/#_2","text":"drush cc all: \u6e05\u9664\u7f13\u5b58 drush updb: \u66f4\u65b0\u6570\u636e\u5e93. drush up\u6216\u8005 drush pm-update\u66f4\u65b0\u6838\u5fc3\u4ee3\u7801\u6216\u8005\u6a21\u5757. drush up\u7684\u5907\u4efd\u4ee3\u7801\u9ed8\u8ba4\u5728 ~/drush-backups cd ~/drush-backups \u5373\u53ef\u770b\u5230\u539f\u6765\u7684\u4ee3\u7801","title":"\u7ecf\u5e38\u4f7f\u7528\u7684\u51e0\u4e2a\u547d\u4ee4"},{"location":"drupal/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/#drupal","text":"drush ev \"print_r(module_implements('menu'))\"","title":"\u6253\u5370Drupal\u51fd\u6570"},{"location":"drupal/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/#php","text":"drush php-eval 'print_r(file(\"/xxxx.log\"));'","title":"\u6267\u884cphp\u4ee3\u7801"},{"location":"drupal/drupal-error-cannot-call-overloaded-function-for-non-object/","tags":"[drupal]","text":"\u4eca\u5929\u5728\u6d4b\u8bd5API\u7684\u65f6\u5019\uff0capache\u603b\u662f\u4f1a\u83ab\u540d\u5176\u5999\u7684\u62a5 PHP Fatal error: Cannot call overloaded function for non-object in /var/www/html/includes/database/query.inc on line 331 \u627e\u4e86\u5f88\u4e45\u7684\u8d44\u6599\uff0c\u53d1\u73b0\u53ef\u4ee5\u914d\u7f6eapache\u7684CoreDumpDirectory\u547d\u4ee4\uff0c\u5176\u5b9e\u5c31\u662f\u628aapache\u7684\u5185\u6838\u76ee\u5f55\u653e\u5230\u5176\u4ed6\u76ee\u5f55\u4e0b\u3002\u5982/tmp/apache_core\uff0c\u5e76\u7ed9apache_core\u6587\u4ef6\u7ed9\u4e88chown apache:apache /tmp/apache_core\u7684\u6743\u9650\u3002\u8fd9\u6837\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002 \u4f46\u662f\u9700\u8981\u6ce8\u610f\uff1a \u8be5\u547d\u4ee4\u4f1a\u5bfc\u81f4tmp\u6587\u4ef6\u8d8a\u6765\u8d8a\u5927\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u91cc\u8fdb\u884c\u8c03\u8bd5 gdb /usr/bin/httpd /tmp/apache_core/core","title":"Drupal error - Cannot call overloaded function for non-object"},{"location":"drupal/drupal-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9Eip/","tags":"[cdn_real_ip]","text":"\u5982\u679c\u7f51\u7ad9\u8d70CDN\u3002\u5fc5\u987b\u5728settings.php\u8bbe\u7f6e $conf['reverse_proxy'] = TRUE; \u8fd9\u6837\u624d\u53ef\u4ee5\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u7684\u771f\u5b9eIP\u3002","title":"Drupal \u83b7\u53d6\u5ba2\u6237\u7aef\u771f\u5b9eIP"},{"location":"drupal/drupal7/Drupal7-WEB%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/","tags":"[WEB\u6027\u80fd\u4f18\u5316]","text":"\u4e00\u3001DNS prefetch DNS \u4f5c\u4e3a\u4e92\u8054\u7f51\u7684\u57fa\u7840\u534f\u8bae\uff0c\u5176\u89e3\u6790\u7684\u901f\u5ea6\u4f3c\u4e4e\u5bb9\u6613\u88ab\u7f51\u7ad9\u4f18\u5316\u4eba\u5458\u5ffd\u89c6\u3002\u73b0\u5728\u6d4f\u89c8\u5668\u5382\u5546\u5df2\u7ecf\u6709\u5728\u9488\u5bf9 DNS \u8fdb\u884c\u4f18\u5316\uff0c\u5178\u578b\u7684\u4e00\u6b21 DNS \u89e3\u6790\u8017\u8d39 20-120 \u6beb\u79d2\uff0c\u51cf\u5c11 DNS \u89e3\u6790\u6570\u662f\u4e2a\u4f18\u5316\u7684\u65b9\u5f0f\uff0c\u800c\u80fd\u591f\u7f29\u51cf DNS \u89e3\u6790\u7684\u65f6\u95f4\u4e5f\u662f\u6709\u7ecf\u6d4e\u6548\u76ca\u7684\u4e8b\u60c5\u3002\u8fd9\u5c31\u662f\u6d4f\u89c8\u5668\u5382\u5546\u91cd\u89c6 DNS Prefetching \u7684\u4e3b\u8981\u539f\u56e0\u3002DNS Prefetching \u5bf9\u4e8e\u6027\u80fd\u7684\u6536\u76ca\u53ef\u4ee5\u7b80\u5355\u7684\u7528\u201dDNS \u540c\u6b65\u8bf7\u6c42\u5230\u5f02\u6b65\u201d\u6765\u89e3\u91ca\uff0c\u4e5f\u5c31\u662f\u5177\u6709\u6b64\u5c5e\u6027\u7684\u57df\u540d\u4e0d\u9700\u8981\u7528\u6237\u70b9\u51fb\u94fe\u63a5\u5c31\u5728\u540e\u53f0\u89e3\u6790\uff0c\u800c\u57df\u540d\u89e3\u6790\u548c\u5185\u5bb9\u8f7d\u5165\u662f\u4e32\u884c\u7684\u7f51\u7edc\u64cd\u4f5c\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65b9\u5f0f\u80fd\u51cf\u5c11\u7528\u6237\u7684\u7b49\u5f85\u65f6\u95f4\uff0c\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3002 Google Chrome \u5185\u7f6e\u5c31\u6709 DNS Prefetching \u6280\u672f \uff0c\u800c Firefox 3.5 \u4e5f\u5f15\u5165\u4e86\u8fd9\u4e00 \u65b0\u7279\u6027\u3002\u81f3\u4e8e IE\uff0c\u8c8c\u4f3c\u8fd8\u672a\u652f\u6301\u3002 Drupal\u5982\u4f55\u8d77dns prefetch\u5462? \u5148\u4e0a\u4e00\u6bb5\u4ee3\u7801. /** * hook_html_head_alter() */ function themename_html_head_alter(&$header) { // Enable prefetching. $header['dns_prefetch_control'] = array( '#type' => 'html_tag', '#tag' => 'meta', '#attributes' => array('http-equiv' => 'x-dns-prefetch-control', 'content' => 'on'), '#weight' => -10001, ); $dns_prefetch_domains = array( 'www.google.cn', 'www.baidu.com', ); foreach ($dns_prefetch_domains as $key => $value) { $header['dns_prefetch_control_' . $key] = array( '#type' => 'html_tag', '#tag' => 'link', '#attributes' => array('rel' => 'dns-prefetch', 'href' => '//' . drupal_strip_dangerous_protocols(trim($value))), ); } } \u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7684\u8f93\u51fa\uff1a <meta content = \"on\" http-equiv = \"x-dns-prefetch-control\" > <link href = \"//www.google.cn\" rel = \"dns-prefetch\" > <link href = \"//www.baidu.com\" rel = \"dns-prefetch\" > \u4e8c\u3001\u542f\u7528\u538b\u7f29 \u538b\u7f29\u7684\u76ee\u7684\u662f\u8ba9\u4f20\u8f93\u7684\u6570\u636e\u53d8\u5f97\u66f4\u5c0f\u3002\u6211\u4eec\u7684\u7ebf\u4e0a\u4ee3\u7801\uff08JS\u3001CSS \u548c HTML\uff09\u90fd\u4f1a\u505a\u538b\u7f29\uff0c\u56fe\u7247\u4e5f\u4f1a\u505a\u538b\u7f29\uff08PNGOUT\u3001Pngcrush\u3001JpegOptim\u3001Gifsicle \u7b49\uff09\u3002\u5bf9\u4e8e\u6587\u672c\u6587\u4ef6\uff0c\u5728\u670d\u52a1\u7aef\u53d1\u9001\u54cd\u5e94\u4e4b\u524d\u8fdb\u884c GZip \u538b\u7f29\u4e5f\u5f88\u91cd\u8981\uff0c\u901a\u5e38\u538b\u7f29\u540e\u7684\u6587\u672c\u5927\u5c0f\u4f1a\u51cf\u5c0f\u5230\u539f\u6765\u7684 \u00bc - \u2153\u3002\u5bf9\u4ee3\u7801\u8fdb\u884c\u5185\u5bb9\u538b\u7f29\u5df2\u7ecf\u6709\u6210\u719f\u7684\u5de5\u5177\u548c\u6807\u51c6\u6d41\u7a0b\u4e86\uff0c\u800c\u670d\u52a1\u7aef\u7684 GZip \u66f4\u662f\u6807\u914d\uff0c\u6240\u4ee5\u300c\u538b\u7f29\u300d\u662f\u4e00\u9879\u6536\u76ca\u6295\u5165\u6bd4\u5f88\u9ad8\u7684\u4f18\u5316\u624b\u6bb5\u3002 \u4e09\u3001\u4f7f\u7528 HTTP \u7f13\u5b58 \u4efb\u4f55\u4e00\u4e2a WEB \u9879\u76ee\uff0c\u8981\u63d0\u9ad8\u6027\u80fd\uff0c\u5404\u4e2a\u73af\u8282\u7684\u7f13\u5b58\u5fc5\u4e0d\u53ef\u5c11\u3002\u5229\u7528\u597d HTTP \u534f\u8bae\u7684\u7f13\u5b58\u673a\u5236\uff0c\u53ef\u4ee5\u5927\u5e45\u51cf\u5c11\u4f20\u8f93\u6570\u636e\uff0c\u51cf\u5c11\u8bf7\u6c42\uff0c\u8fd9\u53c8\u662f\u4e00\u9879\u6536\u76ca\u6295\u5165\u6bd4\u8d85\u9ad8\u7684\u4f18\u5316\u624b\u6bb5\u3002\u8fd9\u91cc\u628a\u4e4b\u524d\u6211\u5199\u7684 HTTP/1.1 \u7f13\u5b58\u673a\u5236\u4ecb\u7ecd\u7ffb\u51fa\u6765\uff1a \u9996\u5148\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u901a\u8fc7\u54cd\u5e94\u5934\u91cc\u7684 Last-Modified\uff08\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff09 \u6216\u8005 ETag\uff08\u5185\u5bb9\u7279\u5f81\uff09 \u6807\u8bb0\u5b9e\u4f53\u3002\u6d4f\u89c8\u5668\u4f1a\u5b58\u4e0b\u8fd9\u4e9b\u6807\u8bb0\uff0c\u5e76\u5728\u4e0b\u6b21\u8bf7\u6c42\u65f6\u5e26\u4e0a If-Modified-Since: \u4e0a\u6b21 Last-Modified \u7684\u5185\u5bb9 \u6216 If-None-Match: \u4e0a\u6b21 ETag \u7684\u5185\u5bb9\uff0c\u8be2\u95ee\u670d\u52a1\u7aef\u8d44\u6e90\u662f\u5426\u8fc7\u671f\u3002\u5982\u679c\u670d\u52a1\u7aef\u53d1\u73b0\u5e76\u6ca1\u6709\u8fc7\u671f\uff0c\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u72b6\u6001\u7801\u4e3a 304\u3001\u6b63\u6587\u4e3a\u7a7a\u7684\u54cd\u5e94\uff0c\u544a\u77e5\u6d4f\u89c8\u5668\u4f7f\u7528\u672c\u5730\u7f13\u5b58\uff1b\u5982\u679c\u8d44\u6e90\u6709\u66f4\u65b0\uff0c\u670d\u52a1\u7aef\u8fd4\u56de\u72b6\u6001\u7801 200\u3001\u65b0\u7684 Last-Modified\u3001Etag \u548c\u6b63\u6587\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e4b\u4e3a HTTP \u7684\u534f\u5546\u7f13\u5b58\uff0c\u901a\u5e38\u4e5f\u53eb\u505a\u5f31\u7f13\u5b58\u3002 \u53ef\u4ee5\u770b\u5230\u534f\u5546\u7f13\u5b58\u5e76\u4e0d\u4f1a\u8282\u7701\u8fde\u63a5\u6570\uff0c\u4f46\u662f\u5728\u7f13\u5b58\u751f\u6548\u65f6\uff0c\u4f1a\u5927\u5e45\u51cf\u5c0f\u4f20\u8f93\u5185\u5bb9\uff08304 \u54cd\u5e94\u6ca1\u6709\u6b63\u6587\uff0c\u4e00\u822c\u53ea\u6709\u51e0\u767e\u5b57\u8282\uff09\u3002\u53e6\u5916\u4e3a\u4ec0\u4e48\u6709\u4e24\u4e2a\u54cd\u5e94\u5934\u90fd\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u534f\u5546\u7f13\u5b58\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u4e00\u5f00\u59cb\u7528\u7684 Last-Modified \u6709\u4e24\u4e2a\u95ee\u9898\uff1a1\uff09\u53ea\u80fd\u7cbe\u786e\u5230\u79d2\uff0c1 \u79d2\u5185\u7684\u591a\u6b21\u53d8\u5316\u53cd\u6620\u4e0d\u51fa\u6765\uff1b2\uff09\u65f6\u95f4\u91c7\u7528\u7edd\u5bf9\u503c\uff0c\u5982\u679c\u670d\u52a1\u7aef / \u5ba2\u6237\u7aef\u65f6\u95f4\u4e0d\u5bf9\u90fd\u53ef\u80fd\u5bfc\u81f4\u7f13\u5b58\u5931\u6548\u3002HTTP/1.1 \u5e76\u6ca1\u6709\u89c4\u5b9a ETag \u7684\u751f\u6210\u89c4\u5219\uff0c\u800c\u4e00\u822c\u5b9e\u73b0\u8005\u90fd\u662f\u5bf9\u8d44\u6e90\u5185\u5bb9\u505a\u6458\u8981\uff0c\u80fd\u89e3\u51b3\u524d\u9762\u4e24\u4e2a\u95ee\u9898\u3002 \u53e6\u5916\u4e00\u79cd\u7f13\u5b58\u673a\u5236\u662f\u670d\u52a1\u7aef\u901a\u8fc7\u54cd\u5e94\u5934\u544a\u8bc9\u6d4f\u89c8\u5668\uff0c\u5728\u4ec0\u4e48\u65f6\u95f4\u4e4b\u524d\uff08Expires\uff09\u6216\u5728\u591a\u957f\u65f6\u95f4\u4e4b\u5185\uff08Cache-Control: Max-age=xxx\uff09\uff0c\u4e0d\u8981\u518d\u8bf7\u6c42\u670d\u52a1\u5668\u4e86\u3002\u8fd9\u4e2a\u673a\u5236\u6211\u4eec\u901a\u5e38\u79f0\u4e4b\u4e3a HTTP \u7684\u5f3a\u7f13\u5b58\u3002 \u4e00\u65e6\u8d44\u6e90\u547d\u4e2d\u5f3a\u7f13\u5b58\u89c4\u5219\u540e\uff0c\u518d\u6b21\u8bbf\u95ee\u5b8c\u5168\u6ca1\u6709 HTTP \u8bf7\u6c42\uff08Chrome \u5f00\u53d1\u8005\u5de5\u5177\u7684 Network \u9762\u677f\u4f9d\u7136\u4f1a\u663e\u793a\u8bf7\u6c42\uff0c\u4f46\u662f\u4f1a\u6ce8\u660e from cache\uff1bFirefox \u7684 firebug \u4e5f\u7c7b\u4f3c\uff0c\u4f1a\u6ce8\u660e BFCache\uff09\uff0c\u8fd9\u4f1a\u5927\u5e45\u63d0\u5347\u6027\u80fd\u3002\u6240\u4ee5\u6211\u4eec\u4e00\u822c\u4f1a\u5bf9 CSS\u3001JS\u3001\u56fe\u7247\u7b49\u8d44\u6e90\u4f7f\u7528\u5f3a\u7f13\u5b58\uff0c\u800c\u5165\u53e3\u6587\u4ef6\uff08HTML\uff09\u4e00\u822c\u4f7f\u7528\u534f\u5546\u7f13\u5b58\u6216\u4e0d\u7f13\u5b58\uff0c\u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5165\u53e3\u6587\u4ef6\u4e2d\u5bf9\u5f3a\u7f13\u5b58\u8d44\u6e90\u7684\u5f15\u5165 URL \u6765\u8fbe\u5230\u5373\u65f6\u66f4\u65b0\u7684\u76ee\u7684\u3002 \u8fd9\u91cc\u4e5f\u89e3\u91ca\u4e0b\u4e3a\u4ec0\u4e48\u6709\u4e86 Expire\uff0c\u8fd8\u8981\u6709 Cache-Control\u3002\u4e5f\u6709\u4e24\u4e2a\u539f\u56e0\uff1a1\uff09Cache-Control \u529f\u80fd\u66f4\u5f3a\u5927\uff0c\u5bf9\u7f13\u5b58\u7684\u63a7\u5236\u80fd\u529b\u66f4\u5f3a\uff1b2\uff09Cache-Control \u91c7\u7528\u7684 max-age \u662f\u76f8\u5bf9\u65f6\u95f4\uff0c\u4e0d\u53d7\u670d\u52a1\u7aef / \u5ba2\u6237\u7aef\u65f6\u95f4\u4e0d\u5bf9\u7684\u5f71\u54cd\u3002 \u53e6\u5916\u5173\u4e8e\u6d4f\u89c8\u5668\u7684\u5237\u65b0\uff08F5 / cmd + r\uff09\u548c\u5f3a\u5237\uff08Ctrl + F5 / shift + cmd +r\uff09\uff1a\u666e\u901a\u5237\u65b0\u4f1a\u4f7f\u7528\u534f\u5546\u7f13\u5b58\uff0c\u5ffd\u7565\u5f3a\u7f13\u5b58\uff1b\u5f3a\u5237\u4f1a\u5ffd\u7565\u6d4f\u89c8\u5668\u6240\u6709\u7f13\u5b58\uff08\u5e76\u4e14\u8bf7\u6c42\u5934\u4f1a\u643a\u5e26 Cache-Control:no-cache \u548c Pragma:no-cache\uff0c\u7528\u6765\u901a\u77e5\u6240\u6709\u4e2d\u95f4\u8282\u70b9\u5ffd\u7565\u7f13\u5b58\uff09\u3002\u53ea\u6709\u4ece\u5730\u5740\u680f\u6216\u6536\u85cf\u5939\u8f93\u5165\u7f51\u5740\u3001\u70b9\u51fb\u94fe\u63a5\u7b49\u60c5\u51b5\u4e0b\uff0c\u6d4f\u89c8\u5668\u624d\u4f1a\u4f7f\u7528\u5f3a\u7f13\u5b58\u3002 \u56db\u3001\u4f7f\u7528HTTP2 1\u3001HTTP/2 \u7684 Server Push \u673a\u5236\uff0c\u53ef\u4ee5\u8ba9\u91cd\u8981\u7684 JS\u3001CSS \u7b49\u8d44\u6e90\u5c3d\u5feb\u52a0\u8f7d\uff0c\u4ece\u800c\u4e0d\u518d\u9700\u8981 HTTP/1 \u4e2d\u300c\u5c06\u91cd\u8981\u8d44\u6e90\u5185\u8054\u5728\u9875\u9762\u5934\u90e8\u300d\u7684\u4f18\u5316\u65b9\u6848\u4e86\u3002 2\u3001HTTP/2 \u652f\u6301\u4e86\u591a\u8def\u590d\u7528\uff0cHTTP \u8fde\u63a5\u53d8\u5f97\u5341\u5206\u5ec9\u4ef7\uff0c\u4e4b\u524d\u4e3a\u4e86\u8282\u7701\u8fde\u63a5\u6570\u6240\u91c7\u7528\u7684\u7c7b\u4f3c\u4e8e\u300c\u8d44\u6e90\u5408\u5e76\u3001\u8d44\u6e90\u5185\u8054\u300d\u7b49\u4f18\u5316\u624b\u6bb5\u4e0d\u518d\u9700\u8981\u4e86\u3002\u591a\u8def\u590d\u7528\u53ef\u4ee5\u5728\u4e00\u4e2a TCP \u8fde\u63a5\u4e0a\u5efa\u7acb\u5927\u91cf HTTP \u8fde\u63a5\uff0c\u4e5f\u5c31\u4e0d\u5b58\u5728 HTTP \u8fde\u63a5\u6570\u9650\u5236\u4e86\uff0cHTTP/1 \u4e2d\u5e38\u89c1\u7684\u300c\u9759\u6001\u57df\u540d\u300d\u4f18\u5316\u7b56\u7565\u4e0d\u4f46\u7528\u4e0d\u4e0a\u4e86\uff0c\u8fd8\u4f1a\u5e26\u6765\u8d1f\u9762\u5f71\u54cd\uff0c\u9700\u8981\u53bb\u6389\u3002\u53e6\u5916\uff0cHTTP/2 \u7684\u5934\u90e8\u538b\u7f29\u529f\u80fd\u4e5f\u80fd\u5927\u5e45\u51cf\u5c11 HTTP \u534f\u8bae\u5934\u90e8\u5e26\u6765\u7684\u5f00\u9500\u3002 \u4e94\u3001\u4f7f\u7528CDN \u56fd\u5185\u6bd4\u8f83\u597d\u7684CDN\u670d\u52a1\u5546\u5982VeryCloud\u7b49\u3002","title":"\"drupal7 WEB\u6027\u80fd\u4f18\u5316\""},{"location":"drupal/drupal7/Drupal7%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/","tags":"[drupal7\u914d\u7f6e]","text":"\u7531\u4e8e\u7ecf\u5e38\u9700\u8981\u914d\u7f6e\uff0c\u8fd9\u91cc\u4e3b\u8981\u662f\u505a\u4e00\u4e2a\u68b3\u7406\u548c\u6574\u7406\uff0c\u514d\u5f97\u4ee5\u540e\u5fd8\u8bb0 1\u3001\u7f13\u5b58\u8bbe\u7f6e\uff0c\u89c1\u6587\u7ae0 ```php http://176code.com/tags/apc/ ``` 2\u3001\u5982\u679c\u7ad9\u70b9\u542f\u7528\u4e86https\uff0c\u5fc5\u987b\u5728settings.php\u91cc\u505a\u5982\u4e0b\u8bbe\u7f6e\uff0c\u4e0d\u7136\u4f1a\u5bfc\u81f4session\u95ee\u9898 ```php $conf['https'] = TRUE; ``` 3\u3001\u5982\u679c\u9700\u8981\u53bb\u9664\u6240\u6709\u7684\u62a5\u9519\uff0c\u5219\u5728settings.php\u91cc\u505a\u5982\u4e0b\u8bbe\u7f6e ```php $conf['error_level'] = 0; ``` 4\u3001php.ini\u8bbe\u7f6e date.timezone = Asia/Chongqing 5\u3001\u89e3\u51b3\u8de8\u57df\u95ee\u9898,\u5728.htaccess\u91cc\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801 Header set Access-Control-Allow-Origin \"*\"","title":"drupal7\u751f\u4ea7\u73af\u5883\u7684\u4e00\u4e9b\u914d\u7f6e"},{"location":"drupal/drupal7/Drupal7%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E6%97%B6%E5%87%BA%E7%8E%B0%E9%9D%9E%E6%B3%95%E9%80%89%E9%A1%B9%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","tags":"[drupal7\u8868\u5355]","text":"\u6709\u7684\u4f7f\u7528ajax\u64cd\u4f5c\u8868\u5355\u65f6\uff0c\u63d0\u4ea4\u65f6\u4f1a\u51fa\u73b0\u201c\u5728\u8bf7\u9009\u62e9xxx\u5143\u7d20\u4e2d\u7684\u975e\u6cd5\u9009\u98791\u3002(An illegal choice has been detected ajax call!)\u201d\uff0c\u89e3\u51b3\u529e\u6cd5\u5f88\u7b80\u5355\uff0c\u5982\u4e0b form['my_dynamic_select'] = array( \u2026 '#type' => 'select', '#validated' => TRUE, // \u8868\u5355\u5143\u7d20\u6dfb\u52a0\u8be5\u884c\u5373\u53ef\u3002 \u2026 ) \u4e3a\u4ec0\u4e48\u8981\u52a0'#validated' => TRUE\u5462\uff1f \u7531\u4e8e\u6211\u4eec\u4f7f\u7528ajax\u53d6\u5f97\u7684\u503c\uff0c\u9875\u9762\u52a0\u8f7d\u65f6\u5e76\u4e0d\u5b58\u5728\uff0cDrupal\u4f1a\u8ba4\u4e3a\u8fd9\u4e2a\u503c\u65f6\u975e\u6cd5\u7684\u3002\u6240\u4ee5\u6211\u4eec\u8981\u91cd\u7f6e\u8868\u5355\u9a8c\u8bc1\u9879\u6c38\u8fdc\u4e3a\u771f\uff0c\u5373\u53ef\u5b8c\u7f8e\u89e3\u51b3\u6b64\u95ee\u9898\u3002","title":"drupal7\u8868\u5355\u63d0\u4ea4\u65f6\u51fa\u73b0\u975e\u6cd5\u9009\u9879\u89e3\u51b3\u65b9\u6848"},{"location":"drupal/drupal8/Drupal8-Configuration-Schema/","tags":"[configuration schema]","text":"Drupal 8\u4e2dconfiguration schema\u662f\u7528\u6765\u63cf\u8ff0\u914d\u7f6e\u6587\u4ef6\u7684\u7ed3\u6784\u7684. \u5b83\u5e94\u7528\u4e8e: \u5b9a\u578b\u914d\u7f6e\u4ee5\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027 (see StorableConfigBase::castValue()) \u81ea\u52a8\u6301\u4e45\u5316\u5b9e\u4f53\u5c5e\u6027\u7684\u914d\u7f6e (see ConfigEntityBase::toArray()) \u81ea\u52a8\u751f\u6210\u7528\u6237\u754c\u9762\u7684\u7ffb\u8bd1\u914d\u7f6e (see the core module) 1\u3001\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b \u5982\u4e0b: config/install/my_module.settings.yml type: warning message: 'Hello!' langcode: en config/schema/my_module.schema.yml my_module.settings: type: config_object mapping: type: type: string label: 'Message type' message: type: label label: 'Message text' langcode: type: string label: 'Language code' \u9700\u8981\u8bf4\u660e\u7684\u662f\uff0cmy_module.schema.yml\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u7ed3\u6784\u4f53\uff0c\u800cmy_module.settings.yml\u5219\u662f\u7ed9\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e86\u9ed8\u8ba4\u503c\uff0c \u5728my_module.schema.yml\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4f53\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2amapping\u7ed3\u6784\u4f53(\u53ef\u4ee5\u7b80\u5355\u7684\u8ba4\u4e3a\u662f\u4e00\u4e2a\u6570\u7ec4\u7c7b\u578b)\uff0c\u8fd9\u4e2a\u6570\u7ec4\u6709\u4e09\u4e2akey\uff0c\u5206\u522b\u662ftype\u3001message\u3001langcode\uff0c \u524d\u9762\u8bf4\u4e86my_module.settings.yml\u662f\u7ed9my_module.schema.yml\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e86\u9ed8\u8ba4\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728my_module.settings.yml\u4e2dtype\u7684\u9ed8\u8ba4\u503c\u662fwarning,message\u7684\u9ed8\u8ba4\u503c \u662f'Hello!',langcode\u7684\u9ed8\u8ba4\u503c\u662fen,\u503c\u7684\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4e00\u4e2aschema.yml\u6587\u4ef6\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a\u6570\u636e\u7ed3\u6784\u4f53\uff0c\u4f46\u662f\u6bcf\u4e00\u4e2a\u7684\u6570\u636e\u7ed3\u6784\u4f53\u7684root\u5143\u7d20\u5fc5\u987b\u4e0esettings.yml\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u4e00\u81f4\uff0c \u6bd4\u5982\u4e0a\u9762\u7684\u4e24\u4e2a\u6587\u4ef6settings.yml\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u662fmy_module.settings.yml\uff0cmy_module.schema.yml\u7684root\u5143\u7d20\u7684\u540d\u79f0\u5c31\u662fmy_module.settings\u3002 2\u3001schema\u4e2d\u5e38\u7528\u7684\u6570\u636e\u7c7b\u578b \u57fa\u672c\u7c7b\u578b\uff1a boolean\uff0c integer\uff0c float\uff0c string\uff0c uri\uff0c email \u5217\u8868\u7c7b\u578b\uff1a mapping(\u77e5\u9053key\u662f\u4ec0\u4e48)\uff0c sequence(\u4e0d\u77e5\u9053key\u7684\u5177\u4f53\u503c) \u5e38\u89c1\u7684\u5b50\u7c7b\u578b\uff1a label: \u77ed\u6807\u7b7e text: \u957f\u6587\u672c config_object: object\u6839\u5143\u7d20\u7c7b\u578b config_entity: entity\u6839\u5143\u7d20\u7c7b\u578b \u5b50\u7c7b\u578b\u5316 \u6240\u6709configuration schema\u7684\u5b50\u7c7b\u578b\u90fd\u662f\u4ece\u73b0\u6709\u7684\u7c7b\u578b\u6f14\u5316\u800c\u6765. \u65e9\u4e9b\u65f6\u5019\u7684\u7b80\u5355\u793a\u4f8b\u5b50\u7c7b\u578bconfig_object (mapping\u7684\u4e00\u4e2a\u5b50\u7c7b\u578b) \u53ef\u4ee5\u8fdb\u4e00\u6b65\u81ea\u5b9a\u4e49key\u3002 configuration schema\u6839\u8282\u70b9\u7684\u6570\u636e\u7c7b\u578b\u4e00\u822c\u90fd\u662fconfig_object\u6216\u8005config_entity\u3002 3\u3001\u5173\u4e8e\u52a8\u6001\u7c7b\u578b[%parent] \u786e\u5207\u7684\u6570\u636e\u7c7b\u578b\u53ef\u80fd\u4e0d\u4f1a\u77e5\u9053\uff0c\u800c\u4e14\u8fd8\u6709\u7c7b\u578b\u53d6\u51b3\u4e8e\u6570\u636e\u7684\u53ef\u80fd\u6027\uff0cconfiguration schema\u540c\u6837\u652f\u6301\u57fa\u4e8e\u6570\u636e\u7684\u7c7b\u578b\u3002\u5047\u8bbeMessage\u7684\u7c7b\u578b\u53ef\u80fd\u53d6\u51b3\u4e8e\u6570\u636e\u7684\u7c7b\u578b\uff1a\u65e0\u8bbaMessage\u662f\u4e00\u4e2a\u5217\u8868 \u6216\u8005\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8b66\u544a\u3002\u8ba9\u6211\u4eec\u7528 'multiple' \u6765\u5b9a\u4e49\u5217\u8868\u60c5\u51b5,\u7528 'warning' \u6765\u8868\u793a\u4e00\u4e2a\u5355\u884c\u7684\u8b66\u544a\u3002 config/install/my_module.message.single.yml type: warning message: 'Hello!' langcode: en config/install/my_module.message.multiple.yml type: multiple message: -'Hello!' -'Hi!' langcode: en config/schema/my_module.schema.yml my_module.message.*: type: config_object mapping: type: type: string label: 'Message type' message: type: my_module_message.[%parent.type] langcode: type: string label: 'Language code' my_module_message.warning: type: string my_module_message.multiple: type: sequence label: 'Messages' sequence: type: string label: 'Message' \u9996\u5148\u770bmy_module.schema.yml\u8fd9\u4e2a\u6587\u4ef6\uff0c'my_module.message.*'\u7528\u4e86\u901a\u914d\u7b26\u5b9a\u4e49\u7ed3\u6784\u4f53\uff0c\u6240\u4ee5\u5b83\u9002\u7528\u4e8e\u4e00\u7ec4\u914d\u7f6e\u540d\u79f0\u3002\u6240\u4ee5\u6211\u4eec\u770b\u5230\u5206\u522b\u6709my_module.message.single.yml\u8ddfmy_module.message.multiple.yml \u8fd9\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002\u63a5\u7740\u5f80\u4e0b\u770bmy_module.schema.yml\uff0c'type: my_module_message.[%parent.type]' message\u7684\u7c7b\u578b\u7528\u4e86\u52a8\u6001\u5143\u7d20[%parent.type]\u6765\u5b9a\u4e49\uff0c\u6240\u4ee5\u5728\u4e0b\u9762\u6211\u4eec\u770b\u5230\u4e86my_module_message.warning\u8ddf my_module_message.multiple\u4e24\u4e2a\u7c7b\u578b\u5b9a\u4e49\uff0c\u65e0\u8bba\u662fmy_module_message.warning\u8fd8\u662fmy_module_message.multiple\u7684\u524d\u7f00\u90fd\u662f\u8ddfmy_module_message.[%parent.type]\u7684\u524d\u7f00\u4e00\u81f4\u7684\uff0c\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\u5185\u90e8\u8282\u70b9\u7684 \u540d\u79f0\u8981\u907f\u514d\u4e0e\u6839\u8282\u70b9\u76f8\u540c\u4ee5\u514d\u9020\u6210\u51b2\u7a81\u3002 4\u3001\u5173\u4e8e\u52a8\u6001\u7c7b\u578b [type] \u5982\u679c\u60f3\u8981\u5728\u5df2\u6709\u7684\u6570\u636e\u4e0b\u9762\u5b9a\u4e49\u4f60\u81ea\u5df1\u4e0d\u540c\u7684\u6570\u636e\u7c7b\u578b \u90a3\u4e48[type]\u5c06\u4f1a\u53d8\u7684\u975e\u5e38\u6709\u7528. config/install/my_module.message.single.yml message: type: warning value: 'Hello!' langcode: en config/install/my_module.message.multiple.yml message: type: multiple value: -'Hello!' -'Hi!' langcode: en config/schema/my_module.schema.yml my_module.message.*: type: config_object mapping: message: type: my_module_message.[type] [\u2026] my_module_message.warning: type: mapping [\u2026] my_module_message.multiple: type: mapping [\u2026] \u9996\u5148\u770bmy_module.schema.yml\u6587\u4ef6\u7528[type]\u6765\u52a8\u6001\u5b9a\u4e49message\u7684\u7c7b\u578b\uff0c\u6240\u4ee5my_module.schema.yml\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u6211\u4eec\u53c8\u770b\u5230\u4e86my_module_message.warning\u8ddfmy_module_message.multiple\u8fd9\u4e24\u4e2a\u5b9a\u4e49\u7c7b\u578b\uff0c \u9700\u8981\u8bf4\u660e\u7684\u662f\u65e0\u8bba\u662fmy_module_message.warning\u8fd8\u662fmy_module_message.multiple\u5b83\u4eec\u7684\u7c7b\u578b\u90fd\u662fmapping\u7c7b\u578b\uff0c\u90a3\u4e48\u5b83\u4eec\u5bf9\u5e94\u7684\u503c\u4e5f\u5fc5\u987bmapping\u7c7b\u578b\uff0c\u6211\u4eec\u518d\u6765\u770bmy_module.message.single.yml\u8ddf my_module.message.multiple.yml\u4e24\u4e2a\u6587\u4ef6\uff0cmessage\u7684\u503c\u4e5f\u662fmapping\u7c7b\u578b\u3002 \u4f60\u540c\u6837\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5305\u542b\u76f8\u540c\u7684key\uff0c\u4f8b\u5982\u2019type\u2019\u7684 \u57fa\u7840\u7c7b\u578b,\u5e76\u4e14\u7ee7\u627f\u8fd9\u4e2a\u57fa\u7840\u7684\u7c7b\u578b\u4f60\u53ef\u4ee5\u6269\u5c55\u4efb\u4f55\u81ea\u5b9a\u4e49\u7c7b\u578b\u7684key\u3002 5\u3001\u5173\u4e8e\u52a8\u6001\u7c7b\u578b[%key] config/install/my_module.messages.yml messages: 'single:1': 'Hello!' 'single:2': 'Hi!' 'multiple:1': -'Good morning!' -'Good night!' langcode: en \u8fd9\u662f\u4e00\u4e2a\u4efb\u610f\u6d88\u606f\u5143\u7d20\u7684\u5217\u8868. config/schema/my_module.schema.yml my_module.messages: type: config_object mapping: messages: type: sequence label:'Messages' sequence: type: my_module_message.[%key] langcode: type: string label: 'Language code' my_module_message.single:*: type: string label: 'Message' my_module_message.multiple:*: type: sequence label: 'Messages' sequence: type: string label: 'Message' \u9996\u5148\u770bconfig/schema/my_module.schema.yml\uff0cmessages\u7684\u7c7b\u578b\u662fsequence\uff0c\u800csequence\u7684\u7c7b\u578b\u5219\u662f\u4ee5my_module_message\u4e3a\u524d\u7f00\u7684\u52a8\u6001\u7c7b\u578b\uff0c\u518d\u5f80\u4e0b\u770b\u5b9a\u4e49\u4e86my_module_message.single: :\u8ddf my_module_message.multiple: :\u4e24\u4e2a\u7ed3\u6784\u7c7b\u578b\uff0c\u8fd9\u4e24\u4e2a\u7c7b\u578b\u5bf9\u5e94\u7684messages\u503c\u5206\u522b\u662f\u4ee5'single: '\u8ddf'multiple: '\u4e3a\u524d\u7f00\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5728config/install/my_module.messages.yml\u8fd9\u4e2a\u6587\u4ef6\u4e2d \u770b\u5230\u4e86'single: '\u8ddf'multiple: '\u4e3a\u524d\u7f00\u7684\u7684messages\u7684\u9ed8\u8ba4\u503c","title":"drupal8 configuration schema"},{"location":"drupal/drupal8/Drupal8-Content-Entity/","tags":"[entity]","text":"\u8fd9\u7bc7\u6587\u7ae0\u662f Drupal8-configuration-Entity \u7684\u59ca\u59b9\u7bc7\u3002\u4e3b\u8981\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa\u5185\u5bb9\u5b9e\u4f53\uff0c\u5e76\u5728\u754c\u9762\u4e0a\u7ba1\u7406\u3002 content entity\u6700\u5927\u7684\u4f18\u52bf\u5728\u4e8e\u53ef\u81ea\u5b9a\u4e49\u5b57\u6bb5\u3002 \u672c\u6587github\uff1a https://github.com/RamboLau/drupal8-demos/tree/master/content_entity_example \u4e00\u3001\u521b\u5efa\u6a21\u5757 \u00b6 mkdir content_entity_example touch content_entity_example.info.yml \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a name: content_entity_example type: module description: Provides ContentEntityExampleOnlineMessage entity. core: 8 .x package: Other \u4e8c\u3001content_entity_example.routing.yml \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a # OnlineMessage routing definition entity.online_message.canonical: path: '/admin/structure/online_message/{online_message}' defaults: _entity_view: 'online_message' _title: 'Online message' requirements: _entity_access: 'online_message.view' options: _admin_route: TRUE entity.online_message.collection: path: '/admin/structure/online_message' defaults: _entity_list: 'online_message' _title: 'Online message list' requirements: _permission: 'view online message entities' options: _admin_route: TRUE entity.online_message.add_form: path: '/admin/structure/online_message/add' defaults: _entity_form: online_message.add _title: 'Add Online message' requirements: _permission: 'add online message entities' options: _admin_route: TRUE entity.online_message.edit_form: path: '/admin/structure/online_message/{online_message}/edit' defaults: _entity_form: online_message.edit _title: 'Edit Online message' requirements: _permission: 'edit online message entities' options: _admin_route: TRUE entity.online_message.delete_form: path: '/admin/structure/online_message/{online_message}/delete' defaults: _entity_form: online_message.delete _title: 'Delete Online message' requirements: _permission: 'delete online message entities' options: _admin_route: TRUE online_message.settings: path: '/admin/structure/online_message/settings' defaults: _form: '\\Drupal\\content_entity_example\\Form\\OnlineMessageSettingsForm' _title: 'Online message settings' requirements: _permission: 'administer online message entities' options: _admin_route: TRUE \u4e09\u3001content_entity_example.links.menu.yml \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a # Online message menu items definition entity.online_message.collection: title: 'Online message list' route_name: entity.online_message.collection description: 'List Online message entities' parent: system.admin_structure weight: 100 online_message.admin.structure.settings: title: Online message settings description: 'Configure Online message entities' route_name: online_message.settings parent: system.admin_structure \u56db\u3001content_entity_example.links.action.yml \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a entity.online_message.add_form: route_name: entity.online_message.add_form title: 'Add Online message' appears_on: - entity.online_message.collection - entity.online_message.canonical \u4e94\u3001content_entity_example.links.task.yml \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a # Online message routing definition online_message.settings_tab: route_name: online_message.settings title: 'Settings' base_route: online_message.settings entity.online_message.canonical: route_name: entity.online_message.canonical base_route: entity.online_message.canonical title: 'View' entity.online_message.edit_form: route_name: entity.online_message.edit_form base_route: entity.online_message.canonical title: Edit entity.online_message.delete_form: route_name: entity.online_message.delete_form base_route: entity.online_message.canonical title: Delete weight: 10 \u516d\u3001Entity\u7c7b \u00b6 1\u3001src/OnlineMessageInterface.php \u00b6 \u6ce8\uff1a\u901a\u8fc7EntityOwnerInterface\u63a5\u53e3\u53ef\u83b7\u53d6\u5176\u4ed6\u7684\u4e00\u4e9b\u51fd\u6570\uff0c\u5982 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\OnlineMessageInterface. */ namespace Drupal\\content_entity_example ; use Drupal\\Core\\Entity\\ContentEntityInterface ; use Drupal\\Core\\Entity\\EntityChangedInterface ; use Drupal\\Core\\Entity\\EntityTypeInterface ; use Drupal\\user\\EntityOwnerInterface ; /** * Provides an interface for defining Online message entities. * * @ingroup content_entity_example */ interface OnlineMessageInterface extends ContentEntityInterface , EntityChangedInterface , EntityOwnerInterface { // Add get/set methods for your configuration properties here. /** * Gets the Online message name. * * @return string * Name of the Online message. */ public function getName (); /** * Sets the Online message name. * * @param string $name * The Online message name. * * @return \\Drupal\\content_entity_example\\OnlineMessageInterface * The called Online message entity. */ public function setName ( $name ); /** * Gets the Online message creation timestamp. * * @return int * Creation timestamp of the Online message. */ public function getCreatedTime (); /** * Sets the Online message creation timestamp. * * @param int $timestamp * The Online message creation timestamp. * * @return \\Drupal\\content_entity_example\\OnlineMessageInterface * The called Online message entity. */ public function setCreatedTime ( $timestamp ); /** * Returns the Online message published status indicator. * * Unpublished Online message are only visible to restricted users. * * @return bool * TRUE if the Online message is published. */ public function isPublished (); /** * Sets the published status of a Online message. * * @param bool $published * TRUE to set this Online message to published, FALSE to set it to unpublished. * * @return \\Drupal\\content_entity_example\\OnlineMessageInterface * The called Online message entity. */ public function setPublished ( $published ); } ?> 2\u3001src/Entity/OnlineMessage.php \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Entity\\OnlineMessage. */ namespace Drupal\\content_entity_example\\Entity ; use Drupal\\Core\\Entity\\EntityStorageInterface ; use Drupal\\Core\\Field\\BaseFieldDefinition ; use Drupal\\Core\\Entity\\ContentEntityBase ; use Drupal\\Core\\Entity\\EntityChangedTrait ; use Drupal\\Core\\Entity\\EntityTypeInterface ; use Drupal\\content_entity_example\\OnlineMessageInterface ; use Drupal\\user\\UserInterface ; /** * Defines the Online message entity. * * @ingroup content_entity_example * * @ContentEntityType( * id = \"online_message\", * label = @Translation(\"Online message\"), * handlers = { * \"view_builder\" = \"Drupal\\Core\\Entity\\EntityViewBuilder\", * \"list_builder\" = \"Drupal\\content_entity_example\\OnlineMessageListBuilder\", * \"views_data\" = \"Drupal\\content_entity_example\\Entity\\OnlineMessageViewsData\", * * \"form\" = { * \"default\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageForm\", * \"add\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageForm\", * \"edit\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageForm\", * \"delete\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageDeleteForm\", * }, * \"access\" = \"Drupal\\content_entity_example\\OnlineMessageAccessControlHandler\", * }, * base_table = \"online_message\", * admin_permission = \"administer OnlineMessage entities\", * entity_keys = { * \"id\" = \"id\", * \"label\" = \"name\", * \"uuid\" = \"uuid\", * \"uid\" = \"user_id\", * \"langcode\" = \"langcode\", * }, * links = { * \"canonical\" = \"/admin/online_message/{online_message}\", * \"edit-form\" = \"/admin/online_message/{online_message}/edit\", * \"delete-form\" = \"/admin/online_message/{online_message}/delete\" * }, * field_ui_base_route = \"online_message.settings\" * ) */ class OnlineMessage extends ContentEntityBase implements OnlineMessageInterface { use EntityChangedTrait ; /** * {@inheritdoc} */ public static function preCreate ( EntityStorageInterface $storage_controller , array & $values ) { parent :: preCreate ( $storage_controller , $values ); $values += array ( 'user_id' => \\Drupal :: currentUser () -> id (), ); } /** * {@inheritdoc} */ public function getName () { return $this -> get ( 'name' ) -> value ; } /** * {@inheritdoc} */ public function setName ( $name ) { $this -> set ( 'name' , $name ); return $this ; } /** * {@inheritdoc} */ public function getCreatedTime () { return $this -> get ( 'created' ) -> value ; } /** * {@inheritdoc} */ public function setCreatedTime ( $timestamp ) { $this -> set ( 'created' , $timestamp ); return $this ; } /** * {@inheritdoc} */ public function getOwner () { return $this -> get ( 'user_id' ) -> entity ; } /** * {@inheritdoc} */ public function getOwnerId () { return $this -> get ( 'user_id' ) -> target_id ; } /** * {@inheritdoc} */ public function setOwnerId ( $uid ) { $this -> set ( 'user_id' , $uid ); return $this ; } /** * {@inheritdoc} */ public function setOwner ( UserInterface $account ) { $this -> set ( 'user_id' , $account -> id ()); return $this ; } /** * {@inheritdoc} */ public function isPublished () { return ( bool ) $this -> getEntityKey ( 'status' ); } /** * {@inheritdoc} */ public function setPublished ( $published ) { $this -> set ( 'status' , $published ? NODE_PUBLISHED : NODE_NOT_PUBLISHED ); return $this ; } /** * {@inheritdoc} */ public static function baseFieldDefinitions ( EntityTypeInterface $entity_type ) { $fields [ 'id' ] = BaseFieldDefinition :: create ( 'integer' ) -> setLabel ( t ( 'ID' )) -> setDescription ( t ( 'The ID of the Online message entity.' )) -> setReadOnly ( TRUE ); $fields [ 'uuid' ] = BaseFieldDefinition :: create ( 'uuid' ) -> setLabel ( t ( 'UUID' )) -> setDescription ( t ( 'The UUID of the Online message entity.' )) -> setReadOnly ( TRUE ); $fields [ 'user_id' ] = BaseFieldDefinition :: create ( 'entity_reference' ) -> setLabel ( t ( 'Authored by' )) -> setDescription ( t ( 'The user ID of author of the Online message entity.' )) -> setRevisionable ( TRUE ) -> setSetting ( 'target_type' , 'user' ) -> setSetting ( 'handler' , 'default' ) -> setDefaultValueCallback ( 'Drupal\\node\\Entity\\Node::getCurrentUserId' ) -> setTranslatable ( TRUE ) -> setDisplayOptions ( 'view' , array ( 'label' => 'hidden' , 'type' => 'author' , 'weight' => 0 , )) -> setDisplayOptions ( 'form' , array ( 'type' => 'entity_reference_autocomplete' , 'weight' => 5 , 'settings' => array ( 'match_operator' => 'CONTAINS' , 'size' => '60' , 'autocomplete_type' => 'tags' , 'placeholder' => '' , ), )) -> setDisplayConfigurable ( 'form' , TRUE ) -> setDisplayConfigurable ( 'view' , TRUE ); $fields [ 'name' ] = BaseFieldDefinition :: create ( 'string' ) -> setLabel ( t ( 'Name' )) -> setDescription ( t ( 'The name of the Online message entity.' )) -> setSettings ( array ( 'max_length' => 50 , 'text_processing' => 0 , )) -> setDefaultValue ( '' ) -> setDisplayOptions ( 'view' , array ( 'label' => 'above' , 'type' => 'string' , 'weight' => - 4 , )) -> setDisplayOptions ( 'form' , array ( 'type' => 'string_textfield' , 'weight' => - 4 , )) -> setDisplayConfigurable ( 'form' , TRUE ) -> setDisplayConfigurable ( 'view' , TRUE ); $fields [ 'status' ] = BaseFieldDefinition :: create ( 'boolean' ) -> setLabel ( t ( 'Publishing status' )) -> setDescription ( t ( 'A boolean indicating whether the Online message is published.' )) -> setDefaultValue ( TRUE ); $fields [ 'langcode' ] = BaseFieldDefinition :: create ( 'language' ) -> setLabel ( t ( 'Language code' )) -> setDescription ( t ( 'The language code for the Online message entity.' )); $fields [ 'created' ] = BaseFieldDefinition :: create ( 'created' ) -> setLabel ( t ( 'Created' )) -> setDescription ( t ( 'The time that the entity was created.' )); $fields [ 'changed' ] = BaseFieldDefinition :: create ( 'changed' ) -> setLabel ( t ( 'Changed' )) -> setDescription ( t ( 'The time that the entity was last edited.' )); return $fields ; } } ?> \u6ce8\u89e3\u7684\u76f8\u5173\u540d\u8bcd\u89e3\u91ca\uff1a 1\u3001id\uff1a\u5b9e\u4f53\u7c7b\u578b\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u4e00\u822c\u9075\u5faa'modulename_xyz'\u7684\u547d\u540d\u89c4\u5219\u3002 2\u3001label\uff1a\u6613\u8bfb\u7684\u5b9e\u4f53\u540d\u79f0\u3002 3\u3001handlers\uff1a\u4e0d\u540c\u7684\u4efb\u52a1\u6240\u4f7f\u7528\u7684\u5904\u7406\u7a0b\u5e8f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u6807\u51c6\u7684\u5904\u7406\u65b9\u6cd5\u6709\uff1a 1)\u3001view_builder\uff1a\u7531routing.yml\u4e2d\u7684'_entity_view'\u6240\u8c03\u7528\u3002 2)\u3001list_builder\uff1a\u7ee7\u627fentityListBuilder\uff0c\u5c55\u793a\u5728\u7ebf\u7559\u8a00\u7684\u5217\u8868\u3002 3)\u3001form\uff1a\u7531routing.yml\u4e2d\u7684'_entity_form'\u6240\u8c03\u7528\u3002 4)\u3001access\uff1a\u8bbe\u5b9a\u8bbf\u95ee\u6743\u9650 4\u3001base_table\uff1a\u5b9a\u4e49\u5b58\u50a8\u6570\u636e\u7684\u8868\uff0c\u5fc5\u987b\u552f\u4e00\u54e6\uff01schema\u7531BaseFieldDefinitions\u51b3\u5b9a\uff0c\u8be5\u8868\u4f1a\u5728\u6a21\u5757\u542f\u7528\u7684\u65f6\u5019\u81ea\u52a8\u521b\u5efa\u3002 5\u3001fieldable\uff1a\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5b57\u6bb5\uff0c\u53ea\u6709\u5185\u5bb9\u5b9e\u4f53\u624d\u6709\u8fd9\u4e2a\u529f\u80fd 6\u3001entity_keys\uff1a\u8bbf\u95eefields\u7684\u5b57\u6bb5\uff0c\u5982nid\u6216uid 7\u3001links\uff1a\u64cd\u4f5c\u94fe\u63a5\uff0c\u5982'edit-form'\u548c'delete-form'\u3002\u5728\u5217\u8868\u9875\u53ef\u4ee5\u770b\u5230\u76f8\u5e94\u7684\u64cd\u4f5c\u6309\u94ae\u3002 \u4e03\u3001\u63a7\u5236\u5668\u7c7b \u00b6 1\u3001src/Form/OnlineMessageForm.php \u00b6 \u7531routing\u4e2d\u5b9a\u4e49\u7684'_entity_form'\u8c03\u7528\u3002 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Form\\OnlineMessageForm. */ namespace Drupal\\content_entity_example\\Form ; use Drupal\\Core\\Entity\\ContentEntityForm ; use Drupal\\Core\\Form\\FormStateInterface ; use Drupal\\Core\\Language\\Language ; /** * Form controller for Online message edit forms. * * @ingroup content_entity_example */ class OnlineMessageForm extends ContentEntityForm { /** * {@inheritdoc} */ public function buildForm ( array $form , FormStateInterface $form_state ) { /* @var $entity \\Drupal\\content_entity_example\\Entity\\OnlineMessage */ $form = parent :: buildForm ( $form , $form_state ); $entity = $this -> entity ; $form [ 'langcode' ] = array ( '#title' => $this -> t ( 'Language' ), '#type' => 'language_select' , '#default_value' => $entity -> langcode -> value , '#languages' => Language :: STATE_ALL , ); return $form ; } /** * {@inheritdoc} */ public function submit ( array $form , FormStateInterface $form_state ) { // Build the entity object from the submitted values. $entity = parent :: submit ( $form , $form_state ); return $entity ; } /** * {@inheritdoc} */ public function save ( array $form , FormStateInterface $form_state ) { $entity = $this -> entity ; $status = $entity -> save (); switch ( $status ) { case SAVED_NEW : drupal_set_message ( $this -> t ( 'Created the %label Online message.' , [ '%label' => $entity -> label (), ])); break ; default : drupal_set_message ( $this -> t ( 'Saved the %label Online message.' , [ '%label' => $entity -> label (), ])); } $form_state -> setRedirect ( 'entity.online_message.edit_form' , [ 'online_message' => $entity -> id ()]); } } ?> 2\u3001src/Form/OnlineMessageDeleteForm.php \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Form\\OnlineMessageDeleteForm. */ namespace Drupal\\content_entity_example\\Form ; use Drupal\\Core\\Entity\\ContentEntityConfirmFormBase ; use Drupal\\Core\\Form\\FormStateInterface ; use Drupal\\Core\\Url ; /** * Provides a form for deleting Online message entities. * * @ingroup content_entity_example */ class OnlineMessageDeleteForm extends ContentEntityConfirmFormBase { /** * {@inheritdoc} */ public function getQuestion () { return $this -> t ( 'Are you sure you want to delete entity %name?' , array ( '%name' => $this -> entity -> label ())); } /** * {@inheritdoc} */ public function getCancelUrl () { return new Url ( 'entity.online_message.collection' ); } /** * {@inheritdoc} */ public function getConfirmText () { return $this -> t ( 'Delete' ); } /** * {@inheritdoc} */ public function submitForm ( array & $form , FormStateInterface $form_state ) { $this -> entity -> delete (); drupal_set_message ( $this -> t ( 'content @type: deleted @label.' , [ '@type' => $this -> entity -> bundle (), '@label' => $this -> entity -> label () ] ) ); $form_state -> setRedirectUrl ( $this -> getCancelUrl ()); } } ?> 3\u3001src/OnlineMessageListBuilder.php \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\OnlineMessageListBuilder. */ namespace Drupal\\content_entity_example ; use Drupal\\Core\\Entity\\EntityInterface ; use Drupal\\Core\\Entity\\EntityListBuilder ; use Drupal\\Core\\Routing\\LinkGeneratorTrait ; use Drupal\\Core\\Url ; /** * Defines a class to build a listing of Online message entities. * * @ingroup content_entity_example */ class OnlineMessageListBuilder extends EntityListBuilder { use LinkGeneratorTrait ; /** * {@inheritdoc} */ public function buildHeader () { $header [ 'id' ] = $this -> t ( 'Online message ID' ); $header [ 'name' ] = $this -> t ( 'Name' ); return $header + parent :: buildHeader (); } /** * {@inheritdoc} */ public function buildRow ( EntityInterface $entity ) { /* @var $entity \\Drupal\\content_entity_example\\Entity\\OnlineMessage */ $row [ 'id' ] = $entity -> id (); $row [ 'name' ] = $this -> l ( $entity -> label (), new Url ( 'entity.online_message.edit_form' , array ( 'online_message' => $entity -> id (), ) ) ); return $row + parent :: buildRow ( $entity ); } } ?> \u516b\u3001Field\u914d\u7f6e \u00b6 1\u3001src/Form/OnlineMessageSettingsForm.php \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Form\\OnlineMessageSettingsForm. */ namespace Drupal\\content_entity_example\\Form ; use Drupal\\Core\\Form\\FormBase ; use Drupal\\Core\\Form\\FormStateInterface ; /** * Class OnlineMessageSettingsForm. * * @package Drupal\\content_entity_example\\Form * * @ingroup content_entity_example */ class OnlineMessageSettingsForm extends FormBase { /** * Returns a unique string identifying the form. * * @return string * The unique string identifying the form. */ public function getFormId () { return 'OnlineMessage_settings' ; } /** * Form submission handler. * * @param array $form * An associative array containing the structure of the form. * @param \\Drupal\\Core\\Form\\FormStateInterface $form_state * The current state of the form. */ public function submitForm ( array & $form , FormStateInterface $form_state ) { // Empty implementation of the abstract submit class. } /** * Defines the settings form for Online message entities. * * @param array $form * An associative array containing the structure of the form. * @param \\Drupal\\Core\\Form\\FormStateInterface $form_state * The current state of the form. * * @return array * Form definition array. */ public function buildForm ( array $form , FormStateInterface $form_state ) { $form [ 'OnlineMessage_settings' ][ '#markup' ] = 'Settings form for Online message entities. Manage field settings here.' ; return $form ; } } ?> \u4e5d\u3001\u6ce8\u518centity \u00b6 \u542f\u7528\u6a21\u5757\uff0c\u4f1a\u81ea\u52a8\u6839\u636eEntity\u4e2d\u7684\u914d\u7f6e\u521b\u5efaonline_message\u8868\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/2192175 2\u3001 http://www.slideshare.net/andypost/d8-entity","title":"\"Drupal8 Content Entity\""},{"location":"drupal/drupal8/Drupal8-Content-Entity/#_1","text":"mkdir content_entity_example touch content_entity_example.info.yml \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a name: content_entity_example type: module description: Provides ContentEntityExampleOnlineMessage entity. core: 8 .x package: Other","title":"\u4e00\u3001\u521b\u5efa\u6a21\u5757"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#content_entity_exampleroutingyml","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a # OnlineMessage routing definition entity.online_message.canonical: path: '/admin/structure/online_message/{online_message}' defaults: _entity_view: 'online_message' _title: 'Online message' requirements: _entity_access: 'online_message.view' options: _admin_route: TRUE entity.online_message.collection: path: '/admin/structure/online_message' defaults: _entity_list: 'online_message' _title: 'Online message list' requirements: _permission: 'view online message entities' options: _admin_route: TRUE entity.online_message.add_form: path: '/admin/structure/online_message/add' defaults: _entity_form: online_message.add _title: 'Add Online message' requirements: _permission: 'add online message entities' options: _admin_route: TRUE entity.online_message.edit_form: path: '/admin/structure/online_message/{online_message}/edit' defaults: _entity_form: online_message.edit _title: 'Edit Online message' requirements: _permission: 'edit online message entities' options: _admin_route: TRUE entity.online_message.delete_form: path: '/admin/structure/online_message/{online_message}/delete' defaults: _entity_form: online_message.delete _title: 'Delete Online message' requirements: _permission: 'delete online message entities' options: _admin_route: TRUE online_message.settings: path: '/admin/structure/online_message/settings' defaults: _form: '\\Drupal\\content_entity_example\\Form\\OnlineMessageSettingsForm' _title: 'Online message settings' requirements: _permission: 'administer online message entities' options: _admin_route: TRUE","title":"\u4e8c\u3001content_entity_example.routing.yml"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#content_entity_examplelinksmenuyml","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a # Online message menu items definition entity.online_message.collection: title: 'Online message list' route_name: entity.online_message.collection description: 'List Online message entities' parent: system.admin_structure weight: 100 online_message.admin.structure.settings: title: Online message settings description: 'Configure Online message entities' route_name: online_message.settings parent: system.admin_structure","title":"\u4e09\u3001content_entity_example.links.menu.yml"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#content_entity_examplelinksactionyml","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a entity.online_message.add_form: route_name: entity.online_message.add_form title: 'Add Online message' appears_on: - entity.online_message.collection - entity.online_message.canonical","title":"\u56db\u3001content_entity_example.links.action.yml"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#content_entity_examplelinkstaskyml","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a # Online message routing definition online_message.settings_tab: route_name: online_message.settings title: 'Settings' base_route: online_message.settings entity.online_message.canonical: route_name: entity.online_message.canonical base_route: entity.online_message.canonical title: 'View' entity.online_message.edit_form: route_name: entity.online_message.edit_form base_route: entity.online_message.canonical title: Edit entity.online_message.delete_form: route_name: entity.online_message.delete_form base_route: entity.online_message.canonical title: Delete weight: 10","title":"\u4e94\u3001content_entity_example.links.task.yml"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#entity","text":"","title":"\u516d\u3001Entity\u7c7b"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#1srconlinemessageinterfacephp","text":"\u6ce8\uff1a\u901a\u8fc7EntityOwnerInterface\u63a5\u53e3\u53ef\u83b7\u53d6\u5176\u4ed6\u7684\u4e00\u4e9b\u51fd\u6570\uff0c\u5982 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\OnlineMessageInterface. */ namespace Drupal\\content_entity_example ; use Drupal\\Core\\Entity\\ContentEntityInterface ; use Drupal\\Core\\Entity\\EntityChangedInterface ; use Drupal\\Core\\Entity\\EntityTypeInterface ; use Drupal\\user\\EntityOwnerInterface ; /** * Provides an interface for defining Online message entities. * * @ingroup content_entity_example */ interface OnlineMessageInterface extends ContentEntityInterface , EntityChangedInterface , EntityOwnerInterface { // Add get/set methods for your configuration properties here. /** * Gets the Online message name. * * @return string * Name of the Online message. */ public function getName (); /** * Sets the Online message name. * * @param string $name * The Online message name. * * @return \\Drupal\\content_entity_example\\OnlineMessageInterface * The called Online message entity. */ public function setName ( $name ); /** * Gets the Online message creation timestamp. * * @return int * Creation timestamp of the Online message. */ public function getCreatedTime (); /** * Sets the Online message creation timestamp. * * @param int $timestamp * The Online message creation timestamp. * * @return \\Drupal\\content_entity_example\\OnlineMessageInterface * The called Online message entity. */ public function setCreatedTime ( $timestamp ); /** * Returns the Online message published status indicator. * * Unpublished Online message are only visible to restricted users. * * @return bool * TRUE if the Online message is published. */ public function isPublished (); /** * Sets the published status of a Online message. * * @param bool $published * TRUE to set this Online message to published, FALSE to set it to unpublished. * * @return \\Drupal\\content_entity_example\\OnlineMessageInterface * The called Online message entity. */ public function setPublished ( $published ); } ?>","title":"1\u3001src/OnlineMessageInterface.php"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#2srcentityonlinemessagephp","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Entity\\OnlineMessage. */ namespace Drupal\\content_entity_example\\Entity ; use Drupal\\Core\\Entity\\EntityStorageInterface ; use Drupal\\Core\\Field\\BaseFieldDefinition ; use Drupal\\Core\\Entity\\ContentEntityBase ; use Drupal\\Core\\Entity\\EntityChangedTrait ; use Drupal\\Core\\Entity\\EntityTypeInterface ; use Drupal\\content_entity_example\\OnlineMessageInterface ; use Drupal\\user\\UserInterface ; /** * Defines the Online message entity. * * @ingroup content_entity_example * * @ContentEntityType( * id = \"online_message\", * label = @Translation(\"Online message\"), * handlers = { * \"view_builder\" = \"Drupal\\Core\\Entity\\EntityViewBuilder\", * \"list_builder\" = \"Drupal\\content_entity_example\\OnlineMessageListBuilder\", * \"views_data\" = \"Drupal\\content_entity_example\\Entity\\OnlineMessageViewsData\", * * \"form\" = { * \"default\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageForm\", * \"add\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageForm\", * \"edit\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageForm\", * \"delete\" = \"Drupal\\content_entity_example\\Form\\OnlineMessageDeleteForm\", * }, * \"access\" = \"Drupal\\content_entity_example\\OnlineMessageAccessControlHandler\", * }, * base_table = \"online_message\", * admin_permission = \"administer OnlineMessage entities\", * entity_keys = { * \"id\" = \"id\", * \"label\" = \"name\", * \"uuid\" = \"uuid\", * \"uid\" = \"user_id\", * \"langcode\" = \"langcode\", * }, * links = { * \"canonical\" = \"/admin/online_message/{online_message}\", * \"edit-form\" = \"/admin/online_message/{online_message}/edit\", * \"delete-form\" = \"/admin/online_message/{online_message}/delete\" * }, * field_ui_base_route = \"online_message.settings\" * ) */ class OnlineMessage extends ContentEntityBase implements OnlineMessageInterface { use EntityChangedTrait ; /** * {@inheritdoc} */ public static function preCreate ( EntityStorageInterface $storage_controller , array & $values ) { parent :: preCreate ( $storage_controller , $values ); $values += array ( 'user_id' => \\Drupal :: currentUser () -> id (), ); } /** * {@inheritdoc} */ public function getName () { return $this -> get ( 'name' ) -> value ; } /** * {@inheritdoc} */ public function setName ( $name ) { $this -> set ( 'name' , $name ); return $this ; } /** * {@inheritdoc} */ public function getCreatedTime () { return $this -> get ( 'created' ) -> value ; } /** * {@inheritdoc} */ public function setCreatedTime ( $timestamp ) { $this -> set ( 'created' , $timestamp ); return $this ; } /** * {@inheritdoc} */ public function getOwner () { return $this -> get ( 'user_id' ) -> entity ; } /** * {@inheritdoc} */ public function getOwnerId () { return $this -> get ( 'user_id' ) -> target_id ; } /** * {@inheritdoc} */ public function setOwnerId ( $uid ) { $this -> set ( 'user_id' , $uid ); return $this ; } /** * {@inheritdoc} */ public function setOwner ( UserInterface $account ) { $this -> set ( 'user_id' , $account -> id ()); return $this ; } /** * {@inheritdoc} */ public function isPublished () { return ( bool ) $this -> getEntityKey ( 'status' ); } /** * {@inheritdoc} */ public function setPublished ( $published ) { $this -> set ( 'status' , $published ? NODE_PUBLISHED : NODE_NOT_PUBLISHED ); return $this ; } /** * {@inheritdoc} */ public static function baseFieldDefinitions ( EntityTypeInterface $entity_type ) { $fields [ 'id' ] = BaseFieldDefinition :: create ( 'integer' ) -> setLabel ( t ( 'ID' )) -> setDescription ( t ( 'The ID of the Online message entity.' )) -> setReadOnly ( TRUE ); $fields [ 'uuid' ] = BaseFieldDefinition :: create ( 'uuid' ) -> setLabel ( t ( 'UUID' )) -> setDescription ( t ( 'The UUID of the Online message entity.' )) -> setReadOnly ( TRUE ); $fields [ 'user_id' ] = BaseFieldDefinition :: create ( 'entity_reference' ) -> setLabel ( t ( 'Authored by' )) -> setDescription ( t ( 'The user ID of author of the Online message entity.' )) -> setRevisionable ( TRUE ) -> setSetting ( 'target_type' , 'user' ) -> setSetting ( 'handler' , 'default' ) -> setDefaultValueCallback ( 'Drupal\\node\\Entity\\Node::getCurrentUserId' ) -> setTranslatable ( TRUE ) -> setDisplayOptions ( 'view' , array ( 'label' => 'hidden' , 'type' => 'author' , 'weight' => 0 , )) -> setDisplayOptions ( 'form' , array ( 'type' => 'entity_reference_autocomplete' , 'weight' => 5 , 'settings' => array ( 'match_operator' => 'CONTAINS' , 'size' => '60' , 'autocomplete_type' => 'tags' , 'placeholder' => '' , ), )) -> setDisplayConfigurable ( 'form' , TRUE ) -> setDisplayConfigurable ( 'view' , TRUE ); $fields [ 'name' ] = BaseFieldDefinition :: create ( 'string' ) -> setLabel ( t ( 'Name' )) -> setDescription ( t ( 'The name of the Online message entity.' )) -> setSettings ( array ( 'max_length' => 50 , 'text_processing' => 0 , )) -> setDefaultValue ( '' ) -> setDisplayOptions ( 'view' , array ( 'label' => 'above' , 'type' => 'string' , 'weight' => - 4 , )) -> setDisplayOptions ( 'form' , array ( 'type' => 'string_textfield' , 'weight' => - 4 , )) -> setDisplayConfigurable ( 'form' , TRUE ) -> setDisplayConfigurable ( 'view' , TRUE ); $fields [ 'status' ] = BaseFieldDefinition :: create ( 'boolean' ) -> setLabel ( t ( 'Publishing status' )) -> setDescription ( t ( 'A boolean indicating whether the Online message is published.' )) -> setDefaultValue ( TRUE ); $fields [ 'langcode' ] = BaseFieldDefinition :: create ( 'language' ) -> setLabel ( t ( 'Language code' )) -> setDescription ( t ( 'The language code for the Online message entity.' )); $fields [ 'created' ] = BaseFieldDefinition :: create ( 'created' ) -> setLabel ( t ( 'Created' )) -> setDescription ( t ( 'The time that the entity was created.' )); $fields [ 'changed' ] = BaseFieldDefinition :: create ( 'changed' ) -> setLabel ( t ( 'Changed' )) -> setDescription ( t ( 'The time that the entity was last edited.' )); return $fields ; } } ?> \u6ce8\u89e3\u7684\u76f8\u5173\u540d\u8bcd\u89e3\u91ca\uff1a 1\u3001id\uff1a\u5b9e\u4f53\u7c7b\u578b\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u4e00\u822c\u9075\u5faa'modulename_xyz'\u7684\u547d\u540d\u89c4\u5219\u3002 2\u3001label\uff1a\u6613\u8bfb\u7684\u5b9e\u4f53\u540d\u79f0\u3002 3\u3001handlers\uff1a\u4e0d\u540c\u7684\u4efb\u52a1\u6240\u4f7f\u7528\u7684\u5904\u7406\u7a0b\u5e8f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u6807\u51c6\u7684\u5904\u7406\u65b9\u6cd5\u6709\uff1a 1)\u3001view_builder\uff1a\u7531routing.yml\u4e2d\u7684'_entity_view'\u6240\u8c03\u7528\u3002 2)\u3001list_builder\uff1a\u7ee7\u627fentityListBuilder\uff0c\u5c55\u793a\u5728\u7ebf\u7559\u8a00\u7684\u5217\u8868\u3002 3)\u3001form\uff1a\u7531routing.yml\u4e2d\u7684'_entity_form'\u6240\u8c03\u7528\u3002 4)\u3001access\uff1a\u8bbe\u5b9a\u8bbf\u95ee\u6743\u9650 4\u3001base_table\uff1a\u5b9a\u4e49\u5b58\u50a8\u6570\u636e\u7684\u8868\uff0c\u5fc5\u987b\u552f\u4e00\u54e6\uff01schema\u7531BaseFieldDefinitions\u51b3\u5b9a\uff0c\u8be5\u8868\u4f1a\u5728\u6a21\u5757\u542f\u7528\u7684\u65f6\u5019\u81ea\u52a8\u521b\u5efa\u3002 5\u3001fieldable\uff1a\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5b57\u6bb5\uff0c\u53ea\u6709\u5185\u5bb9\u5b9e\u4f53\u624d\u6709\u8fd9\u4e2a\u529f\u80fd 6\u3001entity_keys\uff1a\u8bbf\u95eefields\u7684\u5b57\u6bb5\uff0c\u5982nid\u6216uid 7\u3001links\uff1a\u64cd\u4f5c\u94fe\u63a5\uff0c\u5982'edit-form'\u548c'delete-form'\u3002\u5728\u5217\u8868\u9875\u53ef\u4ee5\u770b\u5230\u76f8\u5e94\u7684\u64cd\u4f5c\u6309\u94ae\u3002","title":"2\u3001src/Entity/OnlineMessage.php"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#_2","text":"","title":"\u4e03\u3001\u63a7\u5236\u5668\u7c7b"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#1srcformonlinemessageformphp","text":"\u7531routing\u4e2d\u5b9a\u4e49\u7684'_entity_form'\u8c03\u7528\u3002 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Form\\OnlineMessageForm. */ namespace Drupal\\content_entity_example\\Form ; use Drupal\\Core\\Entity\\ContentEntityForm ; use Drupal\\Core\\Form\\FormStateInterface ; use Drupal\\Core\\Language\\Language ; /** * Form controller for Online message edit forms. * * @ingroup content_entity_example */ class OnlineMessageForm extends ContentEntityForm { /** * {@inheritdoc} */ public function buildForm ( array $form , FormStateInterface $form_state ) { /* @var $entity \\Drupal\\content_entity_example\\Entity\\OnlineMessage */ $form = parent :: buildForm ( $form , $form_state ); $entity = $this -> entity ; $form [ 'langcode' ] = array ( '#title' => $this -> t ( 'Language' ), '#type' => 'language_select' , '#default_value' => $entity -> langcode -> value , '#languages' => Language :: STATE_ALL , ); return $form ; } /** * {@inheritdoc} */ public function submit ( array $form , FormStateInterface $form_state ) { // Build the entity object from the submitted values. $entity = parent :: submit ( $form , $form_state ); return $entity ; } /** * {@inheritdoc} */ public function save ( array $form , FormStateInterface $form_state ) { $entity = $this -> entity ; $status = $entity -> save (); switch ( $status ) { case SAVED_NEW : drupal_set_message ( $this -> t ( 'Created the %label Online message.' , [ '%label' => $entity -> label (), ])); break ; default : drupal_set_message ( $this -> t ( 'Saved the %label Online message.' , [ '%label' => $entity -> label (), ])); } $form_state -> setRedirect ( 'entity.online_message.edit_form' , [ 'online_message' => $entity -> id ()]); } } ?>","title":"1\u3001src/Form/OnlineMessageForm.php"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#2srcformonlinemessagedeleteformphp","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Form\\OnlineMessageDeleteForm. */ namespace Drupal\\content_entity_example\\Form ; use Drupal\\Core\\Entity\\ContentEntityConfirmFormBase ; use Drupal\\Core\\Form\\FormStateInterface ; use Drupal\\Core\\Url ; /** * Provides a form for deleting Online message entities. * * @ingroup content_entity_example */ class OnlineMessageDeleteForm extends ContentEntityConfirmFormBase { /** * {@inheritdoc} */ public function getQuestion () { return $this -> t ( 'Are you sure you want to delete entity %name?' , array ( '%name' => $this -> entity -> label ())); } /** * {@inheritdoc} */ public function getCancelUrl () { return new Url ( 'entity.online_message.collection' ); } /** * {@inheritdoc} */ public function getConfirmText () { return $this -> t ( 'Delete' ); } /** * {@inheritdoc} */ public function submitForm ( array & $form , FormStateInterface $form_state ) { $this -> entity -> delete (); drupal_set_message ( $this -> t ( 'content @type: deleted @label.' , [ '@type' => $this -> entity -> bundle (), '@label' => $this -> entity -> label () ] ) ); $form_state -> setRedirectUrl ( $this -> getCancelUrl ()); } } ?>","title":"2\u3001src/Form/OnlineMessageDeleteForm.php"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#3srconlinemessagelistbuilderphp","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\OnlineMessageListBuilder. */ namespace Drupal\\content_entity_example ; use Drupal\\Core\\Entity\\EntityInterface ; use Drupal\\Core\\Entity\\EntityListBuilder ; use Drupal\\Core\\Routing\\LinkGeneratorTrait ; use Drupal\\Core\\Url ; /** * Defines a class to build a listing of Online message entities. * * @ingroup content_entity_example */ class OnlineMessageListBuilder extends EntityListBuilder { use LinkGeneratorTrait ; /** * {@inheritdoc} */ public function buildHeader () { $header [ 'id' ] = $this -> t ( 'Online message ID' ); $header [ 'name' ] = $this -> t ( 'Name' ); return $header + parent :: buildHeader (); } /** * {@inheritdoc} */ public function buildRow ( EntityInterface $entity ) { /* @var $entity \\Drupal\\content_entity_example\\Entity\\OnlineMessage */ $row [ 'id' ] = $entity -> id (); $row [ 'name' ] = $this -> l ( $entity -> label (), new Url ( 'entity.online_message.edit_form' , array ( 'online_message' => $entity -> id (), ) ) ); return $row + parent :: buildRow ( $entity ); } } ?>","title":"3\u3001src/OnlineMessageListBuilder.php"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#field","text":"","title":"\u516b\u3001Field\u914d\u7f6e"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#1srcformonlinemessagesettingsformphp","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\content_entity_example\\Form\\OnlineMessageSettingsForm. */ namespace Drupal\\content_entity_example\\Form ; use Drupal\\Core\\Form\\FormBase ; use Drupal\\Core\\Form\\FormStateInterface ; /** * Class OnlineMessageSettingsForm. * * @package Drupal\\content_entity_example\\Form * * @ingroup content_entity_example */ class OnlineMessageSettingsForm extends FormBase { /** * Returns a unique string identifying the form. * * @return string * The unique string identifying the form. */ public function getFormId () { return 'OnlineMessage_settings' ; } /** * Form submission handler. * * @param array $form * An associative array containing the structure of the form. * @param \\Drupal\\Core\\Form\\FormStateInterface $form_state * The current state of the form. */ public function submitForm ( array & $form , FormStateInterface $form_state ) { // Empty implementation of the abstract submit class. } /** * Defines the settings form for Online message entities. * * @param array $form * An associative array containing the structure of the form. * @param \\Drupal\\Core\\Form\\FormStateInterface $form_state * The current state of the form. * * @return array * Form definition array. */ public function buildForm ( array $form , FormStateInterface $form_state ) { $form [ 'OnlineMessage_settings' ][ '#markup' ] = 'Settings form for Online message entities. Manage field settings here.' ; return $form ; } } ?>","title":"1\u3001src/Form/OnlineMessageSettingsForm.php"},{"location":"drupal/drupal8/Drupal8-Content-Entity/#entity_1","text":"\u542f\u7528\u6a21\u5757\uff0c\u4f1a\u81ea\u52a8\u6839\u636eEntity\u4e2d\u7684\u914d\u7f6e\u521b\u5efaonline_message\u8868\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/2192175 2\u3001 http://www.slideshare.net/andypost/d8-entity","title":"\u4e5d\u3001\u6ce8\u518centity"},{"location":"drupal/drupal8/Drupal8-Controller/","tags":"[controller]","text":"\u5b66\u4e60\u4e86\u8fd9\u4e48\u591a\u7684\u7ae0\u8282\u4e86\uff0c\u5bf9Drupal8\u5e94\u8be5\u4e0d\u964c\u751f\u4e86\u5427\uff01 Controller\u7c7b\u4e3b\u8981\u7528\u4e8e\u5904\u7406\u76f8\u5173\u7684HTTP\u8bf7\u6c42\u903b\u8f91\uff0c\u4e00\u822c\u5728routing.yml\u4e2d\u4f1a\u6307\u5b9a\u8c03\u7528\u54ea\u4e2aController\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728\uff1a { module_name } /src/Controller/ExampleController.php \u672c\u6587github\uff1a https://github.com/RamboLau/drupal8-demos/tree/master/controller_example \u4e00\u3001\u521b\u5efa\u6a21\u5757 \u00b6 mkdir controller_example touch controller_example.info.yml \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a name: controller_example type: module description: Provides controller example. core: 8 .x package: Other \u4e8c\u3001controller_example.routing.yml \u00b6 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a controller_example.default_controller_index: path: '/controller_example/index/hello/{name}' defaults: _controller: '\\Drupal\\controller_example\\Controller\\DefaultController::index' _title: 'index page' requirements: _permission: 'access content' controller_example.default_controller_default_page: path: '/controller_example/default_page/hello/{name}' defaults: _controller: '\\Drupal\\controller_example\\Controller\\DefaultController::default_page' _title: 'default page' requirements: _permission: 'access content' \u4e09\u3001src/Controller/DefaultController.php \u00b6 \u521b\u5efa\u4e00\u4e2a\u540d\u4e3aDefault\u7684Controller\u3002 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\controller_example\\Controller\\DefaultController. */ namespace Drupal\\controller_example\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; /** * Class DefaultController. * * @package Drupal\\controller_example\\Controller */ class DefaultController extends ControllerBase { /** * Index. * * @return string * Return Hello string. */ public function index ( $name ) { return [ '#type' => 'markup' , '#markup' => $this -> t ( \"Implement method: index with parameter(s): $name \" ) ]; } /** * Default_page. * * @return string * Return Hello string. */ public function default_page ( $name ) { return [ '#type' => 'markup' , '#markup' => $this -> t ( \"Implement method: default_page with parameter(s): $name \" ) ]; } } ?> \u56db\u3001\u8c03\u8bd5 \u00b6 \u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8f93\u5165 http://127.0.0.1:8080/drupal8/controller_example/default_page/hello/this_is_a_default_page \uff0c\u663e\u793a\uff1a \u8f93\u5165 http://127.0.0.1:8080/drupal8/controller_example/index/hello/this_is_a_index_page \uff0c\u663e\u793a\uff1a \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/2116767 2\u3001 http://www.sitepoint.com/build-drupal-8-module-routing-controllers-menu-links/ 3\u3001 https://www.previousnext.com.au/blog/using-drupal-8s-new-route-controllers 4\u3001 http://www.vdmi.nl/blog/using-controllers-drupal-8","title":"\"Drupal8 Controller\""},{"location":"drupal/drupal8/Drupal8-Controller/#_1","text":"mkdir controller_example touch controller_example.info.yml \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a name: controller_example type: module description: Provides controller example. core: 8 .x package: Other","title":"\u4e00\u3001\u521b\u5efa\u6a21\u5757"},{"location":"drupal/drupal8/Drupal8-Controller/#controller_exampleroutingyml","text":"\u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a controller_example.default_controller_index: path: '/controller_example/index/hello/{name}' defaults: _controller: '\\Drupal\\controller_example\\Controller\\DefaultController::index' _title: 'index page' requirements: _permission: 'access content' controller_example.default_controller_default_page: path: '/controller_example/default_page/hello/{name}' defaults: _controller: '\\Drupal\\controller_example\\Controller\\DefaultController::default_page' _title: 'default page' requirements: _permission: 'access content'","title":"\u4e8c\u3001controller_example.routing.yml"},{"location":"drupal/drupal8/Drupal8-Controller/#srccontrollerdefaultcontrollerphp","text":"\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aDefault\u7684Controller\u3002 \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a <?php /** * @file * Contains \\Drupal\\controller_example\\Controller\\DefaultController. */ namespace Drupal\\controller_example\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; /** * Class DefaultController. * * @package Drupal\\controller_example\\Controller */ class DefaultController extends ControllerBase { /** * Index. * * @return string * Return Hello string. */ public function index ( $name ) { return [ '#type' => 'markup' , '#markup' => $this -> t ( \"Implement method: index with parameter(s): $name \" ) ]; } /** * Default_page. * * @return string * Return Hello string. */ public function default_page ( $name ) { return [ '#type' => 'markup' , '#markup' => $this -> t ( \"Implement method: default_page with parameter(s): $name \" ) ]; } } ?>","title":"\u4e09\u3001src/Controller/DefaultController.php"},{"location":"drupal/drupal8/Drupal8-Controller/#_2","text":"\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8f93\u5165 http://127.0.0.1:8080/drupal8/controller_example/default_page/hello/this_is_a_default_page \uff0c\u663e\u793a\uff1a \u8f93\u5165 http://127.0.0.1:8080/drupal8/controller_example/index/hello/this_is_a_index_page \uff0c\u663e\u793a\uff1a \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/2116767 2\u3001 http://www.sitepoint.com/build-drupal-8-module-routing-controllers-menu-links/ 3\u3001 https://www.previousnext.com.au/blog/using-drupal-8s-new-route-controllers 4\u3001 http://www.vdmi.nl/blog/using-controllers-drupal-8","title":"\u56db\u3001\u8c03\u8bd5"},{"location":"drupal/drupal8/Drupal8-Cron-Queue/","tags":"[queue]","text":"Drupal\u4e2d\u7684Queue(\u961f\u5217)\u7528\u4e8e\u5904\u7406\u6bd4\u8f83\u8017\u65f6\u7684\u4efb\u52a1\uff0c\u4e00\u822c\u662f\u901a\u8fc7\u7cfb\u7edf\u7684Cron\u6765\u89e6\u53d1\u3002 \u672c\u6587github\uff1a https://github.com/RamboLau/drupal8-demos/tree/master/queue_example \u4e00\u3001Drupal7 Queue \u00b6 Drupal7\u4e00\u822c\u662f\u901a\u8fc7hook_cron_queue_info()\u8fd9\u4e2a\u94a9\u5b50\u6765\u5b9e\u73b0\uff0c\u5982\uff1a <?php /** * Implements hook_cron(). */ function queue_example_cron () { $queue = DrupalQueue :: get ( 'example_queue' ); foreach ( example_data () as $item ) { $queue -> createItem ( $item ); } } /** * Implements hook_cron_queue_info(). */ function queue_example_cron_queue_info () { $queues = array (); $queues [ 'example_queue' ] = array ( 'worker callback' => 'example_queue_worker' , // queue\u8c03\u7528\u7684\u51fd\u6570 'time' => 60 , //\u6bcf\u6b21\u8fd0\u884c\u65f6\uff0c\u53ef\u4f9b\u6d88\u8017\u7684\u6700\u957f\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2 ); return $queues ; } ?> \u4e8c\u3001Drupal8 Queue \u00b6 Drupal8\u7684Queue(\u961f\u5217)\u662f\u901a\u8fc7QueueWorker\u8fd9\u4e2a\u63d2\u4ef6\u6765\u5b9e\u73b0\u7684\u3002 1\u3001src/Plugin/QueueWorker/ExampleQueue.php \u00b6 <?php /** * @file * Contains Drupal\\queue_example\\Plugin\\QueueWorker\\ExampleQueue */ namespace Drupal\\queue_example\\Plugin\\QueueWorker ; use Drupal\\Core\\Queue\\QueueWorkerBase ; /** * @QueueWorker( * id = \"example_queue\", * title = @Translation(\"example queue\"), * cron = {\"time\" = 10} * ) */ class ExampleQueue extends QueueWorkerBase { /** * {@inheritdoc} */ public function processItem ( $data ) { // Process data here. throw new \\Exception ( 'Process data ' . json_encode ( $data )); } } ?> 2\u3001queue_example.module \u00b6 \u8981\u6267\u884cqueue\uff0c\u5fc5\u9009\u5b9e\u73b0hook_cron\u8fd9\u4e2a\u94a9\u5b50\u3002 /** * Implements hook_cron(). * * @see \\Drupal\\queue_example\\Plugin\\QueueWorker\\ExampleQueue */ function queue_example_cron() { $queue = \\Drupal::queue('example_queue', TRUE); $item = [ 'entity_type' => 'node', 'id' => 1 ]; $queue->createItem($item); } 3\u3001\u7ed3\u679c \u00b6 1\uff09\u3001\u8bbf\u95eehttp://127.0.0.1/drupal8/admin/config/system/cron\u6267\u884ccron 2\uff09\u3001\u6253\u5f00phpmyadmin\uff0c\u67e5\u770bqueue\u8868 3\uff09\u3001\u8bbf\u95eehttp://127.0.0.1/drupal8/admin/reports/dblog\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u5728processItem\u65b9\u6cd5\u4e2d\u629b\u51fa\u7684\u5f02\u5e38\u4e86\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://www.vdmi.nl/blog/creating-drupal-cron-queue-worker-drupal-8 2\u3001 http://www.sitepoint.com/drupal-8-queue-api-powerful-manual-and-cron-queueing/","title":"\"Drupal8 Cron Queue\""},{"location":"drupal/drupal8/Drupal8-Cron-Queue/#drupal7-queue","text":"Drupal7\u4e00\u822c\u662f\u901a\u8fc7hook_cron_queue_info()\u8fd9\u4e2a\u94a9\u5b50\u6765\u5b9e\u73b0\uff0c\u5982\uff1a <?php /** * Implements hook_cron(). */ function queue_example_cron () { $queue = DrupalQueue :: get ( 'example_queue' ); foreach ( example_data () as $item ) { $queue -> createItem ( $item ); } } /** * Implements hook_cron_queue_info(). */ function queue_example_cron_queue_info () { $queues = array (); $queues [ 'example_queue' ] = array ( 'worker callback' => 'example_queue_worker' , // queue\u8c03\u7528\u7684\u51fd\u6570 'time' => 60 , //\u6bcf\u6b21\u8fd0\u884c\u65f6\uff0c\u53ef\u4f9b\u6d88\u8017\u7684\u6700\u957f\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2 ); return $queues ; } ?>","title":"\u4e00\u3001Drupal7 Queue"},{"location":"drupal/drupal8/Drupal8-Cron-Queue/#drupal8-queue","text":"Drupal8\u7684Queue(\u961f\u5217)\u662f\u901a\u8fc7QueueWorker\u8fd9\u4e2a\u63d2\u4ef6\u6765\u5b9e\u73b0\u7684\u3002","title":"\u4e8c\u3001Drupal8 Queue"},{"location":"drupal/drupal8/Drupal8-Cron-Queue/#1srcpluginqueueworkerexamplequeuephp","text":"<?php /** * @file * Contains Drupal\\queue_example\\Plugin\\QueueWorker\\ExampleQueue */ namespace Drupal\\queue_example\\Plugin\\QueueWorker ; use Drupal\\Core\\Queue\\QueueWorkerBase ; /** * @QueueWorker( * id = \"example_queue\", * title = @Translation(\"example queue\"), * cron = {\"time\" = 10} * ) */ class ExampleQueue extends QueueWorkerBase { /** * {@inheritdoc} */ public function processItem ( $data ) { // Process data here. throw new \\Exception ( 'Process data ' . json_encode ( $data )); } } ?>","title":"1\u3001src/Plugin/QueueWorker/ExampleQueue.php"},{"location":"drupal/drupal8/Drupal8-Cron-Queue/#2queue_examplemodule","text":"\u8981\u6267\u884cqueue\uff0c\u5fc5\u9009\u5b9e\u73b0hook_cron\u8fd9\u4e2a\u94a9\u5b50\u3002 /** * Implements hook_cron(). * * @see \\Drupal\\queue_example\\Plugin\\QueueWorker\\ExampleQueue */ function queue_example_cron() { $queue = \\Drupal::queue('example_queue', TRUE); $item = [ 'entity_type' => 'node', 'id' => 1 ]; $queue->createItem($item); }","title":"2\u3001queue_example.module"},{"location":"drupal/drupal8/Drupal8-Cron-Queue/#3","text":"1\uff09\u3001\u8bbf\u95eehttp://127.0.0.1/drupal8/admin/config/system/cron\u6267\u884ccron 2\uff09\u3001\u6253\u5f00phpmyadmin\uff0c\u67e5\u770bqueue\u8868 3\uff09\u3001\u8bbf\u95eehttp://127.0.0.1/drupal8/admin/reports/dblog\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u5728processItem\u65b9\u6cd5\u4e2d\u629b\u51fa\u7684\u5f02\u5e38\u4e86\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://www.vdmi.nl/blog/creating-drupal-cron-queue-worker-drupal-8 2\u3001 http://www.sitepoint.com/drupal-8-queue-api-powerful-manual-and-cron-queueing/","title":"3\u3001\u7ed3\u679c"},{"location":"drupal/drupal8/Drupal8-Javascript/","tags":"[javascript]","text":"JavaScript \u7f16\u7801\u89c4\u8303\u5efa\u8bae \u00b6 \u672c\u6587\u5c31 JavaScript \u7f16\u7801\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u7684\u6392\u7248\u3001\u547d\u540d\u3001\u58f0\u660e\u3001\u4f5c\u7528\u57df\u3001\u53ca\u4e00\u4e9b\u7279\u6b8a\u7b26\u53f7\u7684\u4f7f\u7528\u7b49\u65b9\u9762\uff0c\u6839\u636e\u4e2a\u4eba\u5728\u5b66\u4e60\u5de5\u4f5c\u4e2d\u7684\u603b\u7ed3\uff0c\u7ed9\u51fa\u81ea\u5df1\u7684\u4e00\u4e9b\u5efa\u8bae\uff0c\u5e76\u5206\u6790\u5176\u4e2d\u7f18\u7531\uff0c\u4ee5\u4f9b\u53c2\u8003\u3002 JavaScript \u6587\u4ef6\u5f15\u7528 \u00b6 JavaScript \u7a0b\u5e8f\u5e94\u8be5\u5c3d\u91cf\u653e\u5728 .js \u7684\u6587\u4ef6\u4e2d\uff0c\u9700\u8981\u8c03\u7528\u7684\u65f6\u5019\u5728 HTML \u4e2d\u4ee5 <script src=\"filename.js\"> \u7684\u5f62\u5f0f\u5305\u542b\u8fdb\u6765\u3002JavaScript \u4ee3\u7801\u82e5\u4e0d\u662f\u8be5 HTML \u6587\u4ef6\u6240\u4e13\u7528\u7684\uff0c\u5219\u5e94\u5c3d\u91cf\u907f\u514d\u5728 HTML \u6587\u4ef6\u4e2d\u76f4\u63a5\u7f16\u5199 JavaScript \u4ee3\u7801\u3002\u56e0\u4e3a\u8fd9\u6837\u4f1a\u5927\u5927\u589e\u52a0 HTML \u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u65e0\u76ca\u4e8e\u4ee3\u7801\u7684\u538b\u7f29\u548c\u7f13\u5b58\u7684\u4f7f\u7528\u3002 \u53e6\u5916\uff0c <script src=\"filename.js\"> \u6807\u7b7e\u5e94\u5c3d\u91cf\u653e\u5728\u6587\u4ef6\u7684\u540e\u9762\u3002\u8fd9\u6837\u4f1a\u964d\u4f4e\u56e0\u52a0\u8f7d JavaScript \u4ee3\u7801\u800c\u5f71\u54cd\u9875\u9762\u4e2d\u5176\u5b83\u7ec4\u4ef6\u7684\u52a0\u8f7d\u65f6\u95f4\u3002 \u4ee3\u7801\u6392\u7248 \u00b6 \u884c\u957f\u5ea6 \u00b6 \u6bcf\u884c\u4ee3\u7801\u5e94\u5c0f\u4e8e 80 \u4e2a\u5b57\u7b26 \u3002\u5982\u679c\u4ee3\u7801\u8f83\u957f\uff0c\u5e94\u5c3d\u91cf\u9009\u62e9\u6362\u884c\uff0c\u4e0b\u4e00\u884c\u4ee3\u7801\u5e94\u7f29\u8fdb8 \u4e2a\u7a7a\u683c\u3002\u8fd9\u6837\u53ef\u4ee5\u4f7f\u4ee3\u7801\u6392\u7248\u6574\u9f50\uff0c\u51cf\u8f7b\u9605\u8bfb\u4ee3\u7801\u7684\u75b2\u52b3\u611f\u3002 \u884c\u7ed3\u675f \u00b6 JavaScript \u8bed\u53e5\u5e94\u8be5\u4ee5\u5206\u53f7\u7ed3\u675f \u3002\u4f46\u5927\u591a\u6570\u6d4f\u89c8\u5668\u5141\u8bb8\u4e0d\u5199\u5206\u53f7\uff0c\u53ea\u8981\u5728\u672c\u5e94\u662f\u5206\u53f7\u7684\u5730\u65b9\u6709\u4e00\u4e2a\u6362\u884c\u7b26\u5c31\u884c\u3002\u4f46\u662f\u5982\u679c\u4ee3\u7801\u884c\u8f83\u957f\u9700\u8981\u6362\u884c\u7684\u65f6\u5019\uff0c\u6709\u54ea\u4e9b\u6ce8\u610f\u4e8b\u9879\u5462\uff1f\u6362\u884c\u5e94\u9009\u62e9\u5728\u64cd\u4f5c\u7b26\u548c\u6807\u70b9\u7b26\u53f7\u4e4b\u540e\uff0c\u6700\u597d\u662f\u5728\u9017\u53f7','\u4e4b\u540e\uff0c\u800c\u4e0d\u8981\u5728\u53d8\u91cf\u540d\u3001\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u3001\u6216')' ']' '++' '--'\u7b49\u7b26\u53f7\u4e4b\u540e\u6362\u884c\u3002 \u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u7684\u9632\u6b62\u62f7\u8d1d\u3001\u7c98\u8d34\u800c\u5f15\u8d77\u7684\u9519\u8bef\uff0c\u5e76\u53ef\u6709\u6548\u5730\u589e\u5f3a\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\u3002 \u7f29\u8fdb \u00b6 \u672c\u6587\u63d0\u5021\u7528 2\u4e2a\u7a7a\u683c \u6765\u8fdb\u884c\u7f29\u8fdb\uff0c\u5e76\u5728\u540c\u4e00\u4ea7\u54c1\u4e2d\u91c7\u7528\u540c\u4e00\u79cd\u7f29\u8fdb\u6807\u51c6\u3002\u4e0d\u652f\u6301\u7528TAB\u952e\u8fdb\u884c\u7f29\u8fdb\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f4\u5230\u73b0\u5728\u8fd8\u6ca1\u6709\u7edf\u4e00\u7684\u6807\u51c6\u6765\u5b9a\u4e49 TAB \u952e\u6240\u4ee3\u66ff\u7684\u7a7a\u767d\u5927\u5c0f\uff0c\u6709\u4e9b\u7f16\u8f91\u5668\u89e3\u6790\u4e3a 4 \u4e2a\u7a7a\u683c\u5927\u5c0f\uff0c\u6709\u4e9b\u5219\u89e3\u6790\u4e3a 8 \u4e2a\u3002 \u6ce8\u91ca \u00b6 \u5355\u884c\u6ce8\u91ca\u89c4\u8303\uff1a // Init variable count. var count = 0 ; \u4ee5\"//\"\u5f00\u5934\uff0c\u7136\u540e\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c\u7b2c\u4e00\u4e2a\u5355\u8bcd\u7684\u9996\u5b57\u6bcd\u9700\u8981\u5927\u5199\uff0c \u5f53\u7136\u8981\u662f\u4e2d\u6587\u7684\u8bdd\u5c31\u65e0\u6240\u8c13\u4e86\uff0c\u6700\u540e\u8981\u4ee5\u82f1\u6587\u53e5\u53f7\u201c.\u201d\u7ed3\u5c3e \u8fd8\u6709\u4e00\u79cd\u5757\u7ea7\u6ce8\u91ca /*....*/ \u7528\u4f5c\u5bf9\u6574\u4e2a\u4ee3\u7801\u6bb5\u7684\u6ce8\u9500\uff0c\u6216\u8f83\u6b63\u5f0f\u7684\u58f0\u660e\u4e2d\uff0c\u5982\u51fd\u6570\u53c2\u6570\u3001\u529f\u80fd\u3001\u6587\u4ef6\u529f\u80fd\u7b49\u7684\u63cf\u8ff0\u4e2d\u3002 \u6807\u8bc6\u7b26\u547d\u540d \u00b6 JavaScript \u4e2d\u7684\u6807\u8bc6\u7b26\u7684\u547d\u540d\u89c4\u5219\uff1a \u4ee5\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf _ \u6216\u7f8e\u5143\u7b26\u53f7 $ \u5f00\u5934 \u5141\u8bb8\u540d\u79f0\u4e2d\u5305\u542b\u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u4e0b\u5212\u7ebf _ \u548c\u7f8e\u5143\u7b26\u53f7 $ \u533a\u5206\u5927\u5c0f\u5199 \u53d8\u91cf\u3001\u53c2\u6570\u3001\u6210\u5458\u53d8\u91cf\u3001\u51fd\u6570\u7b49\u540d\u79f0\u5747\u4ee5\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\uff0c\u6784\u9020\u5668\u7684\u540d\u79f0\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\u3002\u4e0b\u5212\u7ebf _ \u5f00\u5934\u7684\u53d8\u91cf\u4e00\u822c\u4e60\u60ef\u4e8e\u6807\u8bc6\u79c1\u6709 / \u5c40\u90e8\u6210\u5458\u3002\u800c\u7f8e\u5143\u7b26\u53f7 $ \u5f00\u5934\u7684\u53d8\u91cf\u4e60\u60ef\u4e8e\u6807\u8bc6\u7cfb\u7edf\u76f8\u5173\uff0c\u6bd4\u5982\u7cfb\u7edf\u8fdb\u7a0b\u7b49\u3002\u5e94\u907f\u514d\u7528\u4e0b\u5212\u7ebf _ \u6216\u7f8e\u5143\u7b26\u53f7 $ \u6765\u547d\u540d\u6807\u8bc6\u7b26\u3002\u5c3d\u53ef\u80fd\u5730\u964d\u4f4e\u4ee3\u7801\u7684\u9605\u8bfb\u8d1f\u62c5\u3002 \u58f0\u660e \u00b6 \u53d8\u91cf\u7684\u58f0\u660e \u00b6 \u5c3d\u7ba1 JavaScript \u8bed\u8a00\u5e76\u4e0d\u8981\u6c42\u5728\u53d8\u91cf\u4f7f\u7528\u524d\u5148\u5bf9\u53d8\u91cf\u8fdb\u884c\u58f0\u660e\u3002\u4f46\u6211\u4eec\u8fd8\u662f\u5e94\u8be5\u517b\u6210\u8fd9\u4e2a\u597d\u4e60\u60ef\u3002\u8fd9\u6837\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u7684\u68c0\u6d4b\u51fa\u90a3\u4e9b\u672a\u7ecf\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u907f\u514d\u5176\u53d8\u4e3a\u9690\u85cf\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u9020\u6210\u9690\u60a3\u3002 \u5728\u51fd\u6570\u7684\u5f00\u59cb\u5e94\u5148\u7528 var \u5173\u952e\u5b57\u58f0\u660e\u51fd\u6570\u4e2d\u8981\u4f7f\u7528\u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u6ce8\u91ca\u53d8\u91cf\u7684\u529f\u80fd\u53ca\u4ee3\u8868\u7684\u542b\u4e49\uff0c\u4e14\u5e94\u4ee5\u5b57\u6bcd\u987a\u5e8f\u6392\u5e8f\u3002\u6bcf\u4e2a\u53d8\u91cf\u5355\u72ec\u5360\u4e00\u884c\uff0c\u4ee5\u4fbf\u6dfb\u52a0\u6ce8\u91ca\u3002\u8fd9\u662f\u56e0\u4e3a JavaScript \u4e2d\u53ea\u6709\u51fd\u6570\u7684 {} \u8868\u660e\u4f5c\u7528\u57df\uff0c\u7528 var \u5173\u952e\u5b57\u58f0\u660e\u7684\u5c40\u90e8\u53d8\u91cf\u53ea\u5728\u51fd\u6570\u5185\u6709\u6548\uff0c\u800c\u672a\u7ecf var \u58f0\u660e\u7684\u53d8\u91cf\u5219\u88ab\u89c6\u4e3a\u5168\u5c40\u53d8\u91cf\u3002\u4f8b\u5982\uff1a < script language = \"javascript\" > var valueA = 'a' ; var valueB = 'b' ; function f1 () { var valueA = 'c' ; // Output: valueA=c. alert ( 'valueA=' + valueA ); valueB = 'd' ; // Output: valueB=d. alert ( 'valueB=' + valueB ); } f1 (); // Output: valueA=a. alert ( 'valueA=' + valueA ); // Output: valueB=d. alert ( 'valueB=' + valueB ); < /script> \u4ece\u4e0a\u4f8b\u7684\u8f93\u51fa\u60ca\u5947\u5730\u53d1\u73b0\uff0c\u7528 var \u58f0\u660e\u8fc7\u7684\u53d8\u91cf valueA \u548c\u6ca1\u6709\u58f0\u660e\u7684\u53d8\u91cf valueB \u662f\u6709\u533a\u522b\u7684\u3002\u7279\u522b\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u51fd\u6570\u5185\u90e8\u7528 var \u58f0\u660e\u7684\u53d8\u91cf\u4e3a\u5c40\u90e8\u53d8\u91cf\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u5730\u907f\u514d\u56e0\u5c40\u90e8\u53d8\u91cf\u548c\u5168\u5c40\u53d8\u91cf\u540c\u540d\u800c\u4ea7\u751f\u7684\u9519\u8bef\u3002 \u51fd\u6570\u7684\u58f0\u660e \u00b6 \u51fd\u6570\u4e5f\u5e94\u5728\u8c03\u7528\u524d\u8fdb\u884c\u58f0\u660e\uff0c\u5185\u90e8\u51fd\u6570\u5e94\u5728 var \u58f0\u660e\u5185\u90e8\u53d8\u91cf\u7684\u8bed\u53e5\u4e4b\u540e\u58f0\u660e\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u8868\u660e\u5185\u90e8\u53d8\u91cf\u548c\u5185\u90e8\u51fd\u6570\u7684\u4f5c\u7528\u57df\u3002 \u6b64\u5916\uff0c\u51fd\u6570\u540d\u7d27\u63a5\u5de6\u62ec\u53f7'('\u4e4b\u95f4\uff0c\u800c\u53f3\u62ec\u53f7')'\u548c\u540e\u9762\u7684'{'\u4e4b\u95f4\u8981\u6709\u4e2a\u7a7a\u683c\uff0c\u4ee5\u6e05\u695a\u5730\u663e\u793a\u51fd\u6570\u540d\u4ee5\u5176\u53c2\u6570\u90e8\u5206\uff0c\u548c\u51fd\u6570\u4f53\u7684\u5f00\u59cb\u3002\u82e5\u51fd\u6570\u4e3a\u533f\u540d / \u65e0\u540d\u51fd\u6570\uff0c\u5219 function \u5173\u952e\u5b57\u548c\u5de6\u62ec\u53f7'('\u4e4b\u95f4\u8981\u7559\u7a7a\u683c\uff0c\u5426\u5219\u53ef\u80fd\u8bef\u8ba4\u4e3a\u8be5\u51fd\u6570\u7684\u51fd\u6570\u540d\u4e3a function\u3002 < script language = \"javascript\" > var innerA = 1 ; function outF () { var innerA = 2 ; function _inF () { alert ( 'valueA=' + innerA ); } _inF (); } // Output: valueA=2. outF (); // Error: innerF is not defined. _inF (); < /script> \u4ece\u4e0a\u9762\u4f8b\u5b50\u7684\u8f93\u51fa\u53ef\u4ee5\u770b\u51fa\uff0cinF() \u51fd\u6570\u4ec5\u5728 outF() \u51fd\u6570\u7684\u5185\u90e8\u751f\u6548\uff0c\u5c40\u90e8\u53d8\u91cf innerA \u5bf9\u5185\u90e8\u51fd\u6570\u7684\u4f5c\u7528\u57df\u751f\u6548\u3002\u8fd9\u6837\u7684\u7f16\u7801\u65b9\u5f0f\u4f7f\u5f97\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4f5c\u7528\u57df\u53d8\u5f97\u6e05\u6670\u3002 \u8bed\u53e5 \u00b6 \u5bf9\u4e8e\u7b80\u5355\u8bed\u53e5\u800c\u8a00\uff0c\u9700\u8981\u63d0\u53ca\u7684\u4ecd\u7136\u662f\u5206\u53f7\u5fc5\u8981\u6027\uff0c\u540c\u65f6\uff0c\u4e00\u884c\u6700\u591a\u6709\u4e00\u4e2a\u8bed\u53e5\u3002\u5982\u679c\u4e00\u4e2a\u8d4b\u503c\u8bed\u53e5\u662f\u7528\u51fd\u6570\u548c\u5bf9\u8c61\u6765\u8d4b\u503c\uff0c\u53ef\u80fd\u9700\u8981\u8de8\u591a\u884c\uff0c\u4e00\u5b9a\u5207\u8bb0\u8981\u5728\u8d4b\u503c\u8bed\u53e5\u672b\u52a0\u4e0a\u5206\u53f7\u3002 \u8fd9\u662f\u56e0\u4e3a JavaScript \u4e2d\uff0c\u6240\u6709\u8868\u8fbe\u5f0f\u90fd\u53ef\u4ee5\u5f53\u8bed\u53e5\uff0c\u9047\u6362\u884c\u7b26\u65f6\u4f1a\u89e3\u6790\u4e3a\u8868\u8fbe\u5f0f\u7684\u7ed3\u675f\uff0c\u6b64\u65f6\u4e0d\u89c4\u8303\u7684\u6362\u884c\u548c\u5206\u53f7\u7684\u4e22\u5931\uff0c\u53ef\u80fd\u5f15\u5165\u65b0\u7684\u9519\u8bef\u3002 \u5bf9\u4e8e\u590d\u5408\u8bed\u53e5\uff0cif, for, while, do, switch, try \u2026 catch \u7b49\u4ee3\u7801\u4f53\uff0c\u51fd\u6570\u5b9a\u4e49\u7684\u51fd\u6570\u4f53\uff0c\u5bf9\u8c61\u7684\u5b9a\u4e49\u7b49\u90fd\u9700\u8981\u653e\u5728\u82b1\u62ec\u53f7'{}'\u91cc\u9762\u3002 '{' \u5e94\u5728\u884c\u672b\uff0c\u6807\u5fd7\u4ee3\u7801\u5757\u7684\u5f00\u59cb\u3002 '}' \u5e94\u5728\u4e00\u884c\u5f00\u5934\uff0c\u6807\u5fd7\u4ee3\u7801\u5757\u7684\u7ed3\u675f\uff0c\u540c\u65f6\u9700\u8981\u548c'{'\u6240\u5728\u884c\u7684\u5f00\u59cb\u5bf9\u9f50\uff0c\u4ee5\u8868\u660e\u4e00\u4e2a\u5b8c\u6574\u7684\u590d\u5408\u8bed\u53e5\u6bb5\u3002\u8fd9\u6837\u53ef\u4ee5\u6781\u5927\u5730\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\uff0c\u63a7\u5236\u903b\u8f91\u80fd\u6e05\u6670\u5730\u8868\u73b0\u51fa\u6765\u3002 \u88ab\u5305\u542b\u7684\u4ee3\u7801\u6bb5\u5e94\u8be5\u518d\u7f29\u8fdb 2 \u4e2a\u7a7a\u683c\u3002 \u5373\u4f7f\u88ab\u5305\u542b\u7684\u4ee3\u7801\u6bb5\u53ea\u6709\u4e00\u53e5\uff0c\u4e5f\u5e94\u8be5\u7528\u82b1\u62ec\u53f7'{}'\u5305\u542b\u3002\u5c3d\u7ba1\u4e0d\u7528\u82b1\u62ec\u53f7\u4ee3\u7801\u4e5f\u4e0d\u4f1a\u9519\uff0c\u4f46\u5982\u82e5\u9700\u8981\u589e\u52a0\u8bed\u53e5\u7684\u8bdd\uff0c\u5219\u8f83\u5bb9\u6613\u56e0\u82b1\u62ec\u53f7\u9057\u6f0f\u800c\u5f15\u8d77\u7684\u7f16\u8bd1\u9519\u8bef\u6216\u903b\u8f91\u9519\u8bef\u3002 return \u8bed\u53e5\u5728\u4f7f\u7528\u65f6\u4e5f\u9700\u614e\u91cd\uff0c\u5982\u679c\u7528\u8868\u8fbe\u5f0f\u7684\u6267\u884c\u4f5c\u4e3a\u8fd4\u56de\u503c\uff0c\u8bf7\u628a\u8868\u8fbe\u5f0f\u548c return \u653e\u5728\u540c\u4e00\u884c\u4e2d\uff0c\u4ee5\u514d\u6362\u884c\u7b26\u88ab\u8bef\u89e3\u6790\u4e3a\u8bed\u53e5\u7684\u7ed3\u675f\u800c\u5f15\u8d77\u8fd4\u56de\u9519\u8bef\u3002return \u5173\u952e\u5b57\u540e\u82e5\u6ca1\u6709\u8fd4\u56de\u8868\u8fbe\u5f0f\uff0c\u5219\u8fd4\u56de undefined\u3002\u6784\u9020\u5668\u7684\u9ed8\u8ba4\u8fd4\u56de\u503c\u4e3a this\u3002 < script language = \"javascript\" > function F1 () { var valueA = 1 ; var valueB = 2 ; return valueA + valueB ; } function F2 () { var valueA = 1 ; var valueB = 2 ; return valueA + valueB ; } // Outut: 3. alert ( F1 () ); // Output: undefined. alert ( F2 () ); < /script> \u4e0a\u4f8b\u4e2d\uff0c\u56e0\u8fd4\u56de\u8868\u8fbe\u5f0f\u6ca1\u6709\u548c return \u5173\u952e\u5b57\u653e\u5728\u540c\u4e00\u884c\u800c\u5f15\u8d77\u7684\u8fd4\u56de\u9519\u8bef\uff0c\u9700\u91cd\u89c6\u3002 \u7279\u6b8a\u7b26\u53f7 \u00b6 \u7a7a\u767d\u7b26 \u00b6 \u9002\u5f53\u7684\u7a7a\u767d\u884c\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\uff0c\u53ef\u4ee5\u4f7f\u4ee3\u7801\u903b\u8f91\u66f4\u6e05\u6670\u6613\u61c2\u3002\u540c\u65f6\uff0c\u5728\u8868\u8fbe\u5f0f\u4e2d\u9002\u5f53\u7684\u7559\u7a7a\u767d\uff0c\u4e5f\u4f1a\u7ed9\u4ee3\u7801\u7684\u9605\u8bfb\u5e26\u6765\u65b9\u4fbf\u3002 \u5173\u952e\u5b57\u7684\u540e\u9762\u5982\u6709\u62ec\u53f7\uff0c\u5219\u6700\u597d\u5728\u5173\u952e\u5b57\u548c\u5de6\u62ec\u53f7'('\u4e4b\u95f4\u7559\u7a7a\u767d\uff0c\u5982 for, if, while \u7b49\u3002\u800c\u51fd\u6570\u540d\u548c\u62ec\u53f7\u4e4b\u95f4\u5219\u4e0d\u5b9c\u7559\u7a7a\u767d\uff0c\u4f46\u82e5\u662f\u533f\u540d\u51fd\u6570\uff0c\u5219\u5fc5\u987b\u5728 function \u548c\u5de6\u62ec\u53f7'('\u4e4b\u95f4\u7559\u7a7a\u767d\uff0c\u5426\u5219\uff0c\u7f16\u8f91\u5668\u4f1a\u8bef\u8ba4\u4e3a\u51fd\u6570\u540d\u4e3a function\u3002 \u5728\u8868\u8fbe\u5f0f\u4e2d\uff0c\u4e8c\u5143\u8fd0\u7b97\u7b26 ( \u9664\u5de6\u62ec\u53f7'('\uff0c\u5de6\u65b9\u62ec\u53f7'['\uff0c\u4f5c\u7528\u57df\u70b9'.') \u548c\u4e24\u4e2a\u64cd\u4f5c\u6570\u4e4b\u95f4\u6700\u597d\u7559\u7a7a\u767d\u3002\u4e00\u5143\u8fd0\u7b97\u7b26\uff08\u82e5\u4e0d\u662f\u8bcd typeof \u7b49\uff09\u548c\u5176\u64cd\u4f5c\u6570\u4e4b\u95f4\u4e0d\u5b9c\u7559\u7a7a\u767d\u3002 \u9017\u53f7','\u7684\u540e\u9762\u9700\u8981\u7559\u7a7a\u767d\uff0c\u4ee5\u663e\u793a\u660e\u786e\u7684\u53c2\u6570\u95f4\u9694\uff0c\u53d8\u91cf\u95f4\u9694\u7b49\u3002 \u5206\u53f7';'\u4e4b\u540e\u901a\u5e38\u8868\u660e\u8868\u8fbe\u8bed\u53e5\u7684\u7ed3\u675f\uff0c\u800c\u5e94\u7a7a\u884c\u3002\u5728 for \u7684\u6761\u4ef6\u8bed\u53e5\u4e2d\uff0c\u5206\u53f7\u4e4b\u540e\u5219\u5e94\u8be5\u7559\u7a7a\u767d\u3002 { } \u548c [ ] \u00b6 \u5728 JavaScript \u4e2d\uff0c\u5982\u9700\u5b9a\u4e49\u7a7a\u5bf9\u8c61\u548c\u7a7a\u6570\u7ec4\uff0c\u901a\u5e38\u5f88\u81ea\u7136\u5730\u60f3\u5230\u7528 new Object() \u548c new Array() \u7684\u65b9\u6cd5\u3002\u5176\u5b9e\u82b1\u62ec\u53f7'{}'\u548c\u65b9\u62ec\u53f7'[]'\u53ef\u4ee5\u76f4\u63a5\u7528\u6765\u5b9a\u4e49\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u548c\u4e00\u4e2a\u7a7a\u6570\u7ec4\u3002\u8fd9\u79cd\u4e66\u5199\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u4ee3\u7801\u770b\u8d77\u6765\u7b80\u5355\u6613\u61c2\u3002 == \u548c === \u00b6 \u5224\u65ad\"\u903b\u8f91\u7b49\"\u5728\u4ee3\u7801\u91cc\u592a\u5e73\u5e38\u7684\u4e0d\u8fc7\u4e8b\u60c5\u4e86\uff0c\u4f46 JavaScript \u4e0e\u5176\u4ed6\u719f\u77e5\u7684\u7f16\u7a0b\u8bed\u8a00\u4e0d\u540c\u7684\u662f\uff0c\u9664\u4e86\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u7b49\u53f7' '\u6765\u4f5c\u5224\u65ad\u4ee5\u4e3a\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e09\u4e2a\u7b49\u53f7'= '\u6765\u8fdb\u884c\u903b\u8f91\u7b49\u5224\u65ad\u3002\u4e24\u8005\u7684\u4e0d\u540c\u662f' '\u4f5c\u903b\u8f91\u7b49\u5224\u65ad\u65f6\uff0c\u4f1a\u5148\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u540e\u518d\u8fdb\u884c\u6bd4\u8f83\u3002'= '\u5219\u4e0d\u4f1a\u3002\u56e0\u800c\uff0c' '\u8fdb\u884c\u7684\u5224\u65ad\u7ed3\u679c\u53ef\u80fd\u4ea7\u751f\u504f\u5dee\u3002'!='\u4e0e'! '\u7684\u533a\u522b\u4ea6\u662f\u5982\u6b64\u3002\u672c\u6587\u63d0\u5021\u5c3d\u91cf\u4f7f\u7528'==='\u6765\u8fdb\u884c\u903b\u8f91\u7b49\u7684\u5224\u65ad\uff0c\u7528'!=='\u8fdb\u884c\u903b\u8f91\u4e0d\u7b49\u7684\u5224\u65ad\u3002 < script language = \"javascript\" > var valueA = \"1\" ; var valueB = 1 ; if ( valueA == valueB ) { alert ( \"Equal\" ); } else { alert ( \"Not equal\" ) } // Output: \"Equal\". if ( valueA === valueB ) { alert ( \"Equal\" ); } else { alert ( \"Not equal\" ) } // Output: \"Not equal\". < /script> \u4e0a\u4f8b\u4e2d\uff0cvalueA \u548c valueB \u4e24\u4e2a\u53d8\u91cf\u7684\u503c\u663e\u7136\u662f\u4e0d\u76f8\u7b49\u7684\uff0c\u8d77\u7801 valueA \u662f\u4e2a\u5b57\u7b26\u4e32\uff0c\u800c valueB \u662f\u4e00\u4e2a\u6570\u5b57\u3002\u4f46\u7528' '\u8fdb\u884c\u5224\u65ad\u662f\uff0c\u7a0b\u5e8f\u5374\u8f93\u51fa\u76f8\u7b49\u7684\u5b57\u6837\u3002\u8fd9\u662f\u56e0\u4e3a\u7f16\u8bd1\u5668\u5bf9\u4e24\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83\u65f6\uff0c\u56e0\u4e3a\u4ed6\u4eec\u7684\u7c7b\u578b\u4e0d\u540c\uff0c\u800c\u81ea\u52a8\u5730\u5c06 valueB \u8f6c\u6362\u6210\u5b57\u7b26\u4e32\uff0c\u800c\u540e\u518d\u548c valueA \u8fdb\u884c\u6bd4\u8f83\u7684\u3002\u7528'= '\u5f97\u5230\u7684\u5224\u65ad\u7ed3\u679c\u6b63\u548c\u9884\u671f\u7684\u7ed3\u679c\u76f8\u7b26\u3002 + \u00b6 \u52a0\u53f7'+'\u4e5f\u540c\u6837\u662f\u7a0b\u5e8f\u5458\u6240\u719f\u77e5\u7684\u64cd\u4f5c\u7b26\u4e4b\u4e00\u3002JavaScript \u548c\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e0d\u540c\u7684\u662f\uff0c\u5728 JavaScript \u4e2d\uff0c'+'\u9664\u4e86\u8868\u793a\u6570\u5b57\u503c\u76f8\u52a0\uff0c\u5b57\u7b26\u4e32\u76f8\u8fde\u63a5\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f5c\u4e00\u5143\u8fd0\u7b97\u7b26\u7528\uff0c\u628a\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u5b57\u3002\u56e0\u800c\u5982\u679c\u4f7f\u7528\u4e0d\u5f53\uff0c\u5219\u53ef\u80fd\u4e0e\u81ea\u589e\u7b26'++'\u6df7\u6dc6\u800c\u5f15\u8d77\u8ba1\u7b97\u9519\u8bef\u3002\u8fd9\u4e00\u70b9\uff0c\u5728\u6e05\u5355 7 \u4e2d\u53ef\u4ee5\u6e05\u695a\u5730\u770b\u51fa\u3002 < script language = \"javascript\" > var valueA = 20 ; var valueB = \"10\" ; // Ouput: 2010. alert ( valueA + valueB ); // Ouput: 30. alert ( valueA + ( + valueB )); // Ouput: 30. alert ( valueA + + valueB ); // Compile error. alert ( valueA ++ valueB ); < /script>","title":"\"drupal8 javascript\""},{"location":"drupal/drupal8/Drupal8-Javascript/#javascript","text":"\u672c\u6587\u5c31 JavaScript \u7f16\u7801\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u7684\u6392\u7248\u3001\u547d\u540d\u3001\u58f0\u660e\u3001\u4f5c\u7528\u57df\u3001\u53ca\u4e00\u4e9b\u7279\u6b8a\u7b26\u53f7\u7684\u4f7f\u7528\u7b49\u65b9\u9762\uff0c\u6839\u636e\u4e2a\u4eba\u5728\u5b66\u4e60\u5de5\u4f5c\u4e2d\u7684\u603b\u7ed3\uff0c\u7ed9\u51fa\u81ea\u5df1\u7684\u4e00\u4e9b\u5efa\u8bae\uff0c\u5e76\u5206\u6790\u5176\u4e2d\u7f18\u7531\uff0c\u4ee5\u4f9b\u53c2\u8003\u3002","title":"JavaScript \u7f16\u7801\u89c4\u8303\u5efa\u8bae"},{"location":"drupal/drupal8/Drupal8-Javascript/#javascript_1","text":"JavaScript \u7a0b\u5e8f\u5e94\u8be5\u5c3d\u91cf\u653e\u5728 .js \u7684\u6587\u4ef6\u4e2d\uff0c\u9700\u8981\u8c03\u7528\u7684\u65f6\u5019\u5728 HTML \u4e2d\u4ee5 <script src=\"filename.js\"> \u7684\u5f62\u5f0f\u5305\u542b\u8fdb\u6765\u3002JavaScript \u4ee3\u7801\u82e5\u4e0d\u662f\u8be5 HTML \u6587\u4ef6\u6240\u4e13\u7528\u7684\uff0c\u5219\u5e94\u5c3d\u91cf\u907f\u514d\u5728 HTML \u6587\u4ef6\u4e2d\u76f4\u63a5\u7f16\u5199 JavaScript \u4ee3\u7801\u3002\u56e0\u4e3a\u8fd9\u6837\u4f1a\u5927\u5927\u589e\u52a0 HTML \u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u65e0\u76ca\u4e8e\u4ee3\u7801\u7684\u538b\u7f29\u548c\u7f13\u5b58\u7684\u4f7f\u7528\u3002 \u53e6\u5916\uff0c <script src=\"filename.js\"> \u6807\u7b7e\u5e94\u5c3d\u91cf\u653e\u5728\u6587\u4ef6\u7684\u540e\u9762\u3002\u8fd9\u6837\u4f1a\u964d\u4f4e\u56e0\u52a0\u8f7d JavaScript \u4ee3\u7801\u800c\u5f71\u54cd\u9875\u9762\u4e2d\u5176\u5b83\u7ec4\u4ef6\u7684\u52a0\u8f7d\u65f6\u95f4\u3002","title":"JavaScript \u6587\u4ef6\u5f15\u7528"},{"location":"drupal/drupal8/Drupal8-Javascript/#_1","text":"","title":"\u4ee3\u7801\u6392\u7248"},{"location":"drupal/drupal8/Drupal8-Javascript/#_2","text":"\u6bcf\u884c\u4ee3\u7801\u5e94\u5c0f\u4e8e 80 \u4e2a\u5b57\u7b26 \u3002\u5982\u679c\u4ee3\u7801\u8f83\u957f\uff0c\u5e94\u5c3d\u91cf\u9009\u62e9\u6362\u884c\uff0c\u4e0b\u4e00\u884c\u4ee3\u7801\u5e94\u7f29\u8fdb8 \u4e2a\u7a7a\u683c\u3002\u8fd9\u6837\u53ef\u4ee5\u4f7f\u4ee3\u7801\u6392\u7248\u6574\u9f50\uff0c\u51cf\u8f7b\u9605\u8bfb\u4ee3\u7801\u7684\u75b2\u52b3\u611f\u3002","title":"\u884c\u957f\u5ea6"},{"location":"drupal/drupal8/Drupal8-Javascript/#_3","text":"JavaScript \u8bed\u53e5\u5e94\u8be5\u4ee5\u5206\u53f7\u7ed3\u675f \u3002\u4f46\u5927\u591a\u6570\u6d4f\u89c8\u5668\u5141\u8bb8\u4e0d\u5199\u5206\u53f7\uff0c\u53ea\u8981\u5728\u672c\u5e94\u662f\u5206\u53f7\u7684\u5730\u65b9\u6709\u4e00\u4e2a\u6362\u884c\u7b26\u5c31\u884c\u3002\u4f46\u662f\u5982\u679c\u4ee3\u7801\u884c\u8f83\u957f\u9700\u8981\u6362\u884c\u7684\u65f6\u5019\uff0c\u6709\u54ea\u4e9b\u6ce8\u610f\u4e8b\u9879\u5462\uff1f\u6362\u884c\u5e94\u9009\u62e9\u5728\u64cd\u4f5c\u7b26\u548c\u6807\u70b9\u7b26\u53f7\u4e4b\u540e\uff0c\u6700\u597d\u662f\u5728\u9017\u53f7','\u4e4b\u540e\uff0c\u800c\u4e0d\u8981\u5728\u53d8\u91cf\u540d\u3001\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u3001\u6216')' ']' '++' '--'\u7b49\u7b26\u53f7\u4e4b\u540e\u6362\u884c\u3002 \u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u7684\u9632\u6b62\u62f7\u8d1d\u3001\u7c98\u8d34\u800c\u5f15\u8d77\u7684\u9519\u8bef\uff0c\u5e76\u53ef\u6709\u6548\u5730\u589e\u5f3a\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\u3002","title":"\u884c\u7ed3\u675f"},{"location":"drupal/drupal8/Drupal8-Javascript/#_4","text":"\u672c\u6587\u63d0\u5021\u7528 2\u4e2a\u7a7a\u683c \u6765\u8fdb\u884c\u7f29\u8fdb\uff0c\u5e76\u5728\u540c\u4e00\u4ea7\u54c1\u4e2d\u91c7\u7528\u540c\u4e00\u79cd\u7f29\u8fdb\u6807\u51c6\u3002\u4e0d\u652f\u6301\u7528TAB\u952e\u8fdb\u884c\u7f29\u8fdb\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f4\u5230\u73b0\u5728\u8fd8\u6ca1\u6709\u7edf\u4e00\u7684\u6807\u51c6\u6765\u5b9a\u4e49 TAB \u952e\u6240\u4ee3\u66ff\u7684\u7a7a\u767d\u5927\u5c0f\uff0c\u6709\u4e9b\u7f16\u8f91\u5668\u89e3\u6790\u4e3a 4 \u4e2a\u7a7a\u683c\u5927\u5c0f\uff0c\u6709\u4e9b\u5219\u89e3\u6790\u4e3a 8 \u4e2a\u3002","title":"\u7f29\u8fdb"},{"location":"drupal/drupal8/Drupal8-Javascript/#_5","text":"\u5355\u884c\u6ce8\u91ca\u89c4\u8303\uff1a // Init variable count. var count = 0 ; \u4ee5\"//\"\u5f00\u5934\uff0c\u7136\u540e\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c\u7b2c\u4e00\u4e2a\u5355\u8bcd\u7684\u9996\u5b57\u6bcd\u9700\u8981\u5927\u5199\uff0c \u5f53\u7136\u8981\u662f\u4e2d\u6587\u7684\u8bdd\u5c31\u65e0\u6240\u8c13\u4e86\uff0c\u6700\u540e\u8981\u4ee5\u82f1\u6587\u53e5\u53f7\u201c.\u201d\u7ed3\u5c3e \u8fd8\u6709\u4e00\u79cd\u5757\u7ea7\u6ce8\u91ca /*....*/ \u7528\u4f5c\u5bf9\u6574\u4e2a\u4ee3\u7801\u6bb5\u7684\u6ce8\u9500\uff0c\u6216\u8f83\u6b63\u5f0f\u7684\u58f0\u660e\u4e2d\uff0c\u5982\u51fd\u6570\u53c2\u6570\u3001\u529f\u80fd\u3001\u6587\u4ef6\u529f\u80fd\u7b49\u7684\u63cf\u8ff0\u4e2d\u3002","title":"\u6ce8\u91ca"},{"location":"drupal/drupal8/Drupal8-Javascript/#_6","text":"JavaScript \u4e2d\u7684\u6807\u8bc6\u7b26\u7684\u547d\u540d\u89c4\u5219\uff1a \u4ee5\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf _ \u6216\u7f8e\u5143\u7b26\u53f7 $ \u5f00\u5934 \u5141\u8bb8\u540d\u79f0\u4e2d\u5305\u542b\u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u4e0b\u5212\u7ebf _ \u548c\u7f8e\u5143\u7b26\u53f7 $ \u533a\u5206\u5927\u5c0f\u5199 \u53d8\u91cf\u3001\u53c2\u6570\u3001\u6210\u5458\u53d8\u91cf\u3001\u51fd\u6570\u7b49\u540d\u79f0\u5747\u4ee5\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\uff0c\u6784\u9020\u5668\u7684\u540d\u79f0\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\u3002\u4e0b\u5212\u7ebf _ \u5f00\u5934\u7684\u53d8\u91cf\u4e00\u822c\u4e60\u60ef\u4e8e\u6807\u8bc6\u79c1\u6709 / \u5c40\u90e8\u6210\u5458\u3002\u800c\u7f8e\u5143\u7b26\u53f7 $ \u5f00\u5934\u7684\u53d8\u91cf\u4e60\u60ef\u4e8e\u6807\u8bc6\u7cfb\u7edf\u76f8\u5173\uff0c\u6bd4\u5982\u7cfb\u7edf\u8fdb\u7a0b\u7b49\u3002\u5e94\u907f\u514d\u7528\u4e0b\u5212\u7ebf _ \u6216\u7f8e\u5143\u7b26\u53f7 $ \u6765\u547d\u540d\u6807\u8bc6\u7b26\u3002\u5c3d\u53ef\u80fd\u5730\u964d\u4f4e\u4ee3\u7801\u7684\u9605\u8bfb\u8d1f\u62c5\u3002","title":"\u6807\u8bc6\u7b26\u547d\u540d"},{"location":"drupal/drupal8/Drupal8-Javascript/#_7","text":"","title":"\u58f0\u660e"},{"location":"drupal/drupal8/Drupal8-Javascript/#_8","text":"\u5c3d\u7ba1 JavaScript \u8bed\u8a00\u5e76\u4e0d\u8981\u6c42\u5728\u53d8\u91cf\u4f7f\u7528\u524d\u5148\u5bf9\u53d8\u91cf\u8fdb\u884c\u58f0\u660e\u3002\u4f46\u6211\u4eec\u8fd8\u662f\u5e94\u8be5\u517b\u6210\u8fd9\u4e2a\u597d\u4e60\u60ef\u3002\u8fd9\u6837\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u7684\u68c0\u6d4b\u51fa\u90a3\u4e9b\u672a\u7ecf\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u907f\u514d\u5176\u53d8\u4e3a\u9690\u85cf\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u9020\u6210\u9690\u60a3\u3002 \u5728\u51fd\u6570\u7684\u5f00\u59cb\u5e94\u5148\u7528 var \u5173\u952e\u5b57\u58f0\u660e\u51fd\u6570\u4e2d\u8981\u4f7f\u7528\u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u6ce8\u91ca\u53d8\u91cf\u7684\u529f\u80fd\u53ca\u4ee3\u8868\u7684\u542b\u4e49\uff0c\u4e14\u5e94\u4ee5\u5b57\u6bcd\u987a\u5e8f\u6392\u5e8f\u3002\u6bcf\u4e2a\u53d8\u91cf\u5355\u72ec\u5360\u4e00\u884c\uff0c\u4ee5\u4fbf\u6dfb\u52a0\u6ce8\u91ca\u3002\u8fd9\u662f\u56e0\u4e3a JavaScript \u4e2d\u53ea\u6709\u51fd\u6570\u7684 {} \u8868\u660e\u4f5c\u7528\u57df\uff0c\u7528 var \u5173\u952e\u5b57\u58f0\u660e\u7684\u5c40\u90e8\u53d8\u91cf\u53ea\u5728\u51fd\u6570\u5185\u6709\u6548\uff0c\u800c\u672a\u7ecf var \u58f0\u660e\u7684\u53d8\u91cf\u5219\u88ab\u89c6\u4e3a\u5168\u5c40\u53d8\u91cf\u3002\u4f8b\u5982\uff1a < script language = \"javascript\" > var valueA = 'a' ; var valueB = 'b' ; function f1 () { var valueA = 'c' ; // Output: valueA=c. alert ( 'valueA=' + valueA ); valueB = 'd' ; // Output: valueB=d. alert ( 'valueB=' + valueB ); } f1 (); // Output: valueA=a. alert ( 'valueA=' + valueA ); // Output: valueB=d. alert ( 'valueB=' + valueB ); < /script> \u4ece\u4e0a\u4f8b\u7684\u8f93\u51fa\u60ca\u5947\u5730\u53d1\u73b0\uff0c\u7528 var \u58f0\u660e\u8fc7\u7684\u53d8\u91cf valueA \u548c\u6ca1\u6709\u58f0\u660e\u7684\u53d8\u91cf valueB \u662f\u6709\u533a\u522b\u7684\u3002\u7279\u522b\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u51fd\u6570\u5185\u90e8\u7528 var \u58f0\u660e\u7684\u53d8\u91cf\u4e3a\u5c40\u90e8\u53d8\u91cf\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u5730\u907f\u514d\u56e0\u5c40\u90e8\u53d8\u91cf\u548c\u5168\u5c40\u53d8\u91cf\u540c\u540d\u800c\u4ea7\u751f\u7684\u9519\u8bef\u3002","title":"\u53d8\u91cf\u7684\u58f0\u660e"},{"location":"drupal/drupal8/Drupal8-Javascript/#_9","text":"\u51fd\u6570\u4e5f\u5e94\u5728\u8c03\u7528\u524d\u8fdb\u884c\u58f0\u660e\uff0c\u5185\u90e8\u51fd\u6570\u5e94\u5728 var \u58f0\u660e\u5185\u90e8\u53d8\u91cf\u7684\u8bed\u53e5\u4e4b\u540e\u58f0\u660e\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u8868\u660e\u5185\u90e8\u53d8\u91cf\u548c\u5185\u90e8\u51fd\u6570\u7684\u4f5c\u7528\u57df\u3002 \u6b64\u5916\uff0c\u51fd\u6570\u540d\u7d27\u63a5\u5de6\u62ec\u53f7'('\u4e4b\u95f4\uff0c\u800c\u53f3\u62ec\u53f7')'\u548c\u540e\u9762\u7684'{'\u4e4b\u95f4\u8981\u6709\u4e2a\u7a7a\u683c\uff0c\u4ee5\u6e05\u695a\u5730\u663e\u793a\u51fd\u6570\u540d\u4ee5\u5176\u53c2\u6570\u90e8\u5206\uff0c\u548c\u51fd\u6570\u4f53\u7684\u5f00\u59cb\u3002\u82e5\u51fd\u6570\u4e3a\u533f\u540d / \u65e0\u540d\u51fd\u6570\uff0c\u5219 function \u5173\u952e\u5b57\u548c\u5de6\u62ec\u53f7'('\u4e4b\u95f4\u8981\u7559\u7a7a\u683c\uff0c\u5426\u5219\u53ef\u80fd\u8bef\u8ba4\u4e3a\u8be5\u51fd\u6570\u7684\u51fd\u6570\u540d\u4e3a function\u3002 < script language = \"javascript\" > var innerA = 1 ; function outF () { var innerA = 2 ; function _inF () { alert ( 'valueA=' + innerA ); } _inF (); } // Output: valueA=2. outF (); // Error: innerF is not defined. _inF (); < /script> \u4ece\u4e0a\u9762\u4f8b\u5b50\u7684\u8f93\u51fa\u53ef\u4ee5\u770b\u51fa\uff0cinF() \u51fd\u6570\u4ec5\u5728 outF() \u51fd\u6570\u7684\u5185\u90e8\u751f\u6548\uff0c\u5c40\u90e8\u53d8\u91cf innerA \u5bf9\u5185\u90e8\u51fd\u6570\u7684\u4f5c\u7528\u57df\u751f\u6548\u3002\u8fd9\u6837\u7684\u7f16\u7801\u65b9\u5f0f\u4f7f\u5f97\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4f5c\u7528\u57df\u53d8\u5f97\u6e05\u6670\u3002","title":"\u51fd\u6570\u7684\u58f0\u660e"},{"location":"drupal/drupal8/Drupal8-Javascript/#_10","text":"\u5bf9\u4e8e\u7b80\u5355\u8bed\u53e5\u800c\u8a00\uff0c\u9700\u8981\u63d0\u53ca\u7684\u4ecd\u7136\u662f\u5206\u53f7\u5fc5\u8981\u6027\uff0c\u540c\u65f6\uff0c\u4e00\u884c\u6700\u591a\u6709\u4e00\u4e2a\u8bed\u53e5\u3002\u5982\u679c\u4e00\u4e2a\u8d4b\u503c\u8bed\u53e5\u662f\u7528\u51fd\u6570\u548c\u5bf9\u8c61\u6765\u8d4b\u503c\uff0c\u53ef\u80fd\u9700\u8981\u8de8\u591a\u884c\uff0c\u4e00\u5b9a\u5207\u8bb0\u8981\u5728\u8d4b\u503c\u8bed\u53e5\u672b\u52a0\u4e0a\u5206\u53f7\u3002 \u8fd9\u662f\u56e0\u4e3a JavaScript \u4e2d\uff0c\u6240\u6709\u8868\u8fbe\u5f0f\u90fd\u53ef\u4ee5\u5f53\u8bed\u53e5\uff0c\u9047\u6362\u884c\u7b26\u65f6\u4f1a\u89e3\u6790\u4e3a\u8868\u8fbe\u5f0f\u7684\u7ed3\u675f\uff0c\u6b64\u65f6\u4e0d\u89c4\u8303\u7684\u6362\u884c\u548c\u5206\u53f7\u7684\u4e22\u5931\uff0c\u53ef\u80fd\u5f15\u5165\u65b0\u7684\u9519\u8bef\u3002 \u5bf9\u4e8e\u590d\u5408\u8bed\u53e5\uff0cif, for, while, do, switch, try \u2026 catch \u7b49\u4ee3\u7801\u4f53\uff0c\u51fd\u6570\u5b9a\u4e49\u7684\u51fd\u6570\u4f53\uff0c\u5bf9\u8c61\u7684\u5b9a\u4e49\u7b49\u90fd\u9700\u8981\u653e\u5728\u82b1\u62ec\u53f7'{}'\u91cc\u9762\u3002 '{' \u5e94\u5728\u884c\u672b\uff0c\u6807\u5fd7\u4ee3\u7801\u5757\u7684\u5f00\u59cb\u3002 '}' \u5e94\u5728\u4e00\u884c\u5f00\u5934\uff0c\u6807\u5fd7\u4ee3\u7801\u5757\u7684\u7ed3\u675f\uff0c\u540c\u65f6\u9700\u8981\u548c'{'\u6240\u5728\u884c\u7684\u5f00\u59cb\u5bf9\u9f50\uff0c\u4ee5\u8868\u660e\u4e00\u4e2a\u5b8c\u6574\u7684\u590d\u5408\u8bed\u53e5\u6bb5\u3002\u8fd9\u6837\u53ef\u4ee5\u6781\u5927\u5730\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\uff0c\u63a7\u5236\u903b\u8f91\u80fd\u6e05\u6670\u5730\u8868\u73b0\u51fa\u6765\u3002 \u88ab\u5305\u542b\u7684\u4ee3\u7801\u6bb5\u5e94\u8be5\u518d\u7f29\u8fdb 2 \u4e2a\u7a7a\u683c\u3002 \u5373\u4f7f\u88ab\u5305\u542b\u7684\u4ee3\u7801\u6bb5\u53ea\u6709\u4e00\u53e5\uff0c\u4e5f\u5e94\u8be5\u7528\u82b1\u62ec\u53f7'{}'\u5305\u542b\u3002\u5c3d\u7ba1\u4e0d\u7528\u82b1\u62ec\u53f7\u4ee3\u7801\u4e5f\u4e0d\u4f1a\u9519\uff0c\u4f46\u5982\u82e5\u9700\u8981\u589e\u52a0\u8bed\u53e5\u7684\u8bdd\uff0c\u5219\u8f83\u5bb9\u6613\u56e0\u82b1\u62ec\u53f7\u9057\u6f0f\u800c\u5f15\u8d77\u7684\u7f16\u8bd1\u9519\u8bef\u6216\u903b\u8f91\u9519\u8bef\u3002 return \u8bed\u53e5\u5728\u4f7f\u7528\u65f6\u4e5f\u9700\u614e\u91cd\uff0c\u5982\u679c\u7528\u8868\u8fbe\u5f0f\u7684\u6267\u884c\u4f5c\u4e3a\u8fd4\u56de\u503c\uff0c\u8bf7\u628a\u8868\u8fbe\u5f0f\u548c return \u653e\u5728\u540c\u4e00\u884c\u4e2d\uff0c\u4ee5\u514d\u6362\u884c\u7b26\u88ab\u8bef\u89e3\u6790\u4e3a\u8bed\u53e5\u7684\u7ed3\u675f\u800c\u5f15\u8d77\u8fd4\u56de\u9519\u8bef\u3002return \u5173\u952e\u5b57\u540e\u82e5\u6ca1\u6709\u8fd4\u56de\u8868\u8fbe\u5f0f\uff0c\u5219\u8fd4\u56de undefined\u3002\u6784\u9020\u5668\u7684\u9ed8\u8ba4\u8fd4\u56de\u503c\u4e3a this\u3002 < script language = \"javascript\" > function F1 () { var valueA = 1 ; var valueB = 2 ; return valueA + valueB ; } function F2 () { var valueA = 1 ; var valueB = 2 ; return valueA + valueB ; } // Outut: 3. alert ( F1 () ); // Output: undefined. alert ( F2 () ); < /script> \u4e0a\u4f8b\u4e2d\uff0c\u56e0\u8fd4\u56de\u8868\u8fbe\u5f0f\u6ca1\u6709\u548c return \u5173\u952e\u5b57\u653e\u5728\u540c\u4e00\u884c\u800c\u5f15\u8d77\u7684\u8fd4\u56de\u9519\u8bef\uff0c\u9700\u91cd\u89c6\u3002","title":"\u8bed\u53e5"},{"location":"drupal/drupal8/Drupal8-Javascript/#_11","text":"","title":"\u7279\u6b8a\u7b26\u53f7"},{"location":"drupal/drupal8/Drupal8-Javascript/#_12","text":"\u9002\u5f53\u7684\u7a7a\u767d\u884c\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\uff0c\u53ef\u4ee5\u4f7f\u4ee3\u7801\u903b\u8f91\u66f4\u6e05\u6670\u6613\u61c2\u3002\u540c\u65f6\uff0c\u5728\u8868\u8fbe\u5f0f\u4e2d\u9002\u5f53\u7684\u7559\u7a7a\u767d\uff0c\u4e5f\u4f1a\u7ed9\u4ee3\u7801\u7684\u9605\u8bfb\u5e26\u6765\u65b9\u4fbf\u3002 \u5173\u952e\u5b57\u7684\u540e\u9762\u5982\u6709\u62ec\u53f7\uff0c\u5219\u6700\u597d\u5728\u5173\u952e\u5b57\u548c\u5de6\u62ec\u53f7'('\u4e4b\u95f4\u7559\u7a7a\u767d\uff0c\u5982 for, if, while \u7b49\u3002\u800c\u51fd\u6570\u540d\u548c\u62ec\u53f7\u4e4b\u95f4\u5219\u4e0d\u5b9c\u7559\u7a7a\u767d\uff0c\u4f46\u82e5\u662f\u533f\u540d\u51fd\u6570\uff0c\u5219\u5fc5\u987b\u5728 function \u548c\u5de6\u62ec\u53f7'('\u4e4b\u95f4\u7559\u7a7a\u767d\uff0c\u5426\u5219\uff0c\u7f16\u8f91\u5668\u4f1a\u8bef\u8ba4\u4e3a\u51fd\u6570\u540d\u4e3a function\u3002 \u5728\u8868\u8fbe\u5f0f\u4e2d\uff0c\u4e8c\u5143\u8fd0\u7b97\u7b26 ( \u9664\u5de6\u62ec\u53f7'('\uff0c\u5de6\u65b9\u62ec\u53f7'['\uff0c\u4f5c\u7528\u57df\u70b9'.') \u548c\u4e24\u4e2a\u64cd\u4f5c\u6570\u4e4b\u95f4\u6700\u597d\u7559\u7a7a\u767d\u3002\u4e00\u5143\u8fd0\u7b97\u7b26\uff08\u82e5\u4e0d\u662f\u8bcd typeof \u7b49\uff09\u548c\u5176\u64cd\u4f5c\u6570\u4e4b\u95f4\u4e0d\u5b9c\u7559\u7a7a\u767d\u3002 \u9017\u53f7','\u7684\u540e\u9762\u9700\u8981\u7559\u7a7a\u767d\uff0c\u4ee5\u663e\u793a\u660e\u786e\u7684\u53c2\u6570\u95f4\u9694\uff0c\u53d8\u91cf\u95f4\u9694\u7b49\u3002 \u5206\u53f7';'\u4e4b\u540e\u901a\u5e38\u8868\u660e\u8868\u8fbe\u8bed\u53e5\u7684\u7ed3\u675f\uff0c\u800c\u5e94\u7a7a\u884c\u3002\u5728 for \u7684\u6761\u4ef6\u8bed\u53e5\u4e2d\uff0c\u5206\u53f7\u4e4b\u540e\u5219\u5e94\u8be5\u7559\u7a7a\u767d\u3002","title":"\u7a7a\u767d\u7b26"},{"location":"drupal/drupal8/Drupal8-Javascript/#_13","text":"\u5728 JavaScript \u4e2d\uff0c\u5982\u9700\u5b9a\u4e49\u7a7a\u5bf9\u8c61\u548c\u7a7a\u6570\u7ec4\uff0c\u901a\u5e38\u5f88\u81ea\u7136\u5730\u60f3\u5230\u7528 new Object() \u548c new Array() \u7684\u65b9\u6cd5\u3002\u5176\u5b9e\u82b1\u62ec\u53f7'{}'\u548c\u65b9\u62ec\u53f7'[]'\u53ef\u4ee5\u76f4\u63a5\u7528\u6765\u5b9a\u4e49\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u548c\u4e00\u4e2a\u7a7a\u6570\u7ec4\u3002\u8fd9\u79cd\u4e66\u5199\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u4ee3\u7801\u770b\u8d77\u6765\u7b80\u5355\u6613\u61c2\u3002","title":"{ } \u548c [ ]"},{"location":"drupal/drupal8/Drupal8-Javascript/#_14","text":"\u5224\u65ad\"\u903b\u8f91\u7b49\"\u5728\u4ee3\u7801\u91cc\u592a\u5e73\u5e38\u7684\u4e0d\u8fc7\u4e8b\u60c5\u4e86\uff0c\u4f46 JavaScript \u4e0e\u5176\u4ed6\u719f\u77e5\u7684\u7f16\u7a0b\u8bed\u8a00\u4e0d\u540c\u7684\u662f\uff0c\u9664\u4e86\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u7b49\u53f7' '\u6765\u4f5c\u5224\u65ad\u4ee5\u4e3a\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e09\u4e2a\u7b49\u53f7'= '\u6765\u8fdb\u884c\u903b\u8f91\u7b49\u5224\u65ad\u3002\u4e24\u8005\u7684\u4e0d\u540c\u662f' '\u4f5c\u903b\u8f91\u7b49\u5224\u65ad\u65f6\uff0c\u4f1a\u5148\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u540e\u518d\u8fdb\u884c\u6bd4\u8f83\u3002'= '\u5219\u4e0d\u4f1a\u3002\u56e0\u800c\uff0c' '\u8fdb\u884c\u7684\u5224\u65ad\u7ed3\u679c\u53ef\u80fd\u4ea7\u751f\u504f\u5dee\u3002'!='\u4e0e'! '\u7684\u533a\u522b\u4ea6\u662f\u5982\u6b64\u3002\u672c\u6587\u63d0\u5021\u5c3d\u91cf\u4f7f\u7528'==='\u6765\u8fdb\u884c\u903b\u8f91\u7b49\u7684\u5224\u65ad\uff0c\u7528'!=='\u8fdb\u884c\u903b\u8f91\u4e0d\u7b49\u7684\u5224\u65ad\u3002 < script language = \"javascript\" > var valueA = \"1\" ; var valueB = 1 ; if ( valueA == valueB ) { alert ( \"Equal\" ); } else { alert ( \"Not equal\" ) } // Output: \"Equal\". if ( valueA === valueB ) { alert ( \"Equal\" ); } else { alert ( \"Not equal\" ) } // Output: \"Not equal\". < /script> \u4e0a\u4f8b\u4e2d\uff0cvalueA \u548c valueB \u4e24\u4e2a\u53d8\u91cf\u7684\u503c\u663e\u7136\u662f\u4e0d\u76f8\u7b49\u7684\uff0c\u8d77\u7801 valueA \u662f\u4e2a\u5b57\u7b26\u4e32\uff0c\u800c valueB \u662f\u4e00\u4e2a\u6570\u5b57\u3002\u4f46\u7528' '\u8fdb\u884c\u5224\u65ad\u662f\uff0c\u7a0b\u5e8f\u5374\u8f93\u51fa\u76f8\u7b49\u7684\u5b57\u6837\u3002\u8fd9\u662f\u56e0\u4e3a\u7f16\u8bd1\u5668\u5bf9\u4e24\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83\u65f6\uff0c\u56e0\u4e3a\u4ed6\u4eec\u7684\u7c7b\u578b\u4e0d\u540c\uff0c\u800c\u81ea\u52a8\u5730\u5c06 valueB \u8f6c\u6362\u6210\u5b57\u7b26\u4e32\uff0c\u800c\u540e\u518d\u548c valueA \u8fdb\u884c\u6bd4\u8f83\u7684\u3002\u7528'= '\u5f97\u5230\u7684\u5224\u65ad\u7ed3\u679c\u6b63\u548c\u9884\u671f\u7684\u7ed3\u679c\u76f8\u7b26\u3002","title":"== \u548c ==="},{"location":"drupal/drupal8/Drupal8-Javascript/#_15","text":"\u52a0\u53f7'+'\u4e5f\u540c\u6837\u662f\u7a0b\u5e8f\u5458\u6240\u719f\u77e5\u7684\u64cd\u4f5c\u7b26\u4e4b\u4e00\u3002JavaScript \u548c\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e0d\u540c\u7684\u662f\uff0c\u5728 JavaScript \u4e2d\uff0c'+'\u9664\u4e86\u8868\u793a\u6570\u5b57\u503c\u76f8\u52a0\uff0c\u5b57\u7b26\u4e32\u76f8\u8fde\u63a5\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f5c\u4e00\u5143\u8fd0\u7b97\u7b26\u7528\uff0c\u628a\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u5b57\u3002\u56e0\u800c\u5982\u679c\u4f7f\u7528\u4e0d\u5f53\uff0c\u5219\u53ef\u80fd\u4e0e\u81ea\u589e\u7b26'++'\u6df7\u6dc6\u800c\u5f15\u8d77\u8ba1\u7b97\u9519\u8bef\u3002\u8fd9\u4e00\u70b9\uff0c\u5728\u6e05\u5355 7 \u4e2d\u53ef\u4ee5\u6e05\u695a\u5730\u770b\u51fa\u3002 < script language = \"javascript\" > var valueA = 20 ; var valueB = \"10\" ; // Ouput: 2010. alert ( valueA + valueB ); // Ouput: 30. alert ( valueA + ( + valueB )); // Ouput: 30. alert ( valueA + + valueB ); // Compile error. alert ( valueA ++ valueB ); < /script>","title":"+"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/","tags":"[Service_DependencyInjection]","text":"\u5148\u6765\u8ba4\u8bc6\u51e0\u4e2a\u540d\u8bcd\uff1a 1\u3001Service Drupal8\u7684service\u5e2e\u52a9\u4ee3\u7801\u53bb\u8026\u5408\uff0c\u63d0\u9ad8\u91cd\u590d\u5229\u7528\u3002\u6bd4\u5982\u64cd\u4f5c\u6570\u636e\u5e93\uff0c\u53d1\u9001mail\u7b49\u3002\u4e00\u822c\u6765\u8bf4\uff0cservice\u662f\u4e00\u4e2aPHP\u7c7b\uff0c\u5305\u542b\u4e86\u4e00\u4e9b\u5168\u5c40\u7684\u65b9\u6cd5\u3002 2\u3001Service Container Service Container\u7528\u6765\u7ba1\u7406service\u3002service\u7684\u7c7b\u4f1a\u88ab\u6ce8\u518c\u5728container\u4e2d\uff0c\u6765\u63a7\u5236\u8bbf\u95ee\u6743\u9650\u3002\u5728\u81ea\u5b9a\u4e49\u6a21\u5757\u4e2d\uff0c\u53ef\u4ee5\u7528module_name.services.yml\u6765\u5b9e\u4f8b\u5316services\uff0c\u8fdb\u800c\u4fdd\u5b58\u8fdbcontainer\u5bf9\u8c61\u4e2d\u3002 3\u3001Dependency Injection \u5982\u679c\u8981\u4f20\u9012\u5bf9\u8c61\u7ed9\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e00\u822c\u7528Dependency Injection\u6765\u53bb\u8026\u3002\u7b80\u5355\u70b9\u8bf4\uff0c\u4e00\u4e2aservice\u53ea\u5904\u7406\u4e00\u4ef6\u4e8b\u60c5\uff0c\u5982\u679c\u5b83\u8981\u8c03\u7528\u53e6\u5916\u4e00\u4e2aservice\uff0c\u90a3\u4e48\u540e\u9762\u7684\u8fd9\u4e2aservice\u53ef\u4ee5\u6ce8\u5165\u5230\u524d\u9762\u7684service\u4e2d\u3002 \u4e0b\u6587\u6211\u4eec\u4ee5service\u8868\u793aService\uff0ccontainer\u8868\u793aService Container\uff0cDI\u8868\u793aDependency Injection\u3002 \u4e00\u3001core services \u00b6 Drupal8\u7684\u6838\u5fc3servive\u90fd\u5728 core.services.yml \u4e2d\u3002 \u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5728module_name.services.yml\u4e2d\u81ea\u5b9a\u4e49service\u3002 *.services.yml\u7684\u5199\u6cd5\u5982\uff1a path.alias_manager: class: Drupal\\Core\\Path\\AliasManager arguments: ['@path.crud', '@path.alias_whitelist', '@language_manager'] breadcrumb: class: Drupal\\Core\\Breadcrumb\\BreadcrumbManager arguments: ['@module_handler'] \u5982\u8981\u628a\u522b\u7684service\u5f53\u4f5c\u5de5\u5382\u4f7f\u7528\uff0c\u5199\u6cd5\u5982\u4e0b\uff1a cache.entity: class: Drupal\\Core\\Cache\\CacheBackendInterface tags: - { name: cache.bin } factory: cache_factory:get arguments: [entity] 1\u3001\u7b2c\u4e00\u884c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u552f\u4e00\u7684service\u540d\u79f0\uff0c\u5982\u679c\u662f\u81ea\u5b9a\u4e49\u7684\u6a21\u5757\uff0c\u5fc5\u987b\u4ee5\u6a21\u5757\u540d\u4f5c\u4e3a\u524d\u7f00\u3002 2\u3001\u7b2c\u4e8c\u884c\u5b9a\u4e49\u4e86\u9ed8\u8ba4\u8c03\u7528\u7684\u7c7b\u3001\u5de5\u5382\u7c7b\u3001\u63a5\u53e3\u7c7b\u7b49\u3002 3\u3001arguments\u5e26@\u8868\u793a\u4f9d\u8d56\u4e8e\u8be5service\u3002 4\u3001factory\u8868\u793a\u8c03\u7528\u54ea\u4e2a\u5de5\u5382\u65b9\u6cd5\u3002 5\u3001tags\u6807\u7b7e\u5b9a\u4e49\u4e86\u4e00\u7ec4\u5173\u8054\u7684service\uff0c\u6216\u6307\u5b9a\u5177\u6709\u67d0\u4e9b\u76f8\u4f3c\u7279\u6027\u7684service\u3002\u5982\u679c\u5b9a\u4e49\u4e86service\u6807\u7b7e\uff0c\u5728service\u7c7b\u4e2d\u5fc5\u987b\u5b9e\u73b0\u76f8\u5e94\u7684\u63a5\u53e3\uff0c\u5982\uff1a > access_check: \u6807\u660e\u8def\u7531\u8bbf\u95ee\u68c0\u67e5service > cache.bin: \u6807\u660ecache bin service > event_subscriber: \u6807\u660e\u4e00\u4e2a\u4e8b\u4ef6\u8ba2\u9605service\u3002 > needs_destruction: \u6807\u660e\u4e00\u4e2adestructor()\u65b9\u6cd5\uff0c\u901a\u5e38\u88ab\u8c03\u7528\u4e8e\u4e00\u4e2a\u8bf7\u6c42\u5b8c\u6210\u65f6\u3002 > context_provice: \u6807\u660e\u4e00\u4e2ablock\u4e0a\u4e0b\u6587\u63d0\u4f9b\u8005\u3002 > http_client_middleware: \u6807\u660e\u8be5service\u63d0\u4f9b\u8005\u662f\u4e00\u4e2aguzzle\u4e2d\u95f4\u4ef6\u3002 \u4e8c\u3001\u8bbf\u95eeservice \u00b6 1\u3001\u5168\u5c40\u51fd\u6570(global functions) \u00b6 Drupal8\u7684\u5168\u5c40\u7c7b\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9759\u6001\u65b9\u6cd5\u53bb\u8bbf\u95ee\u4e00\u4e9b\u901a\u7528\u7684service\u3002\u5982Drupal::moduleHandler()\u5c06\u8fd4\u56de\u6a21\u5757\u5904\u7406service\uff0cDrupal.translation()\u5c06\u8fd4\u56de\u7ffb\u8bd1service\u3002\u7528 Drupal::service()\u53ef\u4ee5\u83b7\u53d6\u6240\u6709\u5df2\u7ecf\u5b9a\u4e49\u7684service\u3002 \u5982\uff1a\u8bbf\u95ee\u4e00\u4e2a\u6570\u636e\u5e93service <?php // Returns a Drupal\\Core\\Database\\Connection object. $connection = \\Drupal :: database (); $result = $connection -> select ( 'node' , 'n' ) -> fields ( 'n' , array ( 'nid' )) -> execute (); ?> \u5982\uff1a\u901a\u8fc7\\Drupal::service()\u8bbf\u95ee\u4e00\u4e2adate service <?php // Returns a Drupal\\Core\\Datetime\\Date object. $date = \\Drupal :: service ( 'date' ); ?> \u5982\uff1a\u81ea\u5b9a\u4e49\u7684demo\u6a21\u5757 2\u3001\u521b\u5efademo.services.yml \u00b6 services: demo.demo_service: class: Drupal\\demo\\DemoService 3\u3001\u5728src\u76ee\u5f55\u4e0b\u521b\u5efaDemoService.php \u00b6 <?php /** * @file * Contains Drupal\\demo\\DemoService. */ namespace Drupal\\demo ; class DemoService { protected $demo_value ; public function __construct () { $this -> demo_value = 'Upchuk' ; } public function getDemoValue () { return $this -> demo_value ; } } ?> \u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837\u8bbf\u95eedemo service $service = \\Drupal::service('demo.demo_service'); 4\u3001\u91cd\u5199\u9ed8\u8ba4service \u00b6 Drupal8\u5141\u8bb8\u5728\u81ea\u5b9a\u4e49\u7684\u6a21\u5757\u4e2d\u91cd\u5199\u5df2\u5b58\u5728\u7684service\u3002\u5982\u81ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3ademo\u7684\u6a21\u5757\u3002 1)\u3001\u5728demo\u7684src\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aDemoServiceProvider.php\u6587\u4ef6\u3002 2)\u3001DemoServiceProvider\u5fc5\u987b\u5b9e\u73b0 \\Drupal\\Core\\DependencyInjection\\ServiceModifierInterface . 3)\u3001\u8fd9\u4e2a\u7c7b\u5fc5\u987b\u5305\u542b\u4e00\u4e2a\u65b9\u6cd5\uff1aalter()\u3002\u8fd9\u4e2a\u65b9\u6cd5\u662f\u544a\u8bc9Drupal\u7528\u4f60\u7684\u7c7b\u6765\u66ff\u4ee3\u9ed8\u8ba4\u7684\u7c7b\u3002\u5982\uff1a public function alter(ContainerBuilder $container) { // Override the language_manager class with a new class. $definition = $container->getDefinition('language_manager'); $definition->setClass('Drupal\\my_module\\MyLanguageManager'); } \u4e09\u3001\u901a\u8fc7DI\u8bbf\u95eeservice \u00b6 \u8fd9\u5757\u6bd4\u8f83\u91cd\u8981\uff0c\u5355\u72ec\u6765\u8bb2\u4e00\u4e0b\u3002\u8fd8\u662f\u4ee5demo\u6a21\u5757\u4e3a\u4f8b\u3002 1\u3001\u521b\u5efademo.services.yml \u00b6 services: demo.demo_service: class: Drupal\\demo\\DemoService 2\u3001\u5728src\u76ee\u5f55\u4e0b\u521b\u5efaDemoService.php \u00b6 <?php /** * @file * Contains Drupal\\demo\\DemoService. */ namespace Drupal\\demo ; class DemoService { protected $demo_value ; public function __construct () { $this -> demo_value = 'Upchuk' ; } public function getDemoValue () { return $this -> demo_value ; } } ?> 3\u3001\u521b\u5efademo.routing.yml \u00b6 demo.demo: path: '/demo' defaults: _controller: '\\Drupal\\demo\\Controller\\DemoController:demo' requirements: _permission: 'access content' 4\u3001\u5728src/Controller\u76ee\u5f55\u4e0b\u521b\u5efaDemoController.php \u00b6 <?php /** * @file * Contains \\Drupal\\demo\\Controller\\DemoController. */ namespace Drupal\\demo\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; /** * DemoController. */ class DemoController extends ControllerBase { protected $demoService ; /** * Class constructor. */ public function __construct ( $demoService ) { $this -> demoService = $demoService ; } /** * {@inheritdoc} */ public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'demo.demo_service' ) ); } /** * Generates an example page. */ public function demo () { return array ( '#markup' => t ( 'Hello @value!' , array ( '@value' => $this -> demoService -> getDemoValue ())), ); } } ?> create()\u65b9\u6cd5\u521b\u5efa\u4e86\u4e00\u4e2a\u63a7\u5236\u5668\u7c7b\u7684\u5b9e\u4f8b\uff0c\u53c2\u6570\u4e3acontainer\u4e2d\u83b7\u53d6\u5230\u7684service\u3002\u8fd9\u6837\uff0cDemoService\u5b9e\u4f8b\u5c31\u53ef\u4ee5\u5b58\u50a8\u5230$demoService\u4e2d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8c03\u7528getDemoValue()\u8fd9\u4e2a\u65b9\u6cd5\u4e86\u3002 5\u3001\u8bbf\u95ee/demo\u7684\u65f6\u5019\u5c4f\u5e55\u4e0a\u5c31\u4f1a\u51fa\u73b0Hello Upchuk! \u00b6 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://docs.acquia.com/articles/drupal-8-dependency-injection 2\u3001 http://katbailey.github.io/2013/05/15/dependency-injection-in-drupal-8/ 3\u3001 https://www.drupal.org/node/2133171 4\u3001 http://redcrackle.com/blog/drupal-8/dependency-injection 5\u3001 https://api.drupal.org/api/drupal/core!core.api.php/group/container/8 6\u3001 http://www.sitepoint.com/building-drupal-8-module-configuration-management-service-container/ 7\u3001 https://api.drupal.org/api/drupal/core%21core.api.php/group/service_tag/8","title":"\"Drupal8-Service-DependencyInjection\""},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#core-services","text":"Drupal8\u7684\u6838\u5fc3servive\u90fd\u5728 core.services.yml \u4e2d\u3002 \u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5728module_name.services.yml\u4e2d\u81ea\u5b9a\u4e49service\u3002 *.services.yml\u7684\u5199\u6cd5\u5982\uff1a path.alias_manager: class: Drupal\\Core\\Path\\AliasManager arguments: ['@path.crud', '@path.alias_whitelist', '@language_manager'] breadcrumb: class: Drupal\\Core\\Breadcrumb\\BreadcrumbManager arguments: ['@module_handler'] \u5982\u8981\u628a\u522b\u7684service\u5f53\u4f5c\u5de5\u5382\u4f7f\u7528\uff0c\u5199\u6cd5\u5982\u4e0b\uff1a cache.entity: class: Drupal\\Core\\Cache\\CacheBackendInterface tags: - { name: cache.bin } factory: cache_factory:get arguments: [entity] 1\u3001\u7b2c\u4e00\u884c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u552f\u4e00\u7684service\u540d\u79f0\uff0c\u5982\u679c\u662f\u81ea\u5b9a\u4e49\u7684\u6a21\u5757\uff0c\u5fc5\u987b\u4ee5\u6a21\u5757\u540d\u4f5c\u4e3a\u524d\u7f00\u3002 2\u3001\u7b2c\u4e8c\u884c\u5b9a\u4e49\u4e86\u9ed8\u8ba4\u8c03\u7528\u7684\u7c7b\u3001\u5de5\u5382\u7c7b\u3001\u63a5\u53e3\u7c7b\u7b49\u3002 3\u3001arguments\u5e26@\u8868\u793a\u4f9d\u8d56\u4e8e\u8be5service\u3002 4\u3001factory\u8868\u793a\u8c03\u7528\u54ea\u4e2a\u5de5\u5382\u65b9\u6cd5\u3002 5\u3001tags\u6807\u7b7e\u5b9a\u4e49\u4e86\u4e00\u7ec4\u5173\u8054\u7684service\uff0c\u6216\u6307\u5b9a\u5177\u6709\u67d0\u4e9b\u76f8\u4f3c\u7279\u6027\u7684service\u3002\u5982\u679c\u5b9a\u4e49\u4e86service\u6807\u7b7e\uff0c\u5728service\u7c7b\u4e2d\u5fc5\u987b\u5b9e\u73b0\u76f8\u5e94\u7684\u63a5\u53e3\uff0c\u5982\uff1a > access_check: \u6807\u660e\u8def\u7531\u8bbf\u95ee\u68c0\u67e5service > cache.bin: \u6807\u660ecache bin service > event_subscriber: \u6807\u660e\u4e00\u4e2a\u4e8b\u4ef6\u8ba2\u9605service\u3002 > needs_destruction: \u6807\u660e\u4e00\u4e2adestructor()\u65b9\u6cd5\uff0c\u901a\u5e38\u88ab\u8c03\u7528\u4e8e\u4e00\u4e2a\u8bf7\u6c42\u5b8c\u6210\u65f6\u3002 > context_provice: \u6807\u660e\u4e00\u4e2ablock\u4e0a\u4e0b\u6587\u63d0\u4f9b\u8005\u3002 > http_client_middleware: \u6807\u660e\u8be5service\u63d0\u4f9b\u8005\u662f\u4e00\u4e2aguzzle\u4e2d\u95f4\u4ef6\u3002","title":"\u4e00\u3001core services"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#service","text":"","title":"\u4e8c\u3001\u8bbf\u95eeservice"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#1global-functions","text":"Drupal8\u7684\u5168\u5c40\u7c7b\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9759\u6001\u65b9\u6cd5\u53bb\u8bbf\u95ee\u4e00\u4e9b\u901a\u7528\u7684service\u3002\u5982Drupal::moduleHandler()\u5c06\u8fd4\u56de\u6a21\u5757\u5904\u7406service\uff0cDrupal.translation()\u5c06\u8fd4\u56de\u7ffb\u8bd1service\u3002\u7528 Drupal::service()\u53ef\u4ee5\u83b7\u53d6\u6240\u6709\u5df2\u7ecf\u5b9a\u4e49\u7684service\u3002 \u5982\uff1a\u8bbf\u95ee\u4e00\u4e2a\u6570\u636e\u5e93service <?php // Returns a Drupal\\Core\\Database\\Connection object. $connection = \\Drupal :: database (); $result = $connection -> select ( 'node' , 'n' ) -> fields ( 'n' , array ( 'nid' )) -> execute (); ?> \u5982\uff1a\u901a\u8fc7\\Drupal::service()\u8bbf\u95ee\u4e00\u4e2adate service <?php // Returns a Drupal\\Core\\Datetime\\Date object. $date = \\Drupal :: service ( 'date' ); ?> \u5982\uff1a\u81ea\u5b9a\u4e49\u7684demo\u6a21\u5757","title":"1\u3001\u5168\u5c40\u51fd\u6570(global functions)"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#2demoservicesyml","text":"services: demo.demo_service: class: Drupal\\demo\\DemoService","title":"2\u3001\u521b\u5efademo.services.yml"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#3srcdemoservicephp","text":"<?php /** * @file * Contains Drupal\\demo\\DemoService. */ namespace Drupal\\demo ; class DemoService { protected $demo_value ; public function __construct () { $this -> demo_value = 'Upchuk' ; } public function getDemoValue () { return $this -> demo_value ; } } ?> \u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837\u8bbf\u95eedemo service $service = \\Drupal::service('demo.demo_service');","title":"3\u3001\u5728src\u76ee\u5f55\u4e0b\u521b\u5efaDemoService.php"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#4service","text":"Drupal8\u5141\u8bb8\u5728\u81ea\u5b9a\u4e49\u7684\u6a21\u5757\u4e2d\u91cd\u5199\u5df2\u5b58\u5728\u7684service\u3002\u5982\u81ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3ademo\u7684\u6a21\u5757\u3002 1)\u3001\u5728demo\u7684src\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aDemoServiceProvider.php\u6587\u4ef6\u3002 2)\u3001DemoServiceProvider\u5fc5\u987b\u5b9e\u73b0 \\Drupal\\Core\\DependencyInjection\\ServiceModifierInterface . 3)\u3001\u8fd9\u4e2a\u7c7b\u5fc5\u987b\u5305\u542b\u4e00\u4e2a\u65b9\u6cd5\uff1aalter()\u3002\u8fd9\u4e2a\u65b9\u6cd5\u662f\u544a\u8bc9Drupal\u7528\u4f60\u7684\u7c7b\u6765\u66ff\u4ee3\u9ed8\u8ba4\u7684\u7c7b\u3002\u5982\uff1a public function alter(ContainerBuilder $container) { // Override the language_manager class with a new class. $definition = $container->getDefinition('language_manager'); $definition->setClass('Drupal\\my_module\\MyLanguageManager'); }","title":"4\u3001\u91cd\u5199\u9ed8\u8ba4service"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#diservice","text":"\u8fd9\u5757\u6bd4\u8f83\u91cd\u8981\uff0c\u5355\u72ec\u6765\u8bb2\u4e00\u4e0b\u3002\u8fd8\u662f\u4ee5demo\u6a21\u5757\u4e3a\u4f8b\u3002","title":"\u4e09\u3001\u901a\u8fc7DI\u8bbf\u95eeservice"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#1demoservicesyml","text":"services: demo.demo_service: class: Drupal\\demo\\DemoService","title":"1\u3001\u521b\u5efademo.services.yml"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#2srcdemoservicephp","text":"<?php /** * @file * Contains Drupal\\demo\\DemoService. */ namespace Drupal\\demo ; class DemoService { protected $demo_value ; public function __construct () { $this -> demo_value = 'Upchuk' ; } public function getDemoValue () { return $this -> demo_value ; } } ?>","title":"2\u3001\u5728src\u76ee\u5f55\u4e0b\u521b\u5efaDemoService.php"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#3demoroutingyml","text":"demo.demo: path: '/demo' defaults: _controller: '\\Drupal\\demo\\Controller\\DemoController:demo' requirements: _permission: 'access content'","title":"3\u3001\u521b\u5efademo.routing.yml"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#4srccontrollerdemocontrollerphp","text":"<?php /** * @file * Contains \\Drupal\\demo\\Controller\\DemoController. */ namespace Drupal\\demo\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; /** * DemoController. */ class DemoController extends ControllerBase { protected $demoService ; /** * Class constructor. */ public function __construct ( $demoService ) { $this -> demoService = $demoService ; } /** * {@inheritdoc} */ public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'demo.demo_service' ) ); } /** * Generates an example page. */ public function demo () { return array ( '#markup' => t ( 'Hello @value!' , array ( '@value' => $this -> demoService -> getDemoValue ())), ); } } ?> create()\u65b9\u6cd5\u521b\u5efa\u4e86\u4e00\u4e2a\u63a7\u5236\u5668\u7c7b\u7684\u5b9e\u4f8b\uff0c\u53c2\u6570\u4e3acontainer\u4e2d\u83b7\u53d6\u5230\u7684service\u3002\u8fd9\u6837\uff0cDemoService\u5b9e\u4f8b\u5c31\u53ef\u4ee5\u5b58\u50a8\u5230$demoService\u4e2d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8c03\u7528getDemoValue()\u8fd9\u4e2a\u65b9\u6cd5\u4e86\u3002","title":"4\u3001\u5728src/Controller\u76ee\u5f55\u4e0b\u521b\u5efaDemoController.php"},{"location":"drupal/drupal8/Drupal8-Service-DependencyInjection/#5demohello-upchuk","text":"\u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://docs.acquia.com/articles/drupal-8-dependency-injection 2\u3001 http://katbailey.github.io/2013/05/15/dependency-injection-in-drupal-8/ 3\u3001 https://www.drupal.org/node/2133171 4\u3001 http://redcrackle.com/blog/drupal-8/dependency-injection 5\u3001 https://api.drupal.org/api/drupal/core!core.api.php/group/container/8 6\u3001 http://www.sitepoint.com/building-drupal-8-module-configuration-management-service-container/ 7\u3001 https://api.drupal.org/api/drupal/core%21core.api.php/group/service_tag/8","title":"5\u3001\u8bbf\u95ee/demo\u7684\u65f6\u5019\u5c4f\u5e55\u4e0a\u5c31\u4f1a\u51fa\u73b0Hello Upchuk!"},{"location":"drupal/drupal8/Drupal8-angularJS/","tags":"[angularjs]","text":"Drupal8\u4e2d\u4f7f\u7528AngularJS \u00b6 \u9996\u5148\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u57fa\u7840\u6a21\u5757\u5f15\u5165\u5e76\u542f\u52a8 angular OK\uff0c\u5148\u521b\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c\u6211\u4eec\u8d77\u540d\u53eb cloud_angular \u5728 cloud_angular \u4e2d\uff0c\u6211\u4eec\u65b0\u5efa\u76ee\u5f55 libs \uff0c\u91cc\u9762\u5b58\u653e\u6240\u6709\u4e0e angular \u76f8\u5173\u7684\u5e93\u6587\u4ef6\uff0c js \u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653eangular\u7684\u542f\u52a8js\uff1a app.js \u63a5\u7740\uff0c\u5b9a\u4e49angular\u7684library\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a cloud_angular.angular : version : VERSION css : angular : libs/angular-loading-bar/build/loading-bar.css : {} js : libs/angular/angular.js : {} libs/angular-animate/angular-animate.js : {} libs/angular-ui-router/release/angular-ui-router.js : {} libs/oclazyload/dist/ocLazyLoad.js : {} libs/angular-loading-bar/build/loading-bar.js : {} js/app.js : {} dependencies : - core/drupalSettings - core/drupal \u4fdd\u5b58\u4e3a cloud_angular.libraries.yml \u6587\u4ef6 \u6700\u540e\uff0c\u6253\u5f00 cloud_angular.module \uff0c\u5b9e\u73b0 page \u7684 hook \uff0c\u5f15\u5165\u4e0a\u9762\u5b9a\u4e49\u7684\u5e93\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a /** * Implements hook_preprocess_page(). */ function cloud_angular_preprocess_page(&$variables) { $variables['#attached']['library'][] = 'cloud_angular/cloud_angular.angular'; } \u8fd9\u6837\u6211\u4eec\u5728\u542f\u7528 cloud_angular \u6a21\u5757\u7684\u65f6\u5019\uff0c\u5c31\u5168\u5c40\u52a0\u8f7d\u4e86 angular \u597d\u4e86\uff0c\u6709\u4e86 angular \u7684\u542f\u52a8\u652f\u6491\u6a21\u5757\uff0c\u63a5\u4e0b\u6765\u770b\u4e0b\u5176\u5b83\u6a21\u5757\u600e\u4e48\u4f7f\u7528 angular \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u7528\u6237\u6a21\u5757\uff0c\u547d\u540d\uff1a cloud_user \uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u8def\u7531 profile/console \uff0c\u7528\u4e8e\u663e\u793a\u7528\u6237\u7684\u63a7\u5236\u53f0\u9996\u9875(\u4fd7\u79f0dashboard) \u6309\u7167drupa8\u7684\u8def\u7531\u5b9a\u4e49\u89c4\u5219\uff0c\u6211\u4eec\u9700\u8981\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6 cloud_user.routing.yml \u5b9a\u4e49\u8def\u7531\uff1a cloud_user.console : path : '/profile/console' defaults : _controller : '\\Drupal\\cloud_user\\Controller\\UserController::console' _title : '\u63a7\u5236\u53f0\u9996\u9875' requirements : _permission : 'access content' \u63a5\u7740\uff0c\u5728 cloud_user \u6a21\u5757\u4e0b\u65b0\u5efa src \u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55 Controller \uff0c\u91cc\u9762\u5b58\u653e\u8def\u7531\u6307\u5b9a\u7684\u63a7\u5236\u5668\u6587\u4ef6 UserController.php \uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a \u63a7\u5236\u5668\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * @contains \\Drupal\\cloud_user\\Controller\\UserController. */ namespace Drupal\\cloud_user\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; use Drupal\\Core\\Database\\Connection ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; class UserController extends ControllerBase { protected $database ; protected $userPath ; function __construct ( $database ) { $this -> database = $database ; $this -> userPath = drupal_get_path ( 'module' , 'cloud_user' ); } public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'database' ) ); } function console () { $build = array ( '#theme' => 'cloud_common' , ); // \u8fd9\u91cc\u6211\u4eec\u628a\u7528\u6237\u6a21\u5757\u7684\u8def\u5f84\u4f20\u9012\u5230\u524d\u7aef $build [ '#attached' ][ 'drupalSettings' ][ 'userPath' ] = $this -> userPath ; return $build ; } } cloud_common \u7684theme\u6a21\u7248 cloud-common.html.twig \u7edf\u4e00\u8f93\u51fa\u662f <div ui-view></div> \u7528\u4e8eangular\u524d\u7aef\u8def\u7531\u52a0\u8f7d\u6a21\u7248 \u63a5\u7740\uff0c\u5728 cloud_user \u6a21\u5757\u4e0b\u65b0\u5efa scripts \u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55 controller \u548c directive \uff0c\u5bf9\u4e86\uff0c\u5728 scripts \u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6 user.route.js \uff0c\u7528\u4e8e\u5b9a\u4e49\u7528\u6237\u6a21\u5757\u7684\u524d\u7aef\u8def\u7531\uff1a ( function ( angular , drupalSettings ) { 'use strict' ; /** * @name verycloud * @description all user's ng route here. * */ var verycloud = angular . module ( 'verycloud' ); verycloud . config ([ '$stateProvider' , function ( $stateProvider ) { $stateProvider . state ( 'dashboard' , { url : '/profile' , templateUrl : 'dashboard/container.html' , resolve : { loadMyFile : function ( $ocLazyLoad ) { return $ocLazyLoad . load ({ name : 'console' , files : [ drupalSettings . userPath + '/scripts/directive/header/header.js' ] }) } }, abstract : true }) . state ( 'dashboard.console' , { url : '/console' , templateUrl : 'dashboard/dashboard.html' , controller : 'ConsoleCtrl' , resolve : { loadMyFile : function ( $ocLazyLoad ) { return $ocLazyLoad . load ({ name : 'console' , files : [ drupalSettings . userPath + '/scripts/controller/consoleController.js' ] }) } } }); }]); })( angular , drupalSettings ); \u63a5\u4e0b\u6765\u5c06\u8fd9\u4e2a\u8def\u7531\u6587\u4ef6\u5b9a\u4e49\u6210\u5e93\uff0c\u4fdd\u5b58\u4e3a cloud_user.libraries.yml \uff0c cloud_user.user_route : version : VERSION js : scripts/user.route.js : {} \u6700\u540e\uff0c\u56de\u5230 angular \u7684\u652f\u6491\u6a21\u5757 cloud_angular \uff0c\u6253\u5f00 cloud_angular.module \u6587\u4ef6\uff0c\u5728 hook_page \u4e2d\u5f15\u5165\u7528\u6237\u6a21\u5757\u7684js\u5e93\u6587\u4ef6\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a /** * Implements hook_preprocess_page(). */ function cloud_angular_preprocess_page(&$variables) { $variables['#attached']['library'][] = 'cloud_angular/cloud_angular.angular'; $variables['#attached']['library'][] = 'cloud_user/cloud_user.user_route'; } \u542f\u7528 cloud_user \u6a21\u5757\uff0c\u5c1d\u8bd5\u8bbf\u95ee'profile/console'","title":"Drupal8\u4e2d\u4f7f\u7528AngularJS"},{"location":"drupal/drupal8/Drupal8-angularJS/#drupal8angularjs","text":"\u9996\u5148\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u57fa\u7840\u6a21\u5757\u5f15\u5165\u5e76\u542f\u52a8 angular OK\uff0c\u5148\u521b\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c\u6211\u4eec\u8d77\u540d\u53eb cloud_angular \u5728 cloud_angular \u4e2d\uff0c\u6211\u4eec\u65b0\u5efa\u76ee\u5f55 libs \uff0c\u91cc\u9762\u5b58\u653e\u6240\u6709\u4e0e angular \u76f8\u5173\u7684\u5e93\u6587\u4ef6\uff0c js \u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653eangular\u7684\u542f\u52a8js\uff1a app.js \u63a5\u7740\uff0c\u5b9a\u4e49angular\u7684library\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a cloud_angular.angular : version : VERSION css : angular : libs/angular-loading-bar/build/loading-bar.css : {} js : libs/angular/angular.js : {} libs/angular-animate/angular-animate.js : {} libs/angular-ui-router/release/angular-ui-router.js : {} libs/oclazyload/dist/ocLazyLoad.js : {} libs/angular-loading-bar/build/loading-bar.js : {} js/app.js : {} dependencies : - core/drupalSettings - core/drupal \u4fdd\u5b58\u4e3a cloud_angular.libraries.yml \u6587\u4ef6 \u6700\u540e\uff0c\u6253\u5f00 cloud_angular.module \uff0c\u5b9e\u73b0 page \u7684 hook \uff0c\u5f15\u5165\u4e0a\u9762\u5b9a\u4e49\u7684\u5e93\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a /** * Implements hook_preprocess_page(). */ function cloud_angular_preprocess_page(&$variables) { $variables['#attached']['library'][] = 'cloud_angular/cloud_angular.angular'; } \u8fd9\u6837\u6211\u4eec\u5728\u542f\u7528 cloud_angular \u6a21\u5757\u7684\u65f6\u5019\uff0c\u5c31\u5168\u5c40\u52a0\u8f7d\u4e86 angular \u597d\u4e86\uff0c\u6709\u4e86 angular \u7684\u542f\u52a8\u652f\u6491\u6a21\u5757\uff0c\u63a5\u4e0b\u6765\u770b\u4e0b\u5176\u5b83\u6a21\u5757\u600e\u4e48\u4f7f\u7528 angular \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u7528\u6237\u6a21\u5757\uff0c\u547d\u540d\uff1a cloud_user \uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u8def\u7531 profile/console \uff0c\u7528\u4e8e\u663e\u793a\u7528\u6237\u7684\u63a7\u5236\u53f0\u9996\u9875(\u4fd7\u79f0dashboard) \u6309\u7167drupa8\u7684\u8def\u7531\u5b9a\u4e49\u89c4\u5219\uff0c\u6211\u4eec\u9700\u8981\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6 cloud_user.routing.yml \u5b9a\u4e49\u8def\u7531\uff1a cloud_user.console : path : '/profile/console' defaults : _controller : '\\Drupal\\cloud_user\\Controller\\UserController::console' _title : '\u63a7\u5236\u53f0\u9996\u9875' requirements : _permission : 'access content' \u63a5\u7740\uff0c\u5728 cloud_user \u6a21\u5757\u4e0b\u65b0\u5efa src \u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55 Controller \uff0c\u91cc\u9762\u5b58\u653e\u8def\u7531\u6307\u5b9a\u7684\u63a7\u5236\u5668\u6587\u4ef6 UserController.php \uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a \u63a7\u5236\u5668\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * @contains \\Drupal\\cloud_user\\Controller\\UserController. */ namespace Drupal\\cloud_user\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; use Drupal\\Core\\Database\\Connection ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; class UserController extends ControllerBase { protected $database ; protected $userPath ; function __construct ( $database ) { $this -> database = $database ; $this -> userPath = drupal_get_path ( 'module' , 'cloud_user' ); } public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'database' ) ); } function console () { $build = array ( '#theme' => 'cloud_common' , ); // \u8fd9\u91cc\u6211\u4eec\u628a\u7528\u6237\u6a21\u5757\u7684\u8def\u5f84\u4f20\u9012\u5230\u524d\u7aef $build [ '#attached' ][ 'drupalSettings' ][ 'userPath' ] = $this -> userPath ; return $build ; } } cloud_common \u7684theme\u6a21\u7248 cloud-common.html.twig \u7edf\u4e00\u8f93\u51fa\u662f <div ui-view></div> \u7528\u4e8eangular\u524d\u7aef\u8def\u7531\u52a0\u8f7d\u6a21\u7248 \u63a5\u7740\uff0c\u5728 cloud_user \u6a21\u5757\u4e0b\u65b0\u5efa scripts \u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55 controller \u548c directive \uff0c\u5bf9\u4e86\uff0c\u5728 scripts \u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6 user.route.js \uff0c\u7528\u4e8e\u5b9a\u4e49\u7528\u6237\u6a21\u5757\u7684\u524d\u7aef\u8def\u7531\uff1a ( function ( angular , drupalSettings ) { 'use strict' ; /** * @name verycloud * @description all user's ng route here. * */ var verycloud = angular . module ( 'verycloud' ); verycloud . config ([ '$stateProvider' , function ( $stateProvider ) { $stateProvider . state ( 'dashboard' , { url : '/profile' , templateUrl : 'dashboard/container.html' , resolve : { loadMyFile : function ( $ocLazyLoad ) { return $ocLazyLoad . load ({ name : 'console' , files : [ drupalSettings . userPath + '/scripts/directive/header/header.js' ] }) } }, abstract : true }) . state ( 'dashboard.console' , { url : '/console' , templateUrl : 'dashboard/dashboard.html' , controller : 'ConsoleCtrl' , resolve : { loadMyFile : function ( $ocLazyLoad ) { return $ocLazyLoad . load ({ name : 'console' , files : [ drupalSettings . userPath + '/scripts/controller/consoleController.js' ] }) } } }); }]); })( angular , drupalSettings ); \u63a5\u4e0b\u6765\u5c06\u8fd9\u4e2a\u8def\u7531\u6587\u4ef6\u5b9a\u4e49\u6210\u5e93\uff0c\u4fdd\u5b58\u4e3a cloud_user.libraries.yml \uff0c cloud_user.user_route : version : VERSION js : scripts/user.route.js : {} \u6700\u540e\uff0c\u56de\u5230 angular \u7684\u652f\u6491\u6a21\u5757 cloud_angular \uff0c\u6253\u5f00 cloud_angular.module \u6587\u4ef6\uff0c\u5728 hook_page \u4e2d\u5f15\u5165\u7528\u6237\u6a21\u5757\u7684js\u5e93\u6587\u4ef6\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a /** * Implements hook_preprocess_page(). */ function cloud_angular_preprocess_page(&$variables) { $variables['#attached']['library'][] = 'cloud_angular/cloud_angular.angular'; $variables['#attached']['library'][] = 'cloud_user/cloud_user.user_route'; } \u542f\u7528 cloud_user \u6a21\u5757\uff0c\u5c1d\u8bd5\u8bbf\u95ee'profile/console'","title":"Drupal8\u4e2d\u4f7f\u7528AngularJS"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/","tags":"[entity]","text":"Drupal8\u7684\u5b9e\u4f53\u75312\u90e8\u5206\u7ec4\u6210\uff0c\u914d\u7f6e\u5b9e\u4f53(configuration entities)\u548c\u5185\u5bb9\u5b9e\u4f53(content entities)\u3002\u5982\u56fe\uff1a \u672c\u8282\u6e90\u4ee3\u7801\u89c1 https://github.com/RamboLau/drupal8-demos/tree/master/config_entities_example \u5185\u5bb9\u5b9e\u4f53\u89c1\uff1a http://verynull.com/2015/12/22/drupal8-content-entity/ \u4e00\u3001\u914d\u7f6e\u5b9e\u4f53\u63a5\u53e3(configuration entity interface) \u00b6 \u5728src\u76ee\u5f55\u4e0btouch DemoInterface.php\uff0cDemoInterface\u7ee7\u627f\u5e76\u5b9e\u73b0 ConfigEntityInterface \u3002 <?php /** * @file * Contains \\Drupal\\demo\\DemoInterface. */ namespace Drupal\\demo ; use Drupal\\Core\\Config\\Entity\\ConfigEntityInterface ; /** * Provides an interface defining a demo entity type. */ interface DemoInterface extends ConfigEntityInterface { // Add get/set methods for your configuration properties here. } ?> \u4e8c\u3001\u914d\u7f6e\u5b9e\u4f53\u7c7b(configuration entity class) \u00b6 \u5728src\u76ee\u5f55\u4e0b\u521b\u5efaEntity\u76ee\u5f55\uff0c\u5e76touch src/Entity/Demo.php\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u6211\u4eec\u5c06\u5b9e\u73b0DemoEntity\u3002 <?php /** * @file * Contains \\Drupal\\demo\\Entity\\Demo. */ namespace Drupal\\demo\\Entity ; use Drupal\\Core\\Config\\Entity\\ConfigEntityBase ; use Drupal\\demo\\DemoInterface ; /** * Defines the Demo entity. * * @ConfigEntityType( * id = \"demo\", * label = @Translation(\"Demo\"), * fieldable = FALSE, * handlers = { * \"list_builder\" = \"Drupal\\demo\\DemoListBuilder\", * \"form\" = { * \"add\" = \"Drupal\\demo\\Form\\DemoForm\", * \"edit\" = \"Drupal\\demo\\Form\\DemoForm\", * \"delete\" = \"Drupal\\demo\\Form\\DemoDeleteForm\" * } * }, * config_prefix = \"demo\", * admin_permission = \"administer site configuration\", * entity_keys = { * \"id\" = \"id\", * \"label\" = \"name\" * }, * links = { * \"edit-form\" = \"/admin/structure/demos/{demo}\", * \"delete-form\" = \"/admin/structure/demos/{demo}/delete\" * } * ) */ class Demo extends ConfigEntityBase implements DemoInterface { /** * The ID of the demo. * * @var string */ public $id ; /** * The demo name. * * @var string */ public $name ; /** * The demo sex. * * @var string */ public $sex ; } ?> \u4e0a\u9762\u5b9a\u4e49Entity\u7684\u65b9\u5f0f\u719f\u6089\u5427\uff01\u5bf9\uff0c\u5c31\u662f\u6ce8\u89e3annotation\u3002 @ConfigEntityType\u544a\u8bc9Drupal\u8fd9\u662f\u4e00\u4e2a\u914d\u7f6e\u5b9e\u4f53\u3002\u53c2\u6570\u5982\u4e0b\uff1a 1\u3001lable\uff1a\u7ffb\u8bd1\u7cfb\u7edf\u7684\u6807\u7b7e 2\u3001fieldable: \u9644\u52a0\u5b57\u6bb5\uff0c\u914d\u7f6e\u5b9e\u4f53\u4e00\u822c\u4e3aFALSE\uff0c\u5185\u5bb9\u5b9e\u4f53\u4e00\u822c\u4e3aTRUE 3\u3001handlers\uff1a\u7ba1\u7406\u8be5\u5b9e\u4f53\u6240\u9700\u8981\u7684\u7c7b 4\u3001list_builder\uff1a\u63d0\u4f9b\u8be5\u5b9e\u4f53\u7684\u7ba1\u7406\u754c\u9762\u63a5\u53e3 5\u3001config_prefix\uff1a\u914d\u7f6e\u7684\u524d\u7f00\uff0c\u4e00\u822c\u7528\u4e8eschema 6\u3001admin_permission\uff1a\u7ba1\u7406\u5458\u6743\u9650 7\u3001entity_keys\uff1a\u4e3b\u8981\u5b9e\u4f53\u5c5e\u6027\u7684\u96c6\u5408 8\u3001links\uff1a\u7f16\u8f91\u548c\u5220\u9664\u7684\u8def\u5f84\uff0c\u5728demo.routing.yml\u4e2d\u5b9a\u4e49 \u4e09\u3001\u5b9e\u4f53\u8868\u5355(entity form) \u00b6 \u63a5\u4e0b\u6765\u6211\u4eec\u6765\u5b9e\u73b0\u5728Entity\u4e2d\u7684\u5b9a\u4e49\u7684\u8868\u5355\uff0c\u5982add, edit, delete\u3002 1\u3001mkdir -p src/Form\uff0c\u5e76touch src/Form/DemoForm.php\u3002 \u00b6 \u5728DemoForm\u4e3b\u8981\u5b9e\u73b02\u4e2a\u65b9\u6cd5\uff0cform()\u548csave()\u3002 <?php /** * @file * Contains \\Drupal\\demo\\Form\\DemoForm. */ namespace Drupal\\demo\\Form ; use Drupal\\Core\\Entity\\EntityForm ; use Drupal\\Core\\Entity\\EntityInterface ; use Drupal\\Core\\Entity\\EntityTypeInterface ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; use Drupal\\Core\\Entity\\Query\\QueryFactory ; use Drupal\\Core\\Form\\FormStateInterface ; /** * Class DemoForm * * Form class for adding/editing demo config entities. */ class DemoForm extends EntityForm { /** * @param \\Drupal\\Core\\Entity\\Query\\QueryFactory $entity_query * The entity query. */ public function __construct ( QueryFactory $entity_query ) { $this -> entityQuery = $entity_query ; } /** * {@inheritdoc} */ public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'entity.query' ) ); } /** * {@inheritdoc} */ public function form ( array $form , FormStateInterface $form_state ) { $form = parent :: form ( $form , $form_state ); $demo = $this -> entity ; // Change page title for the edit operation if ( $this -> operation == 'edit' ) { $form [ '#title' ] = $this -> t ( 'Edit demo: @name' , array ( '@name' => $demo -> name )); } // The demo name. $form [ 'name' ] = array ( '#type' => 'textfield' , '#title' => $this -> t ( 'Name' ), '#maxlength' => 255 , '#default_value' => $demo -> name , '#description' => $this -> t ( \"demo name.\" ), '#required' => TRUE , ); // The unique machine name of the demo. $form [ 'id' ] = array ( '#type' => 'machine_name' , '#maxlength' => EntityTypeInterface :: BUNDLE_MAX_LENGTH , '#default_value' => $demo -> id , '#disabled' => ! $demo -> isNew (), '#machine_name' => array ( 'source' => array ( 'name' ), 'exists' => 'demo_load' ), ); // The sex. $form [ 'sex' ] = array ( '#type' => 'select' , '#options' => array ( 'Man' => 'Man' , 'Woman' => 'Woman' , ), '#title' => $this -> t ( 'Sex' ), '#maxlength' => 255 , '#default_value' => $demo -> sex , '#description' => $this -> t ( \"sex\" ), '#required' => TRUE , ); return $form ; } /** * {@inheritdoc} */ public function save ( array $form , FormStateInterface $form_state ) { $demo = $this -> entity ; $status = $demo -> save (); if ( $status ) { // Setting the success message. drupal_set_message ( $this -> t ( 'Saved the demo: @label.' , array ( '@label' => $demo -> name , ))); } else { drupal_set_message ( $this -> t ( 'The @label demo was not saved.' , array ( '@label' => $demo -> name , ))); } $form_state -> setRedirect ( 'demo.list' ); } } ?> \u5982\u56fe\uff1a 2\u3001touch src/Form/DemoFormDelete.php\u3002 \u00b6 DemoFormDelete\u7ee7\u627f EntityConfirmFormBase \u3002 <?php /** * @file * Contains \\Drupal\\demo\\Form\\DemoDeleteForm. */ namespace Drupal\\demo\\Form ; use Drupal\\Core\\Entity\\EntityConfirmFormBase ; use Drupal\\Core\\Url ; use Drupal\\Core\\Form\\FormStateInterface ; /** * Form that handles the removal of demo entities. */ class DemoDeleteForm extends EntityConfirmFormBase { /** * {@inheritdoc} */ public function getQuestion () { return $this -> t ( 'Are you sure you want to delete this demo: @name?' , array ( '@name' => $this -> entity -> name )); } /** * {@inheritdoc} */ public function getCancelUrl () { return new Url ( 'demo.list' ); } /** * {@inheritdoc} */ public function getConfirmText () { return $this -> t ( 'Delete' ); } /** * {@inheritdoc} */ public function submitForm ( array & $form , FormStateInterface $form_state ) { // Delete and set message $this -> entity -> delete (); drupal_set_message ( $this -> t ( 'The demo @name has been deleted.' , array ( '@name' => $this -> entity -> name ))); $form_state -> setRedirectUrl ( $this -> getCancelUrl ()); } } ?> \u5982\u56fe\uff1a \u56db\u3001list builder \u00b6 \u63a5\u4e0b\u6765\u5c31\u8be5\u521b\u5efa\u7ba1\u7406\u754c\u9762\u5566\uff01 \u5728src\u76ee\u5f55\u4e0b\uff0ctouch DemoListBuilder.php DemoListBuilder\u7ee7\u627f ConfigEntityListBuilder \uff0c\u5b9e\u73b0\u4e86\u4e09\u4e2a\u65b9\u6cd5\u3002 1\u3001buildHeader\uff1a\u521b\u5efa\u8868\u683cheader 2\u3001buildRow\uff1a\u521b\u5efa\u8868\u683c\u884c 3\u3001render\uff1a\u91cd\u5199\u8868\u683c\u8f93\u51fa\u7684\u5185\u5bb9\uff0c\u7c7b\u4f3c\u4e8eDrupal7\u7684hook <?php /** * @file * * Contains Drupal\\demo\\DemoListBuilder */ namespace Drupal\\demo ; use Drupal\\Core\\Config\\Entity\\ConfigEntityListBuilder ; use Drupal\\Core\\Entity\\EntityInterface ; class DemoListBuilder extends ConfigEntityListBuilder { /** * {@inheritdoc} */ public function buildHeader () { $header [ 'label' ] = $this -> t ( 'Name' ); $header [ 'sex' ] = $this -> t ( 'Sex' ); return $header + parent :: buildHeader (); } /** * {@inheritdoc} */ public function buildRow ( EntityInterface $entity ) { // Label $row [ 'label' ] = $this -> getLabel ( $entity ); // Sex $row [ 'sex' ] = $entity -> sex ; return $row + parent :: buildRow ( $entity ); } /** * {@inheritdoc} */ public function render () { $build = parent :: render (); $build [ '#empty' ] = $this -> t ( 'There are no data available.' ); return $build ; } } ?> \u5982\u56fe\uff1a \u4e94\u3001schema \u00b6 mkdir config/schema touch demo.schema.yml # Schema for the configuration files of the Demo module. demo.demo.*: type: mapping label: 'Demo' mapping: id: type: string label: 'Demo identifier' uuid: type: string label: 'UUID' name: type: label label: 'Name' sex: type: string label: 'Sex' translatable: true schema\u7684\u547d\u540d\u89c4\u5219\uff1a ( demo module ) . ( demo configuration entity type ) . ( all demo configuration entities ) . uuid\u5728\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u4e0d\u7528\u5b9a\u4e49\uff0cdrupal\u9ed8\u8ba4\u4f1a\u6dfb\u52a0\u3002 \u516d\u3001routing \u00b6 \u5b9a\u4e49\u4e00\u4e9b\u8def\u7531\uff1a demo.list: path: '/admin/structure/demos' defaults: _entity_list: 'demo' _title: 'Demos' requirements: _permission: 'administer site configuration' demo.add: path: '/admin/structure/demos/add' defaults: _entity_form: 'demo.add' _title: 'Add a new demo' requirements: _permission: 'administer site configuration' entity.demo.edit_form: path: '/admin/structure/demos/{demo}' defaults: _entity_form: 'demo.edit' _title: 'Edit demo' requirements: _permission: 'administer site configuration' entity.demo.delete_form: path: '/admin/structure/demos/{demo}/delete' defaults: _entity_form: 'demo.delete' _title: 'Delete demo' requirements: _permission: 'administer site configuration' \u4e03\u3001 links \u00b6 1\u3001\u663e\u793a\u6dfb\u52a0\u6309\u94ae\u5728\u7f51\u9875\u4e0a\uff0c\u9700\u8981\u5728demo.links.action.yml\u4e2d\u5b9a\u4e49 \u00b6 demo.add: route_name: 'demo.add' title: 'Add demo' appears_on: - demo.list 2\u3001\u5728admin/structure\u9875\u9762\u663e\u793ademo\uff0c\u9700\u8981\u5728demo.links.menu.yml\u4e2d\u5b9a\u4e49 \u00b6 demo.list: title: Demo description: 'Administrator the demo entities' parent: system.admin_structure route_name: demo.list \u5982\u56fe\uff1a \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://www.slideshare.net/andypost/d8-entity 2\u3001 http://www.sitepoint.com/drupal-8-version-entityfieldquery/ 3\u3001 https://www.drupal.org/node/1809494","title":"\"Drupal8 Configuration Entity\""},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#configuration-entity-interface","text":"\u5728src\u76ee\u5f55\u4e0btouch DemoInterface.php\uff0cDemoInterface\u7ee7\u627f\u5e76\u5b9e\u73b0 ConfigEntityInterface \u3002 <?php /** * @file * Contains \\Drupal\\demo\\DemoInterface. */ namespace Drupal\\demo ; use Drupal\\Core\\Config\\Entity\\ConfigEntityInterface ; /** * Provides an interface defining a demo entity type. */ interface DemoInterface extends ConfigEntityInterface { // Add get/set methods for your configuration properties here. } ?>","title":"\u4e00\u3001\u914d\u7f6e\u5b9e\u4f53\u63a5\u53e3(configuration entity interface)"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#configuration-entity-class","text":"\u5728src\u76ee\u5f55\u4e0b\u521b\u5efaEntity\u76ee\u5f55\uff0c\u5e76touch src/Entity/Demo.php\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u6211\u4eec\u5c06\u5b9e\u73b0DemoEntity\u3002 <?php /** * @file * Contains \\Drupal\\demo\\Entity\\Demo. */ namespace Drupal\\demo\\Entity ; use Drupal\\Core\\Config\\Entity\\ConfigEntityBase ; use Drupal\\demo\\DemoInterface ; /** * Defines the Demo entity. * * @ConfigEntityType( * id = \"demo\", * label = @Translation(\"Demo\"), * fieldable = FALSE, * handlers = { * \"list_builder\" = \"Drupal\\demo\\DemoListBuilder\", * \"form\" = { * \"add\" = \"Drupal\\demo\\Form\\DemoForm\", * \"edit\" = \"Drupal\\demo\\Form\\DemoForm\", * \"delete\" = \"Drupal\\demo\\Form\\DemoDeleteForm\" * } * }, * config_prefix = \"demo\", * admin_permission = \"administer site configuration\", * entity_keys = { * \"id\" = \"id\", * \"label\" = \"name\" * }, * links = { * \"edit-form\" = \"/admin/structure/demos/{demo}\", * \"delete-form\" = \"/admin/structure/demos/{demo}/delete\" * } * ) */ class Demo extends ConfigEntityBase implements DemoInterface { /** * The ID of the demo. * * @var string */ public $id ; /** * The demo name. * * @var string */ public $name ; /** * The demo sex. * * @var string */ public $sex ; } ?> \u4e0a\u9762\u5b9a\u4e49Entity\u7684\u65b9\u5f0f\u719f\u6089\u5427\uff01\u5bf9\uff0c\u5c31\u662f\u6ce8\u89e3annotation\u3002 @ConfigEntityType\u544a\u8bc9Drupal\u8fd9\u662f\u4e00\u4e2a\u914d\u7f6e\u5b9e\u4f53\u3002\u53c2\u6570\u5982\u4e0b\uff1a 1\u3001lable\uff1a\u7ffb\u8bd1\u7cfb\u7edf\u7684\u6807\u7b7e 2\u3001fieldable: \u9644\u52a0\u5b57\u6bb5\uff0c\u914d\u7f6e\u5b9e\u4f53\u4e00\u822c\u4e3aFALSE\uff0c\u5185\u5bb9\u5b9e\u4f53\u4e00\u822c\u4e3aTRUE 3\u3001handlers\uff1a\u7ba1\u7406\u8be5\u5b9e\u4f53\u6240\u9700\u8981\u7684\u7c7b 4\u3001list_builder\uff1a\u63d0\u4f9b\u8be5\u5b9e\u4f53\u7684\u7ba1\u7406\u754c\u9762\u63a5\u53e3 5\u3001config_prefix\uff1a\u914d\u7f6e\u7684\u524d\u7f00\uff0c\u4e00\u822c\u7528\u4e8eschema 6\u3001admin_permission\uff1a\u7ba1\u7406\u5458\u6743\u9650 7\u3001entity_keys\uff1a\u4e3b\u8981\u5b9e\u4f53\u5c5e\u6027\u7684\u96c6\u5408 8\u3001links\uff1a\u7f16\u8f91\u548c\u5220\u9664\u7684\u8def\u5f84\uff0c\u5728demo.routing.yml\u4e2d\u5b9a\u4e49","title":"\u4e8c\u3001\u914d\u7f6e\u5b9e\u4f53\u7c7b(configuration entity class)"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#entity-form","text":"\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u5b9e\u73b0\u5728Entity\u4e2d\u7684\u5b9a\u4e49\u7684\u8868\u5355\uff0c\u5982add, edit, delete\u3002","title":"\u4e09\u3001\u5b9e\u4f53\u8868\u5355(entity form)"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#1mkdir-p-srcformtouch-srcformdemoformphp","text":"\u5728DemoForm\u4e3b\u8981\u5b9e\u73b02\u4e2a\u65b9\u6cd5\uff0cform()\u548csave()\u3002 <?php /** * @file * Contains \\Drupal\\demo\\Form\\DemoForm. */ namespace Drupal\\demo\\Form ; use Drupal\\Core\\Entity\\EntityForm ; use Drupal\\Core\\Entity\\EntityInterface ; use Drupal\\Core\\Entity\\EntityTypeInterface ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; use Drupal\\Core\\Entity\\Query\\QueryFactory ; use Drupal\\Core\\Form\\FormStateInterface ; /** * Class DemoForm * * Form class for adding/editing demo config entities. */ class DemoForm extends EntityForm { /** * @param \\Drupal\\Core\\Entity\\Query\\QueryFactory $entity_query * The entity query. */ public function __construct ( QueryFactory $entity_query ) { $this -> entityQuery = $entity_query ; } /** * {@inheritdoc} */ public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'entity.query' ) ); } /** * {@inheritdoc} */ public function form ( array $form , FormStateInterface $form_state ) { $form = parent :: form ( $form , $form_state ); $demo = $this -> entity ; // Change page title for the edit operation if ( $this -> operation == 'edit' ) { $form [ '#title' ] = $this -> t ( 'Edit demo: @name' , array ( '@name' => $demo -> name )); } // The demo name. $form [ 'name' ] = array ( '#type' => 'textfield' , '#title' => $this -> t ( 'Name' ), '#maxlength' => 255 , '#default_value' => $demo -> name , '#description' => $this -> t ( \"demo name.\" ), '#required' => TRUE , ); // The unique machine name of the demo. $form [ 'id' ] = array ( '#type' => 'machine_name' , '#maxlength' => EntityTypeInterface :: BUNDLE_MAX_LENGTH , '#default_value' => $demo -> id , '#disabled' => ! $demo -> isNew (), '#machine_name' => array ( 'source' => array ( 'name' ), 'exists' => 'demo_load' ), ); // The sex. $form [ 'sex' ] = array ( '#type' => 'select' , '#options' => array ( 'Man' => 'Man' , 'Woman' => 'Woman' , ), '#title' => $this -> t ( 'Sex' ), '#maxlength' => 255 , '#default_value' => $demo -> sex , '#description' => $this -> t ( \"sex\" ), '#required' => TRUE , ); return $form ; } /** * {@inheritdoc} */ public function save ( array $form , FormStateInterface $form_state ) { $demo = $this -> entity ; $status = $demo -> save (); if ( $status ) { // Setting the success message. drupal_set_message ( $this -> t ( 'Saved the demo: @label.' , array ( '@label' => $demo -> name , ))); } else { drupal_set_message ( $this -> t ( 'The @label demo was not saved.' , array ( '@label' => $demo -> name , ))); } $form_state -> setRedirect ( 'demo.list' ); } } ?> \u5982\u56fe\uff1a","title":"1\u3001mkdir -p src/Form\uff0c\u5e76touch src/Form/DemoForm.php\u3002"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#2touch-srcformdemoformdeletephp","text":"DemoFormDelete\u7ee7\u627f EntityConfirmFormBase \u3002 <?php /** * @file * Contains \\Drupal\\demo\\Form\\DemoDeleteForm. */ namespace Drupal\\demo\\Form ; use Drupal\\Core\\Entity\\EntityConfirmFormBase ; use Drupal\\Core\\Url ; use Drupal\\Core\\Form\\FormStateInterface ; /** * Form that handles the removal of demo entities. */ class DemoDeleteForm extends EntityConfirmFormBase { /** * {@inheritdoc} */ public function getQuestion () { return $this -> t ( 'Are you sure you want to delete this demo: @name?' , array ( '@name' => $this -> entity -> name )); } /** * {@inheritdoc} */ public function getCancelUrl () { return new Url ( 'demo.list' ); } /** * {@inheritdoc} */ public function getConfirmText () { return $this -> t ( 'Delete' ); } /** * {@inheritdoc} */ public function submitForm ( array & $form , FormStateInterface $form_state ) { // Delete and set message $this -> entity -> delete (); drupal_set_message ( $this -> t ( 'The demo @name has been deleted.' , array ( '@name' => $this -> entity -> name ))); $form_state -> setRedirectUrl ( $this -> getCancelUrl ()); } } ?> \u5982\u56fe\uff1a","title":"2\u3001touch src/Form/DemoFormDelete.php\u3002"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#list-builder","text":"\u63a5\u4e0b\u6765\u5c31\u8be5\u521b\u5efa\u7ba1\u7406\u754c\u9762\u5566\uff01 \u5728src\u76ee\u5f55\u4e0b\uff0ctouch DemoListBuilder.php DemoListBuilder\u7ee7\u627f ConfigEntityListBuilder \uff0c\u5b9e\u73b0\u4e86\u4e09\u4e2a\u65b9\u6cd5\u3002 1\u3001buildHeader\uff1a\u521b\u5efa\u8868\u683cheader 2\u3001buildRow\uff1a\u521b\u5efa\u8868\u683c\u884c 3\u3001render\uff1a\u91cd\u5199\u8868\u683c\u8f93\u51fa\u7684\u5185\u5bb9\uff0c\u7c7b\u4f3c\u4e8eDrupal7\u7684hook <?php /** * @file * * Contains Drupal\\demo\\DemoListBuilder */ namespace Drupal\\demo ; use Drupal\\Core\\Config\\Entity\\ConfigEntityListBuilder ; use Drupal\\Core\\Entity\\EntityInterface ; class DemoListBuilder extends ConfigEntityListBuilder { /** * {@inheritdoc} */ public function buildHeader () { $header [ 'label' ] = $this -> t ( 'Name' ); $header [ 'sex' ] = $this -> t ( 'Sex' ); return $header + parent :: buildHeader (); } /** * {@inheritdoc} */ public function buildRow ( EntityInterface $entity ) { // Label $row [ 'label' ] = $this -> getLabel ( $entity ); // Sex $row [ 'sex' ] = $entity -> sex ; return $row + parent :: buildRow ( $entity ); } /** * {@inheritdoc} */ public function render () { $build = parent :: render (); $build [ '#empty' ] = $this -> t ( 'There are no data available.' ); return $build ; } } ?> \u5982\u56fe\uff1a","title":"\u56db\u3001list builder"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#schema","text":"mkdir config/schema touch demo.schema.yml # Schema for the configuration files of the Demo module. demo.demo.*: type: mapping label: 'Demo' mapping: id: type: string label: 'Demo identifier' uuid: type: string label: 'UUID' name: type: label label: 'Name' sex: type: string label: 'Sex' translatable: true schema\u7684\u547d\u540d\u89c4\u5219\uff1a ( demo module ) . ( demo configuration entity type ) . ( all demo configuration entities ) . uuid\u5728\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u4e0d\u7528\u5b9a\u4e49\uff0cdrupal\u9ed8\u8ba4\u4f1a\u6dfb\u52a0\u3002","title":"\u4e94\u3001schema"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#routing","text":"\u5b9a\u4e49\u4e00\u4e9b\u8def\u7531\uff1a demo.list: path: '/admin/structure/demos' defaults: _entity_list: 'demo' _title: 'Demos' requirements: _permission: 'administer site configuration' demo.add: path: '/admin/structure/demos/add' defaults: _entity_form: 'demo.add' _title: 'Add a new demo' requirements: _permission: 'administer site configuration' entity.demo.edit_form: path: '/admin/structure/demos/{demo}' defaults: _entity_form: 'demo.edit' _title: 'Edit demo' requirements: _permission: 'administer site configuration' entity.demo.delete_form: path: '/admin/structure/demos/{demo}/delete' defaults: _entity_form: 'demo.delete' _title: 'Delete demo' requirements: _permission: 'administer site configuration'","title":"\u516d\u3001routing"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#links","text":"","title":"\u4e03\u3001 links"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#1demolinksactionyml","text":"demo.add: route_name: 'demo.add' title: 'Add demo' appears_on: - demo.list","title":"1\u3001\u663e\u793a\u6dfb\u52a0\u6309\u94ae\u5728\u7f51\u9875\u4e0a\uff0c\u9700\u8981\u5728demo.links.action.yml\u4e2d\u5b9a\u4e49"},{"location":"drupal/drupal8/Drupal8-configuration-Entity/#2adminstructuredemodemolinksmenuyml","text":"demo.list: title: Demo description: 'Administrator the demo entities' parent: system.admin_structure route_name: demo.list \u5982\u56fe\uff1a \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://www.slideshare.net/andypost/d8-entity 2\u3001 http://www.sitepoint.com/drupal-8-version-entityfieldquery/ 3\u3001 https://www.drupal.org/node/1809494","title":"2\u3001\u5728admin/structure\u9875\u9762\u663e\u793ademo\uff0c\u9700\u8981\u5728demo.links.menu.yml\u4e2d\u5b9a\u4e49"},{"location":"drupal/drupal8/Drupal8-css-guide/","tags":"[css]","text":"CSS\u683c\u5f0f \u00b6 \u7a7a\u767d \u00b6 \u7f29\u8fdb \u4e0d\u8981\u4f7f\u7528tab\u952e\u8fdb\u884c\u7f29\u8fdb\uff0c\u91c7\u75282\u4e2a\u7a7a\u683c\u8fdb\u884c\u7f29\u8fdb\u3002 @ media print { /* This line is indented with 2 spaces, 2 spaces x 1 level of indentation. */ . example { /* This line is indented with 4 spaces, 2 spaces x 2 levels of indentation. */ padding : 0 ; } } \u7a7a\u767d\u884c \u901a\u5e38\uff0c\u89c4\u5219\u5757\u4e4b\u95f4\u4e0d\u9700\u8981\u7a7a\u767d\u884c\u4f5c\u4e3a\u5206\u9694 \u5982\u679c\u89c4\u5219\u5757\u4e4b\u524d\u6709\u5355\u884c\u6216\u8005\u5757\u7ea7\u6ce8\u91ca\uff0c\u90a3\u4e48\u9700\u8981\u5728\u6ce8\u91ca\u4e4b\u524d\u7a7a\u767d\u884c \u5982\u679c\u4e24\u4e2a\u89c4\u5219\u5757\u4e4b\u95f4\u6ca1\u6709\u7a7a\u767d\u884c\uff0c\u90a3\u4e48\u5fc5\u7136\u5177\u6709\u903b\u8f91\u5173\u7cfb\u3002\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u9700\u8981\u6dfb\u52a0\u7a7a\u767d\u884c\u3002 /* A comment describing the ruleset. */ . selector-1 , . selector-2 , . selector-3 [ type = \"text\" ] { -webkit- box-sizing : border-box ; -moz- box-sizing : border-box ; box-sizing : border-box ; display : block ; margin : 0 ; font-family : Times , \"Times New Roman\" , sans-serif ; color : #333 ; background : #fff ; background : linear-gradient ( #fff , rgba ( 0 , 0 , 0 , 0.8 )); } /** * A longer comment describing this ruleset. Note * the blank line before the docblock. */ . selector-4 , . selector-5 { background-color : lime ; } /* This logical grouping of rulesets has no interleaving blank lines. */ . profile { margin : 16 px 0 ; margin : 1 rem 0 ; } . profile__picture { float : right ; /* LTR */ } \u884c\u5c3e \u884c\u5c3e\u7edd\u4e0d\u80fd\u6709\u4efb\u4f55\u7a7a\u767d(\u7a7a\u767d\u6216\u8005tab)\u3002\u6240\u6709\u7684\u6587\u4ef6\u5e94\u8be5\u4ee5\u5355\u4e2a\u7a7a\u767d\u884c\u7ed3\u5c3e\u3002 \u6587\u4ef6\u5e94\u8be5\u4ee5Unix\u884c\u5c3e\u683c\u5f0f\u7ed3\u5c3e( \\n \u6216\u8005 LF )\uff0c\u540c\u65f6\u4e5f\u662fMAC OS X\u7684\u9ed8\u8ba4\u65b9\u5f0f\uff0c\u4e0d\u8981\u4f7f\u7528windows\u7684\u884c\u5c3e\u683c\u5f0f( \\r\\n \u6216\u8005 CRLF ) \u5c0f\u63d0\u793a\uff1a\u6587\u672c\u7f16\u8f91\u542f\u7528 show invisibles \u3002 \u6ce8\u91ca \u00b6 \u6587\u4ef6\u6ce8\u91ca \u6bcf\u4e00\u4e2a\u6587\u4ef6\u5e94\u8be5\u4ee5\u6ce8\u91ca\u5f00\u5934\uff0c\u6ce8\u91ca\u4e2d\u5199\u660e\u6587\u4ef6\u7684\u7528\u9014\u3002\u4f8b\u5982\uff1a /** * @file * Short description describing the file. * * The first sentence of the long description starts here and continues on this * line for a while finally concluding here at the end of this paragraph. */ \u591a\u884c\u6ce8\u91ca \u5f53\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u6216\u8005\u4e00\u7ec4\u89c4\u5219\u96c6\u7684\u65f6\u5019\uff0c\u6ce8\u91ca\u5e94\u8be5\u9075\u5faaDoxygen\u6ce8\u91ca\u98ce\u683c(\u4e5f\u88ab\u79f0\u4f5c\"docblock\") /** * Short description using Doxygen-style comment format. * * The first sentence of the long description starts here and continues on this * line for a while finally concluding here at the end of this paragraph. * * The long description is ideal for more detailed explanations and * documentation. It can include example HTML, URLs, or any other information * that is deemed necessary or useful. */ . example-rule { } \u5355\u884c\u6ce8\u91ca \u5f53\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u5c5e\u6027\u6216\u8005\u4e00\u4e2a\u89c4\u5219\u96c6\u7684\u65f6\u5019\uff0c\u6ce8\u91ca\u5e94\u8be5\u63a7\u5236\u572880\u4e2a\u5b57\u7b26\u5e76\u9075\u5faa\u7b80\u5355CSS\u6ce8\u91ca\u98ce\u683c\u3002 . example { /* Override the default margins. */ margin : 0 ; } /* This is a variant of the .example component. */ . example--item { display : inline ; } \u5c06\u6ce8\u91ca\u76f4\u63a5\u653e\u5728\u5c5e\u6027\u6216\u8005\u5b83\u7684\u89c4\u5219\u96c6\u524d\u9762\uff0c\u5e76\u4fdd\u6301\u4e0e\u5b83\u6240\u5c5e\u7684\u5c5e\u6027\u6216\u8005\u89c4\u5219\u96c6\u76f8\u540c\u7684\u7f29\u8fdb\u3002 \u5982\u679c\u6ce8\u91ca\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u89c4\u5219\u96c6\uff0c\u8bb0\u5f97\u5728\u89c4\u5219\u96c6\u524d\u9762\u6dfb\u52a0\u4e00\u7a7a\u767d\u884c\u3002 \u683c\u5f0f \u00b6 CSS\u683c\u5f0f\u89c4\u8303\u786e\u4fdd\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\uff0c\u6ce8\u91ca\u7684\u6e05\u6670\u6027\uff0c\u6700\u5927\u5316\u51cf\u5c11\u610f\u5916\u9519\u8bef\u7684\u60c5\u51b5\u3002 \u89c4\u5219\u96c6 \u6bcf\u4e2a\u9009\u62e9\u5668\u72ec\u5360\u4e00\u884c\uff0c\u5373\u4f7f\u6709\u591a\u4e2a\u9017\u53f7\u76f8\u9694\u7684\u9009\u62e9\u5668\u3002 \u8d77\u59cb\u5927\u62ec\u53f7 { \u4e0e\u9009\u62e9\u5668\u4fdd\u6301\u540c\u884c(\u5982\u679c\u6709\u591a\u4e2a\u5c31\u4e0e\u6700\u540e\u4e00\u4e2a\u9009\u62e9\u5668\u4fdd\u6301\u540c\u4e00\u884c)\uff0c\u5e76\u4ee5\u5355\u4e2a\u7a7a\u683c\u76f8\u9694\u3002 \u7ed3\u675f\u5927\u62ec\u53f7 } \u4fdd\u6301\u4e0e\u89c4\u5219\u96c6\u4e2d\u9009\u62e9\u5668\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4fdd\u540c\u4e00\u5217\u3002 \u6bcf\u4e00\u884c\u6837\u5f0f\u89c4\u5219\u90fd\u5e94\u8be5\u76f8\u5bf9\u4e8e\u5b83\u7684\u9009\u62e9\u5668\u8fdb\u884c\u7f29\u8fdb\u3002 . selector-alpha , . selector-beta { counter-reset : section ; text-transform : small-caps ; } \u5c5e\u6027 \u5c5e\u6027\u540d\u540e\u9762\u7d27\u8ddf\u7740 : \uff0c\u7136\u540e\u662f\u4e00\u4e2a\u7a7a\u683c\uff0c\u63a5\u7740\u662f\u5c5e\u6027\u503c\u3002 \u6bcf\u884c\u6837\u5f0f\u89c4\u5219\u4ee5 ; \u7ed3\u5c3e\uff0c\u5305\u62ec\u89c4\u5219\u96c6\u4e2d\u7684\u6700\u540e\u4e00\u6761\u6837\u5f0f\u89c4\u5219\u3002 \u5341\u516d\u8fdb\u5236\u7684\u989c\u8272\u8bf7\u4f7f\u7528\u5c0f\u5199\uff0c\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u4f7f\u7528\u901f\u5199\uff0c\u4f8b\u5982\uff1a #aaa \u3002 \u5bf9\u4e8e\u9700\u8981\u5f15\u53f7\u7684\u5c5e\u6027\u503c\uff0c\u8bf7\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u4f8b\u5982\uff1a font-family: \"Arial Black\", Arial, sans-serif; and content: \" \"; \u3002 \u5982\u679c\u5c5e\u6027\u503c\u4e0d\u8981\u6c42\u5e26\u6709\u5f15\u53f7\uff0c\u90a3\u5c31\u4e0d\u52a0\u5f15\u53f7\u3002\u4f8b\u5982\uff1a background-image: url(path/image.png) \uff0c\u4e0d\u9700\u8981\u5199\u6210 background-image: url(\"path/image.png\") \u3002 \u4f7f\u7528rem\u4f5c\u4e3a\u5355\u4f4d\u66ff\u4ee3px\uff0c\u9664\u975e\u5b83\u9020\u6210\u4e86\u610f\u5916\u7684\u6548\u679c\u3002 \u9009\u62e9\u5668\u4e2d\u7684\u5c5e\u6027\u503c\u52a0\u53cc\u5f15\u53f7\uff0c\u4f8b\u5982\uff1a input[type=\"checkbox\"] \u3002 \u5bf9\u4e8e0\u503c\uff0c\u4e0d\u9700\u8981\u5e26\u5355\u4f4d\u3002\u4f8b\u5982\uff1a margin: 0; \uff0c\u4ee3\u66ff margin: 0px; \u3002 \u6bcf\u4e00\u4e2a , \u540e\u9762\u8ddf\u4e00\u4e2a\u7a7a\u683c\u3002 \u62ec\u53f7\u4e24\u8fb9\u4e0d\u8981\u52a0\u7a7a\u683c\uff0c\u4f8b\u5982\uff1a color: rgba(0, 0, 0, 0.8); \u3002 /* Basic syntax */ display : block ; /* * Use shorthand syntax for hexadecimal colors when possible * Always use lowercase */ color : # fff ; color : # df7dcf ; /* Use double quotes instead of single quotes */ font-family : \"Frutiger Ultra\" ; /* Do not attach units to zero-values */ text-shadow : 0 0 2px # ddd ; /* * Use rem units preceded by px units for a safe fallback, * unless it creates an undesired effect. */ font-size : 24px ; font-size : 1 . 5rem ; /* Spaces MUST follow commas in property or function values */ color : rgba ( 0 , 136 , 18 , 0 . 8 ) \u5c5e\u6027\u58f0\u660e\u987a\u5e8f Positioning\uff1aposition, float, clear, top, right, bottom, left, direction, and z-index Box model\uff1adisplay, [(max|min)-]height, [(max|min)-]width, margin, padding, border \u4ee5\u53ca\u5b83\u4eec\u5bf9\u5e94\u7684\u53ef\u53d8\u6837\u5f0f\u89c4\u5219(\u4f8b\u5982\uff1amargin-top\u7b49.)\uff0c\u4ee5\u53cabox-sizing \u5176\u5b83 . selector { /* Positioning declarations */ position : absolute ; top : 0 ; left : 0 ; z-index : 10 ; /* Box model declarations */ display : inline-block ; width : 100 % ; padding : 10 px ; padding : 0.625 rem ; border : 1 px solid #333 ; /* Other declarations */ background : #000 ; color : #fff ; font-family : sans-serif ; font-size : 18 px ; font-size : 1.125 rem ; } \u7279\u4f8b \u5355\u884c\u6837\u5f0f\u89c4\u5219\u5757\uff0c\u8d77\u59cb\u5927\u62ec\u53f7\u7684\u540e\u9762\u4ee5\u53ca\u7ed3\u675f\u5927\u62ec\u53f7\u7684\u540e\u9762\u5305\u542b\u4e00\u4e2a\u7a7a\u683c\u3002 . selector-1 { width : 10 % ; } . selector-2 { width : 20 % ; } . selector-3 { width : 30 % ; } \u5f88\u957f\u7684\uff0c\u9017\u53f7\u76f8\u9694\u7684\u5c5e\u6027\u503c\u4f8b\u5982\uff0c gradients \u6216\u8005 shadows \uff0c\u53ef\u80fd\u5360\u636e\u591a\u884c\u3002 . selector { background-image : linear-gradient ( #fff , #ccc ), linear-gradient ( #f3c , #4ec ); box-shadow : 1 px 1 px 1 px #000 , 2 px 2 px 1 px 1 px #ccc inset ; } Media Queries Media queries\u7684\u5199\u6cd5\u9075\u4ece\u89c4\u5219\u96c6\u7684\u5199\u6cd5\u3002 media feature\u548c\u503c\u4e4b\u95f4\u52a0\u4e2a\u7a7a\u683c\u3002 \u6240\u6709\u7684\u503c\u4ee5rem\u4e3a\u5355\u4f4d\u3002 px\u503c\u76f4\u63a5\u52a0\u5728\u8d77\u59cb\u5927\u62ec\u53f7\u4e4b\u540e\u3002 @ media screen and ( min-width : 28 . 125rem ) { /* 450px */ # page { margin-left : 20 px ; margin-left : 1.25 rem ; margin-right : 20 px ; margin-right : 1.25 rem ; } } \u6742\u9879 \u00b6 @charset\u8bed\u53e5 \u5b57\u7b26\u96c6\u8bed\u53e5(\u4f8b\u5982\uff1a @charset \"UTF-8\"; )\u53ea\u5728css\u6587\u4ef6\u6700\u5f00\u5934\u7684\u65f6\u5019\u624d\u4f1a\u751f\u6548\u3002\u5f53Drupal\u7684css\u5408\u5e76\u5668\u5408\u5e76\u591a\u4e2acss\u6587\u4ef6\u5230\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0cDrupal\u4f1a\u5ffd\u7565 @charset \u8bed\u53e5\u3002\u8fd9\u5c31\u610f\u5473\u7740\uff0cCSS\u6587\u4ef6\u4e0d\u5fc5\u8981\u52a0 @charset \u8bed\u53e5\u3002CSS\u6587\u4ef6\u9ed8\u8ba4\u7f16\u7801\u662f UTF-8 \u3002\u4efb\u4f55CSS\u6ce8\u91ca\u6216\u8005\u5c5e\u6027\u503c\u5fc5\u987b\u4ee5 UTF-8 \u7f16\u7801\u3002 \u7efc\u5408\u4f8b\u5b50\uff1a /** * @file * Layouts for this theme. */ /** * Column layout with horizontal scroll. * * This creates a single row of full-height, non-wrapping columns that can be * browsed horizontally within their parent. * * Example HTML: * * <div class=\"grid\"> * <div class=\"cell cell-3\"></div> * <div class=\"cell cell-3\"></div> * <div class=\"cell cell-3\"></div> * </div> */ /** * Grid container * * Must only contain '.cell' children. */ . grid { height : 100 % ; /* Remove inter-cell whitespace */ font-size : 0 ; /* Prevent inline-block cells wrapping */ white-space : nowrap ; } /** * Grid cells * * No explicit width by default. Extend with '.cell-n' classes. */ . cell { position : relative ; display : inline-block ; overflow : hidden ; box-sizing : border-box ; height : 100 % ; /* Set the inter-cell spacing */ padding : 0 10 px ; padding : 0.625 rem ; border : 2 px solid #333 ; vertical-align : top ; /* Reset white-space */ white-space : normal ; /* Reset font-size */ font-size : 16 px ; font-size : 1 rem ; } /* Cell states */ . cell . is-animating { background-color : #fffdec ; } /* Cell dimensions */ . cell-1 { width : 10 % ; } . cell-2 { width : 20 % ; } . cell-3 { width : 30 % ; } . cell-4 { width : 40 % ; } . cell-5 { width : 50 % ; } /* Cell modifiers */ . cell--detail , . cell--important { border-width : 4 px ; } CSS\u67b6\u6784 \u00b6 \u76ee\u6807 \u00b6 \u53ef\u9884\u671f\u6027 CSS\u4ee3\u7801\u5177\u6709\u6613\u8bfb\u6027\uff0c\u5bb9\u6613\u7406\u89e3\u3002\u4fee\u6539\u65f6\u53ea\u4fee\u6539\u4f60\u9700\u8981\u7684\u800c\u4e0d\u4f1a\u53d1\u751f\u5176\u5b83\u9519\u8bef\u3002 \u53ef\u91cd\u7528 CSS\u89c4\u5219\u8db3\u591f\u7b80\u7ea6\u548c\u89e3\u8026\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5feb\u901f\u4ece\u5df2\u7ecf\u5b58\u5728\u7684\u90e8\u5206\u6784\u5efa\u65b0\u7684\u7ec4\u4ef6\u3002 \u53ef\u7ef4\u62a4 \u6211\u4eec\u4f1a\u4e00\u76f4\u6dfb\u52a0\u65b0\u7684\u7ec4\u4ef6\u548c\u7279\u6027\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6dfb\u52a0\u7684\u65f6\u5019\u4f1a\u5f88\u5bb9\u6613\uff0c\u4e0d\u9700\u8981\u7834\u574f\u539f\u6709\u7684\u6837\u5f0f\u89e3\u6784\u3002 \u53ef\u6269\u5c55 \u6700\u4f73\u5b9e\u8df5 \u00b6 \u907f\u514d\u4f9d\u8d56HTML\u7ed3\u6784 CSS\u5e94\u8be5\u5b9a\u4e49\u67d0\u4e2a\u5143\u7d20\u5728\u4efb\u4f55\u4f4d\u7f6e\u51fa\u73b0\u65f6\u5e94\u8be5\u663e\u793a\u7684\u6837\u5b50 \u4e3a\u5143\u7d20\u6807\u8bb0class\uff0c\u4e0d\u8981\u5728CSS\u4e2d\u4f7f\u7528id\u9009\u62e9\u5668 \u4fdd\u8bc1\u9009\u62e9\u5668\u8db3\u591f\u77ed\u3002\u6700\u4f18\u7684\u9009\u62e9\u5668\u5c31\u662f\u4e00\u4e2aclass\u6216\u8005\u4e00\u4e2a\u5143\u7d20 \u6709\u65f6\u5019multi-part\u9009\u62e9\u5668\u5f88\u5b9e\u7528\u3002\u4f8b\u5982\uff1a /** * Add a horizontal rule between adjacent list rows * * Could be part of an implementation of the Pears \u201cslats\u201d component: * http://pea.rs/content/slats-html5 */ . slat + . slat { border-top : 1 px solid #cccccc ; } \u7136\u800c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u5728multi-part\u9009\u62e9\u5668\u4e2d\u5c3d\u91cf\u907f\u514d\u539f\u751f\u6807\u8bb0\uff0c\u4f8b\u5982\uff1a div , span \u5982\u679c\u53ef\u80fd\u7684\u8bdd\u907f\u514d\u51fa\u73b0\u540e\u4ee3\u9009\u62e9\u5668(\u4f8b\u5982\uff1a .my-list li )\uff0c\u7279\u522b\u662f\u4e00\u4e2a\u7ec4\u4ef6\u5305\u542b\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u7684\u65f6\u5019 \u907f\u514d\u51fa\u73b02\u4e2a\u4ee5\u4e0a\u7684\u7ec4\u5408\u3002\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u5f88\u7cdf\u7cd5\uff1a .my-list > li > a \u5982\u679c\u6000\u7591\u7684\u8bdd\uff0c\u76f4\u63a5\u7ed9\u5143\u7d20\u52a0\u4e00\u4e2aclass\u6216\u8005\u52a0\u4e0a\u6837\u5f0f \u4f7f\u7528\u7ec4\u4ef6\u81ea\u5df1\u7684class\u547d\u540d\u7ec4\u4ef6\u5143\u7d20 \u4e3a\u4e86\u907f\u514d\u4f9d\u8d56html\u6807\u7b7e\u7ed3\u6784\uff0c\u66f4\u52a0\u660e\u786e\u5730\u5b9a\u4e49\u4e00\u4e2a\u7ec4\u4ef6\u5143\u7d20\uff0c\u53ef\u4ee5\u7ed9\u7ec4\u4ef6\u52a0\u4e0a\u4ee5 _ \u76f8\u8fde\u7684\u7ec4\u4ef6\u540d\u3002 . component {} /* Component elements */ . component__header {} . component__body {} \u4f7f\u7528\u4fee\u9970class\u6269\u5c55\u7ec4\u4ef6 \u4f8b\u5982\uff1a CSS /* \u6309\u94ae\u7ec4\u4ef6 */ . button { /* styles */ } /* \u6309\u94ae\u4fee\u9970\u7c7b */ . button--primary { /* modifications and additions */ } HTML <!-- Button variant is created by applying both component and modifier classes --> < button class = \"button button--primary\" > Save </ button > \u5206\u79bb\u51fa\u76f8\u5173\u7684css \u7ec4\u4ef6\u7684\u804c\u8d23\u4e0d\u662f\u4e3a\u4e86\u7ad9\u70b9\u7684\u5b9a\u4f4d\u548c\u5e03\u5c40\u3002\u4e0d\u8981\u5e94\u7528 width \u548c height \uff0c\u9664\u975e\u90a3\u4e2a\u5143\u7d20\u539f\u751f\u5e26\u6709\u8fd9\u4e9b\u5c5e\u6027(\u4f8b\u5982\uff1aimg)\u3002 \u907f\u514d\u4f7f\u7528js\u6539\u53d8\u5185\u8054\u6837\u5f0f\u3002\u4f8b\u5982\uff0c\u72b6\u6001\u7684\u53d8\u5316\uff0c\u8fd9\u65f6\u5019\u5c31\u8be5\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a is-active \u7684class\u7528\u4e8e\u63cf\u8ff0\u72b6\u6001\u7684\u53d8\u5316\u3002 Drupal8\u4f7f\u7528 SMACSS \u7cfb\u7edf\u7c7b\u5f52\u7c7bcss\u89c4\u5219\uff1a Base Base\u7531\u53ea\u6e32\u67d3html\u5143\u7d20\u7684\u6837\u5f0f\u89c4\u5219\u7ec4\u6210\uff0c\u4f8b\u5982\u7528\u4e8eCSS reset\u6216\u8005 Normalize.css \u3002Base\u4e2d\u4e0d\u5e94\u8be5\u5305\u542b\u4efb\u4f55\u7c7b\u9009\u62e9\u5668\u3002 Layout \u9875\u9762\u5143\u7d20\u5e03\u5c40\uff0c\u4f8b\u5982grid\u7cfb\u7edf Component \u53ef\u91cd\u7528\u3001\u72ec\u7acb\u7684UI\u5143\u7d20\u3002 State \u5904\u7406\u7ec4\u4ef6\u663e\u793a\u53d8\u5316\u7684\u6837\u5f0f\u96c6\u3002\u901a\u5e38\uff0c\u662f\u5728\u7528\u6237\u4e0e\u9875\u9762\u4ea4\u4e92\u65f6\u89e6\u53d1\u7684\u6837\u5f0f\u53d8\u5316\uff0c\u4f8b\u5982\uff1ahover\uff0c\u6253\u5f00\u4e00\u4e2a\u6a21\u6001\u6846\u7b49\u3002\u4e3b\u8981\u65b9\u5f0f\u6709\uff1a \u81ea\u5b9a\u4e49class\uff0c\u4ee5\u524d\u7f00'.is-'\u5f00\u5934\uff0c\u4f8b\u5982\uff1a .is-transitioning , .is-open \u4f2a\u7c7b\uff0c\u4f8b\u5982\uff1a :hover \u3001 :checked \u4ee5\u72b6\u6001\u8bed\u4e49\u4f5c\u4e3a\u5c5e\u6027\u7684html\u5143\u7d20\uff0c\u3002\u4f8b\u5982\uff1a details[open] media queries Theme \u7eaf\u7cb9\u7684\u53ef\u89c1\u6837\u5f0f\uff0c\u4f8b\u5982\uff1a border \uff0c box-shadow \uff0c colors \uff0cbackgrounds\uff0cfont properties\u7b49 \u7c7b\u540d\u683c\u5f0f \u7c7b\u540d\u5e94\u8be5\u4f7f\u7528\u5168\u79f0\u800c\u4e0d\u662f\u7f29\u5199\u3002\u4f8b\u5982\uff1a class=\"button\" \u800c\u4e0d\u662f class=\"btn\" \u7ec4\u4ef6\u7684\u7c7b\u540d\u5e94\u8be5\u4f7f\u7528 - \u5206\u9694\u4e24\u4e2a\u5355\u8bcd\uff0c\u4f8b\u5982\uff1a class=\"button-group\" \uff0c\u800c\u4e0d\u662f class=\"buttongroup\" \u539f\u6587\u5730\u5740\uff0c \u8bf7\u6233\u8fd9\u91cc","title":"drupal8-css-guide"},{"location":"drupal/drupal8/Drupal8-css-guide/#css","text":"","title":"CSS\u683c\u5f0f"},{"location":"drupal/drupal8/Drupal8-css-guide/#_1","text":"\u7f29\u8fdb \u4e0d\u8981\u4f7f\u7528tab\u952e\u8fdb\u884c\u7f29\u8fdb\uff0c\u91c7\u75282\u4e2a\u7a7a\u683c\u8fdb\u884c\u7f29\u8fdb\u3002 @ media print { /* This line is indented with 2 spaces, 2 spaces x 1 level of indentation. */ . example { /* This line is indented with 4 spaces, 2 spaces x 2 levels of indentation. */ padding : 0 ; } } \u7a7a\u767d\u884c \u901a\u5e38\uff0c\u89c4\u5219\u5757\u4e4b\u95f4\u4e0d\u9700\u8981\u7a7a\u767d\u884c\u4f5c\u4e3a\u5206\u9694 \u5982\u679c\u89c4\u5219\u5757\u4e4b\u524d\u6709\u5355\u884c\u6216\u8005\u5757\u7ea7\u6ce8\u91ca\uff0c\u90a3\u4e48\u9700\u8981\u5728\u6ce8\u91ca\u4e4b\u524d\u7a7a\u767d\u884c \u5982\u679c\u4e24\u4e2a\u89c4\u5219\u5757\u4e4b\u95f4\u6ca1\u6709\u7a7a\u767d\u884c\uff0c\u90a3\u4e48\u5fc5\u7136\u5177\u6709\u903b\u8f91\u5173\u7cfb\u3002\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u9700\u8981\u6dfb\u52a0\u7a7a\u767d\u884c\u3002 /* A comment describing the ruleset. */ . selector-1 , . selector-2 , . selector-3 [ type = \"text\" ] { -webkit- box-sizing : border-box ; -moz- box-sizing : border-box ; box-sizing : border-box ; display : block ; margin : 0 ; font-family : Times , \"Times New Roman\" , sans-serif ; color : #333 ; background : #fff ; background : linear-gradient ( #fff , rgba ( 0 , 0 , 0 , 0.8 )); } /** * A longer comment describing this ruleset. Note * the blank line before the docblock. */ . selector-4 , . selector-5 { background-color : lime ; } /* This logical grouping of rulesets has no interleaving blank lines. */ . profile { margin : 16 px 0 ; margin : 1 rem 0 ; } . profile__picture { float : right ; /* LTR */ } \u884c\u5c3e \u884c\u5c3e\u7edd\u4e0d\u80fd\u6709\u4efb\u4f55\u7a7a\u767d(\u7a7a\u767d\u6216\u8005tab)\u3002\u6240\u6709\u7684\u6587\u4ef6\u5e94\u8be5\u4ee5\u5355\u4e2a\u7a7a\u767d\u884c\u7ed3\u5c3e\u3002 \u6587\u4ef6\u5e94\u8be5\u4ee5Unix\u884c\u5c3e\u683c\u5f0f\u7ed3\u5c3e( \\n \u6216\u8005 LF )\uff0c\u540c\u65f6\u4e5f\u662fMAC OS X\u7684\u9ed8\u8ba4\u65b9\u5f0f\uff0c\u4e0d\u8981\u4f7f\u7528windows\u7684\u884c\u5c3e\u683c\u5f0f( \\r\\n \u6216\u8005 CRLF ) \u5c0f\u63d0\u793a\uff1a\u6587\u672c\u7f16\u8f91\u542f\u7528 show invisibles \u3002","title":"\u7a7a\u767d"},{"location":"drupal/drupal8/Drupal8-css-guide/#_2","text":"\u6587\u4ef6\u6ce8\u91ca \u6bcf\u4e00\u4e2a\u6587\u4ef6\u5e94\u8be5\u4ee5\u6ce8\u91ca\u5f00\u5934\uff0c\u6ce8\u91ca\u4e2d\u5199\u660e\u6587\u4ef6\u7684\u7528\u9014\u3002\u4f8b\u5982\uff1a /** * @file * Short description describing the file. * * The first sentence of the long description starts here and continues on this * line for a while finally concluding here at the end of this paragraph. */ \u591a\u884c\u6ce8\u91ca \u5f53\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u6216\u8005\u4e00\u7ec4\u89c4\u5219\u96c6\u7684\u65f6\u5019\uff0c\u6ce8\u91ca\u5e94\u8be5\u9075\u5faaDoxygen\u6ce8\u91ca\u98ce\u683c(\u4e5f\u88ab\u79f0\u4f5c\"docblock\") /** * Short description using Doxygen-style comment format. * * The first sentence of the long description starts here and continues on this * line for a while finally concluding here at the end of this paragraph. * * The long description is ideal for more detailed explanations and * documentation. It can include example HTML, URLs, or any other information * that is deemed necessary or useful. */ . example-rule { } \u5355\u884c\u6ce8\u91ca \u5f53\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u5c5e\u6027\u6216\u8005\u4e00\u4e2a\u89c4\u5219\u96c6\u7684\u65f6\u5019\uff0c\u6ce8\u91ca\u5e94\u8be5\u63a7\u5236\u572880\u4e2a\u5b57\u7b26\u5e76\u9075\u5faa\u7b80\u5355CSS\u6ce8\u91ca\u98ce\u683c\u3002 . example { /* Override the default margins. */ margin : 0 ; } /* This is a variant of the .example component. */ . example--item { display : inline ; } \u5c06\u6ce8\u91ca\u76f4\u63a5\u653e\u5728\u5c5e\u6027\u6216\u8005\u5b83\u7684\u89c4\u5219\u96c6\u524d\u9762\uff0c\u5e76\u4fdd\u6301\u4e0e\u5b83\u6240\u5c5e\u7684\u5c5e\u6027\u6216\u8005\u89c4\u5219\u96c6\u76f8\u540c\u7684\u7f29\u8fdb\u3002 \u5982\u679c\u6ce8\u91ca\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u89c4\u5219\u96c6\uff0c\u8bb0\u5f97\u5728\u89c4\u5219\u96c6\u524d\u9762\u6dfb\u52a0\u4e00\u7a7a\u767d\u884c\u3002","title":"\u6ce8\u91ca"},{"location":"drupal/drupal8/Drupal8-css-guide/#_3","text":"CSS\u683c\u5f0f\u89c4\u8303\u786e\u4fdd\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\uff0c\u6ce8\u91ca\u7684\u6e05\u6670\u6027\uff0c\u6700\u5927\u5316\u51cf\u5c11\u610f\u5916\u9519\u8bef\u7684\u60c5\u51b5\u3002 \u89c4\u5219\u96c6 \u6bcf\u4e2a\u9009\u62e9\u5668\u72ec\u5360\u4e00\u884c\uff0c\u5373\u4f7f\u6709\u591a\u4e2a\u9017\u53f7\u76f8\u9694\u7684\u9009\u62e9\u5668\u3002 \u8d77\u59cb\u5927\u62ec\u53f7 { \u4e0e\u9009\u62e9\u5668\u4fdd\u6301\u540c\u884c(\u5982\u679c\u6709\u591a\u4e2a\u5c31\u4e0e\u6700\u540e\u4e00\u4e2a\u9009\u62e9\u5668\u4fdd\u6301\u540c\u4e00\u884c)\uff0c\u5e76\u4ee5\u5355\u4e2a\u7a7a\u683c\u76f8\u9694\u3002 \u7ed3\u675f\u5927\u62ec\u53f7 } \u4fdd\u6301\u4e0e\u89c4\u5219\u96c6\u4e2d\u9009\u62e9\u5668\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4fdd\u540c\u4e00\u5217\u3002 \u6bcf\u4e00\u884c\u6837\u5f0f\u89c4\u5219\u90fd\u5e94\u8be5\u76f8\u5bf9\u4e8e\u5b83\u7684\u9009\u62e9\u5668\u8fdb\u884c\u7f29\u8fdb\u3002 . selector-alpha , . selector-beta { counter-reset : section ; text-transform : small-caps ; } \u5c5e\u6027 \u5c5e\u6027\u540d\u540e\u9762\u7d27\u8ddf\u7740 : \uff0c\u7136\u540e\u662f\u4e00\u4e2a\u7a7a\u683c\uff0c\u63a5\u7740\u662f\u5c5e\u6027\u503c\u3002 \u6bcf\u884c\u6837\u5f0f\u89c4\u5219\u4ee5 ; \u7ed3\u5c3e\uff0c\u5305\u62ec\u89c4\u5219\u96c6\u4e2d\u7684\u6700\u540e\u4e00\u6761\u6837\u5f0f\u89c4\u5219\u3002 \u5341\u516d\u8fdb\u5236\u7684\u989c\u8272\u8bf7\u4f7f\u7528\u5c0f\u5199\uff0c\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u4f7f\u7528\u901f\u5199\uff0c\u4f8b\u5982\uff1a #aaa \u3002 \u5bf9\u4e8e\u9700\u8981\u5f15\u53f7\u7684\u5c5e\u6027\u503c\uff0c\u8bf7\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u4f8b\u5982\uff1a font-family: \"Arial Black\", Arial, sans-serif; and content: \" \"; \u3002 \u5982\u679c\u5c5e\u6027\u503c\u4e0d\u8981\u6c42\u5e26\u6709\u5f15\u53f7\uff0c\u90a3\u5c31\u4e0d\u52a0\u5f15\u53f7\u3002\u4f8b\u5982\uff1a background-image: url(path/image.png) \uff0c\u4e0d\u9700\u8981\u5199\u6210 background-image: url(\"path/image.png\") \u3002 \u4f7f\u7528rem\u4f5c\u4e3a\u5355\u4f4d\u66ff\u4ee3px\uff0c\u9664\u975e\u5b83\u9020\u6210\u4e86\u610f\u5916\u7684\u6548\u679c\u3002 \u9009\u62e9\u5668\u4e2d\u7684\u5c5e\u6027\u503c\u52a0\u53cc\u5f15\u53f7\uff0c\u4f8b\u5982\uff1a input[type=\"checkbox\"] \u3002 \u5bf9\u4e8e0\u503c\uff0c\u4e0d\u9700\u8981\u5e26\u5355\u4f4d\u3002\u4f8b\u5982\uff1a margin: 0; \uff0c\u4ee3\u66ff margin: 0px; \u3002 \u6bcf\u4e00\u4e2a , \u540e\u9762\u8ddf\u4e00\u4e2a\u7a7a\u683c\u3002 \u62ec\u53f7\u4e24\u8fb9\u4e0d\u8981\u52a0\u7a7a\u683c\uff0c\u4f8b\u5982\uff1a color: rgba(0, 0, 0, 0.8); \u3002 /* Basic syntax */ display : block ; /* * Use shorthand syntax for hexadecimal colors when possible * Always use lowercase */ color : # fff ; color : # df7dcf ; /* Use double quotes instead of single quotes */ font-family : \"Frutiger Ultra\" ; /* Do not attach units to zero-values */ text-shadow : 0 0 2px # ddd ; /* * Use rem units preceded by px units for a safe fallback, * unless it creates an undesired effect. */ font-size : 24px ; font-size : 1 . 5rem ; /* Spaces MUST follow commas in property or function values */ color : rgba ( 0 , 136 , 18 , 0 . 8 ) \u5c5e\u6027\u58f0\u660e\u987a\u5e8f Positioning\uff1aposition, float, clear, top, right, bottom, left, direction, and z-index Box model\uff1adisplay, [(max|min)-]height, [(max|min)-]width, margin, padding, border \u4ee5\u53ca\u5b83\u4eec\u5bf9\u5e94\u7684\u53ef\u53d8\u6837\u5f0f\u89c4\u5219(\u4f8b\u5982\uff1amargin-top\u7b49.)\uff0c\u4ee5\u53cabox-sizing \u5176\u5b83 . selector { /* Positioning declarations */ position : absolute ; top : 0 ; left : 0 ; z-index : 10 ; /* Box model declarations */ display : inline-block ; width : 100 % ; padding : 10 px ; padding : 0.625 rem ; border : 1 px solid #333 ; /* Other declarations */ background : #000 ; color : #fff ; font-family : sans-serif ; font-size : 18 px ; font-size : 1.125 rem ; } \u7279\u4f8b \u5355\u884c\u6837\u5f0f\u89c4\u5219\u5757\uff0c\u8d77\u59cb\u5927\u62ec\u53f7\u7684\u540e\u9762\u4ee5\u53ca\u7ed3\u675f\u5927\u62ec\u53f7\u7684\u540e\u9762\u5305\u542b\u4e00\u4e2a\u7a7a\u683c\u3002 . selector-1 { width : 10 % ; } . selector-2 { width : 20 % ; } . selector-3 { width : 30 % ; } \u5f88\u957f\u7684\uff0c\u9017\u53f7\u76f8\u9694\u7684\u5c5e\u6027\u503c\u4f8b\u5982\uff0c gradients \u6216\u8005 shadows \uff0c\u53ef\u80fd\u5360\u636e\u591a\u884c\u3002 . selector { background-image : linear-gradient ( #fff , #ccc ), linear-gradient ( #f3c , #4ec ); box-shadow : 1 px 1 px 1 px #000 , 2 px 2 px 1 px 1 px #ccc inset ; } Media Queries Media queries\u7684\u5199\u6cd5\u9075\u4ece\u89c4\u5219\u96c6\u7684\u5199\u6cd5\u3002 media feature\u548c\u503c\u4e4b\u95f4\u52a0\u4e2a\u7a7a\u683c\u3002 \u6240\u6709\u7684\u503c\u4ee5rem\u4e3a\u5355\u4f4d\u3002 px\u503c\u76f4\u63a5\u52a0\u5728\u8d77\u59cb\u5927\u62ec\u53f7\u4e4b\u540e\u3002 @ media screen and ( min-width : 28 . 125rem ) { /* 450px */ # page { margin-left : 20 px ; margin-left : 1.25 rem ; margin-right : 20 px ; margin-right : 1.25 rem ; } }","title":"\u683c\u5f0f"},{"location":"drupal/drupal8/Drupal8-css-guide/#_4","text":"@charset\u8bed\u53e5 \u5b57\u7b26\u96c6\u8bed\u53e5(\u4f8b\u5982\uff1a @charset \"UTF-8\"; )\u53ea\u5728css\u6587\u4ef6\u6700\u5f00\u5934\u7684\u65f6\u5019\u624d\u4f1a\u751f\u6548\u3002\u5f53Drupal\u7684css\u5408\u5e76\u5668\u5408\u5e76\u591a\u4e2acss\u6587\u4ef6\u5230\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0cDrupal\u4f1a\u5ffd\u7565 @charset \u8bed\u53e5\u3002\u8fd9\u5c31\u610f\u5473\u7740\uff0cCSS\u6587\u4ef6\u4e0d\u5fc5\u8981\u52a0 @charset \u8bed\u53e5\u3002CSS\u6587\u4ef6\u9ed8\u8ba4\u7f16\u7801\u662f UTF-8 \u3002\u4efb\u4f55CSS\u6ce8\u91ca\u6216\u8005\u5c5e\u6027\u503c\u5fc5\u987b\u4ee5 UTF-8 \u7f16\u7801\u3002 \u7efc\u5408\u4f8b\u5b50\uff1a /** * @file * Layouts for this theme. */ /** * Column layout with horizontal scroll. * * This creates a single row of full-height, non-wrapping columns that can be * browsed horizontally within their parent. * * Example HTML: * * <div class=\"grid\"> * <div class=\"cell cell-3\"></div> * <div class=\"cell cell-3\"></div> * <div class=\"cell cell-3\"></div> * </div> */ /** * Grid container * * Must only contain '.cell' children. */ . grid { height : 100 % ; /* Remove inter-cell whitespace */ font-size : 0 ; /* Prevent inline-block cells wrapping */ white-space : nowrap ; } /** * Grid cells * * No explicit width by default. Extend with '.cell-n' classes. */ . cell { position : relative ; display : inline-block ; overflow : hidden ; box-sizing : border-box ; height : 100 % ; /* Set the inter-cell spacing */ padding : 0 10 px ; padding : 0.625 rem ; border : 2 px solid #333 ; vertical-align : top ; /* Reset white-space */ white-space : normal ; /* Reset font-size */ font-size : 16 px ; font-size : 1 rem ; } /* Cell states */ . cell . is-animating { background-color : #fffdec ; } /* Cell dimensions */ . cell-1 { width : 10 % ; } . cell-2 { width : 20 % ; } . cell-3 { width : 30 % ; } . cell-4 { width : 40 % ; } . cell-5 { width : 50 % ; } /* Cell modifiers */ . cell--detail , . cell--important { border-width : 4 px ; }","title":"\u6742\u9879"},{"location":"drupal/drupal8/Drupal8-css-guide/#css_1","text":"","title":"CSS\u67b6\u6784"},{"location":"drupal/drupal8/Drupal8-css-guide/#_5","text":"\u53ef\u9884\u671f\u6027 CSS\u4ee3\u7801\u5177\u6709\u6613\u8bfb\u6027\uff0c\u5bb9\u6613\u7406\u89e3\u3002\u4fee\u6539\u65f6\u53ea\u4fee\u6539\u4f60\u9700\u8981\u7684\u800c\u4e0d\u4f1a\u53d1\u751f\u5176\u5b83\u9519\u8bef\u3002 \u53ef\u91cd\u7528 CSS\u89c4\u5219\u8db3\u591f\u7b80\u7ea6\u548c\u89e3\u8026\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5feb\u901f\u4ece\u5df2\u7ecf\u5b58\u5728\u7684\u90e8\u5206\u6784\u5efa\u65b0\u7684\u7ec4\u4ef6\u3002 \u53ef\u7ef4\u62a4 \u6211\u4eec\u4f1a\u4e00\u76f4\u6dfb\u52a0\u65b0\u7684\u7ec4\u4ef6\u548c\u7279\u6027\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6dfb\u52a0\u7684\u65f6\u5019\u4f1a\u5f88\u5bb9\u6613\uff0c\u4e0d\u9700\u8981\u7834\u574f\u539f\u6709\u7684\u6837\u5f0f\u89e3\u6784\u3002 \u53ef\u6269\u5c55","title":"\u76ee\u6807"},{"location":"drupal/drupal8/Drupal8-css-guide/#_6","text":"\u907f\u514d\u4f9d\u8d56HTML\u7ed3\u6784 CSS\u5e94\u8be5\u5b9a\u4e49\u67d0\u4e2a\u5143\u7d20\u5728\u4efb\u4f55\u4f4d\u7f6e\u51fa\u73b0\u65f6\u5e94\u8be5\u663e\u793a\u7684\u6837\u5b50 \u4e3a\u5143\u7d20\u6807\u8bb0class\uff0c\u4e0d\u8981\u5728CSS\u4e2d\u4f7f\u7528id\u9009\u62e9\u5668 \u4fdd\u8bc1\u9009\u62e9\u5668\u8db3\u591f\u77ed\u3002\u6700\u4f18\u7684\u9009\u62e9\u5668\u5c31\u662f\u4e00\u4e2aclass\u6216\u8005\u4e00\u4e2a\u5143\u7d20 \u6709\u65f6\u5019multi-part\u9009\u62e9\u5668\u5f88\u5b9e\u7528\u3002\u4f8b\u5982\uff1a /** * Add a horizontal rule between adjacent list rows * * Could be part of an implementation of the Pears \u201cslats\u201d component: * http://pea.rs/content/slats-html5 */ . slat + . slat { border-top : 1 px solid #cccccc ; } \u7136\u800c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u5728multi-part\u9009\u62e9\u5668\u4e2d\u5c3d\u91cf\u907f\u514d\u539f\u751f\u6807\u8bb0\uff0c\u4f8b\u5982\uff1a div , span \u5982\u679c\u53ef\u80fd\u7684\u8bdd\u907f\u514d\u51fa\u73b0\u540e\u4ee3\u9009\u62e9\u5668(\u4f8b\u5982\uff1a .my-list li )\uff0c\u7279\u522b\u662f\u4e00\u4e2a\u7ec4\u4ef6\u5305\u542b\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u7684\u65f6\u5019 \u907f\u514d\u51fa\u73b02\u4e2a\u4ee5\u4e0a\u7684\u7ec4\u5408\u3002\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u5f88\u7cdf\u7cd5\uff1a .my-list > li > a \u5982\u679c\u6000\u7591\u7684\u8bdd\uff0c\u76f4\u63a5\u7ed9\u5143\u7d20\u52a0\u4e00\u4e2aclass\u6216\u8005\u52a0\u4e0a\u6837\u5f0f \u4f7f\u7528\u7ec4\u4ef6\u81ea\u5df1\u7684class\u547d\u540d\u7ec4\u4ef6\u5143\u7d20 \u4e3a\u4e86\u907f\u514d\u4f9d\u8d56html\u6807\u7b7e\u7ed3\u6784\uff0c\u66f4\u52a0\u660e\u786e\u5730\u5b9a\u4e49\u4e00\u4e2a\u7ec4\u4ef6\u5143\u7d20\uff0c\u53ef\u4ee5\u7ed9\u7ec4\u4ef6\u52a0\u4e0a\u4ee5 _ \u76f8\u8fde\u7684\u7ec4\u4ef6\u540d\u3002 . component {} /* Component elements */ . component__header {} . component__body {} \u4f7f\u7528\u4fee\u9970class\u6269\u5c55\u7ec4\u4ef6 \u4f8b\u5982\uff1a CSS /* \u6309\u94ae\u7ec4\u4ef6 */ . button { /* styles */ } /* \u6309\u94ae\u4fee\u9970\u7c7b */ . button--primary { /* modifications and additions */ } HTML <!-- Button variant is created by applying both component and modifier classes --> < button class = \"button button--primary\" > Save </ button > \u5206\u79bb\u51fa\u76f8\u5173\u7684css \u7ec4\u4ef6\u7684\u804c\u8d23\u4e0d\u662f\u4e3a\u4e86\u7ad9\u70b9\u7684\u5b9a\u4f4d\u548c\u5e03\u5c40\u3002\u4e0d\u8981\u5e94\u7528 width \u548c height \uff0c\u9664\u975e\u90a3\u4e2a\u5143\u7d20\u539f\u751f\u5e26\u6709\u8fd9\u4e9b\u5c5e\u6027(\u4f8b\u5982\uff1aimg)\u3002 \u907f\u514d\u4f7f\u7528js\u6539\u53d8\u5185\u8054\u6837\u5f0f\u3002\u4f8b\u5982\uff0c\u72b6\u6001\u7684\u53d8\u5316\uff0c\u8fd9\u65f6\u5019\u5c31\u8be5\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a is-active \u7684class\u7528\u4e8e\u63cf\u8ff0\u72b6\u6001\u7684\u53d8\u5316\u3002 Drupal8\u4f7f\u7528 SMACSS \u7cfb\u7edf\u7c7b\u5f52\u7c7bcss\u89c4\u5219\uff1a Base Base\u7531\u53ea\u6e32\u67d3html\u5143\u7d20\u7684\u6837\u5f0f\u89c4\u5219\u7ec4\u6210\uff0c\u4f8b\u5982\u7528\u4e8eCSS reset\u6216\u8005 Normalize.css \u3002Base\u4e2d\u4e0d\u5e94\u8be5\u5305\u542b\u4efb\u4f55\u7c7b\u9009\u62e9\u5668\u3002 Layout \u9875\u9762\u5143\u7d20\u5e03\u5c40\uff0c\u4f8b\u5982grid\u7cfb\u7edf Component \u53ef\u91cd\u7528\u3001\u72ec\u7acb\u7684UI\u5143\u7d20\u3002 State \u5904\u7406\u7ec4\u4ef6\u663e\u793a\u53d8\u5316\u7684\u6837\u5f0f\u96c6\u3002\u901a\u5e38\uff0c\u662f\u5728\u7528\u6237\u4e0e\u9875\u9762\u4ea4\u4e92\u65f6\u89e6\u53d1\u7684\u6837\u5f0f\u53d8\u5316\uff0c\u4f8b\u5982\uff1ahover\uff0c\u6253\u5f00\u4e00\u4e2a\u6a21\u6001\u6846\u7b49\u3002\u4e3b\u8981\u65b9\u5f0f\u6709\uff1a \u81ea\u5b9a\u4e49class\uff0c\u4ee5\u524d\u7f00'.is-'\u5f00\u5934\uff0c\u4f8b\u5982\uff1a .is-transitioning , .is-open \u4f2a\u7c7b\uff0c\u4f8b\u5982\uff1a :hover \u3001 :checked \u4ee5\u72b6\u6001\u8bed\u4e49\u4f5c\u4e3a\u5c5e\u6027\u7684html\u5143\u7d20\uff0c\u3002\u4f8b\u5982\uff1a details[open] media queries Theme \u7eaf\u7cb9\u7684\u53ef\u89c1\u6837\u5f0f\uff0c\u4f8b\u5982\uff1a border \uff0c box-shadow \uff0c colors \uff0cbackgrounds\uff0cfont properties\u7b49 \u7c7b\u540d\u683c\u5f0f \u7c7b\u540d\u5e94\u8be5\u4f7f\u7528\u5168\u79f0\u800c\u4e0d\u662f\u7f29\u5199\u3002\u4f8b\u5982\uff1a class=\"button\" \u800c\u4e0d\u662f class=\"btn\" \u7ec4\u4ef6\u7684\u7c7b\u540d\u5e94\u8be5\u4f7f\u7528 - \u5206\u9694\u4e24\u4e2a\u5355\u8bcd\uff0c\u4f8b\u5982\uff1a class=\"button-group\" \uff0c\u800c\u4e0d\u662f class=\"buttongroup\" \u539f\u6587\u5730\u5740\uff0c \u8bf7\u6233\u8fd9\u91cc","title":"\u6700\u4f73\u5b9e\u8df5"},{"location":"drupal/drupal8/Drupal8-drush/","tags":"[drush]","text":"\u6587\u6863\u89c1http://docs.drush.org/en/master/install/\uff0c\u8fd9\u91cc\u8bb0\u5f55\u4e0b\u7b14\u8005\u7684\u5b89\u88c5\u6d41\u7a0b\u3002 1\u3001\u5b89\u88c5composer \u00b6 \u4f5c\u4e3a\u6700\u77e5\u540d\u7684php\u7b2c\u4e09\u65b9\u5e93\u5b89\u88c5\u5de5\u5177\uff0cdrush\u4e5f\u652f\u6301\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u5b89\u88c5\u3002 composer\u7684\u5b89\u88c5\u6bd4\u8f83\u7b80\u5355\u3002 curl -sS https://getcomposer.org/installer | sudo php -- --install-dir = /usr/bin --filename = composer vim ~/.bashrc \u5e76\u6dfb\u52a0\u4e00\u6761 export PATH=\" HOME/.composer/vendor/bin: HOME/.composer/vendor/bin: PATH\"\u3002 2\u3001\u5b89\u88c5drush \u00b6 # Create and/or navigate to a path for the single Composer Drush install. mkdir --parents /opt/drush-8.x cd /opt/drush-8.x # Initialise a new Composer project that requires Drush. composer init --require = drush/drush:8.* -n # Configure the path Composer should use for the Drush vendor binaries. composer config bin-dir /usr/local/bin # Install Drush. composer install \u5b89\u88c5\u5b8c\uff0c\u5982\u679c\u6709Unable to load autoload.php...\u7684\u9519\u8bef\uff0c\u7f16\u8f91 vim /usr/local/drush/drush/drush/includes/preflight.inc \u67e5\u627e$global_vendor_path\uff0c\u4fee\u6539\u4e3a $global_vendor_path = DRUSH_BASE_PATH . '/../vendor/autoload.php' ; \u6267\u884c\u547d\u4ee4 drush version \u5982\u679c\u663e\u793a Drush Version: 8 .1.2 \u5219\u5b89\u88c5\u6210\u529f\u3002 \u4e3a\u4ec0\u4e48\u8981\u5b89\u88c5drush?\u56e0\u4e3adrush\u662f\u4e00\u6b3e\u975e\u5e38\u4f18\u79c0\u7684drupal\u7ba1\u7406\u5de5\u5177\uff0cdrupal\u79bb\u4e0d\u5f00drush\u3002 \u4e0b\u6587\u5c06\u8bb2\u89e3\u5982\u4f55\u628adrupal7\u7684\u6a21\u5757\u8f6c\u5316\u4e3adrupal8\u7684\u6a21\u5757\u3002","title":"\"drush for drupal8\""},{"location":"drupal/drupal8/Drupal8-drush/#1composer","text":"\u4f5c\u4e3a\u6700\u77e5\u540d\u7684php\u7b2c\u4e09\u65b9\u5e93\u5b89\u88c5\u5de5\u5177\uff0cdrush\u4e5f\u652f\u6301\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u5b89\u88c5\u3002 composer\u7684\u5b89\u88c5\u6bd4\u8f83\u7b80\u5355\u3002 curl -sS https://getcomposer.org/installer | sudo php -- --install-dir = /usr/bin --filename = composer vim ~/.bashrc \u5e76\u6dfb\u52a0\u4e00\u6761 export PATH=\" HOME/.composer/vendor/bin: HOME/.composer/vendor/bin: PATH\"\u3002","title":"1\u3001\u5b89\u88c5composer"},{"location":"drupal/drupal8/Drupal8-drush/#2drush","text":"# Create and/or navigate to a path for the single Composer Drush install. mkdir --parents /opt/drush-8.x cd /opt/drush-8.x # Initialise a new Composer project that requires Drush. composer init --require = drush/drush:8.* -n # Configure the path Composer should use for the Drush vendor binaries. composer config bin-dir /usr/local/bin # Install Drush. composer install \u5b89\u88c5\u5b8c\uff0c\u5982\u679c\u6709Unable to load autoload.php...\u7684\u9519\u8bef\uff0c\u7f16\u8f91 vim /usr/local/drush/drush/drush/includes/preflight.inc \u67e5\u627e$global_vendor_path\uff0c\u4fee\u6539\u4e3a $global_vendor_path = DRUSH_BASE_PATH . '/../vendor/autoload.php' ; \u6267\u884c\u547d\u4ee4 drush version \u5982\u679c\u663e\u793a Drush Version: 8 .1.2 \u5219\u5b89\u88c5\u6210\u529f\u3002 \u4e3a\u4ec0\u4e48\u8981\u5b89\u88c5drush?\u56e0\u4e3adrush\u662f\u4e00\u6b3e\u975e\u5e38\u4f18\u79c0\u7684drupal\u7ba1\u7406\u5de5\u5177\uff0cdrupal\u79bb\u4e0d\u5f00drush\u3002 \u4e0b\u6587\u5c06\u8bb2\u89e3\u5982\u4f55\u628adrupal7\u7684\u6a21\u5757\u8f6c\u5316\u4e3adrupal8\u7684\u6a21\u5757\u3002","title":"2\u3001\u5b89\u88c5drush"},{"location":"drupal/drupal8/Drupal8-form/","tags":"[form]","text":"\u8fd9\u91cc\u7b80\u5355\u505a\u4e0bEntity Form\u7684\u5b9e\u73b0\uff0c\u5305\u62ec\u8c03\u7528\u6a21\u677f\u8f93\u51faform. \u8be6\u60c5\u8bf7\u8bbf\u95ee\u4ffa\u7684github\uff0c\u94fe\u63a5\u5730\u5740\uff1a https://github.com/aboutblankchina/drupal8_test 1\u3001\u9996\u5148\u521b\u5efa\u76f8\u5173\u6587\u4ef6 [$install_path]/modules/hello_world/lib/Drupal/hello_world/Entity/Hello.php \u6ce8\uff1a\u8be5\u6587\u4ef6\u5b9a\u4e49\u5b9e\u4f8b\uff08Entity\uff09 \u5982\u4e0b\uff1a <?php /** * @file * Definition of Drupal\\hello_world\\Entity\\Hello. */ namespace Drupal\\hello_world\\Entity ; use Drupal\\Core\\Entity\\ContentEntityBase ; use Drupal\\Core\\Entity\\EntityStorageControllerInterface ; use Drupal\\Core\\Field\\FieldDefinition ; use Drupal\\Core\\Language\\Language ; use Drupal\\Core\\Session\\AccountInterface ; /** * Defines the hello entity class. * * @EntityType( * id = \"hello\", * label = @Translation(\"Hello\"), * controllers = { * \"storage\" = \"Drupal\\Core\\Entity\\FieldableDatabaseStorageController\", * \"view_builder\" = \"Drupal\\Core\\Entity\\EntityViewBuilder\", * \"form\" = { * \"default\" = \"Drupal\\hello_world\\HelloWorldFormController\", * }, * }, * base_table = \"node\", * entity_keys = { * \"id\" = \"nid\", * \"label\" = \"title\", * \"uuid\" = \"uuid\" * }, * links = { * \"edit-form\" = \"hello.edit\", * } * ) */ class Hello extends ContentEntityBase { } \u9700\u8981\u8bf4\u660e\u7684\u662f\uff0c\u4e0a\u9762\u7684\u4e00\u90e8\u5206\u6ce8\u91ca(Annotation)\u662f\u5fc5\u987b\u4f7f\u7528\u7684\uff0c\u8fd9\u662fsymfony\u7684\u6807\u51c6\u3002 Symfony2\u6846\u67b6\u4e2d\u5927\u91cf\u4f7f\u7528\u4e86Annotation\uff1a\u4ece\u7f13\u5b58\u7684\u5b9a\u4e49\u5230\u8def\u7531\u7684\u914d\u7f6e\uff0c\u751a\u81f3\u5230\u8868\u7ed3\u6784\u7684\u5b9a\u4e49\uff0c\u5904\u5904\u90fd\u4f7f\u7528\u4e86Annotation\u529f\u80fd\u3002\u4f60\u751a\u81f3\u53ef\u4ee5\u6839\u636e\u89c4\u8303\u7f16\u5199\u81ea\u5df1\u7684Annotation\u3002\u6240\u4ee5\u5728\u4f7f\u7528Symfony2\u5f00\u53d1\u7a0b\u5e8f\u65f6\uff0c\u590d\u6742\u7684\u903b\u8f91\u4f1a\u53d8\u6210\u4e00\u884c\u884c\u6e05\u6670\u7684\u6ce8\u91ca\uff0c\u7a0b\u5e8f\u7684\u6d41\u7a0b\u63a7\u5236\u5c06\u53d8\u5f97\u975e\u5e38\u7b80\u5355\u3002 \u8be6\u7ec6\u89c1 https://api.drupal.org/api/drupal/core!modules!system!system.api.php/group/annotation/8 \u3002 2\u3001\u5728hello_world.routing.yml\u4e2d\u589e\u52a0\u4e00\u884c hello.edit: path: '/hello/edit' defaults: _entity_form: 'hello.default' requirements: _permission: 'access hello world' 3\u3001\u521b\u5efa\u6587\u4ef6 lib/Drupal/hello_world/HelloWorldFormController.php <?php /** * @file * Definition of Drupal\\hello_world\\HelloWorldFormController. */ namespace Drupal\\hello_world ; use Drupal\\Component\\Utility\\NestedArray ; use Drupal\\Core\\Datetime\\DrupalDateTime ; use Drupal\\Core\\Entity\\ContentEntityFormController ; use Drupal\\Core\\Language\\Language ; use Drupal\\Component\\Utility\\String ; /** * Form controller for the node edit forms. */ class HelloWorldFormController extends ContentEntityFormController { public function form ( array $form , array & $form_state ) { $form = parent :: form ( $form , $form_state ); $entity = $this -> entity ; $form [ '#title' ] = '\u8fd9\u91cc\u5199\u5165\u7f51\u9875\u6807\u9898' ; $form [ 'title' ] = array ( '#type' => 'textfield' , '#title' => t ( 'Title' ), '#default_value' => $entity -> title -> value , ); // \u5982\u679c\u8981\u7528\u6a21\u677f\u8f93\u51fa\u3002\u5219\u8fd9\u6837\u8c03\u7528 $form [ '#theme' ] = 'hello_world_form' ; return $form ; } public function save ( array $form , array & $form_state ) { $entity = $this -> entity ; $entity -> save (); drupal_set_message ( \"hello saved\" ); } public function delete ( array $form , array & $form_state ) { $entity = $this -> entity ; $entity -> delete (); drupal_set_message ( \"hello has been deleted.\" ); $form_sate [ 'redirect_route' ][ 'route_name' ] = '<front>' ; } } 4\u3001\u5982\u679c\u8981\u4f7f\u7528\u6a21\u677f\u8f93\u51fa\uff0c\u5219\u8981\u5b9a\u4e49hook_theme /** * Implements hook_theme(). */ function hello_world_theme() { return array( 'hello_world_form' => array( 'render element' => 'form', 'template' => 'hello-world-form', ), ); } \u8bbf\u95eehttp://localhost/drupal8/hello/edit\u5c31\u53ef\u4ee5\u770b\u5230\u8868\u5355\u4e86\u3002","title":"drupal8\u8868\u5355(form)"},{"location":"drupal/drupal8/Drupal8-routing/","tags":"[routing]","text":"Drupal8\u7684\u8def\u7531\u63a7\u5236\u7cfb\u7edf\u8ddfDrupal7\u5b8c\u5168\u4e0d\u540c\uff0c\u5728drupal7\u4e2d\uff0c\u8def\u7531\u4e00\u822c\u662f\u5b9a\u4e49\u5728module\u6587\u4ef6\u7684hook_menu\u4e2d\uff0c\u5982\u94fe\u63a5\u3001\u8bbf\u95ee\u63a7\u5236\u3001\u56de\u8c03\u65b9\u6cd5\u7b49\u3002\u800cdrupal8\u7531\u4e8e\u5305\u542b\u4e86Symfony2\u7684\u8def\u7531\u7ec4\u4ef6\uff08Symfony2 Routing component\uff09\uff0c\u4e00\u822c\u5b9a\u4e49\u5728{module_name}.routing.yml\u4e2d\u3002 \u672c\u6587\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u8def\u7531\u63a7\u5236\u5668\uff0c\u5e76\u5982\u4f55\u4f7f\u7528\u4f9d\u8d56\u6ce8\u5165(DI)\u3002 \u4e0b\u9762\u8fd9\u5f20\u56fe\u975e\u5e38\u660e\u4e86\u7684\u8bf4\u660e\u4e86\u4ed6\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u672c\u6587github\uff1a https://github.com/RamboLau/drupal8-demos/tree/master/routing_example \u4e00\u3001\u9759\u6001\u8def\u7531(Static Routes) \u00b6 1\u3001Drupal7\u8def\u7531 \u00b6 \u5728Drupal7\u4e2d\uff0c\u901a\u8fc7hook_menu\u6765\u7ba1\u7406\u8def\u7531\uff0c\u4f46\u662f\u8fd9\u5c31\u5bfc\u81f4\u4ee3\u7801\u7684\u8026\u5408\u6027\u592a\u9ad8\uff0c\u5982\u679c\u8981\u63d0\u4f9b\u4e30\u5bcc\u7684\u8fd4\u56de\u683c\u5f0f\uff0c\u5982JSON, XML or HTML\uff0c\u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\uff01 \u5982\uff1a <?php /** * Implements hook_menu() */ function routing_example_menu () { $items [ 'hello' ] = array ( 'title' => 'Hello World' , 'description' => \"hello world page\" , 'route_name' => 'helloWorldPage' , 'type' => MENU_LOCAL_TASK , ); return $items ; } /** * Implements hook_permission(). */ function routing_example_permission () { return array ( 'access hello world' => array ( 'title' => t ( 'Access hello world page' ), ), ); } ?> 2\u3001Drupal8\u8def\u7531 \u00b6 routing_example.routing.yml \u00b6 routing_example.example_controller_index: path: '/routing_example/index/hello/{name}' defaults: _controller: '\\Drupal\\routing_example\\Controller\\BaseController::index' _title: 'hello world' requirements: _permission: 'access content' routing_example.example_controller_dependency_injection: path: '/routing_example/dependency_injection' defaults: _controller: '\\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController::index' _title: 'hello world' requirements: _permission: 'access content' src/Controller/BaseController.php \u00b6 \u8fd9\u662f\u4e00\u4e2a\u666e\u901a\u7684Controller\u7c7b\uff0c\u901a\u8fc7\u8bbf\u95ee/routing_example/index/hello/{name}\u8c03\u7528index\uff0c\u8f93\u51faImplement method: index with parameter(s): $name\u3002 <?php /** * @file * Contains \\Drupal\\routing_example\\Controller\\BaseController. */ namespace Drupal\\routing_example\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; /** * Class BaseController. * * @package Drupal\\routing_example\\Controller */ class BaseController extends ControllerBase { /** * Index. * * @return string * Return Hello string. */ public function index ( $name ) { return [ '#type' => 'markup' , '#markup' => $this -> t ( \"Implement method: index with parameter(s): $name \" ) ]; } } ?> src/Controller/ExampleDependencyInjectionController.php \u00b6 \u8fd9\u662f\u4e00\u4e2a\u4f9d\u8d56\u6ce8\u5165\u7684Controler\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u4ee5\u8bbf\u95ee\u6570\u636e\u5e93\u4e3a\u4f8b\u3002 <?php /** * @file * Contains \\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController. */ namespace Drupal\\routing_example\\Controller ; use Drupal\\Core\\DependencyInjection\\ContainerInjectionInterface ; use Drupal\\Core\\Database\\Connection ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; /** * Class ExampleDependencyInjectionController. * * @package Drupal\\routing_example\\Controller */ class ExampleDependencyInjectionController implements ContainerInjectionInterface { /** * The database connection. * * @var \\Drupal\\Core\\Database\\Connection; */ protected $database ; /** * Constructs a \\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController object. * * @param \\Drupal\\Core\\Database\\Connection $database * The database connection. */ public function __construct ( Connection $database ) { $this -> database = $database ; } /** * {@inheritdoc} */ public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'database' )); } /** * Displays a list of nodes. */ public function index () { // query the database $result = $this -> database -> query ( 'SELECT * from {node} WHERE nid = 1' ) -> fetchAll (); return [ '#type' => 'markup' , '#markup' => json_encode ( $result ), ]; } } ?> \u8bbf\u95ee http://127.0.0.1/routing_example/dependency_injection \u8f93\u51fa\uff1a \u4e8c\u3001\u52a8\u6001\u8def\u7531(Dynamic Routes) \u00b6 \u9759\u6001\u8def\u7531\u6211\u4eec\u4e00\u822c\u662f\u5728{module_name}.routing.yml\u4e2d\u6307\u5b9a\uff0c\u90a3\u4e48\u5982\u4f55\u5b9a\u4e49\u52a8\u6001\u8def\u7531\u5462\uff1f 1\u3001Drupal7\u52a8\u6001\u8def\u7531 \u00b6 \u4e00\u822c\u662f\u901a\u8fc7foreach hook_menu\u5b9e\u73b0\uff0c\u5982\uff1a /** * Implements hook_menu(). */ function routing_example_menu() { $items = array(); foreach (routing_example_types() as $type) { $items['routing_example/add/' . $type->machine_name] = array( 'title' => $type->title, 'page callback' => 'routing_example_type_add_page', 'access arguments' => 'create ' . $type->type, ); } return $items; } 2\u3001Drupal8\u52a8\u6001\u8def\u7531 \u00b6 \u5728D8\u4e2d\uff0c\u6211\u4eec\u63a8\u8350\u4f7f\u7528RouteSubscriber\u6765\u5b9e\u73b0\u52a8\u6001\u8def\u7531\u3002 routing_example.routing.yml \u00b6 \u6dfb\u52a0\uff1a route_callbacks: - '\\Drupal\\routing_example\\Routing\\ExampleRoutes::routes' src/Routing/ExampleRoutes.php \u00b6 <?php /** * @file * Contains \\Drupal\\routing_example\\Routing\\ExampleRoutes. */ namespace Drupal\\routing_example\\Routing ; use Symfony\\Component\\Routing\\Route ; use Symfony\\Component\\Routing\\RouteCollection ; /** * Defines dynamic routes. */ class ExampleRoutes { /** * {@inheritdoc} */ public function routes () { $route_collection = new RouteCollection (); // Dynamically routing. $route = new Route ( 'routing_example/add/dynamic_route' , array ( '_controller' => '\\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController::index' , '_title' => 'Hello' ), // Route requirements: array ( '_permission' => 'access content' , ) ); // Add the route under the name 'example.content'. $route_collection -> add ( 'routing_example.add.dynamic_route' , $route ); return $route_collection ; } } ?> \u8bbf\u95ee\uff1a http://127.0.0.1/routing_example/add/dynamic_route \u52a8\u6001\u8def\u7531\u8fd8\u6709\u5f88\u591a\u9ad8\u7ea7\u7684\u73a9\u6cd5\uff0c\u6bd4\u5982\u4f7f\u7528Entity Storage\u7b49\uff0c\u540e\u7eed\u518d\u6765\u4ecb\u7ecd\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/developing/api/8/routing 2\u3001 https://www.drupal.org/node/2116767 3\u3001 https://www.drupal.org/node/2092643 4\u3001 http://www.sitepoint.com/build-drupal-8-module-routing-controllers-menu-links/ 5\u3001 http://www.slideshare.net/ygerasimov/drupal-8-routing 6\u3001 https://www.previousnext.com.au/blog/using-drupal-8s-new-route-controllers 7\u3001 https://www.previousnext.com.au/blog/dynamic-routes-drupal-8-routesubscriber 8\u3001 https://www.drupal.org/node/2122201","title":"\"Drupal8 Routing\""},{"location":"drupal/drupal8/Drupal8-routing/#static-routes","text":"","title":"\u4e00\u3001\u9759\u6001\u8def\u7531(Static Routes)"},{"location":"drupal/drupal8/Drupal8-routing/#1drupal7","text":"\u5728Drupal7\u4e2d\uff0c\u901a\u8fc7hook_menu\u6765\u7ba1\u7406\u8def\u7531\uff0c\u4f46\u662f\u8fd9\u5c31\u5bfc\u81f4\u4ee3\u7801\u7684\u8026\u5408\u6027\u592a\u9ad8\uff0c\u5982\u679c\u8981\u63d0\u4f9b\u4e30\u5bcc\u7684\u8fd4\u56de\u683c\u5f0f\uff0c\u5982JSON, XML or HTML\uff0c\u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\uff01 \u5982\uff1a <?php /** * Implements hook_menu() */ function routing_example_menu () { $items [ 'hello' ] = array ( 'title' => 'Hello World' , 'description' => \"hello world page\" , 'route_name' => 'helloWorldPage' , 'type' => MENU_LOCAL_TASK , ); return $items ; } /** * Implements hook_permission(). */ function routing_example_permission () { return array ( 'access hello world' => array ( 'title' => t ( 'Access hello world page' ), ), ); } ?>","title":"1\u3001Drupal7\u8def\u7531"},{"location":"drupal/drupal8/Drupal8-routing/#2drupal8","text":"","title":"2\u3001Drupal8\u8def\u7531"},{"location":"drupal/drupal8/Drupal8-routing/#routing_exampleroutingyml","text":"routing_example.example_controller_index: path: '/routing_example/index/hello/{name}' defaults: _controller: '\\Drupal\\routing_example\\Controller\\BaseController::index' _title: 'hello world' requirements: _permission: 'access content' routing_example.example_controller_dependency_injection: path: '/routing_example/dependency_injection' defaults: _controller: '\\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController::index' _title: 'hello world' requirements: _permission: 'access content'","title":"routing_example.routing.yml"},{"location":"drupal/drupal8/Drupal8-routing/#srccontrollerbasecontrollerphp","text":"\u8fd9\u662f\u4e00\u4e2a\u666e\u901a\u7684Controller\u7c7b\uff0c\u901a\u8fc7\u8bbf\u95ee/routing_example/index/hello/{name}\u8c03\u7528index\uff0c\u8f93\u51faImplement method: index with parameter(s): $name\u3002 <?php /** * @file * Contains \\Drupal\\routing_example\\Controller\\BaseController. */ namespace Drupal\\routing_example\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; /** * Class BaseController. * * @package Drupal\\routing_example\\Controller */ class BaseController extends ControllerBase { /** * Index. * * @return string * Return Hello string. */ public function index ( $name ) { return [ '#type' => 'markup' , '#markup' => $this -> t ( \"Implement method: index with parameter(s): $name \" ) ]; } } ?>","title":"src/Controller/BaseController.php"},{"location":"drupal/drupal8/Drupal8-routing/#srccontrollerexampledependencyinjectioncontrollerphp","text":"\u8fd9\u662f\u4e00\u4e2a\u4f9d\u8d56\u6ce8\u5165\u7684Controler\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u4ee5\u8bbf\u95ee\u6570\u636e\u5e93\u4e3a\u4f8b\u3002 <?php /** * @file * Contains \\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController. */ namespace Drupal\\routing_example\\Controller ; use Drupal\\Core\\DependencyInjection\\ContainerInjectionInterface ; use Drupal\\Core\\Database\\Connection ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; /** * Class ExampleDependencyInjectionController. * * @package Drupal\\routing_example\\Controller */ class ExampleDependencyInjectionController implements ContainerInjectionInterface { /** * The database connection. * * @var \\Drupal\\Core\\Database\\Connection; */ protected $database ; /** * Constructs a \\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController object. * * @param \\Drupal\\Core\\Database\\Connection $database * The database connection. */ public function __construct ( Connection $database ) { $this -> database = $database ; } /** * {@inheritdoc} */ public static function create ( ContainerInterface $container ) { return new static ( $container -> get ( 'database' )); } /** * Displays a list of nodes. */ public function index () { // query the database $result = $this -> database -> query ( 'SELECT * from {node} WHERE nid = 1' ) -> fetchAll (); return [ '#type' => 'markup' , '#markup' => json_encode ( $result ), ]; } } ?> \u8bbf\u95ee http://127.0.0.1/routing_example/dependency_injection \u8f93\u51fa\uff1a","title":"src/Controller/ExampleDependencyInjectionController.php"},{"location":"drupal/drupal8/Drupal8-routing/#dynamic-routes","text":"\u9759\u6001\u8def\u7531\u6211\u4eec\u4e00\u822c\u662f\u5728{module_name}.routing.yml\u4e2d\u6307\u5b9a\uff0c\u90a3\u4e48\u5982\u4f55\u5b9a\u4e49\u52a8\u6001\u8def\u7531\u5462\uff1f","title":"\u4e8c\u3001\u52a8\u6001\u8def\u7531(Dynamic Routes)"},{"location":"drupal/drupal8/Drupal8-routing/#1drupal7_1","text":"\u4e00\u822c\u662f\u901a\u8fc7foreach hook_menu\u5b9e\u73b0\uff0c\u5982\uff1a /** * Implements hook_menu(). */ function routing_example_menu() { $items = array(); foreach (routing_example_types() as $type) { $items['routing_example/add/' . $type->machine_name] = array( 'title' => $type->title, 'page callback' => 'routing_example_type_add_page', 'access arguments' => 'create ' . $type->type, ); } return $items; }","title":"1\u3001Drupal7\u52a8\u6001\u8def\u7531"},{"location":"drupal/drupal8/Drupal8-routing/#2drupal8_1","text":"\u5728D8\u4e2d\uff0c\u6211\u4eec\u63a8\u8350\u4f7f\u7528RouteSubscriber\u6765\u5b9e\u73b0\u52a8\u6001\u8def\u7531\u3002","title":"2\u3001Drupal8\u52a8\u6001\u8def\u7531"},{"location":"drupal/drupal8/Drupal8-routing/#routing_exampleroutingyml_1","text":"\u6dfb\u52a0\uff1a route_callbacks: - '\\Drupal\\routing_example\\Routing\\ExampleRoutes::routes'","title":"routing_example.routing.yml"},{"location":"drupal/drupal8/Drupal8-routing/#srcroutingexampleroutesphp","text":"<?php /** * @file * Contains \\Drupal\\routing_example\\Routing\\ExampleRoutes. */ namespace Drupal\\routing_example\\Routing ; use Symfony\\Component\\Routing\\Route ; use Symfony\\Component\\Routing\\RouteCollection ; /** * Defines dynamic routes. */ class ExampleRoutes { /** * {@inheritdoc} */ public function routes () { $route_collection = new RouteCollection (); // Dynamically routing. $route = new Route ( 'routing_example/add/dynamic_route' , array ( '_controller' => '\\Drupal\\routing_example\\Controller\\ExampleDependencyInjectionController::index' , '_title' => 'Hello' ), // Route requirements: array ( '_permission' => 'access content' , ) ); // Add the route under the name 'example.content'. $route_collection -> add ( 'routing_example.add.dynamic_route' , $route ); return $route_collection ; } } ?> \u8bbf\u95ee\uff1a http://127.0.0.1/routing_example/add/dynamic_route \u52a8\u6001\u8def\u7531\u8fd8\u6709\u5f88\u591a\u9ad8\u7ea7\u7684\u73a9\u6cd5\uff0c\u6bd4\u5982\u4f7f\u7528Entity Storage\u7b49\uff0c\u540e\u7eed\u518d\u6765\u4ecb\u7ecd\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/developing/api/8/routing 2\u3001 https://www.drupal.org/node/2116767 3\u3001 https://www.drupal.org/node/2092643 4\u3001 http://www.sitepoint.com/build-drupal-8-module-routing-controllers-menu-links/ 5\u3001 http://www.slideshare.net/ygerasimov/drupal-8-routing 6\u3001 https://www.previousnext.com.au/blog/using-drupal-8s-new-route-controllers 7\u3001 https://www.previousnext.com.au/blog/dynamic-routes-drupal-8-routesubscriber 8\u3001 https://www.drupal.org/node/2122201","title":"src/Routing/ExampleRoutes.php"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/","tags":"[theme]","text":"Drupal8\u4e2d\u7684Twig \u00b6 Drupal8\u4e2dTwig\u66ff\u6362\u4e86PHPTemplate\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u5bfc\u81f4\u7684\u7ed3\u679c\u4e4b\u4e00\u5c31\u662f\u6a21\u7248\u7684\u540e\u7f00\u7531\u539f\u6765\u7684.tpl.php\u53d8\u6210\u4e86.html.twig \u641c\u7d22Twig\u6a21\u7248\u4e2d\u7684\u53d8\u91cf \u00b6 \u5728\u4f7f\u7528Twig\u6a21\u7248\u7684\u65f6\u5019\uff0c\u5927\u90e8\u5206\u7684\u53d8\u91cf\u90fd\u5df2\u6ce8\u91ca\u7684\u5f62\u5f0f\u5199\u5728\u4e86\u6a21\u7248\u4e2d\u3002\u7136\u540e\uff0c\u5f53\u6211\u4eec\u65b0\u589e\u4e86\u53d8\u91cf\uff0c\u6211\u4eec\u5c31\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u641c\u7d22\u5230\u5f53\u524d\u6a21\u7248\u6240\u6709\u53d8\u91cf\u7684\u65b9\u6cd5\u3002Twig\u63d0\u4f9b\u4e86 dump \u51fd\u6570\u3002 dump \u51fd\u6570\u5e76\u4e0d\u4f1a\u6253\u5370\u6240\u6709\u7684\u8f93\u51fa\uff0c\u9664\u975e\u5f00\u542f\u4e86debug\u3002 dump \u51fd\u6570\u7528\u4e8e\u6253\u5370\u5355\u4e2a\u53d8\u91cf\u7684\u4fe1\u606f\u6216\u8005\u6a21\u7248\u4e2d\u7684\u6240\u6709\u53d8\u91cf\u3002 \u5355\u4e2a\u53d8\u91cf \u00b6 \u5982\u679c\u4f60\u7684\u6a21\u7248\u4e2d\u6709\u4e00\u4e2atitle\u53d8\u91cf\uff0c\u4e0b\u9762\u5728\u4f60\u7684\u6a21\u7248\u4e2ddump\u51fa\u8fd9\u4e2a\u53d8\u91cf\u7684\u5185\u5bb9\uff1a {{ dump(title) }} \u6a21\u7248\u4e2d\u7684\u6240\u6709\u53d8\u91cf \u00b6 \u8981\u6253\u5370\u51fa\u6a21\u7248\u4e2d\u7684\u6240\u6709\u7684\u53d8\u91cf\uff0c\u4f60\u53ef\u4ee5\uff1a {{ dump() }} \u8981\u6253\u5370\u51fa\u53d8\u91cf\u7684\u952e\uff1a {{ dump(_context|keys) }} PS: \u8fd9\u91cc\u7684_context\u662f\u4e00\u5168\u5c40\u53d8\u91cf\uff0c\u6307\u5f53\u524d\u6a21\u7248\u4e2d\u6240\u6709\u7684\u4e0a\u4e0b\u6587\u548c\u53d8\u91cf\uff0c\u6bd4\u5982\u901a\u8fc7theme\u51fd\u6570\u4f20\u9012\u7684\u53d8\u91cf\uff0cpreprocess\u51fd\u6570\u5904\u7406\u7684\u53d8\u91cf\uff0c\u6216\u8005\u8c03\u7528set\u8bbe\u7f6e\u7684\u53d8\u91cf\u3002 \u5168\u5c40\u53d8\u91cf\uff1a - _context \u5f53\u524d\u6a21\u7248\u4e2d\u6240\u6709\u7684\u4e0a\u4e0b\u6587\u548c\u53d8\u91cf - _charset \u53ea\u5f53\u524d\u7684\u7f16\u7801\u65b9\u5f0f \u614e\u7528dump() \u00b6 dump() \u51fd\u6570\u867d\u7136\u53ef\u4ee5\u8f93\u51fa\u6240\u6709\u7684\u53d8\u91cf\uff0c\u4f46\u662f\u5374\u5e26\u6765\u4e86\u5de8\u5927\u7684\u5185\u5b58\u6d88\u8017\uff0c\u6545\u4f60\u53ef\u4ee5\u5faa\u73af _context \u6765\u67e5\u770b\u6240\u6709\u7684\u952e\uff1a <ol> {% for key, value in _context %} <li>{{ key }}</li> {% endfor %} </ol> \u63a5\u4e0b\u6765\u518d\u52a0\u4e0a\u4e00\u4e9b\u6761\u4ef6\u5224\u65ad\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u4f60\u9700\u8981\u7684\u53d8\u91cf\u4e86\u3002 Drupal8\u4e3b\u9898 \u00b6 \u6a21\u7248\u547d\u540d\u60ef\u4f8b \u00b6 Drupal\u662f\u6309\u7167\u4e00\u5b9a\u7684\u547d\u540d\u60ef\u4f8b\u6765\u52a0\u8f7d\u6a21\u7248\u7684\uff0c\u8fd9\u5c31\u65b9\u4fbf\u5f00\u53d1\u8005\u53ef\u4ee5\u8986\u76d6\u539f\u6709\u7684\u6a21\u7248\u3002\u5f53\u7136\uff0c\u8bb0\u5f97\u6e05\u9664\u7f13\u5b58\u3002 HTML \u00b6 HTML\u6a21\u7248\u63d0\u4f9b\u4e86\u5305\u62echead\uff0ctitle\u4ee5\u53cabody\u6807\u7b7e\u7b49\u57fa\u7840\u7ed3\u6784\u7684html\u9875\u9762\u3002 \u57fa\u7840\u6a21\u7248\uff1ahtml.html.twig(\u4f4d\u4e8e\uff1acore/modules/system/templates/html.html.twig) \u4e0b\u9762\u662f\u4e00\u4e9b\u4f60\u53ef\u4ee5\u8986\u76d6\u7684\u57fa\u7840\u6a21\u7248\u7684\u4f8b\u5b50\uff1a 1. html--internalviewpath.html.twig 2. html--node--id.html.twig 3. html.html.twig Page \u00b6 \u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1apage--[front|internal/path].html.twig \u57fa\u7840\u6a21\u7248\uff1apage.html.twig(\u4f4d\u4e8e: core/modules/system/templates/page.html.twig) \u4e0b\u9762\u662fpage\u6a21\u7248\u7684\u6a21\u7248\u5efa\u8bae\uff0c\u4e3e\u4e2a\u4f8b\u5b50\u201c http://www.example.com/node/1/edit \u201d\uff1a page--node--edit.html.twig page--node--1.html.twig page--node.html.twig page.html.twig Regions \u00b6 \u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1aregion--[region].html.twig \u57fa\u7840\u6a21\u7248\uff1aregion.html.twig(\u4f4d\u4e8e: core/modules/system/templates/region.html.twig) \u5f53\u4e00\u4e2a\u9875\u9762\u7684\u533a\u57df\u4e2d\u6709\u5185\u5bb9\u65f6\uff0c\u7cfb\u7edf\u4f1a\u4ece\u533a\u5757\u7cfb\u7edf\u6216\u8005\u4e00\u4e2a\u7c7b\u4f3c\u4e8e hook_page_build() \u7684\u65b9\u6cd5\u4e2d\u8c03\u7528\u533a\u57df\u6a21\u7248\u3002 Blocks \u00b6 \u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1ablock--[module|-delta]].html.twig \u57fa\u7840\u6a21\u7248\uff1ablock.html.twig (\u4f4d\u4e8e: core/modules/block/templates/block.html.twig) block--module--delta.html.twig block--module.html.twig block.html.twig \u8fd9\u91cc\u7684module\u5c31\u662f\u6a21\u5757\u540d\uff0cdelta\u662f\u6a21\u5757\u7ed9\u533a\u5757\u8bbe\u7f6e\u7684\u5185\u90e8id\u6807\u8bc6 Nodes \u00b6 \u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1anode--[type|nodeid]--[viewmode].html.twig \u57fa\u7840\u6a21\u7248\uff1anode.html.twig (\u4f4d\u4e8e: core/modules/node/templates/node.html.twig) \u6a21\u7248\u5efa\u8bae\uff1a node--nodeid--viewmode.html.twig node--nodeid.html.twig node--type--viewmode.html.twig node--type.html.twig node--viewmode.html.twig node.html.twig Forums \u00b6 \u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1aforums--[[container|topic]--forumID].html.twig \u57fa\u7840\u6a21\u7248\uff1a forums.html.twig (\u4f4d\u4e8e: core/modules/forum/templates/forums.html.twig) \u6a21\u7248\u5efa\u8bae\uff1a \u8bba\u575b\u5bb9\u5668\uff1a forums--containers--forumID.html.twig forums--forumID.html.twig forums--containers.html.twig forums.html.twig \u8bba\u575b\u4e3b\u9898\u5185\u5bb9 forums--topics--forumID.html.twig forums--forumID.html.twig forums--topics.html.twig forums.html.twig PHPTemplate\u4e0eTwig\u4e3b\u9898\u8303\u4f8b\u7684\u6bd4\u8f83 \u00b6 \u63a5\u4e0b\u6765\uff0c\u770b\u4e0bPHPTemplate\u4e0eTwig\u7684\u533a\u522b\u3002 \u5173\u4e8eTwig \u00b6 Twig\u662f\u57fa\u4e8ephp\u7684\u7f16\u8bd1\u6a21\u7248\u8bed\u8a00\u3002\u5f53\u4f60\u7684\u9875\u9762\u9700\u8981\u6e32\u67d3\u663e\u793a\u7684\u65f6\u5019\uff0cTwig\u5f15\u64ce\u4f1a\u627e\u5230\u5bf9\u5e94\u7684\u6a21\u7248\u5e76\u628a\u5b83\u7f16\u8bd1\u6210php\u6a21\u7248\uff0c\u5b58\u653e\u5728sites/default/files/php_storage/\u76ee\u5f55\u4e0b\u3002 1.Docblock \u00b6 PHPTemplate\uff1a <?php /** * @file * File description */ ?> Twig\uff1a {# /** * @file * File description */ #} 2.\u6587\u4ef6\u548c\u51fd\u6570\u540d \u00b6 PHPTemplate\u6587\u4ef6\uff1anode--article.tpl.php Twig\u6587\u4ef6\uff1anode--article.html.twig PHPTemplate\u51fd\u6570\uff1atheme_node_links() Twig\u6587\u4ef6\uff1anode-links.html.twig 3.\u53d8\u91cf \u00b6 \u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf PHPTemplate: <div class=\"content\"><?php print $content; ?></div> Twig: <div class=\"content\">{{ content }}</div> \u8f93\u51fa\u4e00\u4e2a\u54c8\u5e0c\u952e\u503c PHPTemplate: <?php print $item['#item']['alt']; ?> Twig: {{ item['#item'].alt }} \u53d8\u91cf\u8d4b\u503c PHPTemplate: <?php $custom_var = $content->comments; ?> Twig: {% set custom_var = content.comments %} \u6570\u7ec4\u521d\u59cb\u5316 PHPTemplate: <?php $args = array('!author' => $author, '!date' => $created); ?> Twig: {% set args = {'!author': author, '!date': created} %} 4.\u6761\u4ef6\u5224\u65ad \u00b6 PHPTemplate: <?php if ($content->comments): endif; ?> Twig: {% if content.comments %} {% endif %} PHPTemplate: <?php if (!empty($content->comments)): endif; ?> Twig: {% if content.comments is not empty %} {% endif %} PHPTemplate: <?php if (isset($content->comments)): endif; ?> Twig: {% if content.comments is defined %} {% endif %} PHPTemplate: <?php if ($count > 0): endif; ?> Twig: {% if count > 0 %} {% endif %} 5.\u63a7\u5236\u7ed3\u6784 \u00b6 PHPTemplate: <?php foreach ($users as $user) {} ?> Twig: {% for user in users %} {% endfor %} 6.\u8fc7\u6ee4 \u00b6 check_plain\uff1a PHPTemplate: <?php print check_plain($title); ?> Twig: {{ title|striptags }} Translate\uff1a PHPTemplate: <?php print t('Home'); ?> Twig: {{ 'Home'|t }} Translate with substitutions: PHPTemplate: <?php print t('Welcome, @username', array('@username' => $user->name)); ?> Twig: {{ 'Welcome, @username'|t({ '@username': user.name }) }} Drupal8 Twig(\u91c7\u7528 trans \u6807\u7b7e\u6269\u5c55) {% set username = user.name %} {% trans %} Welcome, {{ username }} {% endtrans %} implode: PHPTemplate: <?php echo implode(', ', $usernames); ?> Twig: {{ usernames | join(', ') }} PHPTemplate\u7684\u4f8b\u5b50\u4e2d usernames\u9700\u8981\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u539f\u751f\u7684Twig\u4e5f\u9700\u8981 usernames\u9700\u8981\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u539f\u751f\u7684Twig\u4e5f\u9700\u8981 usernames\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u4f46\u662fDrupal8\u4e2d\u7684twig\u8fd8\u53ef\u4ee5\u662f\u4e00\u4e2a\u53ef\u4ee5\u6e32\u67d3\u7684\u6570\u7ec4\u5bf9\u8c61\u3002\u8fd9\u5c31\u662fDrupal8\u4e2d\u7684twig\u4e0e\u539f\u751ftwig\u7684\u672c\u8d28\u533a\u522b\u3002Drupal8\u4e2d\u7684twig\u53ef\u4ee5\u201c\u6253\u5370\u201d\u51fa\u7eaf\u6587\u672c\u548c\u53ef\u6e32\u67d3\u7684\u6570\u7ec4\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a {% set numbers = [{'#markup': 'One'}, {'#markup':'Two'}, {'#markup':'Three'}] %} {{ numbers }} \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u6570\u636e\u9879\u90fd\u662f\u4ee5\u9017\u53f7\u76f8\u9694\u7684\u3002\u4f46\u662f\uff0c\u8f93\u51fa\u7684\u7ed3\u679c\u5374\u662f\uff1a OneTwoThree Escape\uff1a PHPTemplate: <?php echo check_plain($title); ?> \u539f\u751fTwig: {{ title|e }} Drupal 8 Twig2: {{ title }} 7.\u7a7a\u767d \u00b6 <div class=\"body\"> {{- block.content -}} </div> \u7c7b\u4f3c\u4e8e <div class=\"body\">{{ block.content }}</div> debug twig\u6a21\u7248 \u00b6 twig\u6a21\u7248\u5f15\u64ce\u63d0\u4f9b\u4e86\u4e00\u4e2adebug\u5de5\u5177\u3002 \u542f\u7528debugging \u00b6 \u5728sites/default/services.yml\u542f\u7528Twig Debugging\u3002 \u8bbe\u7f6edebug\u53d8\u91cf\u4e3atrue parameters: twig.config: debug: true \u81ea\u52a8\u52a0\u8f7d\u7f16\u8bd1\u7684\u6a21\u7248 \u00b6 \u51fa\u4e8e\u6027\u80fd\u8003\u8651\uff0cTwig\u6a21\u7248\u88ab\u7f16\u8bd1\u6210\u4e00\u4e2aPHP\u7c7b\u5b58\u653e\u5728\u78c1\u76d8\u4e0a\uff0c\u4f46\u8fd9\u610f\u5473\u7740\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f60\u7684\u6a21\u7248\u4e0d\u4f1a\u5728\u4f60\u505a\u51fa\u66f4\u6539\u65f6\u53d1\u751f\u5237\u65b0\u3002\u4e3a\u4e86\u4f7fTwig\u6a21\u7248\u53ef\u4ee5\u81ea\u52a8\u5237\u65b0\uff0c\u542f\u7528 services.yml \u4e2d\u7684deubg\u9009\u9879\u3002\u6b32\u77e5\u8be6\u60c5\uff0c\u53c2\u89c1\uff1a https://drupal.org/node/1903374 \u6253\u5370\u6240\u6709\u7684\u53d8\u91cf {# \u6253\u5370\u6240\u6709\u7684\u53d8\u91cf #} {{ dump() }} {# \u6253\u5370\u5355\u4e2a\u53d8\u91cf #} {{ dump(var) }} Filters---\u4fee\u6539Twig\u6a21\u7248\u4e2d\u7684\u53d8\u91cf \u00b6 Twig\u4e2d\u7684Filters\u7528\u4e8e\u4fee\u6539\u53d8\u91cf\u3002Filters\u548c\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\u53f7(|)\u5206\u9694\uff0c\u8fd8\u53ef\u80fd\u5e26\u70b9\u53ef\u9009\u7684\u53c2\u6570\u3002\u591a\u4e2afilters\u53ef\u4ee5\u94fe\u5f0f\u7684\u8fde\u5728\u4e00\u8d77\uff0c\u524d\u4e00\u4e2a\u7684\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u7684\u8f93\u5165\u3002 \u4f8b\u5982\uff1a {{ ponies|safe_join(\", \")|lower}} Drupal\u7684Twig\u6a21\u7248\u4e2d\u4f7f\u7528\u7684filter\u7531\u6240\u6709\u7684Twig\u5f15\u64ce\u81ea\u5e26\u7684filter\u548cdrupal\u4e2d\u7684\u51e0\u4e2a\u7279\u6b8a\u7684filters\u7ec4\u6210\u3002 Twig filters \u00b6 \u8be6\u89c1\uff1a twig filter\u5217\u8868 Drupal\u81ea\u8eab\u7684filters \u00b6 Drupal\u4e2d\u7684filters\u662f\u5728 Drupal\\Core\\Template\\TwigExtension::getFilters(). \u4e2d\u58f0\u660e\u7684\u3002 \u7ffb\u8bd1filters \u00b6 t t filter\u8c03\u7528Drupal\u7684t\u51fd\u6570\u7ffb\u8bd1\u7ed9\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u53ef\u7528\u4e8e\u4efb\u4f55\u5b57\u7b26\u4e32\u3002 \u4f8b\u5982\uff1a <a href=\"{{ url('<front>') }}\" title=\"{{ 'Home'|t }}\" rel=\"home\" class=\"site-logo\"></a> placeholder\u8f93\u51fa\u5b89\u5168\u7684html\u5e76\u4f7f\u7528 drupal_placeholder() \u8fdb\u884c\u683c\u5f0f\u5316\u8f93\u51fa\u6210\u5f3a\u8c03\u6587\u672c\u3002 \u4f8b\u5982\uff1a {% trans %}Submitted on {{ date|placeholder }}{% endtrans %} {{ var1|t }} {{ var1|placeholder }} {% trans %}{{ var1 }}{% endtrans %} \u5c3d\u53ef\u80fd\u907f\u514d\u4f7f\u7528|raw filter\uff0c\u7279\u522b\u662f\u4f60\u6b63\u5728\u8f93\u51fa\u4e00\u4e9b\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u7684\u65f6\u5019\u3002\u8be6\u89c1 https://www.drupal.org/node/2296163 \uff1a {{ var1|raw }} \u989d\u5916\u7684filters \u00b6 drupal_escape drupal_escape\u7528\u4e8e\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u5b89\u5168\u5904\u7406\u540e\u8fdb\u884c\u63d2\u5165\u64cd\u4f5c\u5e76\u8f93\u51fa\u663e\u793a\uff0c\u5b83\u66ff\u4ee3\u4e86twig\u9ed8\u8ba4\u7684escape filter\u3002\u53c2\u89c1 twig_drupal_escape_filter safe_join safe_join\u5c06\u51e0\u4e2a\u5b57\u7b26\u4e32\u7528\u7ed9\u5b9a\u7684\u5206\u9694\u7b26\u8fde\u63a5\u5728\u4e00\u5757\u513f\u3002 \u4f8b\u5982\uff1a {{ items|safe_join(', ') }} without without\u4f1a\u521b\u5efa\u51fa\u5f53\u524d\u8fd9\u4e2a\u53ef\u4ee5\u6e32\u67d3\u7684\u6570\u7ec4\u7684\u62f7\u8d1d\uff0c\u4f46\u662f\u4f1a\u628a\u4f20\u5165\u7684\u53c2\u6570\u5f53\u4f5c\u952e\uff0c\u5220\u9664\u952e\u5173\u8054\u7684\u6240\u6709\u5b50\u5143\u7d20\u3002\u4f46\u662f\uff0c\u5f53\u524d\u8fd9\u4e2a\u6570\u7ec4\u4e0d\u53d7\u5f71\u54cd\uff0c\u4f9d\u65e7\u53ef\u4ee5\u6253\u5370\u51fa\u5b50\u5143\u7d20\u3002\u8be6\u89c1\uff1a twig_without \u4f8b\u5982\uff1a {# \u6253\u5370content\u53d8\u91cf\uff0c\u9664\u4e86content.links #} {{ content|without('links') }} clean_class clean_class filter\u4f1a\u5904\u7406\u51fa\u4e00\u4e2a\u5b89\u5168\u7684\u53ef\u7528\u7684html\u7c7b\u540d\u3002\u8be6\u89c1\uff1a Html::getClass() clean_id clean_id filter\u4f1a\u5904\u7406\u51fa\u4e00\u4e2a\u5b89\u5168\u7684\u53ef\u7528\u7684html id\u3002\u8be6\u89c1\uff1a Html:getID() format_date format_date filter\u683c\u5f0f\u5316\u65e5\u671f\u5b57\u7b26\u4e32\uff0c\u8be6\u89c1\uff1a DateFormatter::format() Functions---Twig\u6a21\u7248\u4e2d\u7684\u51fd\u6570 \u00b6 url() path() url_from_path() link($text, $url, $attributes) {{ link(item.title, item.url, { 'class':['foo', 'bar', 'baz']} ) }} file_url($uri) \u8def\u5f84\u53c2\u6570\u9700\u8981\u662f\u76f8\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u5c06\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u3002 attach_library() Twig\u6700\u4f73\u5b9e\u8df5---\u9884\u5904\u7406\u51fd\u6570\u548c\u6a21\u7248 \u00b6 \u4e3a\u4e86\u4f7fDrupal8\u7684\u4e3b\u9898\u6027\u80fd\u6700\u5927\u5316\uff0c\u4ee5\u53ca\u66f4\u52a0\u7684\u5b9a\u5236\u5316\uff0c\u8bf7\u9075\u7167\u5982\u4e0b\u7684\u6700\u4f73\u5b9e\u8df5\u65b9\u5f0f\uff1a \u4f7f\u7528\u9884\u5904\u7406\u51fd\u6570\u8fd4\u56de\u53ef\u6e32\u67d3\u6570\u7ec4 \u00b6 \u603b\u662f\u901a\u8fc7\u9884\u5904\u7406\u51fd\u6570\u8fd4\u56de\u53ef\u6e32\u67d3\u6570\u7ec4\uff0c\u800c\u4e0d\u662f\u8c03\u7528 theme() \u6216\u8005 drupal_render() \u51fd\u6570\u3002 Twig\u4f1a\u81ea\u52a8\u6e32\u67d3\uff0c\u6545\u6ca1\u6709\u5fc5\u8981\u8c03\u7528 theme() \u6216\u8005 drupal_render() \u51fd\u6570\u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u6bd4\u76f4\u63a5\u8f93\u51fa\u5df2\u7ecf\u6e32\u67d3\u7684html\u4ee3\u7801\u66f4\u5177\u5b9a\u5236\u5316\uff0c\u6e32\u67d3\u6570\u7ec4\u5e94\u8be5\u4f20\u9012\u7ed9\u6a21\u7248\u3002 \u4ece\u9884\u5904\u7406\u51fd\u6570\u4e2d\u5220\u9664 theme() \u51fd\u6570\uff1a <?php // \u4e4b\u524d\uff0c\u76f4\u63a5\u628a\u6e32\u67d3\u7684html\u4f20\u9012\u7ed9\u6a21\u7248 $variables['table'] = theme('table', array('header' => $header, 'rows' => $rows)); // \u4e4b\u540e\uff0c\u628a\u6e32\u67d3\u6570\u7ec4\u4f20\u9012\u7ed9\u6a21\u7248 $variables['table'] = array( '#theme' => 'table', '#header' => $header, '#rows' => $rows, ); ?> \u4ece\u9884\u5904\u7406\u51fd\u6570\u4e2d\u5220\u9664 drupal_render() \u51fd\u6570\u5c31\u662f\u4e0d\u518d\u8c03\u7528\u5b83\uff1a <?php // \u4e4b\u524d $variables['teaser'] = drupal_render($node_teaser); // \u4e4b\u540e $variables['teaser'] = $node_teaser; ?> \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c drupal_render() \u51fd\u6570\u662f\u5728\u6dfb\u52a0\u8868\u683c\u6570\u636e\u7684\u65f6\u5019\u8c03\u7528\u3002 <?php // \u4e4b\u524d $row[] = drupal_render($display['title']); // \u4e4b\u540e $row[]['data'] = $display['title']; ?> \u5728\u6a21\u7248\u4e2d\u8c03\u7528filters\u548c\u5de5\u5177\u51fd\u6570 \u00b6 \u4e3e\u4e2a\u4f8b\u5b50\uff1a \u4e4b\u524d\u7684\u505a\u6cd5\uff1a \u9884\u5904\u7406\u51fd\u6570\u4e2d\uff1a <?php $variables['no_content_text'] = t('You have not created any content types yet. Go to the <a href=\"@create-content\">content type creation page</a> to add a new content type.', array('@create-content' => url('admin/structure/types/add'))); ?> \u6a21\u7248\u4e2d\uff1a <p>{{ no_content_text }}</p> \u73b0\u5728\u7684\u505a\u6cd5\uff1a \u6a21\u7248\u4e2d\uff1a <p>{{ 'You have not created any content types yet. Go to the <a href=\"@create-content\">content type creation page</a> to add a new content type.'|t({'@create-content': url('admin/structure/types/add')}) }}</p> \u663e\u793a/\u9690\u85cf & \u5220\u9664drupal_render_children\u548celement_children \u00b6 \u5728\u539f\u59cb\u7684\u6a21\u7248\u4e2d\uff0c\u5982\u679c\u8c03\u7528\u4e86 hide() \u51fd\u6570\uff0c\u800c\u4e14 drupal_render_children \u51fd\u6570\u7528\u4e8e\u8f93\u51fa\u201d\u5269\u4e0b\u7684\u201c\u6570\u636e\uff0c\u6211\u4eec\u5c06\u9700\u8981\u5728\u9884\u5904\u7406\u7684\u65f6\u5019\u628a\u8fd9\u4e9b\u6570\u636e\u62c6\u5206\u6210\u5355\u4e2a\u53d8\u91cf\u3002 \u4e4b\u524d(PHPTemplate\u6a21\u7248)\uff1a <?php hide($form['advanced']); hide($form['actions']); ?> <div class=\"layout-node-form clearfix\"> <div class=\"layout-region layout-region-node-main\"> <?php print drupal_render_children($form); ?> </div> <div class=\"layout-region layout-region-node-secondary\"> <?php print render($form['advanced']); ?> </div> <div class=\"layout-region layout-region-node-footer\"> <?php print render($form['actions']); ?> </div> </div> \u4e4b\u540e(\u9884\u5904\u7406)\uff1a <?php function template_preprocess_node_edit_form(&$variables) { $form = $variables['form']; // @todo Update this once drupal.org/node/1920886 is resolved. $variables['advanced'] = $form['advanced']; $variables['actions'] = $form['actions']; unset($form['advanced'], $form['actions']); $variables['form'] = drupal_render_children($form); } ?> \u4e4b\u540e(Twig\u6a21\u7248)\uff1a <div class=\"layout-node-form clearfix\"> <div class=\"layout-region layout-region-node-main\"> {{ form|without('advanced', 'actions') }} </div> <div class=\"layout-region layout-region-node-secondary\"> {{ form.advanced }} </div> <div class=\"layout-region layout-region-node-footer\"> {{ form.actions }} </div> </div> \u521b\u5efaDrupal8\u7684\u4e3b\u9898 \u00b6 \u4ee5\u4e00\u4e2a.info.yml\u6587\u4ef6\u5f00\u59cb\u5b9a\u4e49\u4e00\u4e2a\u4e3b\u9898 \u00b6 \u521b\u5efadrupal8\u4e3b\u9898\u7684\u7b2c\u4e00\u6b65\uff0c\u5c31\u662f\u521b\u5efa\u4e00\u4e2aTHEMENAME.info.yml\u6587\u4ef6\u3002\u6709\u4e00\u70b9\u5f88\u91cd\u8981\uff0c.info.yml\u6587\u4ef6\u4e2d\u7684\u201ctype\u201d\u952e\u9700\u8981\u8bbe\u7f6e\u6210\u201ctheme\u201d\u3002 \u521b\u5efa\u4e00\u4e2a.info.yml\u6587\u4ef6 \u00b6 \u5728\u4e3b\u9898\u6587\u4ef6\u5939\u7684\u6839\u76ee\u5f55\u521b\u5efa.info.yml\u6587\u4ef6\u3002\u6587\u4ef6\u5939\u7684\u540d\u5b57\u5e94\u8be5\u4fdd\u6301\u4e0e.info.yml\u6587\u4ef6\u540d\u76f8\u540c\u3002\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u7684\u4e3b\u9898\u547d\u540d\u4e3a\u201cFluffiness\u201d\uff0c\u90a3\u4e48\u6587\u4ef6\u5939\u7684\u540d\u5b57\u5c31\u662f\u201cfluffiness\u201d\uff0c\u800c.info.yml\u6587\u4ef6\u7684\u540d\u5b57\u662f\u201cfluffiness/fluffiness.info.yml\u201d\u3002 \u4f8b\u5982\uff1a name: Fluffiness type: theme description: A cuddly theme that offers extra fluffiness. core: 8.x libraries: - fluffiness/global-styling stylesheets-remove: - '@classy/css/components/tabs.css' - core/assets/vendor/normalize-css/normalize.css regions: header: Header content: Content sidebar_first: 'Sidebar first' footer: Footer \u5728\u4f60\u7684drupal\u7ad9\u70b9\u4e2d\uff0c\u6838\u5fc3\u63d0\u4f9b\u7684\u4e3b\u9898\u5305\u542b\u7740\u5f88\u591a.info.yml\u6587\u4ef6\u53ef\u4ee5\u4f9b\u4f60\u67e5\u9605\u5b9e\u4f8b\u3002 \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u952e\u91ca\u4e49 \u00b6 name: Fluffiness \u5fc5\u9009\u3002\u663e\u793a\u5728\u7ad9\u70b9\u5916\u89c2\u9875\u9762\u7684\uff0c\u53ef\u8bfb\u4e3b\u9898\u540d description: An extra cuddly Drupal theme available in grey and blue \u5fc5\u9009\uff0c\u4e3b\u9898\u63cf\u8ff0\uff0c\u4e5f\u4f1a\u663e\u793a\u5728\u7ad9\u70b9\u5916\u89c2\u7ba1\u7406\u9875\u9762 type: theme \u5fc5\u9009\u9879\uff0c\u6269\u5c55\u7c7b\u578b\uff0c\u6bd4\u5982\uff1amodule, theme \u6216\u8005 profile\u3002\u5bf9\u4e8e\u4e3b\u9898\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u6210\u201ctheme\u201d base theme: classy \u53ef\u4ee5\u4ece\u53e6\u4e00\u4e2a\u4e3b\u9898\u7ee7\u627f\u5176\u8d44\u6e90\u7684\u4e3b\u9898 core: 8.x \u5fc5\u9009\uff0c\u5f53\u524d\u4e3b\u9898\u517c\u5bb9\u7684Drupal\u7248\u672c version: 8.x-1.0 screenshot: fluffiness.png libraries: fluffiness/global-styling \u5f53\u4e3b\u9898\u542f\u7528\u65f6\uff0c\u4e3a\u6240\u6709\u7684\u9875\u9762\u52a0\u8f7d\u8d44\u6e90\u5e93\u6587\u4ef6\uff0c\u5305\u62eccss\u548cjs \u4f8b\u5982\uff1a global-styling: version: 1.x css: theme: css/style.css: {} css/print.css: { media: print } \u5f53html\u89e3\u6790\u65f6\uff0c\u5c31\u4f1a\u662f\uff1a <link rel=\"stylesheet\" href=\"css/style.css\" media=\"all\" /> <link rel=\"stylesheet\" href=\"css/print.css\" media=\"print\" /> stylesheets-remove: - core/assets/vendor/normalize-css/normalize.css # 1 - '@classy/css/components/tabs.css' # 2 \u6ce8\u610f\uff1a 1. stylesheets-remove\u952e\u5b9a\u4e49\u9700\u8981\u5220\u9664\u7684\u6837\u5f0f\uff0c\u9700\u8981\u8bbe\u7f6e\u6210\u5b8c\u5168\u8def\u5f84\u3002 2. \u4e3a\u4e86\u65b9\u5f0fDrupal\u6838\u5fc3\u7684\u8d44\u6e90\uff08\u4f8b\u5982\uff0cjQuery UI\u7684css\u6587\u4ef6\uff09\u88ab\u5220\u9664\uff0c\u8bf7\u8bbe\u7f6e\u4e3a\u5b8c\u5168\u8def\u5f84\u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u907f\u514d\u5f53\u524d\u8fd9\u4e2a\u6587\u4ef6\u5c5e\u4e8e\u67d0\u4e2a\u6a21\u5757\u6216\u8005\u4e3b\u9898\u63d0\u4f9b\u7684\u5e93\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528token\u3002\u6ce8\u610f\uff0c\u5982\u679c\u4f7f\u7528token\uff0c\u7531\u4e8e@\u4f1a\u88ab\u5f53\u6210YAML\uff0c\u8bf7\u8bb0\u5f97\u4f7f\u7528\u5f15\u53f7\u3002 regions: header: Header content: Content # required! sidebar_first: 'Sidebar first' footer: Footer \u4e3b\u9898\u6587\u4ef6\u5939\u7684\u7ed3\u6784 \u00b6 \u4e3b\u9898\u5c31\u662f\u5b9a\u4e86\u89c6\u56fe\u5c42\u7684\u8bb8\u591a\u6587\u4ef6\u7684\u96c6\u5408\u3002.info.yml\u6587\u4ef6\u662f\u5fc5\u987b\u7684\uff0c\u4e0b\u9762\u4f1a\u5217\u51fa\u4e00\u4e2a\u5178\u578b\u7684\u4e3b\u9898\u6587\u4ef6\u5939\u4e2d\u6240\u5305\u542b\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u3002 \u4e3b\u9898\u7684\u4f4d\u7f6e \u00b6 \u4e3b\u9898\u5fc5\u987b\u653e\u7f6e\u5728Drupal\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u201cthemes\u201d\u6587\u4ef6\u5939\u4e2d\u3002\u6ce8\u610f\uff0c\u6838\u5fc3\u7684\u4e3b\u9898\uff0c\u4f8b\u5982\uff1aBartik\u548cSeven\u4f4d\u4e8ecore/themes\u6587\u4ef6\u5939\u4e0b\u3002 \u4e00\u4e2a\u597d\u7684\u5efa\u8bae\u662f\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201ccontrib\u201d\u7684\u6587\u4ef6\u5939\u7528\u4e8e\u5b58\u653e\u4e0b\u8f7d\u7684\u8d21\u732e\u4e3b\u9898\uff0c\u800c\u201ccustom\u201d\u6587\u4ef6\u5939\u7528\u4e8e\u5b58\u653e\u81ea\u5b9a\u4e49\u7684\u4e3b\u9898\u3002 \u4e3b\u4f53\u540d\u79f0\u5fc5\u987b\u5c0f\u5199\u3002 Drupal\u7684\u76ee\u5f55\u7ed3\u6784\uff1a \u00b6 |-core | |-modules | |-themes | | |-bartik | | |-seven .. |-modules |-themes | |-contrib | | |-zen | | |-basic | | |-bluemarine | |-custom | | |-fluffiness \u4e3b\u9898\u6587\u4ef6\u5939\u7ed3\u6784\uff0c\u5047\u8bbe\u4e3b\u9898\u540d\u79f0\u662f\uff1afluffiness \u00b6 |-fluffiness.breakpoints.yml |-fluffiness.info.yml |-fluffiness.libraries.yml |-fluffiness.theme |-config | |-install | | |-fluffiness.settings.yml | |-schema | | |-fluffiness.schema.yml |-css | |-style.css |-js | |-fluffiness.js |-images | |-buttons.png |-logo.png |-screenshot.png |-templates | |-maintenance-page.html.twig | |-node.html.twig \u4e0b\u9762\uff0c\u4ecb\u7ecd\u4e00\u4e0b\u4e3b\u9898\u6587\u4ef6\u5939\u4e2d\u7684\u901a\u7528\u6587\u4ef6\u3002 *.info.yml \u00b6 \u4e3b\u9898\u5fc5\u987b\u5305\u542b*.info.yml\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5b9a\u4e49\u4e86meta\u6570\u636e\uff0c\u6837\u5f0f\uff0c\u8fd8\u6709\u533a\u5757\u548c\u533a\u57df\u4fe1\u606f\u3002 *.libraries.yml \u00b6 *.libraries.yml\u6587\u4ef6\u7528\u4e8e\u4e3b\u9898\u542f\u7528\u65f6\u9700\u8981\u52a0\u8f7d\u7684\u5b9a\u4e49js\u548ccss\u5e93\uff0c\u8be6\u60c5 \u70b9\u51fb\u8fd9\u91cc *.breakpoints.yml \u00b6 \u54cd\u5e94\u5f0f\u8bbe\u8ba1\u76f8\u5173\u7684\u8bbe\u7f6e\uff0c\u8be6\u89c1\uff1a *.breakpoints.yml\u8bbe\u7f6e *.theme \u00b6 *.theme\u6587\u4ef6\u662f\u4e00\u4e2aphp\u6587\u4ef6\uff0c\u5305\u542b\u4e86\u6240\u6709\u7684\u903b\u8f91\u5904\u7406\u4ee3\u7801\u548c\u8f93\u51fa\u524d\u7684\u9884\u5904\u7406\u3002 css/ \u00b6 \u4e00\u4e2a\u597d\u7684\u5efa\u8bae\u5c31\u662f\u5c06css\u6587\u4ef6\u5b58\u653e\u5728\u201ccss\u201d\u81ea\u76ee\u5f55\u4e0b\u3002 js/ \u00b6 \u5b58\u653e\u7740\u4e3b\u9898\u9700\u8981\u7684js\u6587\u4ef6\u3002 images/ \u00b6 \u5b58\u653e\u4e3b\u9898\u9700\u8981\u7684\u56fe\u7247 screenshot.png \u00b6 \u4e3b\u9898\u7684\u9884\u89c8\u56fe templates/ \u00b6 \u6838\u5fc3\u4e3b\u9898Bartik\u7684\u76ee\u5f55\u7ed3\u6784\uff1a \u00b6 |-bartik.breakpoints.yml |-bartik.info.yml |-bartik.libraries.yml |-bartik.theme |-color | |-color.inc | |-preview.css | |-preview.html | |-preview.js |-config | |-schema | | |-bartik.schema.yml |-css | |-base | | |-elements.css | |-components | | |-block.css | | |-book.css | | |-breadcrumb.css ... | |-colors.css | |-layout.css | |-maintenance-page.css | |-print.css |-images | |-add.png | |-required.svg | |-tabs-border.png |-logo.svg |-screenshot.png |-templates | |-block--search-form-block.html.twig | |-block--system-branding-block.html.twig | |-block--system-menu-block.html.twig | |-block.html.twig | |-comment.html.twig | |-field--taxonomy-term-reference.html.twig | |-maintenance-page.html.twig | |-node.html.twig | |-page.html.twig | |-status-messages.html.twig \u4e3a\u4e3b\u9898\u6dfb\u52a0\u533a\u57df \u00b6 \u4e3a\u4e3b\u9898\u6dfb\u52a0\u533a\u57df\u9700\u8981\u4e24\u6b65\uff1a \u5728\u4e3b\u9898\u6587\u4ef6.info.yml\u4e2d\u6dfb\u52a0\u533a\u57df\u7684meta-data \u7f16\u8f91page.html.twig\u6587\u4ef6\u6253\u5370\u65b0\u7684\u533a\u57df info\u6587\u4ef6\u4e2d\u6dfb\u52a0\u533a\u57df \u00b6 \u533a\u57df\u5b9a\u4e49\u6210ragions\u952e\u7684\u5b50\u5143\u7d20\uff1a # Regions regions: header: 'Header' content: 'Content' footer: 'Footer' Region \u952e\u5e94\u662f\u4e2a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u5305\u542b\u4e0b\u5212\u7ebf\u201c_\u201d\u3002 \u6a21\u7248\u4e2d\u6dfb\u52a0\u533a\u57df \u00b6 \u4e3a\u4e86\u663e\u793a\u533a\u57df\u4e2d\u7684\u5185\u5bb9\uff0c\u4f60\u9700\u8981\u786e\u5b9a\u65b0\u7684\u533a\u57df\u4e5f\u6dfb\u52a0\u5230\u4e86page.html.twig\u6a21\u7248\u4e2d\u3002 \u4f8b\u5982\uff1a header: 'Header' \u6a21\u7248\u4e2d\u8f93\u51fa\uff1a {{ page.header }} \u6b64\u5916\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u4eec\u5f53\u6210\u662fTwig\u6a21\u7248\u7684\u666e\u901a\u53d8\u91cf\uff0c\u53ef\u4ee5\u518d\u4efb\u4f55\u9700\u8981\u7684\u5730\u65b9\u6253\u5370\u8f93\u51fa\u3002 \u9ed8\u8ba4\u533a\u57df \u00b6 \u53ef\u4ee5\u5728 page.html.twig\u6a21\u7248\u6587\u6863 \u4e2d\u67e5\u9605\u9ed8\u8ba4\u7684\u533a\u57df page.header page.primary_menu page.secondary_menu page.highlighted page.help page.content page.sidebar_first page.sidebar_second page.footer page.breadcrumb Drupal8\u4e3b\u9898\u4e2d\u6dfb\u52a0\u6837\u5f0f\u548cjs \u00b6 \u4e0eDrupal7\u4e3b\u9898\u7684\u533a\u522b \u00b6 \u6709\u56db\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u533a\u522b\uff1a \u53bb\u6389\u4e86THEME.info\u6587\u4ef6\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fTHEME.info.yml\u6587\u4ef6 THEME.info.yml\u6587\u4ef6\u4e2d\u7684stylesheets\u5c5e\u6027\u4e0d\u590d\u5b58\u5728\uff0c\u6539\u4e3a\u5e93\u7684\u65b9\u5f0f\u5f15\u5165 THEME.info.yml\u6587\u4ef6\u4e2d\u7684scripts\u5c5e\u6027\u4e0d\u590d\u5b58\u5728\uff0c\u6539\u4e3a\u5e93\u7684\u65b9\u5f0f\u5f15\u5165 \u6bcf\u4e00\u4e2a\u9875\u9762\u7684js\u53ea\u5728\u9700\u8981\u65f6\u624d\u52a0\u8f7d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDrupal\u5bf9\u4e8e\u533f\u540d\u7528\u6237\u4e0d\u4f1a\u9700\u8981js\u3002\u8fd9\u610f\u5473\u7740\uff0cjquery\u4e0d\u4f1a\u518d\u5728\u6bcf\u4e2a\u9875\u9762\u81ea\u52a8\u52a0\u8f7d\u4e86\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u7684\u4e3b\u9898\u9700\u8981jquery\u6216\u8005\u5176\u5b83\u7684js\uff0c\u4f60\u9700\u8981\u901a\u8fc7\u201c\u58f0\u660e\u4f9d\u8d56\u5173\u7cfb\u201d\u6765\u544a\u8bc9Drupal\u8fd9\u4e2ajs\u9700\u8981\u52a0\u8f7d ** \u52a0\u8f7dcss/js\u7684\u6b65\u9aa4\uff1a** \u5c06css\u6216\u8005js\u4fdd\u5b58\u5230\u4e00\u4e2a\u6587\u4ef6 \u5b9a\u4e49\u4e00\u4e2a\u5305\u542bjs\u548ccss\u6587\u4ef6\u7684\u201clibrary\u201d \u5728\u94a9\u5b50\u4e2d\uff0c\u628a\u8fd9\u4e2a\u5e93\u8ffd\u52a0\u7ed9\u6e32\u67d3\u6570\u7ec4 \u5b9a\u4e49\u4e00\u4e2a\u5e93 \u00b6 \u5728\u4e3b\u9898\u6587\u4ef6\u5939\u4e2d\u521b\u5efa*.libraries.yml\u6587\u4ef6\u6765\u6dfb\u52a0\u5e93\uff08\u5047\u8bbe\u4f60\u7684\u4e3b\u9898\u540d\u79f0\u662f fluffiness \uff0c\u90a3\u4e48\u6587\u4ef6\u540d\u5c31\u662f fluffiness.libraries.yml \uff09\u3002\u6bcf\u4e00\u4e2a\u5e93\uff0c\u90fd\u662fcss\u548cjs\u6587\u4ef6\u7684\u8be6\u60c5\u5217\u8868\uff1a cuddly-slider: version: 1.x css: theme: css/cuddly-slider.css: {} js: js/cuddly-slider.js: {} \u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5047\u8bbe cuddly-slider.js \u6587\u4ef6\u4f4d\u4e8e\u4e3b\u9898\u7684js\u5b50\u76ee\u5f55\u4e2d\u3002 \u7136\u540e\uff0c\u9700\u8981\u8bb0\u4f4f\u7684\u662f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDrupal8\u4e0d\u4f1a\u5728\u6bcf\u4e00\u4e2a\u9875\u9762\u52a0\u8f7djquery\uff1b\u53ea\u5728\u9700\u8981\u65f6\u52a0\u8f7d\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u81ea\u5df1\u58f0\u660e\uff0c\u4e3b\u9898\u7684 cuddly-slider \u5e93\u4f9d\u8d56 jQuery \u3002 \u56e0\u6b64\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u4e0a\u4f8b\u7684 js/cuddly-slider.js \u53ef\u7528\uff0c\u6211\u4eec\u9700\u8981\u66f4\u65b0\u4e0b\uff1a cuddly-slider: version: 1.x css: theme: css/cuddly-slider.css: {} js: js/cuddly-slider.js: {} dependencies: - core/jquery \u5f53\u7136\uff0c\u5e93\u4e5f\u53ef\u4ee5\u53ea\u5305\u542bcss\uff0c\u6216\u8005\u53ea\u5305\u542bjs\u3002\u5927\u90e8\u5206\u7684\u4e3b\u9898\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a global-styling \u5e93\uff0c\u7528\u4e8e\u5168\u5c40\u52a0\u8f7d\u6837\u5f0f\u6587\u4ef6\uff1a global-styling: version: 1.x css: theme: css/layout.css: {} css/style.css: {} css/colors.css: {} css/print.css: { media: print } \u800c\u4e14\uff0c\u6b63\u5982\u4f60\u6240\u60f3\uff0c\u5e93\u4e2d\u5b9a\u4e49\u7684css\u7684\u987a\u5e8f\u5c31\u662f\u5c06\u6765\u52a0\u8f7d\u7684\u987a\u5e8f\u3002 \u5728Drupal7\u4e2d\uff0c\u4f60\u53ef\u4ee5\u628a\u5a92\u4f53\u67e5\u8be2\u5c5e\u6027(screen, print, all)\u4f5c\u4e3a stylesheets \u5c5e\u6027\u7684\u5b50\u952e\uff0c\u800c\u73b0\u5728\u4f60\u53ef\u4ee5\u628a\u5b83\u5f53\u4f5c\u503c\u5b9a\u4e49\uff0c\u4f8b\u5982\uff1a css/print.css: { media: print } \u73b0\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684js\u6587\u4ef6\u90fd\u5728\u9875\u811a\u52a0\u8f7d\u3002 js-header: header: true js: header.js: {} js-footer: js: footer.js: {} \u4f60\u5f97\u8bbe\u7f6e header \u5c5e\u6027\u4e3atrue\u3002 \u8986\u76d6\u6269\u5c55\u5e93 \u00b6 \u90a3\u4e9b\u5b9a\u4e49\u5728 *.libraries.yml \u6587\u4ef6\u4e2d\u7684\u5e93\u53ef\u4ee5\u901a\u8fc7\u4e3b\u9898\u7684 *.info.yml \u6587\u4ef6\u4e2d\u7684 libraries-override \u548c libraries-extend \u9879\u8fdb\u884c\u8986\u5199\u548c\u6269\u5c55\u3002 libraries-override libraries-override \u662f\u5b9a\u4e49\u5728\u5e93\u4e2d\uff0c\u4e3b\u9898\u7528\u6765\u64cd\u4f5ccss/js\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5305\u62ec\u5220\u9664\u3001\u66ff\u6362\u6216\u8005\u5220\u9664css/js\u3002 libraries-override: # Replace an entire library. core/drupal.collapse: mytheme/collapse # Replace an asset with another. subtheme/library: css: theme: css/layout.css: css/my-layout.css # Remove an asset. drupal/dialog: css: theme: dialog.theme.css: false # Remove an entire library. core/modernizr: false libraries-extend *libraries-extend*\u4e3a\u4e3b\u9898\u63d0\u4f9b\u4e86\u4e00\u79cd\u53ef\u4ee5\u4fee\u6539\u5e93\u7684\u65b9\u5f0f\u3002\u6bd4\u5982\uff0c\u6dfb\u52a0\u989d\u5916\u7684\u4e3b\u9898\u4f9d\u8d56\u7684\u5e93\u3002 # Extend drupal.user: add assets from classy's user libraries. libraries-extend: core/drupal.user: - classy/user1 - classy/user2 \u8ffd\u52a0\u5e93\u5230\u9875\u9762\u4e2d \u00b6 \u5728Twig\u6a21\u7248\u4e2d\u8ffd\u52a0\u5e93 \u901a\u8fc7\u8c03\u7528twig\u7684\u65b9\u6cd5\uff0c attach_library() \u53ef\u4ee5\u5728twig\u6a21\u7248\u4e2d\u8ffd\u52a0\u5e93\uff0c\u4f8b\u5982\uff1a {{ attach_library('fluffiness/cuddly-slider') }} <div>Some fluffy markup {{ message }}</div> \u8ffd\u52a0\u7ed9\u6240\u6709\u7684\u9875\u9762 \u4e3a\u4e86\u6240\u6709\u9875\u9762\u90fd\u52a0\u8f7d\u8fd9\u4e2a\u5e93\uff0c\u9700\u8981\u5728\u4e3b\u9898\u7684 *.info.yml \u6587\u4ef6\u4e2d\uff0c libraries \u952e\u7684\u4e0b\u9762\u58f0\u660e\uff1a name: Example type: theme core: 8.x libraries: - fluffiness/cuddly-slider \u4e3a\u4e00\u7ec4\u9875\u9762\u6dfb\u52a0\u5e93 \u00b6 \u5728\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u80fd\u4e0d\u5e0c\u671b\u6240\u6709\u7684\u9875\u9762\u52a0\u8f7d\u4f60\u7684\u5e93\uff0c\u800c\u662f\u90e8\u5206\u9875\u9762\u52a0\u8f7d\u3002\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff0c\u4f60\u53ef\u80fd\u53ea\u60f3\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u533a\u5757\u4e2d\u52a0\u8f7d\uff0c\u6216\u8005\u7528\u6237\u8bbf\u95ee\u67d0\u4e2a\u8282\u70b9\u7c7b\u578b\u65f6\u52a0\u8f7d\u3002 \u4e3b\u9898\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 THEME_preprocess_HOOK() \u65b9\u6cd5\u8fbe\u5230\u8fd9\u4e2a\u6548\u679c\u3002 \u4f8b\u5982\uff0c\u4f60\u60f3\u8981\u5728\u7ef4\u62a4\u9875\u9762\u8ffd\u52a0\u4f60\u7684\u5e93\uff0c\u201cHOOK\u201d\u5c31\u662f\u201cmaintenance_page\u201d\uff0c\u7136\u540e\u4f60\u7684\u65b9\u6cd5\u5c31\u662f\uff1a <?php function fluffiness_preprocess_maintenance_page(&$variables) { $variables['#attached']['library'][] = 'fluffiness/cuddly-slider'; } ?> \u4f60\u4e5f\u53ef\u4ee5\u4e3a\u4e3b\u9898\u7684\u5176\u5b83hook\u505a\u540c\u6837\u7684\u4e8b\u60c5\uff0c\u5f53\u7136\u4f60\u7684\u51fd\u6570\u4e2d\u4e5f\u53ef\u4ee5\u5305\u542b\u903b\u8f91\u5904\u7406\u3002 \u91cd\u8981\u63d0\u793a \uff1a\u6700\u901a\u7528\u7684\u7528\u6cd5\u662f\u6839\u636e\u5f53\u524d\u7684\u8def\u7531\u6765\u52a0\u8f7d\u5e93\uff1a <?php function fluffiness_preprocess_page(&$variables) { $variables['#cache']['contexts'][] = 'route'; if (\\Drupal::routeMatch()->getRouteName() === 'entity.node.preview') { $variables['#attached']['library'][] = 'fluffiness/node-preview'; } } ?> \u6dfb\u52a0\u53ef\u5b9a\u5236\u7684js \u00b6 \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u80fd\u60f3\u8981\u6839\u636e\u67d0\u4e9bphp\u8ba1\u7b97\u4fe1\u606f\u6765\u52a0\u8f7djs\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u50cf\u4e4b\u524d\u4e00\u6837\uff0c\u521b\u5efa\u4e00\u4e2ajs\u6587\u4ef6\u5e76\u8ffd\u52a0\u8fdb\u6765\uff0c\u518d\u901a\u8fc7 drupalSettings (\u66ff\u6362Drupal7\u4e2d\u7684 Drupal.settings )\u8ffd\u52a0\u4e00\u4e9bjs\u8bbe\u7f6e\u9879\u5e76\u7531\u8ffd\u52a0\u7684js\u6587\u4ef6\u8bfb\u53d6\u8fd9\u4e9b\u8bbe\u7f6e\u9879\u3002\u7136\u540e\uff0c\u4e3a\u4e86\u4f7f drupalSettings \u5728\u6211\u4eec\u7684js\u6587\u4ef6\u4e2d\u751f\u6548\uff0c\u6211\u4eec\u5f97\u50cf\u5f15\u5165jQuery\u4e00\u6837\u64cd\u4f5c\uff1a\u6211\u4eec\u5f97\u5728\u4f9d\u8d56\u4e2d\u5b9a\u4e49\u3002 \u5c31\u50cf\u8fd9\u6837\uff1a cuddly-slider: version: 1.x js: js/cuddly-slider.js: {} dependencies: - core/jquery - core/drupalSettings \u4ee5\u53ca <?php function fluffiness_page_attachments_alter(&$page) { $page['#attached']['library'][] = 'fluffiness/cuddly-slider'; $page['#attached']['drupalSettings']['fluffiness']['cuddlySlider']['foo'] = 'bar'; } ?> \u8fd9\u6837 cuddly-slider.js \u5c31\u53ef\u4ee5\u8bbf\u95ee drupalSettings.fluffiness.cuddlySlider.foo \u4e86(\u8fd9\u91cc === 'bar')\u3002 \u5728\u6a21\u7248\u4e2d\u4f7f\u7528attributes \u00b6 attributes\u662f\u4e00\u4e2a\u5728\u6bcf\u4e2atwig\u6a21\u7248\u4e2d\u90fd\u6709\u6548\u7684\u5bf9\u8c61\u3002attributes\u7528\u6765\u5b58\u50a8\u6240\u6709\u7684\u7236\u5bb9\u5668\u7684\u76f8\u5173\u5c5e\u6027\uff0c\u5e76\u63d0\u4f9b\u6709\u7528\u7684\u65b9\u6cd5\u7ed9\u5f00\u53d1\u8005\u5904\u7406\u8fd9\u4e9b\u6570\u636e\u3002 Attribute\u7684\u65b9\u6cd5 \u00b6 attributes.addClass() \u5355\u4e2a\u7c7b\uff1a <div{{attributes.addClass('my-class')}}></div> \u591a\u4e2a\u7c7b\uff1a {% set classes = [ 'red', 'green', ] %} <div{{ attributes.addClass(classes) }}></div> \u5c06\u4f1a\u8f93\u51fa\uff1a <div class=\"red green\"></div>. html\u6807\u7b7e\u4e0etwig\u8bed\u6cd5\u4e4b\u95f4\u4e0d\u80fd\u6709\u4efb\u4f55\u7a7a\u683c\uff01 attributes.removeClass() {#classes = [ 'red', 'green', 'blue' ] #} <div{{ attributes.addClass(classes).removeClass('green') }}></div> \u5c06\u4f1a\u8f93\u51fa\uff1a <div class=\"red blue\"></div> attributes.setAttribute($attribute, $value) <div{{ attributes.setAttribute('id', 'myID') }}></div> \u5c06\u4f1a\u8f93\u51fa\uff1a <div id=\"myID\"></div> attributes.removeAttribute($attribute, $value) <div{{ attributes.removeAttribute('id') }}></div> attributes.hasClass($class) {% if attribute.hasClass(\u2018myClass') %} {# do stuff #} {% endif %} \u5176\u5b83\u6709\u7528\u7684\u4ee3\u7801\u7247\u6bb5 \u00b6 \u94fe\u5f0f {% set classes = ['red', 'green', 'blue'] %} {% set my_id = 'specific-id' %} {% set image_src = 'https://www.drupal.org/files/powered-blue-135x42.png' %} <img{{ attributes.addClass(classes).removeClass('green').setAttribute('id', my_id).setAttribute('src', image_src) }}> \u5c06\u4f1a\u8f93\u51fa\uff1a <img id=\"specific-id\" class=\"red blue\" src=\"https://www.drupal.org/files/powered-blue-135x42.png\"> \u4f7f\u7528without filter <div class=\u201dmyclass {{ attributes.class }}\u201d{{attributes|without(\u2018class\u2019) }}></div> Drupal6, 7, 8\u4e3b\u9898\u533a\u522b \u00b6 \u8fd9\u91cc\u5217\u51fa\u7684\u662f\u6bd4\u8f83\u91cd\u8981\u7684Drupal8\u4e2d\u7684\u4e3b\u9898\u53d8\u5316 Drupal8\u9ed8\u8ba4\u8f93\u51fahtml5 \u9664\u4e86jQuery2.x\u4e4b\u5916\uff0cDrupal8\u8fd8\u5f15\u5165\u66f4\u591a\u7684\u524d\u7aef\u6846\u67b6\uff0c\u4f8b\u5982\uff1a Modernizr \uff0c Underscore.js \uff0c\u4ee5\u53ca Backbone.js \u3002 Drupal8\u5f15\u5165\u4e86Twig\uff0c\u66ff\u6362\u4e86\u539f\u6765\u7684\u9ed8\u8ba4\u6a21\u677f\u5f15\u64cePHPTemplate\u3002 Drupal8\u5904\u4e8e\u6027\u80fd\u8003\u8651\uff0c\u9ed8\u8ba4\u542f\u7528\u4e86\u7c7b\u4f3ccss\u3001js\u5408\u5e76\u4e4b\u7c7b\u7684\u9ed8\u8ba4\u7279\u6027\u3002 \u5728drupal6\u548cdrupal7\u4e2d\uff0c\u53ef\u4ee5\u8c03\u7528 drupal_add_css() \u548c drupal_add_js() \u51fd\u6570\u6dfb\u52a0css\u6216\u8005js\uff0c\u73b0\u5728\u66ff\u6362\u6210\u4e86\u5728\u6e32\u67d3\u6570\u7ec4\u4e2d\u8ffd\u52a0 #attached \u5c5e\u6027\u8c03\u7528\u5e93\u7684\u65b9\u6cd5\u3002 Drupal8\u4e0d\u518d\u652f\u6301IE6\u30017\u30018\uff0c\u542f\u7528jQuery2.0\uff0c\u652f\u6301\u73b0\u4ee3HTML5/CSS3\u6d4f\u89c8\u5668\u3002 Drupal8\u4e0d\u652f\u6301\u90a3\u4e9b\u4e0d\u652f\u6301SVG\u7684\u6d4f\u89c8\u5668(\u5305\u62ecIE8\u548c\u5b89\u5353\u6d4f\u89c8\u56682.3)\u3002 Drupal8\u7684css\u4e2d\uff0c\u51cf\u5c11\u4e86id\u7684\u4f7f\u7528\u3002 Drupal8\u7684css\u7ed3\u6784(\u6587\u4ef6\u7ed3\u6784)\u57fa\u4e8e SMACSS \u548c BEM Drupal8\u5c06\u9884\u5904\u7406\u51fd\u6570\u4e2d\u7684css\u7c7b\u79fb\u5230\u4e86Twig\u6a21\u7248\u4e2d\u3002","title":"\"Drupal8\u4e3b\u9898(theme)\""},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal8twig","text":"Drupal8\u4e2dTwig\u66ff\u6362\u4e86PHPTemplate\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u5bfc\u81f4\u7684\u7ed3\u679c\u4e4b\u4e00\u5c31\u662f\u6a21\u7248\u7684\u540e\u7f00\u7531\u539f\u6765\u7684.tpl.php\u53d8\u6210\u4e86.html.twig","title":"Drupal8\u4e2d\u7684Twig"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#twig","text":"\u5728\u4f7f\u7528Twig\u6a21\u7248\u7684\u65f6\u5019\uff0c\u5927\u90e8\u5206\u7684\u53d8\u91cf\u90fd\u5df2\u6ce8\u91ca\u7684\u5f62\u5f0f\u5199\u5728\u4e86\u6a21\u7248\u4e2d\u3002\u7136\u540e\uff0c\u5f53\u6211\u4eec\u65b0\u589e\u4e86\u53d8\u91cf\uff0c\u6211\u4eec\u5c31\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u641c\u7d22\u5230\u5f53\u524d\u6a21\u7248\u6240\u6709\u53d8\u91cf\u7684\u65b9\u6cd5\u3002Twig\u63d0\u4f9b\u4e86 dump \u51fd\u6570\u3002 dump \u51fd\u6570\u5e76\u4e0d\u4f1a\u6253\u5370\u6240\u6709\u7684\u8f93\u51fa\uff0c\u9664\u975e\u5f00\u542f\u4e86debug\u3002 dump \u51fd\u6570\u7528\u4e8e\u6253\u5370\u5355\u4e2a\u53d8\u91cf\u7684\u4fe1\u606f\u6216\u8005\u6a21\u7248\u4e2d\u7684\u6240\u6709\u53d8\u91cf\u3002","title":"\u641c\u7d22Twig\u6a21\u7248\u4e2d\u7684\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_1","text":"\u5982\u679c\u4f60\u7684\u6a21\u7248\u4e2d\u6709\u4e00\u4e2atitle\u53d8\u91cf\uff0c\u4e0b\u9762\u5728\u4f60\u7684\u6a21\u7248\u4e2ddump\u51fa\u8fd9\u4e2a\u53d8\u91cf\u7684\u5185\u5bb9\uff1a {{ dump(title) }}","title":"\u5355\u4e2a\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_2","text":"\u8981\u6253\u5370\u51fa\u6a21\u7248\u4e2d\u7684\u6240\u6709\u7684\u53d8\u91cf\uff0c\u4f60\u53ef\u4ee5\uff1a {{ dump() }} \u8981\u6253\u5370\u51fa\u53d8\u91cf\u7684\u952e\uff1a {{ dump(_context|keys) }} PS: \u8fd9\u91cc\u7684_context\u662f\u4e00\u5168\u5c40\u53d8\u91cf\uff0c\u6307\u5f53\u524d\u6a21\u7248\u4e2d\u6240\u6709\u7684\u4e0a\u4e0b\u6587\u548c\u53d8\u91cf\uff0c\u6bd4\u5982\u901a\u8fc7theme\u51fd\u6570\u4f20\u9012\u7684\u53d8\u91cf\uff0cpreprocess\u51fd\u6570\u5904\u7406\u7684\u53d8\u91cf\uff0c\u6216\u8005\u8c03\u7528set\u8bbe\u7f6e\u7684\u53d8\u91cf\u3002 \u5168\u5c40\u53d8\u91cf\uff1a - _context \u5f53\u524d\u6a21\u7248\u4e2d\u6240\u6709\u7684\u4e0a\u4e0b\u6587\u548c\u53d8\u91cf - _charset \u53ea\u5f53\u524d\u7684\u7f16\u7801\u65b9\u5f0f","title":"\u6a21\u7248\u4e2d\u7684\u6240\u6709\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#dump","text":"dump() \u51fd\u6570\u867d\u7136\u53ef\u4ee5\u8f93\u51fa\u6240\u6709\u7684\u53d8\u91cf\uff0c\u4f46\u662f\u5374\u5e26\u6765\u4e86\u5de8\u5927\u7684\u5185\u5b58\u6d88\u8017\uff0c\u6545\u4f60\u53ef\u4ee5\u5faa\u73af _context \u6765\u67e5\u770b\u6240\u6709\u7684\u952e\uff1a <ol> {% for key, value in _context %} <li>{{ key }}</li> {% endfor %} </ol> \u63a5\u4e0b\u6765\u518d\u52a0\u4e0a\u4e00\u4e9b\u6761\u4ef6\u5224\u65ad\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u4f60\u9700\u8981\u7684\u53d8\u91cf\u4e86\u3002","title":"\u614e\u7528dump()"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal8","text":"","title":"Drupal8\u4e3b\u9898"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_3","text":"Drupal\u662f\u6309\u7167\u4e00\u5b9a\u7684\u547d\u540d\u60ef\u4f8b\u6765\u52a0\u8f7d\u6a21\u7248\u7684\uff0c\u8fd9\u5c31\u65b9\u4fbf\u5f00\u53d1\u8005\u53ef\u4ee5\u8986\u76d6\u539f\u6709\u7684\u6a21\u7248\u3002\u5f53\u7136\uff0c\u8bb0\u5f97\u6e05\u9664\u7f13\u5b58\u3002","title":"\u6a21\u7248\u547d\u540d\u60ef\u4f8b"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#html","text":"HTML\u6a21\u7248\u63d0\u4f9b\u4e86\u5305\u62echead\uff0ctitle\u4ee5\u53cabody\u6807\u7b7e\u7b49\u57fa\u7840\u7ed3\u6784\u7684html\u9875\u9762\u3002 \u57fa\u7840\u6a21\u7248\uff1ahtml.html.twig(\u4f4d\u4e8e\uff1acore/modules/system/templates/html.html.twig) \u4e0b\u9762\u662f\u4e00\u4e9b\u4f60\u53ef\u4ee5\u8986\u76d6\u7684\u57fa\u7840\u6a21\u7248\u7684\u4f8b\u5b50\uff1a 1. html--internalviewpath.html.twig 2. html--node--id.html.twig 3. html.html.twig","title":"HTML"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#page","text":"\u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1apage--[front|internal/path].html.twig \u57fa\u7840\u6a21\u7248\uff1apage.html.twig(\u4f4d\u4e8e: core/modules/system/templates/page.html.twig) \u4e0b\u9762\u662fpage\u6a21\u7248\u7684\u6a21\u7248\u5efa\u8bae\uff0c\u4e3e\u4e2a\u4f8b\u5b50\u201c http://www.example.com/node/1/edit \u201d\uff1a page--node--edit.html.twig page--node--1.html.twig page--node.html.twig page.html.twig","title":"Page"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#regions","text":"\u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1aregion--[region].html.twig \u57fa\u7840\u6a21\u7248\uff1aregion.html.twig(\u4f4d\u4e8e: core/modules/system/templates/region.html.twig) \u5f53\u4e00\u4e2a\u9875\u9762\u7684\u533a\u57df\u4e2d\u6709\u5185\u5bb9\u65f6\uff0c\u7cfb\u7edf\u4f1a\u4ece\u533a\u5757\u7cfb\u7edf\u6216\u8005\u4e00\u4e2a\u7c7b\u4f3c\u4e8e hook_page_build() \u7684\u65b9\u6cd5\u4e2d\u8c03\u7528\u533a\u57df\u6a21\u7248\u3002","title":"Regions"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#blocks","text":"\u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1ablock--[module|-delta]].html.twig \u57fa\u7840\u6a21\u7248\uff1ablock.html.twig (\u4f4d\u4e8e: core/modules/block/templates/block.html.twig) block--module--delta.html.twig block--module.html.twig block.html.twig \u8fd9\u91cc\u7684module\u5c31\u662f\u6a21\u5757\u540d\uff0cdelta\u662f\u6a21\u5757\u7ed9\u533a\u5757\u8bbe\u7f6e\u7684\u5185\u90e8id\u6807\u8bc6","title":"Blocks"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#nodes","text":"\u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1anode--[type|nodeid]--[viewmode].html.twig \u57fa\u7840\u6a21\u7248\uff1anode.html.twig (\u4f4d\u4e8e: core/modules/node/templates/node.html.twig) \u6a21\u7248\u5efa\u8bae\uff1a node--nodeid--viewmode.html.twig node--nodeid.html.twig node--type--viewmode.html.twig node--type.html.twig node--viewmode.html.twig node.html.twig","title":"Nodes"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#forums","text":"\u6a21\u7248\u540d\u79f0\u6a21\u5f0f\uff1aforums--[[container|topic]--forumID].html.twig \u57fa\u7840\u6a21\u7248\uff1a forums.html.twig (\u4f4d\u4e8e: core/modules/forum/templates/forums.html.twig) \u6a21\u7248\u5efa\u8bae\uff1a \u8bba\u575b\u5bb9\u5668\uff1a forums--containers--forumID.html.twig forums--forumID.html.twig forums--containers.html.twig forums.html.twig \u8bba\u575b\u4e3b\u9898\u5185\u5bb9 forums--topics--forumID.html.twig forums--forumID.html.twig forums--topics.html.twig forums.html.twig","title":"Forums"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#phptemplatetwig","text":"\u63a5\u4e0b\u6765\uff0c\u770b\u4e0bPHPTemplate\u4e0eTwig\u7684\u533a\u522b\u3002","title":"PHPTemplate\u4e0eTwig\u4e3b\u9898\u8303\u4f8b\u7684\u6bd4\u8f83"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#twig_1","text":"Twig\u662f\u57fa\u4e8ephp\u7684\u7f16\u8bd1\u6a21\u7248\u8bed\u8a00\u3002\u5f53\u4f60\u7684\u9875\u9762\u9700\u8981\u6e32\u67d3\u663e\u793a\u7684\u65f6\u5019\uff0cTwig\u5f15\u64ce\u4f1a\u627e\u5230\u5bf9\u5e94\u7684\u6a21\u7248\u5e76\u628a\u5b83\u7f16\u8bd1\u6210php\u6a21\u7248\uff0c\u5b58\u653e\u5728sites/default/files/php_storage/\u76ee\u5f55\u4e0b\u3002","title":"\u5173\u4e8eTwig"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#1docblock","text":"PHPTemplate\uff1a <?php /** * @file * File description */ ?> Twig\uff1a {# /** * @file * File description */ #}","title":"1.Docblock"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#2","text":"PHPTemplate\u6587\u4ef6\uff1anode--article.tpl.php Twig\u6587\u4ef6\uff1anode--article.html.twig PHPTemplate\u51fd\u6570\uff1atheme_node_links() Twig\u6587\u4ef6\uff1anode-links.html.twig","title":"2.\u6587\u4ef6\u548c\u51fd\u6570\u540d"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#3","text":"\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf PHPTemplate: <div class=\"content\"><?php print $content; ?></div> Twig: <div class=\"content\">{{ content }}</div> \u8f93\u51fa\u4e00\u4e2a\u54c8\u5e0c\u952e\u503c PHPTemplate: <?php print $item['#item']['alt']; ?> Twig: {{ item['#item'].alt }} \u53d8\u91cf\u8d4b\u503c PHPTemplate: <?php $custom_var = $content->comments; ?> Twig: {% set custom_var = content.comments %} \u6570\u7ec4\u521d\u59cb\u5316 PHPTemplate: <?php $args = array('!author' => $author, '!date' => $created); ?> Twig: {% set args = {'!author': author, '!date': created} %}","title":"3.\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#4","text":"PHPTemplate: <?php if ($content->comments): endif; ?> Twig: {% if content.comments %} {% endif %} PHPTemplate: <?php if (!empty($content->comments)): endif; ?> Twig: {% if content.comments is not empty %} {% endif %} PHPTemplate: <?php if (isset($content->comments)): endif; ?> Twig: {% if content.comments is defined %} {% endif %} PHPTemplate: <?php if ($count > 0): endif; ?> Twig: {% if count > 0 %} {% endif %}","title":"4.\u6761\u4ef6\u5224\u65ad"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#5","text":"PHPTemplate: <?php foreach ($users as $user) {} ?> Twig: {% for user in users %} {% endfor %}","title":"5.\u63a7\u5236\u7ed3\u6784"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#6","text":"check_plain\uff1a PHPTemplate: <?php print check_plain($title); ?> Twig: {{ title|striptags }} Translate\uff1a PHPTemplate: <?php print t('Home'); ?> Twig: {{ 'Home'|t }} Translate with substitutions: PHPTemplate: <?php print t('Welcome, @username', array('@username' => $user->name)); ?> Twig: {{ 'Welcome, @username'|t({ '@username': user.name }) }} Drupal8 Twig(\u91c7\u7528 trans \u6807\u7b7e\u6269\u5c55) {% set username = user.name %} {% trans %} Welcome, {{ username }} {% endtrans %} implode: PHPTemplate: <?php echo implode(', ', $usernames); ?> Twig: {{ usernames | join(', ') }} PHPTemplate\u7684\u4f8b\u5b50\u4e2d usernames\u9700\u8981\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u539f\u751f\u7684Twig\u4e5f\u9700\u8981 usernames\u9700\u8981\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u539f\u751f\u7684Twig\u4e5f\u9700\u8981 usernames\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u4f46\u662fDrupal8\u4e2d\u7684twig\u8fd8\u53ef\u4ee5\u662f\u4e00\u4e2a\u53ef\u4ee5\u6e32\u67d3\u7684\u6570\u7ec4\u5bf9\u8c61\u3002\u8fd9\u5c31\u662fDrupal8\u4e2d\u7684twig\u4e0e\u539f\u751ftwig\u7684\u672c\u8d28\u533a\u522b\u3002Drupal8\u4e2d\u7684twig\u53ef\u4ee5\u201c\u6253\u5370\u201d\u51fa\u7eaf\u6587\u672c\u548c\u53ef\u6e32\u67d3\u7684\u6570\u7ec4\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a {% set numbers = [{'#markup': 'One'}, {'#markup':'Two'}, {'#markup':'Three'}] %} {{ numbers }} \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u6570\u636e\u9879\u90fd\u662f\u4ee5\u9017\u53f7\u76f8\u9694\u7684\u3002\u4f46\u662f\uff0c\u8f93\u51fa\u7684\u7ed3\u679c\u5374\u662f\uff1a OneTwoThree Escape\uff1a PHPTemplate: <?php echo check_plain($title); ?> \u539f\u751fTwig: {{ title|e }} Drupal 8 Twig2: {{ title }}","title":"6.\u8fc7\u6ee4"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#7","text":"<div class=\"body\"> {{- block.content -}} </div> \u7c7b\u4f3c\u4e8e <div class=\"body\">{{ block.content }}</div>","title":"7.\u7a7a\u767d"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#debug-twig","text":"twig\u6a21\u7248\u5f15\u64ce\u63d0\u4f9b\u4e86\u4e00\u4e2adebug\u5de5\u5177\u3002","title":"debug twig\u6a21\u7248"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#debugging","text":"\u5728sites/default/services.yml\u542f\u7528Twig Debugging\u3002 \u8bbe\u7f6edebug\u53d8\u91cf\u4e3atrue parameters: twig.config: debug: true","title":"\u542f\u7528debugging"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_4","text":"\u51fa\u4e8e\u6027\u80fd\u8003\u8651\uff0cTwig\u6a21\u7248\u88ab\u7f16\u8bd1\u6210\u4e00\u4e2aPHP\u7c7b\u5b58\u653e\u5728\u78c1\u76d8\u4e0a\uff0c\u4f46\u8fd9\u610f\u5473\u7740\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f60\u7684\u6a21\u7248\u4e0d\u4f1a\u5728\u4f60\u505a\u51fa\u66f4\u6539\u65f6\u53d1\u751f\u5237\u65b0\u3002\u4e3a\u4e86\u4f7fTwig\u6a21\u7248\u53ef\u4ee5\u81ea\u52a8\u5237\u65b0\uff0c\u542f\u7528 services.yml \u4e2d\u7684deubg\u9009\u9879\u3002\u6b32\u77e5\u8be6\u60c5\uff0c\u53c2\u89c1\uff1a https://drupal.org/node/1903374 \u6253\u5370\u6240\u6709\u7684\u53d8\u91cf {# \u6253\u5370\u6240\u6709\u7684\u53d8\u91cf #} {{ dump() }} {# \u6253\u5370\u5355\u4e2a\u53d8\u91cf #} {{ dump(var) }}","title":"\u81ea\u52a8\u52a0\u8f7d\u7f16\u8bd1\u7684\u6a21\u7248"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#filters-twig","text":"Twig\u4e2d\u7684Filters\u7528\u4e8e\u4fee\u6539\u53d8\u91cf\u3002Filters\u548c\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\u53f7(|)\u5206\u9694\uff0c\u8fd8\u53ef\u80fd\u5e26\u70b9\u53ef\u9009\u7684\u53c2\u6570\u3002\u591a\u4e2afilters\u53ef\u4ee5\u94fe\u5f0f\u7684\u8fde\u5728\u4e00\u8d77\uff0c\u524d\u4e00\u4e2a\u7684\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u7684\u8f93\u5165\u3002 \u4f8b\u5982\uff1a {{ ponies|safe_join(\", \")|lower}} Drupal\u7684Twig\u6a21\u7248\u4e2d\u4f7f\u7528\u7684filter\u7531\u6240\u6709\u7684Twig\u5f15\u64ce\u81ea\u5e26\u7684filter\u548cdrupal\u4e2d\u7684\u51e0\u4e2a\u7279\u6b8a\u7684filters\u7ec4\u6210\u3002","title":"Filters---\u4fee\u6539Twig\u6a21\u7248\u4e2d\u7684\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#twig-filters","text":"\u8be6\u89c1\uff1a twig filter\u5217\u8868","title":"Twig filters"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupalfilters","text":"Drupal\u4e2d\u7684filters\u662f\u5728 Drupal\\Core\\Template\\TwigExtension::getFilters(). \u4e2d\u58f0\u660e\u7684\u3002","title":"Drupal\u81ea\u8eab\u7684filters"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#filters","text":"t t filter\u8c03\u7528Drupal\u7684t\u51fd\u6570\u7ffb\u8bd1\u7ed9\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u53ef\u7528\u4e8e\u4efb\u4f55\u5b57\u7b26\u4e32\u3002 \u4f8b\u5982\uff1a <a href=\"{{ url('<front>') }}\" title=\"{{ 'Home'|t }}\" rel=\"home\" class=\"site-logo\"></a> placeholder\u8f93\u51fa\u5b89\u5168\u7684html\u5e76\u4f7f\u7528 drupal_placeholder() \u8fdb\u884c\u683c\u5f0f\u5316\u8f93\u51fa\u6210\u5f3a\u8c03\u6587\u672c\u3002 \u4f8b\u5982\uff1a {% trans %}Submitted on {{ date|placeholder }}{% endtrans %} {{ var1|t }} {{ var1|placeholder }} {% trans %}{{ var1 }}{% endtrans %} \u5c3d\u53ef\u80fd\u907f\u514d\u4f7f\u7528|raw filter\uff0c\u7279\u522b\u662f\u4f60\u6b63\u5728\u8f93\u51fa\u4e00\u4e9b\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u7684\u65f6\u5019\u3002\u8be6\u89c1 https://www.drupal.org/node/2296163 \uff1a {{ var1|raw }}","title":"\u7ffb\u8bd1filters"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#filters_1","text":"drupal_escape drupal_escape\u7528\u4e8e\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u5b89\u5168\u5904\u7406\u540e\u8fdb\u884c\u63d2\u5165\u64cd\u4f5c\u5e76\u8f93\u51fa\u663e\u793a\uff0c\u5b83\u66ff\u4ee3\u4e86twig\u9ed8\u8ba4\u7684escape filter\u3002\u53c2\u89c1 twig_drupal_escape_filter safe_join safe_join\u5c06\u51e0\u4e2a\u5b57\u7b26\u4e32\u7528\u7ed9\u5b9a\u7684\u5206\u9694\u7b26\u8fde\u63a5\u5728\u4e00\u5757\u513f\u3002 \u4f8b\u5982\uff1a {{ items|safe_join(', ') }} without without\u4f1a\u521b\u5efa\u51fa\u5f53\u524d\u8fd9\u4e2a\u53ef\u4ee5\u6e32\u67d3\u7684\u6570\u7ec4\u7684\u62f7\u8d1d\uff0c\u4f46\u662f\u4f1a\u628a\u4f20\u5165\u7684\u53c2\u6570\u5f53\u4f5c\u952e\uff0c\u5220\u9664\u952e\u5173\u8054\u7684\u6240\u6709\u5b50\u5143\u7d20\u3002\u4f46\u662f\uff0c\u5f53\u524d\u8fd9\u4e2a\u6570\u7ec4\u4e0d\u53d7\u5f71\u54cd\uff0c\u4f9d\u65e7\u53ef\u4ee5\u6253\u5370\u51fa\u5b50\u5143\u7d20\u3002\u8be6\u89c1\uff1a twig_without \u4f8b\u5982\uff1a {# \u6253\u5370content\u53d8\u91cf\uff0c\u9664\u4e86content.links #} {{ content|without('links') }} clean_class clean_class filter\u4f1a\u5904\u7406\u51fa\u4e00\u4e2a\u5b89\u5168\u7684\u53ef\u7528\u7684html\u7c7b\u540d\u3002\u8be6\u89c1\uff1a Html::getClass() clean_id clean_id filter\u4f1a\u5904\u7406\u51fa\u4e00\u4e2a\u5b89\u5168\u7684\u53ef\u7528\u7684html id\u3002\u8be6\u89c1\uff1a Html:getID() format_date format_date filter\u683c\u5f0f\u5316\u65e5\u671f\u5b57\u7b26\u4e32\uff0c\u8be6\u89c1\uff1a DateFormatter::format()","title":"\u989d\u5916\u7684filters"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#functions-twig","text":"url() path() url_from_path() link($text, $url, $attributes) {{ link(item.title, item.url, { 'class':['foo', 'bar', 'baz']} ) }} file_url($uri) \u8def\u5f84\u53c2\u6570\u9700\u8981\u662f\u76f8\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u5c06\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u3002 attach_library()","title":"Functions---Twig\u6a21\u7248\u4e2d\u7684\u51fd\u6570"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#twig-","text":"\u4e3a\u4e86\u4f7fDrupal8\u7684\u4e3b\u9898\u6027\u80fd\u6700\u5927\u5316\uff0c\u4ee5\u53ca\u66f4\u52a0\u7684\u5b9a\u5236\u5316\uff0c\u8bf7\u9075\u7167\u5982\u4e0b\u7684\u6700\u4f73\u5b9e\u8df5\u65b9\u5f0f\uff1a","title":"Twig\u6700\u4f73\u5b9e\u8df5---\u9884\u5904\u7406\u51fd\u6570\u548c\u6a21\u7248"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_5","text":"\u603b\u662f\u901a\u8fc7\u9884\u5904\u7406\u51fd\u6570\u8fd4\u56de\u53ef\u6e32\u67d3\u6570\u7ec4\uff0c\u800c\u4e0d\u662f\u8c03\u7528 theme() \u6216\u8005 drupal_render() \u51fd\u6570\u3002 Twig\u4f1a\u81ea\u52a8\u6e32\u67d3\uff0c\u6545\u6ca1\u6709\u5fc5\u8981\u8c03\u7528 theme() \u6216\u8005 drupal_render() \u51fd\u6570\u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u6bd4\u76f4\u63a5\u8f93\u51fa\u5df2\u7ecf\u6e32\u67d3\u7684html\u4ee3\u7801\u66f4\u5177\u5b9a\u5236\u5316\uff0c\u6e32\u67d3\u6570\u7ec4\u5e94\u8be5\u4f20\u9012\u7ed9\u6a21\u7248\u3002 \u4ece\u9884\u5904\u7406\u51fd\u6570\u4e2d\u5220\u9664 theme() \u51fd\u6570\uff1a <?php // \u4e4b\u524d\uff0c\u76f4\u63a5\u628a\u6e32\u67d3\u7684html\u4f20\u9012\u7ed9\u6a21\u7248 $variables['table'] = theme('table', array('header' => $header, 'rows' => $rows)); // \u4e4b\u540e\uff0c\u628a\u6e32\u67d3\u6570\u7ec4\u4f20\u9012\u7ed9\u6a21\u7248 $variables['table'] = array( '#theme' => 'table', '#header' => $header, '#rows' => $rows, ); ?> \u4ece\u9884\u5904\u7406\u51fd\u6570\u4e2d\u5220\u9664 drupal_render() \u51fd\u6570\u5c31\u662f\u4e0d\u518d\u8c03\u7528\u5b83\uff1a <?php // \u4e4b\u524d $variables['teaser'] = drupal_render($node_teaser); // \u4e4b\u540e $variables['teaser'] = $node_teaser; ?> \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c drupal_render() \u51fd\u6570\u662f\u5728\u6dfb\u52a0\u8868\u683c\u6570\u636e\u7684\u65f6\u5019\u8c03\u7528\u3002 <?php // \u4e4b\u524d $row[] = drupal_render($display['title']); // \u4e4b\u540e $row[]['data'] = $display['title']; ?>","title":"\u4f7f\u7528\u9884\u5904\u7406\u51fd\u6570\u8fd4\u56de\u53ef\u6e32\u67d3\u6570\u7ec4"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#filters_2","text":"\u4e3e\u4e2a\u4f8b\u5b50\uff1a \u4e4b\u524d\u7684\u505a\u6cd5\uff1a \u9884\u5904\u7406\u51fd\u6570\u4e2d\uff1a <?php $variables['no_content_text'] = t('You have not created any content types yet. Go to the <a href=\"@create-content\">content type creation page</a> to add a new content type.', array('@create-content' => url('admin/structure/types/add'))); ?> \u6a21\u7248\u4e2d\uff1a <p>{{ no_content_text }}</p> \u73b0\u5728\u7684\u505a\u6cd5\uff1a \u6a21\u7248\u4e2d\uff1a <p>{{ 'You have not created any content types yet. Go to the <a href=\"@create-content\">content type creation page</a> to add a new content type.'|t({'@create-content': url('admin/structure/types/add')}) }}</p>","title":"\u5728\u6a21\u7248\u4e2d\u8c03\u7528filters\u548c\u5de5\u5177\u51fd\u6570"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal_render_childrenelement_children","text":"\u5728\u539f\u59cb\u7684\u6a21\u7248\u4e2d\uff0c\u5982\u679c\u8c03\u7528\u4e86 hide() \u51fd\u6570\uff0c\u800c\u4e14 drupal_render_children \u51fd\u6570\u7528\u4e8e\u8f93\u51fa\u201d\u5269\u4e0b\u7684\u201c\u6570\u636e\uff0c\u6211\u4eec\u5c06\u9700\u8981\u5728\u9884\u5904\u7406\u7684\u65f6\u5019\u628a\u8fd9\u4e9b\u6570\u636e\u62c6\u5206\u6210\u5355\u4e2a\u53d8\u91cf\u3002 \u4e4b\u524d(PHPTemplate\u6a21\u7248)\uff1a <?php hide($form['advanced']); hide($form['actions']); ?> <div class=\"layout-node-form clearfix\"> <div class=\"layout-region layout-region-node-main\"> <?php print drupal_render_children($form); ?> </div> <div class=\"layout-region layout-region-node-secondary\"> <?php print render($form['advanced']); ?> </div> <div class=\"layout-region layout-region-node-footer\"> <?php print render($form['actions']); ?> </div> </div> \u4e4b\u540e(\u9884\u5904\u7406)\uff1a <?php function template_preprocess_node_edit_form(&$variables) { $form = $variables['form']; // @todo Update this once drupal.org/node/1920886 is resolved. $variables['advanced'] = $form['advanced']; $variables['actions'] = $form['actions']; unset($form['advanced'], $form['actions']); $variables['form'] = drupal_render_children($form); } ?> \u4e4b\u540e(Twig\u6a21\u7248)\uff1a <div class=\"layout-node-form clearfix\"> <div class=\"layout-region layout-region-node-main\"> {{ form|without('advanced', 'actions') }} </div> <div class=\"layout-region layout-region-node-secondary\"> {{ form.advanced }} </div> <div class=\"layout-region layout-region-node-footer\"> {{ form.actions }} </div> </div>","title":"\u663e\u793a/\u9690\u85cf &amp; \u5220\u9664drupal_render_children\u548celement_children"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal8_1","text":"","title":"\u521b\u5efaDrupal8\u7684\u4e3b\u9898"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#infoyml","text":"\u521b\u5efadrupal8\u4e3b\u9898\u7684\u7b2c\u4e00\u6b65\uff0c\u5c31\u662f\u521b\u5efa\u4e00\u4e2aTHEMENAME.info.yml\u6587\u4ef6\u3002\u6709\u4e00\u70b9\u5f88\u91cd\u8981\uff0c.info.yml\u6587\u4ef6\u4e2d\u7684\u201ctype\u201d\u952e\u9700\u8981\u8bbe\u7f6e\u6210\u201ctheme\u201d\u3002","title":"\u4ee5\u4e00\u4e2a.info.yml\u6587\u4ef6\u5f00\u59cb\u5b9a\u4e49\u4e00\u4e2a\u4e3b\u9898"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#infoyml_1","text":"\u5728\u4e3b\u9898\u6587\u4ef6\u5939\u7684\u6839\u76ee\u5f55\u521b\u5efa.info.yml\u6587\u4ef6\u3002\u6587\u4ef6\u5939\u7684\u540d\u5b57\u5e94\u8be5\u4fdd\u6301\u4e0e.info.yml\u6587\u4ef6\u540d\u76f8\u540c\u3002\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u7684\u4e3b\u9898\u547d\u540d\u4e3a\u201cFluffiness\u201d\uff0c\u90a3\u4e48\u6587\u4ef6\u5939\u7684\u540d\u5b57\u5c31\u662f\u201cfluffiness\u201d\uff0c\u800c.info.yml\u6587\u4ef6\u7684\u540d\u5b57\u662f\u201cfluffiness/fluffiness.info.yml\u201d\u3002 \u4f8b\u5982\uff1a name: Fluffiness type: theme description: A cuddly theme that offers extra fluffiness. core: 8.x libraries: - fluffiness/global-styling stylesheets-remove: - '@classy/css/components/tabs.css' - core/assets/vendor/normalize-css/normalize.css regions: header: Header content: Content sidebar_first: 'Sidebar first' footer: Footer \u5728\u4f60\u7684drupal\u7ad9\u70b9\u4e2d\uff0c\u6838\u5fc3\u63d0\u4f9b\u7684\u4e3b\u9898\u5305\u542b\u7740\u5f88\u591a.info.yml\u6587\u4ef6\u53ef\u4ee5\u4f9b\u4f60\u67e5\u9605\u5b9e\u4f8b\u3002","title":"\u521b\u5efa\u4e00\u4e2a.info.yml\u6587\u4ef6"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_6","text":"name: Fluffiness \u5fc5\u9009\u3002\u663e\u793a\u5728\u7ad9\u70b9\u5916\u89c2\u9875\u9762\u7684\uff0c\u53ef\u8bfb\u4e3b\u9898\u540d description: An extra cuddly Drupal theme available in grey and blue \u5fc5\u9009\uff0c\u4e3b\u9898\u63cf\u8ff0\uff0c\u4e5f\u4f1a\u663e\u793a\u5728\u7ad9\u70b9\u5916\u89c2\u7ba1\u7406\u9875\u9762 type: theme \u5fc5\u9009\u9879\uff0c\u6269\u5c55\u7c7b\u578b\uff0c\u6bd4\u5982\uff1amodule, theme \u6216\u8005 profile\u3002\u5bf9\u4e8e\u4e3b\u9898\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u6210\u201ctheme\u201d base theme: classy \u53ef\u4ee5\u4ece\u53e6\u4e00\u4e2a\u4e3b\u9898\u7ee7\u627f\u5176\u8d44\u6e90\u7684\u4e3b\u9898 core: 8.x \u5fc5\u9009\uff0c\u5f53\u524d\u4e3b\u9898\u517c\u5bb9\u7684Drupal\u7248\u672c version: 8.x-1.0 screenshot: fluffiness.png libraries: fluffiness/global-styling \u5f53\u4e3b\u9898\u542f\u7528\u65f6\uff0c\u4e3a\u6240\u6709\u7684\u9875\u9762\u52a0\u8f7d\u8d44\u6e90\u5e93\u6587\u4ef6\uff0c\u5305\u62eccss\u548cjs \u4f8b\u5982\uff1a global-styling: version: 1.x css: theme: css/style.css: {} css/print.css: { media: print } \u5f53html\u89e3\u6790\u65f6\uff0c\u5c31\u4f1a\u662f\uff1a <link rel=\"stylesheet\" href=\"css/style.css\" media=\"all\" /> <link rel=\"stylesheet\" href=\"css/print.css\" media=\"print\" /> stylesheets-remove: - core/assets/vendor/normalize-css/normalize.css # 1 - '@classy/css/components/tabs.css' # 2 \u6ce8\u610f\uff1a 1. stylesheets-remove\u952e\u5b9a\u4e49\u9700\u8981\u5220\u9664\u7684\u6837\u5f0f\uff0c\u9700\u8981\u8bbe\u7f6e\u6210\u5b8c\u5168\u8def\u5f84\u3002 2. \u4e3a\u4e86\u65b9\u5f0fDrupal\u6838\u5fc3\u7684\u8d44\u6e90\uff08\u4f8b\u5982\uff0cjQuery UI\u7684css\u6587\u4ef6\uff09\u88ab\u5220\u9664\uff0c\u8bf7\u8bbe\u7f6e\u4e3a\u5b8c\u5168\u8def\u5f84\u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u907f\u514d\u5f53\u524d\u8fd9\u4e2a\u6587\u4ef6\u5c5e\u4e8e\u67d0\u4e2a\u6a21\u5757\u6216\u8005\u4e3b\u9898\u63d0\u4f9b\u7684\u5e93\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528token\u3002\u6ce8\u610f\uff0c\u5982\u679c\u4f7f\u7528token\uff0c\u7531\u4e8e@\u4f1a\u88ab\u5f53\u6210YAML\uff0c\u8bf7\u8bb0\u5f97\u4f7f\u7528\u5f15\u53f7\u3002 regions: header: Header content: Content # required! sidebar_first: 'Sidebar first' footer: Footer","title":"\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u952e\u91ca\u4e49"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_7","text":"\u4e3b\u9898\u5c31\u662f\u5b9a\u4e86\u89c6\u56fe\u5c42\u7684\u8bb8\u591a\u6587\u4ef6\u7684\u96c6\u5408\u3002.info.yml\u6587\u4ef6\u662f\u5fc5\u987b\u7684\uff0c\u4e0b\u9762\u4f1a\u5217\u51fa\u4e00\u4e2a\u5178\u578b\u7684\u4e3b\u9898\u6587\u4ef6\u5939\u4e2d\u6240\u5305\u542b\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u3002","title":"\u4e3b\u9898\u6587\u4ef6\u5939\u7684\u7ed3\u6784"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_8","text":"\u4e3b\u9898\u5fc5\u987b\u653e\u7f6e\u5728Drupal\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u201cthemes\u201d\u6587\u4ef6\u5939\u4e2d\u3002\u6ce8\u610f\uff0c\u6838\u5fc3\u7684\u4e3b\u9898\uff0c\u4f8b\u5982\uff1aBartik\u548cSeven\u4f4d\u4e8ecore/themes\u6587\u4ef6\u5939\u4e0b\u3002 \u4e00\u4e2a\u597d\u7684\u5efa\u8bae\u662f\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201ccontrib\u201d\u7684\u6587\u4ef6\u5939\u7528\u4e8e\u5b58\u653e\u4e0b\u8f7d\u7684\u8d21\u732e\u4e3b\u9898\uff0c\u800c\u201ccustom\u201d\u6587\u4ef6\u5939\u7528\u4e8e\u5b58\u653e\u81ea\u5b9a\u4e49\u7684\u4e3b\u9898\u3002 \u4e3b\u4f53\u540d\u79f0\u5fc5\u987b\u5c0f\u5199\u3002","title":"\u4e3b\u9898\u7684\u4f4d\u7f6e"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal","text":"|-core | |-modules | |-themes | | |-bartik | | |-seven .. |-modules |-themes | |-contrib | | |-zen | | |-basic | | |-bluemarine | |-custom | | |-fluffiness","title":"Drupal\u7684\u76ee\u5f55\u7ed3\u6784\uff1a"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#fluffiness","text":"|-fluffiness.breakpoints.yml |-fluffiness.info.yml |-fluffiness.libraries.yml |-fluffiness.theme |-config | |-install | | |-fluffiness.settings.yml | |-schema | | |-fluffiness.schema.yml |-css | |-style.css |-js | |-fluffiness.js |-images | |-buttons.png |-logo.png |-screenshot.png |-templates | |-maintenance-page.html.twig | |-node.html.twig \u4e0b\u9762\uff0c\u4ecb\u7ecd\u4e00\u4e0b\u4e3b\u9898\u6587\u4ef6\u5939\u4e2d\u7684\u901a\u7528\u6587\u4ef6\u3002","title":"\u4e3b\u9898\u6587\u4ef6\u5939\u7ed3\u6784\uff0c\u5047\u8bbe\u4e3b\u9898\u540d\u79f0\u662f\uff1afluffiness"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#infoyml_2","text":"\u4e3b\u9898\u5fc5\u987b\u5305\u542b*.info.yml\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5b9a\u4e49\u4e86meta\u6570\u636e\uff0c\u6837\u5f0f\uff0c\u8fd8\u6709\u533a\u5757\u548c\u533a\u57df\u4fe1\u606f\u3002","title":"*.info.yml"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#librariesyml","text":"*.libraries.yml\u6587\u4ef6\u7528\u4e8e\u4e3b\u9898\u542f\u7528\u65f6\u9700\u8981\u52a0\u8f7d\u7684\u5b9a\u4e49js\u548ccss\u5e93\uff0c\u8be6\u60c5 \u70b9\u51fb\u8fd9\u91cc","title":"*.libraries.yml"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#breakpointsyml","text":"\u54cd\u5e94\u5f0f\u8bbe\u8ba1\u76f8\u5173\u7684\u8bbe\u7f6e\uff0c\u8be6\u89c1\uff1a *.breakpoints.yml\u8bbe\u7f6e","title":"*.breakpoints.yml"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#theme","text":"*.theme\u6587\u4ef6\u662f\u4e00\u4e2aphp\u6587\u4ef6\uff0c\u5305\u542b\u4e86\u6240\u6709\u7684\u903b\u8f91\u5904\u7406\u4ee3\u7801\u548c\u8f93\u51fa\u524d\u7684\u9884\u5904\u7406\u3002","title":"*.theme"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#css","text":"\u4e00\u4e2a\u597d\u7684\u5efa\u8bae\u5c31\u662f\u5c06css\u6587\u4ef6\u5b58\u653e\u5728\u201ccss\u201d\u81ea\u76ee\u5f55\u4e0b\u3002","title":"css/"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#js","text":"\u5b58\u653e\u7740\u4e3b\u9898\u9700\u8981\u7684js\u6587\u4ef6\u3002","title":"js/"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#images","text":"\u5b58\u653e\u4e3b\u9898\u9700\u8981\u7684\u56fe\u7247","title":"images/"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#screenshotpng","text":"\u4e3b\u9898\u7684\u9884\u89c8\u56fe","title":"screenshot.png"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#templates","text":"","title":"templates/"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#bartik","text":"|-bartik.breakpoints.yml |-bartik.info.yml |-bartik.libraries.yml |-bartik.theme |-color | |-color.inc | |-preview.css | |-preview.html | |-preview.js |-config | |-schema | | |-bartik.schema.yml |-css | |-base | | |-elements.css | |-components | | |-block.css | | |-book.css | | |-breadcrumb.css ... | |-colors.css | |-layout.css | |-maintenance-page.css | |-print.css |-images | |-add.png | |-required.svg | |-tabs-border.png |-logo.svg |-screenshot.png |-templates | |-block--search-form-block.html.twig | |-block--system-branding-block.html.twig | |-block--system-menu-block.html.twig | |-block.html.twig | |-comment.html.twig | |-field--taxonomy-term-reference.html.twig | |-maintenance-page.html.twig | |-node.html.twig | |-page.html.twig | |-status-messages.html.twig","title":"\u6838\u5fc3\u4e3b\u9898Bartik\u7684\u76ee\u5f55\u7ed3\u6784\uff1a"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_9","text":"\u4e3a\u4e3b\u9898\u6dfb\u52a0\u533a\u57df\u9700\u8981\u4e24\u6b65\uff1a \u5728\u4e3b\u9898\u6587\u4ef6.info.yml\u4e2d\u6dfb\u52a0\u533a\u57df\u7684meta-data \u7f16\u8f91page.html.twig\u6587\u4ef6\u6253\u5370\u65b0\u7684\u533a\u57df","title":"\u4e3a\u4e3b\u9898\u6dfb\u52a0\u533a\u57df"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#info","text":"\u533a\u57df\u5b9a\u4e49\u6210ragions\u952e\u7684\u5b50\u5143\u7d20\uff1a # Regions regions: header: 'Header' content: 'Content' footer: 'Footer' Region \u952e\u5e94\u662f\u4e2a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u5305\u542b\u4e0b\u5212\u7ebf\u201c_\u201d\u3002","title":"info\u6587\u4ef6\u4e2d\u6dfb\u52a0\u533a\u57df"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_10","text":"\u4e3a\u4e86\u663e\u793a\u533a\u57df\u4e2d\u7684\u5185\u5bb9\uff0c\u4f60\u9700\u8981\u786e\u5b9a\u65b0\u7684\u533a\u57df\u4e5f\u6dfb\u52a0\u5230\u4e86page.html.twig\u6a21\u7248\u4e2d\u3002 \u4f8b\u5982\uff1a header: 'Header' \u6a21\u7248\u4e2d\u8f93\u51fa\uff1a {{ page.header }} \u6b64\u5916\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u4eec\u5f53\u6210\u662fTwig\u6a21\u7248\u7684\u666e\u901a\u53d8\u91cf\uff0c\u53ef\u4ee5\u518d\u4efb\u4f55\u9700\u8981\u7684\u5730\u65b9\u6253\u5370\u8f93\u51fa\u3002","title":"\u6a21\u7248\u4e2d\u6dfb\u52a0\u533a\u57df"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_11","text":"\u53ef\u4ee5\u5728 page.html.twig\u6a21\u7248\u6587\u6863 \u4e2d\u67e5\u9605\u9ed8\u8ba4\u7684\u533a\u57df page.header page.primary_menu page.secondary_menu page.highlighted page.help page.content page.sidebar_first page.sidebar_second page.footer page.breadcrumb","title":"\u9ed8\u8ba4\u533a\u57df"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal8js","text":"","title":"Drupal8\u4e3b\u9898\u4e2d\u6dfb\u52a0\u6837\u5f0f\u548cjs"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal7","text":"\u6709\u56db\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u533a\u522b\uff1a \u53bb\u6389\u4e86THEME.info\u6587\u4ef6\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fTHEME.info.yml\u6587\u4ef6 THEME.info.yml\u6587\u4ef6\u4e2d\u7684stylesheets\u5c5e\u6027\u4e0d\u590d\u5b58\u5728\uff0c\u6539\u4e3a\u5e93\u7684\u65b9\u5f0f\u5f15\u5165 THEME.info.yml\u6587\u4ef6\u4e2d\u7684scripts\u5c5e\u6027\u4e0d\u590d\u5b58\u5728\uff0c\u6539\u4e3a\u5e93\u7684\u65b9\u5f0f\u5f15\u5165 \u6bcf\u4e00\u4e2a\u9875\u9762\u7684js\u53ea\u5728\u9700\u8981\u65f6\u624d\u52a0\u8f7d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDrupal\u5bf9\u4e8e\u533f\u540d\u7528\u6237\u4e0d\u4f1a\u9700\u8981js\u3002\u8fd9\u610f\u5473\u7740\uff0cjquery\u4e0d\u4f1a\u518d\u5728\u6bcf\u4e2a\u9875\u9762\u81ea\u52a8\u52a0\u8f7d\u4e86\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u7684\u4e3b\u9898\u9700\u8981jquery\u6216\u8005\u5176\u5b83\u7684js\uff0c\u4f60\u9700\u8981\u901a\u8fc7\u201c\u58f0\u660e\u4f9d\u8d56\u5173\u7cfb\u201d\u6765\u544a\u8bc9Drupal\u8fd9\u4e2ajs\u9700\u8981\u52a0\u8f7d ** \u52a0\u8f7dcss/js\u7684\u6b65\u9aa4\uff1a** \u5c06css\u6216\u8005js\u4fdd\u5b58\u5230\u4e00\u4e2a\u6587\u4ef6 \u5b9a\u4e49\u4e00\u4e2a\u5305\u542bjs\u548ccss\u6587\u4ef6\u7684\u201clibrary\u201d \u5728\u94a9\u5b50\u4e2d\uff0c\u628a\u8fd9\u4e2a\u5e93\u8ffd\u52a0\u7ed9\u6e32\u67d3\u6570\u7ec4","title":"\u4e0eDrupal7\u4e3b\u9898\u7684\u533a\u522b"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_12","text":"\u5728\u4e3b\u9898\u6587\u4ef6\u5939\u4e2d\u521b\u5efa*.libraries.yml\u6587\u4ef6\u6765\u6dfb\u52a0\u5e93\uff08\u5047\u8bbe\u4f60\u7684\u4e3b\u9898\u540d\u79f0\u662f fluffiness \uff0c\u90a3\u4e48\u6587\u4ef6\u540d\u5c31\u662f fluffiness.libraries.yml \uff09\u3002\u6bcf\u4e00\u4e2a\u5e93\uff0c\u90fd\u662fcss\u548cjs\u6587\u4ef6\u7684\u8be6\u60c5\u5217\u8868\uff1a cuddly-slider: version: 1.x css: theme: css/cuddly-slider.css: {} js: js/cuddly-slider.js: {} \u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5047\u8bbe cuddly-slider.js \u6587\u4ef6\u4f4d\u4e8e\u4e3b\u9898\u7684js\u5b50\u76ee\u5f55\u4e2d\u3002 \u7136\u540e\uff0c\u9700\u8981\u8bb0\u4f4f\u7684\u662f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDrupal8\u4e0d\u4f1a\u5728\u6bcf\u4e00\u4e2a\u9875\u9762\u52a0\u8f7djquery\uff1b\u53ea\u5728\u9700\u8981\u65f6\u52a0\u8f7d\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u81ea\u5df1\u58f0\u660e\uff0c\u4e3b\u9898\u7684 cuddly-slider \u5e93\u4f9d\u8d56 jQuery \u3002 \u56e0\u6b64\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u4e0a\u4f8b\u7684 js/cuddly-slider.js \u53ef\u7528\uff0c\u6211\u4eec\u9700\u8981\u66f4\u65b0\u4e0b\uff1a cuddly-slider: version: 1.x css: theme: css/cuddly-slider.css: {} js: js/cuddly-slider.js: {} dependencies: - core/jquery \u5f53\u7136\uff0c\u5e93\u4e5f\u53ef\u4ee5\u53ea\u5305\u542bcss\uff0c\u6216\u8005\u53ea\u5305\u542bjs\u3002\u5927\u90e8\u5206\u7684\u4e3b\u9898\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a global-styling \u5e93\uff0c\u7528\u4e8e\u5168\u5c40\u52a0\u8f7d\u6837\u5f0f\u6587\u4ef6\uff1a global-styling: version: 1.x css: theme: css/layout.css: {} css/style.css: {} css/colors.css: {} css/print.css: { media: print } \u800c\u4e14\uff0c\u6b63\u5982\u4f60\u6240\u60f3\uff0c\u5e93\u4e2d\u5b9a\u4e49\u7684css\u7684\u987a\u5e8f\u5c31\u662f\u5c06\u6765\u52a0\u8f7d\u7684\u987a\u5e8f\u3002 \u5728Drupal7\u4e2d\uff0c\u4f60\u53ef\u4ee5\u628a\u5a92\u4f53\u67e5\u8be2\u5c5e\u6027(screen, print, all)\u4f5c\u4e3a stylesheets \u5c5e\u6027\u7684\u5b50\u952e\uff0c\u800c\u73b0\u5728\u4f60\u53ef\u4ee5\u628a\u5b83\u5f53\u4f5c\u503c\u5b9a\u4e49\uff0c\u4f8b\u5982\uff1a css/print.css: { media: print } \u73b0\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684js\u6587\u4ef6\u90fd\u5728\u9875\u811a\u52a0\u8f7d\u3002 js-header: header: true js: header.js: {} js-footer: js: footer.js: {} \u4f60\u5f97\u8bbe\u7f6e header \u5c5e\u6027\u4e3atrue\u3002","title":"\u5b9a\u4e49\u4e00\u4e2a\u5e93"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_13","text":"\u90a3\u4e9b\u5b9a\u4e49\u5728 *.libraries.yml \u6587\u4ef6\u4e2d\u7684\u5e93\u53ef\u4ee5\u901a\u8fc7\u4e3b\u9898\u7684 *.info.yml \u6587\u4ef6\u4e2d\u7684 libraries-override \u548c libraries-extend \u9879\u8fdb\u884c\u8986\u5199\u548c\u6269\u5c55\u3002 libraries-override libraries-override \u662f\u5b9a\u4e49\u5728\u5e93\u4e2d\uff0c\u4e3b\u9898\u7528\u6765\u64cd\u4f5ccss/js\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5305\u62ec\u5220\u9664\u3001\u66ff\u6362\u6216\u8005\u5220\u9664css/js\u3002 libraries-override: # Replace an entire library. core/drupal.collapse: mytheme/collapse # Replace an asset with another. subtheme/library: css: theme: css/layout.css: css/my-layout.css # Remove an asset. drupal/dialog: css: theme: dialog.theme.css: false # Remove an entire library. core/modernizr: false libraries-extend *libraries-extend*\u4e3a\u4e3b\u9898\u63d0\u4f9b\u4e86\u4e00\u79cd\u53ef\u4ee5\u4fee\u6539\u5e93\u7684\u65b9\u5f0f\u3002\u6bd4\u5982\uff0c\u6dfb\u52a0\u989d\u5916\u7684\u4e3b\u9898\u4f9d\u8d56\u7684\u5e93\u3002 # Extend drupal.user: add assets from classy's user libraries. libraries-extend: core/drupal.user: - classy/user1 - classy/user2","title":"\u8986\u76d6\u6269\u5c55\u5e93"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_14","text":"\u5728Twig\u6a21\u7248\u4e2d\u8ffd\u52a0\u5e93 \u901a\u8fc7\u8c03\u7528twig\u7684\u65b9\u6cd5\uff0c attach_library() \u53ef\u4ee5\u5728twig\u6a21\u7248\u4e2d\u8ffd\u52a0\u5e93\uff0c\u4f8b\u5982\uff1a {{ attach_library('fluffiness/cuddly-slider') }} <div>Some fluffy markup {{ message }}</div> \u8ffd\u52a0\u7ed9\u6240\u6709\u7684\u9875\u9762 \u4e3a\u4e86\u6240\u6709\u9875\u9762\u90fd\u52a0\u8f7d\u8fd9\u4e2a\u5e93\uff0c\u9700\u8981\u5728\u4e3b\u9898\u7684 *.info.yml \u6587\u4ef6\u4e2d\uff0c libraries \u952e\u7684\u4e0b\u9762\u58f0\u660e\uff1a name: Example type: theme core: 8.x libraries: - fluffiness/cuddly-slider","title":"\u8ffd\u52a0\u5e93\u5230\u9875\u9762\u4e2d"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_15","text":"\u5728\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u80fd\u4e0d\u5e0c\u671b\u6240\u6709\u7684\u9875\u9762\u52a0\u8f7d\u4f60\u7684\u5e93\uff0c\u800c\u662f\u90e8\u5206\u9875\u9762\u52a0\u8f7d\u3002\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff0c\u4f60\u53ef\u80fd\u53ea\u60f3\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u533a\u5757\u4e2d\u52a0\u8f7d\uff0c\u6216\u8005\u7528\u6237\u8bbf\u95ee\u67d0\u4e2a\u8282\u70b9\u7c7b\u578b\u65f6\u52a0\u8f7d\u3002 \u4e3b\u9898\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 THEME_preprocess_HOOK() \u65b9\u6cd5\u8fbe\u5230\u8fd9\u4e2a\u6548\u679c\u3002 \u4f8b\u5982\uff0c\u4f60\u60f3\u8981\u5728\u7ef4\u62a4\u9875\u9762\u8ffd\u52a0\u4f60\u7684\u5e93\uff0c\u201cHOOK\u201d\u5c31\u662f\u201cmaintenance_page\u201d\uff0c\u7136\u540e\u4f60\u7684\u65b9\u6cd5\u5c31\u662f\uff1a <?php function fluffiness_preprocess_maintenance_page(&$variables) { $variables['#attached']['library'][] = 'fluffiness/cuddly-slider'; } ?> \u4f60\u4e5f\u53ef\u4ee5\u4e3a\u4e3b\u9898\u7684\u5176\u5b83hook\u505a\u540c\u6837\u7684\u4e8b\u60c5\uff0c\u5f53\u7136\u4f60\u7684\u51fd\u6570\u4e2d\u4e5f\u53ef\u4ee5\u5305\u542b\u903b\u8f91\u5904\u7406\u3002 \u91cd\u8981\u63d0\u793a \uff1a\u6700\u901a\u7528\u7684\u7528\u6cd5\u662f\u6839\u636e\u5f53\u524d\u7684\u8def\u7531\u6765\u52a0\u8f7d\u5e93\uff1a <?php function fluffiness_preprocess_page(&$variables) { $variables['#cache']['contexts'][] = 'route'; if (\\Drupal::routeMatch()->getRouteName() === 'entity.node.preview') { $variables['#attached']['library'][] = 'fluffiness/node-preview'; } } ?>","title":"\u4e3a\u4e00\u7ec4\u9875\u9762\u6dfb\u52a0\u5e93"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#js_1","text":"\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u80fd\u60f3\u8981\u6839\u636e\u67d0\u4e9bphp\u8ba1\u7b97\u4fe1\u606f\u6765\u52a0\u8f7djs\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u50cf\u4e4b\u524d\u4e00\u6837\uff0c\u521b\u5efa\u4e00\u4e2ajs\u6587\u4ef6\u5e76\u8ffd\u52a0\u8fdb\u6765\uff0c\u518d\u901a\u8fc7 drupalSettings (\u66ff\u6362Drupal7\u4e2d\u7684 Drupal.settings )\u8ffd\u52a0\u4e00\u4e9bjs\u8bbe\u7f6e\u9879\u5e76\u7531\u8ffd\u52a0\u7684js\u6587\u4ef6\u8bfb\u53d6\u8fd9\u4e9b\u8bbe\u7f6e\u9879\u3002\u7136\u540e\uff0c\u4e3a\u4e86\u4f7f drupalSettings \u5728\u6211\u4eec\u7684js\u6587\u4ef6\u4e2d\u751f\u6548\uff0c\u6211\u4eec\u5f97\u50cf\u5f15\u5165jQuery\u4e00\u6837\u64cd\u4f5c\uff1a\u6211\u4eec\u5f97\u5728\u4f9d\u8d56\u4e2d\u5b9a\u4e49\u3002 \u5c31\u50cf\u8fd9\u6837\uff1a cuddly-slider: version: 1.x js: js/cuddly-slider.js: {} dependencies: - core/jquery - core/drupalSettings \u4ee5\u53ca <?php function fluffiness_page_attachments_alter(&$page) { $page['#attached']['library'][] = 'fluffiness/cuddly-slider'; $page['#attached']['drupalSettings']['fluffiness']['cuddlySlider']['foo'] = 'bar'; } ?> \u8fd9\u6837 cuddly-slider.js \u5c31\u53ef\u4ee5\u8bbf\u95ee drupalSettings.fluffiness.cuddlySlider.foo \u4e86(\u8fd9\u91cc === 'bar')\u3002","title":"\u6dfb\u52a0\u53ef\u5b9a\u5236\u7684js"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#attributes","text":"attributes\u662f\u4e00\u4e2a\u5728\u6bcf\u4e2atwig\u6a21\u7248\u4e2d\u90fd\u6709\u6548\u7684\u5bf9\u8c61\u3002attributes\u7528\u6765\u5b58\u50a8\u6240\u6709\u7684\u7236\u5bb9\u5668\u7684\u76f8\u5173\u5c5e\u6027\uff0c\u5e76\u63d0\u4f9b\u6709\u7528\u7684\u65b9\u6cd5\u7ed9\u5f00\u53d1\u8005\u5904\u7406\u8fd9\u4e9b\u6570\u636e\u3002","title":"\u5728\u6a21\u7248\u4e2d\u4f7f\u7528attributes"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#attribute","text":"attributes.addClass() \u5355\u4e2a\u7c7b\uff1a <div{{attributes.addClass('my-class')}}></div> \u591a\u4e2a\u7c7b\uff1a {% set classes = [ 'red', 'green', ] %} <div{{ attributes.addClass(classes) }}></div> \u5c06\u4f1a\u8f93\u51fa\uff1a <div class=\"red green\"></div>. html\u6807\u7b7e\u4e0etwig\u8bed\u6cd5\u4e4b\u95f4\u4e0d\u80fd\u6709\u4efb\u4f55\u7a7a\u683c\uff01 attributes.removeClass() {#classes = [ 'red', 'green', 'blue' ] #} <div{{ attributes.addClass(classes).removeClass('green') }}></div> \u5c06\u4f1a\u8f93\u51fa\uff1a <div class=\"red blue\"></div> attributes.setAttribute($attribute, $value) <div{{ attributes.setAttribute('id', 'myID') }}></div> \u5c06\u4f1a\u8f93\u51fa\uff1a <div id=\"myID\"></div> attributes.removeAttribute($attribute, $value) <div{{ attributes.removeAttribute('id') }}></div> attributes.hasClass($class) {% if attribute.hasClass(\u2018myClass') %} {# do stuff #} {% endif %}","title":"Attribute\u7684\u65b9\u6cd5"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#_16","text":"\u94fe\u5f0f {% set classes = ['red', 'green', 'blue'] %} {% set my_id = 'specific-id' %} {% set image_src = 'https://www.drupal.org/files/powered-blue-135x42.png' %} <img{{ attributes.addClass(classes).removeClass('green').setAttribute('id', my_id).setAttribute('src', image_src) }}> \u5c06\u4f1a\u8f93\u51fa\uff1a <img id=\"specific-id\" class=\"red blue\" src=\"https://www.drupal.org/files/powered-blue-135x42.png\"> \u4f7f\u7528without filter <div class=\u201dmyclass {{ attributes.class }}\u201d{{attributes|without(\u2018class\u2019) }}></div>","title":"\u5176\u5b83\u6709\u7528\u7684\u4ee3\u7801\u7247\u6bb5"},{"location":"drupal/drupal8/Drupal8%E4%B8%BB%E9%A2%98-theme/#drupal6-7-8","text":"\u8fd9\u91cc\u5217\u51fa\u7684\u662f\u6bd4\u8f83\u91cd\u8981\u7684Drupal8\u4e2d\u7684\u4e3b\u9898\u53d8\u5316 Drupal8\u9ed8\u8ba4\u8f93\u51fahtml5 \u9664\u4e86jQuery2.x\u4e4b\u5916\uff0cDrupal8\u8fd8\u5f15\u5165\u66f4\u591a\u7684\u524d\u7aef\u6846\u67b6\uff0c\u4f8b\u5982\uff1a Modernizr \uff0c Underscore.js \uff0c\u4ee5\u53ca Backbone.js \u3002 Drupal8\u5f15\u5165\u4e86Twig\uff0c\u66ff\u6362\u4e86\u539f\u6765\u7684\u9ed8\u8ba4\u6a21\u677f\u5f15\u64cePHPTemplate\u3002 Drupal8\u5904\u4e8e\u6027\u80fd\u8003\u8651\uff0c\u9ed8\u8ba4\u542f\u7528\u4e86\u7c7b\u4f3ccss\u3001js\u5408\u5e76\u4e4b\u7c7b\u7684\u9ed8\u8ba4\u7279\u6027\u3002 \u5728drupal6\u548cdrupal7\u4e2d\uff0c\u53ef\u4ee5\u8c03\u7528 drupal_add_css() \u548c drupal_add_js() \u51fd\u6570\u6dfb\u52a0css\u6216\u8005js\uff0c\u73b0\u5728\u66ff\u6362\u6210\u4e86\u5728\u6e32\u67d3\u6570\u7ec4\u4e2d\u8ffd\u52a0 #attached \u5c5e\u6027\u8c03\u7528\u5e93\u7684\u65b9\u6cd5\u3002 Drupal8\u4e0d\u518d\u652f\u6301IE6\u30017\u30018\uff0c\u542f\u7528jQuery2.0\uff0c\u652f\u6301\u73b0\u4ee3HTML5/CSS3\u6d4f\u89c8\u5668\u3002 Drupal8\u4e0d\u652f\u6301\u90a3\u4e9b\u4e0d\u652f\u6301SVG\u7684\u6d4f\u89c8\u5668(\u5305\u62ecIE8\u548c\u5b89\u5353\u6d4f\u89c8\u56682.3)\u3002 Drupal8\u7684css\u4e2d\uff0c\u51cf\u5c11\u4e86id\u7684\u4f7f\u7528\u3002 Drupal8\u7684css\u7ed3\u6784(\u6587\u4ef6\u7ed3\u6784)\u57fa\u4e8e SMACSS \u548c BEM Drupal8\u5c06\u9884\u5904\u7406\u51fd\u6570\u4e2d\u7684css\u7c7b\u79fb\u5230\u4e86Twig\u6a21\u7248\u4e2d\u3002","title":"Drupal6, 7, 8\u4e3b\u9898\u533a\u522b"},{"location":"drupal/drupal8/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/","tags":"[\u6d4b\u8bd5]","text":"Drupal8\u7684\u529f\u80fd\u6d4b\u8bd5\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u7ad9\u70b9\uff0c\u5e76\u4e14\u5b89\u88c5\u4e86simpleTest\u6838\u5fc3\u6a21\u5757\u3002 \u672c\u6587\u7684\u6d4b\u8bd5\u7528\u4f8b\u5b9e\u73b0\u7684\u529f\u80fd\u4e3a\uff1a \u5411user\u5b9e\u4f53\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5\uff0c\u7136\u540e\u68c0\u67e5\u7528\u6237\u91cc\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u5b57\u6bb5\u3002 \u4e00\u3001PHPUnit\u548cSimpleTest\u529f\u80fd\u6d4b\u8bd5(BrowserTestBase / WebTestBase) \u00b6 \u4ee5\u540e\u7684\u529f\u80fd\u6d4b\u8bd5\u90fd\u662f\u4f7f\u7528phpUnit\u548cBrowserTestBase\uff0cDrupal8\u4e2d\u5f88\u591a\u6a21\u5757\u8fd8\u5728\u7528WebTestBase. BrowserTestBase\u7684\u4e3b\u8981\u9650\u5236\u662f\u4e0d\u80fd\u4f7f\u7528JavaScript\u548cAJAX\u3002 \u5982\u679c\u9700\u8981\u6d4b\u8bd5\u5b83\u4eec\uff0c\u5efa\u8bae\u5148\u7528WebTestBase\u3002 1\u3001\u5b9a\u4e49\u5b57\u6bb5 \u00b6 vim config/install/field.field.user.user.test_status.yml \u7f16\u8f91\u6587\u4ef6\u5185\u5bb9\u4e3a\uff1a langcode: en status: true dependencies: config: - field.storage.user.test_status id: user.user.test_status field_name: test_status entity_type: user bundle: user label: test_status description: '' required: false translatable: false default_value: - value: 0 default_value_callback: '' settings: on_label: 'On' off_label: 'Off' field_type: boolean vim config/install/field.storage.user.test_status.yml \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a langcode: en status: true dependencies: module: - user id: user.test_status field_name: test_status entity_type: user type: boolean settings: { } module: test_example locked: false cardinality: 1 translatable: true indexes: { } persist_with_no_fields: false 2\u3001\u521b\u5efa\u529f\u80fd\u6d4b\u8bd5 \u00b6 \u5fc5\u987b\u5728tests/src/Functional/\u5185\u521b\u5efa\u4e00\u4e2a\u4ee5 Test.php \u7ed3\u5c3e\u7684\u6587\u4ef6\u3002 \u521b\u5efa\u4e00\u4e2a\u7ee7\u627f BrowserTestBase \u7684\u7c7b\u521b\u5efa\u6d4b\u8bd5\u3002 \u6211\u4eec\u4e5f\u4f7f\u7528 Drupal\\Tests[module_name]\\Functional \u4f5c\u4e3a\u6240\u6709\u6d4b\u8bd5\u7c7b\u7684namespace\u3002 \u7f16\u8f91src/Functional/TestExampleUserTest.php <?php /** * @file * * Contains \\Drupal\\Tests\\test_example\\Functional\\TestExampleUserTest. */ namespace Drupal\\Tests\\test_example\\Functional ; use Drupal\\simpletest\\BrowserTestBase ; /** * Check if our user field works. * * @group test_example * @runTestsInSeparateProcesses * @preserveGlobalState disabled */ class TestExampleUserTest extends BrowserTestBase { /** * @var \\Drupal\\user\\Entity\\User. */ protected $user ; /** * Enabled modules */ public static $modules = [ 'test_example' ]; /** * {@inheritdoc} */ function setUp () { parent :: setUp (); $this -> user = $this -> drupalCreateUser (); } /** * Test that the user has a test_status field. */ public function testUserHasTestStatusField () { $this -> assertTrue ( in_array ( 'test_status' , array_keys ( $this -> user -> getFieldDefinitions ()))); } } \u6ce8\u89e3 \u6240\u6709\u4f7f\u7528PhpUnit\u7684\u529f\u80fd\u6d4b\u8bd5\u5fc5\u987b\u8981\u6709\u4e24\u4e2a\u6ce8\u89e3\uff0c @runTestsInSeparateProcesses \u548c @preserveGlobalState disabled\u3002 \u6fc0\u6d3b\u6a21\u5757 \u56e0\u4e3a\u529f\u80fd\u6d4b\u8bd5\u8fd0\u884c\u5728\u6ca1\u6709\u5b8c\u5168\u6784\u5efa\u7684Drupal\u7cfb\u7edf\u5185\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u6fc0\u6d3b\u9700\u6d4b\u8bd5\u7684\u6a21\u5757\u3002 setUp \u5fc5\u987b\u8c03\u7528parent::setUp\u65b9\u6cd5\uff0c\u5728\u8fd9\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u91cc\uff0c\u6211\u4eec\u8c03\u7528\u4e86drupalCreateUser\u65b9\u6cd5\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u8bbf\u95ee\u5230\u7528\u6237\u5b9e\u4f53\u3002 \u6d4b\u8bd5\u65b9\u6cd5 \u548c\u5355\u5143\u6d4b\u8bd5\u4e00\u6837\uff0c\u65b9\u6cd5\u5fc5\u987b\u4ee5test\u5f00\u5934\u3002 \u65ad\u8a00\u8bed\u53e5 \u548c\u5355\u5143\u6d4b\u8bd5\u4e00\u6837\u3002\u5728\u4e0a\u9762\u8fd9\u4e2a\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6211\u4eec\u68c0\u67e5\u7528\u6237\u5b9e\u4f53\u91cc\u662f\u5426\u5b58\u5728test_status\u8fd9\u4e2a\u5b57\u6bb5\u3002 3\u3001\u6267\u884c\u529f\u80fd\u6d4b\u8bd5 \u00b6 \u9996\u5148\u8bbe\u7f6e\u4e00\u4e0bphpstrom * \u6253\u5f00 PhpStorm * \u5728 Command Line \u90e8\u5206\uff0c\u7f16\u8f91 Environment \u53d8\u91cf\u3002 * \u8bbe\u7f6eSIMPLETEST_BASE_URL \u548c\u503c\uff08\u7ad9\u70b9URL)\u3002 \u4e8c\u3001Ajax\u529f\u80fd\u6d4b\u8bd5-SimpleTest \u00b6 phpUnit\u548csimpleTest\u7684\u4e3b\u8981\u533a\u522b\u662f\uff1a \u6587\u4ef6\u547d\u540d\u548c\u540d\u5b57\u7a7a\u95f4 \u8981\u521b\u5efaSimpleTest\u529f\u80fd\u6d4b\u8bd5\uff0c\u4f60\u5fc5\u987b\u5728src/Tests/\u5185\u521b\u5efa\u4e00\u4e2a\u4ee5Test.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u3002 \u4e00\u822c\u901a\u8fc7\u7ee7\u627f\u57fa\u7c7bWebTestBase\u6216KernelTestBase\u521b\u5efa\u6d4b\u8bd5\u3002 \u4f7f\u7528Drupal[module_name]\\Tests\u4f5c\u4e3a\u6240\u6709\u6d4b\u8bd5\u7c7b\u7684namespace\u3002 phpUnit\u529f\u80fd\u6d4b\u8bd5\u7684\u6587\u4ef6\u4f4d\u4e8etests/src/Functional\u5185\u3002 simpleTest\u4f4d\u4e8esrs/Tests\u5185\u3002 \u4e0b\u9762\u662f\u4e00\u4e2asimpleTest: src/Tests/TestExampleUserTest.php <?php /** * @file * * Contains \\Drupal\\test_example\\Tests\\TestExampleUserTest. */ namespace Drupal\\test_example\\Tests ; use Drupal\\simpletest\\WebTestBase ; /** * Check if our user field works. * * @group test_example */ class TestExampleUserTest extends WebTestBase { /** * @var \\Drupal\\user\\Entity\\User. */ protected $user ; /** * Enabled modules */ public static $modules = [ 'test_example' ]; /** * {@inheritdoc} */ function setUp () { parent :: setUp (); $this -> user = $this -> drupalCreateUser (); } /** * Test that the user has a test_status field. */ public function testUserHasTestStatusField () { $this -> assertTrue ( in_array ( 'test_status' , array_keys ( $this -> user -> getFieldDefinitions ()))); } } Drupal8\u7684\u6838\u5fc3\u6a21\u5757\u6709\u5f88\u591a\u6d4b\u8bd5\u7528\u4f8b\u3002\u6709\u60f3\u5b66\u4e60\u7684\u53ef\u4ee5\u591a\u770b\u770b\u3002","title":"\"Drupal8\u529f\u80fd\u6d4b\u8bd5\""},{"location":"drupal/drupal8/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/#phpunitsimpletestbrowsertestbase-webtestbase","text":"\u4ee5\u540e\u7684\u529f\u80fd\u6d4b\u8bd5\u90fd\u662f\u4f7f\u7528phpUnit\u548cBrowserTestBase\uff0cDrupal8\u4e2d\u5f88\u591a\u6a21\u5757\u8fd8\u5728\u7528WebTestBase. BrowserTestBase\u7684\u4e3b\u8981\u9650\u5236\u662f\u4e0d\u80fd\u4f7f\u7528JavaScript\u548cAJAX\u3002 \u5982\u679c\u9700\u8981\u6d4b\u8bd5\u5b83\u4eec\uff0c\u5efa\u8bae\u5148\u7528WebTestBase\u3002","title":"\u4e00\u3001PHPUnit\u548cSimpleTest\u529f\u80fd\u6d4b\u8bd5(BrowserTestBase / WebTestBase)"},{"location":"drupal/drupal8/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/#1","text":"vim config/install/field.field.user.user.test_status.yml \u7f16\u8f91\u6587\u4ef6\u5185\u5bb9\u4e3a\uff1a langcode: en status: true dependencies: config: - field.storage.user.test_status id: user.user.test_status field_name: test_status entity_type: user bundle: user label: test_status description: '' required: false translatable: false default_value: - value: 0 default_value_callback: '' settings: on_label: 'On' off_label: 'Off' field_type: boolean vim config/install/field.storage.user.test_status.yml \u7f16\u8f91\u5185\u5bb9\u4e3a\uff1a langcode: en status: true dependencies: module: - user id: user.test_status field_name: test_status entity_type: user type: boolean settings: { } module: test_example locked: false cardinality: 1 translatable: true indexes: { } persist_with_no_fields: false","title":"1\u3001\u5b9a\u4e49\u5b57\u6bb5"},{"location":"drupal/drupal8/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/#2","text":"\u5fc5\u987b\u5728tests/src/Functional/\u5185\u521b\u5efa\u4e00\u4e2a\u4ee5 Test.php \u7ed3\u5c3e\u7684\u6587\u4ef6\u3002 \u521b\u5efa\u4e00\u4e2a\u7ee7\u627f BrowserTestBase \u7684\u7c7b\u521b\u5efa\u6d4b\u8bd5\u3002 \u6211\u4eec\u4e5f\u4f7f\u7528 Drupal\\Tests[module_name]\\Functional \u4f5c\u4e3a\u6240\u6709\u6d4b\u8bd5\u7c7b\u7684namespace\u3002 \u7f16\u8f91src/Functional/TestExampleUserTest.php <?php /** * @file * * Contains \\Drupal\\Tests\\test_example\\Functional\\TestExampleUserTest. */ namespace Drupal\\Tests\\test_example\\Functional ; use Drupal\\simpletest\\BrowserTestBase ; /** * Check if our user field works. * * @group test_example * @runTestsInSeparateProcesses * @preserveGlobalState disabled */ class TestExampleUserTest extends BrowserTestBase { /** * @var \\Drupal\\user\\Entity\\User. */ protected $user ; /** * Enabled modules */ public static $modules = [ 'test_example' ]; /** * {@inheritdoc} */ function setUp () { parent :: setUp (); $this -> user = $this -> drupalCreateUser (); } /** * Test that the user has a test_status field. */ public function testUserHasTestStatusField () { $this -> assertTrue ( in_array ( 'test_status' , array_keys ( $this -> user -> getFieldDefinitions ()))); } } \u6ce8\u89e3 \u6240\u6709\u4f7f\u7528PhpUnit\u7684\u529f\u80fd\u6d4b\u8bd5\u5fc5\u987b\u8981\u6709\u4e24\u4e2a\u6ce8\u89e3\uff0c @runTestsInSeparateProcesses \u548c @preserveGlobalState disabled\u3002 \u6fc0\u6d3b\u6a21\u5757 \u56e0\u4e3a\u529f\u80fd\u6d4b\u8bd5\u8fd0\u884c\u5728\u6ca1\u6709\u5b8c\u5168\u6784\u5efa\u7684Drupal\u7cfb\u7edf\u5185\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u6fc0\u6d3b\u9700\u6d4b\u8bd5\u7684\u6a21\u5757\u3002 setUp \u5fc5\u987b\u8c03\u7528parent::setUp\u65b9\u6cd5\uff0c\u5728\u8fd9\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u91cc\uff0c\u6211\u4eec\u8c03\u7528\u4e86drupalCreateUser\u65b9\u6cd5\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u8bbf\u95ee\u5230\u7528\u6237\u5b9e\u4f53\u3002 \u6d4b\u8bd5\u65b9\u6cd5 \u548c\u5355\u5143\u6d4b\u8bd5\u4e00\u6837\uff0c\u65b9\u6cd5\u5fc5\u987b\u4ee5test\u5f00\u5934\u3002 \u65ad\u8a00\u8bed\u53e5 \u548c\u5355\u5143\u6d4b\u8bd5\u4e00\u6837\u3002\u5728\u4e0a\u9762\u8fd9\u4e2a\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6211\u4eec\u68c0\u67e5\u7528\u6237\u5b9e\u4f53\u91cc\u662f\u5426\u5b58\u5728test_status\u8fd9\u4e2a\u5b57\u6bb5\u3002","title":"2\u3001\u521b\u5efa\u529f\u80fd\u6d4b\u8bd5"},{"location":"drupal/drupal8/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/#3","text":"\u9996\u5148\u8bbe\u7f6e\u4e00\u4e0bphpstrom * \u6253\u5f00 PhpStorm * \u5728 Command Line \u90e8\u5206\uff0c\u7f16\u8f91 Environment \u53d8\u91cf\u3002 * \u8bbe\u7f6eSIMPLETEST_BASE_URL \u548c\u503c\uff08\u7ad9\u70b9URL)\u3002","title":"3\u3001\u6267\u884c\u529f\u80fd\u6d4b\u8bd5"},{"location":"drupal/drupal8/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/#ajax-simpletest","text":"phpUnit\u548csimpleTest\u7684\u4e3b\u8981\u533a\u522b\u662f\uff1a \u6587\u4ef6\u547d\u540d\u548c\u540d\u5b57\u7a7a\u95f4 \u8981\u521b\u5efaSimpleTest\u529f\u80fd\u6d4b\u8bd5\uff0c\u4f60\u5fc5\u987b\u5728src/Tests/\u5185\u521b\u5efa\u4e00\u4e2a\u4ee5Test.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u3002 \u4e00\u822c\u901a\u8fc7\u7ee7\u627f\u57fa\u7c7bWebTestBase\u6216KernelTestBase\u521b\u5efa\u6d4b\u8bd5\u3002 \u4f7f\u7528Drupal[module_name]\\Tests\u4f5c\u4e3a\u6240\u6709\u6d4b\u8bd5\u7c7b\u7684namespace\u3002 phpUnit\u529f\u80fd\u6d4b\u8bd5\u7684\u6587\u4ef6\u4f4d\u4e8etests/src/Functional\u5185\u3002 simpleTest\u4f4d\u4e8esrs/Tests\u5185\u3002 \u4e0b\u9762\u662f\u4e00\u4e2asimpleTest: src/Tests/TestExampleUserTest.php <?php /** * @file * * Contains \\Drupal\\test_example\\Tests\\TestExampleUserTest. */ namespace Drupal\\test_example\\Tests ; use Drupal\\simpletest\\WebTestBase ; /** * Check if our user field works. * * @group test_example */ class TestExampleUserTest extends WebTestBase { /** * @var \\Drupal\\user\\Entity\\User. */ protected $user ; /** * Enabled modules */ public static $modules = [ 'test_example' ]; /** * {@inheritdoc} */ function setUp () { parent :: setUp (); $this -> user = $this -> drupalCreateUser (); } /** * Test that the user has a test_status field. */ public function testUserHasTestStatusField () { $this -> assertTrue ( in_array ( 'test_status' , array_keys ( $this -> user -> getFieldDefinitions ()))); } } Drupal8\u7684\u6838\u5fc3\u6a21\u5757\u6709\u5f88\u591a\u6d4b\u8bd5\u7528\u4f8b\u3002\u6709\u60f3\u5b66\u4e60\u7684\u53ef\u4ee5\u591a\u770b\u770b\u3002","title":"\u4e8c\u3001Ajax\u529f\u80fd\u6d4b\u8bd5-SimpleTest"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/","tags":"[\u6d4b\u8bd5]","text":"\u5355\u5143\u6d4b\u8bd5\u5728\u7f16\u7a0b\u4e2d\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u800c\u6211\u66f4\u503e\u5411\u4e8e\u53bb\u5bf9\u90a3\u4e9b\u6709\u610f\u4e49\u7684\u9519\u8bef\u505a\u6d4b\u8bd5\u3002 \u5728Drupal8\u4e2d\uff0c\u53ef\u4ee5\u501f\u52a9phpstorm\u6765\u5e2e\u52a9\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\u3002 \u4e00\u3001phpstorm\u914d\u7f6e \u00b6 1\uff09\u3001\u9488\u5bf9\u9879\u76ee\u8fdb\u884c\u8bbe\u7f6e\uff1a \u00b6 1\u3001\u9009\u4e2d PhpStorm > Preferences > Languages & Frameworks > PHP > PHPUnit > Local Window \u64cd\u4f5c\u7cfb\u7edf\u662f\uff1aFile > Settings \u2026 2\u3001\u9009\u62e9 PHPUnit Library > Use custom autoloader 3\u3001\u5bfc\u822a\u5230 /vendor/autoload.php 4\u3001\u9009\u62e9 Test Runner > Default configuration file 5\u3001\u5bfc\u822a\u5230 /core/phpunit.xml.dist 6\u3001\u70b9\u51fb Save \u5728\u53f3\u4e0a\u65b9\u770b\u5230 For current project\u3002\u63a5\u4e0b\u6765\u5b8c\u6210\u4e0b\u9762\u7684\u6b65\u9aa4\uff1a 1\u3001\u8fd0\u884c\uff1a Run > Edit Configurations 2\u3001\u70b9\u51fb + \u56fe\u6807\uff0c\u9009\u62e9 PHPUnit 3\u3001\u63d0\u4f9b\u4e00\u4e2a\u540d\u79f0\uff0c\u4f8b\u5982 Drupal 8: All Tests 4\u3001\u5728\u914d\u7f6e\u6587\u4ef6\u5185\u9009\u62e9 Test Runner > Defined 5\u3001\u4fdd\u5b58 \u5728\u53f3\u4e0a\u89d2\uff0c\u9009\u62e9\u4f60\u7684\u8fd0\u884c\u914d\u7f6e\uff0c\u6309\u4e0b\u7eff\u8272\u7bad\u5934\u3002\u4e5f\u53ef\u4ee5\u64cd\u4f5c Run > Run Drupal 8: All Tests \u3002 \u8bf4\u660e\uff1a \u5982\u679c\u63d0\u793a\u201cInterpreter is not specified or invalid\u201d\uff0c \u8981\u53bb PhpStorm > Preferences > Languages & Frameworks > PHP \u8bbe\u7f6e\u4e0b PHP \u89e3\u91ca\u5668\u3002 \u5f53\u4f60\u8fd0\u884c\u6d4b\u8bd5\u65f6\uff0c\u4f60\u4f1a\u5728 PhpStorm \u5185\u770b\u5230\u4e00\u4e2a\u65b0\u7a97\u53e3\uff0c\u5217\u51fa\u4e86\u6d4b\u8bd5\u7ed3\u679c\u3002\u9ed8\u8ba4\u60c5\u51b5\uff0c\u901a\u8fc7\u7684\u6d4b\u8bd5\u4e0d\u4f1a\u663e\u793a\u51fa\u6765\u3002\u4f60\u53ef\u4ee5\u64cd\u4f5c\u7a97\u53e3\u5de6\u4e0a\u89d2\u7684 Hide passed \u56fe\u6807\u663e\u793a\u901a\u8fc7\u7684\u6d4b\u8bd5\u3002 2)\u3001\u6d4b\u8bd5\u4e00\u4e2a\u6307\u5b9a\u533a\u57df \u00b6 PHPUnit \u5c06\u8fd0\u884c\u5f88\u591a\u6d4b\u8bd5\u3002\u8981\u628a\u6d4b\u8bd5\u533a\u57df\u9650\u5236\u4e3a\u4e00\u4e2a\u6587\u4ef6\u5939\uff08\u6211\u4eec\u7684\u6a21\u5757\uff09\u53ef\u4ee5\u8c61\u4e0b\u9762\u8fd9\u6837\u505a\uff1a 1\u3001\u8fd0\u884c\uff1a Run > Edit Configurations 2\u3001\u70b9\u51fb + \u56fe\u6807\u9009\u62e9 PHPUnit 3\u3001\u63d0\u4f9b\u4e2a\u540d\u79f0\uff0c\u4f8b\u5982 Drupal 8: Test Example 4\u3001\u9009\u62e9 Test Runner > Test Scope > Directory 5\u3001\u6d4f\u89c8 test_example \u6a21\u5757 6\u3001\u70b9\u51fb Save \u4e8c\u3001\u6dfb\u52a0\u5355\u5143\u6d4b\u8bd5 \u00b6 \u8981\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\uff0c\u5fc5\u987b\u5728[module_name]/tests/srs/Unit/\u4e0b\u521b\u5efa\u4e00\u4e2a\u4ee5Test.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u3002\u4e00\u822c\u90fd\u662f\u7ee7\u627fUnitTestCase\u8fd9\u4e2a\u7c7b\u6765\u521b\u5efa\u6d4b\u8bd5\uff0c\u8fd9\u4e2a\u6d4b\u8bd5\u7c7b\u7684namespace\u5fc5\u987b\u4e3aDrupal\\Test[module_name]\\Unit\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u4e66\u5199\u4ee3\u7801\u3002 vim tests/src/Unit/TestExampleConversionsTest.php <?php /** * @file * * Contains \\Drupal\\Tests\\test_example\\Unit\\TestExampleConversionsTest. */ namespace Drupal\\Tests\\test_example\\Unit ; use Drupal\\Tests\\UnitTestCase ; /** * Demonstrates how to write tests. * * @group test_example */ class TestExampleConversionsTest extends UnitTestCase { /** * {@inheritdoc} */ public function setUp () { parent :: setUp (); } /** * Convert Celsius to Fahrenheit * * @param $temp * * @return int */ public function celsiusToFahrenheit ( $temp ) { return ( $temp * ( 9 / 5 )) + 32 ; } /** * Convert centimeter to inches. * * @param $length * * @return int */ public function centimeterToInch ( $length ) { return $length / 2.54 ; } /** * A simple test that tests our celsiusToFahrenheit() function. */ public function testOneConversion () { // Confirm that 0C = 31F. $this -> assertEquals ( 31 , $this -> celsiusToFahrenheit ( 0 )); } } \u6d4b\u8bd5\u65b9\u6cd5 \u6bcf\u4e2a\u6d4b\u8bd5\u65b9\u6cd5\u5fc5\u987b\u4ee5test\u5f00\u5934\u3002 \u65ad\u8a00 \u65ad\u8a00\u51b3\u5b9a\u6d4b\u8bd5\u662f\u5426\u901a\u8fc7\uff0c\u6bd4\u8f83\u5e38\u7528\u7684\u4e00\u4e9b\u65ad\u8a00\u51fd\u6570\u5982assertTrue\u3001assertFalse\u3001assertEquals\u7b49\u3002 \u6587\u6863\u89c1 https://phpunit.de/manual/current/zh_cn/appendixes.assertions.html setUp() \u6bcf\u6b21\u6d4b\u8bd5\u4e4b\u524d\u90fd\u4f1a\u6267\u884csetUp\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u53d8\u6210\u6216\u5b9e\u4f8b\u3002 \u4e09\u3001\u6267\u884c\u5355\u5143\u6d4b\u8bd5 \u00b6 \u8f93\u51fa\u5982\u4e0b\uff1a Failed asserting that 32 .0 matches expected 31 . Expected :31 Actual :32 \u56db\u3001\u8f83\u590d\u6742\u7684\u5355\u5143\u6d4b\u8bd5 \u00b6 \u5982\u679c\u8981\u505a\u6bd4\u8f83\u590d\u6742\u7684\u5355\u5143\u6d4b\u8bd5\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u529e\u6cd5\u662f\u7528setUp\u65b9\u6cd5\uff0c\u53e6\u4e00\u4e2a\u65b9\u6848\u5c31\u662f\u4f7f\u7528data provider. 1)\u3001data provider \u00b6 PHPUnit\u4e2d\u7684data provider\u662f\u4e3a\u6d4b\u8bd5\u65b9\u6cd5\u63d0\u4f9b\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6570\u7ec4\u3002 \u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2adata provider\u53eb providerCentimetersToInches\u3002 /** * Provides data for the testCentimetersToInches method. * * @return array */ public function providerCentimetersToInches() { return [ [2.545,1], [254,100], [0,0], [-2.54,-1], ]; } /** * Tests centimetersToInches method. * * @dataProvider providerCentimetersToInches */ public function testCentimetersToInches($length, $expectedValue) { $this->assertEquals($expectedValue, $this->centimeterToInch($length)); } Data Provider\u6ce8\u89e3 \u5728\u6d4b\u8bd5\u65b9\u6cd5\u4e0a\u4f7f\u7528 @dataProvider \u6ce8\u89e3\u6765\u8fde\u63a5\u8fd9\u4e2adata provider\u3002 Data Provider\u53c2\u6570 \u5728\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u53ef\u4ee5\u6dfb\u52a0\u53c2\u6570\uff0c\u5728\u4e0a\u9762\u7684\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u5728\u6570\u7ec4\u5185\u4f20\u9012\u4e86\u4e24\u4e2a\u503c\uff0c\u90a3\u4e48\u5728\u4e0a\u9762\u7684\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u6709\u4e24\u4e2a\u5bf9\u5e94\u7684\u53c2\u6570\u3002 \u6267\u884crun\uff0c\u7ed3\u679c\u5982\u4e0b Failed asserting that 1 .0019685039370079 matches expected 1 . Expected :1 Actual :1.001968503937","title":"\"Drupal8\u5355\u5143\u6d4b\u8bd5\""},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#phpstorm","text":"","title":"\u4e00\u3001phpstorm\u914d\u7f6e"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1","text":"1\u3001\u9009\u4e2d PhpStorm > Preferences > Languages & Frameworks > PHP > PHPUnit > Local Window \u64cd\u4f5c\u7cfb\u7edf\u662f\uff1aFile > Settings \u2026 2\u3001\u9009\u62e9 PHPUnit Library > Use custom autoloader 3\u3001\u5bfc\u822a\u5230 /vendor/autoload.php 4\u3001\u9009\u62e9 Test Runner > Default configuration file 5\u3001\u5bfc\u822a\u5230 /core/phpunit.xml.dist 6\u3001\u70b9\u51fb Save \u5728\u53f3\u4e0a\u65b9\u770b\u5230 For current project\u3002\u63a5\u4e0b\u6765\u5b8c\u6210\u4e0b\u9762\u7684\u6b65\u9aa4\uff1a 1\u3001\u8fd0\u884c\uff1a Run > Edit Configurations 2\u3001\u70b9\u51fb + \u56fe\u6807\uff0c\u9009\u62e9 PHPUnit 3\u3001\u63d0\u4f9b\u4e00\u4e2a\u540d\u79f0\uff0c\u4f8b\u5982 Drupal 8: All Tests 4\u3001\u5728\u914d\u7f6e\u6587\u4ef6\u5185\u9009\u62e9 Test Runner > Defined 5\u3001\u4fdd\u5b58 \u5728\u53f3\u4e0a\u89d2\uff0c\u9009\u62e9\u4f60\u7684\u8fd0\u884c\u914d\u7f6e\uff0c\u6309\u4e0b\u7eff\u8272\u7bad\u5934\u3002\u4e5f\u53ef\u4ee5\u64cd\u4f5c Run > Run Drupal 8: All Tests \u3002 \u8bf4\u660e\uff1a \u5982\u679c\u63d0\u793a\u201cInterpreter is not specified or invalid\u201d\uff0c \u8981\u53bb PhpStorm > Preferences > Languages & Frameworks > PHP \u8bbe\u7f6e\u4e0b PHP \u89e3\u91ca\u5668\u3002 \u5f53\u4f60\u8fd0\u884c\u6d4b\u8bd5\u65f6\uff0c\u4f60\u4f1a\u5728 PhpStorm \u5185\u770b\u5230\u4e00\u4e2a\u65b0\u7a97\u53e3\uff0c\u5217\u51fa\u4e86\u6d4b\u8bd5\u7ed3\u679c\u3002\u9ed8\u8ba4\u60c5\u51b5\uff0c\u901a\u8fc7\u7684\u6d4b\u8bd5\u4e0d\u4f1a\u663e\u793a\u51fa\u6765\u3002\u4f60\u53ef\u4ee5\u64cd\u4f5c\u7a97\u53e3\u5de6\u4e0a\u89d2\u7684 Hide passed \u56fe\u6807\u663e\u793a\u901a\u8fc7\u7684\u6d4b\u8bd5\u3002","title":"1\uff09\u3001\u9488\u5bf9\u9879\u76ee\u8fdb\u884c\u8bbe\u7f6e\uff1a"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2","text":"PHPUnit \u5c06\u8fd0\u884c\u5f88\u591a\u6d4b\u8bd5\u3002\u8981\u628a\u6d4b\u8bd5\u533a\u57df\u9650\u5236\u4e3a\u4e00\u4e2a\u6587\u4ef6\u5939\uff08\u6211\u4eec\u7684\u6a21\u5757\uff09\u53ef\u4ee5\u8c61\u4e0b\u9762\u8fd9\u6837\u505a\uff1a 1\u3001\u8fd0\u884c\uff1a Run > Edit Configurations 2\u3001\u70b9\u51fb + \u56fe\u6807\u9009\u62e9 PHPUnit 3\u3001\u63d0\u4f9b\u4e2a\u540d\u79f0\uff0c\u4f8b\u5982 Drupal 8: Test Example 4\u3001\u9009\u62e9 Test Runner > Test Scope > Directory 5\u3001\u6d4f\u89c8 test_example \u6a21\u5757 6\u3001\u70b9\u51fb Save","title":"2)\u3001\u6d4b\u8bd5\u4e00\u4e2a\u6307\u5b9a\u533a\u57df"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#_1","text":"\u8981\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\uff0c\u5fc5\u987b\u5728[module_name]/tests/srs/Unit/\u4e0b\u521b\u5efa\u4e00\u4e2a\u4ee5Test.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u3002\u4e00\u822c\u90fd\u662f\u7ee7\u627fUnitTestCase\u8fd9\u4e2a\u7c7b\u6765\u521b\u5efa\u6d4b\u8bd5\uff0c\u8fd9\u4e2a\u6d4b\u8bd5\u7c7b\u7684namespace\u5fc5\u987b\u4e3aDrupal\\Test[module_name]\\Unit\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u4e66\u5199\u4ee3\u7801\u3002 vim tests/src/Unit/TestExampleConversionsTest.php <?php /** * @file * * Contains \\Drupal\\Tests\\test_example\\Unit\\TestExampleConversionsTest. */ namespace Drupal\\Tests\\test_example\\Unit ; use Drupal\\Tests\\UnitTestCase ; /** * Demonstrates how to write tests. * * @group test_example */ class TestExampleConversionsTest extends UnitTestCase { /** * {@inheritdoc} */ public function setUp () { parent :: setUp (); } /** * Convert Celsius to Fahrenheit * * @param $temp * * @return int */ public function celsiusToFahrenheit ( $temp ) { return ( $temp * ( 9 / 5 )) + 32 ; } /** * Convert centimeter to inches. * * @param $length * * @return int */ public function centimeterToInch ( $length ) { return $length / 2.54 ; } /** * A simple test that tests our celsiusToFahrenheit() function. */ public function testOneConversion () { // Confirm that 0C = 31F. $this -> assertEquals ( 31 , $this -> celsiusToFahrenheit ( 0 )); } } \u6d4b\u8bd5\u65b9\u6cd5 \u6bcf\u4e2a\u6d4b\u8bd5\u65b9\u6cd5\u5fc5\u987b\u4ee5test\u5f00\u5934\u3002 \u65ad\u8a00 \u65ad\u8a00\u51b3\u5b9a\u6d4b\u8bd5\u662f\u5426\u901a\u8fc7\uff0c\u6bd4\u8f83\u5e38\u7528\u7684\u4e00\u4e9b\u65ad\u8a00\u51fd\u6570\u5982assertTrue\u3001assertFalse\u3001assertEquals\u7b49\u3002 \u6587\u6863\u89c1 https://phpunit.de/manual/current/zh_cn/appendixes.assertions.html setUp() \u6bcf\u6b21\u6d4b\u8bd5\u4e4b\u524d\u90fd\u4f1a\u6267\u884csetUp\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u53d8\u6210\u6216\u5b9e\u4f8b\u3002","title":"\u4e8c\u3001\u6dfb\u52a0\u5355\u5143\u6d4b\u8bd5"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#_2","text":"\u8f93\u51fa\u5982\u4e0b\uff1a Failed asserting that 32 .0 matches expected 31 . Expected :31 Actual :32","title":"\u4e09\u3001\u6267\u884c\u5355\u5143\u6d4b\u8bd5"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#_3","text":"\u5982\u679c\u8981\u505a\u6bd4\u8f83\u590d\u6742\u7684\u5355\u5143\u6d4b\u8bd5\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u529e\u6cd5\u662f\u7528setUp\u65b9\u6cd5\uff0c\u53e6\u4e00\u4e2a\u65b9\u6848\u5c31\u662f\u4f7f\u7528data provider.","title":"\u56db\u3001\u8f83\u590d\u6742\u7684\u5355\u5143\u6d4b\u8bd5"},{"location":"drupal/drupal8/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1data-provider","text":"PHPUnit\u4e2d\u7684data provider\u662f\u4e3a\u6d4b\u8bd5\u65b9\u6cd5\u63d0\u4f9b\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6570\u7ec4\u3002 \u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2adata provider\u53eb providerCentimetersToInches\u3002 /** * Provides data for the testCentimetersToInches method. * * @return array */ public function providerCentimetersToInches() { return [ [2.545,1], [254,100], [0,0], [-2.54,-1], ]; } /** * Tests centimetersToInches method. * * @dataProvider providerCentimetersToInches */ public function testCentimetersToInches($length, $expectedValue) { $this->assertEquals($expectedValue, $this->centimeterToInch($length)); } Data Provider\u6ce8\u89e3 \u5728\u6d4b\u8bd5\u65b9\u6cd5\u4e0a\u4f7f\u7528 @dataProvider \u6ce8\u89e3\u6765\u8fde\u63a5\u8fd9\u4e2adata provider\u3002 Data Provider\u53c2\u6570 \u5728\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u53ef\u4ee5\u6dfb\u52a0\u53c2\u6570\uff0c\u5728\u4e0a\u9762\u7684\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u5728\u6570\u7ec4\u5185\u4f20\u9012\u4e86\u4e24\u4e2a\u503c\uff0c\u90a3\u4e48\u5728\u4e0a\u9762\u7684\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u6709\u4e24\u4e2a\u5bf9\u5e94\u7684\u53c2\u6570\u3002 \u6267\u884crun\uff0c\u7ed3\u679c\u5982\u4e0b Failed asserting that 1 .0019685039370079 matches expected 1 . Expected :1 Actual :1.001968503937","title":"1)\u3001data provider"},{"location":"drupal/drupal8/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/","tags":"[namespace]","text":"\u547d\u540d\u7a7a\u95f4\u662fphp5.3\u5f15\u8fdb\u7684\u6982\u5ff5\uff0c\u8fd9\u8fb9\u6587\u7ae0\u4e3b\u8981\u4ecb\u7ecd\u5728Drupal\u4e2d\u5982\u4f55\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u679c\u4f60\u5bf9\u547d\u540d\u7a7a\u95f4\u8fd8\u4e0d\u719f\u6089\uff0c\u8bf7\u79fb\u6b65\u5230 \u8fd9\u91cc \u5b66\u4e60\uff0c\u8fd9\u7bc7\u6587\u7ae0 article introducing namespaces \u4e5f\u8bb2\u7684\u4e0d\u9519\u3002 \u5728Drupal\u4e2d\uff0c\u5e76\u4e0d\u662f\u6bcf\u4e00\u4e2a\u6587\u4ef6\u90fd\u9700\u8981\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u3002Drupal8\u4e4b\u524d\u4e3a\u4e86\u8ddfphp5.2\u4fdd\u6301\u517c\u5bb9\uff0c\u4ece\u672a\u7528\u8fc7\u547d\u540d\u7a7a\u95f4\u3002Drupal8\u9650\u5b9a\u4e86php\u7248\u672c\u5fc5\u987b\u662f5.5\u4ee5\u4e0a\uff0cSo\uff0c\u8ba9\u6211\u4eec\u5c3d\u60c5\u7684\u4eab\u53d7OOP\u7684\u4e50\u8da3\u5427\uff01 \u7528\"use\"\u5bfc\u5165\u7c7b \u00b6 \u5728\u8bbf\u95ee\u7cfb\u7edf\u5185\u90e8\u6216\u5305\u542b\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7c7b\u540d\u79f0\u65f6\uff0c\u53ef\u4ee5\u4e0d\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u3002\u547d\u540d\u7a7a\u95f4\u548cuse\u5173\u952e\u5b57\u7684\u58f0\u660e\u5fc5\u987b\u653e\u5728\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u5e76\u4e14\u4ee5\u53cd\u659c\u6760\\\u505a\u4e3a\u5206\u9694\u7b26\u3002\u5982 <?php namespace Drupal\\mymodule\\Tests\\Foo ; use Drupal\\simpletest\\WebTestBase ; /** * Tests that the foo bars. */ class BarTest extends WebTestBase { // WebTestBase\u524d\u4e0d\u9700\u8981\u52a0\\ } ?> \u5728\u8bbf\u95ee\u7cfb\u7edf\u5185\u90e8\u6216\u4e0d\u5305\u542b\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7c7b\u540d\u79f0\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u3002\u5982 new \\Exception(); \u5728\u4e00\u4e2a\u6ca1\u6709\u58f0\u660e\u547d\u540d\u7a7a\u95f4\u7684\u6587\u4ef6\u91cc\uff0c\u5c31\u7b97\u5b83\u662f\u5168\u5c40\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u679c\u8981\u4f7f\u7528\u5176\u4ed6\u975e\u5168\u5c40\u547d\u540d\u7a7a\u95f4\u7684\u7c7b\uff0c\u5fc5\u987b\u4f7f\u7528\"use\"\u5173\u952e\u5b57\uff0c\u5e76\u4e14\u9700\u8981\u58f0\u660e\u5728\u6587\u4ef6\u7684\u5f00\u5934\u54e6\uff01 \u5f53\u7528\"use\"\u5bfc\u5165\u7c7b\u65f6\uff0c\u4e0d\u8981\u5728\u5f00\u5934\u52a0\\\u3002\u5927PHP\u5b98\u65b9\u4e5f\u662f\u8fd9\u4e48\u63a8\u8350\u7684\uff0c\u89c1 PHP documentation \u5f53\u5728\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7c7b\u540d\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u5e26\u547d\u540d\u7a7a\u95f4\u7684\u5168\u7c7b\u540d\uff0c\u5e76\u4e14\u4e0d\u80fd\u4ee5\\\u5f00\u5934\u3002 \u5982\u679c\u8981\u5728\u53cc\u5f15\u53f7\u4e2d\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\uff0c\u5fc5\u987b\u8f6c\u4e49\uff0c\u5982\uff1a \"Drupal\\\\Content\\\\ContentInterface\" \u5728\u5355\u5f15\u53f7\u4e2d\u5c31\u4e0d\u9700\u8981\u8f6c\u4e49\u4e86\uff0c\u5982\uff1a 'Drupal\\Context\\ContextInterface' \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u63a8\u8350\u4f7f\u7528\u5355\u5f15\u53f7\u7684\u5199\u6cd5\uff01 \u4e00\u4e2a\"use\"\u53ea\u80fd\u58f0\u660e\u4e00\u4e2a\u7c7b\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\"use\"\u5bfc\u5165\u591a\u4e2a\u7c7b.\u5982\u8fd9\u79cd\u5199\u6cd5\u5c31\u662f\u4e0d\u63a8\u8350\u7684 use My\\Full\\Classname, My\\Full\\NSname; \u800c\u8fd9\u79cd\u5199\u6cd5\u662f\u63a8\u8350\u7684 use My\\Full\\Classname; \u5728.api.php\u8fd9\u79cdAPI\u6587\u4ef6\u4e2d\u5fc5\u987b\u4f7f\u7528\u7c7b\u7684\u5168\u540d\uff0c\u8fd9\u6837\u522b\u4eba\u8981\u60f3hook\u4f60\u7684\u7c7b\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\"use\"\u5bfc\u5165\u4e86\u3002\u5982 \u5b9a\u4e49Drupal\\Subsystem\\Foo <?php /** * @file * Contains \\Drupal\\Subsystem\\Foo. */ namespace Drupal\\Subsystem ; // This imports just the Cat class from the Drupal\\Othersystem namespace. use Drupal\\Othersystem\\Cat ; // Bar is a class in the Drupal\\Subsystem namespace in another file. // It is already available without any importing. /** * Defines a Foo. */ class Foo { /** * Constructs a new Foo object. */ public function __construct ( Bar $b , Cat $c ) { // Global classes must be prefixed with a \\ character. $d = new \\DateTime (); } } ?> hook Drupal\\Subsystem\\Foo <?php /** * @file * The Example module. * * This file is not part of any namespace, so all global namespaced classes * are automatically available. */ use Drupal\\Subsystem\\Foo ; /** * Does stuff with Foo stuff. * * @param \\Drupal\\Subsystem\\Foo $f * A Foo object used to bar the baz. */ function do_stuff ( Foo $f ) { // The DateTime class does not need to be imported as it is already global $d = new DateTime (); } ?> \u7c7b\u7684\u522b\u540d \u00b6 php\u5141\u8bb8\u5bfc\u5165\u7c7b\u7684\u65f6\u5019\u4f7f\u7528\u522b\u540d\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u53ef\u6076\u7684\u91cd\u540d\uff01\u4e00\u65e6\u4e24\u4e2a\u7c7b\u91cd\u540d\u4e86\uff0c\u53ef\u4ee5\u5c06\u5404\u81ea\u547d\u540d\u7a7a\u95f4\u91cc\u7684\u4e0a\u4e00\u7ea7\u7684\u540d\u5b57\u62ff\u51fa\u6765\u4f5c\u4e3a\u76f8\u5e94\u7684\u524d\u7f00\u3002 \u5982\uff1a <?php use Foo\\Bar\\Baz as BarBaz ; use Stuff\\Thing\\Baz as ThingBaz ; /** * Tests stuff for the whichever. */ function test () { $a = new BarBaz (); // This will be Foo\\Bar\\Baz $b = new ThingBaz (); // This will be Stuff\\Thing\\Baz } ?> \u5bfc\u5165\u7684\u987a\u5e8f \u00b6 \u5982\u679c\u8981\u5bfc\u5165\u591a\u4e2a\u7c7b\uff0cDrupal8\u5e76\u6ca1\u6709\u9650\u5236\u5bfc\u5165\u7684\u987a\u5e8f\u3002\u5982\uff1a <?php namespace Drupal\\block ; use Drupal\\Core\\Entity\\EntityForm ; use Drupal\\Core\\Entity\\EntityManagerInterface ; use Drupal\\Core\\Form\\FormState ; use Drupal\\Core\\Form\\FormStateInterface ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; ?> \u6a21\u5757 \u00b6 \u6a21\u5757\u4e2d\u7684\u7c7b\u5fc5\u987b\u7533\u660e\u4e3a\u7279\u5b9a\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u6a21\u5757\u540d\u4e3aexample_module\u3002 namespace Drupal\\example_module \u8981\u5728Drupal8\u4e2d\u81ea\u52a8\u52a0\u8f7d(autoload)\uff0c\u8fd8\u8981\u8fd9\u4e9b\u7c7b\u5f52\u7f6e\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u4e00\u822c\u7ea6\u5b9a\u5728 modules/example_module/src \u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5982\uff1a NO.1 // \u58f0\u660e\u547d\u540d\u7a7a\u95f4 namespace Drupal\\example_module // \u521b\u5efa\u7c7b class Foo {} \u8fd9\u4e2a\u5bf9\u5e94\u7684\u6587\u4ef6\u5c31\u662fexample_module/src/Foo.php\u3002 NO.2 // \u58f0\u660e\u547d\u540d\u7a7a\u95f4 namespace Drupal\\example_module\\Foo // \u521b\u5efa\u7c7b class Bar {} \u8fd9\u4e2a\u5bf9\u5e94\u7684\u6587\u4ef6\u5c31\u662fexample_module/src/Foo/Bar.php\u3002 \u4ee5\u4e0a\uff0c\u5c31\u662f\u5bf9Drupal8\u7684\u547d\u540d\u7a7a\u95f4\u505a\u7b80\u5355\u7684\u68b3\u7406\u548c\u4ecb\u7ecd\u3002\u6b22\u8fce\u62cd\u7816\u4ea4\u6d41\uff01 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/1353118 2\u3001 https://www.drupal.org/node/2156625","title":"\"Drupal8\u547d\u540d\u7a7a\u95f4(Namespace)\""},{"location":"drupal/drupal8/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/#use","text":"\u5728\u8bbf\u95ee\u7cfb\u7edf\u5185\u90e8\u6216\u5305\u542b\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7c7b\u540d\u79f0\u65f6\uff0c\u53ef\u4ee5\u4e0d\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u3002\u547d\u540d\u7a7a\u95f4\u548cuse\u5173\u952e\u5b57\u7684\u58f0\u660e\u5fc5\u987b\u653e\u5728\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u5e76\u4e14\u4ee5\u53cd\u659c\u6760\\\u505a\u4e3a\u5206\u9694\u7b26\u3002\u5982 <?php namespace Drupal\\mymodule\\Tests\\Foo ; use Drupal\\simpletest\\WebTestBase ; /** * Tests that the foo bars. */ class BarTest extends WebTestBase { // WebTestBase\u524d\u4e0d\u9700\u8981\u52a0\\ } ?> \u5728\u8bbf\u95ee\u7cfb\u7edf\u5185\u90e8\u6216\u4e0d\u5305\u542b\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u7c7b\u540d\u79f0\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u3002\u5982 new \\Exception(); \u5728\u4e00\u4e2a\u6ca1\u6709\u58f0\u660e\u547d\u540d\u7a7a\u95f4\u7684\u6587\u4ef6\u91cc\uff0c\u5c31\u7b97\u5b83\u662f\u5168\u5c40\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u679c\u8981\u4f7f\u7528\u5176\u4ed6\u975e\u5168\u5c40\u547d\u540d\u7a7a\u95f4\u7684\u7c7b\uff0c\u5fc5\u987b\u4f7f\u7528\"use\"\u5173\u952e\u5b57\uff0c\u5e76\u4e14\u9700\u8981\u58f0\u660e\u5728\u6587\u4ef6\u7684\u5f00\u5934\u54e6\uff01 \u5f53\u7528\"use\"\u5bfc\u5165\u7c7b\u65f6\uff0c\u4e0d\u8981\u5728\u5f00\u5934\u52a0\\\u3002\u5927PHP\u5b98\u65b9\u4e5f\u662f\u8fd9\u4e48\u63a8\u8350\u7684\uff0c\u89c1 PHP documentation \u5f53\u5728\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7c7b\u540d\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u5e26\u547d\u540d\u7a7a\u95f4\u7684\u5168\u7c7b\u540d\uff0c\u5e76\u4e14\u4e0d\u80fd\u4ee5\\\u5f00\u5934\u3002 \u5982\u679c\u8981\u5728\u53cc\u5f15\u53f7\u4e2d\u4f7f\u7528\u547d\u540d\u7a7a\u95f4\uff0c\u5fc5\u987b\u8f6c\u4e49\uff0c\u5982\uff1a \"Drupal\\\\Content\\\\ContentInterface\" \u5728\u5355\u5f15\u53f7\u4e2d\u5c31\u4e0d\u9700\u8981\u8f6c\u4e49\u4e86\uff0c\u5982\uff1a 'Drupal\\Context\\ContextInterface' \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u63a8\u8350\u4f7f\u7528\u5355\u5f15\u53f7\u7684\u5199\u6cd5\uff01 \u4e00\u4e2a\"use\"\u53ea\u80fd\u58f0\u660e\u4e00\u4e2a\u7c7b\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\"use\"\u5bfc\u5165\u591a\u4e2a\u7c7b.\u5982\u8fd9\u79cd\u5199\u6cd5\u5c31\u662f\u4e0d\u63a8\u8350\u7684 use My\\Full\\Classname, My\\Full\\NSname; \u800c\u8fd9\u79cd\u5199\u6cd5\u662f\u63a8\u8350\u7684 use My\\Full\\Classname; \u5728.api.php\u8fd9\u79cdAPI\u6587\u4ef6\u4e2d\u5fc5\u987b\u4f7f\u7528\u7c7b\u7684\u5168\u540d\uff0c\u8fd9\u6837\u522b\u4eba\u8981\u60f3hook\u4f60\u7684\u7c7b\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\"use\"\u5bfc\u5165\u4e86\u3002\u5982 \u5b9a\u4e49Drupal\\Subsystem\\Foo <?php /** * @file * Contains \\Drupal\\Subsystem\\Foo. */ namespace Drupal\\Subsystem ; // This imports just the Cat class from the Drupal\\Othersystem namespace. use Drupal\\Othersystem\\Cat ; // Bar is a class in the Drupal\\Subsystem namespace in another file. // It is already available without any importing. /** * Defines a Foo. */ class Foo { /** * Constructs a new Foo object. */ public function __construct ( Bar $b , Cat $c ) { // Global classes must be prefixed with a \\ character. $d = new \\DateTime (); } } ?> hook Drupal\\Subsystem\\Foo <?php /** * @file * The Example module. * * This file is not part of any namespace, so all global namespaced classes * are automatically available. */ use Drupal\\Subsystem\\Foo ; /** * Does stuff with Foo stuff. * * @param \\Drupal\\Subsystem\\Foo $f * A Foo object used to bar the baz. */ function do_stuff ( Foo $f ) { // The DateTime class does not need to be imported as it is already global $d = new DateTime (); } ?>","title":"\u7528\"use\"\u5bfc\u5165\u7c7b"},{"location":"drupal/drupal8/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/#_1","text":"php\u5141\u8bb8\u5bfc\u5165\u7c7b\u7684\u65f6\u5019\u4f7f\u7528\u522b\u540d\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u53ef\u6076\u7684\u91cd\u540d\uff01\u4e00\u65e6\u4e24\u4e2a\u7c7b\u91cd\u540d\u4e86\uff0c\u53ef\u4ee5\u5c06\u5404\u81ea\u547d\u540d\u7a7a\u95f4\u91cc\u7684\u4e0a\u4e00\u7ea7\u7684\u540d\u5b57\u62ff\u51fa\u6765\u4f5c\u4e3a\u76f8\u5e94\u7684\u524d\u7f00\u3002 \u5982\uff1a <?php use Foo\\Bar\\Baz as BarBaz ; use Stuff\\Thing\\Baz as ThingBaz ; /** * Tests stuff for the whichever. */ function test () { $a = new BarBaz (); // This will be Foo\\Bar\\Baz $b = new ThingBaz (); // This will be Stuff\\Thing\\Baz } ?>","title":"\u7c7b\u7684\u522b\u540d"},{"location":"drupal/drupal8/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/#_2","text":"\u5982\u679c\u8981\u5bfc\u5165\u591a\u4e2a\u7c7b\uff0cDrupal8\u5e76\u6ca1\u6709\u9650\u5236\u5bfc\u5165\u7684\u987a\u5e8f\u3002\u5982\uff1a <?php namespace Drupal\\block ; use Drupal\\Core\\Entity\\EntityForm ; use Drupal\\Core\\Entity\\EntityManagerInterface ; use Drupal\\Core\\Form\\FormState ; use Drupal\\Core\\Form\\FormStateInterface ; use Symfony\\Component\\DependencyInjection\\ContainerInterface ; ?>","title":"\u5bfc\u5165\u7684\u987a\u5e8f"},{"location":"drupal/drupal8/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/#_3","text":"\u6a21\u5757\u4e2d\u7684\u7c7b\u5fc5\u987b\u7533\u660e\u4e3a\u7279\u5b9a\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u6a21\u5757\u540d\u4e3aexample_module\u3002 namespace Drupal\\example_module \u8981\u5728Drupal8\u4e2d\u81ea\u52a8\u52a0\u8f7d(autoload)\uff0c\u8fd8\u8981\u8fd9\u4e9b\u7c7b\u5f52\u7f6e\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u4e00\u822c\u7ea6\u5b9a\u5728 modules/example_module/src \u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5982\uff1a NO.1 // \u58f0\u660e\u547d\u540d\u7a7a\u95f4 namespace Drupal\\example_module // \u521b\u5efa\u7c7b class Foo {} \u8fd9\u4e2a\u5bf9\u5e94\u7684\u6587\u4ef6\u5c31\u662fexample_module/src/Foo.php\u3002 NO.2 // \u58f0\u660e\u547d\u540d\u7a7a\u95f4 namespace Drupal\\example_module\\Foo // \u521b\u5efa\u7c7b class Bar {} \u8fd9\u4e2a\u5bf9\u5e94\u7684\u6587\u4ef6\u5c31\u662fexample_module/src/Foo/Bar.php\u3002 \u4ee5\u4e0a\uff0c\u5c31\u662f\u5bf9Drupal8\u7684\u547d\u540d\u7a7a\u95f4\u505a\u7b80\u5355\u7684\u68b3\u7406\u548c\u4ecb\u7ecd\u3002\u6b22\u8fce\u62cd\u7816\u4ea4\u6d41\uff01 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/1353118 2\u3001 https://www.drupal.org/node/2156625","title":"\u6a21\u5757"},{"location":"drupal/drupal8/Drupal8%E5%92%8Csymfony2/","tags":"[drupal8]","text":"","title":"\"Drupal8\u548csymfony2\""},{"location":"drupal/drupal8/Drupal8%E5%AE%9E%E4%BD%93-entity/","tags":"[entity]","text":"Drupal \u7684 Entity \u662f\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u6682\u65f6\u628a Entity \u7ffb\u8bd1\u6210\u201c\u5b9e\u4f53\u201d\u5427\u3002\u6b63\u786e\u7684\u7406\u89e3 Entity\uff0c\u6709\u52a9\u4e8e\u7406\u89e3 Drupal \u4fe1\u606f\u7ba1\u7406\u7ed3\u6784\uff0c\u5bf9\u4e8e\u4f7f\u7528 Drupal \u4f1a\u6709\u5f88\u5927\u7684\u5e2e\u52a9\uff0c\u4e0b\u9762\u5c06\u5bf9\u8fd9\u4e2a Entity \u505a\u4e00\u4e2a\u901a\u4fd7\u7684\u89e3\u91ca\u3002 \u5148\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b Entity\uff1a \u00b6 \u4ec0\u4e48\u662f Entity\uff1fEntity \u5305\u62ec Nodes\uff08\u8282\u70b9\uff09, Users\uff08\u7528\u6237\uff09, Taxonomy Terms\uff08\u672f\u8bed\uff09, Comments\uff08\u8bc4\u8bba\uff09\uff0c\u5b83\u4eec\u90fd\u662f\u5b9e\u4f53\uff0c\u53ea\u662f\u547d\u540d\u548c\u7528\u9014\u4e0d\u4e00\u6837\u800c\u5df2\u3002\u4e0b\u9762\u7ffb\u8bd1\u4e00\u4e0b Drupal \u5b98\u7f51\u627e\u5230\u7684\u51e0\u884c\u5b9a\u4e49\u6587\u5b57\uff1a An entity type is a base class \u4e00\u4e2a\u5b9e\u4f53\u7c7b\u578b\u662f\u57fa\u7840\u7c7b\u522b A bundle is an extended class \u4e00\u4e2a\u96c6\u5408\u662f\u6269\u5c55\u7c7b\u522b A field is a class member, property, variable or field instance (depending on your naming preference) \u4e00\u4e2a\u5b57\u6bb5\u662f\u4e00\u4e2a\u7c7b\u522b\u7684\u6210\u5458\u3001\u5c5e\u6027\u3001\u5143\u7d20\u3001\u6216\u8005\u5b57\u6bb5\u5b9e\u4f8b\uff08\u53d6\u51b3\u4e8e\u4f60\u7684\u547d\u540d\u559c\u597d\uff09 An entity is an object or instance of a base or extended class \u4e00\u4e2a\u5b9e\u4f53\u662f\u4e00\u4e2a\u7269\u4f53\uff0c\u6216\u8005\u662f\u57fa\u7840\u7c7b\u522b\u7684\u5b9e\u4f8b\uff0c\u6216\u8005\u662f\u6269\u5c55\u7c7b\u522b\u7684\u5b9e\u4f8b \u66f4\u591a\u7684\u5c31\u4e0d\u7ffb\u8bd1\u4e86\uff0c\u514d\u5f97\u770b\u5f97\u4e00\u5934\u96fe\u6c34\u3002\u5982\u679c\u4f60\u80fd\u7406\u89e3\uff0c\u4e0b\u9762\u7684\u5185\u5bb9\u4e5f\u4e0d\u7528\u770b\u4e86\u3002 \u5173\u4e8e Entity \u7684\u901a\u4fd7\u89e3\u91ca\uff1a \u00b6 \u8fd9\u662f\u6839\u636e\u6211\u5bf9 Entity \u7684\u7406\u89e3\u6765\u89e3\u91ca\u7684\uff0c\u6211\u89c9\u5f97\u6211\u5bf9 Entity \u7406\u89e3\u5f97\u5dee\u4e0d\u591a\u4e86\uff0c\u4e0d\u81f3\u4e8e\u5bf9\u5927\u5bb6\u9020\u6210\u591a\u5927\u7684\u8bef\u5bfc\u3002 \u597d\u4e86\uff0c\u8ba9\u6211\u4eec\u6765\u6253\u4e2a\u6bd4\u65b9\uff0c\u8bf7\u5145\u5206\u53d1\u6325\u4f60\u7684\u8054\u60f3\u80fd\u529b\uff1a \u628a Entity Type\uff08\u5b9e\u4f53\u7c7b\u578b\uff09 \u770b\u505a\u4e8b\u7269\u2014\u2014\u4e8b\u7269\u6709\u5f88\u591a\u79cd\uff0c\u5305\u62ec\u751f\u7269\u3001\u975e\u751f\u7269\u7b49\uff0c\u6bd4\u5982\u7af9\u5b50\u3001\u8774\u8776\u3001\u96e8\u82b1\u77f3\u3001\u7a7a\u6c14\u7b49\u3002 \u628a Bundle\uff08\u96c6\u5408\uff09 \u770b\u6210\u67d0\u4e00\u7c7b\u5177\u4f53\u7684\u4e8b\u7269\uff0c\u6bd4\u5982\u7af9\u7c7b\u2014\u2014\u7af9\u5b50\u5176\u5b9e\u4e5f\u5206\u5f88\u591a\u79cd\uff0c\u6bd4\u5982\u6c34\u7af9\u3001\u6bdb\u7af9\u3001\u7d2b\u7af9\u3001\u82e6\u7af9\u7b49 \u628a Entity\uff08\u5b9e\u4f53\uff09\u770b\u6210\u67d0\u4e00\u79cd\u5177\u4f53\u7684\u4e8b\u7269\uff0c\u6bd4\u5982\u6bdb\u7af9\u2014\u2014\u6bdb\u7af9\u5176\u5b9e\u5176\u5b9e\u662f\u7531\u5f88\u591a\u90e8\u5206\u7ec4\u6210\u7684\uff0c\u6bd4\u5982\u4e3b\u5e72\u3001\u7af9\u679d\u3001\u7af9\u53f6\u3001\u6839\u987b\u7b49 \u628a Field\uff08\u5b57\u6bb5\uff09\u770b\u6210\u7ec4\u6210\u67d0\u4e00\u5177\u4f53\u4e8b\u7269\u7684\u4e00\u90e8\u5206\uff0c\u6bd4\u5982\u7af9\u53f6 \u8fd9\u6837\u4e5f\u8bb8\u6bd4\u8f83\u597d\u7406\u89e3\u5427\u3002\u4f60\u4e5f\u53ef\u4ee5\u628a Bundle \u770b\u6210\u8774\u8776\u8fd9\u4e2a\u5927\u7c7b\uff0cEntity \u76f8\u5f53\u4e8e\u5927\u9e1f\u7ffc\u8776\u4ec0\u4e48\u7684\uff0c\u5b57\u6bb5\u76f8\u5f53\u4e8e\u7fc5\u8180\u3001\u89e6\u987b\u4ec0\u4e48\u7684\u3002\u4ee5\u6b64\u7c7b\u63a8\u3002 Content Type\uff08\u5185\u5bb9\u7c7b\u578b\uff09\uff1a \u00b6 \u5728\u62ec\u53f7\u5185\u52a0\u89e3\u91ca\u592a\u4e71\u4e86\uff0c\u5206\u4e24\u884c\u5427\uff0c\u4e00\u884c\u7ffb\u8bd1\u6210\u4e2d\u6587\uff0c\u4e00\u884c\u4e0d\u7ffb\u8bd1\u3002\u6211\u4e2a\u4eba\u89c9\u5f97\u4e0d\u7ffb\u8bd1\u7684\u8bdd\u597d\u7406\u89e3\u4e00\u70b9\uff0c\u4f46\u662f\u5bf9\u82f1\u8bed\u4e0d\u719f\u6089\u7684\u7f51\u53cb\u770b\u82f1\u8bed\u53ef\u80fd\u4e0d\u597d\u7406\u89e3\u3002 \u7ffb\u8bd1\u7684\uff1a\u5185\u5bb9\u7c7b\u578b\u5176\u5b9e\u5c31\u662f\u8282\u70b9\u8fd9\u79cd\u5b9e\u4f53\u7684\u96c6\u5408\uff0c\u9ed8\u8ba4\u5305\u62ec\u6807\u9898\u3001\u5185\u5bb9\u4e24\u4e2a\u5b57\u6bb5\u3002\u8bc4\u8bba\u4e5f\u662f\u4e00\u4e2a\u5b9e\u4f53\uff0c\u5b83\u548c\u8282\u70b9\u8fd9\u79cd\u5b9e\u4f53\u662f\u5173\u8054\u7684\u5173\u7cfb\u3002 \u4e0d\u7ffb\u8bd1\uff1aContent Type \u5176\u5b9e\u5c31\u662f node \u8fd9\u79cd Entity \u7684 Bundle\uff0c\u9ed8\u8ba4\u5305\u62ec Title\u3001Body \u4e24\u4e2a Filed\u3002 \u5e94\u7528\uff1a \u00b6 \u7406\u89e3\u4e86 Entity\uff08\u5b9e\u4f53\uff09\u4e4b\u540e\uff0c\u81ea\u7136\u5c31\u662f\u5e94\u7528\u4e86\u3002\u53ef\u4ee5\u7528 Entity Construction Kit (ECK) \u8fd9\u4e2a\u6a21\u5757\u521b\u5efa\u65b0\u7684Entity\uff08\u5b9e\u4f53\uff09\uff0c\u6216\u8005\u7b80\u5355\u7684\uff0c\u5c31\u6dfb\u52a0\u65b0\u7684 Content Type\uff08\u5185\u5bb9\u7c7b\u578b\uff09\u5427\u3002 \u5185\u5bb9\u6240\u6307\u7684\u5176\u5b9e\u4e0d\u4ec5\u4ec5\u662f\u6587\u7ae0\uff0c\u56fe\u7247\u3001\u97f3\u4e50\u3001\u7535\u5f71\u3001\u6587\u4ef6\u3001\u4e66\u7c4d\u3001\u5e94\u7528\u7b49\u7b49\u90fd\u662f\u5185\u5bb9\u3002\u4f60\u60f3\u505a\u4ec0\u4e48\u7ad9\u70b9\u5c31\u600e\u4e48\u53bb\u5b9a\u4e49\u5b83\uff0c\u5b83\u6709\u4ec0\u4e48\u5c5e\u6027\u5c31\u6dfb\u52a0\u51e0\u4e2a\u5b57\u6bb5\u3002 \u628a\u5185\u5bb9\u7406\u89e3\u6210\u67d0\u4e9b\u4e1c\u897f\u5c31\u5bf9\u4e86\uff0c\u53ea\u8981\u5b83\u662f\u4fe1\u606f\u6570\u636e\u90fd\u80fd\u7528 Drupal \u6765\u7ba1\u7406\u3002\u600e\u4e48\u6837\uff1f\u77e5\u9053 Drupal \u53ef\u4ee5\u505a\u5f88\u591a\u79cd\u7f51\u7ad9\u4e86\u5427\uff1f\u5176\u5b9e\u524d\u9762\u8bf4\u7684\u4e3b\u8981\u8fd8\u662f\u8d44\u8baf\u7c7b\u7684\u7f51\u7ad9\uff0c\u66f4\u591a\u7c7b\u578b\u7684\u7f51\u7ad9\u8be5\u600e\u4e48\u505a\uff0c\u5c31\u8981\u53d1\u6325\u4f60\u7684\u601d\u7ef4\u529b\u4e86\u3002\u601d\u8def\u51b3\u5b9a\u51fa\u8def\uff0c\u89c1\u8bc6\u6539\u53d8\u601d\u7ef4\u3002","title":"Drupal8\u5b9e\u4f53(entity)"},{"location":"drupal/drupal8/Drupal8%E5%AE%9E%E4%BD%93-entity/#entity","text":"\u4ec0\u4e48\u662f Entity\uff1fEntity \u5305\u62ec Nodes\uff08\u8282\u70b9\uff09, Users\uff08\u7528\u6237\uff09, Taxonomy Terms\uff08\u672f\u8bed\uff09, Comments\uff08\u8bc4\u8bba\uff09\uff0c\u5b83\u4eec\u90fd\u662f\u5b9e\u4f53\uff0c\u53ea\u662f\u547d\u540d\u548c\u7528\u9014\u4e0d\u4e00\u6837\u800c\u5df2\u3002\u4e0b\u9762\u7ffb\u8bd1\u4e00\u4e0b Drupal \u5b98\u7f51\u627e\u5230\u7684\u51e0\u884c\u5b9a\u4e49\u6587\u5b57\uff1a An entity type is a base class \u4e00\u4e2a\u5b9e\u4f53\u7c7b\u578b\u662f\u57fa\u7840\u7c7b\u522b A bundle is an extended class \u4e00\u4e2a\u96c6\u5408\u662f\u6269\u5c55\u7c7b\u522b A field is a class member, property, variable or field instance (depending on your naming preference) \u4e00\u4e2a\u5b57\u6bb5\u662f\u4e00\u4e2a\u7c7b\u522b\u7684\u6210\u5458\u3001\u5c5e\u6027\u3001\u5143\u7d20\u3001\u6216\u8005\u5b57\u6bb5\u5b9e\u4f8b\uff08\u53d6\u51b3\u4e8e\u4f60\u7684\u547d\u540d\u559c\u597d\uff09 An entity is an object or instance of a base or extended class \u4e00\u4e2a\u5b9e\u4f53\u662f\u4e00\u4e2a\u7269\u4f53\uff0c\u6216\u8005\u662f\u57fa\u7840\u7c7b\u522b\u7684\u5b9e\u4f8b\uff0c\u6216\u8005\u662f\u6269\u5c55\u7c7b\u522b\u7684\u5b9e\u4f8b \u66f4\u591a\u7684\u5c31\u4e0d\u7ffb\u8bd1\u4e86\uff0c\u514d\u5f97\u770b\u5f97\u4e00\u5934\u96fe\u6c34\u3002\u5982\u679c\u4f60\u80fd\u7406\u89e3\uff0c\u4e0b\u9762\u7684\u5185\u5bb9\u4e5f\u4e0d\u7528\u770b\u4e86\u3002","title":"\u5148\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b Entity\uff1a"},{"location":"drupal/drupal8/Drupal8%E5%AE%9E%E4%BD%93-entity/#entity_1","text":"\u8fd9\u662f\u6839\u636e\u6211\u5bf9 Entity \u7684\u7406\u89e3\u6765\u89e3\u91ca\u7684\uff0c\u6211\u89c9\u5f97\u6211\u5bf9 Entity \u7406\u89e3\u5f97\u5dee\u4e0d\u591a\u4e86\uff0c\u4e0d\u81f3\u4e8e\u5bf9\u5927\u5bb6\u9020\u6210\u591a\u5927\u7684\u8bef\u5bfc\u3002 \u597d\u4e86\uff0c\u8ba9\u6211\u4eec\u6765\u6253\u4e2a\u6bd4\u65b9\uff0c\u8bf7\u5145\u5206\u53d1\u6325\u4f60\u7684\u8054\u60f3\u80fd\u529b\uff1a \u628a Entity Type\uff08\u5b9e\u4f53\u7c7b\u578b\uff09 \u770b\u505a\u4e8b\u7269\u2014\u2014\u4e8b\u7269\u6709\u5f88\u591a\u79cd\uff0c\u5305\u62ec\u751f\u7269\u3001\u975e\u751f\u7269\u7b49\uff0c\u6bd4\u5982\u7af9\u5b50\u3001\u8774\u8776\u3001\u96e8\u82b1\u77f3\u3001\u7a7a\u6c14\u7b49\u3002 \u628a Bundle\uff08\u96c6\u5408\uff09 \u770b\u6210\u67d0\u4e00\u7c7b\u5177\u4f53\u7684\u4e8b\u7269\uff0c\u6bd4\u5982\u7af9\u7c7b\u2014\u2014\u7af9\u5b50\u5176\u5b9e\u4e5f\u5206\u5f88\u591a\u79cd\uff0c\u6bd4\u5982\u6c34\u7af9\u3001\u6bdb\u7af9\u3001\u7d2b\u7af9\u3001\u82e6\u7af9\u7b49 \u628a Entity\uff08\u5b9e\u4f53\uff09\u770b\u6210\u67d0\u4e00\u79cd\u5177\u4f53\u7684\u4e8b\u7269\uff0c\u6bd4\u5982\u6bdb\u7af9\u2014\u2014\u6bdb\u7af9\u5176\u5b9e\u5176\u5b9e\u662f\u7531\u5f88\u591a\u90e8\u5206\u7ec4\u6210\u7684\uff0c\u6bd4\u5982\u4e3b\u5e72\u3001\u7af9\u679d\u3001\u7af9\u53f6\u3001\u6839\u987b\u7b49 \u628a Field\uff08\u5b57\u6bb5\uff09\u770b\u6210\u7ec4\u6210\u67d0\u4e00\u5177\u4f53\u4e8b\u7269\u7684\u4e00\u90e8\u5206\uff0c\u6bd4\u5982\u7af9\u53f6 \u8fd9\u6837\u4e5f\u8bb8\u6bd4\u8f83\u597d\u7406\u89e3\u5427\u3002\u4f60\u4e5f\u53ef\u4ee5\u628a Bundle \u770b\u6210\u8774\u8776\u8fd9\u4e2a\u5927\u7c7b\uff0cEntity \u76f8\u5f53\u4e8e\u5927\u9e1f\u7ffc\u8776\u4ec0\u4e48\u7684\uff0c\u5b57\u6bb5\u76f8\u5f53\u4e8e\u7fc5\u8180\u3001\u89e6\u987b\u4ec0\u4e48\u7684\u3002\u4ee5\u6b64\u7c7b\u63a8\u3002","title":"\u5173\u4e8e Entity \u7684\u901a\u4fd7\u89e3\u91ca\uff1a"},{"location":"drupal/drupal8/Drupal8%E5%AE%9E%E4%BD%93-entity/#content-type","text":"\u5728\u62ec\u53f7\u5185\u52a0\u89e3\u91ca\u592a\u4e71\u4e86\uff0c\u5206\u4e24\u884c\u5427\uff0c\u4e00\u884c\u7ffb\u8bd1\u6210\u4e2d\u6587\uff0c\u4e00\u884c\u4e0d\u7ffb\u8bd1\u3002\u6211\u4e2a\u4eba\u89c9\u5f97\u4e0d\u7ffb\u8bd1\u7684\u8bdd\u597d\u7406\u89e3\u4e00\u70b9\uff0c\u4f46\u662f\u5bf9\u82f1\u8bed\u4e0d\u719f\u6089\u7684\u7f51\u53cb\u770b\u82f1\u8bed\u53ef\u80fd\u4e0d\u597d\u7406\u89e3\u3002 \u7ffb\u8bd1\u7684\uff1a\u5185\u5bb9\u7c7b\u578b\u5176\u5b9e\u5c31\u662f\u8282\u70b9\u8fd9\u79cd\u5b9e\u4f53\u7684\u96c6\u5408\uff0c\u9ed8\u8ba4\u5305\u62ec\u6807\u9898\u3001\u5185\u5bb9\u4e24\u4e2a\u5b57\u6bb5\u3002\u8bc4\u8bba\u4e5f\u662f\u4e00\u4e2a\u5b9e\u4f53\uff0c\u5b83\u548c\u8282\u70b9\u8fd9\u79cd\u5b9e\u4f53\u662f\u5173\u8054\u7684\u5173\u7cfb\u3002 \u4e0d\u7ffb\u8bd1\uff1aContent Type \u5176\u5b9e\u5c31\u662f node \u8fd9\u79cd Entity \u7684 Bundle\uff0c\u9ed8\u8ba4\u5305\u62ec Title\u3001Body \u4e24\u4e2a Filed\u3002","title":"Content Type\uff08\u5185\u5bb9\u7c7b\u578b\uff09\uff1a"},{"location":"drupal/drupal8/Drupal8%E5%AE%9E%E4%BD%93-entity/#_1","text":"\u7406\u89e3\u4e86 Entity\uff08\u5b9e\u4f53\uff09\u4e4b\u540e\uff0c\u81ea\u7136\u5c31\u662f\u5e94\u7528\u4e86\u3002\u53ef\u4ee5\u7528 Entity Construction Kit (ECK) \u8fd9\u4e2a\u6a21\u5757\u521b\u5efa\u65b0\u7684Entity\uff08\u5b9e\u4f53\uff09\uff0c\u6216\u8005\u7b80\u5355\u7684\uff0c\u5c31\u6dfb\u52a0\u65b0\u7684 Content Type\uff08\u5185\u5bb9\u7c7b\u578b\uff09\u5427\u3002 \u5185\u5bb9\u6240\u6307\u7684\u5176\u5b9e\u4e0d\u4ec5\u4ec5\u662f\u6587\u7ae0\uff0c\u56fe\u7247\u3001\u97f3\u4e50\u3001\u7535\u5f71\u3001\u6587\u4ef6\u3001\u4e66\u7c4d\u3001\u5e94\u7528\u7b49\u7b49\u90fd\u662f\u5185\u5bb9\u3002\u4f60\u60f3\u505a\u4ec0\u4e48\u7ad9\u70b9\u5c31\u600e\u4e48\u53bb\u5b9a\u4e49\u5b83\uff0c\u5b83\u6709\u4ec0\u4e48\u5c5e\u6027\u5c31\u6dfb\u52a0\u51e0\u4e2a\u5b57\u6bb5\u3002 \u628a\u5185\u5bb9\u7406\u89e3\u6210\u67d0\u4e9b\u4e1c\u897f\u5c31\u5bf9\u4e86\uff0c\u53ea\u8981\u5b83\u662f\u4fe1\u606f\u6570\u636e\u90fd\u80fd\u7528 Drupal \u6765\u7ba1\u7406\u3002\u600e\u4e48\u6837\uff1f\u77e5\u9053 Drupal \u53ef\u4ee5\u505a\u5f88\u591a\u79cd\u7f51\u7ad9\u4e86\u5427\uff1f\u5176\u5b9e\u524d\u9762\u8bf4\u7684\u4e3b\u8981\u8fd8\u662f\u8d44\u8baf\u7c7b\u7684\u7f51\u7ad9\uff0c\u66f4\u591a\u7c7b\u578b\u7684\u7f51\u7ad9\u8be5\u600e\u4e48\u505a\uff0c\u5c31\u8981\u53d1\u6325\u4f60\u7684\u601d\u7ef4\u529b\u4e86\u3002\u601d\u8def\u51b3\u5b9a\u51fa\u8def\uff0c\u89c1\u8bc6\u6539\u53d8\u601d\u7ef4\u3002","title":"\u5e94\u7528\uff1a"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/","tags":"[database]","text":"Drupal8\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u51fd\u6570\u8ddfDrupal7\u6ca1\u4ec0\u4e48\u53d8\u5316\uff0c\u4f46\u662f\uff0c\u5728Drupal9(\u8fd8\u6ca1\u5f00\u59cb\u5f00\u53d1\uff0c\u4f46\u662f\u4ee3\u7801\u6ce8\u91ca\u4e2d\u5df2\u7ecf\u6709)\u4e2d\u4f1a\u628a\u4e00\u4e9b\u51fd\u6570\u79fb\u9664\uff0c\u6bd4\u5982db_add, db_insert, db_query\u7b49\uff0c\u89c1 Drupal8 database \u3002 Select \u00b6 Get single value: \u00b6 $query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->addField('nfd', 'nid'); $query->condition('nfd.title', 'Potato'); $query->range(0, 1); $nid = $query->execute()->fetchField(); Get single row: \u00b6 $query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->fields('nfd', ['nid', 'title']); $query->condition('nfd.type', 'vegetable'); $query->range(0, 1); $vegetable = $query->execute()->fetchAssoc(); Using db like: \u00b6 $query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->fields('nfd', ['nid', 'title']); $query->condition('nfd.type', 'vegetable'); $query->condition('nfd.title', $query->escapeLike('ca') . '%', 'LIKE'); $vegetable = $query->execute()->fetchAllKeyed(); Get several rows with JOIN: \u00b6 $query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->fields('nfd', ['nid', 'title']); $query->addField('ufd', 'name'); $query->join('users_field_data', 'ufd', 'ufd.uid = nfd.uid'); $query->condition('nfd.type', 'vegetable'); $vegetable = $query->execute()->fetchAllAssoc('nid'); Insert \u00b6 $query = \\Drupal::database()->insert('flood'); $query->fields([ 'event', 'identifier' ]); $query->values([ 'My event', 'My indentifier' ]); $query->execute(); \u6ce8\uff1avalues\u53ef\u4ee5\u8c03\u7528\u591a\u6b21\uff0c\u5982 $query->values([ 'My event', 'My indentifier' ]) ->values([ 'My event1', 'My indentifier1' ]); Update \u00b6 $query = \\Drupal::database()->update('flood'); $query->fields([ 'identifier' => 'My new identifier' ]); $query->condition('event', 'My event'); $query->execute(); Upsert \u00b6 $query = \\Drupal::database()->upsert('flood'); $query->fields([ 'fid', 'identifier', ]); $query->values([ 1, 'My indentifier for upsert' ]); $query->key('fid'); $query->execute(); \u6ce8\uff1aupsert\uff0c\u987e\u540d\u601d\u4e49\u5c31\u662fupdate+insert\u7684\u4f5c\u7528\u3002 \u6839\u636e\u6761\u4ef6\u5224\u65ad\u6709\u65e0\u8bb0\u5f55\uff0c\u6709\u7684\u8bdd\u5c31\u66f4\u65b0\u8bb0\u5f55\uff0c\u6ca1\u6709\u7684\u8bdd\u5c31\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 key()\u7528\u6765\u5b9a\u4e49\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684row, \u5fc5\u987b\u662funique\u7c7b\u578b\uff0c\u4e0d\u7136\u6c38\u8fdc\u6267\u884cInsert\u64cd\u4f5c. Delete \u00b6 $query = \\Drupal::database()->delete('flood'); $query->condition('event', 'My event'); $query->execute();","title":"\"Drupal8\u6570\u636e\u5e93(database)\""},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#select","text":"","title":"Select"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#get-single-value","text":"$query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->addField('nfd', 'nid'); $query->condition('nfd.title', 'Potato'); $query->range(0, 1); $nid = $query->execute()->fetchField();","title":"Get single value:"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#get-single-row","text":"$query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->fields('nfd', ['nid', 'title']); $query->condition('nfd.type', 'vegetable'); $query->range(0, 1); $vegetable = $query->execute()->fetchAssoc();","title":"Get single row:"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#using-db-like","text":"$query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->fields('nfd', ['nid', 'title']); $query->condition('nfd.type', 'vegetable'); $query->condition('nfd.title', $query->escapeLike('ca') . '%', 'LIKE'); $vegetable = $query->execute()->fetchAllKeyed();","title":"Using db like:"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#get-several-rows-with-join","text":"$query = \\Drupal::database()->select('node_field_data', 'nfd'); $query->fields('nfd', ['nid', 'title']); $query->addField('ufd', 'name'); $query->join('users_field_data', 'ufd', 'ufd.uid = nfd.uid'); $query->condition('nfd.type', 'vegetable'); $vegetable = $query->execute()->fetchAllAssoc('nid');","title":"Get several rows with JOIN:"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#insert","text":"$query = \\Drupal::database()->insert('flood'); $query->fields([ 'event', 'identifier' ]); $query->values([ 'My event', 'My indentifier' ]); $query->execute(); \u6ce8\uff1avalues\u53ef\u4ee5\u8c03\u7528\u591a\u6b21\uff0c\u5982 $query->values([ 'My event', 'My indentifier' ]) ->values([ 'My event1', 'My indentifier1' ]);","title":"Insert"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#update","text":"$query = \\Drupal::database()->update('flood'); $query->fields([ 'identifier' => 'My new identifier' ]); $query->condition('event', 'My event'); $query->execute();","title":"Update"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#upsert","text":"$query = \\Drupal::database()->upsert('flood'); $query->fields([ 'fid', 'identifier', ]); $query->values([ 1, 'My indentifier for upsert' ]); $query->key('fid'); $query->execute(); \u6ce8\uff1aupsert\uff0c\u987e\u540d\u601d\u4e49\u5c31\u662fupdate+insert\u7684\u4f5c\u7528\u3002 \u6839\u636e\u6761\u4ef6\u5224\u65ad\u6709\u65e0\u8bb0\u5f55\uff0c\u6709\u7684\u8bdd\u5c31\u66f4\u65b0\u8bb0\u5f55\uff0c\u6ca1\u6709\u7684\u8bdd\u5c31\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 key()\u7528\u6765\u5b9a\u4e49\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684row, \u5fc5\u987b\u662funique\u7c7b\u578b\uff0c\u4e0d\u7136\u6c38\u8fdc\u6267\u884cInsert\u64cd\u4f5c.","title":"Upsert"},{"location":"drupal/drupal8/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#delete","text":"$query = \\Drupal::database()->delete('flood'); $query->condition('event', 'My event'); $query->execute();","title":"Delete"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E5%9D%97-module-%E5%BC%80%E5%8F%91/","tags":"[module]","text":"","title":"\"Drupal8\u6a21\u5757(module)\u5f00\u53d1\""},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/","tags":"[twig]","text":"\u4e00\u3001\u7b80\u4ecb \u00b6 Twig\u662f\u4e00\u4e2a\u9ad8\u6548\u3001\u5b89\u5168\u5e76\u53ef\u6269\u5c55\u7684PHP\u6a21\u677f\u5f15\u64ce\u3002 \u5982\u679c\u4f60\u5177\u6709Smarty, Django\u6216\u8005Jinja\u8fd9\u517b\u7684\u57fa\u4e8e\u6587\u672c\u7684\u6a21\u677f\u8bed\u8a00\u7684\u7ecf\u9a8c\uff0c\u90a3\u4e48\u4f60\u5bf9Twig\u4f1a\u611f\u89c9\u4e00\u89c1\u5982\u6545\u3002\u5728\u9075\u5faaPHP\u7406\u5ff5\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u63d0\u4f9b\u4e86\u5177\u5907\u5f3a\u5927\u529f\u80fd\u7684\u6a21\u677f\u73af\u5883\uff0c\u4e0d\u8bba\u662f\u5bf9\u5f00\u53d1\u8005\u8fd8\u662f\u8bbe\u8ba1\u8005\u6765\u8bf4\uff0c\u8fd9\u4e00\u5f15\u64ce\u90fd\u5177\u6709\u826f\u597d\u7684\u53ef\u7528\u6027\u3002 \u5173\u952e\u7279\u6027\uff1a \u5feb\u901f\uff1aTwig\u628a\u6a21\u677f\u7f16\u8bd1\u6210\u4e3a\u4f18\u5316\u540e\u7684PHP\u4ee3\u7801\u3002\u76f8\u5bf9\u666e\u901aPHP\u4ee3\u7801\u6765\u8bf4\uff0c\u5176\u989d\u5916\u5f00\u9500\u975e\u5e38\u8f7b\u5fae\u3002 \u5b89\u5168\uff1aTwig\u4f1a\u4f7f\u7528\u4e00\u4e2a\u6c99\u7bb1\u6a21\u5f0f\u6765\u8fd0\u884c\u4e0d\u4fe1\u4efb\u7684\u6a21\u677f\u4ee3\u7801\u3002\u8fd9\u4f7f\u5f97Twig\u53ef\u4ee5\u5728\u7528\u6237\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u8bbe\u8ba1\u7684\u5e94\u7528\u4e2d\u5de5\u4f5c\u826f\u597d\u3002 \u5f39\u6027\uff1aTwig\u8bd5\u7528\u4e86\u5f39\u6027\u7684\u8bcd\u6cd5\u548c\u8bed\u6cd5\u5206\u6790\u5668\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u5b9a\u4e49\u81ea\u5df1\u7684\u6807\u8bb0\u548c\u8fc7\u6ee4\uff0c\u5e76\u521b\u5efa\u81ea\u5df1\u7684DSL\u3002 \u9700\u6c42 \u00b6 Twig\u9700\u8981\u7684\u6700\u5c0f\u8fd0\u884c\u73af\u5883\u4e3aPHP 5.2.4 \u5b89\u88c5 \u00b6 \u63a8\u8350\u4f7f\u7528Composer\u5b89\u88c5Twig\uff1a composer require \"twig/twig:~1.0\" \u57fa\u7840API\u7528\u6cd5 \u00b6 \u672c\u8282\u5bf9Twig PHP API\u505a\u4e00\u4e2a\u7b80\u5355\u4ecb\u7ecd\u3002 require_once '/path/to/vendor/autoload.php'; $loader = new Twig_Loader_Array( 'index' => 'Hello {{ name }}!', ); $twig = new Twig_Environment($loader); echo $twig->render('index', array('name' => 'Fabien')); Twig\u4f7f\u7528\u4e00\u4e2a\u52a0\u8f7d\u5668(Twig_Loader_Array)\u6765\u5b9a\u4f4d\u6a21\u677f\u6587\u4ef6\uff0c\u4f7f\u7528\u4e00\u4e2a\u73af\u5883(Twig_Environment)\u6765\u5b58\u50a8\u914d\u7f6e\uff0crender()\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u6307\u5b9a\u4e86\u6a21\u677f\uff0c\u540e\u9762\u7684\u53c2\u6570\u5219\u4e3a\u6e32\u67d3\u63d0\u4f9b\u4e86\u53d8\u91cf\u3002 \u6a21\u677f\u4e00\u822c\u662f\u4fdd\u5b58\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u6240\u4ee5Twig\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u52a0\u8f7d\u5668\uff1a $loader = new Twig_Loader_Filesystem('/path/to/templates'); $twig = new Twig_Environment($loader, array( 'cache' => '/path/to/compilation_cache', )); echo $twig->render('index.html', array('name' => 'Fabien')); \u5982\u679c\u6ca1\u6709\u4f7f\u7528 Composer\uff0c\u53ef\u4ee5\u4f7f\u7528 Twig \u7684\u5185\u7f6e\u52a0\u8f7d\u5668\uff1a require_once '/path/to/lib/Twig/Autoloader.php'; Twig_Autoloader::register(); \u4e8c\u3001\u6a21\u677f\u8bbe\u8ba1\u8005\u7684Twig \u00b6 \u672c\u6587\u63cf\u8ff0\u4e86\u6a21\u677f\u5f15\u64ce\u4e2d\u6d89\u53ca\u5230\u7684\u8bed\u6cd5\u548c\u8bed\u4e49\uff0c\u5bf9Twig\u6a21\u677f\u7684\u8bbe\u8ba1\u4f1a\u5f88\u6709\u5e2e\u52a9\u3002 \u6982\u8981 \u00b6 \u6a21\u677f\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6587\u672c\u6587\u4ef6\u3002\u5b83\u80fd\u591f\u751f\u6210\u4efb\u4f55\u6587\u672c\u683c\u5f0f\uff08HTML, XML, CSV, LaTeX\u7b49\uff09\u3002\u4ed6\u6ca1\u6709\u56fa\u5b9a\u7684\u6269\u5c55\u540d\uff0chtml\u3001xml\u90fd\u6ca1\u5173\u7cfb\u3002 \u6a21\u677f\u4e2d\u5305\u542b\u53d8\u91cf\u548c\u8868\u8fbe\u5f0f\u5728\u6a21\u677f\u88ab\u5904\u7406\u65f6\u4f1a\u88ab\u66ff\u6362\u4e3a\u771f\u5b9e\u7684\u503c\uff0ctags\u5219\u5bf9\u6a21\u677f\u7684\u903b\u8f91\u8fdb\u884c\u63a7\u5236\u3002 \u4e0b\u9762\u7528\u4e00\u4e2a\u5c0f\u4f8b\u5b50\u5c55\u793a\u4e00\u4e9b\u57fa\u7840\u5185\u5bb9\uff0c\u5f53\u7136\uff0c\u540e\u9762\u4f1a\u505a\u8fdb\u4e00\u6b65\u7684\u6df1\u5165\u3002 <!DOCTYPE html> <html> <head> <title>My Webpage</title> </head> <body> <ul id=\"navigation\"> {% raw %} {% for item in navigation %} <li><a href=\"{{ item.href }}\">{{ item.caption }}</a></li> {% endfor %} </ul> {% endraw %} <h1>My Webpage</h1> {% raw %} {{ a_variable }} {% endraw %} </body> </html> {% raw %} \u4e0a\u9762\u4ee3\u7801\u4e2d\u6709\u4e24\u79cd\u5206\u9694\u7b26\uff1a{% ... %}\u548c{{ ... }}\u3002\u7b2c\u4e00\u79cd\u7528\u4e8e\u6267\u884cfor\u5faa\u73af\u4e4b\u7c7b\u7684\u8bed\u53e5\uff0c\u7b2c\u4e8c\u79cd\u7528\u4e8e\u8f93\u51fa\u8868\u8fbe\u5f0f\u7ed3\u679c\u3002 {% endraw %} \u53d8\u91cf \u00b6 \u5e94\u7528\u4f1a\u628a\u53d8\u91cf\u4f20\u9012\u7ed9\u6a21\u677f\u8fdb\u884c\u5904\u7406\u3002\u53d8\u91cf\u81ea\u8eab\u4e5f\u53ef\u4ee5\u62e5\u6709\u5c5e\u6027\u6216\u5143\u7d20\u4f9b\u5916\u90e8\u8bbf\u95ee\u3002\u53d8\u91cf\u7684\u5177\u4f53\u5f62\u6001\u53d6\u51b3\u4e8e\u63d0\u4f9b\u53d8\u91cf\u7684\u5e94\u7528\u3002 \u53ef\u4ee5\u5229\u7528\u53e5\u70b9\uff08.\uff09\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\uff08\u76f8\u5f53\u4e8ePHP\u5bf9\u8c61\u7684\u5c5e\u6027\u6216\u65b9\u6cd5\uff0c\u6216\u8005PHP\u6570\u7ec4\u7684\u6210\u5458\uff09\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0b\u6807\u8bed\u6cd5\uff08[]\uff09\uff1a {% raw %} {{ foo.bar }} {{ foo['bar'] }} {% endraw %} \u5f53\u5c5e\u6027\u540d\u5b57\u4e2d\u5305\u542b\u4e86\u7279\u522b\u5b57\u7b26\uff08\u4f8b\u5982\u201c-\u201d\u4f1a\u88ab\u5f53\u505a\u51cf\u53f7\u5904\u7406\uff09\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528attribute\u51fd\u6570\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\uff1a {# \u7b49\u4ef7\u4e8e\u4e0d\u80fd\u5de5\u4f5c\u7684\uff1afoo.data-foo #} {% raw %} {{ attribute(foo, 'data-foo') }} {% endraw %} \u5927\u62ec\u53f7\u662f\u6253\u5370\u6307\u4ee4\uff0c\u800c\u4e0d\u662f\u53d8\u91cf\u7684\u7ec4\u6210\u90e8\u5206\u3002\u5f53\u5728tag\u4e2d\u8bbf\u95ee\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u5728Tag\u4e2d\u8bbf\u95ee\u53d8\u91cf\u7684\u65f6\u5019\u4f7f\u7528\u8fd9\u79cd\u8bed\u6cd5\u3002 \u5728strict_variables\u9009\u9879\u4e3afalse\u7684\u65f6\u5019\uff0c\u5982\u679c\u53d8\u91cf\u6216\u5c5e\u6027\u4e0d\u5b58\u5728\uff0c\u4f1a\u8fd4\u56denull\uff1b\u800c\u5982\u679c\u8be5\u9009\u9879\u8bbe\u7f6e\u4e3atrue\uff0c\u8fd9\u79cd\u60c5\u51b5\u5c31\u4f1a\u629b\u51fa\u9519\u8bef \u5b9e\u73b0 \u00b6 foo.bar\u5728PHP\u8fd9\u4e00\u5c42\u6b21\u505a\u4e86\u5982\u4e0b\u4e8b\u60c5\uff1a \u68c0\u67e5foo\u662f\u4e0d\u662f\u6570\u7ec4\uff0cbar\u662f\u4e0d\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u6709\u6548\u5143\u7d20\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5bar\u662f\u4e0d\u662f\u6709\u6548\u7684\u5c5e\u6027\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5bar\u662f\u4e0d\u662f\u6709\u6548\u7684\u65b9\u6cd5\uff08\u5373\u4f7fbar\u662f\u6784\u9020\u5668\u2014\u2014\u6240\u4ee5\u8bf7\u4f7f\u7528__construct()\uff09\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5getBar\u662f\u4e0d\u662f\u6709\u6548\u7684\u65b9\u6cd5\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5isBar\u662f\u4e0d\u662f\u6709\u6548\u7684\u65b9\u6cd5\uff1b \u5982\u679c\u90fd\u4e0d\u662f\uff0c\u8fd4\u56denull\u3002 \u53e6\u4e00\u65b9\u9762\uff0cfoo['bar']\u53ea\u5bf9PHP\u6570\u7ec4\u5de5\u4f5c - \u68c0\u67e5foo\u662f\u4e0d\u662f\u4e00\u4e2a\u6570\u7ec4\uff0cbar\u662f\u4e0d\u662f\u4e00\u4e2a\u6709\u6548\u5143\u7d20\uff1b - \u5982\u679c\u4e0d\u662f\uff0c\u8fd4\u56denull\u3002 \u5982\u679c\u8981\u8bbf\u95ee\u53d8\u91cf\u7684\u52a8\u6001\u5c5e\u6027\uff0c\u5e94\u8be5\u4f7f\u7528attribute()\u51fd\u6570\u3002 \u5168\u5c40\u53d8\u91cf \u00b6 \u6a21\u677f\u4e2d\u968f\u65f6\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684\u53d8\u91cf\uff1a _self\uff1a\u5f53\u524d\u7684\u6a21\u677f\uff1b _context\uff1a\u5f53\u524d\u4e0a\u4e0b\u6587 _charset\uff1a\u5f53\u524d\u7f16\u7801 \u8bbe\u7f6e\u53d8\u91cf \u00b6 \u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002\u8d4b\u503c\u8fc7\u7a0b\u4f7f\u7528settag\u5b8c\u6210\uff1a {% raw %} {% set foo = 'foo' %} {% set foo = [1, 2] %} {% set foo = {'foo': 'bar'} %} {% endraw %} Filters \u00b6 \u53d8\u91cf\u53ef\u4ee5\u7528filters\u8fdb\u884c\u4fee\u6539\u3002Filters\u548c\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\uff08|\uff09\u8fdb\u884c\u5206\u9694\uff0c\u53ef\u4ee5\u7528\u62ec\u53f7\u6765\u5305\u542b\u53c2\u6570\u3002\u591a\u4e2aFilter\u53ef\u80fd\u8fdb\u884c\u94fe\u5f0f\u8c03\u7528\u2014\u2014\u524d\u4e00\u4e2aFilter\u7684\u8f93\u51fa\u53ef\u4f5c\u4e3a\u4e0b\u4e00\u4e2aFilter\u7684\u8f93\u5165\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u6e05\u7406\u6240\u6709\u7684HTML\u6807\u8bb0\uff0c\u5e76\u505a\u6807\u9898\u5927\u5199\u5904\u7406\uff1a {% raw %} {{ name|striptags|title }} {% endraw %} Filter\u53ef\u4ee5\u7528\u62ec\u53f7\u7684\u5f62\u5f0f\u63a5\u6536\u53c2\u6570\u3002\u8fd9\u4e2a\u4f8b\u5b50\u7528\u9017\u53f7\u8fde\u63a5\u4e00\u4e2a\u5217\u8868\uff1a {% raw %} {{ list|join(', ') }} {% endraw %} \u8981\u5bf9\u4e00\u6bb5\u4ee3\u7801\u4f7f\u7528Filter\uff0c\u53ef\u4ee5\u7528filter tag\u64cd\u4f5c\uff1a {% raw %} {% filter upper %} This text becomes uppercase {% endfilter %} {% endraw %} \u51fd\u6570 \u00b6 \u8c03\u7528\u51fd\u6570\u53ef\u4ee5\u751f\u6210\u5185\u5bb9\u3002\u8c03\u7528\u51fd\u6570\u7684\u65b9\u5f0f\u662f\uff1a\u51fd\u6570\u540d\u79f0\u52a0\u62ec\u53f7\uff0c\u62ec\u53f7\u4e2d\u53ef\u80fd\u5305\u542b\u53c2\u6570\u3002 \u4f8b\u5982range\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u9012\u589e\u7684\u6574\u6570\u5217\u8868\uff1a {% raw %} {% for i in range(0, 3) %} {{ i }}, {% endfor %} {% endraw %} \u524d\u5f80 functions \u4e00\u8282\u53ef\u4ee5\u5b66\u4e60\u66f4\u591a\u5185\u7f6e\u51fd\u6570\u7684\u5185\u5bb9\u3002 \u5177\u540d\u53c2\u6570 \u00b6 1.12\u7248\u4e2d\u65b0\u589e {% raw %} {% for i in range(low=1, high=10, step=2) %} {{ i }}, {% endfor %} {% endraw %} \u6709\u4e86\u5177\u540d\u53c2\u6570\uff0c\u4f20\u9012\u7ed9\u6a21\u677f\u7684\u53c2\u6570\u53ef\u4ee5\u66f4\u52a0\u660e\u786e\uff0c\u8ba9\u6a21\u677f\u66f4\u52a0\u6613\u7528\u3002 {% raw %} {{ data|convert_encoding('UTF-8', 'iso-2022-jp') }} {# \u76f8\u6bd4\uff1a #} {{ data|convert_encoding(from='iso-2022-jp', to='UTF-8') }} {% endraw %} \u5177\u540d\u53c2\u6570\u8fd8\u80fd\u5728\u4e0d\u4f20\u9012\u67d0\u4e9b\u53c2\u6570\u65f6\u5019\u76f4\u63a5\u8df3\u8fc7\uff1a {% raw %} {# the first argument is the date format, which defaults to the global date format if null is passed #} {{ \"now\"|date(null, \"Europe/Paris\") }} {# or skip the format value by using a named argument for the time zone #} {{ \"now\"|date(timezone=\"Europe/Paris\") }} {% endraw %} \u8fd8\u53ef\u4ee5\u7528\u987a\u5e8f\u53c2\u6570\u548c\u5177\u540d\u53c2\u6570\u5939\u6742\u7684\u65b9\u5f0f\u8fdb\u884c\u8c03\u7528\uff0c\u8fd9\u91cc\u8981\u4fdd\u8bc1\u987a\u5e8f\u53c2\u6570\u5fc5\u987b\u6bd4\u5177\u540d\u53c2\u6570\u5148\u51fa\u73b0\uff1a {% raw %} {{ \"now\"|date('d/m/Y H:i', timezone=\"Europe/Paris\") }} {% endraw %} \u6bcf\u4e2a\u51fd\u6570\u548cFilter\u7684\u6587\u6863\u4e2d\uff0c\u5982\u679c\u8be5\u51fd\u6570\u6216\u8005Filter\u652f\u6301\u5177\u540d\u53c2\u6570\uff0c\u90fd\u4f1a\u6709\u4e00\u8282\u5217\u51fa\u6240\u6709\u7684\u53c2\u6570\u540d\u79f0\u3002 \u63a7\u5236\u7ed3\u6784 \u00b6 {% raw %} \u63a7\u5236\u7ed3\u6784\u6307\u7684\u662f\u6240\u6709\u80fd\u591f\u63a7\u5236\u7a0b\u5e8f\u6d41\u7a0b\u7684\u5143\u7d20\u2014\u2014\u6761\u4ef6\u5224\u65ad\uff08\u4e5f\u5c31\u662fif/elseif/else\uff09\u3001for\u5faa\u73af\uff0c\u4ee5\u53ca\u8bed\u53e5\u5757\u7b49\u3002\u63a7\u5236\u7ed3\u6784\u7528{% ... %}\u5305\u88f9 {% endraw %} \u4f8b\u5982\uff0c\u8981\u663e\u793a\u4e00\u4e2ausers\u53d8\u91cf\u4e2d\u6240\u6709\u7684\u5217\u8868\u6210\u5458\uff0c\u4f7f\u7528for\uff1a <h1>Members</h1> <ul> {% raw %} {% for user in users %} <li>{{ user.username|e }}</li> {% endfor %} {% endraw %} </ul> \u53ef\u4ee5\u7528if\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\uff1a {% if users|length > 0 %} <ul> {% raw %} {% for user in users %} <li>{{ user.username|e }}</li> {% endfor %} {% endraw %} </ul> {% endif %} Tags \u9875\u4e2d\u63cf\u8ff0\u4e86\u5404\u79cd\u5185\u7f6eTag\u3002 \u6ce8\u91ca \u00b6 \u5728\u6a21\u677f\u4e2d\u8fdb\u884c\u6ce8\u91ca\uff0c\u4f7f\u7528\u6ce8\u91ca\u8bed\u6cd5`{# ... #}\uff1a {% raw %} {# \u6ce8\uff1a\u7981\u7528\u8fd9\u4e00\u5757\u4e1c\u897f\uff0c\u4e0d\u518d\u9700\u8981\u4e86 {% for user in users %} ... {% endfor %} {% endraw %} #} \u5305\u542b\u5176\u4ed6\u6a21\u677f \u00b6 include\u6807\u7b7e\u7528\u4e8e\u5305\u542b\u5176\u5b83\u6a21\u7248\uff0c\u5e76\u628a\u8be5\u6a21\u7248\u7684\u6e32\u67d3\u7ed3\u679c\u8fd4\u56de\u5230\u5f53\u524d\u9875\u9762\uff1a {% raw %} {% include 'sidebar.html' %} {% endraw %} \u7f3a\u7701\u72b6\u51b5\u4e0b\uff0c\u5f53\u524d\u7684\u4e0a\u4e0b\u6587\u4f1a\u88ab\u4f20\u9012\u7ed9\u88ab\u5305\u542b\u7684\u6a21\u677f\u3002 \u4f20\u9012\u7ed9\u88ab\u5305\u542b\u6a21\u677f\u4e2d\u7684\u4e0a\u4e0b\u6587\u5305\u542b\u5f53\u524d\u6a21\u677f\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\uff1a {% raw %} {% for box in boxes %} {% include \"render_box.html\" %} {% endfor %} {% endraw %} \u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0crender_box.html\u53ef\u4ee5\u8bbf\u95eebox\u53d8\u91cf\u3002 \u6a21\u677f\u6587\u4ef6\u540d\u7684\u9009\u53d6\uff0c\u53d6\u51b3\u4e8e\u6a21\u677f\u52a0\u8f7d\u5668\u3002\u6bd4\u5982Twig_Loader_Filesystem\u5141\u8bb8\u901a\u8fc7\u6587\u4ef6\u540d\u8bbf\u95ee\u5176\u4ed6\u7684\u6a21\u677f\u3002\u53ef\u4ee5\u4f7f\u7528\u5b50\u76ee\u5f55\u6765\u8bbf\u95ee\u5176\u4ed6\u6a21\u677f\uff1a {% raw %} {% include \"sections/articles/sidebar.html\" %} {% endraw %} \u6a21\u7248\u7ee7\u627f \u00b6 Twig\u6700\u5f3a\u5927\u7684\u80fd\u529b\u5c31\u662f\u7ee7\u627f\u3002\u8fd9\u4e00\u4e2a\u80fd\u529b\u53ef\u4ee5\u8ba9\u4f60\u5efa\u7acb\u4e00\u4e2a\u5305\u542b\u6240\u6709\u57fa\u7840\u5143\u7d20\u7684\u57fa\u7840\u6a21\u677f\uff0c\u5e76\u5b9a\u4e49\u53ef\u4ee5\u88ab\u5b50\u6a21\u677f\u8986\u76d6\u7684block\u3002 \u8fd9\u90e8\u5206\u5185\u5bb9\u5e76\u4e0d\u50cf\u542c\u8d77\u6765\u90a3\u4e48\u590d\u6742\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u80fd\u8ba9\u4f60\u66f4\u597d\u7684\u7406\u89e3\u8fd9\u4e2a\u6982\u5ff5\u3002 \u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3abase.html\u7684\u57fa\u672c\u6a21\u677f\uff0c\u5728\u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7b80\u5355\u7684HTML\u7ed3\u6784\uff0c\u540e\u9762\u53ef\u4ee5\u7528\u5728\u4e00\u4e2a\u7b80\u5355\u7684\u4e24\u5217\u5e03\u5c40\u7684\u9875\u9762\u4e0a\uff1a <!DOCTYPE html> <html> <head> {% raw %} {% block head %} <link rel=\"stylesheet\" href=\"style.css\" /> <title>{% block title %}{% endblock %} - My Webpage</title> {% endblock %} {% endraw %} </head> <body> <div id=\"content\"> {% raw %} {% block content %} {% endblock %} {% endraw %} </div> <div id=\"footer\"> {% raw %} {% block footer %} &copy; Copyright 2011 by <a href=\"http://domain.invalid/\">you</a>. {% endblock %} {% endraw %} </div> </body> </html> \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c Block\u6807\u8bb0 \u5b9a\u4e49\u4e86\u56db\u4e2aBlock\uff0c\u5b50\u6a21\u677f\u53ef\u4ee5\u5bf9\u8fd9\u56db\u4e2aBlock\u8fdb\u884c\u586b\u5145\u3002\u6240\u6709\u7684Block\u6807\u8bb0\u7684\u4f5c\u7528\u5c31\u5728\u4e8e\u544a\u8bc9\u6a21\u677f\u5f15\u64ce\u2014\u2014\u5b50\u6a21\u677f\u53ef\u80fd\u5bf9\u6a21\u677f\u7684\u8fd9\u4e00\u90e8\u5206\u8fdb\u884c\u8986\u76d6\u3002 \u4e00\u4e2a\u5b50\u6a21\u677f\u770b\u8d77\u6765\u5927\u6982\u662f\uff1a {% raw %} {% extends \"base.html\" %} {% block title %}Index{% endblock %} {% block head %} {{ parent() }} <style type=\"text/css\"> .important { color: #336699; } </style> {% endblock %} {% block content %} <h1>Index</h1> <p class=\"important\"> Welcome to my awesome homepage. </p> {% endblock %} {% endraw %} \u6b64\u5904\u7684\u5173\u952e\u5c31\u5728\u4e8e Extends tag \u3002\u4ed6\u8ba9\u6a21\u677f\u5f15\u64ce\u5f97\u77e5\u8fd9\u4e2a\u6a21\u677f\u662f\u201c\u6269\u5c55\u81ea\u5176\u4ed6\u6a21\u677f\u201d\u3002\u5f53\u6a21\u677f\u7cfb\u7edf\u5904\u7406\u8fd9\u4e00\u6a21\u677f\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u9996\u5148\u5b9a\u4f4d\u7236\u6a21\u677f\u3002Extends\u6807\u8bb0\u5e94\u8be5\u662f\u5b50\u6a21\u677f\u7684\u7b2c\u4e00\u4e2a\u6807\u8bb0\u3002 \u53e6\u5916\u56e0\u4e3a\u5b50\u6a21\u677f\u4e2d\u6ca1\u6709\u5b9a\u4e49footer block\uff0c\u6240\u4ee5\u6b64\u5904\u4f1a\u7ee7\u7eed\u4f7f\u7528\u7236\u6a21\u677f\u7684\u5185\u5bb9\u3002 \u4e5f\u53ef\u4ee5\u7528 Parent\u51fd\u6570 \u6765\u6e32\u67d3\u7236\u6a21\u677fBlock\u7684\u5185\u5bb9\u3002\u8fd9\u4e00\u8c03\u7528\u4f1a\u8fd4\u56de\u7236\u6a21\u677f\u4e2d\u7684Block\u7ed3\u679c\uff1a {% raw %} {% block sidebar %} <h3>Table Of Contents</h3> ... {{ parent() }} {% endblock %} {% endraw %} extend\u6587\u6863 \u4e2d\u4ecb\u7ecd\u4e86\u66f4\u6df1\u5165\u7684\u7279\u6027\uff0c\u4f8b\u5982Block\u5d4c\u5957\u3001\u4f5c\u7528\u57df\u3001\u52a8\u6001\u7ee7\u627f\u4ee5\u53ca\u6761\u4ef6\u7ee7\u627f\u7b49\u3002 HTML\u8f6c\u4e49 \u00b6 \u4ece\u6a21\u677f\u4e2d\u751f\u6210HTML\u7684\u65f6\u5019\uff0c\u5b58\u5728\u4e00\u79cd\u98ce\u9669\uff1a\u4e00\u4e2a\u53d8\u91cf\u53ef\u80fd\u5305\u542b\u4e86HTML\u4ee3\u7801\uff0c\u4f1a\u5f71\u54cd\u5230\u6700\u7ec8\u7684HTML\u3002\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\u4eba\u5de5\u8f6c\u4e49\u6bcf\u4e00\u4e2a\u53d8\u91cf\uff0c\u6216\u8005\u7f3a\u7701\u60c5\u51b5\u4e0b\u81ea\u52a8\u8f6c\u4e49\u6240\u6709\u53d8\u91cf\u3002Twig\u5bf9\u4e24\u79cd\u65b9\u5f0f\u90fd\u652f\u6301\uff0c\u7f3a\u7701\u5f00\u542f\u7b2c\u4e8c\u79cd\u3002 \u81ea\u52a8\u8f6c\u4e49\u53ea\u6709\u5728escaper\u6269\u5c55\u6fc0\u6d3b\u7684\u60c5\u51b5\u4e0b\u624d\u751f\u6548\u3002 \u4eba\u5de5\u8f6c\u4e49 \u00b6 \u5982\u679c\u542f\u7528\u4e86\u4eba\u5de5\u8f6c\u4e49\uff0c\u90a3\u4e48\u5bf9\u9700\u8981\u8fdb\u884c\u5904\u7406\u7684\u53d8\u91cf\u8fdb\u884c\u8f6c\u4e49\u5c31\u6210\u4e86\u5f00\u53d1\u8005\u7684\u8d23\u4efb\u3002\u90a3\u4e48\u4ec0\u4e48\u9700\u8981\u88ab\u8f6c\u4e49\u5462\uff1f\u7b54\u6848\u662f\u6240\u6709\u4e0d\u4fe1\u4efb\u7684\u53d8\u91cf\u3002\u4eba\u5de5\u8f6c\u4e49\u7684\u65b9\u6cd5\u662f\u628a\u53d8\u91cf\u4f20\u9001\u7ed9 escape filter \u6216\u8005e filter\u8fdb\u884c\u5904\u7406\u3002 {% raw %} {{ user.username|e }} {% endraw %} \u81ea\u52a8\u8f6c\u4e49 \u00b6 \u4e0d\u7ba1\u662f\u5426\u542f\u7528\u4e86\u81ea\u52a8\u8f6c\u4e49\uff0c\u90fd\u53ef\u4ee5\u5229\u7528 autoescape \u6807\u8bb0\u6765\u6807\u8bb0\u6a21\u677f\u4e2d\u7684\u4e00\u6bb5\u5185\u5bb9\u3002 {% raw %} {% autoescape %} Everything will be automatically escaped in this block (using the HTML strategy) {% endautoescape %} {% endraw %} \u7f3a\u7701\u60c5\u51b5\u4e0b\uff0c\u81ea\u52a8\u8f6c\u4e49\u4f7f\u7528html\u7b56\u7565\u3002\u5982\u679c\u8f93\u51fa\u5185\u5bb9\u5c5e\u4e8e\u5176\u4ed6\u4e0a\u4e0b\u6587\uff0c\u5219\u9700\u8981\u663e\u5f0f\u7684\u6307\u5b9a\u5176\u4ed6\u7684\u8f6c\u4e49\u7b56\u7565\uff1a {% raw %} {% autoescape 'js' %} \u8fd9\u4e2a\u533a\u5757\u4e2d\u7684\u6240\u6709\u5b57\u7b26\u90fd\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e49(\u91c7\u7528JS\u7b56\u7565) {% endautoescape %} {% endraw %} \u8f6c\u4e49 {% raw %} \u8ba9Twig\u80fd\u591f\u5ffd\u7565\u4e00\u90e8\u5206\u672c\u5e94\u5f53\u505a\u662fblock\u6216\u8005\u53d8\u91cf\u6765\u5904\u7406\u7684\u4e1c\u897f\uff0c\u662f\u4e2a\u5e38\u89c1\u751a\u81f3\u5fc5\u8981\u7684\u9700\u6c42\u3002\u4f8b\u5982\u60f3\u8981\u4ee5\u539f\u59cb\u5f62\u6001\u8f93\u51fa{{\u8fd9\u6837\u88ab\u8bed\u6cd5\u5360\u7528\u7684\u5173\u952e\u5b57\uff0c\u800c\u4e0d\u60f3\u88ab\u5f53\u505a\u53d8\u91cf\u7684\u5f00\u59cb\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5c0f\u6280\u5de7\u3002 {% endraw %} \u6700\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\u8868\u8fbe\u5f0f\uff1a {% raw %} {{ '{{' }} {% endraw %} \u5b8f \u00b6 \u5728\u7248\u672c1.12\u4e2d\u51fa\u73b0\uff1a\u652f\u6301\u7f3a\u7701\u53c2\u6570\u503c\u3002 \u5b8f\u548c\u548c\u5176\u4ed6\u8bed\u8a00\u4e2d\u7684\u51fd\u6570\u7c7b\u4f3c\u3002\u5b83\u53ef\u4ee5\u590d\u7528\u7ecf\u5e38\u4f7f\u7528\u7684HTML\u7247\u6bb5\u3002 \u4f7f\u7528 macro\u6807\u8bb0 \u53ef\u4ee5\u5b9a\u4e49\u5b8f\u3002\u4e0b\u9762\u662fforms.html\u4e2d\u7684\u4e00\u4e2a\u5c0f\u4f8b\u5b50\uff1a\u5229\u7528\u5b8f\u6e32\u67d3\u4e00\u4e2aform\u5143\u7d20\uff1a {% raw %} {% macro input(name, value, type, size) %} <input type=\"{{ type|default('text') }}\" name=\"{{ name }}\" value=\"{{ value|e }}\" size=\"{{ size|default(20) }}\" /> {% endmacro %} {% endraw %} \u53ef\u4ee5\u5728\u4efb\u4f55\u6a21\u677f\u4e2d\u5b9a\u4e49\u5b8f\uff0c\u7136\u540e\u4f7f\u7528 import\u6807\u8bb0 \u8fdb\u884c\u5bfc\u5165\u5373\u53ef\uff1a {% raw %} {% import \"forms.html\" as forms %} <p>{{ forms.input('username') }}</p> {% endraw %} \u5728\u4ece\u5176\u4ed6\u6a21\u677f\u4e2d\u8fdb\u884c\u5f15\u5165\u7684\u65f6\u5019\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528From\u6807\u8bb0\u4e3a\u5176\u8d4b\u4e88\u522b\u540d\uff1a {% raw %} {% from 'forms.html' import input as input_field %} <dl> <dt>Username</dt> <dd>{{ input_field('username') }}</dd> <dt>Password</dt> <dd>{{ input_field('password', '', 'password') }}</dd> </dl> {% endraw %} \u8fd8\u53ef\u4ee5\u5728\u4e3a\u5b8f\u6307\u5b9a\u7f3a\u7701\u53c2\u6570\uff1a {% raw %} {% macro input(name, value = \"\", type = \"text\", size = 20) %} <input type=\"{{ type }}\" name=\"{{ name }}\" value=\"{{ value|e }}\" size=\"{{ size }}\" /> {% endmacro %} {% endraw %} \u8868\u8fbe\u5f0f \u00b6 Twig\u5141\u8bb8\u4f7f\u7528\u8868\u8fbe\u5f0f\uff0c\u5de5\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\u666e\u901a\u7684PHP\uff0c\u5373\u4f7f\u4f60\u5bf9PHP\u6ca1\u90a3\u4e48\u719f\u6089\uff0c\u4e5f\u53ef\u4ee5\u8f7b\u677e\u9762\u5bf9\u3002 \u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u6309\u9012\u589e\u987a\u5e8f\u6392\u5217\u5982\u4e0b\uff1a b-and, b-xor, b-or, or, and, ==, !=, <, >, >=, <=, in, matches, starts with, ends with, .., +, -, ~, , /, //, %, is, * , |, [], and {% raw %} {% set greeting = 'Hello ' %} {% set name = 'Fabien' %} {{ greeting ~ name|lower }} {# Hello fabien #} {# use parenthesis to change precedence #} {{ (greeting ~ name)|lower }} {# hello fabien #} {% endraw %} \u5e38\u91cf \u00b6 \u57281.5\u4e2d\u65b0\u589e\uff1a\u652f\u6301\u4ee5\u540d\u79f0\u548c\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u54c8\u5e0c\u952e \u8868\u8fbe\u5f0f\u7684\u6700\u7b80\u5355\u5f62\u5f0f\u5c31\u662f\u5e38\u91cf\u4e86\u3002\u4ed6\u662fPHP\u7c7b\u578b\u7684\u4e00\u79cd\u5b9e\u73b0\uff0c\u5305\u542b\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u4ee5\u53ca\u6570\u7ec4\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4f8b\u5b50 \"Hello world\"\uff1a\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u4e4b\u95f4\u7684\u5185\u5bb9\u662f\u5b57\u7b26\u4e32\u3002\u53ef\u4ee5\u5728\u4efb\u4f55\u9700\u8981\u5b57\u7b26\u4e32\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\uff08\u4f8b\u5982\u4f5c\u4e3a\u51fd\u6570\u6216\u8005Filter\u7684\u53c2\u6570\uff0c\u6216\u8005\u5728extend\u4ee5\u53cainclude\u8fc7\u7a0b\u4e2d\u4f7f\u7528\uff09\u3002 42 / 42.23\uff1a\u6574\u6570\u548c\u6d6e\u70b9\u6570\u3002\u6709\u5c0f\u6570\u70b9\u7684\u662f\u6d6e\u70b9\u6570\uff1b\u5426\u5219\u5c31\u662f\u6574\u6570\u3002 [\"foo\", \"bar\"]\uff1a\u6570\u7ec4\u7531\u65b9\u62ec\u53f7\u5305\u542b\u7684\u4e00\u7ec4\u9017\u53f7\u5206\u9694\u7684\u8868\u8fbe\u5f0f\u7ec4\u6210\u3002 {\"foo\": \"bar\"}\uff1a\u540c\u6570\u7ec4\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u662f\u4ee5\u82b1\u62ec\u53f7\u8fdb\u884c\u5305\u88c5\u3002 {% raw %} {# keys as string #} { 'foo': 'foo', 'bar': 'bar' } {# keys as names (equivalent to the previous hash) -- as of Twig 1.5 #} { foo: 'foo', bar: 'bar' } {# keys as integer #} { 2: 'foo', 4: 'bar' } {# keys as expressions (the expression must be enclosed into parentheses) -- as of Twig 1.5 #} { (1 + 1): 'foo', (a ~ 'b'): 'bar' } {% endraw %} true / false\uff1a\u5e03\u5c14\u503c\uff0c\u4f60\u61c2\u7684 null\uff1a\u8868\u660e\u65e0\u7279\u5b9a\u503c\u3002\u5f53\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u65f6\uff0c\u5c31\u4f1a\u8fd4\u56denull\uff0cnone\u662fnull\u7684\u522b\u540d\u3002 \u6570\u7ec4\u548c\u54c8\u5e0c\u53ef\u4ee5\u5d4c\u5957\uff1a {% raw %} {% set foo = [1, {\"foo\": \"bar\"}] %} {% endraw %} \u5b57\u7b26\u4e32\u4f7f\u7528\u5355\u53cc\u5f15\u53f7\u5bf9\u6027\u80fd\u6ca1\u4ec0\u4e48\u5f71\u54cd\uff0c\u4f46\u662f\u53ea\u6709\u53cc\u5f15\u53f7\u624d\u652f\u6301\u5b57\u7b26\u4e32\u5dee\u503c\u3002 \u7b97\u6570\u8fd0\u7b97\u7b26 \u00b6 Twig\u53ef\u4ee5\u8fdb\u884c\u8fd0\u7b97\u3002\u8fd9\u4e2a\u529f\u80fd\u5f88\u5c11\u7528\u5f97\u5230\uff0c\u4e0d\u8fc7\u4e3a\u4e86\u5b8c\u6574\u8d77\u89c1\uff0c\u8fd8\u662f\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002\u76ee\u524d\u652f\u6301\u4e0b\u5217\u64cd\u4f5c\u7b26\uff1a {% raw %} +\uff1a\u52a0\u6cd5 -\uff1a\u51cf\u6cd5 /\uff1a\u9664\u6cd5 %\uff1a\u6c42\u4f59\u3002{{ 11 % 7 }} \u7b49\u4e8e 4. //\uff1a\u6574\u9664\uff0c\u8fd4\u56de\u4e24\u4e2a\u6570\u76f8\u9664\u5f97\u5230\u7684\u7ed3\u679c\u7684\u6574\u6570\u90e8\u5206\u3002{{ 20 // 7 }}\u7b49\u4e8e2 *\uff1a \u76f8\u4e58\uff0c{{2 * 2}} \u8fd4\u56de 4\u3002 **\uff1a\u4e58\u65b9\uff0c{{ 2 3}}`\u7b49\u4e8e8\u3002 {% endraw %} \u903b\u8f91\u8fd0\u7b97\u7b26 \u00b6 \u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u64cd\u4f5c\u7b26\u8fde\u63a5\u591a\u4e2a\u8868\u8fbe\u5f0f\uff1a and\uff1a\u4e0e\u8fd0\u7b97 or\uff1a\u6216\u8fd0\u7b97 not\uff1a\u975e\u8fd0\u7b97 (expr)\uff1a\u4e3a\u8868\u8fbe\u5f0f\u5206\u7ec4 Twig\u8fd8\u652f\u6301\u4f4d\u64cd\u4f5c\uff1a\uff08b-and, b-xor \u4ee5\u53ca b-or\uff09\u3002 \u6bd4\u8f83\u8fd0\u7b97\u7b26 \u00b6 Twig\u652f\u6301\u7684\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff1a==\u3001!=\u3001<\u3001>\u3001>=\u3001<=\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u4f7f\u7528starts with\u6216\u8005end with\uff1a {% raw %} {% if 'Fabien' starts with 'F' %} {% endif %} {% if 'Fabien' ends with 'n' %} {% endraw %} \u5bf9\u4e8e\u590d\u6742\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0cmatches\u64cd\u4f5c\u7b26\u63d0\u4f9b\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u80fd\u529b\uff1a {% raw %} {% if phone matches '/^[\\\\d\\\\.]+$/' %} {% endif %} {% endraw %} \u5305\u542b\u64cd\u4f5c\u7b26 \u00b6 \u64cd\u4f5c\u7b26in\u63d0\u4f9b\u4e86\u5305\u542b\u6d4b\u8bd5\u529f\u80fd\u3002 \u5982\u679c\u53f3\u4fa7\u64cd\u4f5c\u6570\u5305\u542b\u5de6\u4fa7\u7684\u64cd\u4f5c\u6570\uff0c\u5219\u8fd4\u56detrue\uff1a {% raw %} {# returns true #} {{ 1 in [1, 2, 3] }} {{ 'cd' in 'abcde' }} {% endraw %} \u8fd8\u53ef\u4ee5\u53cd\u7740\u7528\uff08not in\uff09\uff1a {% raw %} {% if 1 not in [1, 2, 3] %} {# \u7b49\u4ef7\u4e8e #} {% if not (1 in [1, 2, 3]) %} {% endraw %} \u6d4b\u8bd5\u64cd\u4f5c\u7b26 \u00b6 is\u64cd\u4f5c\u7b26\u7528\u4e8e\u6d4b\u8bd5\u3002\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5\u4e00\u4e2a\u53d8\u91cf\u548c\u8868\u8fbe\u5f0f\uff0c\u53f3\u4fa7\u7684\u64cd\u4f5c\u6570\u5c31\u662f\u6d4b\u8bd5\u7684\u540d\u5b57\uff1a {% raw %} {# \u68c0\u6d4b\u53d8\u91cf\u662f\u4e0d\u662f\u5947\u6570 #} {{ name is odd }} {% endraw %} \u6d4b\u8bd5\u4e5f\u53ef\u4ee5\u63a5\u53d7\u53c2\u6570\uff1a {% raw %} {% if post.status is constant('Post::PUBLISHED') %} {% endraw %} \u53ef\u4ee5\u4f7f\u7528is not\u6765\u8fdb\u884c\u5426\u5b9a\u6d4b\u8bd5\uff1a {% raw %} {% if post.status is not constant('Post::PUBLISHED') %} {# \u7b49\u4ef7\u4e8e #} {% if not (post.status is constant('Post::PUBLISHED')) %} {% endraw %} \u53ef\u4ee5\u53bb test \u9875\u9762\u6765\u4e86\u89e3\u4e00\u4e0b\u5185\u7f6e\u7684\u6d4b\u8bd5\u3002 \u5176\u4ed6\u64cd\u4f5c\u7b26 \u00b6 1.12.0\u4e2d\u52a0\u5165\u4e86\u6269\u5c55\u7684\u4e09\u5143\u64cd\u4f5c\u7b26\u3002 |\uff1a\u7ba1\u9053\u7b26\u53f7\uff0c\u5e94\u7528\u4e00\u4e2afilter ..\uff1a\u4ee5\u5de6\u53f3\u4e24\u4e2a\u64cd\u4f5c\u6570\u4e3a\u57fa\u7840\u751f\u6210\u4e00\u4e2a\u5e8f\u5217 {% raw %} {{ 1..5 }} {# \u7b49\u4ef7\u4e8e #} {{ range(1, 5) }} {% endraw %} {% raw %} - ~\uff1a\u628a\u6240\u6709\u64cd\u4f5c\u6570\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5e76\u8fde\u63a5\u8d77\u6765\u3002{{ \"Hello \" ~ name ~ \"!\" }}\u4f1a\u8fd4\u56de(\u5047\u8bbename\u662f'John')Hello John!\u3002 - .,[]\uff1a\u83b7\u53d6\u5bf9\u8c61\u7684\u5c5e\u6027 - ?:\uff1a\u4e09\u5143\u64cd\u4f5c\u7b26 {% endraw %} {% raw %} {{ foo ? 'yes' : 'no' }} {# \u5728Twig 1.12.0\u4e2d #} {{ foo ?: 'no' }} \u7b49\u540c\u4e8e {{ foo ? foo : 'no' }} {{ foo ? 'yes' }} \u7b49\u540c\u4e8e {{ foo ? 'yes' : '' }} {% endraw %} \u5b57\u7b26\u4e32\u63d2\u503c \u00b6 \u5b57\u7b26\u4e32\u5dee\u503c(#{\u8868\u8fbe\u5f0f})\u5141\u8bb8\u5728\u53cc\u5f15\u53f7\u5185\u7684\u5b57\u7b26\u4e32\u4e2d\u63d2\u5165\u4efb\u4f55\u6709\u6548\u7684\u8868\u8fbe\u5f0f\u3002\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u4f1a\u51fa\u73b0\u5728\u6700\u7ec8\u7684\u5b57\u7b26\u4e32\u4e2d\uff1a {% raw %} {{ \"foo #{bar} baz\" }} {{ \"foo #{1 + 2} baz\" }} {% endraw %} \u7a7a\u767d\u63a7\u5236 \u00b6 twig1.1\u65b0\u589etag\u7ea7\u522b\u7684\u7a7a\u767d\u63a7\u5236 \u8ddfPHP\u7c7b\u4f3c\uff0c\u6a21\u677f\u6807\u8bb0\u540e\u9762\u7684\u7b2c\u4e00\u4e2a\u7a7a\u884c\u4f1a\u88ab\u81ea\u52a8\u5220\u9664\u3002\u6a21\u677f\u5f15\u64ce\u76ee\u524d\u5df2\u7ecf\u4e0d\u518d\u81ea\u52a8\u6e05\u7406\u7a7a\u767d\uff0c\u6240\u6709\u7a7a\u767d\uff08\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u884c\u7b26\u7b49\uff09\u90fd\u4f1a\u539f\u6837\u8f93\u51fa\u3002 \u4f7f\u7528 spaceless \u6807\u8bb0\u53ef\u4ee5\u79fb\u51fahtml\u6807\u8bb0\u4e4b\u95f4\u7684\u7a7a\u767d\uff1a {% raw %} {% spaceless %} <div> <strong>foo bar</strong> </div> {% endspaceless %} {# output will be <div><strong>foo bar</strong></div> #} {% endraw %} \u5728spaceless\u6807\u8bb0\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5728\u6bcf\u4e2a\u6807\u8bb0\u7684\u7ea7\u522b\u63a7\u5236\u7a7a\u767d\u3002\u5728\u6807\u8bb0\u4e0a\u4f7f\u7528\u7a7a\u767d\u63a7\u5236\u4fee\u9970\u7b26\uff0c\u53ef\u4ee5\u6e05\u9664\u524d\u5bfc\u6216\u8ddf\u968f\u7684\u7a7a\u767d\uff1a {% raw %} {% set value = 'no spaces' %} {#- \u53d6\u51fa\u9996\u4f4d\u7a7a\u767d -#} {%- if true -%} {{- value -}} {%- endif -%} {# \u8f93\u51fa 'no spaces' #} {% endraw %} \u4e0a\u9762\u7684\u4f8b\u5b50\u6f14\u793a\u4e86\u7f3a\u7701\u7684\u7a7a\u767d\u63a7\u5236\u4fee\u9970\u7b26\uff0c\u4ee5\u53ca\u5982\u4f55\u79fb\u9664\u6807\u8bb0\u5468\u56f4\u7684\u7a7a\u767d\u3002\u8fd8\u53ef\u4ee5\u53ea\u6e05\u9664Tag\u4e00\u8fb9\u7684\u7a7a\u767d\uff1a {% raw %} {% set value = 'no spaces' %} <li> {{- value }} </li> {# \u8f93\u51fa '<li>no spaces</li>' #} {% endraw %} \u6269\u5c55 \u00b6 Twig\u7684\u6269\u5c55\u5f88\u65b9\u4fbf\u3002 \u5982\u679c\u4f60\u8981\u67e5\u627e\u65b0\u7684\u6807\u8bb0\u3001filter\u6216\u8005\u51fd\u6570\uff0c\u53ef\u4ee5\u6d4f\u89c8\u5b98\u65b9\u7684 \u6269\u5c55\u4ed3\u5e93 \u3002 \u5982\u679c\u60f3\u8981\u521b\u5efa\u81ea\u5df1\u7684\u6269\u5c55\uff0c\u8bf7\u9605\u8bfb\u521b\u5efa \u6269\u5c55\u7ae0\u8282 \u3002 \u4e09\u3001\u5f00\u53d1\u8005\u7684Twig \u00b6 \u672c\u7ae0\u8bb2\u8ff0\u7684\u662fTwig\u7684API\uff0c\u800c\u4e0d\u662fTwig\u7684\u6a21\u677f\u8bed\u8a00\u3002\u8fd9\u4e9b\u5185\u5bb9\u4f1a\u5bf9\u4e3a\u5e94\u7528\u5b9e\u73b0\u6a21\u677f\u63a5\u53e3\u7684\u5de5\u4f5c\u5f88\u6709\u5e2e\u52a9\uff0c\u5bf9\u6a21\u677f\u7684\u5236\u4f5c\u5de5\u4f5c\u5c31\u6ca1\u4ec0\u4e48\u610f\u4e49\u4e86\u3002 \u57fa\u7840 \u00b6 Twig\u7684\u4e2d\u5fc3\u5bf9\u8c61\u4e3a**environment**\uff08\u662fTwig_Environment\u7c7b\u7684\u5b9e\u4f8b\uff09\u3002\u8fd9\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u7528\u4e8e\u5b58\u50a8\u914d\u7f6e\u548c\u6269\u5c55\uff0c\u5e76\u7528\u6765\u4ece\u6587\u4ef6\u7cfb\u7edf\u6216\u8005\u5176\u4ed6\u4f4d\u7f6e\u8f7d\u5165\u6a21\u677f\u3002 \u7edd\u5927\u591a\u6570\u5e94\u7528\u9700\u8981\u5728\u5e94\u7528\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u521b\u5efa\u4e00\u4e2aTwig_Environment\u5bf9\u8c61\uff0c\u7136\u540e\u7528\u5b83\u6765\u52a0\u8f7d\u6a21\u677f\u3002\u5728\u6709\u4e9b\u6848\u4f8b\u4e2d\uff0c\u4f1a\u6709\u591a\u4e2a\u73af\u5883\u540c\u65f6\u5e76\u5b58\uff0c\u7528\u6765\u5904\u7406\u4e0d\u540c\u7684\u914d\u7f6e\u3002 \u4e0b\u9762\u4e3e\u4e2a\u7b80\u5355\u4f8b\u5b50\uff0c\u914d\u7f6eTwig\u6765\u4e3a\u5e94\u7528\u8f7d\u5165\u6a21\u677f\uff1a require_once '/path/to/lib/Twig/Autoloader.php'; Twig_Autoloader::register(); $loader = new Twig_Loader_Filesystem('/path/to/templates'); $twig = new Twig_Environment($loader, array( 'cache' => '/path/to/compilation_cache', )); \u4e0a\u9762\u7684\u4ee3\u7801\u4f1a\u521b\u5efa\u4e00\u4e2a\u7f3a\u7701\u8bbe\u7f6e\u7684\u73af\u5883\uff0c\u7136\u540e\u52a0\u8f7d\u5668\u4f1a\u53bb/path/to/templates/\u76ee\u5f55\u67e5\u627e\u6a21\u677f\u3002\u6709\u4e0d\u540c\u7684\u52a0\u8f7d\u5668\u53ef\u4ee5\u4f7f\u7528\uff0c\u4f60\u53ef\u4ee5\u5b9e\u73b0\u81ea\u5df1\u7684\u52a0\u8f7d\u5668\u7528\u6765\u4ece\u6570\u636e\u5e93\u6216\u8005\u5176\u4ed6\u8d44\u6e90\u4e2d\u83b7\u53d6\u6a21\u677f\u3002 \u6ce8\u610f\uff0cenvironment\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u6570\u7ec4\u9009\u9879\u3002cache\u9009\u9879\u58f0\u660e\u4e86\u4e00\u4e2a\u76ee\u5f55\uff0c\u7528\u4e8e\u5b58\u50a8Twig\u7f16\u8bd1\u7684\u6a21\u7248\uff0c\u4ee5\u51cf\u5c11\u89e3\u6790\u7684\u5f00\u9500\u3002\u8fd9\u79cd\u7f13\u5b58\u8ddf\u4f60\u5e0c\u671b\u5728\u5904\u7406\u6a21\u677f\u8fc7\u7a0b\u4e2d\u52a0\u5165\u7684\u7f13\u5b58\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u5982\u679c\u9700\u8981\u81ea\u884c\u7f13\u5b58\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u7684PHP\u7f13\u5b58\u5e93\u3002 \u8981\u4ece\u73af\u5883\u4e2d\u8c03\u7528\u6a21\u7248\uff0c\u53ea\u9700\u8981\u8c03\u7528 loadTemplate \u51fd\u6570\uff0c\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a Twig_Template \u5b9e\u4f8b $template = $twig->loadTemplate('index.html'); \u8981\u6e32\u67d3\u5e26\u6709\u53d8\u91cf\u7684\u6a21\u7248\uff0c\u8c03\u7528 render \u51fd\u6570 echo $template->render(array('the' => 'variables', 'go' => 'here')); display() \u65b9\u6cd5\u662f\u7528\u4e8e\u76f4\u63a5\u8f93\u51fa\u6a21\u7248\u7684\u5feb\u6377\u65b9\u6cd5\u3002 \u4f60\u8fd8\u53ef\u4ee5\u4e00\u6c14\u5475\u6210\u52a0\u8f7d\u548c\u6e32\u67d3\u6a21\u7248\uff1a echo $twig->render('index.html', array('the' => 'variables', 'go' => 'here')); \u73af\u5883\u9009\u9879 \u00b6 \u5f53\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Twig_Environment\u5b9e\u4f8b\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u9009\u9879\u6570\u7ec4\uff0c\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a $twig = new Twig_Environment($loader, array('debug' => true)); \u53ef\u7528\u7684\u73af\u5883\u9009\u9879\uff1a debug\uff1a\u5e03\u5c14\u503c\uff0c\u8bbe\u7f6e\u4e3atrue\u7684\u65f6\u5019\uff0c\u751f\u6210\u7684\u6a21\u7248\u4f1a\u5e26\u6709\u4e00\u4e2a __toString() \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u7528\u6765\u663e\u793a\u751f\u6210\u7684Node\uff08\u9ed8\u8ba4\u503cfalse\uff09 charset\uff1a\u6a21\u7248\u7684\u5b57\u7b26\u96c6\uff0c\u9ed8\u8ba4\u662futf-8 base_template_class\uff1a\u751f\u6210\u6a21\u7248\u65f6\u4f7f\u7528\u7684\u57fa\u672c\u6a21\u7248\u7c7b\uff0c\u9ed8\u8ba4Twig_Template cache\uff1a\u7528\u4e8e\u5b58\u50a8\u7f13\u5b58\u7684\u7edd\u5bf9\u8def\u5f84\u540d\uff0c\u6216\u8005false\u7528\u4e8e\u7981\u7528\u7f13\u5b58\uff08\u9ed8\u8ba4\u662ffalse\uff09 auto_reload\uff1a\u5e03\u5c14\u503c\uff0c\u5f53\u7528Twig\u5f00\u53d1\u65f6\uff0c\u6e90\u4ee3\u7801\u6709\u4fee\u6539\u65f6\u5c31\u91cd\u65b0\u7f16\u8bd1\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\u662f\u975e\u5e38\u5fc5\u8981\u7684\u3002\u5982\u679c\u4e0d\u63d0\u4f9b\u4e00\u4e2aauto_reload\u9009\u9879\uff0c\u4ed6\u4f1a\u4ecedebug\u9009\u9879\u4e2d\u53d6\u503c\u3002 strict_variables\uff1a\u5e03\u5c14\u503c\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3afalse\uff0cTwig\u4f1a\u5ffd\u7565\u65e0\u6548\u7684\u53d8\u91cf\uff08\u65e0\u6548\u6307\u7684\u662f\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u6216\u8005\u5c5e\u6027/\u65b9\u6cd5\uff09\uff0c\u5e76\u5c06\u5176\u66ff\u6362\u4e3anull\u3002\u5982\u679c\u8fd9\u4e2a\u9009\u9879\u8bbe\u7f6e\u4e3atrue\uff0c\u90a3\u4e48\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\u7684\u65f6\u5019\uff0cTwig\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u9ed8\u8ba4\u503c\u662ffalse autoescape\uff1a\u5b57\u7b26\u4e32\u6216\u8005\u5e03\u5c14\u503c\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3atrue\uff0cHTML\u7684\u81ea\u52a8\u8f6c\u4e49\u4f1a\u9ed8\u8ba4\u5bf9\u6240\u6709\u7684\u6a21\u7248\u8d77\u6548\uff0c\u9ed8\u8ba4\u503c\u662ftrue\u3002\u5728Twig 1.8\u4e2d\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8f6c\u4e49\u7b56\u7565\uff08html\u6216\u8005js\uff0c\u8981\u5173\u95ed\u53ef\u4ee5\u8bbe\u7f6e\u4e3afalse\uff09\u3002\u5728Twig 1.9\u4e2d\u7684\u8f6c\u4e49\u7b56\u7565\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3acss\uff0curl\uff0chtml_attr\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u4e3aPHP\u56de\u8c03\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u6a21\u677f\u6587\u4ef6\u540d\u4e3a\u53c2\u6570\uff0c\u4e14\u5fc5\u987b\u8fd4\u56de\u8981\u4f7f\u7528\u7684\u8f6c\u4e49\u7b56\u7565\uff0c\u56de\u8c03\u547d\u540d\u5e94\u8be5\u907f\u514d\u540c\u5185\u7f6e\u7684\u8f6c\u4e49\u7b56\u7565\u51b2\u7a81\u3002 optimizations\uff1a\u6574\u578b\u503c\uff0c\u4e00\u4e2a\u6807\u8bb0\uff0c\u7528\u4e8e\u51b3\u5b9a\u91c7\u7528\u54ea\u79cd\u4f18\u5316\u65b9\u5f0f\uff08\u9ed8\u8ba4\u662f-1\uff0c\u6fc0\u6d3b\u6240\u6709\u7684\u4f18\u5316\u65b9\u5f0f\uff1b\u8bbe\u7f6e0\u7684\u8bdd\u5c06\u4f1a\u7981\u7528\uff09 \u52a0\u8f7d\u5668 \u00b6 \u52a0\u8f7d\u5668\u8d1f\u8d23\u4ece\u6587\u4ef6\u7cfb\u7edf\u7b49\u8d44\u6e90\u4e2d\u52a0\u8f7d\u6a21\u7248 \u7f16\u8bd1\u7f13\u5b58 \u00b6 \u6240\u6709\u7684\u6a21\u7248\u52a0\u8f7d\u5668\u90fd\u4f1a\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7f13\u5b58\u7f16\u8bd1\u7684\u6a21\u7248\uff0c\u5df2\u88ab\u5c06\u6765\u8c03\u7528\u3002\u7531\u4e8e\u6a21\u7248\u53ea\u7f16\u8bd1\u4e00\u6b21\uff0c\u6240\u4ee5\u5927\u5927\u5730\u63d0\u5347\u4e86Twig\u7684\u901f\u5ea6\uff0c\u5982\u679c\u4f60\u8fd8\u4f7f\u7528\u4e86PHP\u52a0\u901f\u5668\uff0c\u4f8b\u5982APC\uff0c\u6027\u80fd\u7684\u63d0\u5347\u5c06\u4f1a\u66f4\u52a0\u7684\u660e\u663e\u3002\u53c2\u8003\u4e0a\u6587\u63d0\u5230\u7684 Twig_Environment \u4e2d\u7684 cache \u4ee5\u53ca auto_reload \u9009\u9879\u80fd\u591f\u83b7\u5f97\u66f4\u591a\u4fe1\u606f\u3002 \u5185\u7f6e\u52a0\u8f7d\u5668 \u00b6 \u8fd9\u91cc\u6709\u4e00\u4e2aTwig\u63d0\u4f9b\u7684\u5185\u7f6e\u52a0\u8f7d\u5217\u8868\uff1a Twig_Loader_Filesystem 1.10\u65b0\u589eprependPath()\u4ee5\u53ca\u547d\u540d\u7a7a\u95f4\u652f\u6301 Twig_Loader_Filesystem \u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u52a0\u8f7d\u6a21\u7248\u3002\u8fd9\u4e2a\u52a0\u8f7d\u5668\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u7684\u76ee\u5f55\u4e2d\u627e\u5230\u6a21\u7248\uff0c\u4e5f\u662f\u63a8\u8350\u4f7f\u7528\u7684\u52a0\u8f7d\u5668\uff1a $loader = new Twig_Loader_Filesystem($templateDir); \u5b83\u8fd8\u53ef\u4ee5\u4ece\u76ee\u5f55\u6570\u7ec4\u4e2d\u67e5\u627e\u6a21\u7248\uff1a $loader = new Twig_Loader_Filesystem(array($templateDir1, $templateDir2)); \u5728\u8fd9\u79cd\u914d\u7f6e\u4e0b\uff0cTwig\u4f1a\u9996\u5148\u5728$templateDir1\u76ee\u5f55\u4e0b\u67e5\u627e\u6a21\u7248\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\uff0c\u518d\u7ee7\u7eed\u4ecetemplateDir2\u76ee\u5f55\u4e0b\u67e5\u627e\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7 addPath() \u548c prependPath() \u65b9\u6cd5\u6dfb\u52a0\u6216\u8005\u8ffd\u52a0\u8def\u5f84 $loader->addPath($templateDir3); $loader->prependPath($templateDir4); filesystem\u52a0\u8f7d\u5668\u8fd8\u652f\u6301\u547d\u540d\u7a7a\u95f4\u6a21\u7248\u3002\u8fd9\u4e00\u7279\u6027\u5c06\u5141\u8bb8\u7528\u6237\u628a\u6a21\u7248\u653e\u5728\u4e0d\u540c\u7684\u5e26\u6709\u547d\u540d\u7a7a\u95f4\u7684\u76ee\u5f55\u4e0b\u3002 \u5f53\u4f7f\u7528 setPaths() \u3001 addPath() \u4ee5\u53ca prependPath() \u65b9\u6cd5\u65f6\uff0c\u628a\u547d\u540d\u7a7a\u95f4\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u8fdb\u884c\u4f20\u9012\uff08\u5982\u679c\u6ca1\u6709\u4f20\u9012\uff0c\u7f3a\u7701\u547d\u540d\u7a7a\u95f4\u4e3a\"main\"\uff09\uff1a $loader->addPath($templateDir, 'admin'); \u547d\u540d\u7a7a\u95f4\u6a21\u7248\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3c\u4e8e @namespace_name/template_path \u7684\u6ce8\u89e3\u5f62\u5f0f\u6765\u8bbf\u95ee\u3002 $twig->render('@admin/index.html', array()); Twig_Loader_Array Twig_Loader_Array\u4ecePHP\u6570\u7ec4\u4e2d\u52a0\u8f7d\u6a21\u7248 {% raw %} $loader = new Twig_Loader_Array(array( 'index.html' => 'Hello {{ name }}!',)); $twig = new Twig_Environment($loader); echo $twig->render('index.html', array('name' => 'Fabien')); {% endraw %} \u8fd9\u4e2a\u52a0\u8f7d\u5668\u5bf9\u4e8e\u5355\u5143\u6d4b\u8bd5\u975e\u5e38\u6709\u7528\u3002\u8fd9\u4e2a\u52a0\u8f7d\u5668\u9002\u5408\u4e8e\u90a3\u4e9b\u9700\u8981\u628a\u6240\u6709\u7684\u6a21\u7248\u90fd\u5b58\u5728\u5728\u4e00\u4e2a\u5355\u72ecphp\u6587\u4ef6\u7684\u5c0f\u578b\u9879\u76ee\u4e2d\u3002 Twig_Loader_Chain Twig_Loader_Chain\u59d4\u6258\u5176\u5b83\u52a0\u8f7d\u5668\u52a0\u5728\u6a21\u7248 {% raw %} $loader1 = new Twig_Loader_Array(array( 'base.html' => '{% block content %}{% endblock %}', )); $loader2 = new Twig_Loader_Array(array( 'index.html' => '{% extends \"base.html\" %}{% block content %}Hello {{ name }}{% endblock %}', 'base.html' => 'Will never be loaded', )); $loader = new Twig_Loader_Chain(array($loader1, $loader2)); $twig = new Twig_Environment($loader); {% endraw %} \u5f53\u641c\u7d22\u6a21\u7248\u7684\u65f6\u5019\uff0cTwig\u4f1a\u4f9d\u6b21\u5c1d\u8bd5\u6bcf\u4e00\u4e2a\u52a0\u8f7d\u5668\uff0c\u4e00\u65e6\u627e\u5230\u5339\u914d\u6a21\u7248\uff0c\u7acb\u5373\u8fd4\u56de\u3002\u5f53\u6e32\u67d3\u4e0a\u8ff0\u4f8b\u5b50\u4e2d\u7684index.html\u6a21\u7248\u65f6\uff0cTwig\u4f1a\u5728 loader2\u4e2d\u52a0\u8f7d\u5b83\uff0c\u4f46\u662f\u5bf9\u4e8ebase.html\u6a21\u7248\uff0cTwig\u4f1a\u4ece loader2\u4e2d\u52a0\u8f7d\u5b83\uff0c\u4f46\u662f\u5bf9\u4e8ebase.html\u6a21\u7248\uff0cTwig\u4f1a\u4ece loader1\u4e2d\u52a0\u8f7d\u3002 Twig_Loader_Chain\u63a5\u53d7\u4efb\u4f55\u5b9e\u73b0\u4e86Twig_LoaderInterface\u63a5\u53e3\u7684\u52a0\u8f7d\u5668 \u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7addLoader()\u65b9\u6cd5\u6dfb\u52a0\u52a0\u8f7d\u5668 \u521b\u5efa\u81ea\u5df1\u7684\u52a0\u8f7d\u5668 \u00b6 \u5b9e\u73b0\u4e86Twig_LoaderInterface\u63a5\u53e3\u7684\u52a0\u8f7d\u5668\uff1a interface Twig_LoaderInterface { /** * Gets the source code of a template, given its name. * * @param string $name string The name of the template to load * * @return string The template source code */ function getSource($name); /** * Gets the cache key to use for the cache for a given template name. * * @param string $name string The name of the template to load * * @return string The cache key */ function getCacheKey($name); /** * Returns true if the template is still fresh. * * @param string $name The template name * @param timestamp $time The last modification time of the cached template */ function isFresh($name, $time); } \u5982\u679c\u5f53\u524d\u7684\u7f13\u5b58\u6a21\u7248\u8fd8\u662f\u6700\u65b0\u7684\uff0cisFresh()\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56detrue\uff0c\u5426\u5219\u5e94\u8be5\u8fd4\u56de\u6700\u540e\u4e00\u6b21\u7684\u4fee\u6539\u65f6\u95f4\uff0c\u6216\u8005\u76f4\u63a5false Twig 1.11.0\uff0c\u8fd8\u53ef\u4ee5\u5b9e\u73b0Twig_ExistsLoaderInterface\u63a5\u53e3\uff0c\u8ba9\u52a0\u8f7d\u5668\u5728\u540c\u94fe\u5f0f\u52a0\u8f7d\u5668\u534f\u540c\u5de5\u4f5c\u65f6\u7a0d\u5feb\u4e00\u4e9b\u3002 \u4f7f\u7528\u6269\u5c55 \u00b6 Twig\u6269\u5c55\u662f\u6253\u5305\u8d77\u6765\u7684\u4e00\u4e9b\u65b0\u529f\u80fd\u3002\u4f7f\u7528\u6269\u5c55\u5f88\u7b80\u5355\uff0c\u8c03\u7528addExtension()\u65b9\u6cd5\uff1a $twig->addExtension(new Twig_Extension_Sandbox()); Twig\u81ea\u5e26\u4e86\u4ee5\u4e0b\u6269\u5c55\uff1a Twig_Extension_Core\uff1a\u5b9a\u4e49\u4e86Twig\u7684\u6240\u6709\u6838\u5fc3\u7279\u6027 Twig_Extension_Escaper\uff1a\u6dfb\u52a0\u81ea\u52a8\u8f93\u51fa\u8f6c\u4e49\uff0c\u4ee5\u53ca\u4ee3\u7801\u5e93\u53ef\u80fd\u9700\u8981\u7684\u8f6c\u4e49\u6216\u8005\u53cd\u8f6c\u4e49 Twig_Extension_Sandbox\uff1a\u4e3aTwig\u73af\u5883\u6dfb\u52a0\u4e00\u4e2a\u9ed8\u8ba4\u7684\u6c99\u76d2\u6a21\u5f0f\uff0c\u4f7f\u4e0d\u4fe1\u4efb\u7684\u53ef\u4ee5\u5b89\u5168\u7684\u8fd0\u884c Twig_Extension_Profiler\uff1a\u542f\u7528\u5185\u7f6e\u7684Twig profiler Twig_Extension_Optimizer\uff1a\u7f16\u8bd1\u524d\u4f18\u5316\u8282\u70b9\u6811 \u6838\u5fc3\u3001\u8f6c\u4e49\u3001\u4ee5\u53ca\u4f18\u5316\u6269\u5c55\u4e0d\u9700\u8981\u6dfb\u52a0\u5230Twig\u73af\u5883\u4e2d\uff0c\u4ed6\u4eec\u9ed8\u8ba4\u5c31\u662f\u542f\u7528\u7684 \u5185\u7f6e\u6269\u5c55 \u00b6 \u8fd9\u5757\u513f\u5c06\u4f1a\u63cf\u8ff0\u5185\u7f6e\u6269\u5c55\u5e26\u6765\u7684\u65b0\u7279\u6027 \u6838\u5fc3\u6269\u5c55 \u00b6 core\u6269\u5c55\u5b9a\u4e49\u4e86Twig\u7684\u6240\u6709\u6838\u5fc3\u7279\u6027\uff1a Tags Filters Functions Tests \u8f6c\u4e49\u6269\u5c55 \u00b6 escaper\u6269\u5c55\u4e3aTwig\u5e26\u6765\u4e86\u81ea\u52a8\u8f93\u51fa\u8f6c\u4e49\uff0c\u5b83\u5b9a\u4e49\u4e86autoescape\u6807\u8bb0\uff0craw filter\u3002 \u81ea\u884c\u521b\u5efaescaper\u6269\u5c55\u65f6\uff0c\u4f60\u53ef\u4ee5\u6253\u5f00\u6216\u8005\u5173\u95ed\u5168\u5c40\u7684\u8f6c\u4e49\u7b56\u7565\uff1a $escaper = new Twig_Extension_Escaper('html'); $twig->addExtension($escaper); \u5982\u679c\u8bbe\u7f6e\u6210html\uff0c\u6a21\u7248\u4e2d\u6240\u6709\u7684\u53d8\u91cf\u90fd\u4f1a\u8f6c\u4e49\uff0c\u9664\u4e86\u90a3\u4e9braw filter\u8f93\u51fa\u7684 {% raw %} {{ article.to_html|raw }} {% endraw %} \u901a\u8fc7\u4f7f\u7528autoescape\u6807\u8bb0\uff0c\u4f60\u53ef\u4ee5\u6539\u53d8\u8f6c\u79fb\u6a21\u5f0f\uff08\u53c2\u8003 autoescape\u6587\u6863 \uff09 {% raw %} {% autoescape 'html' %} {{ var }} {{ var|raw }} {# var \u4e0d\u4f1a\u88ab\u8f6c\u4e49 #} {{ var|escape }} {# var \u4e0d\u4f1a\u88ab\u518d\u6b21\u8f6c\u4e49 #} {% endautoescape %} {% endraw %} autoescape\u6807\u8bb0\u5bf9\u5305\u542b\u8fdb\u6765\u7684\u6a21\u7248\u65e0\u6548 \u8f6c\u4e49\u89c4\u5219\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\uff1a \u6a21\u677f\u4e2d\u7684\u5e38\u91cf\uff08\u6574\u6570\u3001\u5e03\u5c14\u3001\u6570\u7ec4...\uff09\u4f1a\u76f4\u63a5\u5f53\u505a\u53d8\u91cf\u6216filter\u7684\u53c2\u6570\uff0c\u4e0d\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e49\uff1a {% raw %} {{ \"Twig<br />\" }} {# won't be escaped #} {% set text = \"Twig<br />\" %} {{ text }} {# will be escaped #} {% endraw %} \u5bf9\u4e8e\u4e00\u4e2a\u7ed3\u679c\u662f\u5e38\u91cf\u7684\u8868\u8fbe\u5f0f\uff0c\u6216\u8005\u4e00\u4e2a\u6807\u8bb0\u4e3a\u5b89\u5168\u7684\u53d8\u91cf\u4e5f\u4e0d\u4f1a\u81ea\u52a8\u8f6c\u4e49\uff1a {% raw %} {{ foo ? \"Twig<br />\" : \"<br />Twig\" }} {# won't be escaped #} {% set text = \"Twig<br />\" %} {{ foo ? text : \"<br />Twig\" }} {# will be escaped #} {% set text = \"Twig<br />\" %} {{ foo ? text|raw : \"<br />Twig\" }} {# won't be escaped #} {% set text = \"Twig<br />\" %} {{ foo ? text|escape : \"<br />Twig\" }} {# the result of the expression won't be escaped #} {% endraw %} \u8f6c\u4e49\u53d1\u751f\u5728\u6253\u5370\u4e4b\u524d\uff0cfilter\u4e4b\u540e\uff1a {% raw %} {{ var|upper }} {# \u7b49\u4ef7\u4e8e {{ var|upper|escape }} #} {% endraw %} raw filter\u5e94\u8be5\u5728filter\u94fe\u7684\u6700\u540e\u4f7f\u7528\uff1a {% raw %} {{ var|raw|upper }} {# \u4f1a\u8f6c\u4e49 #} {{ var|upper|raw }} {# \u4e0d\u8f6c\u4e49 #} {% endraw %} \u5982\u679c\u6700\u540e\u4e00\u4e2afilter\u5728\u5f53\u524d\u4e0a\u4e0b\u6587\u4e2d\uff08\u4f8b\u5982html\u6216\u8005js\uff09\u88ab\u6807\u8bb0\u4e3a\u5b89\u5168\uff0cescape\u548cescape('html')\u88abHTML\u6807\u8bb0\u4e3a\u5b89\u5168\uff0cescape('js')\u88abJavaScript\u6807\u8bb0\u4e3a\u5b89\u5168\uff0craw\u5bf9\u6240\u6709\u5185\u5bb9\u90fd\u88ab\u6807\u8bb0\u4e3a\u5b89\u5168\u3002 {% raw %} {% autoescape 'js' %} {{ var|escape('html') }} {# will be escaped for HTML and JavaScript #} {{ var }} {# will be escaped for JavaScript #} {{ var|escape('js') }} {# won't be double-escaped #} {% endautoescape %} {% endraw %} {% raw %} \u6ce8\u610f\u81ea\u52a8\u8f6c\u4e49\u662f\u662f\u5728\u8868\u8fbe\u5f0f\u8fd0\u884c\u4e4b\u540e\u53d1\u751f\uff0c\u56e0\u6b64\u6709\u5c40\u9650\u6027\u7684\u3002\u4f8b\u5982\u5f53\u8fdb\u884c\u8fde\u7eed\u64cd\u4f5c\u65f6\uff0c{{ foo|raw ~ bar }}\u56e0\u4e3a\u8f6c\u4e49\u662f\u6700\u540e\u53d1\u751f\u7684\uff0c\u56e0\u6b64\u65e0\u6cd5\u7ed9\u51fa\u671f\u5f85\u7684\u7ed3\u679c\uff08\u8fd9\u91cc\u7684raw filter\u6ca1\u6709\u4efb\u4f55\u6548\u679c\uff09\u3002 {% endraw %} \u6c99\u76d2\u6269\u5c55 \u00b6 \u6c99\u7bb1\u6269\u5c55\u7528\u4e8e\u8fd0\u884c\u4e0d\u53d7\u4fe1\u4efb\u7684\u4ee3\u7801,\u4f1a\u9650\u5236\u8bbf\u95ee\u4e0d\u5b89\u5168\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002\u6c99\u7bb1\u5b89\u5168\u6027\u7531\u4e00\u4e2a\u7b56\u7565\u5b9e\u4f8b\u6765\u7ba1\u7406\u3002\u7f3a\u7701\u60c5\u51b5\u4e0b\uff0cTwig\u4f1a\u5e26\u6709\u4e00\u4e2a\u7b56\u7565\u7c7b\uff1aTwig_Sandbox_SecurityPolicy\u3002\u8fd9\u4e2a\u7c7b\u5141\u8bb8\u628a\u67d0\u4e9b\u6807\u8bb0\u3001Filter\u3001\u5c5e\u6027\u4ee5\u53ca\u65b9\u6cd5\u653e\u5165\u767d\u540d\u5355\uff1a $tags = array('if'); $filters = array('upper'); $methods = array( 'Article' => array('getTitle', 'getBody'), ); $properties = array( 'Article' => array('title', 'body'), ); $functions = array('range'); $policy = new Twig_Sandbox_SecurityPolicy($tags, $filters, $methods, $properties, $functions); \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5b89\u5168\u7b56\u7565\u53ea\u5141\u8bb8\u4f7f\u7528if\u6807\u7b7e\u548cupper\u8fc7\u6ee4\u5668\u3002\u53e6\u5916\uff0c\u6a21\u7248\u53ea\u80fd\u8c03\u7528 Article \u5bf9\u8c61\u7684 getTitle() \u65b9\u6cd5\u548c getBody() \u65b9\u6cd5\uff0c\u53ea\u80fd\u8bbf\u95ee title \u548c body \u8fd9\u4fe9\u4e2a\u516c\u5171\u5c5e\u6027\u3002\u5176\u5b83\u7684\u90fd\u88ab\u7981\u6b62\u8bbf\u95ee\uff0c\u5982\u679c\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u5219\u4f1a\u629b\u51fa\u4e00\u4e2a Twig_Sandbox_SecurityError \u5f02\u5e38\u3002 \u7b56\u7565\u5bf9\u8c61\u662f\u6c99\u76d2\u6784\u9020\u5668\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a $sandbox = new Twig_Extension_Sandbox($policy); $twig->addExtension($sandbox); \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6c99\u76d2\u6a21\u5f0f\u5904\u4e8e\u7981\u7528\u72b6\u6001\u3002\u5f53\u5305\u542b\u7684\u6a21\u7248\u4e2d\u542b\u6709\u4e0d\u53ef\u4fe1\u7684\u4ee3\u7801\u65f6\uff0c\u4f7f\u7528 sandbox \u6807\u7b7e\u6fc0\u6d3b\u6c99\u76d2\u6a21\u5f0f\u3002 {% raw %} {% sandbox %} {% include 'user.html' %} {% endsandbox %} {% endraw %} \u4f60\u53ef\u4ee5\u901a\u8fc7\u5c06\u6269\u5c55\u6784\u9020\u5668\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u503ctrue\u6765\u5bf9\u6240\u6709\u7684\u6a21\u7248\u542f\u7528\u6c99\u76d2\u6a21\u5f0f\uff1a $sandbox = new Twig_Extension_Sandbox($policy, true); \u7b80\u4ecb\u6269\u5c55 \u00b6 Twig1.18\u65b0\u589e\u7b80\u4ecb\u6269\u5c55 profiler\u6269\u5c55\u4e3aTwig\u6a21\u7248\u5f00\u542f\u4e00\u4e2aprofiler\uff0c\u5b83\u5e94\u8be5\u53ea\u5728\u5f00\u53d1\u673a\u5668\u4e0a\u4f7f\u7528\u3002 $profile = new Twig_Profiler_Profile(); $twig->addExtension(new Twig_Extension_Profiler($profile)); $dumper = new Twig_Profiler_Dumper_Text(); echo $dumper->dump($profile); \u4e00\u4e2aprofile\u5305\u542b\u4e86\u6a21\u7248\uff0c\u5757\u4ee5\u53ca\u5b8f\u6269\u5c55\u7684\u8017\u65f6\u548c\u5185\u5b58\u6d88\u8017\u4fe1\u606f\u3002 \u4f60\u8fd8\u53ef\u4ee5\u4ee5 blackfire.io \u517c\u5bb9\u683c\u5f0fdump\u8fd9\u4e9b\u6570\u636e\u3002 $dumper = new Twig_Profiler_Dumper_Blackfire(); file_put_contents('/path/to/profile.prof', $dumper->dump($profile)); \u4e0a\u4f20\u5e76\u663e\u793a\u5b83(\u5148\u521b\u5efa\u4e2a \u514d\u8d39\u5e10\u53f7 ) blackfire --slot = 7 upload /path/to/profile.prof \u4f18\u5316\u6269\u5c55 \u00b6 optimizer\u6269\u5c55\u4f1a\u5728\u7f16\u8bd1\u6a21\u677f\u4e4b\u524d\u5bf9\u8282\u70b9\u6811\u8fdb\u884c\u4f18\u5316\uff1a $twig->addExtension(new Twig_Extension_Optimizer()); \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684\u4f18\u5316\u90fd\u662f\u542f\u7528\u7684\u3002\u4f60\u4e5f\u53ef\u4ee5\u5728\u6784\u9020\u5668\u4e2d\u4f20\u9012\u60a8\u9700\u8981\u6fc0\u6d3b\u7684\u6269\u5c55\u3002 $optimizer = new Twig_Extension_Optimizer(Twig_NodeVisitor_Optimizer::OPTIMIZE_FOR); $twig->addExtension($optimizer); Twig\u652f\u6301\u4e0b\u5217\u4f18\u5316\uff1a Twig_NodeVisitor_Optimizer\uff1aOPTIMIZE_ALL \u9ed8\u8ba4\u503c\uff0c\u542f\u7528\u6240\u6709\u4f18\u5316 Twig_NodeVisitor_Optimizer\uff1aOPTIMIZE_NONE \u7981\u7528\u6240\u6709\u7684\u4f18\u5316\uff0c\u8fd9\u56de\u51cf\u5c11\u7f16\u8bd1\u65f6\u95f4\uff0c\u4f46\u662f\u4f1a\u589e\u52a0\u6267\u884c\u65f6\u95f4\u548c\u5185\u5b58\u6d88\u8017\u3002 Twig_NodeVisitor_Optimizer::OPTIMIZE_FOR \u5c3d\u53ef\u80fd\u51cf\u5c11loop\u53d8\u91cf\u7684\u521b\u5efa\uff0c\u4ee5\u63d0\u9ad8for\u6807\u8bb0\u7684\u6548\u7387\u3002 Twig_NodeVisitor_Optimizer::OPTIMIZE_RAW_FILTER \u5c3d\u53ef\u80fd\u79fb\u51faraw filter Twig_NodeVisitor_Optimizer::OPTIMIZE_VAR_ACCESS \u5c3d\u53ef\u80fd\u7684\u7b80\u5316\u7f16\u8bd1\u6a21\u7248\u4e2d\u53d8\u91cf\u7684\u521b\u5efa\u548c\u8bbf\u95ee \u5f02\u5e38 \u00b6 Twig\u80fd\u629b\u51fa\u7684\u5f02\u5e38\uff1a Twig_Error\uff1a\u6240\u6709\u5f02\u5e38 Twig_Error_Syntax\uff1a\u8bed\u6cd5\u9519\u8bef Twig_Error_Runtime\uff1a\u8fd0\u884c\u65f6\u9519\u8bef\uff08\u5f53\u524d\u5b9e\u4f8b\u4e2d\u4e0d\u5305\u542b\u67d0\u4e2afilter\uff09 Twig_Error_Loader\uff1a\u6a21\u677f\u8f7d\u5165\u65f6\u7684\u5f02\u5e38 Twig_Sandbox_SecurityError: \u6c99\u76d2\u6a21\u5f0f\u4e0b\u51fa\u73b0\u4e86\u4e0d\u5141\u8bb8\u4f7f\u7528\u7684\u6807\u8bb0\uff0cfilter\u6216\u8005\u8c03\u7528\u4e86\u4e0d\u5141\u8bb8\u8c03\u7528\u7684\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38 \u6269\u5c55Twig \u00b6 \u672c\u7ae0\u63cf\u8ff0\u4e86\u5982\u4f55\u5bf9Twig 1.12\u8fdb\u884c\u6269\u5c55\u3002\u5982\u679c\u4f60\u5728\u4f7f\u7528\u4e00\u4e2a\u65e7\u7248\u672c\uff0c\u8bf7\u79fb\u6b65\u5230 \u8fc7\u5f80\u6587\u6863 \u7ee7\u7eed\u9605\u8bfb\u3002 \u6709\u591a\u91cd\u6269\u5c55Twig\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u52a0\u5165\u989d\u5916\u7684\u6807\u8bb0\u3001Filter\u3001Test\u3001\u64cd\u4f5c\u7b26\u3001\u5168\u5c40\u53d8\u91cf\u4ee5\u53ca\u51fd\u6570\uff0c\u751a\u81f3\u8fd8\u80fd\u5229\u7528Node visitors\u5bf9\u89e3\u6790\u5668\u672c\u8eab\u8fdb\u884c\u6269\u5c55\u3002 \u672c\u6587\u7684\u7b2c\u4e00\u7ae0\u8282\u4f1a\u4ecb\u7ecd\u5982\u4f55\u7b80\u5355\u5730\u6269\u5c55Twig\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u4e0d\u540c\u9879\u76ee\u4e2d\u8fdb\u884c\u590d\u7528\uff0c\u6216\u8005\u5171\u4eab\u7ed9\u4ed6\u4eba\u4f7f\u7528\uff0c\u4f60\u5e94\u8be5\u6309\u7167\u63a5\u4e0b\u6765\u7ae0\u8282\u63cf\u8ff0\u7684\u90a3\u6837\u521b\u5efa\u4e00\u4e2a\u6269\u5c55\u3002 \u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u4f60\u5fc5\u987b\u7406\u89e3\u4e0d\u540c\u6269\u5c55\u70b9\u7684\u533a\u522b\u53ca\u5176\u5e94\u7528\u573a\u666f\u3002 \u9996\u5148\uff0c\u4f60\u9700\u8981\u8bb0\u4f4f\u7684\u662f\uff0cTwig\u6709\u4e24\u4e2a\u4e3b\u8981\u7684\u8bed\u6cd5\u7ed3\u6784\uff1a {% raw %} - {{}}\uff1a\u7528\u6765\u8f93\u51fa\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c - {%%}\uff1a\u7528\u6765\u6267\u884c\u8bed\u53e5 {% endraw %} \u8981\u7406\u89e3\u4e3a\u4ec0\u4e48Twig\u63d0\u4f9b\u8fd9\u4e48\u591a\u6269\u5c55\u70b9\uff0c\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a Lorem ipsum \u751f\u6210\u5668\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3a lipsum \u7684\u6807\u8bb0\uff1a {% raw %} {% lipsum 40 %} {% endraw %} \u8fd9\u6837\u7684\u786e\u53ef\u4ee5\u8d77\u5230\u6548\u679c\uff0c\u4f46\u662f\uff0c\u4f7f\u7528 lipsum \u6807\u8bb0\u7684\u786e\u4e0d\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\uff0c\u56e0\u4e3a\uff1a lipsum\u4e0d\u662f\u4e00\u4e2a\u8bed\u8a00\u7ed3\u6784 \u8fd9\u4e2a\u6807\u8bb0\u8f93\u51fa\u4e86\u4e1c\u897f \u8fd9\u4e2a\u6807\u8bb0\u4e0d\u591f\u7075\u6d3b\uff0c\u4e0d\u80fd\u5728\u8868\u8fbe\u5f0f\u4e2d\u590d\u7528 {% raw %} {{ 'some text' ~ {% lipsum 40 %} ~ 'some more text' }} {% endraw %} \u4e8b\u5b9e\u4e0a\uff0c\u4f60\u5f88\u5c11\u4f1a\u4f7f\u7528\u6807\u8bb0\uff1b\u4e0d\u8fc7\u8fd9\u4e5f\u662f\u4e2a\u597d\u6d88\u606f\u2014\u2014Tag\u7684\u6269\u5c55\u662fTwig\u6269\u5c55\u65b9\u5f0f\u4e2d\u6700\u590d\u6742\u7684\u4e00\u79cd\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u8bd5\u8bd5filter\u7684\u65b9\u5f0f\uff1a {% raw %} {{ 40|lipsum }} {% endraw %} \u518d\u4e00\u6b21\uff0c\u5b83\u8fbe\u5230\u4e86\u6548\u679c\uff0c\u4f46\u662f\u5374\u770b\u4e0a\u53bb\u5f88\u53e4\u602a\u3002filter\u7528\u6765\u628a\u8f93\u5165\u8f6c\u6362\u6210\u8f93\u51fa\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u8f93\u5165\u4e86\u7684\u503c\u662f\u7528\u4e8e\u6307\u793a\u751f\u6210\u5355\u8bcd\u7684\u6570\u91cf\u2014\u2014\u4e5f\u5c31\u662f\u8bf4\uff0c40\u662f\u4e00\u4e2a\u53c2\u6570\uff0c\u4f46\u4e0d\u662f\u6211\u4eec\u8f6c\u6362\u7684\u76ee\u6807\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f7f\u7528 lipsum \u51fd\u6570\uff1a {% raw %} {{ lipsum(40) }} {% endraw %} \u8fd9\u91cc\u6211\u4eec\u4e5f\u6210\u529f\u4e86\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6269\u5c55\u70b9\u7684\u9009\u62e9\u662f\u5408\u9002\u7684\u3002\u73b0\u5728\u53ef\u4ee5\u5728\u4efb\u4f55\u63a5\u53d7\u8868\u8fbe\u5f0f\u7684\u5730\u65b9\u4f7f\u7528\u5b83\u4e86\u3002 {% raw %} {{ 'some text' ~ lipsum(40) ~ 'some more text' }} {% set lipsum = lipsum(40) %} {% endraw %} \u6700\u540e\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5e26\u6709\u65b9\u6cd5\u7684\u5168\u5c40\u5bf9\u8c61\u6765\u751f\u6210\u8fd9\u4e9b\u6587\u5b57\uff1a {% raw %} {{ text.lipsum(40) }} {% endraw %} \u5168\u5c40\u53d8\u91cf \u00b6 \u5168\u5c40\u53d8\u91cf\u548c\u5176\u5b83\u7684\u6a21\u7248\u53d8\u91cf\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5168\u5c40\u53d8\u91cf\u5728\u6240\u6709\u7684\u6a21\u7248\u548c\u5b8f\u5b9a\u4e49\u4e2d\u90fd\u6709\u6548\uff1a $twig = new Twig_Environment($loader); $twig->addGlobal('text', new Text()); \u63a5\u4e0b\u6765\u4f60\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u4f7f\u7528 text \u53d8\u91cf\u4e86\u3002 {% raw %} {{ text.lipsum(40) }} {% endraw %} Filters \u00b6 \u521b\u5efa\u4e00\u4e2afilter\u5c31\u662f\u7b80\u5355\u7684\u7ed9\u4e00\u4e2aPHP\u56de\u8c03\u4e00\u4e2a\u540d\u5b57\uff1a // \u533f\u540d\u51fd\u6570 $filter = new Twig_SimpleFilter('rot13', function ($string) { return str_rot13($string); }); // \u6216\u8005\u4e00\u4e2a\u7b80\u5355\u7684php\u51fd\u6570 $filter = new Twig_SimpleFilter('rot13', 'str_rot13'); // \u6216\u8005\u4e00\u4e2a\u7c7b\u7684\u65b9\u6cd5 $filter = new Twig_SimpleFilter('rot13', array('SomeClass', 'rot13Filter')); \u4f20\u9012\u7ed9 Twig_SimpleFilter \u6784\u9020\u5668\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5c06\u8981\u5728\u6a21\u7248\u4e2d\u4f7f\u7528\u7684filter\u7684\u540d\u5b57\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5173\u4e8e\u8fd9\u4e2a\u53c2\u6570\u7684php\u56de\u8c03\u51fd\u6570\u3002 \u63a5\u4e0b\u6765\uff0c\u5c06filter\u52a0\u5165\u5230\u4f60\u7684Twig\u73af\u5883\u4e2d\uff1a $twig = new Twig_Environment($loader); $twig->addFilter($filter); \u7136\u540e\u5c31\u53ef\u4ee5\u5728\u6a21\u7248\u4e2d\u4f7f\u7528\u4e86\uff1a {% raw %} {{ 'Twig'|rot13 }} {# \u8f93\u51fa\uff1a Gjvt #} {% endraw %} \u5f53Twig\u8c03\u7528\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u7ba1\u9053\u7b26\u5de6\u8fb9\u7684\u503c\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u5e76\u628a\u62ec\u53f7\u4e2d\u7684Filter\u53c2\u6570\u4f5c\u4e3a\u9644\u52a0\u53c2\u6570\u4f20\u9012\u7ed9\u56de\u8c03\u3002 \u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\uff1a {% raw %} {{ 'TWIG'|lower }} {{ now|date('d/m/Y') }} {% endraw %} \u4f1a\u88ab\u7f16\u8bd1\u6210\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a <?php echo strtolower ( 'TWIG' ) ?> <?php echo twig_date_format_filter ( $now , 'd/m/Y' ) ?> Twig_SimpleFilter \u7c7b\u5c06\u9009\u9879\u6570\u7ec4\u4f5c\u4e3a\u5b83\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u3002 $filter = new Twig_SimpleFilter('rot13', 'str_rot13', $options); Filter\u73af\u5883\u611f\u77e5 \u00b6 \u5982\u679c\u8981\u5728filter\u4e2d\u8bbf\u95ee\u5f53\u524d\u7684environment\u5b9e\u4f8b\uff0c\u9700\u8981\u5728option\u4e2d\u8bbe\u7f6eneeds_environment\u4e3atrue\uff1b\u8fd9\u6837Twig\u5c31\u4f1a\u628a\u5f53\u524d\u73af\u5883\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u7ed9filter\uff1a $filter = new Twig_SimpleFilter('rot13', function (Twig_Environment $env, $string) { // \u83b7\u53d6\u5f53\u524d\u5b9e\u4f8b\u7684\u5b57\u7b26\u96c6 $charset = $env->getCharset(); return str_rot13($string); }, array('needs_environment' => true)); Filter\u4e0a\u4e0b\u6587\u611f\u77e5 \u00b6 \u5728Twig\u4e2d\u8bbf\u95ee\u4e0a\u4e0b\u6587\uff0c\u5219\u9700\u8981\u5728option\u4e2d\u8bbe\u7f6eneeds_context\u4e3atrue\uff0cTwig\u5c31\u4f1a\u5427\u5f53\u524d\u4e0a\u4e0b\u6587\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\uff08\u5982\u679c\u8fd8\u8bbe\u7f6e\u4e86needs_environment\u4e3atrue\uff0c\u90a3\u4e48\u5c31\u4f1a\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff09\u8fdb\u884c\u4f20\u9012\uff1a $filter = new Twig_SimpleFilter('rot13', function ($context, $string) { // ... }, array('needs_context' => true)); $filter = new Twig_SimpleFilter('rot13', function (Twig_Environment $env, $context, $string) { // ... }, array('needs_context' => true, 'needs_environment' => true)); \u81ea\u52a8\u8f6c\u4e49 \u00b6 \u5982\u679c\u542f\u7528\u4e86\u81ea\u52a8\u8f6c\u4e49\uff0cfilter\u7684\u8f93\u51fa\u4f1a\u5728\u6253\u5370\u4e4b\u524d\u88ab\u8f6c\u4e49\u3002\u5982\u679c\u4f60\u7684filter\u5c31\u662f\u4f5c\u4e3a\u4e00\u4e2a\u8f6c\u4e49\u5668\uff08\u6216\u8005\u663e\u5f0f\u7684\u8f93\u51faHTML\u4ee5\u53caJavaScript\u4ee3\u7801\uff09\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u8f93\u51fa\u539f\u6587\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528is_safe\u9009\u9879\uff1a $filter = new Twig_SimpleFilter('nl2br', 'nl2br', array('is_safe' => array('html'))); \u53c2\u6570\u53ef\u53d8\u7684Filters \u00b6 Twig1.19\u4e2d\u65b0\u589e\u53ef\u53d8\u53c2\u6570filters \u5f53\u9700\u8981\u4e00\u4e2afilter\u63a5\u6536\u7684\u53c2\u6570\u4e2a\u6570\u53ef\u53d8\u65f6\uff0c\u8bbe\u7f6e is_variadic \u9009\u9879\u4e3atrue\uff1bTwig\u4f1a\u628a\u4f59\u4e0b\u7684\u53c2\u6570\u4f5c\u4e3a\u4e00\u4e2a\u6570\u7ec4\u4f20\u9012\u7ed9filter\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff1a $filter = new Twig_SimpleFilter('thumbnail', function ($file, array $options = array()) { // ... }, array('is_variadic' => true)); \u52a8\u6001Filters \u00b6 \u540d\u5b57\u4e2d\u5e26\u6709\u7279\u6b8a\u5b57\u7b26\u201d*\u201c\u7684filter\u5c31\u662f\u4e00\u4e2a\u52a8\u6001filter\uff1a $filter = new Twig_SimpleFilter('*_path', function ($name, $arguments) { // ... }); \u4e0a\u9762\u5b9a\u4e49\u7684\u52a8\u6001filter\u5c06\u4f1a\u5339\u914d\u4e0b\u8ff0\u5217\u8868\uff1a product_path category_path \u52a8\u6001Filter\u80fd\u591f\u5b9a\u4e49\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u901a\u914d\u7b26\u90e8\u5206\uff1a $filter = new Twig_SimpleFilter('*_path_*', function ($name, $suffix, $arguments) { // ... }); \u8fd9\u4e2aFilter\u80fd\u591f\u63a5\u53d7\u6240\u6709\u7684\u52a8\u6001\u503c\uff0c\u5e76\u6446\u653e\u5728\uff08\u73af\u5883\u548c\u4e0a\u4e0b\u6587\u4e4b\u540e\uff09\u5176\u4ed6\u53c2\u6570\u4e4b\u524d\u3002\u4f8b\u5982\uff0c\u5bf9'foo'|a_path_b()\u7684\u8c03\u7528\uff0c\u4f1a\u4f20\u9012\u8fd9\u4e9b\u53c2\u6570\uff1a('a', 'b', 'foo')\u3002 \u51fd\u6570 \u00b6 \u51fd\u6570\u7684\u5b9a\u4e49\u7c7b\u4f3c\u4e8efilter\uff0c\u4f46\u662f\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a Twig_SimpleFunction \u7684\u5b9e\u4f8b\uff1a $twig = new Twig_Environment($loader); $function = new Twig_SimpleFunction('function_name', function () { // ... }); $twig->addFunction($function); Tests \u00b6 Tests\u7684\u5b9a\u4e49\u548cfilter\u548c\u51fd\u6570\u7684\u5b9a\u4e49\u65b9\u6cd5\u76f8\u540c\uff0c\u4f60\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a Twig_SimpleTest \u5b9e\u4f8b\uff1a $twig = new Twig_Environment($loader); $test = new Twig_SimpleTest('test_name', function () { // ... }); $twig->addTest($test); Tests\u5141\u8bb8\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u5e26\u6709\u903b\u8f91\u5904\u7406\u7684\u5e94\u7528\u6765\u5904\u7406\u5e03\u5c14\u503c\u7684\u6761\u4ef6\u5224\u65ad\u3002\u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u521b\u5efa\u4e00\u4e2aTwig test\u6765\u68c0\u6d4b\u5bf9\u8c61\u662f\u5426\u662f\u2018red\u2019\uff1a $twig = new Twig_Environment($loader); $test = new Twig_SimpleTest('red', function ($value) { if (isset($value->color) && $value->color == 'red') { return true; } if (isset($value->paint) && $value->paint == 'red') { return true; } return false; }); $twig->addTest($test); Test\u51fd\u6570\u53ea\u8fd4\u56detrue/false\u3002 \u5f53\u521b\u5efaTest\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528node_class\u9009\u9879\u6765\u63d0\u4f9b\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u7f16\u5236\u3002\u5982\u679c\u4f60\u7684test\u53ef\u4ee5\u7f16\u8bd1\u6210PHP\u539f\u8bed\uff0c\u8fd9\u4e2a\u529e\u6cd5\u5c31\u5f88\u6709\u7528\u4e86\uff0c\u8fd9\u4e2a\u529e\u6cd5\u5728\u5f88\u591aTwig\u7684\u5185\u7f6eTest\u4e2d\u4f7f\u7528\uff1a $twig = new Twig_Environment($loader); $test = new Twig_SimpleTest( 'odd', null, array('node_class' => 'Twig_Node_Expression_Test_Odd')); $twig->addTest($test); class Twig_Node_Expression_Test_Odd extends Twig_Node_Expression_Test { public function compile(Twig_Compiler $compiler) { $compiler ->raw('(') ->subcompile($this->getNode('node')) ->raw(' % 2 == 1') ->raw(')') ; } } Tags \u00b6 Twig\u6700\u4ee4\u4eba\u6fc0\u52a8\u7684\u7279\u6027\u5c31\u662f\u53ef\u4ee5\u5b9a\u4e49\u65b0\u7684\u8bed\u8a00\u7ed3\u6784\u3002\u8fd9\u4e5f\u662f\u4f60\u9700\u8981\u7406\u89e3\u7684\u5173\u4e8eTwig\u6700\u590d\u6742\u7684\u5173\u4e8e\u5982\u4f55\u5de5\u4f5c\u7684\u7279\u6027\u3002 \u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684set\u6807\u8bb0\uff0c\u8fd9\u4e2a\u6807\u8bb0\u7528\u6765\u5728\u6a21\u677f\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u7b80\u5355\u53d8\u91cf\uff0c\u8fd9\u4e2a\u6807\u8bb0\u7684\u7528\u6cd5\u5982\u4e0b\uff1a {% raw %} {% set name = \"value\" %} {{ name }} {# \u8f93\u51fa value #} {% endraw %} \u4e09\u4e2a\u6b65\u9aa4\u5373\u53ef\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u6807\u8bb0\uff1a \u5b9a\u4e49\u4e00\u4e2aToken\u89e3\u6790\u5668\uff08\u7528\u6765\u89e3\u6790\u6a21\u677f\u4ee3\u7801\uff09 \u5b9a\u4e49\u4e00\u4e2a\u8282\u70b9\u7c7b(\u7528\u4e8e\u628a\u89e3\u6790\u7684\u7ed3\u679c\u8f6c\u6362\u6210PHP) \u6ce8\u518c\u8fd9\u4e2a\u6807\u8bb0 \u6ce8\u518c\u4e00\u4e2a\u65b0\u7684\u6807\u8bb0 \u00b6 \u7b80\u5355\u7684\u8c03\u7528 Twig_Environment \u5b9e\u4f8b\u7684 addTokenParser \u65b9\u6cd5\u5373\u53ef\u6dfb\u52a0\u4e00\u4e2a\u6807\u8bb0\uff1a $twig = new Twig_Environment($loader); $twig->addTokenParser(new Project_Set_TokenParser()); \u5b9a\u4e49\u4e00\u4e2atoken\u89e3\u6790\u5668 \u00b6 \u6765\u770b\u4e0b\u4ee3\u7801\u5b9e\u4f8b\uff1a class Project_Set_TokenParser extends Twig_TokenParser { public function parse(Twig_Token $token) { $parser = $this->parser; $stream = $parser->getStream(); $name = $stream->expect(Twig_Token::NAME_TYPE)->getValue(); $stream->expect(Twig_Token::OPERATOR_TYPE, '='); $value = $parser->getExpressionParser()->parseExpression(); $stream->expect(Twig_Token::BLOCK_END_TYPE); return new Project_Set_Node($name, $value, $token->getLine(), $this->getTag()); } public function getTag() { return 'set'; } } getTag() \u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u6211\u4eec\u8981\u89e3\u6790\u7684\u6807\u8bb0\uff0c\u8fd9\u91cc\u8fd4\u56de\u7684\u5c31\u662f set . parse() \u65b9\u6cd5\u5728\u89e3\u6790\u5668\u9047\u5230 set \u6807\u8bb0\u7684\u65f6\u5019\u5c31\u4f1a\u88ab\u8c03\u7528\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u8fd4\u56de\u4e00\u4e2a Twig_Node \u5b9e\u4f8b\u7528\u4e8e\u663e\u793a\u8fd9\u4e2a\u7ed3\u70b9\u3002 Token\u6d41\uff08$this->parser->getStream()\uff09\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u65b9\u6cd5\uff0c\u7b80\u5316\u4e86\u89e3\u6790\u8fc7\u7a0b\uff1a getCurrent()\uff1a\u4ece\u6d41\u4e2d\u83b7\u53d6\u5f53\u524d\u7684token next()\uff1a\u79fb\u52a8\u5230\u6d41\u4e2d\u7684\u4e0b\u4e00\u4e2aToken\uff0c\u5e76\u8fd4\u56de\u4e4b\u524d\u7684\u4e00\u4e2a test( type), test( type), test( value\uff09\u6216\u8005test($type, $value)\uff1a\u5224\u65ad\u5f53\u524dtoken\u662f\u4e0d\u662f\u67d0\u79cd\u7c7b\u578b\u6216\u503c\uff08\u6216\u540c\u65f6\u6ee1\u8db3\uff09\u3002\u503c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5305\u542b\u5f88\u591a\u503c\u7684\u6570\u7ec4\u3002 expect($type[, $value[, $message]])\uff1a\u5982\u679c\u5f53\u524dtoken\u4e0d\u662f\u6307\u5b9a\u7684\u7c7b\u578b\u6216\u503c\uff0c\u5c31\u7ed9\u51fa\u4e00\u4e2a\u8bed\u6cd5\u9519\u8bef\u3002\u5426\u5219\uff0c\u5982\u679c\u503c\u548c\u7c7b\u578b\u90fd\u6b63\u786e\uff0c\u5219\u8fd4\u56de\u5f53\u524dtoken\uff0c\u5e76\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2aToken\u3002 look()\uff1a\u67e5\u770b\u4f46\u4e0d\u4f7f\u7528\u4e0b\u4e00\u4e2atoken \u50cfset\u6807\u8bb0\u8fd9\u6837\uff0c\u901a\u8fc7\u8c03\u7528 parseExpression() \u5b8c\u6210\u5bf9\u8868\u8fbe\u5f0f\u7684\u89e3\u6790\u3002 \u5b9a\u4e49\u4e00\u4e2a\u8282\u70b9 \u00b6 Project_Set_Node\u7c7b\u5f88\u7b80\u5355\uff1a class Project_Set_Node extends Twig_Node { public function __construct($name, Twig_Node_Expression $value, $line, $tag = null) { parent::__construct(array('value' => $value), array('name' => $name), $line, $tag); } public function compile(Twig_Compiler $compiler) { $compiler ->addDebugInfo($this) ->write('$context[\\''.$this->getAttribute('name').'\\'] = ') ->subcompile($this->getNode('value')) ->raw(\";\\n\") ; } } \u7f16\u8bd1\u5668\u5b9e\u73b0\u4e86\u4e00\u5957\u63a5\u53e3\u548c\u65b9\u6cd5\u7528\u4e8e\u5e2e\u52a9\u5f00\u53d1\u8005\u751f\u6210\u7f8e\u89c2\u6613\u8bfb\u7684PHP\u4ee3\u7801\uff1a subcompile()\uff1a\u7f16\u8bd1\u4e00\u4e2a\u7ed3\u70b9 raw()\uff1a\u539f\u6587\u8f93\u51fa\u5b57\u7b26\u4e32 write()\uff1a\u8f93\u51fa\u9996\u884c\u7f29\u8fdb\u7684\u5b57\u7b26\u4e32 string()\uff1a\u8f93\u51fa\u5f15\u7528\u5b57\u7b26 repr()\uff1a\u8f93\u51faphp\u7ed3\u679c\u503c addDebugInfo()\uff1a\u628a\u4e0e\u5f53\u524d\u8282\u70b9\u76f8\u5173\u7684\u539f\u59cb\u6a21\u677f\u6587\u4ef6\u5f53\u4f5c\u6ce8\u91ca\u6dfb\u52a0\u8fdb\u6765 indent()\uff1a\u7f29\u8fdb\u751f\u6210\u7684\u4ee3\u7801 outdent()\uff1a\u4f38\u51fa\u751f\u6210\u7684\u4ee3\u7801 \u521b\u5efa\u4e00\u4e2a\u6269\u5c55 \u00b6 \u5f00\u53d1\u6269\u5c55\u7684\u4e00\u4e2a\u4e3b\u8981\u76ee\u7684\u53ef\u80fd\u5c31\u662f\u4e3a\u4e86\u5c06\u7ecf\u5e38\u4f7f\u7528\u7684\u529f\u80fd\u89c4\u8303\u79f0\u4e00\u4e2a\u53ef\u590d\u7528\u7684\u7c7b\uff0c\u6bd4\u5982\u8bf4\uff0c\u56fd\u9645\u5316\u652f\u6301\u3002\u4e00\u4e2a\u6269\u5c55\u53ef\u4ee5\u6307\u5b9a\u6807\u8bb0\u3001Filter\u3001Test\u3001\u8fd0\u7b97\u7b26\u3001\u5168\u5c40\u53d8\u91cf\u3001\u51fd\u6570\u4ee5\u53caNode visitors\u3002 \u6269\u5c55\u8fd8\u53ef\u4ee5\u5206\u79bb\u7f16\u8bd1\u65f6\u548c\u8fd0\u884c\u65f6\u7684\u4ee3\u7801\uff0c\u52a0\u5feb\u4ee3\u7801\u7684\u8fd0\u884c\u901f\u5ea6\u3002 \u5927\u591a\u6570\u65f6\u5019\uff0c\u521b\u5efa\u4e00\u4e2a\u5355\u72ec\u7684\u5305\u542b\u6240\u6709\u6807\u8bb0\u548cfilters\u7684\u6269\u5c55\u5c06\u5bf9\u4f60\u7684\u9879\u76ee\u5f88\u6709\u7528\u3002 \u4e00\u4e2a\u6269\u5c55\u5c31\u662f\u4e00\u4e2a\u5b9e\u73b0\u4e86\u4e0b\u9762\u8fd9\u4e2a\u63a5\u53e3\u7684\u7c7b\uff1a interface Twig_ExtensionInterface { /** * Initializes the runtime environment. * * This is where you can load some file that contains filter functions for instance. * * @param Twig_Environment $environment The current Twig_Environment instance * * @deprecated since 1.23 (to be removed in 2.0), implement Twig_Extension_InitRuntimeInterace instead */ function initRuntime(Twig_Environment $environment); /** * Returns the token parser instances to add to the existing list. * * @return array An array of Twig_TokenParserInterface or Twig_TokenParserBrokerInterface instances */ function getTokenParsers(); /** * Returns the node visitor instances to add to the existing list. * * @return array An array of Twig_NodeVisitorInterface instances */ function getNodeVisitors(); /** * Returns a list of filters to add to the existing list. * * @return array An array of filters */ function getFilters(); /** * Returns a list of tests to add to the existing list. * * @return array An array of tests */ function getTests(); /** * Returns a list of functions to add to the existing list. * * @return array An array of functions */ function getFunctions(); /** * Returns a list of operators to add to the existing list. * * @return array An array of operators */ function getOperators(); /** * Returns a list of global variables to add to the existing list. * * @return array An array of global variables * * @deprecated since 1.23 (to be removed in 2.0), implement Twig_Extension_GlobalsInterface instead */ function getGlobals(); /** * Returns the name of the extension. * * @return string The extension name */ function getName(); } \u4e3a\u4e86\u4fdd\u6301\u6269\u5c55\u7c7b\u7684\u6574\u6d01\u4e0e\u7a33\u5b9a\uff0c\u8fd8\u53ef\u4ee5\u53ea\u7ee7\u627f\u5185\u7f6e\u7684 Twig_Extension \u7c7b\u800c\u4e0d\u9700\u8981\u5b9e\u73b0\u6240\u6709\u7684\u63a5\u53e3\u3002\u91c7\u7528\u8fd9\u79cd\u8be5\u65b9\u5f0f\u7684\u8bdd\uff0c\u4f60\u53ea\u9700\u8981\u5b9e\u73b0 getName() \u65b9\u6cd5\u3002 getName() \u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u8fd9\u4e2a\u6269\u5c55\u7684\u552f\u4e00\u6807\u8bc6\u7b26 \u73b0\u5728\u6211\u4eec\u6765\u662f\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u6269\u5c55\uff1a class Project_Twig_Extension extends Twig_Extension { public function getName() { return 'project'; } } Twig\u4e0d\u5173\u5fc3\u4f60\u7684\u6269\u5c55\u5b58\u5728\u4f55\u5904\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u6269\u5c55\u90fd\u9700\u8981\u663e\u793a\u7684\u6ce8\u518c\u3002\u901a\u8fc7\u8c03\u7528 Environment \u5bf9\u8c61\u7684 addExtension() \u65b9\u6cd5\u5373\u53ef\u6ce8\u518c\u4e00\u4e2a\u6269\u5c55\u3002 $twig = new Twig_Environment($loader); $twig->addExtension(new Project_Twig_Extension()); \u5168\u5c40\u53d8\u91cf \u00b6 \u901a\u8fc7\u8c03\u7528 getGlobals() \u65b9\u6cd5\u5373\u53ef\u4ee5\u5728\u6269\u5c55\u4e2d\u6ce8\u518c\u5168\u5c40\u53d8\u91cf\uff1a class Project_Twig_Extension extends Twig_Extension { public function getGlobals() { return array( 'text' => new Text(), ); } // ... } \u51fd\u6570 \u00b6 \u901a\u8fc7\u8c03\u7528 getFunctions() \u65b9\u6cd5\u5373\u53ef\u4ee5\u5728\u6269\u5c55\u4e2d\u6ce8\u518c\u51fd\u6570\uff1a class Project_Twig_Extension extends Twig_Extension { public function getFunctions() { return array( new Twig_SimpleFunction('lipsum', 'generate_lipsum'), ); } // ... } Filters \u00b6 \u4e3a\u4e86\u5c06filter\u6dfb\u52a0\u5230\u4e00\u4e2a\u6269\u5c55\u4e2d\uff0c\u4f60\u9700\u8981\u8986\u5199 getFilters() \u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u6dfb\u52a0\u5230Twig\u73af\u5883\u7684filters\u6570\u7ec4\uff1a class Project_Twig_Extension extends Twig_Extension { public function getFilters() { return array( new Twig_SimpleFilter('rot13', 'str_rot13'), ); } // ... } \u6807\u8bb0 \u00b6 \u901a\u8fc7\u8986\u5199 getTokenParsers() \u65b9\u6cd5\u5c31\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6807\u8bb0\u6dfb\u52a0\u5230\u4e00\u4e2a\u6269\u5c55\u4e2d\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u5929\u6781\u5230Twig\u73af\u5883\u7684tags\u6570\u7ec4\uff1a class Project_Twig_Extension extends Twig_Extension { public function getTokenParsers() { return array(new Project_Set_TokenParser()); } // ... } \u64cd\u4f5c\u7b26 \u00b6 getOperators() \u65b9\u6cd5\u7528\u6765\u65b0\u589e\u65b0\u7684\u64cd\u4f5c\u7b26\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u662f\u5982\u4f55\u6dfb\u52a0!\uff0c||\u4ee5\u53ca&&\u64cd\u4f5c\u7b26\uff1a class Project_Twig_Extension extends Twig_Extension { public function getOperators() { return array( array( '!' => array('precedence' => 50, 'class' => 'Twig_Node_Expression_Unary_Not'), ), array( '||' => array('precedence' => 10, 'class' => 'Twig_Node_Expression_Binary_Or', 'associativity' => Twig_ExpressionParser::OPERATOR_LEFT), '&&' => array('precedence' => 15, 'class' => 'Twig_Node_Expression_Binary_And', 'associativity' => Twig_ExpressionParser::OPERATOR_LEFT), ), ); } // ... } Tests \u00b6 getTests()\u65b9\u6cd5\u7528\u6765\u6dfb\u52a0\u65b0\u7684Test\u51fd\u6570\uff1a class Project_Twig_Extension extends Twig_Extension { public function getTests() { return array( new Twig_SimpleTest('even', 'twig_test_even'), ); } // ... }","title":"\"Drupal8\u6a21\u677f\u5f15\u64ce-twig\""},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_1","text":"Twig\u662f\u4e00\u4e2a\u9ad8\u6548\u3001\u5b89\u5168\u5e76\u53ef\u6269\u5c55\u7684PHP\u6a21\u677f\u5f15\u64ce\u3002 \u5982\u679c\u4f60\u5177\u6709Smarty, Django\u6216\u8005Jinja\u8fd9\u517b\u7684\u57fa\u4e8e\u6587\u672c\u7684\u6a21\u677f\u8bed\u8a00\u7684\u7ecf\u9a8c\uff0c\u90a3\u4e48\u4f60\u5bf9Twig\u4f1a\u611f\u89c9\u4e00\u89c1\u5982\u6545\u3002\u5728\u9075\u5faaPHP\u7406\u5ff5\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u63d0\u4f9b\u4e86\u5177\u5907\u5f3a\u5927\u529f\u80fd\u7684\u6a21\u677f\u73af\u5883\uff0c\u4e0d\u8bba\u662f\u5bf9\u5f00\u53d1\u8005\u8fd8\u662f\u8bbe\u8ba1\u8005\u6765\u8bf4\uff0c\u8fd9\u4e00\u5f15\u64ce\u90fd\u5177\u6709\u826f\u597d\u7684\u53ef\u7528\u6027\u3002 \u5173\u952e\u7279\u6027\uff1a \u5feb\u901f\uff1aTwig\u628a\u6a21\u677f\u7f16\u8bd1\u6210\u4e3a\u4f18\u5316\u540e\u7684PHP\u4ee3\u7801\u3002\u76f8\u5bf9\u666e\u901aPHP\u4ee3\u7801\u6765\u8bf4\uff0c\u5176\u989d\u5916\u5f00\u9500\u975e\u5e38\u8f7b\u5fae\u3002 \u5b89\u5168\uff1aTwig\u4f1a\u4f7f\u7528\u4e00\u4e2a\u6c99\u7bb1\u6a21\u5f0f\u6765\u8fd0\u884c\u4e0d\u4fe1\u4efb\u7684\u6a21\u677f\u4ee3\u7801\u3002\u8fd9\u4f7f\u5f97Twig\u53ef\u4ee5\u5728\u7528\u6237\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u8bbe\u8ba1\u7684\u5e94\u7528\u4e2d\u5de5\u4f5c\u826f\u597d\u3002 \u5f39\u6027\uff1aTwig\u8bd5\u7528\u4e86\u5f39\u6027\u7684\u8bcd\u6cd5\u548c\u8bed\u6cd5\u5206\u6790\u5668\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u5b9a\u4e49\u81ea\u5df1\u7684\u6807\u8bb0\u548c\u8fc7\u6ee4\uff0c\u5e76\u521b\u5efa\u81ea\u5df1\u7684DSL\u3002","title":"\u4e00\u3001\u7b80\u4ecb"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_2","text":"Twig\u9700\u8981\u7684\u6700\u5c0f\u8fd0\u884c\u73af\u5883\u4e3aPHP 5.2.4","title":"\u9700\u6c42"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_3","text":"\u63a8\u8350\u4f7f\u7528Composer\u5b89\u88c5Twig\uff1a composer require \"twig/twig:~1.0\"","title":"\u5b89\u88c5"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#api","text":"\u672c\u8282\u5bf9Twig PHP API\u505a\u4e00\u4e2a\u7b80\u5355\u4ecb\u7ecd\u3002 require_once '/path/to/vendor/autoload.php'; $loader = new Twig_Loader_Array( 'index' => 'Hello {{ name }}!', ); $twig = new Twig_Environment($loader); echo $twig->render('index', array('name' => 'Fabien')); Twig\u4f7f\u7528\u4e00\u4e2a\u52a0\u8f7d\u5668(Twig_Loader_Array)\u6765\u5b9a\u4f4d\u6a21\u677f\u6587\u4ef6\uff0c\u4f7f\u7528\u4e00\u4e2a\u73af\u5883(Twig_Environment)\u6765\u5b58\u50a8\u914d\u7f6e\uff0crender()\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u6307\u5b9a\u4e86\u6a21\u677f\uff0c\u540e\u9762\u7684\u53c2\u6570\u5219\u4e3a\u6e32\u67d3\u63d0\u4f9b\u4e86\u53d8\u91cf\u3002 \u6a21\u677f\u4e00\u822c\u662f\u4fdd\u5b58\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u6240\u4ee5Twig\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u52a0\u8f7d\u5668\uff1a $loader = new Twig_Loader_Filesystem('/path/to/templates'); $twig = new Twig_Environment($loader, array( 'cache' => '/path/to/compilation_cache', )); echo $twig->render('index.html', array('name' => 'Fabien')); \u5982\u679c\u6ca1\u6709\u4f7f\u7528 Composer\uff0c\u53ef\u4ee5\u4f7f\u7528 Twig \u7684\u5185\u7f6e\u52a0\u8f7d\u5668\uff1a require_once '/path/to/lib/Twig/Autoloader.php'; Twig_Autoloader::register();","title":"\u57fa\u7840API\u7528\u6cd5"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#twig","text":"\u672c\u6587\u63cf\u8ff0\u4e86\u6a21\u677f\u5f15\u64ce\u4e2d\u6d89\u53ca\u5230\u7684\u8bed\u6cd5\u548c\u8bed\u4e49\uff0c\u5bf9Twig\u6a21\u677f\u7684\u8bbe\u8ba1\u4f1a\u5f88\u6709\u5e2e\u52a9\u3002","title":"\u4e8c\u3001\u6a21\u677f\u8bbe\u8ba1\u8005\u7684Twig"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_4","text":"\u6a21\u677f\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6587\u672c\u6587\u4ef6\u3002\u5b83\u80fd\u591f\u751f\u6210\u4efb\u4f55\u6587\u672c\u683c\u5f0f\uff08HTML, XML, CSV, LaTeX\u7b49\uff09\u3002\u4ed6\u6ca1\u6709\u56fa\u5b9a\u7684\u6269\u5c55\u540d\uff0chtml\u3001xml\u90fd\u6ca1\u5173\u7cfb\u3002 \u6a21\u677f\u4e2d\u5305\u542b\u53d8\u91cf\u548c\u8868\u8fbe\u5f0f\u5728\u6a21\u677f\u88ab\u5904\u7406\u65f6\u4f1a\u88ab\u66ff\u6362\u4e3a\u771f\u5b9e\u7684\u503c\uff0ctags\u5219\u5bf9\u6a21\u677f\u7684\u903b\u8f91\u8fdb\u884c\u63a7\u5236\u3002 \u4e0b\u9762\u7528\u4e00\u4e2a\u5c0f\u4f8b\u5b50\u5c55\u793a\u4e00\u4e9b\u57fa\u7840\u5185\u5bb9\uff0c\u5f53\u7136\uff0c\u540e\u9762\u4f1a\u505a\u8fdb\u4e00\u6b65\u7684\u6df1\u5165\u3002 <!DOCTYPE html> <html> <head> <title>My Webpage</title> </head> <body> <ul id=\"navigation\"> {% raw %} {% for item in navigation %} <li><a href=\"{{ item.href }}\">{{ item.caption }}</a></li> {% endfor %} </ul> {% endraw %} <h1>My Webpage</h1> {% raw %} {{ a_variable }} {% endraw %} </body> </html> {% raw %} \u4e0a\u9762\u4ee3\u7801\u4e2d\u6709\u4e24\u79cd\u5206\u9694\u7b26\uff1a{% ... %}\u548c{{ ... }}\u3002\u7b2c\u4e00\u79cd\u7528\u4e8e\u6267\u884cfor\u5faa\u73af\u4e4b\u7c7b\u7684\u8bed\u53e5\uff0c\u7b2c\u4e8c\u79cd\u7528\u4e8e\u8f93\u51fa\u8868\u8fbe\u5f0f\u7ed3\u679c\u3002 {% endraw %}","title":"\u6982\u8981"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_5","text":"\u5e94\u7528\u4f1a\u628a\u53d8\u91cf\u4f20\u9012\u7ed9\u6a21\u677f\u8fdb\u884c\u5904\u7406\u3002\u53d8\u91cf\u81ea\u8eab\u4e5f\u53ef\u4ee5\u62e5\u6709\u5c5e\u6027\u6216\u5143\u7d20\u4f9b\u5916\u90e8\u8bbf\u95ee\u3002\u53d8\u91cf\u7684\u5177\u4f53\u5f62\u6001\u53d6\u51b3\u4e8e\u63d0\u4f9b\u53d8\u91cf\u7684\u5e94\u7528\u3002 \u53ef\u4ee5\u5229\u7528\u53e5\u70b9\uff08.\uff09\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\uff08\u76f8\u5f53\u4e8ePHP\u5bf9\u8c61\u7684\u5c5e\u6027\u6216\u65b9\u6cd5\uff0c\u6216\u8005PHP\u6570\u7ec4\u7684\u6210\u5458\uff09\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0b\u6807\u8bed\u6cd5\uff08[]\uff09\uff1a {% raw %} {{ foo.bar }} {{ foo['bar'] }} {% endraw %} \u5f53\u5c5e\u6027\u540d\u5b57\u4e2d\u5305\u542b\u4e86\u7279\u522b\u5b57\u7b26\uff08\u4f8b\u5982\u201c-\u201d\u4f1a\u88ab\u5f53\u505a\u51cf\u53f7\u5904\u7406\uff09\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528attribute\u51fd\u6570\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\uff1a {# \u7b49\u4ef7\u4e8e\u4e0d\u80fd\u5de5\u4f5c\u7684\uff1afoo.data-foo #} {% raw %} {{ attribute(foo, 'data-foo') }} {% endraw %} \u5927\u62ec\u53f7\u662f\u6253\u5370\u6307\u4ee4\uff0c\u800c\u4e0d\u662f\u53d8\u91cf\u7684\u7ec4\u6210\u90e8\u5206\u3002\u5f53\u5728tag\u4e2d\u8bbf\u95ee\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u5728Tag\u4e2d\u8bbf\u95ee\u53d8\u91cf\u7684\u65f6\u5019\u4f7f\u7528\u8fd9\u79cd\u8bed\u6cd5\u3002 \u5728strict_variables\u9009\u9879\u4e3afalse\u7684\u65f6\u5019\uff0c\u5982\u679c\u53d8\u91cf\u6216\u5c5e\u6027\u4e0d\u5b58\u5728\uff0c\u4f1a\u8fd4\u56denull\uff1b\u800c\u5982\u679c\u8be5\u9009\u9879\u8bbe\u7f6e\u4e3atrue\uff0c\u8fd9\u79cd\u60c5\u51b5\u5c31\u4f1a\u629b\u51fa\u9519\u8bef","title":"\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_6","text":"foo.bar\u5728PHP\u8fd9\u4e00\u5c42\u6b21\u505a\u4e86\u5982\u4e0b\u4e8b\u60c5\uff1a \u68c0\u67e5foo\u662f\u4e0d\u662f\u6570\u7ec4\uff0cbar\u662f\u4e0d\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u6709\u6548\u5143\u7d20\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5bar\u662f\u4e0d\u662f\u6709\u6548\u7684\u5c5e\u6027\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5bar\u662f\u4e0d\u662f\u6709\u6548\u7684\u65b9\u6cd5\uff08\u5373\u4f7fbar\u662f\u6784\u9020\u5668\u2014\u2014\u6240\u4ee5\u8bf7\u4f7f\u7528__construct()\uff09\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5getBar\u662f\u4e0d\u662f\u6709\u6548\u7684\u65b9\u6cd5\uff1b \u5982\u679c\u4e0d\u662f\uff0c\u4e14foo\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u68c0\u67e5isBar\u662f\u4e0d\u662f\u6709\u6548\u7684\u65b9\u6cd5\uff1b \u5982\u679c\u90fd\u4e0d\u662f\uff0c\u8fd4\u56denull\u3002 \u53e6\u4e00\u65b9\u9762\uff0cfoo['bar']\u53ea\u5bf9PHP\u6570\u7ec4\u5de5\u4f5c - \u68c0\u67e5foo\u662f\u4e0d\u662f\u4e00\u4e2a\u6570\u7ec4\uff0cbar\u662f\u4e0d\u662f\u4e00\u4e2a\u6709\u6548\u5143\u7d20\uff1b - \u5982\u679c\u4e0d\u662f\uff0c\u8fd4\u56denull\u3002 \u5982\u679c\u8981\u8bbf\u95ee\u53d8\u91cf\u7684\u52a8\u6001\u5c5e\u6027\uff0c\u5e94\u8be5\u4f7f\u7528attribute()\u51fd\u6570\u3002","title":"\u5b9e\u73b0"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_7","text":"\u6a21\u677f\u4e2d\u968f\u65f6\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684\u53d8\u91cf\uff1a _self\uff1a\u5f53\u524d\u7684\u6a21\u677f\uff1b _context\uff1a\u5f53\u524d\u4e0a\u4e0b\u6587 _charset\uff1a\u5f53\u524d\u7f16\u7801","title":"\u5168\u5c40\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_8","text":"\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002\u8d4b\u503c\u8fc7\u7a0b\u4f7f\u7528settag\u5b8c\u6210\uff1a {% raw %} {% set foo = 'foo' %} {% set foo = [1, 2] %} {% set foo = {'foo': 'bar'} %} {% endraw %}","title":"\u8bbe\u7f6e\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filters","text":"\u53d8\u91cf\u53ef\u4ee5\u7528filters\u8fdb\u884c\u4fee\u6539\u3002Filters\u548c\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\uff08|\uff09\u8fdb\u884c\u5206\u9694\uff0c\u53ef\u4ee5\u7528\u62ec\u53f7\u6765\u5305\u542b\u53c2\u6570\u3002\u591a\u4e2aFilter\u53ef\u80fd\u8fdb\u884c\u94fe\u5f0f\u8c03\u7528\u2014\u2014\u524d\u4e00\u4e2aFilter\u7684\u8f93\u51fa\u53ef\u4f5c\u4e3a\u4e0b\u4e00\u4e2aFilter\u7684\u8f93\u5165\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u6e05\u7406\u6240\u6709\u7684HTML\u6807\u8bb0\uff0c\u5e76\u505a\u6807\u9898\u5927\u5199\u5904\u7406\uff1a {% raw %} {{ name|striptags|title }} {% endraw %} Filter\u53ef\u4ee5\u7528\u62ec\u53f7\u7684\u5f62\u5f0f\u63a5\u6536\u53c2\u6570\u3002\u8fd9\u4e2a\u4f8b\u5b50\u7528\u9017\u53f7\u8fde\u63a5\u4e00\u4e2a\u5217\u8868\uff1a {% raw %} {{ list|join(', ') }} {% endraw %} \u8981\u5bf9\u4e00\u6bb5\u4ee3\u7801\u4f7f\u7528Filter\uff0c\u53ef\u4ee5\u7528filter tag\u64cd\u4f5c\uff1a {% raw %} {% filter upper %} This text becomes uppercase {% endfilter %} {% endraw %}","title":"Filters"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_9","text":"\u8c03\u7528\u51fd\u6570\u53ef\u4ee5\u751f\u6210\u5185\u5bb9\u3002\u8c03\u7528\u51fd\u6570\u7684\u65b9\u5f0f\u662f\uff1a\u51fd\u6570\u540d\u79f0\u52a0\u62ec\u53f7\uff0c\u62ec\u53f7\u4e2d\u53ef\u80fd\u5305\u542b\u53c2\u6570\u3002 \u4f8b\u5982range\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u9012\u589e\u7684\u6574\u6570\u5217\u8868\uff1a {% raw %} {% for i in range(0, 3) %} {{ i }}, {% endfor %} {% endraw %} \u524d\u5f80 functions \u4e00\u8282\u53ef\u4ee5\u5b66\u4e60\u66f4\u591a\u5185\u7f6e\u51fd\u6570\u7684\u5185\u5bb9\u3002","title":"\u51fd\u6570"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_10","text":"1.12\u7248\u4e2d\u65b0\u589e {% raw %} {% for i in range(low=1, high=10, step=2) %} {{ i }}, {% endfor %} {% endraw %} \u6709\u4e86\u5177\u540d\u53c2\u6570\uff0c\u4f20\u9012\u7ed9\u6a21\u677f\u7684\u53c2\u6570\u53ef\u4ee5\u66f4\u52a0\u660e\u786e\uff0c\u8ba9\u6a21\u677f\u66f4\u52a0\u6613\u7528\u3002 {% raw %} {{ data|convert_encoding('UTF-8', 'iso-2022-jp') }} {# \u76f8\u6bd4\uff1a #} {{ data|convert_encoding(from='iso-2022-jp', to='UTF-8') }} {% endraw %} \u5177\u540d\u53c2\u6570\u8fd8\u80fd\u5728\u4e0d\u4f20\u9012\u67d0\u4e9b\u53c2\u6570\u65f6\u5019\u76f4\u63a5\u8df3\u8fc7\uff1a {% raw %} {# the first argument is the date format, which defaults to the global date format if null is passed #} {{ \"now\"|date(null, \"Europe/Paris\") }} {# or skip the format value by using a named argument for the time zone #} {{ \"now\"|date(timezone=\"Europe/Paris\") }} {% endraw %} \u8fd8\u53ef\u4ee5\u7528\u987a\u5e8f\u53c2\u6570\u548c\u5177\u540d\u53c2\u6570\u5939\u6742\u7684\u65b9\u5f0f\u8fdb\u884c\u8c03\u7528\uff0c\u8fd9\u91cc\u8981\u4fdd\u8bc1\u987a\u5e8f\u53c2\u6570\u5fc5\u987b\u6bd4\u5177\u540d\u53c2\u6570\u5148\u51fa\u73b0\uff1a {% raw %} {{ \"now\"|date('d/m/Y H:i', timezone=\"Europe/Paris\") }} {% endraw %} \u6bcf\u4e2a\u51fd\u6570\u548cFilter\u7684\u6587\u6863\u4e2d\uff0c\u5982\u679c\u8be5\u51fd\u6570\u6216\u8005Filter\u652f\u6301\u5177\u540d\u53c2\u6570\uff0c\u90fd\u4f1a\u6709\u4e00\u8282\u5217\u51fa\u6240\u6709\u7684\u53c2\u6570\u540d\u79f0\u3002","title":"\u5177\u540d\u53c2\u6570"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_11","text":"{% raw %} \u63a7\u5236\u7ed3\u6784\u6307\u7684\u662f\u6240\u6709\u80fd\u591f\u63a7\u5236\u7a0b\u5e8f\u6d41\u7a0b\u7684\u5143\u7d20\u2014\u2014\u6761\u4ef6\u5224\u65ad\uff08\u4e5f\u5c31\u662fif/elseif/else\uff09\u3001for\u5faa\u73af\uff0c\u4ee5\u53ca\u8bed\u53e5\u5757\u7b49\u3002\u63a7\u5236\u7ed3\u6784\u7528{% ... %}\u5305\u88f9 {% endraw %} \u4f8b\u5982\uff0c\u8981\u663e\u793a\u4e00\u4e2ausers\u53d8\u91cf\u4e2d\u6240\u6709\u7684\u5217\u8868\u6210\u5458\uff0c\u4f7f\u7528for\uff1a <h1>Members</h1> <ul> {% raw %} {% for user in users %} <li>{{ user.username|e }}</li> {% endfor %} {% endraw %} </ul> \u53ef\u4ee5\u7528if\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\uff1a {% if users|length > 0 %} <ul> {% raw %} {% for user in users %} <li>{{ user.username|e }}</li> {% endfor %} {% endraw %} </ul> {% endif %} Tags \u9875\u4e2d\u63cf\u8ff0\u4e86\u5404\u79cd\u5185\u7f6eTag\u3002","title":"\u63a7\u5236\u7ed3\u6784"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_12","text":"\u5728\u6a21\u677f\u4e2d\u8fdb\u884c\u6ce8\u91ca\uff0c\u4f7f\u7528\u6ce8\u91ca\u8bed\u6cd5`{# ... #}\uff1a {% raw %} {# \u6ce8\uff1a\u7981\u7528\u8fd9\u4e00\u5757\u4e1c\u897f\uff0c\u4e0d\u518d\u9700\u8981\u4e86 {% for user in users %} ... {% endfor %} {% endraw %} #}","title":"\u6ce8\u91ca"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_13","text":"include\u6807\u7b7e\u7528\u4e8e\u5305\u542b\u5176\u5b83\u6a21\u7248\uff0c\u5e76\u628a\u8be5\u6a21\u7248\u7684\u6e32\u67d3\u7ed3\u679c\u8fd4\u56de\u5230\u5f53\u524d\u9875\u9762\uff1a {% raw %} {% include 'sidebar.html' %} {% endraw %} \u7f3a\u7701\u72b6\u51b5\u4e0b\uff0c\u5f53\u524d\u7684\u4e0a\u4e0b\u6587\u4f1a\u88ab\u4f20\u9012\u7ed9\u88ab\u5305\u542b\u7684\u6a21\u677f\u3002 \u4f20\u9012\u7ed9\u88ab\u5305\u542b\u6a21\u677f\u4e2d\u7684\u4e0a\u4e0b\u6587\u5305\u542b\u5f53\u524d\u6a21\u677f\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\uff1a {% raw %} {% for box in boxes %} {% include \"render_box.html\" %} {% endfor %} {% endraw %} \u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0crender_box.html\u53ef\u4ee5\u8bbf\u95eebox\u53d8\u91cf\u3002 \u6a21\u677f\u6587\u4ef6\u540d\u7684\u9009\u53d6\uff0c\u53d6\u51b3\u4e8e\u6a21\u677f\u52a0\u8f7d\u5668\u3002\u6bd4\u5982Twig_Loader_Filesystem\u5141\u8bb8\u901a\u8fc7\u6587\u4ef6\u540d\u8bbf\u95ee\u5176\u4ed6\u7684\u6a21\u677f\u3002\u53ef\u4ee5\u4f7f\u7528\u5b50\u76ee\u5f55\u6765\u8bbf\u95ee\u5176\u4ed6\u6a21\u677f\uff1a {% raw %} {% include \"sections/articles/sidebar.html\" %} {% endraw %}","title":"\u5305\u542b\u5176\u4ed6\u6a21\u677f"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_14","text":"Twig\u6700\u5f3a\u5927\u7684\u80fd\u529b\u5c31\u662f\u7ee7\u627f\u3002\u8fd9\u4e00\u4e2a\u80fd\u529b\u53ef\u4ee5\u8ba9\u4f60\u5efa\u7acb\u4e00\u4e2a\u5305\u542b\u6240\u6709\u57fa\u7840\u5143\u7d20\u7684\u57fa\u7840\u6a21\u677f\uff0c\u5e76\u5b9a\u4e49\u53ef\u4ee5\u88ab\u5b50\u6a21\u677f\u8986\u76d6\u7684block\u3002 \u8fd9\u90e8\u5206\u5185\u5bb9\u5e76\u4e0d\u50cf\u542c\u8d77\u6765\u90a3\u4e48\u590d\u6742\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u80fd\u8ba9\u4f60\u66f4\u597d\u7684\u7406\u89e3\u8fd9\u4e2a\u6982\u5ff5\u3002 \u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3abase.html\u7684\u57fa\u672c\u6a21\u677f\uff0c\u5728\u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7b80\u5355\u7684HTML\u7ed3\u6784\uff0c\u540e\u9762\u53ef\u4ee5\u7528\u5728\u4e00\u4e2a\u7b80\u5355\u7684\u4e24\u5217\u5e03\u5c40\u7684\u9875\u9762\u4e0a\uff1a <!DOCTYPE html> <html> <head> {% raw %} {% block head %} <link rel=\"stylesheet\" href=\"style.css\" /> <title>{% block title %}{% endblock %} - My Webpage</title> {% endblock %} {% endraw %} </head> <body> <div id=\"content\"> {% raw %} {% block content %} {% endblock %} {% endraw %} </div> <div id=\"footer\"> {% raw %} {% block footer %} &copy; Copyright 2011 by <a href=\"http://domain.invalid/\">you</a>. {% endblock %} {% endraw %} </div> </body> </html> \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c Block\u6807\u8bb0 \u5b9a\u4e49\u4e86\u56db\u4e2aBlock\uff0c\u5b50\u6a21\u677f\u53ef\u4ee5\u5bf9\u8fd9\u56db\u4e2aBlock\u8fdb\u884c\u586b\u5145\u3002\u6240\u6709\u7684Block\u6807\u8bb0\u7684\u4f5c\u7528\u5c31\u5728\u4e8e\u544a\u8bc9\u6a21\u677f\u5f15\u64ce\u2014\u2014\u5b50\u6a21\u677f\u53ef\u80fd\u5bf9\u6a21\u677f\u7684\u8fd9\u4e00\u90e8\u5206\u8fdb\u884c\u8986\u76d6\u3002 \u4e00\u4e2a\u5b50\u6a21\u677f\u770b\u8d77\u6765\u5927\u6982\u662f\uff1a {% raw %} {% extends \"base.html\" %} {% block title %}Index{% endblock %} {% block head %} {{ parent() }} <style type=\"text/css\"> .important { color: #336699; } </style> {% endblock %} {% block content %} <h1>Index</h1> <p class=\"important\"> Welcome to my awesome homepage. </p> {% endblock %} {% endraw %} \u6b64\u5904\u7684\u5173\u952e\u5c31\u5728\u4e8e Extends tag \u3002\u4ed6\u8ba9\u6a21\u677f\u5f15\u64ce\u5f97\u77e5\u8fd9\u4e2a\u6a21\u677f\u662f\u201c\u6269\u5c55\u81ea\u5176\u4ed6\u6a21\u677f\u201d\u3002\u5f53\u6a21\u677f\u7cfb\u7edf\u5904\u7406\u8fd9\u4e00\u6a21\u677f\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u9996\u5148\u5b9a\u4f4d\u7236\u6a21\u677f\u3002Extends\u6807\u8bb0\u5e94\u8be5\u662f\u5b50\u6a21\u677f\u7684\u7b2c\u4e00\u4e2a\u6807\u8bb0\u3002 \u53e6\u5916\u56e0\u4e3a\u5b50\u6a21\u677f\u4e2d\u6ca1\u6709\u5b9a\u4e49footer block\uff0c\u6240\u4ee5\u6b64\u5904\u4f1a\u7ee7\u7eed\u4f7f\u7528\u7236\u6a21\u677f\u7684\u5185\u5bb9\u3002 \u4e5f\u53ef\u4ee5\u7528 Parent\u51fd\u6570 \u6765\u6e32\u67d3\u7236\u6a21\u677fBlock\u7684\u5185\u5bb9\u3002\u8fd9\u4e00\u8c03\u7528\u4f1a\u8fd4\u56de\u7236\u6a21\u677f\u4e2d\u7684Block\u7ed3\u679c\uff1a {% raw %} {% block sidebar %} <h3>Table Of Contents</h3> ... {{ parent() }} {% endblock %} {% endraw %} extend\u6587\u6863 \u4e2d\u4ecb\u7ecd\u4e86\u66f4\u6df1\u5165\u7684\u7279\u6027\uff0c\u4f8b\u5982Block\u5d4c\u5957\u3001\u4f5c\u7528\u57df\u3001\u52a8\u6001\u7ee7\u627f\u4ee5\u53ca\u6761\u4ef6\u7ee7\u627f\u7b49\u3002","title":"\u6a21\u7248\u7ee7\u627f"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#html","text":"\u4ece\u6a21\u677f\u4e2d\u751f\u6210HTML\u7684\u65f6\u5019\uff0c\u5b58\u5728\u4e00\u79cd\u98ce\u9669\uff1a\u4e00\u4e2a\u53d8\u91cf\u53ef\u80fd\u5305\u542b\u4e86HTML\u4ee3\u7801\uff0c\u4f1a\u5f71\u54cd\u5230\u6700\u7ec8\u7684HTML\u3002\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\u4eba\u5de5\u8f6c\u4e49\u6bcf\u4e00\u4e2a\u53d8\u91cf\uff0c\u6216\u8005\u7f3a\u7701\u60c5\u51b5\u4e0b\u81ea\u52a8\u8f6c\u4e49\u6240\u6709\u53d8\u91cf\u3002Twig\u5bf9\u4e24\u79cd\u65b9\u5f0f\u90fd\u652f\u6301\uff0c\u7f3a\u7701\u5f00\u542f\u7b2c\u4e8c\u79cd\u3002 \u81ea\u52a8\u8f6c\u4e49\u53ea\u6709\u5728escaper\u6269\u5c55\u6fc0\u6d3b\u7684\u60c5\u51b5\u4e0b\u624d\u751f\u6548\u3002","title":"HTML\u8f6c\u4e49"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_15","text":"\u5982\u679c\u542f\u7528\u4e86\u4eba\u5de5\u8f6c\u4e49\uff0c\u90a3\u4e48\u5bf9\u9700\u8981\u8fdb\u884c\u5904\u7406\u7684\u53d8\u91cf\u8fdb\u884c\u8f6c\u4e49\u5c31\u6210\u4e86\u5f00\u53d1\u8005\u7684\u8d23\u4efb\u3002\u90a3\u4e48\u4ec0\u4e48\u9700\u8981\u88ab\u8f6c\u4e49\u5462\uff1f\u7b54\u6848\u662f\u6240\u6709\u4e0d\u4fe1\u4efb\u7684\u53d8\u91cf\u3002\u4eba\u5de5\u8f6c\u4e49\u7684\u65b9\u6cd5\u662f\u628a\u53d8\u91cf\u4f20\u9001\u7ed9 escape filter \u6216\u8005e filter\u8fdb\u884c\u5904\u7406\u3002 {% raw %} {{ user.username|e }} {% endraw %}","title":"\u4eba\u5de5\u8f6c\u4e49"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_16","text":"\u4e0d\u7ba1\u662f\u5426\u542f\u7528\u4e86\u81ea\u52a8\u8f6c\u4e49\uff0c\u90fd\u53ef\u4ee5\u5229\u7528 autoescape \u6807\u8bb0\u6765\u6807\u8bb0\u6a21\u677f\u4e2d\u7684\u4e00\u6bb5\u5185\u5bb9\u3002 {% raw %} {% autoescape %} Everything will be automatically escaped in this block (using the HTML strategy) {% endautoescape %} {% endraw %} \u7f3a\u7701\u60c5\u51b5\u4e0b\uff0c\u81ea\u52a8\u8f6c\u4e49\u4f7f\u7528html\u7b56\u7565\u3002\u5982\u679c\u8f93\u51fa\u5185\u5bb9\u5c5e\u4e8e\u5176\u4ed6\u4e0a\u4e0b\u6587\uff0c\u5219\u9700\u8981\u663e\u5f0f\u7684\u6307\u5b9a\u5176\u4ed6\u7684\u8f6c\u4e49\u7b56\u7565\uff1a {% raw %} {% autoescape 'js' %} \u8fd9\u4e2a\u533a\u5757\u4e2d\u7684\u6240\u6709\u5b57\u7b26\u90fd\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e49(\u91c7\u7528JS\u7b56\u7565) {% endautoescape %} {% endraw %} \u8f6c\u4e49 {% raw %} \u8ba9Twig\u80fd\u591f\u5ffd\u7565\u4e00\u90e8\u5206\u672c\u5e94\u5f53\u505a\u662fblock\u6216\u8005\u53d8\u91cf\u6765\u5904\u7406\u7684\u4e1c\u897f\uff0c\u662f\u4e2a\u5e38\u89c1\u751a\u81f3\u5fc5\u8981\u7684\u9700\u6c42\u3002\u4f8b\u5982\u60f3\u8981\u4ee5\u539f\u59cb\u5f62\u6001\u8f93\u51fa{{\u8fd9\u6837\u88ab\u8bed\u6cd5\u5360\u7528\u7684\u5173\u952e\u5b57\uff0c\u800c\u4e0d\u60f3\u88ab\u5f53\u505a\u53d8\u91cf\u7684\u5f00\u59cb\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5c0f\u6280\u5de7\u3002 {% endraw %} \u6700\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\u8868\u8fbe\u5f0f\uff1a {% raw %} {{ '{{' }} {% endraw %}","title":"\u81ea\u52a8\u8f6c\u4e49"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_17","text":"\u5728\u7248\u672c1.12\u4e2d\u51fa\u73b0\uff1a\u652f\u6301\u7f3a\u7701\u53c2\u6570\u503c\u3002 \u5b8f\u548c\u548c\u5176\u4ed6\u8bed\u8a00\u4e2d\u7684\u51fd\u6570\u7c7b\u4f3c\u3002\u5b83\u53ef\u4ee5\u590d\u7528\u7ecf\u5e38\u4f7f\u7528\u7684HTML\u7247\u6bb5\u3002 \u4f7f\u7528 macro\u6807\u8bb0 \u53ef\u4ee5\u5b9a\u4e49\u5b8f\u3002\u4e0b\u9762\u662fforms.html\u4e2d\u7684\u4e00\u4e2a\u5c0f\u4f8b\u5b50\uff1a\u5229\u7528\u5b8f\u6e32\u67d3\u4e00\u4e2aform\u5143\u7d20\uff1a {% raw %} {% macro input(name, value, type, size) %} <input type=\"{{ type|default('text') }}\" name=\"{{ name }}\" value=\"{{ value|e }}\" size=\"{{ size|default(20) }}\" /> {% endmacro %} {% endraw %} \u53ef\u4ee5\u5728\u4efb\u4f55\u6a21\u677f\u4e2d\u5b9a\u4e49\u5b8f\uff0c\u7136\u540e\u4f7f\u7528 import\u6807\u8bb0 \u8fdb\u884c\u5bfc\u5165\u5373\u53ef\uff1a {% raw %} {% import \"forms.html\" as forms %} <p>{{ forms.input('username') }}</p> {% endraw %} \u5728\u4ece\u5176\u4ed6\u6a21\u677f\u4e2d\u8fdb\u884c\u5f15\u5165\u7684\u65f6\u5019\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528From\u6807\u8bb0\u4e3a\u5176\u8d4b\u4e88\u522b\u540d\uff1a {% raw %} {% from 'forms.html' import input as input_field %} <dl> <dt>Username</dt> <dd>{{ input_field('username') }}</dd> <dt>Password</dt> <dd>{{ input_field('password', '', 'password') }}</dd> </dl> {% endraw %} \u8fd8\u53ef\u4ee5\u5728\u4e3a\u5b8f\u6307\u5b9a\u7f3a\u7701\u53c2\u6570\uff1a {% raw %} {% macro input(name, value = \"\", type = \"text\", size = 20) %} <input type=\"{{ type }}\" name=\"{{ name }}\" value=\"{{ value|e }}\" size=\"{{ size }}\" /> {% endmacro %} {% endraw %}","title":"\u5b8f"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_18","text":"Twig\u5141\u8bb8\u4f7f\u7528\u8868\u8fbe\u5f0f\uff0c\u5de5\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\u666e\u901a\u7684PHP\uff0c\u5373\u4f7f\u4f60\u5bf9PHP\u6ca1\u90a3\u4e48\u719f\u6089\uff0c\u4e5f\u53ef\u4ee5\u8f7b\u677e\u9762\u5bf9\u3002 \u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u6309\u9012\u589e\u987a\u5e8f\u6392\u5217\u5982\u4e0b\uff1a b-and, b-xor, b-or, or, and, ==, !=, <, >, >=, <=, in, matches, starts with, ends with, .., +, -, ~, , /, //, %, is, * , |, [], and {% raw %} {% set greeting = 'Hello ' %} {% set name = 'Fabien' %} {{ greeting ~ name|lower }} {# Hello fabien #} {# use parenthesis to change precedence #} {{ (greeting ~ name)|lower }} {# hello fabien #} {% endraw %}","title":"\u8868\u8fbe\u5f0f"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_19","text":"\u57281.5\u4e2d\u65b0\u589e\uff1a\u652f\u6301\u4ee5\u540d\u79f0\u548c\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u54c8\u5e0c\u952e \u8868\u8fbe\u5f0f\u7684\u6700\u7b80\u5355\u5f62\u5f0f\u5c31\u662f\u5e38\u91cf\u4e86\u3002\u4ed6\u662fPHP\u7c7b\u578b\u7684\u4e00\u79cd\u5b9e\u73b0\uff0c\u5305\u542b\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u4ee5\u53ca\u6570\u7ec4\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4f8b\u5b50 \"Hello world\"\uff1a\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u4e4b\u95f4\u7684\u5185\u5bb9\u662f\u5b57\u7b26\u4e32\u3002\u53ef\u4ee5\u5728\u4efb\u4f55\u9700\u8981\u5b57\u7b26\u4e32\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\uff08\u4f8b\u5982\u4f5c\u4e3a\u51fd\u6570\u6216\u8005Filter\u7684\u53c2\u6570\uff0c\u6216\u8005\u5728extend\u4ee5\u53cainclude\u8fc7\u7a0b\u4e2d\u4f7f\u7528\uff09\u3002 42 / 42.23\uff1a\u6574\u6570\u548c\u6d6e\u70b9\u6570\u3002\u6709\u5c0f\u6570\u70b9\u7684\u662f\u6d6e\u70b9\u6570\uff1b\u5426\u5219\u5c31\u662f\u6574\u6570\u3002 [\"foo\", \"bar\"]\uff1a\u6570\u7ec4\u7531\u65b9\u62ec\u53f7\u5305\u542b\u7684\u4e00\u7ec4\u9017\u53f7\u5206\u9694\u7684\u8868\u8fbe\u5f0f\u7ec4\u6210\u3002 {\"foo\": \"bar\"}\uff1a\u540c\u6570\u7ec4\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u662f\u4ee5\u82b1\u62ec\u53f7\u8fdb\u884c\u5305\u88c5\u3002 {% raw %} {# keys as string #} { 'foo': 'foo', 'bar': 'bar' } {# keys as names (equivalent to the previous hash) -- as of Twig 1.5 #} { foo: 'foo', bar: 'bar' } {# keys as integer #} { 2: 'foo', 4: 'bar' } {# keys as expressions (the expression must be enclosed into parentheses) -- as of Twig 1.5 #} { (1 + 1): 'foo', (a ~ 'b'): 'bar' } {% endraw %} true / false\uff1a\u5e03\u5c14\u503c\uff0c\u4f60\u61c2\u7684 null\uff1a\u8868\u660e\u65e0\u7279\u5b9a\u503c\u3002\u5f53\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u65f6\uff0c\u5c31\u4f1a\u8fd4\u56denull\uff0cnone\u662fnull\u7684\u522b\u540d\u3002 \u6570\u7ec4\u548c\u54c8\u5e0c\u53ef\u4ee5\u5d4c\u5957\uff1a {% raw %} {% set foo = [1, {\"foo\": \"bar\"}] %} {% endraw %} \u5b57\u7b26\u4e32\u4f7f\u7528\u5355\u53cc\u5f15\u53f7\u5bf9\u6027\u80fd\u6ca1\u4ec0\u4e48\u5f71\u54cd\uff0c\u4f46\u662f\u53ea\u6709\u53cc\u5f15\u53f7\u624d\u652f\u6301\u5b57\u7b26\u4e32\u5dee\u503c\u3002","title":"\u5e38\u91cf"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_20","text":"Twig\u53ef\u4ee5\u8fdb\u884c\u8fd0\u7b97\u3002\u8fd9\u4e2a\u529f\u80fd\u5f88\u5c11\u7528\u5f97\u5230\uff0c\u4e0d\u8fc7\u4e3a\u4e86\u5b8c\u6574\u8d77\u89c1\uff0c\u8fd8\u662f\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002\u76ee\u524d\u652f\u6301\u4e0b\u5217\u64cd\u4f5c\u7b26\uff1a {% raw %} +\uff1a\u52a0\u6cd5 -\uff1a\u51cf\u6cd5 /\uff1a\u9664\u6cd5 %\uff1a\u6c42\u4f59\u3002{{ 11 % 7 }} \u7b49\u4e8e 4. //\uff1a\u6574\u9664\uff0c\u8fd4\u56de\u4e24\u4e2a\u6570\u76f8\u9664\u5f97\u5230\u7684\u7ed3\u679c\u7684\u6574\u6570\u90e8\u5206\u3002{{ 20 // 7 }}\u7b49\u4e8e2 *\uff1a \u76f8\u4e58\uff0c{{2 * 2}} \u8fd4\u56de 4\u3002 **\uff1a\u4e58\u65b9\uff0c{{ 2 3}}`\u7b49\u4e8e8\u3002 {% endraw %}","title":"\u7b97\u6570\u8fd0\u7b97\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_21","text":"\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u64cd\u4f5c\u7b26\u8fde\u63a5\u591a\u4e2a\u8868\u8fbe\u5f0f\uff1a and\uff1a\u4e0e\u8fd0\u7b97 or\uff1a\u6216\u8fd0\u7b97 not\uff1a\u975e\u8fd0\u7b97 (expr)\uff1a\u4e3a\u8868\u8fbe\u5f0f\u5206\u7ec4 Twig\u8fd8\u652f\u6301\u4f4d\u64cd\u4f5c\uff1a\uff08b-and, b-xor \u4ee5\u53ca b-or\uff09\u3002","title":"\u903b\u8f91\u8fd0\u7b97\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_22","text":"Twig\u652f\u6301\u7684\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff1a==\u3001!=\u3001<\u3001>\u3001>=\u3001<=\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u4f7f\u7528starts with\u6216\u8005end with\uff1a {% raw %} {% if 'Fabien' starts with 'F' %} {% endif %} {% if 'Fabien' ends with 'n' %} {% endraw %} \u5bf9\u4e8e\u590d\u6742\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0cmatches\u64cd\u4f5c\u7b26\u63d0\u4f9b\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u80fd\u529b\uff1a {% raw %} {% if phone matches '/^[\\\\d\\\\.]+$/' %} {% endif %} {% endraw %}","title":"\u6bd4\u8f83\u8fd0\u7b97\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_23","text":"\u64cd\u4f5c\u7b26in\u63d0\u4f9b\u4e86\u5305\u542b\u6d4b\u8bd5\u529f\u80fd\u3002 \u5982\u679c\u53f3\u4fa7\u64cd\u4f5c\u6570\u5305\u542b\u5de6\u4fa7\u7684\u64cd\u4f5c\u6570\uff0c\u5219\u8fd4\u56detrue\uff1a {% raw %} {# returns true #} {{ 1 in [1, 2, 3] }} {{ 'cd' in 'abcde' }} {% endraw %} \u8fd8\u53ef\u4ee5\u53cd\u7740\u7528\uff08not in\uff09\uff1a {% raw %} {% if 1 not in [1, 2, 3] %} {# \u7b49\u4ef7\u4e8e #} {% if not (1 in [1, 2, 3]) %} {% endraw %}","title":"\u5305\u542b\u64cd\u4f5c\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_24","text":"is\u64cd\u4f5c\u7b26\u7528\u4e8e\u6d4b\u8bd5\u3002\u53ef\u4ee5\u7528\u4e8e\u6d4b\u8bd5\u4e00\u4e2a\u53d8\u91cf\u548c\u8868\u8fbe\u5f0f\uff0c\u53f3\u4fa7\u7684\u64cd\u4f5c\u6570\u5c31\u662f\u6d4b\u8bd5\u7684\u540d\u5b57\uff1a {% raw %} {# \u68c0\u6d4b\u53d8\u91cf\u662f\u4e0d\u662f\u5947\u6570 #} {{ name is odd }} {% endraw %} \u6d4b\u8bd5\u4e5f\u53ef\u4ee5\u63a5\u53d7\u53c2\u6570\uff1a {% raw %} {% if post.status is constant('Post::PUBLISHED') %} {% endraw %} \u53ef\u4ee5\u4f7f\u7528is not\u6765\u8fdb\u884c\u5426\u5b9a\u6d4b\u8bd5\uff1a {% raw %} {% if post.status is not constant('Post::PUBLISHED') %} {# \u7b49\u4ef7\u4e8e #} {% if not (post.status is constant('Post::PUBLISHED')) %} {% endraw %} \u53ef\u4ee5\u53bb test \u9875\u9762\u6765\u4e86\u89e3\u4e00\u4e0b\u5185\u7f6e\u7684\u6d4b\u8bd5\u3002","title":"\u6d4b\u8bd5\u64cd\u4f5c\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_25","text":"1.12.0\u4e2d\u52a0\u5165\u4e86\u6269\u5c55\u7684\u4e09\u5143\u64cd\u4f5c\u7b26\u3002 |\uff1a\u7ba1\u9053\u7b26\u53f7\uff0c\u5e94\u7528\u4e00\u4e2afilter ..\uff1a\u4ee5\u5de6\u53f3\u4e24\u4e2a\u64cd\u4f5c\u6570\u4e3a\u57fa\u7840\u751f\u6210\u4e00\u4e2a\u5e8f\u5217 {% raw %} {{ 1..5 }} {# \u7b49\u4ef7\u4e8e #} {{ range(1, 5) }} {% endraw %} {% raw %} - ~\uff1a\u628a\u6240\u6709\u64cd\u4f5c\u6570\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5e76\u8fde\u63a5\u8d77\u6765\u3002{{ \"Hello \" ~ name ~ \"!\" }}\u4f1a\u8fd4\u56de(\u5047\u8bbename\u662f'John')Hello John!\u3002 - .,[]\uff1a\u83b7\u53d6\u5bf9\u8c61\u7684\u5c5e\u6027 - ?:\uff1a\u4e09\u5143\u64cd\u4f5c\u7b26 {% endraw %} {% raw %} {{ foo ? 'yes' : 'no' }} {# \u5728Twig 1.12.0\u4e2d #} {{ foo ?: 'no' }} \u7b49\u540c\u4e8e {{ foo ? foo : 'no' }} {{ foo ? 'yes' }} \u7b49\u540c\u4e8e {{ foo ? 'yes' : '' }} {% endraw %}","title":"\u5176\u4ed6\u64cd\u4f5c\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_26","text":"\u5b57\u7b26\u4e32\u5dee\u503c(#{\u8868\u8fbe\u5f0f})\u5141\u8bb8\u5728\u53cc\u5f15\u53f7\u5185\u7684\u5b57\u7b26\u4e32\u4e2d\u63d2\u5165\u4efb\u4f55\u6709\u6548\u7684\u8868\u8fbe\u5f0f\u3002\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u4f1a\u51fa\u73b0\u5728\u6700\u7ec8\u7684\u5b57\u7b26\u4e32\u4e2d\uff1a {% raw %} {{ \"foo #{bar} baz\" }} {{ \"foo #{1 + 2} baz\" }} {% endraw %}","title":"\u5b57\u7b26\u4e32\u63d2\u503c"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_27","text":"twig1.1\u65b0\u589etag\u7ea7\u522b\u7684\u7a7a\u767d\u63a7\u5236 \u8ddfPHP\u7c7b\u4f3c\uff0c\u6a21\u677f\u6807\u8bb0\u540e\u9762\u7684\u7b2c\u4e00\u4e2a\u7a7a\u884c\u4f1a\u88ab\u81ea\u52a8\u5220\u9664\u3002\u6a21\u677f\u5f15\u64ce\u76ee\u524d\u5df2\u7ecf\u4e0d\u518d\u81ea\u52a8\u6e05\u7406\u7a7a\u767d\uff0c\u6240\u6709\u7a7a\u767d\uff08\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u884c\u7b26\u7b49\uff09\u90fd\u4f1a\u539f\u6837\u8f93\u51fa\u3002 \u4f7f\u7528 spaceless \u6807\u8bb0\u53ef\u4ee5\u79fb\u51fahtml\u6807\u8bb0\u4e4b\u95f4\u7684\u7a7a\u767d\uff1a {% raw %} {% spaceless %} <div> <strong>foo bar</strong> </div> {% endspaceless %} {# output will be <div><strong>foo bar</strong></div> #} {% endraw %} \u5728spaceless\u6807\u8bb0\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5728\u6bcf\u4e2a\u6807\u8bb0\u7684\u7ea7\u522b\u63a7\u5236\u7a7a\u767d\u3002\u5728\u6807\u8bb0\u4e0a\u4f7f\u7528\u7a7a\u767d\u63a7\u5236\u4fee\u9970\u7b26\uff0c\u53ef\u4ee5\u6e05\u9664\u524d\u5bfc\u6216\u8ddf\u968f\u7684\u7a7a\u767d\uff1a {% raw %} {% set value = 'no spaces' %} {#- \u53d6\u51fa\u9996\u4f4d\u7a7a\u767d -#} {%- if true -%} {{- value -}} {%- endif -%} {# \u8f93\u51fa 'no spaces' #} {% endraw %} \u4e0a\u9762\u7684\u4f8b\u5b50\u6f14\u793a\u4e86\u7f3a\u7701\u7684\u7a7a\u767d\u63a7\u5236\u4fee\u9970\u7b26\uff0c\u4ee5\u53ca\u5982\u4f55\u79fb\u9664\u6807\u8bb0\u5468\u56f4\u7684\u7a7a\u767d\u3002\u8fd8\u53ef\u4ee5\u53ea\u6e05\u9664Tag\u4e00\u8fb9\u7684\u7a7a\u767d\uff1a {% raw %} {% set value = 'no spaces' %} <li> {{- value }} </li> {# \u8f93\u51fa '<li>no spaces</li>' #} {% endraw %}","title":"\u7a7a\u767d\u63a7\u5236"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_28","text":"Twig\u7684\u6269\u5c55\u5f88\u65b9\u4fbf\u3002 \u5982\u679c\u4f60\u8981\u67e5\u627e\u65b0\u7684\u6807\u8bb0\u3001filter\u6216\u8005\u51fd\u6570\uff0c\u53ef\u4ee5\u6d4f\u89c8\u5b98\u65b9\u7684 \u6269\u5c55\u4ed3\u5e93 \u3002 \u5982\u679c\u60f3\u8981\u521b\u5efa\u81ea\u5df1\u7684\u6269\u5c55\uff0c\u8bf7\u9605\u8bfb\u521b\u5efa \u6269\u5c55\u7ae0\u8282 \u3002","title":"\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#twig_1","text":"\u672c\u7ae0\u8bb2\u8ff0\u7684\u662fTwig\u7684API\uff0c\u800c\u4e0d\u662fTwig\u7684\u6a21\u677f\u8bed\u8a00\u3002\u8fd9\u4e9b\u5185\u5bb9\u4f1a\u5bf9\u4e3a\u5e94\u7528\u5b9e\u73b0\u6a21\u677f\u63a5\u53e3\u7684\u5de5\u4f5c\u5f88\u6709\u5e2e\u52a9\uff0c\u5bf9\u6a21\u677f\u7684\u5236\u4f5c\u5de5\u4f5c\u5c31\u6ca1\u4ec0\u4e48\u610f\u4e49\u4e86\u3002","title":"\u4e09\u3001\u5f00\u53d1\u8005\u7684Twig"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_29","text":"Twig\u7684\u4e2d\u5fc3\u5bf9\u8c61\u4e3a**environment**\uff08\u662fTwig_Environment\u7c7b\u7684\u5b9e\u4f8b\uff09\u3002\u8fd9\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u7528\u4e8e\u5b58\u50a8\u914d\u7f6e\u548c\u6269\u5c55\uff0c\u5e76\u7528\u6765\u4ece\u6587\u4ef6\u7cfb\u7edf\u6216\u8005\u5176\u4ed6\u4f4d\u7f6e\u8f7d\u5165\u6a21\u677f\u3002 \u7edd\u5927\u591a\u6570\u5e94\u7528\u9700\u8981\u5728\u5e94\u7528\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u521b\u5efa\u4e00\u4e2aTwig_Environment\u5bf9\u8c61\uff0c\u7136\u540e\u7528\u5b83\u6765\u52a0\u8f7d\u6a21\u677f\u3002\u5728\u6709\u4e9b\u6848\u4f8b\u4e2d\uff0c\u4f1a\u6709\u591a\u4e2a\u73af\u5883\u540c\u65f6\u5e76\u5b58\uff0c\u7528\u6765\u5904\u7406\u4e0d\u540c\u7684\u914d\u7f6e\u3002 \u4e0b\u9762\u4e3e\u4e2a\u7b80\u5355\u4f8b\u5b50\uff0c\u914d\u7f6eTwig\u6765\u4e3a\u5e94\u7528\u8f7d\u5165\u6a21\u677f\uff1a require_once '/path/to/lib/Twig/Autoloader.php'; Twig_Autoloader::register(); $loader = new Twig_Loader_Filesystem('/path/to/templates'); $twig = new Twig_Environment($loader, array( 'cache' => '/path/to/compilation_cache', )); \u4e0a\u9762\u7684\u4ee3\u7801\u4f1a\u521b\u5efa\u4e00\u4e2a\u7f3a\u7701\u8bbe\u7f6e\u7684\u73af\u5883\uff0c\u7136\u540e\u52a0\u8f7d\u5668\u4f1a\u53bb/path/to/templates/\u76ee\u5f55\u67e5\u627e\u6a21\u677f\u3002\u6709\u4e0d\u540c\u7684\u52a0\u8f7d\u5668\u53ef\u4ee5\u4f7f\u7528\uff0c\u4f60\u53ef\u4ee5\u5b9e\u73b0\u81ea\u5df1\u7684\u52a0\u8f7d\u5668\u7528\u6765\u4ece\u6570\u636e\u5e93\u6216\u8005\u5176\u4ed6\u8d44\u6e90\u4e2d\u83b7\u53d6\u6a21\u677f\u3002 \u6ce8\u610f\uff0cenvironment\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u6570\u7ec4\u9009\u9879\u3002cache\u9009\u9879\u58f0\u660e\u4e86\u4e00\u4e2a\u76ee\u5f55\uff0c\u7528\u4e8e\u5b58\u50a8Twig\u7f16\u8bd1\u7684\u6a21\u7248\uff0c\u4ee5\u51cf\u5c11\u89e3\u6790\u7684\u5f00\u9500\u3002\u8fd9\u79cd\u7f13\u5b58\u8ddf\u4f60\u5e0c\u671b\u5728\u5904\u7406\u6a21\u677f\u8fc7\u7a0b\u4e2d\u52a0\u5165\u7684\u7f13\u5b58\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u5982\u679c\u9700\u8981\u81ea\u884c\u7f13\u5b58\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u7684PHP\u7f13\u5b58\u5e93\u3002 \u8981\u4ece\u73af\u5883\u4e2d\u8c03\u7528\u6a21\u7248\uff0c\u53ea\u9700\u8981\u8c03\u7528 loadTemplate \u51fd\u6570\uff0c\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a Twig_Template \u5b9e\u4f8b $template = $twig->loadTemplate('index.html'); \u8981\u6e32\u67d3\u5e26\u6709\u53d8\u91cf\u7684\u6a21\u7248\uff0c\u8c03\u7528 render \u51fd\u6570 echo $template->render(array('the' => 'variables', 'go' => 'here')); display() \u65b9\u6cd5\u662f\u7528\u4e8e\u76f4\u63a5\u8f93\u51fa\u6a21\u7248\u7684\u5feb\u6377\u65b9\u6cd5\u3002 \u4f60\u8fd8\u53ef\u4ee5\u4e00\u6c14\u5475\u6210\u52a0\u8f7d\u548c\u6e32\u67d3\u6a21\u7248\uff1a echo $twig->render('index.html', array('the' => 'variables', 'go' => 'here'));","title":"\u57fa\u7840"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_30","text":"\u5f53\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Twig_Environment\u5b9e\u4f8b\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u9009\u9879\u6570\u7ec4\uff0c\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a $twig = new Twig_Environment($loader, array('debug' => true)); \u53ef\u7528\u7684\u73af\u5883\u9009\u9879\uff1a debug\uff1a\u5e03\u5c14\u503c\uff0c\u8bbe\u7f6e\u4e3atrue\u7684\u65f6\u5019\uff0c\u751f\u6210\u7684\u6a21\u7248\u4f1a\u5e26\u6709\u4e00\u4e2a __toString() \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u7528\u6765\u663e\u793a\u751f\u6210\u7684Node\uff08\u9ed8\u8ba4\u503cfalse\uff09 charset\uff1a\u6a21\u7248\u7684\u5b57\u7b26\u96c6\uff0c\u9ed8\u8ba4\u662futf-8 base_template_class\uff1a\u751f\u6210\u6a21\u7248\u65f6\u4f7f\u7528\u7684\u57fa\u672c\u6a21\u7248\u7c7b\uff0c\u9ed8\u8ba4Twig_Template cache\uff1a\u7528\u4e8e\u5b58\u50a8\u7f13\u5b58\u7684\u7edd\u5bf9\u8def\u5f84\u540d\uff0c\u6216\u8005false\u7528\u4e8e\u7981\u7528\u7f13\u5b58\uff08\u9ed8\u8ba4\u662ffalse\uff09 auto_reload\uff1a\u5e03\u5c14\u503c\uff0c\u5f53\u7528Twig\u5f00\u53d1\u65f6\uff0c\u6e90\u4ee3\u7801\u6709\u4fee\u6539\u65f6\u5c31\u91cd\u65b0\u7f16\u8bd1\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\u662f\u975e\u5e38\u5fc5\u8981\u7684\u3002\u5982\u679c\u4e0d\u63d0\u4f9b\u4e00\u4e2aauto_reload\u9009\u9879\uff0c\u4ed6\u4f1a\u4ecedebug\u9009\u9879\u4e2d\u53d6\u503c\u3002 strict_variables\uff1a\u5e03\u5c14\u503c\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3afalse\uff0cTwig\u4f1a\u5ffd\u7565\u65e0\u6548\u7684\u53d8\u91cf\uff08\u65e0\u6548\u6307\u7684\u662f\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u6216\u8005\u5c5e\u6027/\u65b9\u6cd5\uff09\uff0c\u5e76\u5c06\u5176\u66ff\u6362\u4e3anull\u3002\u5982\u679c\u8fd9\u4e2a\u9009\u9879\u8bbe\u7f6e\u4e3atrue\uff0c\u90a3\u4e48\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\u7684\u65f6\u5019\uff0cTwig\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u9ed8\u8ba4\u503c\u662ffalse autoescape\uff1a\u5b57\u7b26\u4e32\u6216\u8005\u5e03\u5c14\u503c\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3atrue\uff0cHTML\u7684\u81ea\u52a8\u8f6c\u4e49\u4f1a\u9ed8\u8ba4\u5bf9\u6240\u6709\u7684\u6a21\u7248\u8d77\u6548\uff0c\u9ed8\u8ba4\u503c\u662ftrue\u3002\u5728Twig 1.8\u4e2d\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u8f6c\u4e49\u7b56\u7565\uff08html\u6216\u8005js\uff0c\u8981\u5173\u95ed\u53ef\u4ee5\u8bbe\u7f6e\u4e3afalse\uff09\u3002\u5728Twig 1.9\u4e2d\u7684\u8f6c\u4e49\u7b56\u7565\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3acss\uff0curl\uff0chtml_attr\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u4e3aPHP\u56de\u8c03\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u6a21\u677f\u6587\u4ef6\u540d\u4e3a\u53c2\u6570\uff0c\u4e14\u5fc5\u987b\u8fd4\u56de\u8981\u4f7f\u7528\u7684\u8f6c\u4e49\u7b56\u7565\uff0c\u56de\u8c03\u547d\u540d\u5e94\u8be5\u907f\u514d\u540c\u5185\u7f6e\u7684\u8f6c\u4e49\u7b56\u7565\u51b2\u7a81\u3002 optimizations\uff1a\u6574\u578b\u503c\uff0c\u4e00\u4e2a\u6807\u8bb0\uff0c\u7528\u4e8e\u51b3\u5b9a\u91c7\u7528\u54ea\u79cd\u4f18\u5316\u65b9\u5f0f\uff08\u9ed8\u8ba4\u662f-1\uff0c\u6fc0\u6d3b\u6240\u6709\u7684\u4f18\u5316\u65b9\u5f0f\uff1b\u8bbe\u7f6e0\u7684\u8bdd\u5c06\u4f1a\u7981\u7528\uff09","title":"\u73af\u5883\u9009\u9879"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_31","text":"\u52a0\u8f7d\u5668\u8d1f\u8d23\u4ece\u6587\u4ef6\u7cfb\u7edf\u7b49\u8d44\u6e90\u4e2d\u52a0\u8f7d\u6a21\u7248","title":"\u52a0\u8f7d\u5668"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_32","text":"\u6240\u6709\u7684\u6a21\u7248\u52a0\u8f7d\u5668\u90fd\u4f1a\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7f13\u5b58\u7f16\u8bd1\u7684\u6a21\u7248\uff0c\u5df2\u88ab\u5c06\u6765\u8c03\u7528\u3002\u7531\u4e8e\u6a21\u7248\u53ea\u7f16\u8bd1\u4e00\u6b21\uff0c\u6240\u4ee5\u5927\u5927\u5730\u63d0\u5347\u4e86Twig\u7684\u901f\u5ea6\uff0c\u5982\u679c\u4f60\u8fd8\u4f7f\u7528\u4e86PHP\u52a0\u901f\u5668\uff0c\u4f8b\u5982APC\uff0c\u6027\u80fd\u7684\u63d0\u5347\u5c06\u4f1a\u66f4\u52a0\u7684\u660e\u663e\u3002\u53c2\u8003\u4e0a\u6587\u63d0\u5230\u7684 Twig_Environment \u4e2d\u7684 cache \u4ee5\u53ca auto_reload \u9009\u9879\u80fd\u591f\u83b7\u5f97\u66f4\u591a\u4fe1\u606f\u3002","title":"\u7f16\u8bd1\u7f13\u5b58"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_33","text":"\u8fd9\u91cc\u6709\u4e00\u4e2aTwig\u63d0\u4f9b\u7684\u5185\u7f6e\u52a0\u8f7d\u5217\u8868\uff1a Twig_Loader_Filesystem 1.10\u65b0\u589eprependPath()\u4ee5\u53ca\u547d\u540d\u7a7a\u95f4\u652f\u6301 Twig_Loader_Filesystem \u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u52a0\u8f7d\u6a21\u7248\u3002\u8fd9\u4e2a\u52a0\u8f7d\u5668\u53ef\u4ee5\u5728\u6587\u4ef6\u7cfb\u7edf\u7684\u76ee\u5f55\u4e2d\u627e\u5230\u6a21\u7248\uff0c\u4e5f\u662f\u63a8\u8350\u4f7f\u7528\u7684\u52a0\u8f7d\u5668\uff1a $loader = new Twig_Loader_Filesystem($templateDir); \u5b83\u8fd8\u53ef\u4ee5\u4ece\u76ee\u5f55\u6570\u7ec4\u4e2d\u67e5\u627e\u6a21\u7248\uff1a $loader = new Twig_Loader_Filesystem(array($templateDir1, $templateDir2)); \u5728\u8fd9\u79cd\u914d\u7f6e\u4e0b\uff0cTwig\u4f1a\u9996\u5148\u5728$templateDir1\u76ee\u5f55\u4e0b\u67e5\u627e\u6a21\u7248\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\uff0c\u518d\u7ee7\u7eed\u4ecetemplateDir2\u76ee\u5f55\u4e0b\u67e5\u627e\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7 addPath() \u548c prependPath() \u65b9\u6cd5\u6dfb\u52a0\u6216\u8005\u8ffd\u52a0\u8def\u5f84 $loader->addPath($templateDir3); $loader->prependPath($templateDir4); filesystem\u52a0\u8f7d\u5668\u8fd8\u652f\u6301\u547d\u540d\u7a7a\u95f4\u6a21\u7248\u3002\u8fd9\u4e00\u7279\u6027\u5c06\u5141\u8bb8\u7528\u6237\u628a\u6a21\u7248\u653e\u5728\u4e0d\u540c\u7684\u5e26\u6709\u547d\u540d\u7a7a\u95f4\u7684\u76ee\u5f55\u4e0b\u3002 \u5f53\u4f7f\u7528 setPaths() \u3001 addPath() \u4ee5\u53ca prependPath() \u65b9\u6cd5\u65f6\uff0c\u628a\u547d\u540d\u7a7a\u95f4\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u8fdb\u884c\u4f20\u9012\uff08\u5982\u679c\u6ca1\u6709\u4f20\u9012\uff0c\u7f3a\u7701\u547d\u540d\u7a7a\u95f4\u4e3a\"main\"\uff09\uff1a $loader->addPath($templateDir, 'admin'); \u547d\u540d\u7a7a\u95f4\u6a21\u7248\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3c\u4e8e @namespace_name/template_path \u7684\u6ce8\u89e3\u5f62\u5f0f\u6765\u8bbf\u95ee\u3002 $twig->render('@admin/index.html', array()); Twig_Loader_Array Twig_Loader_Array\u4ecePHP\u6570\u7ec4\u4e2d\u52a0\u8f7d\u6a21\u7248 {% raw %} $loader = new Twig_Loader_Array(array( 'index.html' => 'Hello {{ name }}!',)); $twig = new Twig_Environment($loader); echo $twig->render('index.html', array('name' => 'Fabien')); {% endraw %} \u8fd9\u4e2a\u52a0\u8f7d\u5668\u5bf9\u4e8e\u5355\u5143\u6d4b\u8bd5\u975e\u5e38\u6709\u7528\u3002\u8fd9\u4e2a\u52a0\u8f7d\u5668\u9002\u5408\u4e8e\u90a3\u4e9b\u9700\u8981\u628a\u6240\u6709\u7684\u6a21\u7248\u90fd\u5b58\u5728\u5728\u4e00\u4e2a\u5355\u72ecphp\u6587\u4ef6\u7684\u5c0f\u578b\u9879\u76ee\u4e2d\u3002 Twig_Loader_Chain Twig_Loader_Chain\u59d4\u6258\u5176\u5b83\u52a0\u8f7d\u5668\u52a0\u5728\u6a21\u7248 {% raw %} $loader1 = new Twig_Loader_Array(array( 'base.html' => '{% block content %}{% endblock %}', )); $loader2 = new Twig_Loader_Array(array( 'index.html' => '{% extends \"base.html\" %}{% block content %}Hello {{ name }}{% endblock %}', 'base.html' => 'Will never be loaded', )); $loader = new Twig_Loader_Chain(array($loader1, $loader2)); $twig = new Twig_Environment($loader); {% endraw %} \u5f53\u641c\u7d22\u6a21\u7248\u7684\u65f6\u5019\uff0cTwig\u4f1a\u4f9d\u6b21\u5c1d\u8bd5\u6bcf\u4e00\u4e2a\u52a0\u8f7d\u5668\uff0c\u4e00\u65e6\u627e\u5230\u5339\u914d\u6a21\u7248\uff0c\u7acb\u5373\u8fd4\u56de\u3002\u5f53\u6e32\u67d3\u4e0a\u8ff0\u4f8b\u5b50\u4e2d\u7684index.html\u6a21\u7248\u65f6\uff0cTwig\u4f1a\u5728 loader2\u4e2d\u52a0\u8f7d\u5b83\uff0c\u4f46\u662f\u5bf9\u4e8ebase.html\u6a21\u7248\uff0cTwig\u4f1a\u4ece loader2\u4e2d\u52a0\u8f7d\u5b83\uff0c\u4f46\u662f\u5bf9\u4e8ebase.html\u6a21\u7248\uff0cTwig\u4f1a\u4ece loader1\u4e2d\u52a0\u8f7d\u3002 Twig_Loader_Chain\u63a5\u53d7\u4efb\u4f55\u5b9e\u73b0\u4e86Twig_LoaderInterface\u63a5\u53e3\u7684\u52a0\u8f7d\u5668 \u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7addLoader()\u65b9\u6cd5\u6dfb\u52a0\u52a0\u8f7d\u5668","title":"\u5185\u7f6e\u52a0\u8f7d\u5668"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_34","text":"\u5b9e\u73b0\u4e86Twig_LoaderInterface\u63a5\u53e3\u7684\u52a0\u8f7d\u5668\uff1a interface Twig_LoaderInterface { /** * Gets the source code of a template, given its name. * * @param string $name string The name of the template to load * * @return string The template source code */ function getSource($name); /** * Gets the cache key to use for the cache for a given template name. * * @param string $name string The name of the template to load * * @return string The cache key */ function getCacheKey($name); /** * Returns true if the template is still fresh. * * @param string $name The template name * @param timestamp $time The last modification time of the cached template */ function isFresh($name, $time); } \u5982\u679c\u5f53\u524d\u7684\u7f13\u5b58\u6a21\u7248\u8fd8\u662f\u6700\u65b0\u7684\uff0cisFresh()\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56detrue\uff0c\u5426\u5219\u5e94\u8be5\u8fd4\u56de\u6700\u540e\u4e00\u6b21\u7684\u4fee\u6539\u65f6\u95f4\uff0c\u6216\u8005\u76f4\u63a5false Twig 1.11.0\uff0c\u8fd8\u53ef\u4ee5\u5b9e\u73b0Twig_ExistsLoaderInterface\u63a5\u53e3\uff0c\u8ba9\u52a0\u8f7d\u5668\u5728\u540c\u94fe\u5f0f\u52a0\u8f7d\u5668\u534f\u540c\u5de5\u4f5c\u65f6\u7a0d\u5feb\u4e00\u4e9b\u3002","title":"\u521b\u5efa\u81ea\u5df1\u7684\u52a0\u8f7d\u5668"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_35","text":"Twig\u6269\u5c55\u662f\u6253\u5305\u8d77\u6765\u7684\u4e00\u4e9b\u65b0\u529f\u80fd\u3002\u4f7f\u7528\u6269\u5c55\u5f88\u7b80\u5355\uff0c\u8c03\u7528addExtension()\u65b9\u6cd5\uff1a $twig->addExtension(new Twig_Extension_Sandbox()); Twig\u81ea\u5e26\u4e86\u4ee5\u4e0b\u6269\u5c55\uff1a Twig_Extension_Core\uff1a\u5b9a\u4e49\u4e86Twig\u7684\u6240\u6709\u6838\u5fc3\u7279\u6027 Twig_Extension_Escaper\uff1a\u6dfb\u52a0\u81ea\u52a8\u8f93\u51fa\u8f6c\u4e49\uff0c\u4ee5\u53ca\u4ee3\u7801\u5e93\u53ef\u80fd\u9700\u8981\u7684\u8f6c\u4e49\u6216\u8005\u53cd\u8f6c\u4e49 Twig_Extension_Sandbox\uff1a\u4e3aTwig\u73af\u5883\u6dfb\u52a0\u4e00\u4e2a\u9ed8\u8ba4\u7684\u6c99\u76d2\u6a21\u5f0f\uff0c\u4f7f\u4e0d\u4fe1\u4efb\u7684\u53ef\u4ee5\u5b89\u5168\u7684\u8fd0\u884c Twig_Extension_Profiler\uff1a\u542f\u7528\u5185\u7f6e\u7684Twig profiler Twig_Extension_Optimizer\uff1a\u7f16\u8bd1\u524d\u4f18\u5316\u8282\u70b9\u6811 \u6838\u5fc3\u3001\u8f6c\u4e49\u3001\u4ee5\u53ca\u4f18\u5316\u6269\u5c55\u4e0d\u9700\u8981\u6dfb\u52a0\u5230Twig\u73af\u5883\u4e2d\uff0c\u4ed6\u4eec\u9ed8\u8ba4\u5c31\u662f\u542f\u7528\u7684","title":"\u4f7f\u7528\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_36","text":"\u8fd9\u5757\u513f\u5c06\u4f1a\u63cf\u8ff0\u5185\u7f6e\u6269\u5c55\u5e26\u6765\u7684\u65b0\u7279\u6027","title":"\u5185\u7f6e\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_37","text":"core\u6269\u5c55\u5b9a\u4e49\u4e86Twig\u7684\u6240\u6709\u6838\u5fc3\u7279\u6027\uff1a Tags Filters Functions Tests","title":"\u6838\u5fc3\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_38","text":"escaper\u6269\u5c55\u4e3aTwig\u5e26\u6765\u4e86\u81ea\u52a8\u8f93\u51fa\u8f6c\u4e49\uff0c\u5b83\u5b9a\u4e49\u4e86autoescape\u6807\u8bb0\uff0craw filter\u3002 \u81ea\u884c\u521b\u5efaescaper\u6269\u5c55\u65f6\uff0c\u4f60\u53ef\u4ee5\u6253\u5f00\u6216\u8005\u5173\u95ed\u5168\u5c40\u7684\u8f6c\u4e49\u7b56\u7565\uff1a $escaper = new Twig_Extension_Escaper('html'); $twig->addExtension($escaper); \u5982\u679c\u8bbe\u7f6e\u6210html\uff0c\u6a21\u7248\u4e2d\u6240\u6709\u7684\u53d8\u91cf\u90fd\u4f1a\u8f6c\u4e49\uff0c\u9664\u4e86\u90a3\u4e9braw filter\u8f93\u51fa\u7684 {% raw %} {{ article.to_html|raw }} {% endraw %} \u901a\u8fc7\u4f7f\u7528autoescape\u6807\u8bb0\uff0c\u4f60\u53ef\u4ee5\u6539\u53d8\u8f6c\u79fb\u6a21\u5f0f\uff08\u53c2\u8003 autoescape\u6587\u6863 \uff09 {% raw %} {% autoescape 'html' %} {{ var }} {{ var|raw }} {# var \u4e0d\u4f1a\u88ab\u8f6c\u4e49 #} {{ var|escape }} {# var \u4e0d\u4f1a\u88ab\u518d\u6b21\u8f6c\u4e49 #} {% endautoescape %} {% endraw %} autoescape\u6807\u8bb0\u5bf9\u5305\u542b\u8fdb\u6765\u7684\u6a21\u7248\u65e0\u6548 \u8f6c\u4e49\u89c4\u5219\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\uff1a \u6a21\u677f\u4e2d\u7684\u5e38\u91cf\uff08\u6574\u6570\u3001\u5e03\u5c14\u3001\u6570\u7ec4...\uff09\u4f1a\u76f4\u63a5\u5f53\u505a\u53d8\u91cf\u6216filter\u7684\u53c2\u6570\uff0c\u4e0d\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e49\uff1a {% raw %} {{ \"Twig<br />\" }} {# won't be escaped #} {% set text = \"Twig<br />\" %} {{ text }} {# will be escaped #} {% endraw %} \u5bf9\u4e8e\u4e00\u4e2a\u7ed3\u679c\u662f\u5e38\u91cf\u7684\u8868\u8fbe\u5f0f\uff0c\u6216\u8005\u4e00\u4e2a\u6807\u8bb0\u4e3a\u5b89\u5168\u7684\u53d8\u91cf\u4e5f\u4e0d\u4f1a\u81ea\u52a8\u8f6c\u4e49\uff1a {% raw %} {{ foo ? \"Twig<br />\" : \"<br />Twig\" }} {# won't be escaped #} {% set text = \"Twig<br />\" %} {{ foo ? text : \"<br />Twig\" }} {# will be escaped #} {% set text = \"Twig<br />\" %} {{ foo ? text|raw : \"<br />Twig\" }} {# won't be escaped #} {% set text = \"Twig<br />\" %} {{ foo ? text|escape : \"<br />Twig\" }} {# the result of the expression won't be escaped #} {% endraw %} \u8f6c\u4e49\u53d1\u751f\u5728\u6253\u5370\u4e4b\u524d\uff0cfilter\u4e4b\u540e\uff1a {% raw %} {{ var|upper }} {# \u7b49\u4ef7\u4e8e {{ var|upper|escape }} #} {% endraw %} raw filter\u5e94\u8be5\u5728filter\u94fe\u7684\u6700\u540e\u4f7f\u7528\uff1a {% raw %} {{ var|raw|upper }} {# \u4f1a\u8f6c\u4e49 #} {{ var|upper|raw }} {# \u4e0d\u8f6c\u4e49 #} {% endraw %} \u5982\u679c\u6700\u540e\u4e00\u4e2afilter\u5728\u5f53\u524d\u4e0a\u4e0b\u6587\u4e2d\uff08\u4f8b\u5982html\u6216\u8005js\uff09\u88ab\u6807\u8bb0\u4e3a\u5b89\u5168\uff0cescape\u548cescape('html')\u88abHTML\u6807\u8bb0\u4e3a\u5b89\u5168\uff0cescape('js')\u88abJavaScript\u6807\u8bb0\u4e3a\u5b89\u5168\uff0craw\u5bf9\u6240\u6709\u5185\u5bb9\u90fd\u88ab\u6807\u8bb0\u4e3a\u5b89\u5168\u3002 {% raw %} {% autoescape 'js' %} {{ var|escape('html') }} {# will be escaped for HTML and JavaScript #} {{ var }} {# will be escaped for JavaScript #} {{ var|escape('js') }} {# won't be double-escaped #} {% endautoescape %} {% endraw %} {% raw %} \u6ce8\u610f\u81ea\u52a8\u8f6c\u4e49\u662f\u662f\u5728\u8868\u8fbe\u5f0f\u8fd0\u884c\u4e4b\u540e\u53d1\u751f\uff0c\u56e0\u6b64\u6709\u5c40\u9650\u6027\u7684\u3002\u4f8b\u5982\u5f53\u8fdb\u884c\u8fde\u7eed\u64cd\u4f5c\u65f6\uff0c{{ foo|raw ~ bar }}\u56e0\u4e3a\u8f6c\u4e49\u662f\u6700\u540e\u53d1\u751f\u7684\uff0c\u56e0\u6b64\u65e0\u6cd5\u7ed9\u51fa\u671f\u5f85\u7684\u7ed3\u679c\uff08\u8fd9\u91cc\u7684raw filter\u6ca1\u6709\u4efb\u4f55\u6548\u679c\uff09\u3002 {% endraw %}","title":"\u8f6c\u4e49\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_39","text":"\u6c99\u7bb1\u6269\u5c55\u7528\u4e8e\u8fd0\u884c\u4e0d\u53d7\u4fe1\u4efb\u7684\u4ee3\u7801,\u4f1a\u9650\u5236\u8bbf\u95ee\u4e0d\u5b89\u5168\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002\u6c99\u7bb1\u5b89\u5168\u6027\u7531\u4e00\u4e2a\u7b56\u7565\u5b9e\u4f8b\u6765\u7ba1\u7406\u3002\u7f3a\u7701\u60c5\u51b5\u4e0b\uff0cTwig\u4f1a\u5e26\u6709\u4e00\u4e2a\u7b56\u7565\u7c7b\uff1aTwig_Sandbox_SecurityPolicy\u3002\u8fd9\u4e2a\u7c7b\u5141\u8bb8\u628a\u67d0\u4e9b\u6807\u8bb0\u3001Filter\u3001\u5c5e\u6027\u4ee5\u53ca\u65b9\u6cd5\u653e\u5165\u767d\u540d\u5355\uff1a $tags = array('if'); $filters = array('upper'); $methods = array( 'Article' => array('getTitle', 'getBody'), ); $properties = array( 'Article' => array('title', 'body'), ); $functions = array('range'); $policy = new Twig_Sandbox_SecurityPolicy($tags, $filters, $methods, $properties, $functions); \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5b89\u5168\u7b56\u7565\u53ea\u5141\u8bb8\u4f7f\u7528if\u6807\u7b7e\u548cupper\u8fc7\u6ee4\u5668\u3002\u53e6\u5916\uff0c\u6a21\u7248\u53ea\u80fd\u8c03\u7528 Article \u5bf9\u8c61\u7684 getTitle() \u65b9\u6cd5\u548c getBody() \u65b9\u6cd5\uff0c\u53ea\u80fd\u8bbf\u95ee title \u548c body \u8fd9\u4fe9\u4e2a\u516c\u5171\u5c5e\u6027\u3002\u5176\u5b83\u7684\u90fd\u88ab\u7981\u6b62\u8bbf\u95ee\uff0c\u5982\u679c\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u5219\u4f1a\u629b\u51fa\u4e00\u4e2a Twig_Sandbox_SecurityError \u5f02\u5e38\u3002 \u7b56\u7565\u5bf9\u8c61\u662f\u6c99\u76d2\u6784\u9020\u5668\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a $sandbox = new Twig_Extension_Sandbox($policy); $twig->addExtension($sandbox); \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6c99\u76d2\u6a21\u5f0f\u5904\u4e8e\u7981\u7528\u72b6\u6001\u3002\u5f53\u5305\u542b\u7684\u6a21\u7248\u4e2d\u542b\u6709\u4e0d\u53ef\u4fe1\u7684\u4ee3\u7801\u65f6\uff0c\u4f7f\u7528 sandbox \u6807\u7b7e\u6fc0\u6d3b\u6c99\u76d2\u6a21\u5f0f\u3002 {% raw %} {% sandbox %} {% include 'user.html' %} {% endsandbox %} {% endraw %} \u4f60\u53ef\u4ee5\u901a\u8fc7\u5c06\u6269\u5c55\u6784\u9020\u5668\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u503ctrue\u6765\u5bf9\u6240\u6709\u7684\u6a21\u7248\u542f\u7528\u6c99\u76d2\u6a21\u5f0f\uff1a $sandbox = new Twig_Extension_Sandbox($policy, true);","title":"\u6c99\u76d2\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_40","text":"Twig1.18\u65b0\u589e\u7b80\u4ecb\u6269\u5c55 profiler\u6269\u5c55\u4e3aTwig\u6a21\u7248\u5f00\u542f\u4e00\u4e2aprofiler\uff0c\u5b83\u5e94\u8be5\u53ea\u5728\u5f00\u53d1\u673a\u5668\u4e0a\u4f7f\u7528\u3002 $profile = new Twig_Profiler_Profile(); $twig->addExtension(new Twig_Extension_Profiler($profile)); $dumper = new Twig_Profiler_Dumper_Text(); echo $dumper->dump($profile); \u4e00\u4e2aprofile\u5305\u542b\u4e86\u6a21\u7248\uff0c\u5757\u4ee5\u53ca\u5b8f\u6269\u5c55\u7684\u8017\u65f6\u548c\u5185\u5b58\u6d88\u8017\u4fe1\u606f\u3002 \u4f60\u8fd8\u53ef\u4ee5\u4ee5 blackfire.io \u517c\u5bb9\u683c\u5f0fdump\u8fd9\u4e9b\u6570\u636e\u3002 $dumper = new Twig_Profiler_Dumper_Blackfire(); file_put_contents('/path/to/profile.prof', $dumper->dump($profile)); \u4e0a\u4f20\u5e76\u663e\u793a\u5b83(\u5148\u521b\u5efa\u4e2a \u514d\u8d39\u5e10\u53f7 ) blackfire --slot = 7 upload /path/to/profile.prof","title":"\u7b80\u4ecb\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_41","text":"optimizer\u6269\u5c55\u4f1a\u5728\u7f16\u8bd1\u6a21\u677f\u4e4b\u524d\u5bf9\u8282\u70b9\u6811\u8fdb\u884c\u4f18\u5316\uff1a $twig->addExtension(new Twig_Extension_Optimizer()); \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684\u4f18\u5316\u90fd\u662f\u542f\u7528\u7684\u3002\u4f60\u4e5f\u53ef\u4ee5\u5728\u6784\u9020\u5668\u4e2d\u4f20\u9012\u60a8\u9700\u8981\u6fc0\u6d3b\u7684\u6269\u5c55\u3002 $optimizer = new Twig_Extension_Optimizer(Twig_NodeVisitor_Optimizer::OPTIMIZE_FOR); $twig->addExtension($optimizer); Twig\u652f\u6301\u4e0b\u5217\u4f18\u5316\uff1a Twig_NodeVisitor_Optimizer\uff1aOPTIMIZE_ALL \u9ed8\u8ba4\u503c\uff0c\u542f\u7528\u6240\u6709\u4f18\u5316 Twig_NodeVisitor_Optimizer\uff1aOPTIMIZE_NONE \u7981\u7528\u6240\u6709\u7684\u4f18\u5316\uff0c\u8fd9\u56de\u51cf\u5c11\u7f16\u8bd1\u65f6\u95f4\uff0c\u4f46\u662f\u4f1a\u589e\u52a0\u6267\u884c\u65f6\u95f4\u548c\u5185\u5b58\u6d88\u8017\u3002 Twig_NodeVisitor_Optimizer::OPTIMIZE_FOR \u5c3d\u53ef\u80fd\u51cf\u5c11loop\u53d8\u91cf\u7684\u521b\u5efa\uff0c\u4ee5\u63d0\u9ad8for\u6807\u8bb0\u7684\u6548\u7387\u3002 Twig_NodeVisitor_Optimizer::OPTIMIZE_RAW_FILTER \u5c3d\u53ef\u80fd\u79fb\u51faraw filter Twig_NodeVisitor_Optimizer::OPTIMIZE_VAR_ACCESS \u5c3d\u53ef\u80fd\u7684\u7b80\u5316\u7f16\u8bd1\u6a21\u7248\u4e2d\u53d8\u91cf\u7684\u521b\u5efa\u548c\u8bbf\u95ee","title":"\u4f18\u5316\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_42","text":"Twig\u80fd\u629b\u51fa\u7684\u5f02\u5e38\uff1a Twig_Error\uff1a\u6240\u6709\u5f02\u5e38 Twig_Error_Syntax\uff1a\u8bed\u6cd5\u9519\u8bef Twig_Error_Runtime\uff1a\u8fd0\u884c\u65f6\u9519\u8bef\uff08\u5f53\u524d\u5b9e\u4f8b\u4e2d\u4e0d\u5305\u542b\u67d0\u4e2afilter\uff09 Twig_Error_Loader\uff1a\u6a21\u677f\u8f7d\u5165\u65f6\u7684\u5f02\u5e38 Twig_Sandbox_SecurityError: \u6c99\u76d2\u6a21\u5f0f\u4e0b\u51fa\u73b0\u4e86\u4e0d\u5141\u8bb8\u4f7f\u7528\u7684\u6807\u8bb0\uff0cfilter\u6216\u8005\u8c03\u7528\u4e86\u4e0d\u5141\u8bb8\u8c03\u7528\u7684\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38","title":"\u5f02\u5e38"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#twig_2","text":"\u672c\u7ae0\u63cf\u8ff0\u4e86\u5982\u4f55\u5bf9Twig 1.12\u8fdb\u884c\u6269\u5c55\u3002\u5982\u679c\u4f60\u5728\u4f7f\u7528\u4e00\u4e2a\u65e7\u7248\u672c\uff0c\u8bf7\u79fb\u6b65\u5230 \u8fc7\u5f80\u6587\u6863 \u7ee7\u7eed\u9605\u8bfb\u3002 \u6709\u591a\u91cd\u6269\u5c55Twig\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u52a0\u5165\u989d\u5916\u7684\u6807\u8bb0\u3001Filter\u3001Test\u3001\u64cd\u4f5c\u7b26\u3001\u5168\u5c40\u53d8\u91cf\u4ee5\u53ca\u51fd\u6570\uff0c\u751a\u81f3\u8fd8\u80fd\u5229\u7528Node visitors\u5bf9\u89e3\u6790\u5668\u672c\u8eab\u8fdb\u884c\u6269\u5c55\u3002 \u672c\u6587\u7684\u7b2c\u4e00\u7ae0\u8282\u4f1a\u4ecb\u7ecd\u5982\u4f55\u7b80\u5355\u5730\u6269\u5c55Twig\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u4e0d\u540c\u9879\u76ee\u4e2d\u8fdb\u884c\u590d\u7528\uff0c\u6216\u8005\u5171\u4eab\u7ed9\u4ed6\u4eba\u4f7f\u7528\uff0c\u4f60\u5e94\u8be5\u6309\u7167\u63a5\u4e0b\u6765\u7ae0\u8282\u63cf\u8ff0\u7684\u90a3\u6837\u521b\u5efa\u4e00\u4e2a\u6269\u5c55\u3002 \u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u4f60\u5fc5\u987b\u7406\u89e3\u4e0d\u540c\u6269\u5c55\u70b9\u7684\u533a\u522b\u53ca\u5176\u5e94\u7528\u573a\u666f\u3002 \u9996\u5148\uff0c\u4f60\u9700\u8981\u8bb0\u4f4f\u7684\u662f\uff0cTwig\u6709\u4e24\u4e2a\u4e3b\u8981\u7684\u8bed\u6cd5\u7ed3\u6784\uff1a {% raw %} - {{}}\uff1a\u7528\u6765\u8f93\u51fa\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c - {%%}\uff1a\u7528\u6765\u6267\u884c\u8bed\u53e5 {% endraw %} \u8981\u7406\u89e3\u4e3a\u4ec0\u4e48Twig\u63d0\u4f9b\u8fd9\u4e48\u591a\u6269\u5c55\u70b9\uff0c\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a Lorem ipsum \u751f\u6210\u5668\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3a lipsum \u7684\u6807\u8bb0\uff1a {% raw %} {% lipsum 40 %} {% endraw %} \u8fd9\u6837\u7684\u786e\u53ef\u4ee5\u8d77\u5230\u6548\u679c\uff0c\u4f46\u662f\uff0c\u4f7f\u7528 lipsum \u6807\u8bb0\u7684\u786e\u4e0d\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\uff0c\u56e0\u4e3a\uff1a lipsum\u4e0d\u662f\u4e00\u4e2a\u8bed\u8a00\u7ed3\u6784 \u8fd9\u4e2a\u6807\u8bb0\u8f93\u51fa\u4e86\u4e1c\u897f \u8fd9\u4e2a\u6807\u8bb0\u4e0d\u591f\u7075\u6d3b\uff0c\u4e0d\u80fd\u5728\u8868\u8fbe\u5f0f\u4e2d\u590d\u7528 {% raw %} {{ 'some text' ~ {% lipsum 40 %} ~ 'some more text' }} {% endraw %} \u4e8b\u5b9e\u4e0a\uff0c\u4f60\u5f88\u5c11\u4f1a\u4f7f\u7528\u6807\u8bb0\uff1b\u4e0d\u8fc7\u8fd9\u4e5f\u662f\u4e2a\u597d\u6d88\u606f\u2014\u2014Tag\u7684\u6269\u5c55\u662fTwig\u6269\u5c55\u65b9\u5f0f\u4e2d\u6700\u590d\u6742\u7684\u4e00\u79cd\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u8bd5\u8bd5filter\u7684\u65b9\u5f0f\uff1a {% raw %} {{ 40|lipsum }} {% endraw %} \u518d\u4e00\u6b21\uff0c\u5b83\u8fbe\u5230\u4e86\u6548\u679c\uff0c\u4f46\u662f\u5374\u770b\u4e0a\u53bb\u5f88\u53e4\u602a\u3002filter\u7528\u6765\u628a\u8f93\u5165\u8f6c\u6362\u6210\u8f93\u51fa\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u8f93\u5165\u4e86\u7684\u503c\u662f\u7528\u4e8e\u6307\u793a\u751f\u6210\u5355\u8bcd\u7684\u6570\u91cf\u2014\u2014\u4e5f\u5c31\u662f\u8bf4\uff0c40\u662f\u4e00\u4e2a\u53c2\u6570\uff0c\u4f46\u4e0d\u662f\u6211\u4eec\u8f6c\u6362\u7684\u76ee\u6807\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f7f\u7528 lipsum \u51fd\u6570\uff1a {% raw %} {{ lipsum(40) }} {% endraw %} \u8fd9\u91cc\u6211\u4eec\u4e5f\u6210\u529f\u4e86\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6269\u5c55\u70b9\u7684\u9009\u62e9\u662f\u5408\u9002\u7684\u3002\u73b0\u5728\u53ef\u4ee5\u5728\u4efb\u4f55\u63a5\u53d7\u8868\u8fbe\u5f0f\u7684\u5730\u65b9\u4f7f\u7528\u5b83\u4e86\u3002 {% raw %} {{ 'some text' ~ lipsum(40) ~ 'some more text' }} {% set lipsum = lipsum(40) %} {% endraw %} \u6700\u540e\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5e26\u6709\u65b9\u6cd5\u7684\u5168\u5c40\u5bf9\u8c61\u6765\u751f\u6210\u8fd9\u4e9b\u6587\u5b57\uff1a {% raw %} {{ text.lipsum(40) }} {% endraw %}","title":"\u6269\u5c55Twig"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_43","text":"\u5168\u5c40\u53d8\u91cf\u548c\u5176\u5b83\u7684\u6a21\u7248\u53d8\u91cf\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5168\u5c40\u53d8\u91cf\u5728\u6240\u6709\u7684\u6a21\u7248\u548c\u5b8f\u5b9a\u4e49\u4e2d\u90fd\u6709\u6548\uff1a $twig = new Twig_Environment($loader); $twig->addGlobal('text', new Text()); \u63a5\u4e0b\u6765\u4f60\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u4f7f\u7528 text \u53d8\u91cf\u4e86\u3002 {% raw %} {{ text.lipsum(40) }} {% endraw %}","title":"\u5168\u5c40\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filters_1","text":"\u521b\u5efa\u4e00\u4e2afilter\u5c31\u662f\u7b80\u5355\u7684\u7ed9\u4e00\u4e2aPHP\u56de\u8c03\u4e00\u4e2a\u540d\u5b57\uff1a // \u533f\u540d\u51fd\u6570 $filter = new Twig_SimpleFilter('rot13', function ($string) { return str_rot13($string); }); // \u6216\u8005\u4e00\u4e2a\u7b80\u5355\u7684php\u51fd\u6570 $filter = new Twig_SimpleFilter('rot13', 'str_rot13'); // \u6216\u8005\u4e00\u4e2a\u7c7b\u7684\u65b9\u6cd5 $filter = new Twig_SimpleFilter('rot13', array('SomeClass', 'rot13Filter')); \u4f20\u9012\u7ed9 Twig_SimpleFilter \u6784\u9020\u5668\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5c06\u8981\u5728\u6a21\u7248\u4e2d\u4f7f\u7528\u7684filter\u7684\u540d\u5b57\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5173\u4e8e\u8fd9\u4e2a\u53c2\u6570\u7684php\u56de\u8c03\u51fd\u6570\u3002 \u63a5\u4e0b\u6765\uff0c\u5c06filter\u52a0\u5165\u5230\u4f60\u7684Twig\u73af\u5883\u4e2d\uff1a $twig = new Twig_Environment($loader); $twig->addFilter($filter); \u7136\u540e\u5c31\u53ef\u4ee5\u5728\u6a21\u7248\u4e2d\u4f7f\u7528\u4e86\uff1a {% raw %} {{ 'Twig'|rot13 }} {# \u8f93\u51fa\uff1a Gjvt #} {% endraw %} \u5f53Twig\u8c03\u7528\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u7ba1\u9053\u7b26\u5de6\u8fb9\u7684\u503c\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u5e76\u628a\u62ec\u53f7\u4e2d\u7684Filter\u53c2\u6570\u4f5c\u4e3a\u9644\u52a0\u53c2\u6570\u4f20\u9012\u7ed9\u56de\u8c03\u3002 \u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\uff1a {% raw %} {{ 'TWIG'|lower }} {{ now|date('d/m/Y') }} {% endraw %} \u4f1a\u88ab\u7f16\u8bd1\u6210\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a <?php echo strtolower ( 'TWIG' ) ?> <?php echo twig_date_format_filter ( $now , 'd/m/Y' ) ?> Twig_SimpleFilter \u7c7b\u5c06\u9009\u9879\u6570\u7ec4\u4f5c\u4e3a\u5b83\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u3002 $filter = new Twig_SimpleFilter('rot13', 'str_rot13', $options);","title":"Filters"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filter","text":"\u5982\u679c\u8981\u5728filter\u4e2d\u8bbf\u95ee\u5f53\u524d\u7684environment\u5b9e\u4f8b\uff0c\u9700\u8981\u5728option\u4e2d\u8bbe\u7f6eneeds_environment\u4e3atrue\uff1b\u8fd9\u6837Twig\u5c31\u4f1a\u628a\u5f53\u524d\u73af\u5883\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u7ed9filter\uff1a $filter = new Twig_SimpleFilter('rot13', function (Twig_Environment $env, $string) { // \u83b7\u53d6\u5f53\u524d\u5b9e\u4f8b\u7684\u5b57\u7b26\u96c6 $charset = $env->getCharset(); return str_rot13($string); }, array('needs_environment' => true));","title":"Filter\u73af\u5883\u611f\u77e5"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filter_1","text":"\u5728Twig\u4e2d\u8bbf\u95ee\u4e0a\u4e0b\u6587\uff0c\u5219\u9700\u8981\u5728option\u4e2d\u8bbe\u7f6eneeds_context\u4e3atrue\uff0cTwig\u5c31\u4f1a\u5427\u5f53\u524d\u4e0a\u4e0b\u6587\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\uff08\u5982\u679c\u8fd8\u8bbe\u7f6e\u4e86needs_environment\u4e3atrue\uff0c\u90a3\u4e48\u5c31\u4f1a\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff09\u8fdb\u884c\u4f20\u9012\uff1a $filter = new Twig_SimpleFilter('rot13', function ($context, $string) { // ... }, array('needs_context' => true)); $filter = new Twig_SimpleFilter('rot13', function (Twig_Environment $env, $context, $string) { // ... }, array('needs_context' => true, 'needs_environment' => true));","title":"Filter\u4e0a\u4e0b\u6587\u611f\u77e5"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_44","text":"\u5982\u679c\u542f\u7528\u4e86\u81ea\u52a8\u8f6c\u4e49\uff0cfilter\u7684\u8f93\u51fa\u4f1a\u5728\u6253\u5370\u4e4b\u524d\u88ab\u8f6c\u4e49\u3002\u5982\u679c\u4f60\u7684filter\u5c31\u662f\u4f5c\u4e3a\u4e00\u4e2a\u8f6c\u4e49\u5668\uff08\u6216\u8005\u663e\u5f0f\u7684\u8f93\u51faHTML\u4ee5\u53caJavaScript\u4ee3\u7801\uff09\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u8f93\u51fa\u539f\u6587\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528is_safe\u9009\u9879\uff1a $filter = new Twig_SimpleFilter('nl2br', 'nl2br', array('is_safe' => array('html')));","title":"\u81ea\u52a8\u8f6c\u4e49"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filters_2","text":"Twig1.19\u4e2d\u65b0\u589e\u53ef\u53d8\u53c2\u6570filters \u5f53\u9700\u8981\u4e00\u4e2afilter\u63a5\u6536\u7684\u53c2\u6570\u4e2a\u6570\u53ef\u53d8\u65f6\uff0c\u8bbe\u7f6e is_variadic \u9009\u9879\u4e3atrue\uff1bTwig\u4f1a\u628a\u4f59\u4e0b\u7684\u53c2\u6570\u4f5c\u4e3a\u4e00\u4e2a\u6570\u7ec4\u4f20\u9012\u7ed9filter\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff1a $filter = new Twig_SimpleFilter('thumbnail', function ($file, array $options = array()) { // ... }, array('is_variadic' => true));","title":"\u53c2\u6570\u53ef\u53d8\u7684Filters"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filters_3","text":"\u540d\u5b57\u4e2d\u5e26\u6709\u7279\u6b8a\u5b57\u7b26\u201d*\u201c\u7684filter\u5c31\u662f\u4e00\u4e2a\u52a8\u6001filter\uff1a $filter = new Twig_SimpleFilter('*_path', function ($name, $arguments) { // ... }); \u4e0a\u9762\u5b9a\u4e49\u7684\u52a8\u6001filter\u5c06\u4f1a\u5339\u914d\u4e0b\u8ff0\u5217\u8868\uff1a product_path category_path \u52a8\u6001Filter\u80fd\u591f\u5b9a\u4e49\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u901a\u914d\u7b26\u90e8\u5206\uff1a $filter = new Twig_SimpleFilter('*_path_*', function ($name, $suffix, $arguments) { // ... }); \u8fd9\u4e2aFilter\u80fd\u591f\u63a5\u53d7\u6240\u6709\u7684\u52a8\u6001\u503c\uff0c\u5e76\u6446\u653e\u5728\uff08\u73af\u5883\u548c\u4e0a\u4e0b\u6587\u4e4b\u540e\uff09\u5176\u4ed6\u53c2\u6570\u4e4b\u524d\u3002\u4f8b\u5982\uff0c\u5bf9'foo'|a_path_b()\u7684\u8c03\u7528\uff0c\u4f1a\u4f20\u9012\u8fd9\u4e9b\u53c2\u6570\uff1a('a', 'b', 'foo')\u3002","title":"\u52a8\u6001Filters"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_45","text":"\u51fd\u6570\u7684\u5b9a\u4e49\u7c7b\u4f3c\u4e8efilter\uff0c\u4f46\u662f\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a Twig_SimpleFunction \u7684\u5b9e\u4f8b\uff1a $twig = new Twig_Environment($loader); $function = new Twig_SimpleFunction('function_name', function () { // ... }); $twig->addFunction($function);","title":"\u51fd\u6570"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#tests","text":"Tests\u7684\u5b9a\u4e49\u548cfilter\u548c\u51fd\u6570\u7684\u5b9a\u4e49\u65b9\u6cd5\u76f8\u540c\uff0c\u4f60\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a Twig_SimpleTest \u5b9e\u4f8b\uff1a $twig = new Twig_Environment($loader); $test = new Twig_SimpleTest('test_name', function () { // ... }); $twig->addTest($test); Tests\u5141\u8bb8\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u5e26\u6709\u903b\u8f91\u5904\u7406\u7684\u5e94\u7528\u6765\u5904\u7406\u5e03\u5c14\u503c\u7684\u6761\u4ef6\u5224\u65ad\u3002\u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u521b\u5efa\u4e00\u4e2aTwig test\u6765\u68c0\u6d4b\u5bf9\u8c61\u662f\u5426\u662f\u2018red\u2019\uff1a $twig = new Twig_Environment($loader); $test = new Twig_SimpleTest('red', function ($value) { if (isset($value->color) && $value->color == 'red') { return true; } if (isset($value->paint) && $value->paint == 'red') { return true; } return false; }); $twig->addTest($test); Test\u51fd\u6570\u53ea\u8fd4\u56detrue/false\u3002 \u5f53\u521b\u5efaTest\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528node_class\u9009\u9879\u6765\u63d0\u4f9b\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u7f16\u5236\u3002\u5982\u679c\u4f60\u7684test\u53ef\u4ee5\u7f16\u8bd1\u6210PHP\u539f\u8bed\uff0c\u8fd9\u4e2a\u529e\u6cd5\u5c31\u5f88\u6709\u7528\u4e86\uff0c\u8fd9\u4e2a\u529e\u6cd5\u5728\u5f88\u591aTwig\u7684\u5185\u7f6eTest\u4e2d\u4f7f\u7528\uff1a $twig = new Twig_Environment($loader); $test = new Twig_SimpleTest( 'odd', null, array('node_class' => 'Twig_Node_Expression_Test_Odd')); $twig->addTest($test); class Twig_Node_Expression_Test_Odd extends Twig_Node_Expression_Test { public function compile(Twig_Compiler $compiler) { $compiler ->raw('(') ->subcompile($this->getNode('node')) ->raw(' % 2 == 1') ->raw(')') ; } }","title":"Tests"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#tags","text":"Twig\u6700\u4ee4\u4eba\u6fc0\u52a8\u7684\u7279\u6027\u5c31\u662f\u53ef\u4ee5\u5b9a\u4e49\u65b0\u7684\u8bed\u8a00\u7ed3\u6784\u3002\u8fd9\u4e5f\u662f\u4f60\u9700\u8981\u7406\u89e3\u7684\u5173\u4e8eTwig\u6700\u590d\u6742\u7684\u5173\u4e8e\u5982\u4f55\u5de5\u4f5c\u7684\u7279\u6027\u3002 \u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684set\u6807\u8bb0\uff0c\u8fd9\u4e2a\u6807\u8bb0\u7528\u6765\u5728\u6a21\u677f\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u7b80\u5355\u53d8\u91cf\uff0c\u8fd9\u4e2a\u6807\u8bb0\u7684\u7528\u6cd5\u5982\u4e0b\uff1a {% raw %} {% set name = \"value\" %} {{ name }} {# \u8f93\u51fa value #} {% endraw %} \u4e09\u4e2a\u6b65\u9aa4\u5373\u53ef\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u6807\u8bb0\uff1a \u5b9a\u4e49\u4e00\u4e2aToken\u89e3\u6790\u5668\uff08\u7528\u6765\u89e3\u6790\u6a21\u677f\u4ee3\u7801\uff09 \u5b9a\u4e49\u4e00\u4e2a\u8282\u70b9\u7c7b(\u7528\u4e8e\u628a\u89e3\u6790\u7684\u7ed3\u679c\u8f6c\u6362\u6210PHP) \u6ce8\u518c\u8fd9\u4e2a\u6807\u8bb0","title":"Tags"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_46","text":"\u7b80\u5355\u7684\u8c03\u7528 Twig_Environment \u5b9e\u4f8b\u7684 addTokenParser \u65b9\u6cd5\u5373\u53ef\u6dfb\u52a0\u4e00\u4e2a\u6807\u8bb0\uff1a $twig = new Twig_Environment($loader); $twig->addTokenParser(new Project_Set_TokenParser());","title":"\u6ce8\u518c\u4e00\u4e2a\u65b0\u7684\u6807\u8bb0"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#token","text":"\u6765\u770b\u4e0b\u4ee3\u7801\u5b9e\u4f8b\uff1a class Project_Set_TokenParser extends Twig_TokenParser { public function parse(Twig_Token $token) { $parser = $this->parser; $stream = $parser->getStream(); $name = $stream->expect(Twig_Token::NAME_TYPE)->getValue(); $stream->expect(Twig_Token::OPERATOR_TYPE, '='); $value = $parser->getExpressionParser()->parseExpression(); $stream->expect(Twig_Token::BLOCK_END_TYPE); return new Project_Set_Node($name, $value, $token->getLine(), $this->getTag()); } public function getTag() { return 'set'; } } getTag() \u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u6211\u4eec\u8981\u89e3\u6790\u7684\u6807\u8bb0\uff0c\u8fd9\u91cc\u8fd4\u56de\u7684\u5c31\u662f set . parse() \u65b9\u6cd5\u5728\u89e3\u6790\u5668\u9047\u5230 set \u6807\u8bb0\u7684\u65f6\u5019\u5c31\u4f1a\u88ab\u8c03\u7528\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u8fd4\u56de\u4e00\u4e2a Twig_Node \u5b9e\u4f8b\u7528\u4e8e\u663e\u793a\u8fd9\u4e2a\u7ed3\u70b9\u3002 Token\u6d41\uff08$this->parser->getStream()\uff09\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u65b9\u6cd5\uff0c\u7b80\u5316\u4e86\u89e3\u6790\u8fc7\u7a0b\uff1a getCurrent()\uff1a\u4ece\u6d41\u4e2d\u83b7\u53d6\u5f53\u524d\u7684token next()\uff1a\u79fb\u52a8\u5230\u6d41\u4e2d\u7684\u4e0b\u4e00\u4e2aToken\uff0c\u5e76\u8fd4\u56de\u4e4b\u524d\u7684\u4e00\u4e2a test( type), test( type), test( value\uff09\u6216\u8005test($type, $value)\uff1a\u5224\u65ad\u5f53\u524dtoken\u662f\u4e0d\u662f\u67d0\u79cd\u7c7b\u578b\u6216\u503c\uff08\u6216\u540c\u65f6\u6ee1\u8db3\uff09\u3002\u503c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5305\u542b\u5f88\u591a\u503c\u7684\u6570\u7ec4\u3002 expect($type[, $value[, $message]])\uff1a\u5982\u679c\u5f53\u524dtoken\u4e0d\u662f\u6307\u5b9a\u7684\u7c7b\u578b\u6216\u503c\uff0c\u5c31\u7ed9\u51fa\u4e00\u4e2a\u8bed\u6cd5\u9519\u8bef\u3002\u5426\u5219\uff0c\u5982\u679c\u503c\u548c\u7c7b\u578b\u90fd\u6b63\u786e\uff0c\u5219\u8fd4\u56de\u5f53\u524dtoken\uff0c\u5e76\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2aToken\u3002 look()\uff1a\u67e5\u770b\u4f46\u4e0d\u4f7f\u7528\u4e0b\u4e00\u4e2atoken \u50cfset\u6807\u8bb0\u8fd9\u6837\uff0c\u901a\u8fc7\u8c03\u7528 parseExpression() \u5b8c\u6210\u5bf9\u8868\u8fbe\u5f0f\u7684\u89e3\u6790\u3002","title":"\u5b9a\u4e49\u4e00\u4e2atoken\u89e3\u6790\u5668"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_47","text":"Project_Set_Node\u7c7b\u5f88\u7b80\u5355\uff1a class Project_Set_Node extends Twig_Node { public function __construct($name, Twig_Node_Expression $value, $line, $tag = null) { parent::__construct(array('value' => $value), array('name' => $name), $line, $tag); } public function compile(Twig_Compiler $compiler) { $compiler ->addDebugInfo($this) ->write('$context[\\''.$this->getAttribute('name').'\\'] = ') ->subcompile($this->getNode('value')) ->raw(\";\\n\") ; } } \u7f16\u8bd1\u5668\u5b9e\u73b0\u4e86\u4e00\u5957\u63a5\u53e3\u548c\u65b9\u6cd5\u7528\u4e8e\u5e2e\u52a9\u5f00\u53d1\u8005\u751f\u6210\u7f8e\u89c2\u6613\u8bfb\u7684PHP\u4ee3\u7801\uff1a subcompile()\uff1a\u7f16\u8bd1\u4e00\u4e2a\u7ed3\u70b9 raw()\uff1a\u539f\u6587\u8f93\u51fa\u5b57\u7b26\u4e32 write()\uff1a\u8f93\u51fa\u9996\u884c\u7f29\u8fdb\u7684\u5b57\u7b26\u4e32 string()\uff1a\u8f93\u51fa\u5f15\u7528\u5b57\u7b26 repr()\uff1a\u8f93\u51faphp\u7ed3\u679c\u503c addDebugInfo()\uff1a\u628a\u4e0e\u5f53\u524d\u8282\u70b9\u76f8\u5173\u7684\u539f\u59cb\u6a21\u677f\u6587\u4ef6\u5f53\u4f5c\u6ce8\u91ca\u6dfb\u52a0\u8fdb\u6765 indent()\uff1a\u7f29\u8fdb\u751f\u6210\u7684\u4ee3\u7801 outdent()\uff1a\u4f38\u51fa\u751f\u6210\u7684\u4ee3\u7801","title":"\u5b9a\u4e49\u4e00\u4e2a\u8282\u70b9"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_48","text":"\u5f00\u53d1\u6269\u5c55\u7684\u4e00\u4e2a\u4e3b\u8981\u76ee\u7684\u53ef\u80fd\u5c31\u662f\u4e3a\u4e86\u5c06\u7ecf\u5e38\u4f7f\u7528\u7684\u529f\u80fd\u89c4\u8303\u79f0\u4e00\u4e2a\u53ef\u590d\u7528\u7684\u7c7b\uff0c\u6bd4\u5982\u8bf4\uff0c\u56fd\u9645\u5316\u652f\u6301\u3002\u4e00\u4e2a\u6269\u5c55\u53ef\u4ee5\u6307\u5b9a\u6807\u8bb0\u3001Filter\u3001Test\u3001\u8fd0\u7b97\u7b26\u3001\u5168\u5c40\u53d8\u91cf\u3001\u51fd\u6570\u4ee5\u53caNode visitors\u3002 \u6269\u5c55\u8fd8\u53ef\u4ee5\u5206\u79bb\u7f16\u8bd1\u65f6\u548c\u8fd0\u884c\u65f6\u7684\u4ee3\u7801\uff0c\u52a0\u5feb\u4ee3\u7801\u7684\u8fd0\u884c\u901f\u5ea6\u3002 \u5927\u591a\u6570\u65f6\u5019\uff0c\u521b\u5efa\u4e00\u4e2a\u5355\u72ec\u7684\u5305\u542b\u6240\u6709\u6807\u8bb0\u548cfilters\u7684\u6269\u5c55\u5c06\u5bf9\u4f60\u7684\u9879\u76ee\u5f88\u6709\u7528\u3002 \u4e00\u4e2a\u6269\u5c55\u5c31\u662f\u4e00\u4e2a\u5b9e\u73b0\u4e86\u4e0b\u9762\u8fd9\u4e2a\u63a5\u53e3\u7684\u7c7b\uff1a interface Twig_ExtensionInterface { /** * Initializes the runtime environment. * * This is where you can load some file that contains filter functions for instance. * * @param Twig_Environment $environment The current Twig_Environment instance * * @deprecated since 1.23 (to be removed in 2.0), implement Twig_Extension_InitRuntimeInterace instead */ function initRuntime(Twig_Environment $environment); /** * Returns the token parser instances to add to the existing list. * * @return array An array of Twig_TokenParserInterface or Twig_TokenParserBrokerInterface instances */ function getTokenParsers(); /** * Returns the node visitor instances to add to the existing list. * * @return array An array of Twig_NodeVisitorInterface instances */ function getNodeVisitors(); /** * Returns a list of filters to add to the existing list. * * @return array An array of filters */ function getFilters(); /** * Returns a list of tests to add to the existing list. * * @return array An array of tests */ function getTests(); /** * Returns a list of functions to add to the existing list. * * @return array An array of functions */ function getFunctions(); /** * Returns a list of operators to add to the existing list. * * @return array An array of operators */ function getOperators(); /** * Returns a list of global variables to add to the existing list. * * @return array An array of global variables * * @deprecated since 1.23 (to be removed in 2.0), implement Twig_Extension_GlobalsInterface instead */ function getGlobals(); /** * Returns the name of the extension. * * @return string The extension name */ function getName(); } \u4e3a\u4e86\u4fdd\u6301\u6269\u5c55\u7c7b\u7684\u6574\u6d01\u4e0e\u7a33\u5b9a\uff0c\u8fd8\u53ef\u4ee5\u53ea\u7ee7\u627f\u5185\u7f6e\u7684 Twig_Extension \u7c7b\u800c\u4e0d\u9700\u8981\u5b9e\u73b0\u6240\u6709\u7684\u63a5\u53e3\u3002\u91c7\u7528\u8fd9\u79cd\u8be5\u65b9\u5f0f\u7684\u8bdd\uff0c\u4f60\u53ea\u9700\u8981\u5b9e\u73b0 getName() \u65b9\u6cd5\u3002 getName() \u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u8fd9\u4e2a\u6269\u5c55\u7684\u552f\u4e00\u6807\u8bc6\u7b26 \u73b0\u5728\u6211\u4eec\u6765\u662f\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u6269\u5c55\uff1a class Project_Twig_Extension extends Twig_Extension { public function getName() { return 'project'; } } Twig\u4e0d\u5173\u5fc3\u4f60\u7684\u6269\u5c55\u5b58\u5728\u4f55\u5904\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u6269\u5c55\u90fd\u9700\u8981\u663e\u793a\u7684\u6ce8\u518c\u3002\u901a\u8fc7\u8c03\u7528 Environment \u5bf9\u8c61\u7684 addExtension() \u65b9\u6cd5\u5373\u53ef\u6ce8\u518c\u4e00\u4e2a\u6269\u5c55\u3002 $twig = new Twig_Environment($loader); $twig->addExtension(new Project_Twig_Extension());","title":"\u521b\u5efa\u4e00\u4e2a\u6269\u5c55"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_49","text":"\u901a\u8fc7\u8c03\u7528 getGlobals() \u65b9\u6cd5\u5373\u53ef\u4ee5\u5728\u6269\u5c55\u4e2d\u6ce8\u518c\u5168\u5c40\u53d8\u91cf\uff1a class Project_Twig_Extension extends Twig_Extension { public function getGlobals() { return array( 'text' => new Text(), ); } // ... }","title":"\u5168\u5c40\u53d8\u91cf"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_50","text":"\u901a\u8fc7\u8c03\u7528 getFunctions() \u65b9\u6cd5\u5373\u53ef\u4ee5\u5728\u6269\u5c55\u4e2d\u6ce8\u518c\u51fd\u6570\uff1a class Project_Twig_Extension extends Twig_Extension { public function getFunctions() { return array( new Twig_SimpleFunction('lipsum', 'generate_lipsum'), ); } // ... }","title":"\u51fd\u6570"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#filters_4","text":"\u4e3a\u4e86\u5c06filter\u6dfb\u52a0\u5230\u4e00\u4e2a\u6269\u5c55\u4e2d\uff0c\u4f60\u9700\u8981\u8986\u5199 getFilters() \u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u6dfb\u52a0\u5230Twig\u73af\u5883\u7684filters\u6570\u7ec4\uff1a class Project_Twig_Extension extends Twig_Extension { public function getFilters() { return array( new Twig_SimpleFilter('rot13', 'str_rot13'), ); } // ... }","title":"Filters"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_51","text":"\u901a\u8fc7\u8986\u5199 getTokenParsers() \u65b9\u6cd5\u5c31\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6807\u8bb0\u6dfb\u52a0\u5230\u4e00\u4e2a\u6269\u5c55\u4e2d\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u5929\u6781\u5230Twig\u73af\u5883\u7684tags\u6570\u7ec4\uff1a class Project_Twig_Extension extends Twig_Extension { public function getTokenParsers() { return array(new Project_Set_TokenParser()); } // ... }","title":"\u6807\u8bb0"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#_52","text":"getOperators() \u65b9\u6cd5\u7528\u6765\u65b0\u589e\u65b0\u7684\u64cd\u4f5c\u7b26\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u662f\u5982\u4f55\u6dfb\u52a0!\uff0c||\u4ee5\u53ca&&\u64cd\u4f5c\u7b26\uff1a class Project_Twig_Extension extends Twig_Extension { public function getOperators() { return array( array( '!' => array('precedence' => 50, 'class' => 'Twig_Node_Expression_Unary_Not'), ), array( '||' => array('precedence' => 10, 'class' => 'Twig_Node_Expression_Binary_Or', 'associativity' => Twig_ExpressionParser::OPERATOR_LEFT), '&&' => array('precedence' => 15, 'class' => 'Twig_Node_Expression_Binary_And', 'associativity' => Twig_ExpressionParser::OPERATOR_LEFT), ), ); } // ... }","title":"\u64cd\u4f5c\u7b26"},{"location":"drupal/drupal8/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#tests_1","text":"getTests()\u65b9\u6cd5\u7528\u6765\u6dfb\u52a0\u65b0\u7684Test\u51fd\u6570\uff1a class Project_Twig_Extension extends Twig_Extension { public function getTests() { return array( new Twig_SimpleTest('even', 'twig_test_even'), ); } // ... }","title":"Tests"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/","tags":"[annotation]","text":"\u5199\u8fc7java\u4ee3\u7801\u7684\u540c\u5b66\uff0c\u76f8\u4fe1\u5927\u5bb6\u5bf9\u6ce8\u89e3\u90fd\u4e0d\u964c\u751f\u3002\u6709\u4e9bPHP\u6846\u67b6\u4e5f\u662f\u652f\u6301\u6ce8\u89e3\u7684\uff0c\u5982Symfony2\u4f7f\u7528\u6ce8\u89e3\u5b9a\u4e49\u8def\u7531\u89c4\u5219\uff0cDoctrine\u4f7f\u7528\u6ce8\u89e3\u6765\u6dfb\u52a0ORM\u5143\u6570\u636e\u3002PHP\u6ce8\u89e3RFC\u89c1 rfc-annotations \u3002 Drupal8\u7684\u6ce8\u89e3\u4f9d\u7167 Doctrine \u7684\u89c4\u8303\u3002 \u672c\u6587\u4e3b\u8981\u5bf9Drupal8\u4e2d\u6240\u7528\u5230\u7684\u6ce8\u89e3\u505a\u5206\u6790\uff0c\u6b22\u8fce\u62cd\u7816\u4ea4\u6d41\uff01 \u4e00\u3001\u6ce8\u89e3\u7684\u4e89\u8bae \u00b6 \u76ee\u524d\u5bf9\u6ce8\u89e3\u7684\u4e89\u8bae\u4e3b\u8981\u6709\u8fd9\u4e48\u51e0\u70b9\u3002 1\u3001\u5982\u4f55\u533a\u5206\u6ce8\u89e3\u548c\u6ce8\u91ca\uff1f \u00b6 2\u3001\u4e3a\u4ec0\u4e48\u8981\u628a\u4e1a\u52a1\u903b\u8f91\u653e\u5728\u6ce8\u91ca\u4e2d\uff1f\u96be\u9053\u4ed6\u4eec\u4e0d\u662f\u4e00\u4e2a\u6838\u5fc3\u8bed\u8a00\u8bed\u4e49\u7684\u4e00\u90e8\u5206\uff1f \u00b6 3\u3001\u6ce8\u89e3\u548c\u6ce8\u91ca\u4ee3\u7801\u5bb9\u6613\u6df7\u6dc6\uff0c\u5982\u679c\u5f00\u53d1\u4eba\u5458\u5fd8\u8bb0\u5b9a\u4e49\u4e86\u6ce8\u89e3\uff0c\u7a0b\u5e8f\u5e76\u4e0d\u4f1a\u62a5\u9519\uff0c\u4f46\u662f\u53ef\u80fd\u4e0d\u4f1a\u50cf\u9884\u671f\u7684\u5de5\u4f5c\u3002 \u00b6 4\u3001\u6ce8\u89e3\u4e0d\u597d\u6d4b\u8bd5\u3001\u8c03\u8bd5\u3002 \u00b6 \u4e8c\u3001\u6ce8\u89e3\u7684\u4f18\u52bf \u00b6 1\u3001\u4e0d\u7528\u5199\u5f88\u591a\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6ce8\u5165\u3002\u5982\uff1a \u00b6 \u6211\u4eec\u8981\u628aweapon\u5bf9\u8c61\u6ce8\u5165\u5230soldier\u5b9e\u4f8b\u4e2d\u3002 class Weapon { public function shoot() { print \"... shooting ...\"; } } class Soldier { private $weapon; public function setWeapon($weapon) { $this->weapon = $weapon; } public function fight() { $this->weapon->shoot(); } } \u8981\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u8981\u8fd9\u6837\u5199\u4ee3\u7801\uff1a $weapon = new Weapon(); $soldier = new Soldier(); $soldier->setWeapon($weapon); $soldier->fight(); \u5982\u679c\u6211\u4eec\u7528\u6ce8\u89e3\uff0c\u5c31\u53d8\u5f97\u7b80\u5355\u591a\u4e86\uff1a class Soldier { ... /** * @inject $weapon Weapon */ public function setWeapon($weapon) { $this->weapon = $weapon; } } // \u53ea\u9700\u89812\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u4e86 $soldier = new Soldier(); $soldier->fight(); 2\u3001Drupal8\u6267\u884c\u65f6\uff0c\u5185\u5b58\u4f7f\u7528\u5927\u5927\u51cf\u5c11\u3002\u5728Drupal7\u4e2d\uff0c\u901a\u8fc7hook\u5b9a\u4e49\u5143\u6570\u636e\uff0c\u8fd9\u6837\u5c31\u5bfc\u81f4\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u9700\u8981\u628a\u6240\u6709\u7684\u6a21\u5757\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800cDrupal8\u4ec5\u89e3\u6790\u6ce8\u89e3\uff0c\u5e76\u52a0\u8f7d\u8fdb\u5185\u5b58\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5360\u7528\u5f88\u5c0f\u7684\u5185\u5b58\u3002 \u00b6 \u4e09\u3001\u8bed\u6cd5 \u00b6 \u6ce8\u89e3\u7684\u6570\u636e\u7ed3\u6784\u662f\u7c7b\u4f3cjson key-value\u3002 \u8ba9\u6211\u4eec\u6765\u770btext\u6a21\u5757\u7684TextDefaultFormatter.php\u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002 /** * Plugin implementation of the 'text_default' formatter. * * @FieldFormatter( * id = \"text_default\", * label = @Translation(\"Default\"), * field_types = { * \"text\", * \"text_long\", * \"text_with_summary\" * }, * quickedit = { * \"editor\" = \"plain_text\" * } * ) */ class TextDefaultFormatter extends FormatterBase { ... \u4ee5\u4e0b\u662f\u4e00\u4e9b\u89c4\u8303\uff1a 1\u3001\u5fc5\u987b\u4ee5\u4e00\u4e2a\u552f\u4e00\u7684id\u5f00\u59cb\uff0c\u7c7b\u4f3cDrupal7\u7684machine name \u00b6 2\u3001\u9876\u7ea7\u7684Keys\u53ef\u4ee5\u4f7f\u7528\u53cc\u5f15\u53f7 \u00b6 3\u3001\u4e0b\u7ea7\u7684Keys\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7 \u00b6 4\u3001\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u5355\u5f15\u53f7\u4f1a\u9020\u6210\u8bed\u6cd5\u9519\u8bef \u00b6 5\u3001value\u5141\u8bb8\u7684\u6570\u636e\u7c7b\u578b \u00b6 > \u5b57\u7b26\u4e32(string)\uff1a\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7,\u5982\"foo\"\uff0c\u4f7f\u7528\u4e00\u5bf9\u53cc\u5f15\u53f7\u5305\u542b\u53cc\u5f15\u53f7\u5b57\u7b26\uff0c\u5982\"The \"\"On\"\" value \" > \u6570\u5b57(number)\uff1a\u4e0d\u80fd\u4f7f\u7528\u5f15\u53f7\uff0c\u5982\u679c\u4f7f\u7528\u5f15\u53f7\uff0c\u4f1a\u88ab\u89e3\u6790\u6210\u5b57\u7b26\u4e32 > \u5e03\u5c14\u578b(bool)\uff1a\u4e0d\u80fd\u4f7f\u7528\u5f15\u53f7\uff0c\u5982\u679c\u4f7f\u7528\u5f15\u53f7\uff0c\u4f1a\u88ab\u89e3\u6790\u6210\u5b57\u7b26\u4e32 > list\uff1a\u5fc5\u987b\u4f7f\u7528\u82b1\u62ec\u53f7\uff0c\u672b\u5c3e\u4e0d\u80fd\u4f7f\u7528\u9017\u53f7\u3002\u5982 field_types = { \"text\", \"text_long\", \"text_with_summary\" } > map: \u5fc5\u987b\u4f7f\u7528\u82b1\u62ec\u53f7\uff0ckey-value\u7528\uff1d\u53f7\u5206\u5272\uff0c\u9ed8\u8ba4\u4e0d\u80fd\u4f7f\u7528\u9017\u53f7\u3002\u5982\uff1a quickedit = { \"editor\" = \"plain_text\" } > \u5141\u8bb8\u5b9a\u4e49\u5e38\u91cf \u56db\u3001\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7c7b \u00b6 Drupal8\u4e2d\u7684\u4e00\u4e9b\u57fa\u7840plugin\u5982entity,views\u7b49\u4f1a\u88ab\u81ea\u52a8\u52a0\u8f7d\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u5728\u81ea\u5b9a\u4e49\u7684\u7c7b\u4e2d\u7ed9plugin\u63d0\u4f9b\u6587\u6863\u548c\u53c2\u6570\u3002 \u6211\u4eec\u8fd8\u662f\u4ee5text\u6a21\u5757\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5728text/src/Plugin/field/formatter/TextPlainFormatter.php\u4e2d\u5b9a\u4e49\u4e86plaintext\uff0c\u5e76\u4e14\u81ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ebFieldFormatter\u7684\u6ce8\u89e3\u7c7b\u3002 \u6ce8\u610f\uff1a\u6240\u6709\u7684\u6ce8\u89e3\u7c7b\u90fd\u662f\u7ee7\u627f\u81ea \\Drupal\\Component\\Annotation\\Plugin\u3002 <?php /** * Plugin implementation of the 'text_plain' formatter. * * @FieldFormatter( * id = \"text_plain\", * label = @Translation(\"Plain text\"), * field_types = { * \"text\", * \"text_long\", * \"text_with_summary\" * }, * edit = { * \"editor\" = \"direct\" * } * ) */ class TextPlainFormatter { ?> \u4e94\u3001\u81ea\u5b9a\u4e49\u63d2\u4ef6\u7c7b\u578b\u4e2d\u4f7f\u7528\u6ce8\u89e3 \u00b6 \u5982\u679c\u4f60\u60f3\u5728\u81ea\u5b9a\u4e49plugin\u7c7b\u578b\u4e2d\u4f7f\u7528\u6ce8\u89e3\uff0c\u53ef\u4ee5\u7528AnnotatedClassDiscovery\u7c7b\u3002 AnnotatedClassDiscovery\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8fd9\u4e2aplugin\u7c7b\u578b\u6240\u5b58\u653e\u7684\u76ee\u5f55\u7ed3\u6784\u3002 \u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff0cplugin\u5728\u76ee\u5f55$module/src/Plugin/field/formatter\u4e2d\u3002 <?php use Drupal\\Core\\Plugin\\Discovery\\AnnotatedClassDiscovery ; class FormatterPluginManager extends PluginManagerBase { /** * Constructs a FormatterPluginManager object. * * @param array $namespaces * An array of paths keyed by their corresponding namespaces. */ public function __construct ( array $namespaces ) { // This is the essential line you have to use in your manager. $this -> discovery = new AnnotatedClassDiscovery ( 'Plugin/field/formatter' , $namespaces ); // Every other line is a good practice. $this -> discovery = new ProcessDecorator ( $this -> discovery , [ $this , 'processDefinition' ]); $this -> discovery = new AlterDecorator ( $this -> discovery , 'field_formatter_info' ); $this -> discovery = new CacheDecorator ( $this -> discovery , 'field_formatter_types' , 'field' ); } } ?> \u6ce8\u5165\u7684\u547d\u540d\u7a7a\u95f4\u6765\u81ea\u4e8e\u4f9d\u8d56\u6ce8\u5165\u5bb9\u5668\uff0c\u5982FieldBundle\uff1a <?php /** * @file * Contains Drupal\\field\\FieldBundle. */ namespace Drupal\\field ; use Symfony\\Component\\DependencyInjection\\ContainerBuilder ; use Symfony\\Component\\HttpKernel\\Bundle\\Bundle ; /** * Field dependency injection container. */ class FieldBundle extends Bundle { /** * Overrides Symfony\\Component\\HttpKernel\\Bundle\\Bundle::build(). */ public function build ( ContainerBuilder $container ) { // Register the plugin managers for our plugin types with the dependency injection container. $container -> register ( 'plugin.manager.field.widget' , 'Drupal\\field\\Plugin\\Type\\Widget\\WidgetPluginManager' ) -> addArgument ( '%container.namespaces%' ); $container -> register ( 'plugin.manager.field.formatter' , 'Drupal\\field\\Plugin\\Type\\Formatter\\FormatterPluginManager' ) -> addArgument ( '%container.namespaces%' ); } } ?> \u8981\u8c03\u7528\u81ea\u5b9a\u4e49\u7684plugin\u7ba1\u7406\u5668\uff0c\u9700\u8981\u5728\u6784\u9020\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\u6ce8\u5165\u547d\u540d\u7a7a\u95f4\u3002 <?php $type = new CustomPluginManager ( \\Drupal :: getContainer () -> getParameter ( 'container.namespaces' )); ?> \u516d\u3001Entity\u6ce8\u89e3 \u00b6 Entity\u7c7b\u578b\u4e0d\u7ba1\u662f\u914d\u7f6e\u8fd8\u662f\u5185\u5bb9\u5b9e\u4f53\u90fd\u5fc5\u987b\u7528\u6ce8\u89e3\u5b9a\u4e49\u3002 \u5982\uff1acore/modules/user/src/Entity/User.php: ... /** * Defines the user entity class. * * The base table name here is plural, despite Drupal table naming standards, * because \"user\" is a reserved word in many databases. * * @ContentEntityType( * id = \"user\", * label = @Translation(\"User\"), * handlers = { * \"storage\" = \"Drupal\\user\\UserStorage\", * \"storage_schema\" = \"Drupal\\user\\UserStorageSchema\", * \"access\" = \"Drupal\\user\\UserAccessControlHandler\", * \"list_builder\" = \"Drupal\\user\\UserListBuilder\", * \"view_builder\" = \"Drupal\\Core\\Entity\\EntityViewBuilder\", * \"views_data\" = \"Drupal\\user\\UserViewsData\", * \"route_provider\" = { * \"html\" = \"Drupal\\user\\Entity\\UserRouteProvider\", * }, * \"form\" = { * \"default\" = \"Drupal\\user\\ProfileForm\", * \"cancel\" = \"Drupal\\user\\Form\\UserCancelForm\", * \"register\" = \"Drupal\\user\\RegisterForm\" * }, * \"translation\" = \"Drupal\\user\\ProfileTranslationHandler\" * }, * admin_permission = \"administer user\", * base_table = \"users\", * data_table = \"users_field_data\", * label_callback = \"user_format_name\", * translatable = TRUE, * entity_keys = { * \"id\" = \"uid\", * \"langcode\" = \"langcode\", * \"uuid\" = \"uuid\" * }, * links = { * \"canonical\" = \"/user/{user}\", * \"edit-form\" = \"/user/{user}/edit\", * \"cancel-form\" = \"/user/{user}/cancel\", * \"collection\" = \"/admin/people\", * }, * field_ui_base_route = \"entity.user.admin_form\", * ) */ class User extends ContentEntityBase implements UserInterface { ... @ConfigEntityType\u7ee7\u627f\u81eaDrupal\\Core\\Config\\Entity\\ConfigEntityBase\u7c7b\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/1882526 2\u3001 https://www.drupal.org/node/2207559 3\u3001 https://www.drupal.org/node/1638040 4\u3001 http://lakshminp-lakshminp.rhcloud.com/annotations-in-drupal-8/ 5\u3001 https://docs.phalconphp.com/zh/latest/reference/annotations.html","title":"\"Drupal8\u6ce8\u89e3(Annotations)\u8bed\u6cd5\""},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#_1","text":"\u76ee\u524d\u5bf9\u6ce8\u89e3\u7684\u4e89\u8bae\u4e3b\u8981\u6709\u8fd9\u4e48\u51e0\u70b9\u3002","title":"\u4e00\u3001\u6ce8\u89e3\u7684\u4e89\u8bae"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#1","text":"","title":"1\u3001\u5982\u4f55\u533a\u5206\u6ce8\u89e3\u548c\u6ce8\u91ca\uff1f"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#2","text":"","title":"2\u3001\u4e3a\u4ec0\u4e48\u8981\u628a\u4e1a\u52a1\u903b\u8f91\u653e\u5728\u6ce8\u91ca\u4e2d\uff1f\u96be\u9053\u4ed6\u4eec\u4e0d\u662f\u4e00\u4e2a\u6838\u5fc3\u8bed\u8a00\u8bed\u4e49\u7684\u4e00\u90e8\u5206\uff1f"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#3","text":"","title":"3\u3001\u6ce8\u89e3\u548c\u6ce8\u91ca\u4ee3\u7801\u5bb9\u6613\u6df7\u6dc6\uff0c\u5982\u679c\u5f00\u53d1\u4eba\u5458\u5fd8\u8bb0\u5b9a\u4e49\u4e86\u6ce8\u89e3\uff0c\u7a0b\u5e8f\u5e76\u4e0d\u4f1a\u62a5\u9519\uff0c\u4f46\u662f\u53ef\u80fd\u4e0d\u4f1a\u50cf\u9884\u671f\u7684\u5de5\u4f5c\u3002"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#4","text":"","title":"4\u3001\u6ce8\u89e3\u4e0d\u597d\u6d4b\u8bd5\u3001\u8c03\u8bd5\u3002"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#_2","text":"","title":"\u4e8c\u3001\u6ce8\u89e3\u7684\u4f18\u52bf"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#1_1","text":"\u6211\u4eec\u8981\u628aweapon\u5bf9\u8c61\u6ce8\u5165\u5230soldier\u5b9e\u4f8b\u4e2d\u3002 class Weapon { public function shoot() { print \"... shooting ...\"; } } class Soldier { private $weapon; public function setWeapon($weapon) { $this->weapon = $weapon; } public function fight() { $this->weapon->shoot(); } } \u8981\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u8981\u8fd9\u6837\u5199\u4ee3\u7801\uff1a $weapon = new Weapon(); $soldier = new Soldier(); $soldier->setWeapon($weapon); $soldier->fight(); \u5982\u679c\u6211\u4eec\u7528\u6ce8\u89e3\uff0c\u5c31\u53d8\u5f97\u7b80\u5355\u591a\u4e86\uff1a class Soldier { ... /** * @inject $weapon Weapon */ public function setWeapon($weapon) { $this->weapon = $weapon; } } // \u53ea\u9700\u89812\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u4e86 $soldier = new Soldier(); $soldier->fight();","title":"1\u3001\u4e0d\u7528\u5199\u5f88\u591a\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6ce8\u5165\u3002\u5982\uff1a"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#2drupal8drupal7hookdrupal8","text":"","title":"2\u3001Drupal8\u6267\u884c\u65f6\uff0c\u5185\u5b58\u4f7f\u7528\u5927\u5927\u51cf\u5c11\u3002\u5728Drupal7\u4e2d\uff0c\u901a\u8fc7hook\u5b9a\u4e49\u5143\u6570\u636e\uff0c\u8fd9\u6837\u5c31\u5bfc\u81f4\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u9700\u8981\u628a\u6240\u6709\u7684\u6a21\u5757\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800cDrupal8\u4ec5\u89e3\u6790\u6ce8\u89e3\uff0c\u5e76\u52a0\u8f7d\u8fdb\u5185\u5b58\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5360\u7528\u5f88\u5c0f\u7684\u5185\u5b58\u3002"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#_3","text":"\u6ce8\u89e3\u7684\u6570\u636e\u7ed3\u6784\u662f\u7c7b\u4f3cjson key-value\u3002 \u8ba9\u6211\u4eec\u6765\u770btext\u6a21\u5757\u7684TextDefaultFormatter.php\u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002 /** * Plugin implementation of the 'text_default' formatter. * * @FieldFormatter( * id = \"text_default\", * label = @Translation(\"Default\"), * field_types = { * \"text\", * \"text_long\", * \"text_with_summary\" * }, * quickedit = { * \"editor\" = \"plain_text\" * } * ) */ class TextDefaultFormatter extends FormatterBase { ... \u4ee5\u4e0b\u662f\u4e00\u4e9b\u89c4\u8303\uff1a","title":"\u4e09\u3001\u8bed\u6cd5"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#1iddrupal7machine-name","text":"","title":"1\u3001\u5fc5\u987b\u4ee5\u4e00\u4e2a\u552f\u4e00\u7684id\u5f00\u59cb\uff0c\u7c7b\u4f3cDrupal7\u7684machine name"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#2keys","text":"","title":"2\u3001\u9876\u7ea7\u7684Keys\u53ef\u4ee5\u4f7f\u7528\u53cc\u5f15\u53f7"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#3keys","text":"","title":"3\u3001\u4e0b\u7ea7\u7684Keys\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#4_1","text":"","title":"4\u3001\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u5355\u5f15\u53f7\u4f1a\u9020\u6210\u8bed\u6cd5\u9519\u8bef"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#5value","text":"> \u5b57\u7b26\u4e32(string)\uff1a\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7,\u5982\"foo\"\uff0c\u4f7f\u7528\u4e00\u5bf9\u53cc\u5f15\u53f7\u5305\u542b\u53cc\u5f15\u53f7\u5b57\u7b26\uff0c\u5982\"The \"\"On\"\" value \" > \u6570\u5b57(number)\uff1a\u4e0d\u80fd\u4f7f\u7528\u5f15\u53f7\uff0c\u5982\u679c\u4f7f\u7528\u5f15\u53f7\uff0c\u4f1a\u88ab\u89e3\u6790\u6210\u5b57\u7b26\u4e32 > \u5e03\u5c14\u578b(bool)\uff1a\u4e0d\u80fd\u4f7f\u7528\u5f15\u53f7\uff0c\u5982\u679c\u4f7f\u7528\u5f15\u53f7\uff0c\u4f1a\u88ab\u89e3\u6790\u6210\u5b57\u7b26\u4e32 > list\uff1a\u5fc5\u987b\u4f7f\u7528\u82b1\u62ec\u53f7\uff0c\u672b\u5c3e\u4e0d\u80fd\u4f7f\u7528\u9017\u53f7\u3002\u5982 field_types = { \"text\", \"text_long\", \"text_with_summary\" } > map: \u5fc5\u987b\u4f7f\u7528\u82b1\u62ec\u53f7\uff0ckey-value\u7528\uff1d\u53f7\u5206\u5272\uff0c\u9ed8\u8ba4\u4e0d\u80fd\u4f7f\u7528\u9017\u53f7\u3002\u5982\uff1a quickedit = { \"editor\" = \"plain_text\" } > \u5141\u8bb8\u5b9a\u4e49\u5e38\u91cf","title":"5\u3001value\u5141\u8bb8\u7684\u6570\u636e\u7c7b\u578b"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#_4","text":"Drupal8\u4e2d\u7684\u4e00\u4e9b\u57fa\u7840plugin\u5982entity,views\u7b49\u4f1a\u88ab\u81ea\u52a8\u52a0\u8f7d\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u5728\u81ea\u5b9a\u4e49\u7684\u7c7b\u4e2d\u7ed9plugin\u63d0\u4f9b\u6587\u6863\u548c\u53c2\u6570\u3002 \u6211\u4eec\u8fd8\u662f\u4ee5text\u6a21\u5757\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5728text/src/Plugin/field/formatter/TextPlainFormatter.php\u4e2d\u5b9a\u4e49\u4e86plaintext\uff0c\u5e76\u4e14\u81ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ebFieldFormatter\u7684\u6ce8\u89e3\u7c7b\u3002 \u6ce8\u610f\uff1a\u6240\u6709\u7684\u6ce8\u89e3\u7c7b\u90fd\u662f\u7ee7\u627f\u81ea \\Drupal\\Component\\Annotation\\Plugin\u3002 <?php /** * Plugin implementation of the 'text_plain' formatter. * * @FieldFormatter( * id = \"text_plain\", * label = @Translation(\"Plain text\"), * field_types = { * \"text\", * \"text_long\", * \"text_with_summary\" * }, * edit = { * \"editor\" = \"direct\" * } * ) */ class TextPlainFormatter { ?>","title":"\u56db\u3001\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7c7b"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#_5","text":"\u5982\u679c\u4f60\u60f3\u5728\u81ea\u5b9a\u4e49plugin\u7c7b\u578b\u4e2d\u4f7f\u7528\u6ce8\u89e3\uff0c\u53ef\u4ee5\u7528AnnotatedClassDiscovery\u7c7b\u3002 AnnotatedClassDiscovery\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8fd9\u4e2aplugin\u7c7b\u578b\u6240\u5b58\u653e\u7684\u76ee\u5f55\u7ed3\u6784\u3002 \u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff0cplugin\u5728\u76ee\u5f55$module/src/Plugin/field/formatter\u4e2d\u3002 <?php use Drupal\\Core\\Plugin\\Discovery\\AnnotatedClassDiscovery ; class FormatterPluginManager extends PluginManagerBase { /** * Constructs a FormatterPluginManager object. * * @param array $namespaces * An array of paths keyed by their corresponding namespaces. */ public function __construct ( array $namespaces ) { // This is the essential line you have to use in your manager. $this -> discovery = new AnnotatedClassDiscovery ( 'Plugin/field/formatter' , $namespaces ); // Every other line is a good practice. $this -> discovery = new ProcessDecorator ( $this -> discovery , [ $this , 'processDefinition' ]); $this -> discovery = new AlterDecorator ( $this -> discovery , 'field_formatter_info' ); $this -> discovery = new CacheDecorator ( $this -> discovery , 'field_formatter_types' , 'field' ); } } ?> \u6ce8\u5165\u7684\u547d\u540d\u7a7a\u95f4\u6765\u81ea\u4e8e\u4f9d\u8d56\u6ce8\u5165\u5bb9\u5668\uff0c\u5982FieldBundle\uff1a <?php /** * @file * Contains Drupal\\field\\FieldBundle. */ namespace Drupal\\field ; use Symfony\\Component\\DependencyInjection\\ContainerBuilder ; use Symfony\\Component\\HttpKernel\\Bundle\\Bundle ; /** * Field dependency injection container. */ class FieldBundle extends Bundle { /** * Overrides Symfony\\Component\\HttpKernel\\Bundle\\Bundle::build(). */ public function build ( ContainerBuilder $container ) { // Register the plugin managers for our plugin types with the dependency injection container. $container -> register ( 'plugin.manager.field.widget' , 'Drupal\\field\\Plugin\\Type\\Widget\\WidgetPluginManager' ) -> addArgument ( '%container.namespaces%' ); $container -> register ( 'plugin.manager.field.formatter' , 'Drupal\\field\\Plugin\\Type\\Formatter\\FormatterPluginManager' ) -> addArgument ( '%container.namespaces%' ); } } ?> \u8981\u8c03\u7528\u81ea\u5b9a\u4e49\u7684plugin\u7ba1\u7406\u5668\uff0c\u9700\u8981\u5728\u6784\u9020\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\u6ce8\u5165\u547d\u540d\u7a7a\u95f4\u3002 <?php $type = new CustomPluginManager ( \\Drupal :: getContainer () -> getParameter ( 'container.namespaces' )); ?>","title":"\u4e94\u3001\u81ea\u5b9a\u4e49\u63d2\u4ef6\u7c7b\u578b\u4e2d\u4f7f\u7528\u6ce8\u89e3"},{"location":"drupal/drupal8/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#entity","text":"Entity\u7c7b\u578b\u4e0d\u7ba1\u662f\u914d\u7f6e\u8fd8\u662f\u5185\u5bb9\u5b9e\u4f53\u90fd\u5fc5\u987b\u7528\u6ce8\u89e3\u5b9a\u4e49\u3002 \u5982\uff1acore/modules/user/src/Entity/User.php: ... /** * Defines the user entity class. * * The base table name here is plural, despite Drupal table naming standards, * because \"user\" is a reserved word in many databases. * * @ContentEntityType( * id = \"user\", * label = @Translation(\"User\"), * handlers = { * \"storage\" = \"Drupal\\user\\UserStorage\", * \"storage_schema\" = \"Drupal\\user\\UserStorageSchema\", * \"access\" = \"Drupal\\user\\UserAccessControlHandler\", * \"list_builder\" = \"Drupal\\user\\UserListBuilder\", * \"view_builder\" = \"Drupal\\Core\\Entity\\EntityViewBuilder\", * \"views_data\" = \"Drupal\\user\\UserViewsData\", * \"route_provider\" = { * \"html\" = \"Drupal\\user\\Entity\\UserRouteProvider\", * }, * \"form\" = { * \"default\" = \"Drupal\\user\\ProfileForm\", * \"cancel\" = \"Drupal\\user\\Form\\UserCancelForm\", * \"register\" = \"Drupal\\user\\RegisterForm\" * }, * \"translation\" = \"Drupal\\user\\ProfileTranslationHandler\" * }, * admin_permission = \"administer user\", * base_table = \"users\", * data_table = \"users_field_data\", * label_callback = \"user_format_name\", * translatable = TRUE, * entity_keys = { * \"id\" = \"uid\", * \"langcode\" = \"langcode\", * \"uuid\" = \"uuid\" * }, * links = { * \"canonical\" = \"/user/{user}\", * \"edit-form\" = \"/user/{user}/edit\", * \"cancel-form\" = \"/user/{user}/cancel\", * \"collection\" = \"/admin/people\", * }, * field_ui_base_route = \"entity.user.admin_form\", * ) */ class User extends ContentEntityBase implements UserInterface { ... @ConfigEntityType\u7ee7\u627f\u81eaDrupal\\Core\\Config\\Entity\\ConfigEntityBase\u7c7b\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 https://www.drupal.org/node/1882526 2\u3001 https://www.drupal.org/node/2207559 3\u3001 https://www.drupal.org/node/1638040 4\u3001 http://lakshminp-lakshminp.rhcloud.com/annotations-in-drupal-8/ 5\u3001 https://docs.phalconphp.com/zh/latest/reference/annotations.html","title":"\u516d\u3001Entity\u6ce8\u89e3"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/","tags":"[drupal8]","text":"1\u3001\u6982\u8ff0 \u00b6 Drupal 8\u5df2\u7ecf\u6b63\u5f0f\u53d1\u5e03\uff0c\u4e0eDrupal 7\u76f8\u6bd4\uff0cDrupal 8\u5728\u5b9e\u73b0\u673a\u5236\u4e0a\u53d1\u751f\u4e86\u6839\u672c\u6027\u7684\u6539\u53d8\u3002\u6700\u672c\u8d28\u7684\u6539\u53d8\uff0c\u5e94\u8be5\u5c31\u662f\u4ece\u4e3b\u8981\u4ee5\u9762\u5411\u8fc7\u7a0b\u7684\u7f16\u7801\u65b9\u5f0f\u8f6c\u4e3a\u4e86\u4e3b\u8981\u4ee5\u9762\u5411\u5bf9\u8c61\u7684\u7f16\u7801\u65b9\u5f0f\u3002\u867d\u7136Drupal 8\u4ecd\u7136\u4fdd\u7559\u4e86\u90e8\u5206\u9762\u5411\u8fc7\u7a0b\u7684\u6587\u4ef6\uff0c\u6bd4\u5982.module\u6587\u4ef6\uff0c\u4f46\u662f\u53ef\u4ee5\u9884\u89c1\uff0c\u5728Drupal 9\u4e2d\uff0c\u8fd9\u4e9b\u9762\u5411\u8fc7\u7a0b\u7684\u4ee3\u7801\u5c06\u88ab\u5168\u90e8\u79fb\u9664\uff0c\u6240\u4ee5\u5728\u4f7f\u7528Drupal 8\u505a\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u5c3d\u91cf\u907f\u514d\u5f15\u7528\u9762\u5411\u8fc7\u7a0b\u7684\u4ee3\u7801\uff0c\u4ee5\u514d\u4eceDrupal 8\u5347\u7ea7\u5230Drupal 9\u7684\u8fc7\u7a0b\u4e2d\u589e\u52a0\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\u3002 \u672c\u6587\u5c06\u4ece\u6a21\u5757\u5f00\u53d1\u7684\u89d2\u5ea6\uff08\u800c\u975e\u5176\u4ed6\u89d2\u5ea6\uff0c\u6bd4\u5982\u7f51\u7ad9\u7f16\u8f91\u3001\u6027\u80fd\u4f18\u52a3\u7b49\uff09\u8ba8\u8bbaDrupal 8 \u4e0eDrupal 7\u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u901a\u8fc7\u5bf9Drupal 8\u7684\u7814\u7a76\uff0c\u6211\u5c06Drupal 8\u6a21\u5757\u5f00\u53d1\u4e0eDrupal 7\u7684\u4e0d\u540c\u70b9\u6982\u62ec\u4e3a\u4ee5\u4e0b\u51e0\u70b9\uff1a \u76ee\u5f55\u7ed3\u6784\uff1b \u914d\u7f6e\u6587\u4ef6\uff1b \u8def\u7531\u65b9\u5f0f\uff1b \u4e3b\u9898\uff1b \u8868\u5355\uff1b \u94a9\u5b50\u673a\u5236\u5728Drupal 8\u4e2d\u7684\u53d8\u5316\u53ca\u5b9e\u73b0\uff1b Drupal 8\u4e2d\u7684\u65b0\u589e\u673a\u5236\u3002 \u4e0b\u9762\u5c06\u8be6\u7ec6\u8bba\u8ff0\u8fd9\u4e9b\u4e0d\u540c\u70b9\u3002 2\u3001\u76ee\u5f55\u7ed3\u6784 \u00b6 Drupal 7\u7684\u76ee\u5f55\u7ed3\u6784\u4e3a\uff1a |-includes |-misc |-modules |-scripts |-sites | |-all | | |-modules | | |-themes | |-default |-themes Drupal 8\u7684\u76ee\u5f55\u7ed3\u6784\u4e3a\uff1a |-core | |-assets | |-config | |-includes | |-lib | |-misc | |-modules | |-profiles | |-scripts | |-themes |-modules |-sites | |-default |-themes |-vendor \u53ef\u4ee5\u770b\u51fa\uff0cDrupal 8\u4e0eDrupal 7\u7684\u76ee\u5f55\u7ed3\u6784\u5927\u4e0d\u76f8\u540c\uff0c\u5728Drupal7\u4e2d\u6838\u5fc3\u7684\u4ee3\u7801\u90fd\u76f4\u63a5\u653e\u5728\u6839\u76ee\u5f55\u4e0b\uff0c\u6bd4\u5982includes\u7b49\uff0c\u6838\u5fc3\u6a21\u5757\u653e\u5728\u6839\u76ee\u5f55\u4e0b\u7684modules\u76ee\u5f55\u4e0b\uff0c\u6838\u5fc3\u4e3b\u9898\u653e\u5728\u6839\u76ee\u5f55\u4e0b\u7684themes\u76ee\u5f55\u4e0b\u3002\u7528\u6237\u81ea\u5b9a\u4e49\u6216\u8005\u7b2c\u4e09\u65b9\u7684\u6a21\u5757\u653e\u5728sites\\all\\modules\u3001\u4e3b\u9898\u653e\u5728sites\\all\\themes\u76ee\u5f55\u4e0b\u3002 \u800c\u5728Drupal 8\u91cc\u9762\uff0c\u6838\u5fc3\u7684\u4e1c\u897f\u90fd\u88ab\u79fb\u5230\u6839\u76ee\u5f55\u4e0b\u7684core\u76ee\u5f55\u4e0b\uff0c\u539f\u6765\u7528\u6765\u653e\u6838\u5fc3\u6a21\u5757\u548c\u4e3b\u9898\u7684modules\u3001themes\u76ee\u5f55\u5206\u522b\u7528\u6765\u653e\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u6a21\u5757\u548c\u4e3b\u9898\u3002\u6309\u7167\u7ea6\u5b9a\u4fd7\u79f0\u7684\u89c4\u5219\uff0c\u4e00\u822c\u5728modules\u76ee\u5f55\u4e0b\u65b0\u5efacontrib\u548ccustom\u76ee\u5f55\uff0c\u5206\u522b\u7528\u6765\u653e\u8d21\u732e\u548c\u81ea\u5b9a\u4e49\u6a21\u5757\u3002 2\u3001\u914d\u7f6e\u6587\u4ef6 \u00b6 \u5728Drupal\u6a21\u5757\u5f00\u53d1\u4e2d\uff0c\u5f88\u591a\u529f\u80fd\u7684\u5b9e\u73b0\u90fd\u8981\u9760\u914d\u7f6e\u6587\u4ef6\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\u6a21\u5757\u7684\u57fa\u672c\u4fe1\u606f\u5728Drupal 7\u4e2d\u5c31\u5fc5\u987b\u914d\u7f6e\u5728*.info\u6587\u4ef6\u4e2d\u3002\u5728Drupal 8\u4e2d\uff0c\u914d\u7f6e\u6587\u4ef6\u7684\u4f7f\u7528\u5f97\u5230\u4e86\u8fdb\u4e00\u6b65\u7684\u6269\u5145\uff0c\u53ef\u4ee5\u8bf4\uff0cDrupal 8\u7684\u51e0\u4e4e\u6240\u6709\u529f\u80fd\u90fd\u79bb\u4e0d\u5f00\u914d\u7f6e\u6587\u4ef6\u3002 \u4f46\u662f\u540c\u65f6\u914d\u7f6e\u6587\u4ef6\u7684\u683c\u5f0f\u4e5f\u4e0eDrupal 7\u6709\u6240\u4e0d\u540c\u3002Drupal 7\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u4e3b\u8981\u662f.info\u6587\u4ef6\uff0c.info\u6587\u4ef6\u91c7\u7528\u4f7f\u7528\u7b49\u53f7\u9694\u5f00\u7684\u952e\u503c\u5bf9\u7684\u5f62\u5f0f\u914d\u7f6e\u4fe1\u606f\uff0c\u4f8b\u5982\u6a21\u5757\u4fe1\u606f\u7684\u914d\u7f6e\u6587\u4ef6demo.info\uff1a core = \"7.x\" description = \"Demo Module\" dependencies[] = system name = \"demo\" package = \"demo\" version = \"7.x-1.0\" Drupal 8\u4e2d\u914d\u7f6e\u6587\u4ef6\u5e7f\u6cdb\u4f7f\u7528yaml\u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u6a21\u5757\u4fe1\u606f\u7684\u914d\u7f6e\u6587\u4ef6demo.info.yml: name: demo type: module description: \"demo module\" package: demo core: 8.x dependencies: - rest \u5bf9\u6bd4Drupal 7\u548cDrupal 8\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u96be\u770b\u51fa\uff0c\u91cc\u9762\u7684\u5185\u5bb9\u57fa\u672c\u4e00\u81f4\uff0c\u6240\u4e0d\u540c\u7684\u53ea\u662f\u6587\u4ef6\u683c\u5f0f\u7684\u4e0d\u540c\u3002\u9700\u8981\u6ce8\u610f\u7684\u662fDrupal 8\u7684\u914d\u7f6e\u6587\u4ef6\u540e\u7f00\u540d\u90fd\u662f.yml\uff0c\u8868\u660e\u8fd9\u662f\u4e00\u4e2ayaml\u6587\u4ef6\u3002Drupal 8\u7684\u6a21\u5757\u914d\u7f6e\u4fe1\u606f\u6bd4Drupal 7\u7684\u591a\u4e00\u9879type: module\uff0c\u8fd9\u662f\u56e0\u4e3aDrupal 8\u7684\u4e3b\u9898\u4e5f\u662f\u7528\u540c\u6837\u683c\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3a\u4e86\u533a\u5206\u8fd9\u662f\u4e00\u4e2a\u4e3b\u9898\u8fd8\u662f\u6a21\u5757\uff0c\u8be5\u9879\u662f\u5fc5\u987b\u7684\u3002 Drupal 8 \u4e0d\u4ec5\u9700\u8981\u6a21\u5757\u4fe1\u606f\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd8\u9700\u8981\u5404\u79cd\u5176\u4ed6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982\u540e\u9762\u5c06\u8981\u8bb2\u5230\u7684\u8def\u7531\u914d\u7f6e\u6587\u4ef6*.routing.yml\u3001\u670d\u52a1\u914d\u7f6e\u6587\u4ef6*.services.yml\u7b49\u3002 3\u3001\u8def\u7531\u65b9\u5f0f \u00b6 Drupal 7\u548cDrupal 8\u7684\u8def\u7531\u4e5f\u5b58\u5728\u5f88\u5927\u7684\u533a\u522b\u3002Drupal 7 \u4f7f\u7528Hook\u7684\u65b9\u5f0f\uff0c\u800cDrupal 8\u4f7f\u7528Symfony\u6846\u67b6\u7684\u8def\u7531\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u3002\u672c\u6587\u53ea\u8ba8\u8bbaDrupal 8\u548cDrupal 7 \u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003 http://verynull.com/2015/12/23/Drupal8-routing/ \u548c http://verynull.com/2015/12/23/Drupal8-Controller/ Drupal 7\u9700\u8981\u5728module_name.module\u4e2d\u5b9e\u73b0hook_menu\u94a9\u5b50\u6765\u5c06\u67d0\u4e2aurl\u548c\u8bf7\u6c42\u5904\u7406\u65b9\u6cd5\u5173\u8054\u8d77\u6765\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function demo_menu() { $items = array(); $items['demo'] = array( 'title' => '\u793a\u4f8b', 'page callback' => 'theme', 'page arguments' => array('demo'), 'access callback' => 'user_is_logged_in', 'type' => MENU_CALLBACK ); return $items; } \u4e0a\u8ff0\u4ee3\u7801\u8868\u793a\uff0c\u5f53\u7528\u6237\u8bbf\u95ee/demo\u8def\u5f84\u65f6\u3002\u8c03\u7528theme\u65b9\u6cd5\u6e32\u67d3demo\u4e3b\u9898\uff0c\u4e3b\u9898\u9700\u8981\u5728hook_theme\u4e2d\u6ce8\u518c\uff0c\u8fd9\u4e00\u70b9Drupal 8\u6ca1\u6709\u53d8\u5316\u3002 \u5b9e\u73b0\u540c\u6837\u7684\u529f\u80fd\uff0cDrupal 8 \u9996\u5148\u9700\u8981\u914d\u7f6emodule_name.routing.yml\uff0c\u5c06\u8def\u5f84\u548c\u63a7\u5236\u5668\u4e2d\u7684\u67d0\u4e2aaction\u5173\u8054\u8d77\u6765\uff0c\u7136\u540e\u7f16\u5199\u63a7\u5236\u5668\uff0c\u5b9e\u73b0\u91cc\u9762\u7684action\u3002\u8fd9\u91cc\u9700\u8981\u63d0\u5230\u4e00\u4e2a\u6982\u5ff5MVC\uff0cMVC\u5168\u540d\u662fModel View Controller\uff0c\u662f\u6a21\u578b(model)\uff0d\u89c6\u56fe(view)\uff0d\u63a7\u5236\u5668(controller)\u7684\u7f29\u5199\uff0c\u4e00\u79cd\u8f6f\u4ef6\u8bbe\u8ba1\u5178\u8303\uff0c\u7528\u4e00\u79cd\u4e1a\u52a1\u903b\u8f91\u3001\u6570\u636e\u3001\u754c\u9762\u663e\u793a\u5206\u79bb\u7684\u65b9\u6cd5\u7ec4\u7ec7\u4ee3\u7801\u3002Drupal 8\u91cc\u9762\u7684\u63a7\u5236\u5668\u5c31\u662fMVC\u4e2dcontroller\uff0c\u7528\u4e8e\u8854\u63a5\u754c\u9762\uff08view\uff09\u548c\u6570\u636e\uff08model\uff09\uff0c\u5373\u5728\u63a7\u5236\u5668\u91cc\u9762\uff0c\u63a5\u6536\u53c2\u6570\uff0c\u7136\u540e\u8bfb\u53d6\u6570\u636e\uff0c\u4f20\u9012\u7ed9\u754c\u9762\uff0c\u6700\u540e\u8fd4\u56de\u7ed9\u7ec8\u7aef\u7528\u6237\u3002 example.rounting.yml\u683c\u5f0f\u5982\u4e0b\uff1a example.demo: path: '/demo/{name}' defaults: _controller: '\\Drupal\\example\\Controller\\ExampleController::demo' _title: 'test drupal 8 routing' requirements: _permission: 'access content' example.demo\u4e3a\u8def\u7531\u7684\u673a\u8bfb\u540d\u79f0\uff0c\u683c\u5f0f\u4e3a\"\u6a21\u5757\u540d.\u8def\u7531\"\uff0cpath\u662f\u5b9e\u9645\u7684url\u8def\u5f84\uff0c\u5176\u4e2d{name}\uff0c\u8868\u793a\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4f1a\u4f20\u9012\u7ed9action\uff0c\u53c2\u6570\u540d\u79f0\u5c31\u662fname\u3002 defaults\u4e0b\u6709\u7684_controller: '\\Drupal\\example\\Controller\\ExampleController::demo'\u8868\u793a\u63a7\u5236\u5668\u4e3a\\Drupal\\example\\Controller\\ExampleController\uff0caction\u4e3ademo\u65b9\u6cd5\u3002 defaults\u4e0b\u7684_title: 'test drupal 8 routing'\u8868\u793a\u9875\u9762\u6807\u9898\u4e3a\uff1atest drupal 8 routing\u3002 requirements\u4e0b\u7684_permission\u8868\u793a\u53ef\u4ee5\u8bbf\u95ee\u8be5\u8def\u5f84\u7684\u6743\u9650\u3002 ExampleController\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * Contains ExampleController */ namespace Drupal\\example\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; /** * Provides route responses for example.module. */ class ExampleController extends ControllerBase { /** * \u5c55\u793ahello {name}. * @param $name * * @return array * */ public function demo ( $name ) { return array ( '#markup' => t ( 'Hello ' . $name ), ); } } \u5f53\u5b8c\u6210\u4e0a\u8ff0\u4ee3\u7801\u540e\uff0c\u6e05\u9664\u7f13\u5b58\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eehttp://yourdomain/demo/World\uff0c\u754c\u9762\u5c31\u4f1a\u663e\u793aHello World\u3002example.info.yml\u3001example.routing.yml\u548cExampleController\u5c31\u6784\u6210\u4e86Drupal 8\u4e2d\u7684\u4e00\u4e2a\u6700\u57fa\u672c\u6a21\u5757\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e09\u7c7b\u6587\u4ef6\u662f\u5fc5\u987b\u7684\u3002 4\u3001\u4e3b\u9898 \u00b6 Drupal 8\u548cDrupal 7\u76f8\u6bd4\uff0c\u4e3b\u9898\u4e0a\u4e5f\u53d1\u751f\u4e86\u672c\u8d28\u7684\u53d8\u5316\uff0c\u9996\u5148\u662f\u4e3b\u9898\u5f15\u64ce\u7684\u53d8\u5316\uff0c\u5176\u6b21\u662f\u914d\u7f6e\u65b9\u5f0f\u7684\u53d8\u5316\uff0c\u6700\u540e\u662fjs\u3001css\u5f15\u5165\u65b9\u5f0f\u7684\u53d8\u5316\u3002\u672c\u6587\u53ea\u8ba8\u8bbaDrupal 8 \u4e0eDrupal 7\u4e3b\u9898\u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u4e3b\u9898\u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003 http://verynull.com/2015/11/19/Drupal8\u4e3b\u9898-theme/ \u548c http://verynull.com/2015/11/18/Drupal8\u6a21\u677f\u5f15\u64ce-twig/ \u3002 4.1\u3001\u6a21\u677f\u5f15\u64ce\u7684\u53d8\u5316 \u00b6 Drupal 7\u4f7f\u7528\u7684\u6a21\u677f\u5f15\u64ce\u662fPHPTemplate\uff0c\u8be5\u6a21\u677f\u5f15\u64ce\u7684\u7279\u70b9\u662f\u6a21\u677f\u91cc\u9762\u53ef\u4ee5\u5199php\u4ee3\u7801\u3002\u8fd9\u79cd\u6a21\u677f\u7684\u7f3a\u70b9\u663e\u800c\u6613\u89c1\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751fXSS\u548cSQL\u6ce8\u5165\u7b49\u653b\u51fb\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a <?php echo $name ; ?> \u5982\u679c$name = '<script>js\u8bed\u53e5</script>'\uff0c\u8fd9\u6837\u8f93\u51fa\u5230\u9875\u9762\u4e2d\u5c31\u4f1a\u6267\u884cscript\u6807\u7b7e\u4e2d\u7684js\u4ee3\u7801\uff0c\u8fd9\u6837\u5c31\u4f1a\u88ab\u9ed1\u5ba2\u5229\u7528\u6765\u653b\u51fb\u7f51\u7ad9\u3002 \u800cDrupal 8\u5219\u4f7f\u7528twig\u6a21\u677f\u5f15\u64ce\uff0ctwig\u6a21\u677f\u76f8\u5bf9\u4e8ePHPTemplate\u5f15\u64ce\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u6709\u70b9\uff1a \u5feb\u901f\uff1aTwig\u628a\u6a21\u677f\u7f16\u8bd1\u6210\u4e3a\u4f18\u5316\u540e\u7684PHP\u4ee3\u7801\u3002\u76f8\u5bf9\u666e\u901aPHP\u4ee3\u7801\u6765\u8bf4\uff0c\u5176\u989d\u5916\u5f00\u9500\u975e\u5e38\u8f7b\u5fae\u3002 \u5b89\u5168\uff1aTwig\u4f1a\u4f7f\u7528\u4e00\u4e2a\u6c99\u7bb1\u6a21\u5f0f\u6765\u8fd0\u884c\u4e0d\u4fe1\u4efb\u7684\u6a21\u677f\u4ee3\u7801\u3002\u8fd9\u4f7f\u5f97Twig\u53ef\u4ee5\u5728\u7528\u6237\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u8bbe\u8ba1\u7684\u5e94\u7528\u4e2d\u5de5\u4f5c\u826f\u597d\u3002 \u5f39\u6027\uff1aTwig\u8bd5\u7528\u4e86\u5f39\u6027\u7684\u8bcd\u6cd5\u548c\u8bed\u6cd5\u5206\u6790\u5668\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u5b9a\u4e49\u81ea\u5df1\u7684\u6807\u8bb0\u548c\u8fc7\u6ee4\uff0c\u5e76\u521b\u5efa\u81ea\u5df1\u7684DSL\u3002 \u53ef\u4ee5\u770b\u51fa\uff0ctwig\u91cc\u9762\u4e0d\u80fd\u5199php\u4ee3\u7801\uff0c\u4ed6\u6709\u4e00\u5957\u81ea\u5df1\u7684\u8bed\u6cd5\uff0c\u5e76\u4e14\u6700\u7ec8\u88ab\u7f16\u8bd1\u4e3aphp\uff0c\u8fd0\u884c\u5728\u5b89\u5168\u6c99\u7bb1\u4e2d\uff0c\u4e00\u53e5\u8bdd\uff0c\u5c31\u662f\u5b89\u5168\u3002\u50cf\u4e0a\u9762\u7684\u8f93\u51fa\u53d8\u91cf\uff0c\u5728twig\u4e2d\u5982\u4e0b\uff1a {{ name }} \u8fd9\u6837\u4f1a\u81ea\u52a8\u628a\u4e0d\u5b89\u5168\u7684\u5b57\u7b26\u8fc7\u6ee4\u6389\u3002\u4e0b\u9762\u6765\u6bd4\u8f83PHPTemplate\u548ctwig\u7684\u5178\u578b\u7684\u4e0d\u540c\u4e4b\u5904\u3002 1.\u540e\u7f00\u540d PHPTemplate\u7684\u540e\u7f00\u540d\u662f.tpl.php\uff0ctwig\u7684\u540e\u7f00\u540d\u4e3a.html.twig. 2.\u53d8\u91cf \u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf PHPTemplate: <div class=\"content\"> <?php print $content ; ?> </div> Twig: <div class=\"content\">{{ content }}</div> \u8f93\u51fa\u4e00\u4e2a\u54c8\u5e0c\u952e\u503c PHPTemplate: <?php print $item [ '#item' ][ 'alt' ]; ?> Twig: {{ item['#item'].alt }} \u53d8\u91cf\u8d4b\u503c PHPTemplate: <?php $custom_var = $content -> comments ; ?> Twig: {% set custom_var = content.comments %} \u6570\u7ec4\u521d\u59cb\u5316 PHPTemplate: <?php $args = array ( '!author' => $author , '!date' => $created ); ?> Twig: {% set args = {'!author': author, '!date': created} 3.\u6761\u4ef6\u5224\u65ad PHPTemplate: <?php if ( $content -> comments ) : endif ; ?> Twig: {% if content.comments %} {% endif %} PHPTemplate: <?php if ( ! empty ( $content -> comments )) : endif ; ?> Twig: {% if content.comments is not empty %} {% endif %} PHPTemplate: <?php if ( isset ( $content -> comments )) : endif ; ?> Twig: {% if content.comments is defined %} {% endif %} PHPTemplate: <?php if ( $count > 0 ) : endif ; ?> Twig: {% if count > 0 %} {% endif %} 4.\u63a7\u5236\u7ed3\u6784 PHPTemplate: <?php foreach ( $users as $user ) {} ?> Twig: {% for user in users %} {% endfor %} 5.\u8fc7\u6ee4 check_plain\uff1a PHPTemplate: <?php print check_plain ( $title ); ?> Twig: {{ title|striptags }} Translate\uff1a PHPTemplate: <?php print t ( 'Home' ); ?> Twig: {{ 'Home'|t }} \u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003\u4e0a\u8ff0\u6587\u7ae0\u3002 4.2\u3001\u4e3b\u9898\u914d\u7f6e \u00b6 Drupal 7\u7684\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6bartik.info\u683c\u5f0f\u5982\u4e0b\uff1a name = Bartik description = A flexible, recolorable theme with many regions. package = Core version = VERSION core = 7.x stylesheets[all][] = css/layout.css stylesheets[all][] = css/style.css stylesheets[all][] = css/colors.css stylesheets[print][] = css/print.css regions[header] = Header regions[help] = Help regions[page_top] = Page top regions[page_bottom] = Page bottom regions[highlighted] = Highlighted regions[featured] = Featured regions[content] = Content regions[sidebar_first] = Sidebar first regions[sidebar_second] = Sidebar second regions[triptych_first] = Triptych first regions[triptych_middle] = Triptych middle regions[triptych_last] = Triptych last regions[footer_firstcolumn] = Footer first column regions[footer_secondcolumn] = Footer second column regions[footer_thirdcolumn] = Footer third column regions[footer_fourthcolumn] = Footer fourth column regions[footer] = Footer settings[shortcut_module_link] = 0 \u672c\u6587\u7b2c\u4e8c\u7ae0\u8282\u5df2\u7ecf\u63d0\u5230\uff0cDrupal 8 \u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u662f\u7528yaml\u6587\u4ef6\uff0cbartik.info.yml\uff1a name: Bartik type: theme base theme: classy description: 'A flexible, recolorable theme with many regions and a responsive, mobile-first layout.' package: Core # version: VERSION # core: 8.x libraries: - bartik/global-styling ckeditor_stylesheets: - css/base/elements.css - css/components/captions.css - css/components/table.css regions: header: Header primary_menu: 'Primary menu' secondary_menu: 'Secondary menu' page_top: 'Page top' page_bottom: 'Page bottom' highlighted: Highlighted featured_top: 'Featured top' breadcrumb: Breadcrumb content: Content sidebar_first: 'Sidebar first' sidebar_second: 'Sidebar second' featured_bottom_first: 'Featured bottom first' featured_bottom_second: 'Featured bottom second' featured_bottom_third: 'Featured bottom third' footer_first: 'Footer first' footer_second: 'Footer second' footer_third: 'Footer third' footer_fourth: 'Footer fourth' footer_fifth: 'Footer fifth' \u4ece\u4ee5\u4e0a\u53ef\u4ee5\u770b\u51fa\uff0cDrupal 7 \u548cDrupal 8 \u7684\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u5927\u81f4\u76f8\u540c\uff0c\u53ea\u662f\u683c\u5f0f\u4e0d\u4e00\u81f4\uff0c\u4e3b\u8981\u7684\u4e0d\u540c\u6709\u4e24\u70b9\uff1a 1.Drupal 8\u7684\u914d\u7f6e\u6587\u4ef6\u591a\u4e86type: theme\uff0c\u8fd9\u662f\u7528\u6765\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u4e3b\u9898\uff0c\u800c\u4e0d\u662f\u6a21\u5757\u3002 2.js\u3001css\u7684\u5168\u5c40\u5f15\u5165\uff0cDrupal 7\u53ef\u4ee5\u76f4\u63a5\u5f15\u5165\u5355\u4e2ajs\u3001css\u6587\u4ef6\uff0c\u800cDrupal 8\u9700\u8981\u5148\u5c06css\u3001js\u8bbe\u7f6e\u6210library\uff0c\u7136\u540e\u5728\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f15\u5165library\uff0c\u5982\u4e0a\u4f8b\u4e2d\u7684\uff1a libraries: - bartik/global-styling \u8868\u793a\u5f15\u5165bartik\u4e3b\u9898\u4e0b\u7684global-styling\u5e93\u3002library\u5e93\u662f\u5728theme_name.libraries.yml\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\uff0cbartik.libraries.yml\u7684\u90e8\u5206\u4ee3\u7801\u5982\u4e0b: color.preview: version: VERSION css: theme: color/preview.css: {} js: color/preview.js: {} dependencies: - color/drupal.color maintenance_page: version: VERSION css: theme: css/maintenance-page.css: {} dependencies: - system/maintenance - bartik/global-styling \u5176\u4e2dcolor.preview\u3001maintenance_page\u5c31\u8868\u793a\u4e00\u4e2alibrary\uff0c\u6bcf\u4e2alibrary\u4e0b\u53ef\u4ee5\u6709css\u3001js\u3001dependencies\u7b49\u952e\uff0c\u5206\u522b\u8868\u793a\u5f15\u5165css\u3001\u5f15\u5165js\u548c\u5f15\u5165\u4f9d\u8d56\u7684\u5e93\u3002 4.3\u3001\u5f15\u5165js\u3001css \u00b6 \u57284.2\u8282\u4e2d\u5df2\u7ecf\u63d0\u5230\uff0cDrupal 8\u4e2d\u5f15\u5165js\u548ccss\u5fc5\u987b\u4f7f\u7528library\uff0c\u4e0d\u80fd\u5355\u72ec\u5f15\u5165\u5355\u4e2ajs\u6216css\u6587\u4ef6\u3002\u5728\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f15\u5165\u5168\u5c40\u7684\u5e93\u4e5f\u5df2\u7ecf\u57284.2\u8282\u4e2d\u9610\u8ff0\uff0c\u90a3\u5728\u5355\u4e2a\u9875\u9762\u4e2d\u5f15\u5165js\u548ccss\u6709\u4f55\u4e0d\u540c\u5462\uff1f \u6211\u4eec\u5728Drupal 7\u4e2d\u901a\u5e38\u901a\u8fc7drupal_add_js\u548cdrupal_add_css\u6765\u5f15\u5165js\u548ccss\uff0c\u4f8b\u5982\uff1a drupal_add_js(drupal_get_path('module', 'demo') . '/js/demo.js'); drupal_add_css(drupal_get_path('module', 'demo') . '/css/demo.css'); \u5728Drupal 8\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u5c06js\u3001css\u914d\u7f6e\u6210\u5e93\uff0c\u5982demo.libraries.yml: base: version: VERSION css: theme: css/demo.css: {} js: js/demo.js: {} dependencies: - core/jquery \u4e0a\u9762\u914d\u7f6e\u4e86\u4e00\u4e2abase\u5e93\uff0cDrupal 8\u4e2d\u9664\u4e86\u8981\u914d\u7f6e\u5e93\uff0c\u8fd8\u8981\u5728\u6e32\u67d3\u6570\u7ec4\u4e2d\u4f7f\u7528#attached\u624d\u80fd\u5c06\u5e93\u52a0\u5230\u9875\u9762\u4e2d\uff1a return array( '#theme' => 'example_demo', '#attached' => array( 'library' => array( 'example/base' ) ) ); \u4e0a\u8ff0\u4ee3\u7801\u8868\u793a\uff0c\u6e32\u67d3example_demo\u4e3b\u9898\uff0c\u5e76\u4e14\u52a0\u8f7dexample/base'\u5e93\u3002 5\u3001\u8868\u5355 \u00b6 \u6211\u4eec\u5c06\u4ee5\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u6765\u5206\u6790Drupal 7\u548cDrupal 8\u8868\u5355\u7684\u5f02\u540c\u3002 \u5728Drupal 7\u4e2d\u8981\u5b9e\u73b0\u8868\u5355\u7684\u5c55\u793a\u3001\u63d0\u4ea4\uff0c\u9996\u5148\u9700\u8981\u914d\u7f6e\u83dc\u5355\uff0c\u5c06\u8def\u5f84\u548c\u8868\u5355\u51fd\u6570\u5173\u8054\u8d77\u6765\u5728hook_menu\u4e2d\u5b9a\u4e49\u5982\u4e0b\u83dc\u5355\uff1a $items['demo/form'] = array( 'title' => 'Create demo form', 'page callback' => 'drupal_get_form', 'page arguments' => array('demo_form'), 'access callback' => 'access content', 'type' => MENU_LOCAL_TASK, ); \u63a5\u4e0b\u6765\uff0c\u5b9a\u4e49\u8868\u5355\u51fd\u6570demo_form\uff1a function demo_form($form, &$form_state) { $form['name'] = array( '#type' => 'textfield', '#title' => '\u59d3\u540d' ); $form['actions']['#type'] = 'actions'; $form['actions']['submit'] = array( '#type' => 'submit', '#value' => $this->t('Save'), '#button_type' => 'primary', ); $form['#validate'][] = 'demo_validate'; $form['#submit'][] = 'demo_submit'; return $form; } \u4e0a\u8ff0\u4ee3\u7801\u8868\u660e\u8868\u5355\u6709\u4e00\u4e2a\u6587\u672c\u6846\uff0c\u4e00\u4e2a\u63d0\u4ea4\u6309\u94ae\uff0c\u8868\u5355\u7684\u9a8c\u8bc1\u51fd\u6570\u4e66demo_validate\uff0c\u63d0\u4ea4\u5904\u7406\u51fd\u6570\u662fdemo_submit\u3002 \u4e0b\u9762\u5b9e\u73b0demo_validate\u3001demo_submit\uff1a function demo_validate($form, &$form_state) { $name = $form_state['value']['name']; if($name != 'world') { form_set_error('name', '\u53c2\u6570\u9519\u8bef'); } } function demo_submit($form, &$form_state) { $name = $form_state['value']['name']; drupal_set_message('Hello' . $name); } \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbf\u95eedemo/form\u4e86\uff0c\u5728\u6587\u672c\u6846\u4e2d\u8f93\u5165world\uff0c\u5219\u754c\u9762\u5c31\u4f1a\u663e\u793aHello world\uff0c\u4f46\u662f\u8f93\u5165\u5176\u4ed6\u7684\u6587\u672c\uff0c\u5219\u4f1a\u62a5\u9519\u201c\u53c2\u6570\u9519\u8bef\u201d\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0bDrupal 8\u4e2d\u7684\u8868\u5355\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u9996\u5148\u6211\u4eec\u8981\u914d\u7f6e\u4e00\u4e2a\u8def\u7531\u6307\u5411\u8868\u5355\uff0c example.demo_form: path: '/demo/form' defaults: _form: '\\Drupal\\example\\Form\\ExampleForm' _title: 'test drupal 8 form' requirements: _permission: 'access content' path\uff1a'/demo/form'\u8868\u793a\u8868\u5355\u8def\u5f84\u662f/demo/form\uff0c_form: '\\Drupal\\example\\Form\\ExampleForm'\u8868\u793a\u8868\u5355\u7c7b\u662f\\Drupal\\example\\Form\\ExampleForm\uff0c\u90a3\u4e48\u4e0b\u9762\u5c31\u6765\u5b9e\u73b0\u8fd9\u4e2a\u7c7b\uff1a <?php /** * @file * contains Drupal\\example\\Form\\ExampleForm */ namespace Drupal\\example\\Form ; use Drupal\\Core\\Form\\FormBase ; use Drupal\\Core\\Form\\FormStateInterface ; class ExampleForm extends FormBase { /** * @inheritdoc */ public function getFormId () { return 'example_form' ; } /** * @inheritdoc */ public function buildForm ( array $form , FormStateInterface $form_state ) { $form [ 'name' ] = array ( '#type' => 'textfield' , '#title' => '\u59d3\u540d' ); $form [ 'actions' ][ '#type' ] = 'actions' ; $form [ 'actions' ][ 'submit' ] = array ( '#type' => 'submit' , '#value' => $this -> t ( 'Save' ), '#button_type' => 'primary' , ); return $form ; } /** * @inheritdoc */ public function validateForm ( array & $form , FormStateInterface $form_state ) { parent :: validateForm ( $form , $form_state ); if ( $form_state -> getValue ( 'name' ) != 'world' ) { $a = array ( 'name' ); $form_state -> setErrorByName ( 'name' , '\u53c2\u6570\u9519\u8bef' ); } } /** * @inheritdoc */ public function submitForm ( array & $form , FormStateInterface $form_state ) { $name = $form_state -> getValue ( 'name' ); drupal_set_message ( 'Hello' . $name ); } } \u53ef\u89c1\uff0cDrupal 8\u4e2d\u7684\u8868\u5355\u5c31\u662f\u4e00\u4e2a\u7c7b\uff0c\u7ee7\u627f\u81eaformBase\uff0c\u9700\u8981\u8986\u5199\u7236\u7c7b\u7684\u56db\u4e2a\u65b9\u6cd5\uff1agetFormId\u3001buildForm\u3001validateForm\u548csubmitForm\u3002 1.getFormId \u8fd4\u56de\u8868\u5355ID\uff0c\u5bf9\u5e94\u4e8eDrupal 7\u4e2d\u7684\u8868\u5355\u7684\u65b9\u6cd5\u540d\uff1b 2.buildForm \u6784\u9020\u5e76\u8fd4\u56de\u8868\u5355\uff0c\u5bf9\u5e94\u4e8eDrupal 7\u4e2d\u7684\u8868\u5355\u51fd\u6570\u3002 3.validateForm \u8868\u5355\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5bf9\u5e94\u4e8eDrupal 7\u4e2d\u7684$form['#validate'][] = 'demo_validate'\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5 4.submitForm \u8868\u5355\u63d0\u4ea4\u5904\u7406\u65b9\u6cd5\uff0c\u5bf9\u5e94\u4e8eDrupal 7 \u4e2d$form['#submit'][] = 'demo_submit'\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u3002 \u901a\u8fc7\u5bf9\u6bd4\u53ef\u4ee5\u53d1\u73b0\uff0cDrupal 8\u5c06\u8868\u5355\u7684\u5404\u4e2a\u5143\u7d20\u7ec4\u7ec7\u5728\u4e00\u4e2a\u7c7b\u91cc\u9762\uff0c\u7ed3\u6784\u6e05\u6670\uff0c\u903b\u8f91\u5206\u660e\uff0c\u76f8\u5bf9\u4e8eDrupal 7\u677e\u6563\u7684\u4ee3\u7801\u662f\u5f88\u5927\u7684\u8fdb\u6b65\u3002 6\u3001\u94a9\u5b50\u673a\u5236\u5728Drupal 8\u4e2d\u7684\u53d8\u5316\u53ca\u5b9e\u73b0 \u00b6 \u94a9\u5b50\u673a\u5236\u5728Drupal 7\u4e2d\u8d77\u7740\u4e3e\u8db3\u8f7b\u91cd\u7684\u4f5c\u7528\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\u4e24\u4e2a\u65b9\u9762\uff1a \u4e00\u662finfo\u7c7b\u7684\u94a9\u5b50\uff0c\u4f8b\u5982hook_menu\u3001hook_theme\u3001hook_services_resources\u7b49\uff0c\u8d77\u5230\u5173\u8054\u4fe1\u606f\u7684\u4f5c\u7528\uff0c\u6bd4\u5982hook_menu\u544a\u8bc9\u7cfb\u7edfURL\u8def\u5f84\u548c\u5904\u7406\u65b9\u6cd5\u7684\u5bf9\u5e94\u5173\u7cfb\u4ee5\u4fbf\u7528\u6237\u8bbf\u95ee\u67d0\u4e2a\u8def\u5f84\u7684\u65f6\u5019\u627e\u5230\u6b63\u786e\u7684\u51fd\u6570\u6765\u5904\u7406\uff1b \u4e8c\u662f\u8c03\u7528\u7c7b\u94a9\u5b50\uff0c\u4f8b\u5982hook_user_delete\u7b49\uff0c\u8c03\u7528\u7c7b\u94a9\u5b50\u7684\u4f5c\u7528\u662f\u7cfb\u7edf\u5728\u505a\u4e86\u67d0\u4e2a\u64cd\u4f5c\u4e4b\u540e\u901a\u8fc7module_invoke_all\u6765\u8c03\u7528\u5176\u4ed6\u6a21\u5757\u4e2d\u5b9e\u73b0\u7684\u94a9\u5b50\u51fd\u6570\u3002\u6bd4\u5982\uff0c\u5220\u9664\u67d0\u4e2a\u7528\u6237\u4e4b\u540e\uff0c\u53ef\u80fd\u9700\u8981\u5220\u9664\u8be5\u7528\u6237\u5173\u8054\u7684\u5176\u4ed6\u8d44\u6e90\uff0c\u5219\u6a21\u5757\u9700\u8981\u901a\u8fc7\u5b9e\u73b0hook_user_delete\u94a9\u5b50\u3002 Drupal 8\u4e2d\u8fd9\u4e24\u7c7b\u94a9\u5b50\u90fd\u6709\u4e86\u76f8\u5e94\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0cinfo\u7c7b\u578b\u7684\u94a9\u5b50\u5927\u90e8\u5206\u88ab\u63d2\u4ef6\uff08Plugin\uff09\u4ee3\u66ff\uff0c\u8c03\u7528\u7c7b\u578b\u7684\u94a9\u5b50\u5219\u88ab\u4e8b\u4ef6\uff08Event\uff09\u4ee3\u66ff\u3002\u4e0b\u9762\u5206\u522b\u9488\u5bf9\u4e24\u79cd\u94a9\u5b50\u9009\u62e9\u5177\u6709\u4ee3\u8868\u6027\u7684\u529f\u80fd\u505a\u5206\u6790\u3002 6.1\u3001\u8c03\u7528\u94a9\u5b50\u7684\u66ff\u4ee3\u4e0e\u5b9e\u73b0 \u00b6 \u8c03\u7528\u94a9\u5b50\u5728Drupal 7 \u4e2d\u6700\u6709\u4ee3\u8868\u6027\u7684\u5e94\u7528\u662f\u7528\u6237\u7684\u5220\u9664\uff0c\u5b9e\u73b0\u9700\u8981\u5206\u4e24\u6b65\uff1a 1.\u5b9e\u73b0hook_user_delete\u65b9\u6cd5\uff0c\u4ee5demo\u6a21\u5757\u4e3a\u4f8b\uff1a function demo_user_delete($account) { db_delete('user_demo', 'ud') ->condition('ud.uid', $account->uid) ->execute(); } 2.\u5728\u7528\u6237\u5220\u9664\u7684\u65b9\u6cd5\u91cc\u9762\u901a\u8fc7module_invoke_all\u6765\u8c03\u7528\u94a9\u5b50\uff1a module_invoke_all('user_delete', $account); \u53ea\u9700\u8981\u4e24\u6b65\u5c31\u5b9e\u73b0\u4e86\u7528\u6237\u5220\u9664\u4e4b\u540e\uff0c\u5220\u9664\u5173\u8054\u8d44\u6e90\u7684\u529f\u80fd\u3002 Drupal 8\u91cc\u9762\u7684\u4e8b\u4ef6\u7684\u4e09\u4e2a\u8981\u7d20\uff1a\u4e8b\u4ef6\u3001\u4e8b\u4ef6\u76d1\u542c\u548c\u4e8b\u4ef6\u89e6\u53d1\u3002 \u8981\u5b9e\u73b0\u4e8b\u4ef6\u673a\u5236\uff0c\u9996\u5148\u6211\u4eec\u5fc5\u987b\u5148\u5b9a\u4e49\u4e00\u4e2a\u4e8b\u4ef6\uff08Event\uff09\uff0c\u6bd4\u5982\u7ad9\u70b9\u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\uff0c\u5176\u6b21\u6709\u4e86\u8fd9\u4e2a\u4e8b\u4ef6\u540e\uff0c\u9700\u8981\u6709\u8ba2\u9605\u8005\u6765\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u6700\u540e\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u89e6\u53d1\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u5c06\u4e8b\u4ef6\u4f20\u9012\u7ed9\u6240\u6709\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\u7684\u8ba2\u9605\u8005\u3002 \u6211\u4eec\u4ee5\u7ad9\u70b9\u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\u4e3a\u4f8b\uff0c\u4ecb\u7ecd\u4e8b\u4ef6\u8ba2\u9605\u7684\u5b9e\u73b0\uff1a 1.\u5b9a\u4e49\u4e8b\u4ef6 Drupal 8\u7684\u6838\u5fc3\u6a21\u5757Config\u6a21\u5757\u4e2d\u5b9a\u4e49\u4e86ConfigEvent\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * Contains \\Drupal\\Core\\Config\\ConfigEvents. */ namespace Drupal\\Core\\Config ; /** * Defines events for the configuration system. * * @see \\Drupal\\Core\\Config\\ConfigCrudEvent */ final class ConfigEvents { /** * Name of the event fired when saving a configuration object. * * This event allows modules to perform an action whenever a configuration * object is saved. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigCrudEvent instance. * * See hook_update_N() documentation for safe configuration API usage and * restrictions as this event will be fired when configuration is saved by * hook_update_N(). * * @Event * * @see \\Drupal\\Core\\Config\\ConfigCrudEvent * @see \\Drupal\\Core\\Config\\Config::save() * @see \\Drupal\\Core\\Config\\ConfigFactory::onConfigSave() * @see hook_update_N() * * @var string */ const SAVE = 'config.save' ; /** * Name of the event fired when deleting a configuration object. * * This event allows modules to perform an action whenever a configuration * object is deleted. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigCrudEvent instance. * * See hook_update_N() documentation for safe configuration API usage and * restrictions as this event will be fired when configuration is deleted by * hook_update_N(). * * @Event * * @see \\Drupal\\Core\\Config\\ConfigCrudEvent * @see \\Drupal\\Core\\Config\\Config::delete() * @see \\Drupal\\Core\\Config\\ConfigFactory::onConfigDelete() * @see hook_update_N() * * @var string */ const DELETE = 'config.delete' ; /** * Name of the event fired when renaming a configuration object. * * This event allows modules to perform an action whenever a configuration * object's name is changed. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigRenameEvent instance. * * See hook_update_N() documentation for safe configuration API usage and * restrictions as this event will be fired when configuration is renamed by * hook_update_N(). * * @Event * * @see \\Drupal\\Core\\Config\\ConfigRenameEvent * @see \\Drupal\\Core\\Config\\ConfigFactoryInterface::rename() * @see hook_update_N() * * @var string */ const RENAME = 'config.rename' ; /** * Name of the event fired when validating imported configuration. * * This event allows modules to perform additional validation operations when * configuration is being imported. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigImporterEvent instance. * * @Event * * @see \\Drupal\\Core\\Config\\ConfigImporterEvent * @see \\Drupal\\Core\\Config\\ConfigImporter::validate(). * @see \\Drupal\\Core\\EventSubscriber\\ConfigImportSubscriber::onConfigImporterValidate(). * * @var string */ const IMPORT_VALIDATE = 'config.importer.validate' ; /** * Name of the event fired when importing configuration to target storage. * * This event allows modules to perform additional actions when configuration * is imported. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigImporterEvent instance. * * @Event * * @see \\Drupal\\Core\\Config\\ConfigImporterEvent * @see \\Drupal\\Core\\Config\\ConfigImporter::import(). * @see \\Drupal\\Core\\EventSubscriber\\ConfigSnapshotSubscriber::onConfigImporterImport(). * * @var string */ const IMPORT = 'config.importer.import' ; /** * Name of event fired when missing content dependencies are detected. * * Events subscribers are fired as part of the configuration import batch. * Each subscribe should call * \\Drupal\\Core\\Config\\MissingContentEvent::resolveMissingContent() when they * address a missing dependency. To address large amounts of dependencies * subscribers can call * \\Drupal\\Core\\Config\\MissingContentEvent::stopPropagation() which will stop * calling other events and guarantee that the configuration import batch will * fire the event again to continue processing missing content dependencies. * * @see \\Drupal\\Core\\Config\\ConfigImporter::processMissingContent() * @see \\Drupal\\Core\\Config\\MissingContentEvent */ const IMPORT_MISSING_CONTENT = 'config.importer.missing_content' ; /** * Name of event fired to collect information on all config collections. * * This event allows modules to add to the list of configuration collections * retrieved by \\Drupal\\Core\\Config\\ConfigManager::getConfigCollectionInfo(). * The event listener method receives a * \\Drupal\\Core\\Config\\ConfigCollectionInfo instance. * * @Event * * @see \\Drupal\\Core\\Config\\ConfigCollectionInfo * @see \\Drupal\\Core\\Config\\ConfigManager::getConfigCollectionInfo() * @see \\Drupal\\Core\\Config\\ConfigFactoryOverrideBase * * @var string */ const COLLECTION_INFO = 'config.collection_info' ; } \u8be5\u4e8b\u4ef6\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982const SAVE = 'config.save'\u7684\u610f\u601d\u5373\u5b9a\u4e49\u4e86\u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\uff0c\u5f53\u914d\u7f6e\u4fdd\u5b58\u5b8c\u6210\u540e\u89e6\u53d1\u8be5\u4e8b\u4ef6\u3002 \u6709\u4e86\u4e8b\u4ef6\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u9700\u8981\u6709\u4e8b\u4ef6\u8ba2\u9605\u8005\u6765\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u4e00\u65e6\u914d\u7f6e\u4fdd\u5b58\uff0c\u5219\u6267\u884c\u76f8\u5e94\u7684\u4ee3\u7801\u3002\u6211\u4eec\u4ecd\u7136\u4ee5demo\u6a21\u5757\u4e3a\u4f8b\uff0c\u5047\u8bbe\u914d\u7f6e\u4fdd\u5b58\u540e\uff0c\u6211\u4eec\u7684demo\u6a21\u5757\u9700\u8981\u8bb0\u5f55\u4e00\u6761\u65e5\u5fd7\uff0c\u90a3demo\u6a21\u5757\u9700\u8981\u5b9e\u73b0\u76f8\u5e94\u7684\u4e8b\u4ef6\u8ba2\u9605\u7c7b\uff1a <?php /** * @file * Contains \\Drupal\\demo\\EventSubscriber\\ConfigSubscriber. */ namespace Drupal\\demo\\EventSubscriber ; use Drupal\\Core\\Config\\ConfigFactoryInterface ; use Drupal\\Core\\Config\\ConfigCrudEvent ; use Drupal\\Core\\Config\\ConfigEvents ; use Symfony\\Component\\EventDispatcher\\EventSubscriberInterface ; /** * \u8bb0\u5f55\u65e5\u5fd7\uff0c\u5982\u679c\u914d\u7f6e\u4fdd\u5b58\u4e86 */ class ConfigSubscriber implements EventSubscriberInterface { /** * \u65e5\u5fd7\u8bb0\u5f55 * * * @param ConfigCrudEvent $event * The configuration event. */ public function onConfigSave ( ConfigCrudEvent $event ) { $saved_config = $event -> getConfig (); $logger = \\Drupal :: logger ( 'config save' ); $logger -> notice ( $saved_config -> getName () . '\u4fdd\u5b58\u4e86' ); } /** * {@inheritdoc} */ static function getSubscribedEvents () { $events [ ConfigEvents :: SAVE ][] = array ( 'onConfigSave' , 0 ); return $events ; } } \u8fd9\u4e2a\u4e8b\u4ef6\u8ba2\u9605\u7c7b\u5b9e\u73b0\u4e86EventSubscriberInterface\uff0c\u8fd9\u4e2a\u63a5\u53e3\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5getSubscribedEvents\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u4e8b\u4ef6\u5bf9\u7528\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u6bd4\u5982$events[ConfigEvents::SAVE][] = array('onConfigSave', 0)\u8868\u793aConfigEvents::SAVE\u4e8b\u4ef6\u7684\u5904\u7406\u65b9\u6cd5\u4e3aonConfigSave\uff0c\u540e\u9762\u7684\u7b2c\u4e8c\u4e2a\u53c2\u65700\u8868\u793a\u4f18\u5148\u7ea7\uff0c\u8d8a\u5927\u8d8a\u5148\u6267\u884c\u3002 \u5b9e\u73b0\u4e86\u8fd9\u4e2a\u8ba2\u9605\u7c7b\u4e4b\u540e\uff0c\u4e3a\u4e86\u8ba9\u4e8b\u4ef6\u8c03\u5ea6\u5668\uff08event dispacher\uff09\u77e5\u9053\u8fd9\u4e2a\u8ba2\u9605\u8005\uff0c\u6211\u4eec\u9700\u8981\u628a\u8fd9\u4e2a\u8ba2\u9605\u7c7b\u914d\u7f6e\u6210\u670d\u52a1\uff0c\u5728demo.services.yml\u4e2d\u6211\u4eec\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a demo.config_subscriber: class: Drupal\\demo\\EventSubscriber\\ConfigSubscriber arguments: [] tags: - { name: event_subscriber } \u5230\u6b64\u4e8b\u4ef6\u8ba2\u9605\u7684\u5de5\u4f5c\u5c31\u5b8c\u6210\u4e86\uff0c\u8981\u89e6\u53d1\u4e8b\u4ef6\uff0c\u5fc5\u987b\u8981\u5728\u914d\u7f6e\u4fdd\u5b58\u7684\u65f6\u5019\u4f7f\u7528\u4e8b\u4ef6\u8c03\u5ea6\u5668\u5c06\u4e8b\u4ef6\u4f20\u9012\u7ed9\u8ba2\u9605\u8005\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public function save($has_trusted_data = FALSE) { // Validate the configuration object name before saving. static::validateName($this->name); // If there is a schema for this configuration object, cast all values to // conform to the schema. if (!$has_trusted_data) { if ($this->typedConfigManager->hasConfigSchema($this->name)) { // Ensure that the schema wrapper has the latest data. $this->schemaWrapper = NULL; foreach ($this->data as $key => $value) { $this->data[$key] = $this->castValue($key, $value); } } else { foreach ($this->data as $key => $value) { $this->validateValue($key, $value); } } } $this->storage->write($this->name, $this->data); if (!$this->isNew) { Cache::invalidateTags($this->getCacheTags()); } $this->isNew = FALSE; $this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent($this)); $this->originalData = $this->data; // Potentially configuration schema could have changed the underlying data's // types. $this->resetOverriddenData(); return $this; } \u4e0a\u8ff0\u4ee3\u7801\u4e3aConfig\u6a21\u5757\u4e2d\u914d\u7f6e\u4fdd\u5b58\u7684\u65b9\u6cd5\uff0c\u5176\u4e2d\u7684 this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent( this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent( this))\u8fd9\u53e5\u4ee3\u7801\u5c31\u662f\u8bb2\u4e8b\u4ef6\u4f20\u9012\u7ed9\u6240\u6709\u76d1\u542c\u4e86ConfigEvents::SAVE\u4e8b\u4ef6\u7684\u8ba2\u9605\u8005\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u6211\u4eecdemo\u6a21\u5757\u91cc\u9762\u7684\u8ba2\u9605\u8005\u3002 \u5173\u4e8e\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u7684\u5b9e\u73b0\u8bf7\u53c2\u8003 http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/ 6.2\u3001info\u7c7b\u94a9\u5b50\u7684\u66ff\u6362\u4e0e\u5b9e\u73b0 \u00b6 info\u7c7b\u94a9\u5b50\u7684\u4e00\u4e2a\u91cd\u8981\u5e94\u7528\u662fweb services\u3002\u5728Drupal 7\u4e2d\uff0c\u5185\u6838\u4e0d\u5e26rest\uff0c\u9700\u8981\u7b2c\u4e09\u65b9\u6a21\u5757\u3002\u800c\u5728drupal8\u4e2d\uff0c\u6838\u5fc3\u81ea\u5e26rest\uff0c\u9664\u4e86rest\u754c\u9762\u7ba1\u7406\u6a21\u5757\uff08rest UI\uff09\u5916\uff0c\u4e0d\u9700\u8981\u7b2c\u4e09\u65b9\u6a21\u5757\u3002 Drupal 7\u4e2d\u5b9e\u73b0\u4e00\u4e2aweb services\u9700\u8981\u4ee5\u4e0b\u51e0\u6b65\uff1a 1.\u4e0b\u8f7dServices\u3001REST Server\u3001Chaos tools\u3001OAuth Authentication\u7b2c\u4e09\u65b9\u6a21\u5757\u653e\u5165\u76f8\u5e94\u76ee\u5f55\uff0c\u8fdb\u5165\u540e\u53f0->\u6a21\u5757\uff0c\u52fe\u9009\u8fd9\u51e0\u4e2a\u6a21\u5757\u4fdd\u5b58\u542f\u7528\u3002 2.\u5b9e\u73b0hook_services_resources,\u4ee3\u7801\u5982\u4e0b\uff1a /** * Implements hook_services_resources(). */ function demo_services_resources() { return array( 'demo' => array( 'actions' => array( 'add' => array( 'help' => '\u521b\u5efa\u793a\u4f8b', 'file' => array('file' => 'inc', 'module' => 'demo', 'name' => 'demo.apis'), 'callback' => 'demo_add_resources', 'access arguments' => array('access_to_demo_api'), 'args' => array( array( 'name' => 'data', 'source' => 'data', 'type' => 'array', 'optional' => FALSE, ), ), ), ), ), ); } \u5176\u4e2d\u6570\u7ec4\u7684\u7b2c\u4e00\u5c42\u8868\u793a\u63a5\u53e3\u5730\u5740\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0cactions\u4e0b\u7684\u6bcf\u4e00\u4e2a\u952e\u8868\u793a\u4e00\u4e2a\u63a5\u53e3\uff0c\u540c\u65f6\u4e5f\u662f\u63a5\u53e3\u5730\u5740\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982\u4e0a\u9762\u7684\u4f8b\u5b50\u8868\u793ademo/add\u63a5\u53e3\uff0ccallback\u8868\u793a\u63a5\u53e3\u7684\u5904\u7406\u51fd\u6570\u3002file\u8868\u793a\u63a5\u53e3\u65b9\u6cd5\u6240\u5728\u7684\u6587\u4ef6\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u8981\u5b9e\u73b0demo_add_resources\u65b9\u6cd5\uff1a function demo_add_resources($data) { $return = array( 'code' => 0, 'message' => '\u64cd\u4f5c\u5931\u8d25' ); return $return; } \u6700\u540e\u6211\u4eec\u8981\u8fdb\u5165\u7cfb\u7edf\u7ba1\u7406\u754c\u9762-\u300b\u7ed3\u6784-\u300bservices\u6dfb\u52a0\u4e00\u4e2a\u7aef\u70b9\uff0c\u6211\u4eec\u5c06\u673a\u8bfb\u540d\u79f0\u8bbe\u7f6e\u4e3aapi\uff0c\u670d\u52a1\u5668\u9009\u62e9rest\uff0c\u7aef\u70b9\u8def\u5f84\u8bbe\u4e3aAPI\uff0c\u4fdd\u5b58\uff0c\u5219\u7aef\u70b9\u65b0\u5efa\u6210\u529f\u3002\u70b9\u51fb\u7f16\u8f91\uff0c\u5c06\u6211\u4eec\u521a\u624d\u65b0\u5efa\u7684\u63a5\u53e3\u52fe\u9009\uff0c\u4fdd\u5b58\u3002\u8fd9\u65f6\uff0c\u63a5\u53e3\u5c31\u53d1\u5e03\u6210\u529f\uff0c\u8bbf\u95ee\u8def\u5f84\u4e3aAPI/demo/add\u3002 Drupal 8\u4e2d\uff0cweb services\u7528\u63d2\u4ef6\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u5177\u4f53\u6b65\u9aa4\uff1a 1.\u4e0b\u8f7drest UI\u7b2c\u4e09\u65b9\u6a21\u5757\uff0c\u653e\u5165\u76f8\u5e94\u76ee\u5f55\uff0c\u8fdb\u5165\u540e\u53f0-\u300b\u6269\u5c55\uff0c\u52fe\u9009rest UI\u3001RESTful Web Services\u3001Serialization\u3001HAL\u3001HTTP Basic Authentication\uff0c\u4fdd\u5b58\u3002 2.\u65b0\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u53cd\u5e8f\u5217\u5316\u7c7b\u3002\u56e0\u4e3aDrupal 8 \u5728\u5904\u7406web service\u7684\u8bf7\u6c42\u65f6\uff0c\u9996\u5148\u5c06\u63a5\u6536\u7684\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3a\u67d0\u4e2a\u7c7b\uff0c\u7136\u540e\u5904\u7406\u6570\u636e\uff0c\u6700\u540e\u5c06\u8fd4\u56de\u503c\u5e8f\u5217\u5316\u4e3ajson\u6216\u8005xml\u7b49\u6570\u636e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u6240\u4ee5\u5fc5\u987b\u8981\u6709\u53cd\u5e8f\u5217\u5316\u548c\u5e8f\u5217\u5316\u7684\u7c7b\u3002\u4f46\u662fDrupal 8\u6838\u5fc3\u4e2d\u7684\u53cd\u5e8f\u5217\u5316\u7c7b\u53ea\u652f\u6301\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3aentity\uff0c\u8fd9\u6837\uff0c\u5bf9\u4e8e\u5199\u63a5\u53e3\u4f1a\u975e\u5e38\u4e0d\u4fbf\uff0c\u6bd4\u5982\uff0c\u67d0\u4e2aAPI\u4f20\u9012\u7684\u53c2\u6570\u53ef\u80fd\u5e76\u4e0d\u80fd\u548c\u67d0\u4e2aentity\u5bf9\u5e94\uff0c\u8fd9\u6837\u8fd9\u4e2a\u63a5\u53e3\u5c31\u6ca1\u6cd5\u5b9e\u73b0\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u7684\u7c7b\uff0c\u6bd4\u5982\u53ef\u4ee5\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3a\u6570\u7ec4\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * Contains \\Drupal\\demo\\Normalizer\\CustomNormalizer. */ namespace Drupal\\demo\\Normalizer ; class CustomNormalizer extends AbstractNormalizer { /** * {@inheritdoc} */ public function supportsNormalization ( $data , $format = null ) { return false ; } /** * {@inheritdoc} * */ public function normalize ( $object , $format = null , array $context = array ()) { return '' ; } /** * {@inheritdoc} */ public function supportsDenormalization ( $data , $type , $format = null ) { return $type == 'Array' ; } /** * {@inheritdoc} */ public function denormalize ( $data , $class , $format = null , array $context = array ()) { $array = ( array ) $data ; return $array ; } } \u5b9e\u73b0\u4e0a\u8ff0\u7c7b\u4e4b\u540e\uff0c\u6211\u4eec\u9700\u8981\u5c06\u8be5\u7c7b\u5b9a\u4e49\u4e3aservice\uff0c\u5728demo.services.yml\u4e2d\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a demo.normalizer.custom: class: Drupal\\demo\\Normalizer\\CustomNormalizer tags: - { name: normalizer } \u63a5\u4e0b\u6765\uff0c\u518d\u5b9e\u73b0\u63d2\u4ef6\uff0c\u63d2\u4ef6\u5176\u5b9e\u662f\u4e00\u4e2a\u7c7b\uff0c\u8be5\u7c7b\u7ee7\u627f\u81ea\u8be5\u79cd\u63d2\u4ef6\u7684\u57fa\u7c7b\uff0c\u5e76\u4e14\u9700\u8981\u7528\u6ce8\u89e3\u8868\u660e\u8be5\u7c7b\u7684\u63d2\u4ef6\u6027\u8d28\u3002 <?php /** * @file * Contains \\Drupal\\demo\\Plugin\\rest\\resource\\ExampleResource */ namespace Drupal\\demo\\Plugin\\rest\\resource ; use Drupal\\rest\\Plugin\\ResourceBase ; use Drupal\\rest\\ResourceResponse ; use Symfony\\Component\\HttpFoundation\\Request ; /** * Represents demo as resources. * * @RestResource( * id = \"demo\", * label = @Translation(\"Demo Resource\"), * serialization_class = \"Array\", * uri_paths = { * \"canonical\" = \"/API/demo\", * * } * ) * */ class ExampleResource extends ResourceBase { /** * Responds to GET requests. * * @param array $data * @param Symfony\\Component\\HttpFoundation\\Request $request * * @return \\Drupal\\rest\\ResourceResponse * The response containing the entity with its accessible fields. * */ public function get ( $data , Request $request ) { $logger = \\Drupal :: logger ( 'rest_get' ); $logger -> notice ( $request -> get ( 'sid' )); $return = array ( 'code' => 1 , 'message' => '\u8fd9\u662fget\u65b9\u6cd5' , ); $response = new ResourceResponse ( $return , 200 ); return $response ; } /** * Responds to POST requests. * * @param array $data * @param Symfony\\Component\\HttpFoundation\\Request $request * * @return \\Drupal\\rest\\ResourceResponse * The response containing the entity with its accessible fields. * */ public function post ( $data , Request $request ) { $logger = \\Drupal :: logger ( 'rest_post' ); $logger -> notice ( '<pre>' . print_r ( $data , TRUE ) . '</pre>' ); $return = array ( 'code' => 1 , 'message' => '\u8fd9\u662fpost\u65b9\u6cd5' , 'data' => $data ); $response = new ResourceResponse ( $return , 200 ); return $response ; } /** * Responds to DELETE requests. * * @param array $data * @param Symfony\\Component\\HttpFoundation\\Request $request * * @return \\Drupal\\rest\\ResourceResponse * The response containing the entity with its accessible fields. * */ public function delete ( $data , Request $request ) { $logger = \\Drupal :: logger ( 'rest_delete' ); $logger -> notice ( '<pre>' . print_r ( $data , TRUE ) . '</pre>' ); $return = array ( 'code' => 1 , 'message' => '\u8fd9\u662fdelete\u65b9\u6cd5' , 'data' => $data ); $response = new ResourceResponse ( $return , 200 ); return $response ; } } \u4e0b\u9762\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u4e0a\u8ff0\u4ee3\u7801\uff0c 1.@RestResource\u6ce8\u89e3\u8868\u793a\u8be5\u7c7b\u662fRestResource\u7c7b\u578b\u7684\u63d2\u4ef6\uff0c\u4e5f\u5c31\u662f\u8be5\u7c7b\u5b9e\u73b0rest web services\uff1b 2.\u6ce8\u89e3\u4e2d\u7684ID\u662f\u8be5\u63d2\u4ef6\u7684ID\uff0clabel\u662f\u63d2\u4ef6\u7684\u540d\u79f0\uff1b 3.serialization_class\u5c31\u662f\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u8bbe\u7f6e\u4e3a\u201cArray\u201d\uff0c\u5219\u4ee3\u7801\u4f1a\u81ea\u52a8\u8c03\u7528\u6211\u4eec\u7684\u81ea\u5b9a\u4e49\u7684\u53cd\u5e8f\u5217\u5316\u7c7b\u6765\u53cd\u5e8f\u5217\u5316\u6570\u636e\uff1b 4.\"canonical\" = \"/API/demo\"\u8868\u793aapi\u7684\u8def\u5f84\u662f/API/demo\uff1b\" https://www.drupal.org/link-relations/create \" = \"/API/demo\"\uff0c\u8868\u793aPOST\u65b9\u6cd5\u63d0\u4ea4\u65f6\u7684\u8def\u5f84\uff0c\u5f53\u7528POST\u65b9\u6cd5\u63d0\u4ea4\u65f6\uff0c\u4f1a\u8986\u76d6canonical\u6307\u5b9a\u8def\u5f84\u3002 \u8fd9\u4e2aweb services\u63d2\u4ef6\u5185\u90e8\u5b9e\u73b0\u4e86\u4e09\u4e2a\u65b9\u6cd5\uff0cget\u3001post\u3001delete\uff0c\u5206\u522b\u5bf9\u5e94\u4ee5get\u65b9\u6cd5\u3001post\u65b9\u6cd5\u548cdelete\u65b9\u6cd5\u63d0\u4ea4\u7684\u5904\u7406\u65b9\u6cd5\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5982\u679c\u6211\u4ee5get\u65b9\u6cd5\u8bbf\u95eeAPI/demo\uff0c\u5219\u8c03\u7528get\uff0c\u4ee5post\u65b9\u6cd5\u8bbf\u95eeAPI/demo\uff0c\u5219\u8c03\u7528post\uff0c\u4ee5delete\u65b9\u6cd5\u8bbf\u95eeAPI/demo\u5219\u8c03\u7528delete\u3002 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u7684\u4ee3\u7801\u5c31\u5168\u90e8\u5199\u5b8c\uff0c\u8981\u4f7f\u7528\u8be5API\uff0c\u9700\u8981\u8fdb\u5165\u540e\u53f0-\u300b\u914d\u7f6e-\u300brest\uff0c\u542f\u7528\u8fd9\u4e2aapi\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u542f\u7528get\u3001post\u548cdelete\u65b9\u6cd5\uff0c\u540c\u65f6\u9009\u62e9\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u6570\u636e\u683c\u5f0f\uff0c\u6bd4\u5982hal_json\u3001json\u3001xml\uff0c\u70b9\u51fb\u4fdd\u5b58\u540e\uff0c\u60a8\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8be5api\u4e86\u3002 7\u3001Drupal 8\u4e2d\u7684\u65b0\u589e\u673a\u5236 \u00b6 Drupal 8\u91c7\u7528\u4e86\u9762\u5411\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u81ea\u7136\u4e5f\u4f1a\u5f15\u5165\u5f88\u591a\u9762\u5411\u5bf9\u8c61\u7684\u65b0\u7279\u6027\uff0c\u6bd4\u5982\u4f9d\u8d56\u6ce8\u5165\u3001\u670d\u52a1\u5bb9\u5668\uff0c\u672c\u6587\u53ea\u662f\u63d0\u51fa\u8fd9\u4e9b\u65b0\u7279\u6027\uff0c\u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003\u76f8\u5e94\u7684\u6587\u7ae0\u3002 \u4f9d\u8d56\u6ce8\u5165\u548c\u670d\u52a1\u5bb9\u5668\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/15/Drupal8-Service-DependencyInjection/ \u6ce8\u89e3\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/12/Drupal8\u6ce8\u89e3-Annotations-\u8bed\u6cd5/ content entity\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/22/Drupal8-Content-Entity/ configuration entity\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/21/Drupal8-configuration-Entity/ \u53c2\u8003\u6587\u732e http://drupalchina.cn/node/3122 https://www.drupal.org/node/2216195 https://drupalize.me/blog/201409/unravelling-drupal-8-plugin-system http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/ http://drupalchina.cn/node/3353 https://dev.acquia.com/blog/introduction-restful-web-services-drupal-8","title":"\"Drupal8\u76f8\u5bf9Drupal7\u7684\u53d8\u5316\""},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#1","text":"Drupal 8\u5df2\u7ecf\u6b63\u5f0f\u53d1\u5e03\uff0c\u4e0eDrupal 7\u76f8\u6bd4\uff0cDrupal 8\u5728\u5b9e\u73b0\u673a\u5236\u4e0a\u53d1\u751f\u4e86\u6839\u672c\u6027\u7684\u6539\u53d8\u3002\u6700\u672c\u8d28\u7684\u6539\u53d8\uff0c\u5e94\u8be5\u5c31\u662f\u4ece\u4e3b\u8981\u4ee5\u9762\u5411\u8fc7\u7a0b\u7684\u7f16\u7801\u65b9\u5f0f\u8f6c\u4e3a\u4e86\u4e3b\u8981\u4ee5\u9762\u5411\u5bf9\u8c61\u7684\u7f16\u7801\u65b9\u5f0f\u3002\u867d\u7136Drupal 8\u4ecd\u7136\u4fdd\u7559\u4e86\u90e8\u5206\u9762\u5411\u8fc7\u7a0b\u7684\u6587\u4ef6\uff0c\u6bd4\u5982.module\u6587\u4ef6\uff0c\u4f46\u662f\u53ef\u4ee5\u9884\u89c1\uff0c\u5728Drupal 9\u4e2d\uff0c\u8fd9\u4e9b\u9762\u5411\u8fc7\u7a0b\u7684\u4ee3\u7801\u5c06\u88ab\u5168\u90e8\u79fb\u9664\uff0c\u6240\u4ee5\u5728\u4f7f\u7528Drupal 8\u505a\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u5c3d\u91cf\u907f\u514d\u5f15\u7528\u9762\u5411\u8fc7\u7a0b\u7684\u4ee3\u7801\uff0c\u4ee5\u514d\u4eceDrupal 8\u5347\u7ea7\u5230Drupal 9\u7684\u8fc7\u7a0b\u4e2d\u589e\u52a0\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\u3002 \u672c\u6587\u5c06\u4ece\u6a21\u5757\u5f00\u53d1\u7684\u89d2\u5ea6\uff08\u800c\u975e\u5176\u4ed6\u89d2\u5ea6\uff0c\u6bd4\u5982\u7f51\u7ad9\u7f16\u8f91\u3001\u6027\u80fd\u4f18\u52a3\u7b49\uff09\u8ba8\u8bbaDrupal 8 \u4e0eDrupal 7\u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u901a\u8fc7\u5bf9Drupal 8\u7684\u7814\u7a76\uff0c\u6211\u5c06Drupal 8\u6a21\u5757\u5f00\u53d1\u4e0eDrupal 7\u7684\u4e0d\u540c\u70b9\u6982\u62ec\u4e3a\u4ee5\u4e0b\u51e0\u70b9\uff1a \u76ee\u5f55\u7ed3\u6784\uff1b \u914d\u7f6e\u6587\u4ef6\uff1b \u8def\u7531\u65b9\u5f0f\uff1b \u4e3b\u9898\uff1b \u8868\u5355\uff1b \u94a9\u5b50\u673a\u5236\u5728Drupal 8\u4e2d\u7684\u53d8\u5316\u53ca\u5b9e\u73b0\uff1b Drupal 8\u4e2d\u7684\u65b0\u589e\u673a\u5236\u3002 \u4e0b\u9762\u5c06\u8be6\u7ec6\u8bba\u8ff0\u8fd9\u4e9b\u4e0d\u540c\u70b9\u3002","title":"1\u3001\u6982\u8ff0"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#2","text":"Drupal 7\u7684\u76ee\u5f55\u7ed3\u6784\u4e3a\uff1a |-includes |-misc |-modules |-scripts |-sites | |-all | | |-modules | | |-themes | |-default |-themes Drupal 8\u7684\u76ee\u5f55\u7ed3\u6784\u4e3a\uff1a |-core | |-assets | |-config | |-includes | |-lib | |-misc | |-modules | |-profiles | |-scripts | |-themes |-modules |-sites | |-default |-themes |-vendor \u53ef\u4ee5\u770b\u51fa\uff0cDrupal 8\u4e0eDrupal 7\u7684\u76ee\u5f55\u7ed3\u6784\u5927\u4e0d\u76f8\u540c\uff0c\u5728Drupal7\u4e2d\u6838\u5fc3\u7684\u4ee3\u7801\u90fd\u76f4\u63a5\u653e\u5728\u6839\u76ee\u5f55\u4e0b\uff0c\u6bd4\u5982includes\u7b49\uff0c\u6838\u5fc3\u6a21\u5757\u653e\u5728\u6839\u76ee\u5f55\u4e0b\u7684modules\u76ee\u5f55\u4e0b\uff0c\u6838\u5fc3\u4e3b\u9898\u653e\u5728\u6839\u76ee\u5f55\u4e0b\u7684themes\u76ee\u5f55\u4e0b\u3002\u7528\u6237\u81ea\u5b9a\u4e49\u6216\u8005\u7b2c\u4e09\u65b9\u7684\u6a21\u5757\u653e\u5728sites\\all\\modules\u3001\u4e3b\u9898\u653e\u5728sites\\all\\themes\u76ee\u5f55\u4e0b\u3002 \u800c\u5728Drupal 8\u91cc\u9762\uff0c\u6838\u5fc3\u7684\u4e1c\u897f\u90fd\u88ab\u79fb\u5230\u6839\u76ee\u5f55\u4e0b\u7684core\u76ee\u5f55\u4e0b\uff0c\u539f\u6765\u7528\u6765\u653e\u6838\u5fc3\u6a21\u5757\u548c\u4e3b\u9898\u7684modules\u3001themes\u76ee\u5f55\u5206\u522b\u7528\u6765\u653e\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u6a21\u5757\u548c\u4e3b\u9898\u3002\u6309\u7167\u7ea6\u5b9a\u4fd7\u79f0\u7684\u89c4\u5219\uff0c\u4e00\u822c\u5728modules\u76ee\u5f55\u4e0b\u65b0\u5efacontrib\u548ccustom\u76ee\u5f55\uff0c\u5206\u522b\u7528\u6765\u653e\u8d21\u732e\u548c\u81ea\u5b9a\u4e49\u6a21\u5757\u3002","title":"2\u3001\u76ee\u5f55\u7ed3\u6784"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#2_1","text":"\u5728Drupal\u6a21\u5757\u5f00\u53d1\u4e2d\uff0c\u5f88\u591a\u529f\u80fd\u7684\u5b9e\u73b0\u90fd\u8981\u9760\u914d\u7f6e\u6587\u4ef6\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\u6a21\u5757\u7684\u57fa\u672c\u4fe1\u606f\u5728Drupal 7\u4e2d\u5c31\u5fc5\u987b\u914d\u7f6e\u5728*.info\u6587\u4ef6\u4e2d\u3002\u5728Drupal 8\u4e2d\uff0c\u914d\u7f6e\u6587\u4ef6\u7684\u4f7f\u7528\u5f97\u5230\u4e86\u8fdb\u4e00\u6b65\u7684\u6269\u5145\uff0c\u53ef\u4ee5\u8bf4\uff0cDrupal 8\u7684\u51e0\u4e4e\u6240\u6709\u529f\u80fd\u90fd\u79bb\u4e0d\u5f00\u914d\u7f6e\u6587\u4ef6\u3002 \u4f46\u662f\u540c\u65f6\u914d\u7f6e\u6587\u4ef6\u7684\u683c\u5f0f\u4e5f\u4e0eDrupal 7\u6709\u6240\u4e0d\u540c\u3002Drupal 7\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u4e3b\u8981\u662f.info\u6587\u4ef6\uff0c.info\u6587\u4ef6\u91c7\u7528\u4f7f\u7528\u7b49\u53f7\u9694\u5f00\u7684\u952e\u503c\u5bf9\u7684\u5f62\u5f0f\u914d\u7f6e\u4fe1\u606f\uff0c\u4f8b\u5982\u6a21\u5757\u4fe1\u606f\u7684\u914d\u7f6e\u6587\u4ef6demo.info\uff1a core = \"7.x\" description = \"Demo Module\" dependencies[] = system name = \"demo\" package = \"demo\" version = \"7.x-1.0\" Drupal 8\u4e2d\u914d\u7f6e\u6587\u4ef6\u5e7f\u6cdb\u4f7f\u7528yaml\u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u6a21\u5757\u4fe1\u606f\u7684\u914d\u7f6e\u6587\u4ef6demo.info.yml: name: demo type: module description: \"demo module\" package: demo core: 8.x dependencies: - rest \u5bf9\u6bd4Drupal 7\u548cDrupal 8\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u96be\u770b\u51fa\uff0c\u91cc\u9762\u7684\u5185\u5bb9\u57fa\u672c\u4e00\u81f4\uff0c\u6240\u4e0d\u540c\u7684\u53ea\u662f\u6587\u4ef6\u683c\u5f0f\u7684\u4e0d\u540c\u3002\u9700\u8981\u6ce8\u610f\u7684\u662fDrupal 8\u7684\u914d\u7f6e\u6587\u4ef6\u540e\u7f00\u540d\u90fd\u662f.yml\uff0c\u8868\u660e\u8fd9\u662f\u4e00\u4e2ayaml\u6587\u4ef6\u3002Drupal 8\u7684\u6a21\u5757\u914d\u7f6e\u4fe1\u606f\u6bd4Drupal 7\u7684\u591a\u4e00\u9879type: module\uff0c\u8fd9\u662f\u56e0\u4e3aDrupal 8\u7684\u4e3b\u9898\u4e5f\u662f\u7528\u540c\u6837\u683c\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3a\u4e86\u533a\u5206\u8fd9\u662f\u4e00\u4e2a\u4e3b\u9898\u8fd8\u662f\u6a21\u5757\uff0c\u8be5\u9879\u662f\u5fc5\u987b\u7684\u3002 Drupal 8 \u4e0d\u4ec5\u9700\u8981\u6a21\u5757\u4fe1\u606f\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd8\u9700\u8981\u5404\u79cd\u5176\u4ed6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982\u540e\u9762\u5c06\u8981\u8bb2\u5230\u7684\u8def\u7531\u914d\u7f6e\u6587\u4ef6*.routing.yml\u3001\u670d\u52a1\u914d\u7f6e\u6587\u4ef6*.services.yml\u7b49\u3002","title":"2\u3001\u914d\u7f6e\u6587\u4ef6"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#3","text":"Drupal 7\u548cDrupal 8\u7684\u8def\u7531\u4e5f\u5b58\u5728\u5f88\u5927\u7684\u533a\u522b\u3002Drupal 7 \u4f7f\u7528Hook\u7684\u65b9\u5f0f\uff0c\u800cDrupal 8\u4f7f\u7528Symfony\u6846\u67b6\u7684\u8def\u7531\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u3002\u672c\u6587\u53ea\u8ba8\u8bbaDrupal 8\u548cDrupal 7 \u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003 http://verynull.com/2015/12/23/Drupal8-routing/ \u548c http://verynull.com/2015/12/23/Drupal8-Controller/ Drupal 7\u9700\u8981\u5728module_name.module\u4e2d\u5b9e\u73b0hook_menu\u94a9\u5b50\u6765\u5c06\u67d0\u4e2aurl\u548c\u8bf7\u6c42\u5904\u7406\u65b9\u6cd5\u5173\u8054\u8d77\u6765\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function demo_menu() { $items = array(); $items['demo'] = array( 'title' => '\u793a\u4f8b', 'page callback' => 'theme', 'page arguments' => array('demo'), 'access callback' => 'user_is_logged_in', 'type' => MENU_CALLBACK ); return $items; } \u4e0a\u8ff0\u4ee3\u7801\u8868\u793a\uff0c\u5f53\u7528\u6237\u8bbf\u95ee/demo\u8def\u5f84\u65f6\u3002\u8c03\u7528theme\u65b9\u6cd5\u6e32\u67d3demo\u4e3b\u9898\uff0c\u4e3b\u9898\u9700\u8981\u5728hook_theme\u4e2d\u6ce8\u518c\uff0c\u8fd9\u4e00\u70b9Drupal 8\u6ca1\u6709\u53d8\u5316\u3002 \u5b9e\u73b0\u540c\u6837\u7684\u529f\u80fd\uff0cDrupal 8 \u9996\u5148\u9700\u8981\u914d\u7f6emodule_name.routing.yml\uff0c\u5c06\u8def\u5f84\u548c\u63a7\u5236\u5668\u4e2d\u7684\u67d0\u4e2aaction\u5173\u8054\u8d77\u6765\uff0c\u7136\u540e\u7f16\u5199\u63a7\u5236\u5668\uff0c\u5b9e\u73b0\u91cc\u9762\u7684action\u3002\u8fd9\u91cc\u9700\u8981\u63d0\u5230\u4e00\u4e2a\u6982\u5ff5MVC\uff0cMVC\u5168\u540d\u662fModel View Controller\uff0c\u662f\u6a21\u578b(model)\uff0d\u89c6\u56fe(view)\uff0d\u63a7\u5236\u5668(controller)\u7684\u7f29\u5199\uff0c\u4e00\u79cd\u8f6f\u4ef6\u8bbe\u8ba1\u5178\u8303\uff0c\u7528\u4e00\u79cd\u4e1a\u52a1\u903b\u8f91\u3001\u6570\u636e\u3001\u754c\u9762\u663e\u793a\u5206\u79bb\u7684\u65b9\u6cd5\u7ec4\u7ec7\u4ee3\u7801\u3002Drupal 8\u91cc\u9762\u7684\u63a7\u5236\u5668\u5c31\u662fMVC\u4e2dcontroller\uff0c\u7528\u4e8e\u8854\u63a5\u754c\u9762\uff08view\uff09\u548c\u6570\u636e\uff08model\uff09\uff0c\u5373\u5728\u63a7\u5236\u5668\u91cc\u9762\uff0c\u63a5\u6536\u53c2\u6570\uff0c\u7136\u540e\u8bfb\u53d6\u6570\u636e\uff0c\u4f20\u9012\u7ed9\u754c\u9762\uff0c\u6700\u540e\u8fd4\u56de\u7ed9\u7ec8\u7aef\u7528\u6237\u3002 example.rounting.yml\u683c\u5f0f\u5982\u4e0b\uff1a example.demo: path: '/demo/{name}' defaults: _controller: '\\Drupal\\example\\Controller\\ExampleController::demo' _title: 'test drupal 8 routing' requirements: _permission: 'access content' example.demo\u4e3a\u8def\u7531\u7684\u673a\u8bfb\u540d\u79f0\uff0c\u683c\u5f0f\u4e3a\"\u6a21\u5757\u540d.\u8def\u7531\"\uff0cpath\u662f\u5b9e\u9645\u7684url\u8def\u5f84\uff0c\u5176\u4e2d{name}\uff0c\u8868\u793a\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u4f1a\u4f20\u9012\u7ed9action\uff0c\u53c2\u6570\u540d\u79f0\u5c31\u662fname\u3002 defaults\u4e0b\u6709\u7684_controller: '\\Drupal\\example\\Controller\\ExampleController::demo'\u8868\u793a\u63a7\u5236\u5668\u4e3a\\Drupal\\example\\Controller\\ExampleController\uff0caction\u4e3ademo\u65b9\u6cd5\u3002 defaults\u4e0b\u7684_title: 'test drupal 8 routing'\u8868\u793a\u9875\u9762\u6807\u9898\u4e3a\uff1atest drupal 8 routing\u3002 requirements\u4e0b\u7684_permission\u8868\u793a\u53ef\u4ee5\u8bbf\u95ee\u8be5\u8def\u5f84\u7684\u6743\u9650\u3002 ExampleController\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * Contains ExampleController */ namespace Drupal\\example\\Controller ; use Drupal\\Core\\Controller\\ControllerBase ; /** * Provides route responses for example.module. */ class ExampleController extends ControllerBase { /** * \u5c55\u793ahello {name}. * @param $name * * @return array * */ public function demo ( $name ) { return array ( '#markup' => t ( 'Hello ' . $name ), ); } } \u5f53\u5b8c\u6210\u4e0a\u8ff0\u4ee3\u7801\u540e\uff0c\u6e05\u9664\u7f13\u5b58\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eehttp://yourdomain/demo/World\uff0c\u754c\u9762\u5c31\u4f1a\u663e\u793aHello World\u3002example.info.yml\u3001example.routing.yml\u548cExampleController\u5c31\u6784\u6210\u4e86Drupal 8\u4e2d\u7684\u4e00\u4e2a\u6700\u57fa\u672c\u6a21\u5757\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e09\u7c7b\u6587\u4ef6\u662f\u5fc5\u987b\u7684\u3002","title":"3\u3001\u8def\u7531\u65b9\u5f0f"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#4","text":"Drupal 8\u548cDrupal 7\u76f8\u6bd4\uff0c\u4e3b\u9898\u4e0a\u4e5f\u53d1\u751f\u4e86\u672c\u8d28\u7684\u53d8\u5316\uff0c\u9996\u5148\u662f\u4e3b\u9898\u5f15\u64ce\u7684\u53d8\u5316\uff0c\u5176\u6b21\u662f\u914d\u7f6e\u65b9\u5f0f\u7684\u53d8\u5316\uff0c\u6700\u540e\u662fjs\u3001css\u5f15\u5165\u65b9\u5f0f\u7684\u53d8\u5316\u3002\u672c\u6587\u53ea\u8ba8\u8bbaDrupal 8 \u4e0eDrupal 7\u4e3b\u9898\u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u4e3b\u9898\u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003 http://verynull.com/2015/11/19/Drupal8\u4e3b\u9898-theme/ \u548c http://verynull.com/2015/11/18/Drupal8\u6a21\u677f\u5f15\u64ce-twig/ \u3002","title":"4\u3001\u4e3b\u9898"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#41","text":"Drupal 7\u4f7f\u7528\u7684\u6a21\u677f\u5f15\u64ce\u662fPHPTemplate\uff0c\u8be5\u6a21\u677f\u5f15\u64ce\u7684\u7279\u70b9\u662f\u6a21\u677f\u91cc\u9762\u53ef\u4ee5\u5199php\u4ee3\u7801\u3002\u8fd9\u79cd\u6a21\u677f\u7684\u7f3a\u70b9\u663e\u800c\u6613\u89c1\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751fXSS\u548cSQL\u6ce8\u5165\u7b49\u653b\u51fb\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a <?php echo $name ; ?> \u5982\u679c$name = '<script>js\u8bed\u53e5</script>'\uff0c\u8fd9\u6837\u8f93\u51fa\u5230\u9875\u9762\u4e2d\u5c31\u4f1a\u6267\u884cscript\u6807\u7b7e\u4e2d\u7684js\u4ee3\u7801\uff0c\u8fd9\u6837\u5c31\u4f1a\u88ab\u9ed1\u5ba2\u5229\u7528\u6765\u653b\u51fb\u7f51\u7ad9\u3002 \u800cDrupal 8\u5219\u4f7f\u7528twig\u6a21\u677f\u5f15\u64ce\uff0ctwig\u6a21\u677f\u76f8\u5bf9\u4e8ePHPTemplate\u5f15\u64ce\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u6709\u70b9\uff1a \u5feb\u901f\uff1aTwig\u628a\u6a21\u677f\u7f16\u8bd1\u6210\u4e3a\u4f18\u5316\u540e\u7684PHP\u4ee3\u7801\u3002\u76f8\u5bf9\u666e\u901aPHP\u4ee3\u7801\u6765\u8bf4\uff0c\u5176\u989d\u5916\u5f00\u9500\u975e\u5e38\u8f7b\u5fae\u3002 \u5b89\u5168\uff1aTwig\u4f1a\u4f7f\u7528\u4e00\u4e2a\u6c99\u7bb1\u6a21\u5f0f\u6765\u8fd0\u884c\u4e0d\u4fe1\u4efb\u7684\u6a21\u677f\u4ee3\u7801\u3002\u8fd9\u4f7f\u5f97Twig\u53ef\u4ee5\u5728\u7528\u6237\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u8bbe\u8ba1\u7684\u5e94\u7528\u4e2d\u5de5\u4f5c\u826f\u597d\u3002 \u5f39\u6027\uff1aTwig\u8bd5\u7528\u4e86\u5f39\u6027\u7684\u8bcd\u6cd5\u548c\u8bed\u6cd5\u5206\u6790\u5668\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u5b9a\u4e49\u81ea\u5df1\u7684\u6807\u8bb0\u548c\u8fc7\u6ee4\uff0c\u5e76\u521b\u5efa\u81ea\u5df1\u7684DSL\u3002 \u53ef\u4ee5\u770b\u51fa\uff0ctwig\u91cc\u9762\u4e0d\u80fd\u5199php\u4ee3\u7801\uff0c\u4ed6\u6709\u4e00\u5957\u81ea\u5df1\u7684\u8bed\u6cd5\uff0c\u5e76\u4e14\u6700\u7ec8\u88ab\u7f16\u8bd1\u4e3aphp\uff0c\u8fd0\u884c\u5728\u5b89\u5168\u6c99\u7bb1\u4e2d\uff0c\u4e00\u53e5\u8bdd\uff0c\u5c31\u662f\u5b89\u5168\u3002\u50cf\u4e0a\u9762\u7684\u8f93\u51fa\u53d8\u91cf\uff0c\u5728twig\u4e2d\u5982\u4e0b\uff1a {{ name }} \u8fd9\u6837\u4f1a\u81ea\u52a8\u628a\u4e0d\u5b89\u5168\u7684\u5b57\u7b26\u8fc7\u6ee4\u6389\u3002\u4e0b\u9762\u6765\u6bd4\u8f83PHPTemplate\u548ctwig\u7684\u5178\u578b\u7684\u4e0d\u540c\u4e4b\u5904\u3002 1.\u540e\u7f00\u540d PHPTemplate\u7684\u540e\u7f00\u540d\u662f.tpl.php\uff0ctwig\u7684\u540e\u7f00\u540d\u4e3a.html.twig. 2.\u53d8\u91cf \u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf PHPTemplate: <div class=\"content\"> <?php print $content ; ?> </div> Twig: <div class=\"content\">{{ content }}</div> \u8f93\u51fa\u4e00\u4e2a\u54c8\u5e0c\u952e\u503c PHPTemplate: <?php print $item [ '#item' ][ 'alt' ]; ?> Twig: {{ item['#item'].alt }} \u53d8\u91cf\u8d4b\u503c PHPTemplate: <?php $custom_var = $content -> comments ; ?> Twig: {% set custom_var = content.comments %} \u6570\u7ec4\u521d\u59cb\u5316 PHPTemplate: <?php $args = array ( '!author' => $author , '!date' => $created ); ?> Twig: {% set args = {'!author': author, '!date': created} 3.\u6761\u4ef6\u5224\u65ad PHPTemplate: <?php if ( $content -> comments ) : endif ; ?> Twig: {% if content.comments %} {% endif %} PHPTemplate: <?php if ( ! empty ( $content -> comments )) : endif ; ?> Twig: {% if content.comments is not empty %} {% endif %} PHPTemplate: <?php if ( isset ( $content -> comments )) : endif ; ?> Twig: {% if content.comments is defined %} {% endif %} PHPTemplate: <?php if ( $count > 0 ) : endif ; ?> Twig: {% if count > 0 %} {% endif %} 4.\u63a7\u5236\u7ed3\u6784 PHPTemplate: <?php foreach ( $users as $user ) {} ?> Twig: {% for user in users %} {% endfor %} 5.\u8fc7\u6ee4 check_plain\uff1a PHPTemplate: <?php print check_plain ( $title ); ?> Twig: {{ title|striptags }} Translate\uff1a PHPTemplate: <?php print t ( 'Home' ); ?> Twig: {{ 'Home'|t }} \u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003\u4e0a\u8ff0\u6587\u7ae0\u3002","title":"4.1\u3001\u6a21\u677f\u5f15\u64ce\u7684\u53d8\u5316"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#42","text":"Drupal 7\u7684\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6bartik.info\u683c\u5f0f\u5982\u4e0b\uff1a name = Bartik description = A flexible, recolorable theme with many regions. package = Core version = VERSION core = 7.x stylesheets[all][] = css/layout.css stylesheets[all][] = css/style.css stylesheets[all][] = css/colors.css stylesheets[print][] = css/print.css regions[header] = Header regions[help] = Help regions[page_top] = Page top regions[page_bottom] = Page bottom regions[highlighted] = Highlighted regions[featured] = Featured regions[content] = Content regions[sidebar_first] = Sidebar first regions[sidebar_second] = Sidebar second regions[triptych_first] = Triptych first regions[triptych_middle] = Triptych middle regions[triptych_last] = Triptych last regions[footer_firstcolumn] = Footer first column regions[footer_secondcolumn] = Footer second column regions[footer_thirdcolumn] = Footer third column regions[footer_fourthcolumn] = Footer fourth column regions[footer] = Footer settings[shortcut_module_link] = 0 \u672c\u6587\u7b2c\u4e8c\u7ae0\u8282\u5df2\u7ecf\u63d0\u5230\uff0cDrupal 8 \u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u662f\u7528yaml\u6587\u4ef6\uff0cbartik.info.yml\uff1a name: Bartik type: theme base theme: classy description: 'A flexible, recolorable theme with many regions and a responsive, mobile-first layout.' package: Core # version: VERSION # core: 8.x libraries: - bartik/global-styling ckeditor_stylesheets: - css/base/elements.css - css/components/captions.css - css/components/table.css regions: header: Header primary_menu: 'Primary menu' secondary_menu: 'Secondary menu' page_top: 'Page top' page_bottom: 'Page bottom' highlighted: Highlighted featured_top: 'Featured top' breadcrumb: Breadcrumb content: Content sidebar_first: 'Sidebar first' sidebar_second: 'Sidebar second' featured_bottom_first: 'Featured bottom first' featured_bottom_second: 'Featured bottom second' featured_bottom_third: 'Featured bottom third' footer_first: 'Footer first' footer_second: 'Footer second' footer_third: 'Footer third' footer_fourth: 'Footer fourth' footer_fifth: 'Footer fifth' \u4ece\u4ee5\u4e0a\u53ef\u4ee5\u770b\u51fa\uff0cDrupal 7 \u548cDrupal 8 \u7684\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u5927\u81f4\u76f8\u540c\uff0c\u53ea\u662f\u683c\u5f0f\u4e0d\u4e00\u81f4\uff0c\u4e3b\u8981\u7684\u4e0d\u540c\u6709\u4e24\u70b9\uff1a 1.Drupal 8\u7684\u914d\u7f6e\u6587\u4ef6\u591a\u4e86type: theme\uff0c\u8fd9\u662f\u7528\u6765\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u4e3b\u9898\uff0c\u800c\u4e0d\u662f\u6a21\u5757\u3002 2.js\u3001css\u7684\u5168\u5c40\u5f15\u5165\uff0cDrupal 7\u53ef\u4ee5\u76f4\u63a5\u5f15\u5165\u5355\u4e2ajs\u3001css\u6587\u4ef6\uff0c\u800cDrupal 8\u9700\u8981\u5148\u5c06css\u3001js\u8bbe\u7f6e\u6210library\uff0c\u7136\u540e\u5728\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f15\u5165library\uff0c\u5982\u4e0a\u4f8b\u4e2d\u7684\uff1a libraries: - bartik/global-styling \u8868\u793a\u5f15\u5165bartik\u4e3b\u9898\u4e0b\u7684global-styling\u5e93\u3002library\u5e93\u662f\u5728theme_name.libraries.yml\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\uff0cbartik.libraries.yml\u7684\u90e8\u5206\u4ee3\u7801\u5982\u4e0b: color.preview: version: VERSION css: theme: color/preview.css: {} js: color/preview.js: {} dependencies: - color/drupal.color maintenance_page: version: VERSION css: theme: css/maintenance-page.css: {} dependencies: - system/maintenance - bartik/global-styling \u5176\u4e2dcolor.preview\u3001maintenance_page\u5c31\u8868\u793a\u4e00\u4e2alibrary\uff0c\u6bcf\u4e2alibrary\u4e0b\u53ef\u4ee5\u6709css\u3001js\u3001dependencies\u7b49\u952e\uff0c\u5206\u522b\u8868\u793a\u5f15\u5165css\u3001\u5f15\u5165js\u548c\u5f15\u5165\u4f9d\u8d56\u7684\u5e93\u3002","title":"4.2\u3001\u4e3b\u9898\u914d\u7f6e"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#43jscss","text":"\u57284.2\u8282\u4e2d\u5df2\u7ecf\u63d0\u5230\uff0cDrupal 8\u4e2d\u5f15\u5165js\u548ccss\u5fc5\u987b\u4f7f\u7528library\uff0c\u4e0d\u80fd\u5355\u72ec\u5f15\u5165\u5355\u4e2ajs\u6216css\u6587\u4ef6\u3002\u5728\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f15\u5165\u5168\u5c40\u7684\u5e93\u4e5f\u5df2\u7ecf\u57284.2\u8282\u4e2d\u9610\u8ff0\uff0c\u90a3\u5728\u5355\u4e2a\u9875\u9762\u4e2d\u5f15\u5165js\u548ccss\u6709\u4f55\u4e0d\u540c\u5462\uff1f \u6211\u4eec\u5728Drupal 7\u4e2d\u901a\u5e38\u901a\u8fc7drupal_add_js\u548cdrupal_add_css\u6765\u5f15\u5165js\u548ccss\uff0c\u4f8b\u5982\uff1a drupal_add_js(drupal_get_path('module', 'demo') . '/js/demo.js'); drupal_add_css(drupal_get_path('module', 'demo') . '/css/demo.css'); \u5728Drupal 8\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u5c06js\u3001css\u914d\u7f6e\u6210\u5e93\uff0c\u5982demo.libraries.yml: base: version: VERSION css: theme: css/demo.css: {} js: js/demo.js: {} dependencies: - core/jquery \u4e0a\u9762\u914d\u7f6e\u4e86\u4e00\u4e2abase\u5e93\uff0cDrupal 8\u4e2d\u9664\u4e86\u8981\u914d\u7f6e\u5e93\uff0c\u8fd8\u8981\u5728\u6e32\u67d3\u6570\u7ec4\u4e2d\u4f7f\u7528#attached\u624d\u80fd\u5c06\u5e93\u52a0\u5230\u9875\u9762\u4e2d\uff1a return array( '#theme' => 'example_demo', '#attached' => array( 'library' => array( 'example/base' ) ) ); \u4e0a\u8ff0\u4ee3\u7801\u8868\u793a\uff0c\u6e32\u67d3example_demo\u4e3b\u9898\uff0c\u5e76\u4e14\u52a0\u8f7dexample/base'\u5e93\u3002","title":"4.3\u3001\u5f15\u5165js\u3001css"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#5","text":"\u6211\u4eec\u5c06\u4ee5\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u6765\u5206\u6790Drupal 7\u548cDrupal 8\u8868\u5355\u7684\u5f02\u540c\u3002 \u5728Drupal 7\u4e2d\u8981\u5b9e\u73b0\u8868\u5355\u7684\u5c55\u793a\u3001\u63d0\u4ea4\uff0c\u9996\u5148\u9700\u8981\u914d\u7f6e\u83dc\u5355\uff0c\u5c06\u8def\u5f84\u548c\u8868\u5355\u51fd\u6570\u5173\u8054\u8d77\u6765\u5728hook_menu\u4e2d\u5b9a\u4e49\u5982\u4e0b\u83dc\u5355\uff1a $items['demo/form'] = array( 'title' => 'Create demo form', 'page callback' => 'drupal_get_form', 'page arguments' => array('demo_form'), 'access callback' => 'access content', 'type' => MENU_LOCAL_TASK, ); \u63a5\u4e0b\u6765\uff0c\u5b9a\u4e49\u8868\u5355\u51fd\u6570demo_form\uff1a function demo_form($form, &$form_state) { $form['name'] = array( '#type' => 'textfield', '#title' => '\u59d3\u540d' ); $form['actions']['#type'] = 'actions'; $form['actions']['submit'] = array( '#type' => 'submit', '#value' => $this->t('Save'), '#button_type' => 'primary', ); $form['#validate'][] = 'demo_validate'; $form['#submit'][] = 'demo_submit'; return $form; } \u4e0a\u8ff0\u4ee3\u7801\u8868\u660e\u8868\u5355\u6709\u4e00\u4e2a\u6587\u672c\u6846\uff0c\u4e00\u4e2a\u63d0\u4ea4\u6309\u94ae\uff0c\u8868\u5355\u7684\u9a8c\u8bc1\u51fd\u6570\u4e66demo_validate\uff0c\u63d0\u4ea4\u5904\u7406\u51fd\u6570\u662fdemo_submit\u3002 \u4e0b\u9762\u5b9e\u73b0demo_validate\u3001demo_submit\uff1a function demo_validate($form, &$form_state) { $name = $form_state['value']['name']; if($name != 'world') { form_set_error('name', '\u53c2\u6570\u9519\u8bef'); } } function demo_submit($form, &$form_state) { $name = $form_state['value']['name']; drupal_set_message('Hello' . $name); } \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbf\u95eedemo/form\u4e86\uff0c\u5728\u6587\u672c\u6846\u4e2d\u8f93\u5165world\uff0c\u5219\u754c\u9762\u5c31\u4f1a\u663e\u793aHello world\uff0c\u4f46\u662f\u8f93\u5165\u5176\u4ed6\u7684\u6587\u672c\uff0c\u5219\u4f1a\u62a5\u9519\u201c\u53c2\u6570\u9519\u8bef\u201d\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0bDrupal 8\u4e2d\u7684\u8868\u5355\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u9996\u5148\u6211\u4eec\u8981\u914d\u7f6e\u4e00\u4e2a\u8def\u7531\u6307\u5411\u8868\u5355\uff0c example.demo_form: path: '/demo/form' defaults: _form: '\\Drupal\\example\\Form\\ExampleForm' _title: 'test drupal 8 form' requirements: _permission: 'access content' path\uff1a'/demo/form'\u8868\u793a\u8868\u5355\u8def\u5f84\u662f/demo/form\uff0c_form: '\\Drupal\\example\\Form\\ExampleForm'\u8868\u793a\u8868\u5355\u7c7b\u662f\\Drupal\\example\\Form\\ExampleForm\uff0c\u90a3\u4e48\u4e0b\u9762\u5c31\u6765\u5b9e\u73b0\u8fd9\u4e2a\u7c7b\uff1a <?php /** * @file * contains Drupal\\example\\Form\\ExampleForm */ namespace Drupal\\example\\Form ; use Drupal\\Core\\Form\\FormBase ; use Drupal\\Core\\Form\\FormStateInterface ; class ExampleForm extends FormBase { /** * @inheritdoc */ public function getFormId () { return 'example_form' ; } /** * @inheritdoc */ public function buildForm ( array $form , FormStateInterface $form_state ) { $form [ 'name' ] = array ( '#type' => 'textfield' , '#title' => '\u59d3\u540d' ); $form [ 'actions' ][ '#type' ] = 'actions' ; $form [ 'actions' ][ 'submit' ] = array ( '#type' => 'submit' , '#value' => $this -> t ( 'Save' ), '#button_type' => 'primary' , ); return $form ; } /** * @inheritdoc */ public function validateForm ( array & $form , FormStateInterface $form_state ) { parent :: validateForm ( $form , $form_state ); if ( $form_state -> getValue ( 'name' ) != 'world' ) { $a = array ( 'name' ); $form_state -> setErrorByName ( 'name' , '\u53c2\u6570\u9519\u8bef' ); } } /** * @inheritdoc */ public function submitForm ( array & $form , FormStateInterface $form_state ) { $name = $form_state -> getValue ( 'name' ); drupal_set_message ( 'Hello' . $name ); } } \u53ef\u89c1\uff0cDrupal 8\u4e2d\u7684\u8868\u5355\u5c31\u662f\u4e00\u4e2a\u7c7b\uff0c\u7ee7\u627f\u81eaformBase\uff0c\u9700\u8981\u8986\u5199\u7236\u7c7b\u7684\u56db\u4e2a\u65b9\u6cd5\uff1agetFormId\u3001buildForm\u3001validateForm\u548csubmitForm\u3002 1.getFormId \u8fd4\u56de\u8868\u5355ID\uff0c\u5bf9\u5e94\u4e8eDrupal 7\u4e2d\u7684\u8868\u5355\u7684\u65b9\u6cd5\u540d\uff1b 2.buildForm \u6784\u9020\u5e76\u8fd4\u56de\u8868\u5355\uff0c\u5bf9\u5e94\u4e8eDrupal 7\u4e2d\u7684\u8868\u5355\u51fd\u6570\u3002 3.validateForm \u8868\u5355\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u5bf9\u5e94\u4e8eDrupal 7\u4e2d\u7684$form['#validate'][] = 'demo_validate'\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5 4.submitForm \u8868\u5355\u63d0\u4ea4\u5904\u7406\u65b9\u6cd5\uff0c\u5bf9\u5e94\u4e8eDrupal 7 \u4e2d$form['#submit'][] = 'demo_submit'\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u3002 \u901a\u8fc7\u5bf9\u6bd4\u53ef\u4ee5\u53d1\u73b0\uff0cDrupal 8\u5c06\u8868\u5355\u7684\u5404\u4e2a\u5143\u7d20\u7ec4\u7ec7\u5728\u4e00\u4e2a\u7c7b\u91cc\u9762\uff0c\u7ed3\u6784\u6e05\u6670\uff0c\u903b\u8f91\u5206\u660e\uff0c\u76f8\u5bf9\u4e8eDrupal 7\u677e\u6563\u7684\u4ee3\u7801\u662f\u5f88\u5927\u7684\u8fdb\u6b65\u3002","title":"5\u3001\u8868\u5355"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#6drupal-8","text":"\u94a9\u5b50\u673a\u5236\u5728Drupal 7\u4e2d\u8d77\u7740\u4e3e\u8db3\u8f7b\u91cd\u7684\u4f5c\u7528\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\u4e24\u4e2a\u65b9\u9762\uff1a \u4e00\u662finfo\u7c7b\u7684\u94a9\u5b50\uff0c\u4f8b\u5982hook_menu\u3001hook_theme\u3001hook_services_resources\u7b49\uff0c\u8d77\u5230\u5173\u8054\u4fe1\u606f\u7684\u4f5c\u7528\uff0c\u6bd4\u5982hook_menu\u544a\u8bc9\u7cfb\u7edfURL\u8def\u5f84\u548c\u5904\u7406\u65b9\u6cd5\u7684\u5bf9\u5e94\u5173\u7cfb\u4ee5\u4fbf\u7528\u6237\u8bbf\u95ee\u67d0\u4e2a\u8def\u5f84\u7684\u65f6\u5019\u627e\u5230\u6b63\u786e\u7684\u51fd\u6570\u6765\u5904\u7406\uff1b \u4e8c\u662f\u8c03\u7528\u7c7b\u94a9\u5b50\uff0c\u4f8b\u5982hook_user_delete\u7b49\uff0c\u8c03\u7528\u7c7b\u94a9\u5b50\u7684\u4f5c\u7528\u662f\u7cfb\u7edf\u5728\u505a\u4e86\u67d0\u4e2a\u64cd\u4f5c\u4e4b\u540e\u901a\u8fc7module_invoke_all\u6765\u8c03\u7528\u5176\u4ed6\u6a21\u5757\u4e2d\u5b9e\u73b0\u7684\u94a9\u5b50\u51fd\u6570\u3002\u6bd4\u5982\uff0c\u5220\u9664\u67d0\u4e2a\u7528\u6237\u4e4b\u540e\uff0c\u53ef\u80fd\u9700\u8981\u5220\u9664\u8be5\u7528\u6237\u5173\u8054\u7684\u5176\u4ed6\u8d44\u6e90\uff0c\u5219\u6a21\u5757\u9700\u8981\u901a\u8fc7\u5b9e\u73b0hook_user_delete\u94a9\u5b50\u3002 Drupal 8\u4e2d\u8fd9\u4e24\u7c7b\u94a9\u5b50\u90fd\u6709\u4e86\u76f8\u5e94\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0cinfo\u7c7b\u578b\u7684\u94a9\u5b50\u5927\u90e8\u5206\u88ab\u63d2\u4ef6\uff08Plugin\uff09\u4ee3\u66ff\uff0c\u8c03\u7528\u7c7b\u578b\u7684\u94a9\u5b50\u5219\u88ab\u4e8b\u4ef6\uff08Event\uff09\u4ee3\u66ff\u3002\u4e0b\u9762\u5206\u522b\u9488\u5bf9\u4e24\u79cd\u94a9\u5b50\u9009\u62e9\u5177\u6709\u4ee3\u8868\u6027\u7684\u529f\u80fd\u505a\u5206\u6790\u3002","title":"6\u3001\u94a9\u5b50\u673a\u5236\u5728Drupal 8\u4e2d\u7684\u53d8\u5316\u53ca\u5b9e\u73b0"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#61","text":"\u8c03\u7528\u94a9\u5b50\u5728Drupal 7 \u4e2d\u6700\u6709\u4ee3\u8868\u6027\u7684\u5e94\u7528\u662f\u7528\u6237\u7684\u5220\u9664\uff0c\u5b9e\u73b0\u9700\u8981\u5206\u4e24\u6b65\uff1a 1.\u5b9e\u73b0hook_user_delete\u65b9\u6cd5\uff0c\u4ee5demo\u6a21\u5757\u4e3a\u4f8b\uff1a function demo_user_delete($account) { db_delete('user_demo', 'ud') ->condition('ud.uid', $account->uid) ->execute(); } 2.\u5728\u7528\u6237\u5220\u9664\u7684\u65b9\u6cd5\u91cc\u9762\u901a\u8fc7module_invoke_all\u6765\u8c03\u7528\u94a9\u5b50\uff1a module_invoke_all('user_delete', $account); \u53ea\u9700\u8981\u4e24\u6b65\u5c31\u5b9e\u73b0\u4e86\u7528\u6237\u5220\u9664\u4e4b\u540e\uff0c\u5220\u9664\u5173\u8054\u8d44\u6e90\u7684\u529f\u80fd\u3002 Drupal 8\u91cc\u9762\u7684\u4e8b\u4ef6\u7684\u4e09\u4e2a\u8981\u7d20\uff1a\u4e8b\u4ef6\u3001\u4e8b\u4ef6\u76d1\u542c\u548c\u4e8b\u4ef6\u89e6\u53d1\u3002 \u8981\u5b9e\u73b0\u4e8b\u4ef6\u673a\u5236\uff0c\u9996\u5148\u6211\u4eec\u5fc5\u987b\u5148\u5b9a\u4e49\u4e00\u4e2a\u4e8b\u4ef6\uff08Event\uff09\uff0c\u6bd4\u5982\u7ad9\u70b9\u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\uff0c\u5176\u6b21\u6709\u4e86\u8fd9\u4e2a\u4e8b\u4ef6\u540e\uff0c\u9700\u8981\u6709\u8ba2\u9605\u8005\u6765\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u6700\u540e\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u89e6\u53d1\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u5c06\u4e8b\u4ef6\u4f20\u9012\u7ed9\u6240\u6709\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\u7684\u8ba2\u9605\u8005\u3002 \u6211\u4eec\u4ee5\u7ad9\u70b9\u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\u4e3a\u4f8b\uff0c\u4ecb\u7ecd\u4e8b\u4ef6\u8ba2\u9605\u7684\u5b9e\u73b0\uff1a 1.\u5b9a\u4e49\u4e8b\u4ef6 Drupal 8\u7684\u6838\u5fc3\u6a21\u5757Config\u6a21\u5757\u4e2d\u5b9a\u4e49\u4e86ConfigEvent\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * Contains \\Drupal\\Core\\Config\\ConfigEvents. */ namespace Drupal\\Core\\Config ; /** * Defines events for the configuration system. * * @see \\Drupal\\Core\\Config\\ConfigCrudEvent */ final class ConfigEvents { /** * Name of the event fired when saving a configuration object. * * This event allows modules to perform an action whenever a configuration * object is saved. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigCrudEvent instance. * * See hook_update_N() documentation for safe configuration API usage and * restrictions as this event will be fired when configuration is saved by * hook_update_N(). * * @Event * * @see \\Drupal\\Core\\Config\\ConfigCrudEvent * @see \\Drupal\\Core\\Config\\Config::save() * @see \\Drupal\\Core\\Config\\ConfigFactory::onConfigSave() * @see hook_update_N() * * @var string */ const SAVE = 'config.save' ; /** * Name of the event fired when deleting a configuration object. * * This event allows modules to perform an action whenever a configuration * object is deleted. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigCrudEvent instance. * * See hook_update_N() documentation for safe configuration API usage and * restrictions as this event will be fired when configuration is deleted by * hook_update_N(). * * @Event * * @see \\Drupal\\Core\\Config\\ConfigCrudEvent * @see \\Drupal\\Core\\Config\\Config::delete() * @see \\Drupal\\Core\\Config\\ConfigFactory::onConfigDelete() * @see hook_update_N() * * @var string */ const DELETE = 'config.delete' ; /** * Name of the event fired when renaming a configuration object. * * This event allows modules to perform an action whenever a configuration * object's name is changed. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigRenameEvent instance. * * See hook_update_N() documentation for safe configuration API usage and * restrictions as this event will be fired when configuration is renamed by * hook_update_N(). * * @Event * * @see \\Drupal\\Core\\Config\\ConfigRenameEvent * @see \\Drupal\\Core\\Config\\ConfigFactoryInterface::rename() * @see hook_update_N() * * @var string */ const RENAME = 'config.rename' ; /** * Name of the event fired when validating imported configuration. * * This event allows modules to perform additional validation operations when * configuration is being imported. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigImporterEvent instance. * * @Event * * @see \\Drupal\\Core\\Config\\ConfigImporterEvent * @see \\Drupal\\Core\\Config\\ConfigImporter::validate(). * @see \\Drupal\\Core\\EventSubscriber\\ConfigImportSubscriber::onConfigImporterValidate(). * * @var string */ const IMPORT_VALIDATE = 'config.importer.validate' ; /** * Name of the event fired when importing configuration to target storage. * * This event allows modules to perform additional actions when configuration * is imported. The event listener method receives a * \\Drupal\\Core\\Config\\ConfigImporterEvent instance. * * @Event * * @see \\Drupal\\Core\\Config\\ConfigImporterEvent * @see \\Drupal\\Core\\Config\\ConfigImporter::import(). * @see \\Drupal\\Core\\EventSubscriber\\ConfigSnapshotSubscriber::onConfigImporterImport(). * * @var string */ const IMPORT = 'config.importer.import' ; /** * Name of event fired when missing content dependencies are detected. * * Events subscribers are fired as part of the configuration import batch. * Each subscribe should call * \\Drupal\\Core\\Config\\MissingContentEvent::resolveMissingContent() when they * address a missing dependency. To address large amounts of dependencies * subscribers can call * \\Drupal\\Core\\Config\\MissingContentEvent::stopPropagation() which will stop * calling other events and guarantee that the configuration import batch will * fire the event again to continue processing missing content dependencies. * * @see \\Drupal\\Core\\Config\\ConfigImporter::processMissingContent() * @see \\Drupal\\Core\\Config\\MissingContentEvent */ const IMPORT_MISSING_CONTENT = 'config.importer.missing_content' ; /** * Name of event fired to collect information on all config collections. * * This event allows modules to add to the list of configuration collections * retrieved by \\Drupal\\Core\\Config\\ConfigManager::getConfigCollectionInfo(). * The event listener method receives a * \\Drupal\\Core\\Config\\ConfigCollectionInfo instance. * * @Event * * @see \\Drupal\\Core\\Config\\ConfigCollectionInfo * @see \\Drupal\\Core\\Config\\ConfigManager::getConfigCollectionInfo() * @see \\Drupal\\Core\\Config\\ConfigFactoryOverrideBase * * @var string */ const COLLECTION_INFO = 'config.collection_info' ; } \u8be5\u4e8b\u4ef6\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982const SAVE = 'config.save'\u7684\u610f\u601d\u5373\u5b9a\u4e49\u4e86\u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\uff0c\u5f53\u914d\u7f6e\u4fdd\u5b58\u5b8c\u6210\u540e\u89e6\u53d1\u8be5\u4e8b\u4ef6\u3002 \u6709\u4e86\u4e8b\u4ef6\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u9700\u8981\u6709\u4e8b\u4ef6\u8ba2\u9605\u8005\u6765\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u4e00\u65e6\u914d\u7f6e\u4fdd\u5b58\uff0c\u5219\u6267\u884c\u76f8\u5e94\u7684\u4ee3\u7801\u3002\u6211\u4eec\u4ecd\u7136\u4ee5demo\u6a21\u5757\u4e3a\u4f8b\uff0c\u5047\u8bbe\u914d\u7f6e\u4fdd\u5b58\u540e\uff0c\u6211\u4eec\u7684demo\u6a21\u5757\u9700\u8981\u8bb0\u5f55\u4e00\u6761\u65e5\u5fd7\uff0c\u90a3demo\u6a21\u5757\u9700\u8981\u5b9e\u73b0\u76f8\u5e94\u7684\u4e8b\u4ef6\u8ba2\u9605\u7c7b\uff1a <?php /** * @file * Contains \\Drupal\\demo\\EventSubscriber\\ConfigSubscriber. */ namespace Drupal\\demo\\EventSubscriber ; use Drupal\\Core\\Config\\ConfigFactoryInterface ; use Drupal\\Core\\Config\\ConfigCrudEvent ; use Drupal\\Core\\Config\\ConfigEvents ; use Symfony\\Component\\EventDispatcher\\EventSubscriberInterface ; /** * \u8bb0\u5f55\u65e5\u5fd7\uff0c\u5982\u679c\u914d\u7f6e\u4fdd\u5b58\u4e86 */ class ConfigSubscriber implements EventSubscriberInterface { /** * \u65e5\u5fd7\u8bb0\u5f55 * * * @param ConfigCrudEvent $event * The configuration event. */ public function onConfigSave ( ConfigCrudEvent $event ) { $saved_config = $event -> getConfig (); $logger = \\Drupal :: logger ( 'config save' ); $logger -> notice ( $saved_config -> getName () . '\u4fdd\u5b58\u4e86' ); } /** * {@inheritdoc} */ static function getSubscribedEvents () { $events [ ConfigEvents :: SAVE ][] = array ( 'onConfigSave' , 0 ); return $events ; } } \u8fd9\u4e2a\u4e8b\u4ef6\u8ba2\u9605\u7c7b\u5b9e\u73b0\u4e86EventSubscriberInterface\uff0c\u8fd9\u4e2a\u63a5\u53e3\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5getSubscribedEvents\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u4e8b\u4ef6\u5bf9\u7528\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u6bd4\u5982$events[ConfigEvents::SAVE][] = array('onConfigSave', 0)\u8868\u793aConfigEvents::SAVE\u4e8b\u4ef6\u7684\u5904\u7406\u65b9\u6cd5\u4e3aonConfigSave\uff0c\u540e\u9762\u7684\u7b2c\u4e8c\u4e2a\u53c2\u65700\u8868\u793a\u4f18\u5148\u7ea7\uff0c\u8d8a\u5927\u8d8a\u5148\u6267\u884c\u3002 \u5b9e\u73b0\u4e86\u8fd9\u4e2a\u8ba2\u9605\u7c7b\u4e4b\u540e\uff0c\u4e3a\u4e86\u8ba9\u4e8b\u4ef6\u8c03\u5ea6\u5668\uff08event dispacher\uff09\u77e5\u9053\u8fd9\u4e2a\u8ba2\u9605\u8005\uff0c\u6211\u4eec\u9700\u8981\u628a\u8fd9\u4e2a\u8ba2\u9605\u7c7b\u914d\u7f6e\u6210\u670d\u52a1\uff0c\u5728demo.services.yml\u4e2d\u6211\u4eec\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a demo.config_subscriber: class: Drupal\\demo\\EventSubscriber\\ConfigSubscriber arguments: [] tags: - { name: event_subscriber } \u5230\u6b64\u4e8b\u4ef6\u8ba2\u9605\u7684\u5de5\u4f5c\u5c31\u5b8c\u6210\u4e86\uff0c\u8981\u89e6\u53d1\u4e8b\u4ef6\uff0c\u5fc5\u987b\u8981\u5728\u914d\u7f6e\u4fdd\u5b58\u7684\u65f6\u5019\u4f7f\u7528\u4e8b\u4ef6\u8c03\u5ea6\u5668\u5c06\u4e8b\u4ef6\u4f20\u9012\u7ed9\u8ba2\u9605\u8005\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a public function save($has_trusted_data = FALSE) { // Validate the configuration object name before saving. static::validateName($this->name); // If there is a schema for this configuration object, cast all values to // conform to the schema. if (!$has_trusted_data) { if ($this->typedConfigManager->hasConfigSchema($this->name)) { // Ensure that the schema wrapper has the latest data. $this->schemaWrapper = NULL; foreach ($this->data as $key => $value) { $this->data[$key] = $this->castValue($key, $value); } } else { foreach ($this->data as $key => $value) { $this->validateValue($key, $value); } } } $this->storage->write($this->name, $this->data); if (!$this->isNew) { Cache::invalidateTags($this->getCacheTags()); } $this->isNew = FALSE; $this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent($this)); $this->originalData = $this->data; // Potentially configuration schema could have changed the underlying data's // types. $this->resetOverriddenData(); return $this; } \u4e0a\u8ff0\u4ee3\u7801\u4e3aConfig\u6a21\u5757\u4e2d\u914d\u7f6e\u4fdd\u5b58\u7684\u65b9\u6cd5\uff0c\u5176\u4e2d\u7684 this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent( this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent( this))\u8fd9\u53e5\u4ee3\u7801\u5c31\u662f\u8bb2\u4e8b\u4ef6\u4f20\u9012\u7ed9\u6240\u6709\u76d1\u542c\u4e86ConfigEvents::SAVE\u4e8b\u4ef6\u7684\u8ba2\u9605\u8005\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u6211\u4eecdemo\u6a21\u5757\u91cc\u9762\u7684\u8ba2\u9605\u8005\u3002 \u5173\u4e8e\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u7684\u5b9e\u73b0\u8bf7\u53c2\u8003 http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/","title":"6.1\u3001\u8c03\u7528\u94a9\u5b50\u7684\u66ff\u4ee3\u4e0e\u5b9e\u73b0"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#62info","text":"info\u7c7b\u94a9\u5b50\u7684\u4e00\u4e2a\u91cd\u8981\u5e94\u7528\u662fweb services\u3002\u5728Drupal 7\u4e2d\uff0c\u5185\u6838\u4e0d\u5e26rest\uff0c\u9700\u8981\u7b2c\u4e09\u65b9\u6a21\u5757\u3002\u800c\u5728drupal8\u4e2d\uff0c\u6838\u5fc3\u81ea\u5e26rest\uff0c\u9664\u4e86rest\u754c\u9762\u7ba1\u7406\u6a21\u5757\uff08rest UI\uff09\u5916\uff0c\u4e0d\u9700\u8981\u7b2c\u4e09\u65b9\u6a21\u5757\u3002 Drupal 7\u4e2d\u5b9e\u73b0\u4e00\u4e2aweb services\u9700\u8981\u4ee5\u4e0b\u51e0\u6b65\uff1a 1.\u4e0b\u8f7dServices\u3001REST Server\u3001Chaos tools\u3001OAuth Authentication\u7b2c\u4e09\u65b9\u6a21\u5757\u653e\u5165\u76f8\u5e94\u76ee\u5f55\uff0c\u8fdb\u5165\u540e\u53f0->\u6a21\u5757\uff0c\u52fe\u9009\u8fd9\u51e0\u4e2a\u6a21\u5757\u4fdd\u5b58\u542f\u7528\u3002 2.\u5b9e\u73b0hook_services_resources,\u4ee3\u7801\u5982\u4e0b\uff1a /** * Implements hook_services_resources(). */ function demo_services_resources() { return array( 'demo' => array( 'actions' => array( 'add' => array( 'help' => '\u521b\u5efa\u793a\u4f8b', 'file' => array('file' => 'inc', 'module' => 'demo', 'name' => 'demo.apis'), 'callback' => 'demo_add_resources', 'access arguments' => array('access_to_demo_api'), 'args' => array( array( 'name' => 'data', 'source' => 'data', 'type' => 'array', 'optional' => FALSE, ), ), ), ), ), ); } \u5176\u4e2d\u6570\u7ec4\u7684\u7b2c\u4e00\u5c42\u8868\u793a\u63a5\u53e3\u5730\u5740\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0cactions\u4e0b\u7684\u6bcf\u4e00\u4e2a\u952e\u8868\u793a\u4e00\u4e2a\u63a5\u53e3\uff0c\u540c\u65f6\u4e5f\u662f\u63a5\u53e3\u5730\u5740\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982\u4e0a\u9762\u7684\u4f8b\u5b50\u8868\u793ademo/add\u63a5\u53e3\uff0ccallback\u8868\u793a\u63a5\u53e3\u7684\u5904\u7406\u51fd\u6570\u3002file\u8868\u793a\u63a5\u53e3\u65b9\u6cd5\u6240\u5728\u7684\u6587\u4ef6\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u8981\u5b9e\u73b0demo_add_resources\u65b9\u6cd5\uff1a function demo_add_resources($data) { $return = array( 'code' => 0, 'message' => '\u64cd\u4f5c\u5931\u8d25' ); return $return; } \u6700\u540e\u6211\u4eec\u8981\u8fdb\u5165\u7cfb\u7edf\u7ba1\u7406\u754c\u9762-\u300b\u7ed3\u6784-\u300bservices\u6dfb\u52a0\u4e00\u4e2a\u7aef\u70b9\uff0c\u6211\u4eec\u5c06\u673a\u8bfb\u540d\u79f0\u8bbe\u7f6e\u4e3aapi\uff0c\u670d\u52a1\u5668\u9009\u62e9rest\uff0c\u7aef\u70b9\u8def\u5f84\u8bbe\u4e3aAPI\uff0c\u4fdd\u5b58\uff0c\u5219\u7aef\u70b9\u65b0\u5efa\u6210\u529f\u3002\u70b9\u51fb\u7f16\u8f91\uff0c\u5c06\u6211\u4eec\u521a\u624d\u65b0\u5efa\u7684\u63a5\u53e3\u52fe\u9009\uff0c\u4fdd\u5b58\u3002\u8fd9\u65f6\uff0c\u63a5\u53e3\u5c31\u53d1\u5e03\u6210\u529f\uff0c\u8bbf\u95ee\u8def\u5f84\u4e3aAPI/demo/add\u3002 Drupal 8\u4e2d\uff0cweb services\u7528\u63d2\u4ef6\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u5177\u4f53\u6b65\u9aa4\uff1a 1.\u4e0b\u8f7drest UI\u7b2c\u4e09\u65b9\u6a21\u5757\uff0c\u653e\u5165\u76f8\u5e94\u76ee\u5f55\uff0c\u8fdb\u5165\u540e\u53f0-\u300b\u6269\u5c55\uff0c\u52fe\u9009rest UI\u3001RESTful Web Services\u3001Serialization\u3001HAL\u3001HTTP Basic Authentication\uff0c\u4fdd\u5b58\u3002 2.\u65b0\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u53cd\u5e8f\u5217\u5316\u7c7b\u3002\u56e0\u4e3aDrupal 8 \u5728\u5904\u7406web service\u7684\u8bf7\u6c42\u65f6\uff0c\u9996\u5148\u5c06\u63a5\u6536\u7684\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3a\u67d0\u4e2a\u7c7b\uff0c\u7136\u540e\u5904\u7406\u6570\u636e\uff0c\u6700\u540e\u5c06\u8fd4\u56de\u503c\u5e8f\u5217\u5316\u4e3ajson\u6216\u8005xml\u7b49\u6570\u636e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u6240\u4ee5\u5fc5\u987b\u8981\u6709\u53cd\u5e8f\u5217\u5316\u548c\u5e8f\u5217\u5316\u7684\u7c7b\u3002\u4f46\u662fDrupal 8\u6838\u5fc3\u4e2d\u7684\u53cd\u5e8f\u5217\u5316\u7c7b\u53ea\u652f\u6301\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3aentity\uff0c\u8fd9\u6837\uff0c\u5bf9\u4e8e\u5199\u63a5\u53e3\u4f1a\u975e\u5e38\u4e0d\u4fbf\uff0c\u6bd4\u5982\uff0c\u67d0\u4e2aAPI\u4f20\u9012\u7684\u53c2\u6570\u53ef\u80fd\u5e76\u4e0d\u80fd\u548c\u67d0\u4e2aentity\u5bf9\u5e94\uff0c\u8fd9\u6837\u8fd9\u4e2a\u63a5\u53e3\u5c31\u6ca1\u6cd5\u5b9e\u73b0\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u7684\u7c7b\uff0c\u6bd4\u5982\u53ef\u4ee5\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3a\u6570\u7ec4\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <?php /** * @file * Contains \\Drupal\\demo\\Normalizer\\CustomNormalizer. */ namespace Drupal\\demo\\Normalizer ; class CustomNormalizer extends AbstractNormalizer { /** * {@inheritdoc} */ public function supportsNormalization ( $data , $format = null ) { return false ; } /** * {@inheritdoc} * */ public function normalize ( $object , $format = null , array $context = array ()) { return '' ; } /** * {@inheritdoc} */ public function supportsDenormalization ( $data , $type , $format = null ) { return $type == 'Array' ; } /** * {@inheritdoc} */ public function denormalize ( $data , $class , $format = null , array $context = array ()) { $array = ( array ) $data ; return $array ; } } \u5b9e\u73b0\u4e0a\u8ff0\u7c7b\u4e4b\u540e\uff0c\u6211\u4eec\u9700\u8981\u5c06\u8be5\u7c7b\u5b9a\u4e49\u4e3aservice\uff0c\u5728demo.services.yml\u4e2d\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a demo.normalizer.custom: class: Drupal\\demo\\Normalizer\\CustomNormalizer tags: - { name: normalizer } \u63a5\u4e0b\u6765\uff0c\u518d\u5b9e\u73b0\u63d2\u4ef6\uff0c\u63d2\u4ef6\u5176\u5b9e\u662f\u4e00\u4e2a\u7c7b\uff0c\u8be5\u7c7b\u7ee7\u627f\u81ea\u8be5\u79cd\u63d2\u4ef6\u7684\u57fa\u7c7b\uff0c\u5e76\u4e14\u9700\u8981\u7528\u6ce8\u89e3\u8868\u660e\u8be5\u7c7b\u7684\u63d2\u4ef6\u6027\u8d28\u3002 <?php /** * @file * Contains \\Drupal\\demo\\Plugin\\rest\\resource\\ExampleResource */ namespace Drupal\\demo\\Plugin\\rest\\resource ; use Drupal\\rest\\Plugin\\ResourceBase ; use Drupal\\rest\\ResourceResponse ; use Symfony\\Component\\HttpFoundation\\Request ; /** * Represents demo as resources. * * @RestResource( * id = \"demo\", * label = @Translation(\"Demo Resource\"), * serialization_class = \"Array\", * uri_paths = { * \"canonical\" = \"/API/demo\", * * } * ) * */ class ExampleResource extends ResourceBase { /** * Responds to GET requests. * * @param array $data * @param Symfony\\Component\\HttpFoundation\\Request $request * * @return \\Drupal\\rest\\ResourceResponse * The response containing the entity with its accessible fields. * */ public function get ( $data , Request $request ) { $logger = \\Drupal :: logger ( 'rest_get' ); $logger -> notice ( $request -> get ( 'sid' )); $return = array ( 'code' => 1 , 'message' => '\u8fd9\u662fget\u65b9\u6cd5' , ); $response = new ResourceResponse ( $return , 200 ); return $response ; } /** * Responds to POST requests. * * @param array $data * @param Symfony\\Component\\HttpFoundation\\Request $request * * @return \\Drupal\\rest\\ResourceResponse * The response containing the entity with its accessible fields. * */ public function post ( $data , Request $request ) { $logger = \\Drupal :: logger ( 'rest_post' ); $logger -> notice ( '<pre>' . print_r ( $data , TRUE ) . '</pre>' ); $return = array ( 'code' => 1 , 'message' => '\u8fd9\u662fpost\u65b9\u6cd5' , 'data' => $data ); $response = new ResourceResponse ( $return , 200 ); return $response ; } /** * Responds to DELETE requests. * * @param array $data * @param Symfony\\Component\\HttpFoundation\\Request $request * * @return \\Drupal\\rest\\ResourceResponse * The response containing the entity with its accessible fields. * */ public function delete ( $data , Request $request ) { $logger = \\Drupal :: logger ( 'rest_delete' ); $logger -> notice ( '<pre>' . print_r ( $data , TRUE ) . '</pre>' ); $return = array ( 'code' => 1 , 'message' => '\u8fd9\u662fdelete\u65b9\u6cd5' , 'data' => $data ); $response = new ResourceResponse ( $return , 200 ); return $response ; } } \u4e0b\u9762\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u4e0a\u8ff0\u4ee3\u7801\uff0c 1.@RestResource\u6ce8\u89e3\u8868\u793a\u8be5\u7c7b\u662fRestResource\u7c7b\u578b\u7684\u63d2\u4ef6\uff0c\u4e5f\u5c31\u662f\u8be5\u7c7b\u5b9e\u73b0rest web services\uff1b 2.\u6ce8\u89e3\u4e2d\u7684ID\u662f\u8be5\u63d2\u4ef6\u7684ID\uff0clabel\u662f\u63d2\u4ef6\u7684\u540d\u79f0\uff1b 3.serialization_class\u5c31\u662f\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u8bbe\u7f6e\u4e3a\u201cArray\u201d\uff0c\u5219\u4ee3\u7801\u4f1a\u81ea\u52a8\u8c03\u7528\u6211\u4eec\u7684\u81ea\u5b9a\u4e49\u7684\u53cd\u5e8f\u5217\u5316\u7c7b\u6765\u53cd\u5e8f\u5217\u5316\u6570\u636e\uff1b 4.\"canonical\" = \"/API/demo\"\u8868\u793aapi\u7684\u8def\u5f84\u662f/API/demo\uff1b\" https://www.drupal.org/link-relations/create \" = \"/API/demo\"\uff0c\u8868\u793aPOST\u65b9\u6cd5\u63d0\u4ea4\u65f6\u7684\u8def\u5f84\uff0c\u5f53\u7528POST\u65b9\u6cd5\u63d0\u4ea4\u65f6\uff0c\u4f1a\u8986\u76d6canonical\u6307\u5b9a\u8def\u5f84\u3002 \u8fd9\u4e2aweb services\u63d2\u4ef6\u5185\u90e8\u5b9e\u73b0\u4e86\u4e09\u4e2a\u65b9\u6cd5\uff0cget\u3001post\u3001delete\uff0c\u5206\u522b\u5bf9\u5e94\u4ee5get\u65b9\u6cd5\u3001post\u65b9\u6cd5\u548cdelete\u65b9\u6cd5\u63d0\u4ea4\u7684\u5904\u7406\u65b9\u6cd5\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5982\u679c\u6211\u4ee5get\u65b9\u6cd5\u8bbf\u95eeAPI/demo\uff0c\u5219\u8c03\u7528get\uff0c\u4ee5post\u65b9\u6cd5\u8bbf\u95eeAPI/demo\uff0c\u5219\u8c03\u7528post\uff0c\u4ee5delete\u65b9\u6cd5\u8bbf\u95eeAPI/demo\u5219\u8c03\u7528delete\u3002 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u7684\u4ee3\u7801\u5c31\u5168\u90e8\u5199\u5b8c\uff0c\u8981\u4f7f\u7528\u8be5API\uff0c\u9700\u8981\u8fdb\u5165\u540e\u53f0-\u300b\u914d\u7f6e-\u300brest\uff0c\u542f\u7528\u8fd9\u4e2aapi\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u542f\u7528get\u3001post\u548cdelete\u65b9\u6cd5\uff0c\u540c\u65f6\u9009\u62e9\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u6570\u636e\u683c\u5f0f\uff0c\u6bd4\u5982hal_json\u3001json\u3001xml\uff0c\u70b9\u51fb\u4fdd\u5b58\u540e\uff0c\u60a8\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8be5api\u4e86\u3002","title":"6.2\u3001info\u7c7b\u94a9\u5b50\u7684\u66ff\u6362\u4e0e\u5b9e\u73b0"},{"location":"drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#7drupal-8","text":"Drupal 8\u91c7\u7528\u4e86\u9762\u5411\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u81ea\u7136\u4e5f\u4f1a\u5f15\u5165\u5f88\u591a\u9762\u5411\u5bf9\u8c61\u7684\u65b0\u7279\u6027\uff0c\u6bd4\u5982\u4f9d\u8d56\u6ce8\u5165\u3001\u670d\u52a1\u5bb9\u5668\uff0c\u672c\u6587\u53ea\u662f\u63d0\u51fa\u8fd9\u4e9b\u65b0\u7279\u6027\uff0c\u66f4\u6df1\u5165\u7684\u4ecb\u7ecd\u8bf7\u53c2\u8003\u76f8\u5e94\u7684\u6587\u7ae0\u3002 \u4f9d\u8d56\u6ce8\u5165\u548c\u670d\u52a1\u5bb9\u5668\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/15/Drupal8-Service-DependencyInjection/ \u6ce8\u89e3\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/12/Drupal8\u6ce8\u89e3-Annotations-\u8bed\u6cd5/ content entity\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/22/Drupal8-Content-Entity/ configuration entity\uff0c\u8bf7\u53c2\u8003 http://verynull.com/2015/12/21/Drupal8-configuration-Entity/ \u53c2\u8003\u6587\u732e http://drupalchina.cn/node/3122 https://www.drupal.org/node/2216195 https://drupalize.me/blog/201409/unravelling-drupal-8-plugin-system http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/ http://drupalchina.cn/node/3353 https://dev.acquia.com/blog/introduction-restful-web-services-drupal-8","title":"7\u3001Drupal 8\u4e2d\u7684\u65b0\u589e\u673a\u5236"},{"location":"drupal/drupal8/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/","tags":"[oop]","text":"\u8fd9\u662f\u5b66\u4e60Drupal8\u7684\u7cfb\u5217\u7684\u5f00\u7bc7\u6587\u7ae0\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5c06\u4ecb\u7ecd\u548c\u63a2\u8ba8Drupal OOP\u3002 OOP\u7684\u6700\u5927\u4f18\u52bf\u5c31\u662f\u89e3\u8026\uff0cDrupal8\u4e2d\u4f7f\u7528\u5927\u91cf\u7684OOP(interface, class, etc...)\uff0c\u8fd9\u91cc\u4ec5\u5bf9Drupal\u4e2d\u5e38\u89c1\u7684\u4e00\u4e9b\u6982\u5ff5\u505a\u4e00\u4e0b\u4ecb\u7ecd\u3002 \u4e00\u3001\u6570\u636e\u7c7b\u578b \u00b6 \u4ec0\u4e48\u662f\u5bf9\u8c61\uff1f\u6211\u4eec\u5148\u6765\u770b\u5b57\u7b26\u4e32\uff0c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c31\u662f\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u6539\u53d8\u6216\u83b7\u53d6\u5b57\u7b26\u4e32\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u5982\u8981\u83b7\u53d6\u957f\u5ea6\uff0c\u6211\u4eec\u4e00\u822c\u662f\u7528strlen()\u51fd\u6570\u3002 \u4f46\u662f\u5bf9\u4e8e\u5176\u4ed6\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5982\u6574\u5f62(int)\u7b49\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5c31\u4e0d\u9002\u7528\u3002 \u800cOOP\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u5b83\u5141\u8bb8\u4f60\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u3002\u8fd9\u4e9b\u6570\u636e\u7c7b\u578b\u4e5f\u79f0\u4e4b\u4e3a\"\u7c7b\"\uff0c\u5728\u7c7b\u4e2d\u5305\u542b\u4e00\u4e9b\u5185\u90e8\u7ed3\u6784\uff0c\u5982: class Person { // \u4e0b\u9762\u662f\u4eba\u7684\u6210\u5458\u5c5e\u6027 protected $name; // \u4eba\u7684\u540d\u5b50 protected $sex; // \u4eba\u7684\u6027\u522b protected $age; // \u4eba\u7684\u5e74\u9f84 // \u6784\u9020\u51fd\u6570 public function __construct($name, $sex, $age) { $this->name = $name; $this->sex = $sex; $this->age = $age; } public function getPerson() { return $this->name . '\uff0c\u6027\u522b\uff1a' . $this->sex . '\uff0c\u5e74\u9f84\uff1a' . $this->age; } } \u8fd9\u6bb5\u4ee3\u7801\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u53ebPerson\u7684\u7c7b\uff0c\u5305\u542b\u4e09\u4e2a\u5c5e\u6027$name, $sex, $age\uff0c\u4e5f\u5305\u542b2\u4e2a\u65b9\u6cd5\u3002\u5b9e\u4f8b\u5316\u5982\u4e0b\uff1a $name = '\u738b\u9e4f'; $sex = '\u7537'; $age = 30; $myperson = new Person($name, $sex, $age); $myperson\u73b0\u5728\u5c31\u662f\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\u3002\u5bf9\u4e8eDrupal\u6765\u8bf4\uff0c\u7c7b\u548c\u5bf9\u8c61\u7684\u5173\u7cfb\u5c31\u7c7b\u4f3c\u5185\u5bb9\u7c7b\u578b\u548c\u5185\u5bb9\u4e4b\u95f4\u7684\u5173\u7cfb\u3002 \u4e8c\u3001\u7c7b\u7684\u7ed3\u6784(class) \u00b6 \u7c7b\u7684\u6982\u5ff5\uff1a\u7c7b\u662f\u5177\u6709\u76f8\u540c\u5c5e\u6027\u548c\u670d\u52a1\u7684\u4e00\u7ec4\u5bf9\u8c61\u7684\u96c6\u5408\u3002\u5b83\u4e3a\u5c5e\u4e8e\u8be5\u7c7b\u7684\u6240\u6709\u5bf9\u8c61\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u62bd\u8c61\u63cf\u8ff0\uff0c\u5176\u5185\u90e8\u5305\u62ec\u5c5e\u6027\u548c\u670d\u52a1\u4e24\u4e2a\u4e3b\u8981\u90e8\u5206\u3002\u5728\u9762\u5411\u5bf9\u8c61\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u7c7b\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u7a0b\u5e8f\u5355\u4f4d\uff0c\u5b83\u5e94\u8be5\u6709\u4e00\u4e2a\u7c7b\u540d\u5e76\u5305\u62ec\u5c5e\u6027\u8bf4\u660e\u548c\u670d\u52a1\u8bf4\u660e\u4e24\u4e2a\u4e3b\u8981\u90e8\u5206\u3002 \u8fd9\u6bb5\u6587\u5b57\u662f\u6458\u6284\u81eagoogle\uff0c\u6bd4\u8f83\u6666\u6da9\u96be\u61c2\u3002 \u7b80\u5355\u8bf4\uff0c\u65b9\u6cd5\u662f\u53ef\u4ee5\u5728\u5bf9\u8c61\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\u3002\u6bd4\u5982\u5728Person\u7c7b\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u65b9\u6cd5\u53ebgetPerson()\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5f15\u7528\u5bf9\u8c61\u8c03\u7528TA\u3002 $person = $myperson->getPerson(); \u5f53\u7136\uff0c\u6211\u4eec\u4e0d\u80fd\u7528 myperson->name\u6216 myperson->name\u6216 myperson->sex\u6765\u5f15\u7528\u8fd9\u4e9b\u5c5e\u6027\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e9b\u5173\u952e\u8bcdpublic\u3001protected\uff0c\u4ed6\u4eec\u5b9a\u4e49\u4e86\u65b9\u6cd5\u6216\u8005\u5c5e\u6027\u7684\u53ef\u89c1\u6027\u3002public\u65b9\u6cd5\u6216\u8005\u5c5e\u6027\u53ef\u4ee5\u5916\u90e8\u8bbf\u95ee\u8c03\u7528\uff0c\u5982getPerson()\u3002\u4f46\u662fprotected\u4ec5\u9650\u4e8e\u5728\u7c7b\u6216\u5b50\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u3002\u800cprivate\u5c31\u53ea\u80fd\u5728\u7c7b\u81ea\u5df1\u5185\u90e8\u8c03\u7528\uff0c\u800c\u4e0d\u80fd\u5728\u5b83\u7684\u5b50\u7c7b\u4e2d\u3002 Drupal\u4e2d\u4e00\u822c\u58f0\u660e\u5c5e\u6027protected,\u65b9\u6cd5\u58f0\u660e\u4e3apublic\u6216protected\uff0cprivate\u4e00\u822c\u4e0d\u8d5e\u6210\u4f7f\u7528\u3002 \u4e09\u3001\u63a5\u53e3(interface) \u00b6 \u63a5\u53e3\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u62bd\u8c61\u7c7b\uff0c\u62bd\u8c61\u7c7b\u53c8\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7c7b\uff0c\u6240\u4ee5\u63a5\u53e3\u4e5f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7c7b\uff0c\u4e3a \u4ec0\u4e48\u8bf4\u63a5\u53e3\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u62bd\u8c61\u7c7b\u5462\uff1f\u5982\u679c\u4e00\u4e2a\u62bd\u8c61\u7c7b\u91cc\u9762\u7684\u6240\u6709\u7684\u65b9\u6cd5\u90fd\u662f\u62bd\u8c61\u65b9\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6362\u4e00\u79cd\u58f0\u660e\u65b9\u6cd5\u4f7f\u7528\u201c\u63a5\u53e3\u201d\uff1b\u4e5f\u5c31\u662f\u8bf4\u63a5\u53e3\u91cc\u9762\u6240\u6709\u7684\u65b9\u6cd5\u5fc5\u987b \u90fd\u662f\u58f0\u660e\u4e3a\u62bd\u8c61\u65b9\u6cd5\uff0c\u53e6\u5916\u63a5\u53e3\u91cc\u9762\u4e0d\u80fd\u58f0\u660e\u53d8\u91cf(\u4f46\u53ef\u58f0\u660e\u5e38\u91cfconstant)\uff0c\u800c\u4e14\u63a5\u53e3\u91cc\u9762\u6240\u6709\u7684\u6210\u5458\u90fd\u662fpublic\u6743\u9650\u7684\u3002\u6240\u4ee5\u5b50\u7c7b\u5728\u5b9e\u73b0\u7684\u65f6\u5019 \u4e5f\u4e00\u5b9a\u8981\u4f7f\u7528public\u6743\u9650\u5b9e\u9650\u3002 \u5728\u7c7b\u4e2d\uff0cPerson\u5b9a\u4e49\u7684\u5bf9\u8c61\u5927\u62b5\u662f\u8fd9\u6837\uff1a class Person { public function getPerson() {...} } \u90a3\u5982\u4f55\u5b9a\u4e49\u63a5\u53e3\u5462\uff1f interface PersonInterface { public function getPerson(); } class Person implements PersonInterface { public __construct($name, $sex, $age); public function getPerson() { /*..........*/ } } \u8fd9\u5c31\u50cf\u7528\u6237\u754c\u9762\u5b9a\u4e49\u4e86\u4eba\u548c\u7a0b\u5e8f\u5982\u4f55\u4ea4\u4e92\uff0c\u800c\u63a5\u53e3\u5b9a\u4e49\u4e86\u65b9\u6cd5\u548c\u5bf9\u8c61\u7684\u4ea4\u4e92\u8fc7\u7a0b\u3002\u5f53\u7136\u4f60\u4e0d\u80fd\u521b\u5efa\u4e00\u4e2a\u63a5\u53e3\u5bf9\u8c61\uff0c\u800c\u5fc5\u987b\u4e00\u4e2a\u63a5\u53e3\u7c7b\u3002 \u8bf4\u7b80\u5355\u70b9\u3002\u5c31\u662f---\u63a5\u53e3\u5b9a\u4e49\u4e86\u65b9\u6cd5\uff0c\u7c7b\u5b9e\u73b0\u4e86\u65b9\u6cd5\u3002 \u56db\u3001\u6784\u9020\u65b9\u6cd5(constructor) \u00b6 \u6211\u4eec\u518d\u6765\u770bPerson\u7c7b\u4e2d\u7684\u65b9\u6cd5__construct()\uff0c\u5b83\u662f\u7528\u4e24\u4e2a\u4e0b\u5212\u7ebf\u4f5c\u4e3a\u524d\u7f00\u3002\u8fd9\u662fPHP5\u4e2d\u5f15\u5165\u7684\u3002\u5f53\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528\u6784\u9020\u51fd\u6570\uff0c\u4e5f\u5c31\u662f\u7528new\u8fd9\u4e2a\u5173\u952e\u5b57\u5b9e\u4f8b\u5316\u5bf9\u8c61\u7684\u65f6\u5019\u81ea\u52a8\u8c03\u7528\u6784\u9020\u51fd\u6570\u3002 \u5728\u4e00\u4e2a\u7c7b\u4e2d\u53ea\u80fd\u58f0\u660e\u4e00\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u800c\u662f\u53ea\u6709\u5728\u6bcf\u6b21\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u90fd\u4f1a\u53bb\u8c03\u7528\u4e00\u6b21\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u80fd\u4e3b\u52a8\u7684\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6240\u4ee5\u901a\u5e38\u7528\u5b83\u6267\u884c\u4e00\u4e9b\u6709\u7528\u7684\u521d\u59cb\u5316\u4efb\u52a1\u3002\u6bd4\u5982\u5bf9\u6210\u5c5e\u6027\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u8d4b\u521d\u503c\u3002\u5982\u6211\u4eec\u4e0a\u9762\u7684\u4ee3\u7801\uff1a $myperson = new Person($name, $sex, $age); \u5b83\u662f\u5982\u4f55\u6267\u884c\u7684\u5462\uff1f 1\u3001\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2aPerson\u5bf9\u8c61 2\u3001\u7528new\u5173\u952e\u5b57\u8c03\u7528__construct\u65b9\u6cd5 3\u3001\u628aPerson\u5bf9\u8c61\u590d\u5236\u7ed9 this\u5c5e\u6027 4\u3001\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a this\u5c5e\u6027 4\u3001\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a myperson\u7684\u53d8\u91cf\uff0c\u4ed6\u5e76\u4e0d\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4ed6\u7528\u6765\u5904\u7406\u5bf9\u8c61 5\u3001\u628a$myperson\u6307\u5411\u5185\u5b58\u4e2d\u7684Person\u5bf9\u8c61 \u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u63a5\u53e3\u4e2d\u5b9a\u4e49\u6784\u9020\u65b9\u6cd5\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u4ee3\u7801\u903b\u8f91\u6df7\u4e71\uff01 \u4e94\u3001\u7ee7\u627f(inherit) \u00b6 \u7ee7\u627f\u662fOOP\u7684\u4e00\u4e2a\u91cd\u8981\u7684\u7279\u6027\uff0c\u7ee7\u627f\u662f\u5b50\u7c7b\u81ea\u52a8\u5171\u4eab\u7236\u7c7b\u6570\u636e\u7ed3\u6784\u548c\u65b9\u6cd5\u7684\u673a\u5236\uff0c\u8fd9\u662f\u7c7b\u4e4b\u95f4\u7684\u4e00\u79cd\u5173\u7cfb\u3002\u5982\uff1a class Student extends Person { public function __construct($name, $sex, $age) { $this->name = $name; $this->sex = $sex; $this->age = $age; } } $mystudent = new Student($name, $sex, $age); \u8fd9\u91cc\u58f0\u660e\u4e86Student\u7c7b\u662fPerson\u7684\u5b50\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u6ca1\u6709\u5b9a\u4e49getPerson\u65b9\u6cd5\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2a\u65b9\u6cd5\u7ee7\u627f\u81eaPerson\u7c7b\uff0c\u5982 mystudent->getPerson()\u548c mystudent->getPerson()\u548c mypeson->getPerson()\u6267\u884c\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\u3002\u6211\u4eec\u8fd9\u91cc\u4e5f\u6ca1\u6709\u5b9a\u4e49$name, $sex, $age\u8fd9\u4e9b\u5c5e\u6027\uff0c\u4ed6\u4eec\u4e5f\u662f\u7ee7\u627f\u81eaPerson\u7236\u7c7b\u3002 \u5728C++\u8bed\u8a00\u4e2d\uff0c\u4e00\u4e2a\u6d3e\u751f\u7c7b\u53ef\u4ee5\u4ece\u4e00\u4e2a\u57fa\u7c7b\u6d3e\u751f\uff0c\u4e5f\u53ef\u4ee5\u4ece\u591a\u4e2a\u57fa\u7c7b\u6d3e\u751f\u3002\u4ece\u4e00\u4e2a\u57fa\u7c7b\u6d3e\u751f\u7684\u7ee7\u627f\u79f0\u4e3a\u5355\u7ee7\u627f\uff1b\u4ece\u591a\u4e2a\u57fa\u7c7b\u6d3e\u751f\u7684\u7ee7\u627f\u79f0\u4e3a\u591a\u7ee7\u627f\u3002 \u4f46\u662f\u5728PHP\u548cJava\u8bed\u8a00\u91cc\u9762\u6ca1\u6709\u591a\u7ee7\u627f\uff0c\u53ea\u6709\u5355\u7ee7\u627f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u7c7b\u53ea\u80fd\u76f4\u63a5\u4ece\u4e00\u4e2a\u7c7b\u4e2d\u7ee7\u627f\u6570\u636e\uff0c \u8fd9\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u5355\u7ee7\u627f\u3002","title":"\"Drupal8\u9762\u5411\u5bf9\u8c61(OOP)\""},{"location":"drupal/drupal8/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/#_1","text":"\u4ec0\u4e48\u662f\u5bf9\u8c61\uff1f\u6211\u4eec\u5148\u6765\u770b\u5b57\u7b26\u4e32\uff0c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c31\u662f\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u6539\u53d8\u6216\u83b7\u53d6\u5b57\u7b26\u4e32\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u5982\u8981\u83b7\u53d6\u957f\u5ea6\uff0c\u6211\u4eec\u4e00\u822c\u662f\u7528strlen()\u51fd\u6570\u3002 \u4f46\u662f\u5bf9\u4e8e\u5176\u4ed6\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5982\u6574\u5f62(int)\u7b49\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5c31\u4e0d\u9002\u7528\u3002 \u800cOOP\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u5b83\u5141\u8bb8\u4f60\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u3002\u8fd9\u4e9b\u6570\u636e\u7c7b\u578b\u4e5f\u79f0\u4e4b\u4e3a\"\u7c7b\"\uff0c\u5728\u7c7b\u4e2d\u5305\u542b\u4e00\u4e9b\u5185\u90e8\u7ed3\u6784\uff0c\u5982: class Person { // \u4e0b\u9762\u662f\u4eba\u7684\u6210\u5458\u5c5e\u6027 protected $name; // \u4eba\u7684\u540d\u5b50 protected $sex; // \u4eba\u7684\u6027\u522b protected $age; // \u4eba\u7684\u5e74\u9f84 // \u6784\u9020\u51fd\u6570 public function __construct($name, $sex, $age) { $this->name = $name; $this->sex = $sex; $this->age = $age; } public function getPerson() { return $this->name . '\uff0c\u6027\u522b\uff1a' . $this->sex . '\uff0c\u5e74\u9f84\uff1a' . $this->age; } } \u8fd9\u6bb5\u4ee3\u7801\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u53ebPerson\u7684\u7c7b\uff0c\u5305\u542b\u4e09\u4e2a\u5c5e\u6027$name, $sex, $age\uff0c\u4e5f\u5305\u542b2\u4e2a\u65b9\u6cd5\u3002\u5b9e\u4f8b\u5316\u5982\u4e0b\uff1a $name = '\u738b\u9e4f'; $sex = '\u7537'; $age = 30; $myperson = new Person($name, $sex, $age); $myperson\u73b0\u5728\u5c31\u662f\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\u3002\u5bf9\u4e8eDrupal\u6765\u8bf4\uff0c\u7c7b\u548c\u5bf9\u8c61\u7684\u5173\u7cfb\u5c31\u7c7b\u4f3c\u5185\u5bb9\u7c7b\u578b\u548c\u5185\u5bb9\u4e4b\u95f4\u7684\u5173\u7cfb\u3002","title":"\u4e00\u3001\u6570\u636e\u7c7b\u578b"},{"location":"drupal/drupal8/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/#class","text":"\u7c7b\u7684\u6982\u5ff5\uff1a\u7c7b\u662f\u5177\u6709\u76f8\u540c\u5c5e\u6027\u548c\u670d\u52a1\u7684\u4e00\u7ec4\u5bf9\u8c61\u7684\u96c6\u5408\u3002\u5b83\u4e3a\u5c5e\u4e8e\u8be5\u7c7b\u7684\u6240\u6709\u5bf9\u8c61\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u62bd\u8c61\u63cf\u8ff0\uff0c\u5176\u5185\u90e8\u5305\u62ec\u5c5e\u6027\u548c\u670d\u52a1\u4e24\u4e2a\u4e3b\u8981\u90e8\u5206\u3002\u5728\u9762\u5411\u5bf9\u8c61\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u7c7b\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u7a0b\u5e8f\u5355\u4f4d\uff0c\u5b83\u5e94\u8be5\u6709\u4e00\u4e2a\u7c7b\u540d\u5e76\u5305\u62ec\u5c5e\u6027\u8bf4\u660e\u548c\u670d\u52a1\u8bf4\u660e\u4e24\u4e2a\u4e3b\u8981\u90e8\u5206\u3002 \u8fd9\u6bb5\u6587\u5b57\u662f\u6458\u6284\u81eagoogle\uff0c\u6bd4\u8f83\u6666\u6da9\u96be\u61c2\u3002 \u7b80\u5355\u8bf4\uff0c\u65b9\u6cd5\u662f\u53ef\u4ee5\u5728\u5bf9\u8c61\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\u3002\u6bd4\u5982\u5728Person\u7c7b\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u65b9\u6cd5\u53ebgetPerson()\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5f15\u7528\u5bf9\u8c61\u8c03\u7528TA\u3002 $person = $myperson->getPerson(); \u5f53\u7136\uff0c\u6211\u4eec\u4e0d\u80fd\u7528 myperson->name\u6216 myperson->name\u6216 myperson->sex\u6765\u5f15\u7528\u8fd9\u4e9b\u5c5e\u6027\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e9b\u5173\u952e\u8bcdpublic\u3001protected\uff0c\u4ed6\u4eec\u5b9a\u4e49\u4e86\u65b9\u6cd5\u6216\u8005\u5c5e\u6027\u7684\u53ef\u89c1\u6027\u3002public\u65b9\u6cd5\u6216\u8005\u5c5e\u6027\u53ef\u4ee5\u5916\u90e8\u8bbf\u95ee\u8c03\u7528\uff0c\u5982getPerson()\u3002\u4f46\u662fprotected\u4ec5\u9650\u4e8e\u5728\u7c7b\u6216\u5b50\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u3002\u800cprivate\u5c31\u53ea\u80fd\u5728\u7c7b\u81ea\u5df1\u5185\u90e8\u8c03\u7528\uff0c\u800c\u4e0d\u80fd\u5728\u5b83\u7684\u5b50\u7c7b\u4e2d\u3002 Drupal\u4e2d\u4e00\u822c\u58f0\u660e\u5c5e\u6027protected,\u65b9\u6cd5\u58f0\u660e\u4e3apublic\u6216protected\uff0cprivate\u4e00\u822c\u4e0d\u8d5e\u6210\u4f7f\u7528\u3002","title":"\u4e8c\u3001\u7c7b\u7684\u7ed3\u6784(class)"},{"location":"drupal/drupal8/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/#interface","text":"\u63a5\u53e3\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u62bd\u8c61\u7c7b\uff0c\u62bd\u8c61\u7c7b\u53c8\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7c7b\uff0c\u6240\u4ee5\u63a5\u53e3\u4e5f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7c7b\uff0c\u4e3a \u4ec0\u4e48\u8bf4\u63a5\u53e3\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u62bd\u8c61\u7c7b\u5462\uff1f\u5982\u679c\u4e00\u4e2a\u62bd\u8c61\u7c7b\u91cc\u9762\u7684\u6240\u6709\u7684\u65b9\u6cd5\u90fd\u662f\u62bd\u8c61\u65b9\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6362\u4e00\u79cd\u58f0\u660e\u65b9\u6cd5\u4f7f\u7528\u201c\u63a5\u53e3\u201d\uff1b\u4e5f\u5c31\u662f\u8bf4\u63a5\u53e3\u91cc\u9762\u6240\u6709\u7684\u65b9\u6cd5\u5fc5\u987b \u90fd\u662f\u58f0\u660e\u4e3a\u62bd\u8c61\u65b9\u6cd5\uff0c\u53e6\u5916\u63a5\u53e3\u91cc\u9762\u4e0d\u80fd\u58f0\u660e\u53d8\u91cf(\u4f46\u53ef\u58f0\u660e\u5e38\u91cfconstant)\uff0c\u800c\u4e14\u63a5\u53e3\u91cc\u9762\u6240\u6709\u7684\u6210\u5458\u90fd\u662fpublic\u6743\u9650\u7684\u3002\u6240\u4ee5\u5b50\u7c7b\u5728\u5b9e\u73b0\u7684\u65f6\u5019 \u4e5f\u4e00\u5b9a\u8981\u4f7f\u7528public\u6743\u9650\u5b9e\u9650\u3002 \u5728\u7c7b\u4e2d\uff0cPerson\u5b9a\u4e49\u7684\u5bf9\u8c61\u5927\u62b5\u662f\u8fd9\u6837\uff1a class Person { public function getPerson() {...} } \u90a3\u5982\u4f55\u5b9a\u4e49\u63a5\u53e3\u5462\uff1f interface PersonInterface { public function getPerson(); } class Person implements PersonInterface { public __construct($name, $sex, $age); public function getPerson() { /*..........*/ } } \u8fd9\u5c31\u50cf\u7528\u6237\u754c\u9762\u5b9a\u4e49\u4e86\u4eba\u548c\u7a0b\u5e8f\u5982\u4f55\u4ea4\u4e92\uff0c\u800c\u63a5\u53e3\u5b9a\u4e49\u4e86\u65b9\u6cd5\u548c\u5bf9\u8c61\u7684\u4ea4\u4e92\u8fc7\u7a0b\u3002\u5f53\u7136\u4f60\u4e0d\u80fd\u521b\u5efa\u4e00\u4e2a\u63a5\u53e3\u5bf9\u8c61\uff0c\u800c\u5fc5\u987b\u4e00\u4e2a\u63a5\u53e3\u7c7b\u3002 \u8bf4\u7b80\u5355\u70b9\u3002\u5c31\u662f---\u63a5\u53e3\u5b9a\u4e49\u4e86\u65b9\u6cd5\uff0c\u7c7b\u5b9e\u73b0\u4e86\u65b9\u6cd5\u3002","title":"\u4e09\u3001\u63a5\u53e3(interface)"},{"location":"drupal/drupal8/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/#constructor","text":"\u6211\u4eec\u518d\u6765\u770bPerson\u7c7b\u4e2d\u7684\u65b9\u6cd5__construct()\uff0c\u5b83\u662f\u7528\u4e24\u4e2a\u4e0b\u5212\u7ebf\u4f5c\u4e3a\u524d\u7f00\u3002\u8fd9\u662fPHP5\u4e2d\u5f15\u5165\u7684\u3002\u5f53\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528\u6784\u9020\u51fd\u6570\uff0c\u4e5f\u5c31\u662f\u7528new\u8fd9\u4e2a\u5173\u952e\u5b57\u5b9e\u4f8b\u5316\u5bf9\u8c61\u7684\u65f6\u5019\u81ea\u52a8\u8c03\u7528\u6784\u9020\u51fd\u6570\u3002 \u5728\u4e00\u4e2a\u7c7b\u4e2d\u53ea\u80fd\u58f0\u660e\u4e00\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u800c\u662f\u53ea\u6709\u5728\u6bcf\u6b21\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u90fd\u4f1a\u53bb\u8c03\u7528\u4e00\u6b21\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u80fd\u4e3b\u52a8\u7684\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6240\u4ee5\u901a\u5e38\u7528\u5b83\u6267\u884c\u4e00\u4e9b\u6709\u7528\u7684\u521d\u59cb\u5316\u4efb\u52a1\u3002\u6bd4\u5982\u5bf9\u6210\u5c5e\u6027\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u8d4b\u521d\u503c\u3002\u5982\u6211\u4eec\u4e0a\u9762\u7684\u4ee3\u7801\uff1a $myperson = new Person($name, $sex, $age); \u5b83\u662f\u5982\u4f55\u6267\u884c\u7684\u5462\uff1f 1\u3001\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2aPerson\u5bf9\u8c61 2\u3001\u7528new\u5173\u952e\u5b57\u8c03\u7528__construct\u65b9\u6cd5 3\u3001\u628aPerson\u5bf9\u8c61\u590d\u5236\u7ed9 this\u5c5e\u6027 4\u3001\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a this\u5c5e\u6027 4\u3001\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a myperson\u7684\u53d8\u91cf\uff0c\u4ed6\u5e76\u4e0d\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4ed6\u7528\u6765\u5904\u7406\u5bf9\u8c61 5\u3001\u628a$myperson\u6307\u5411\u5185\u5b58\u4e2d\u7684Person\u5bf9\u8c61 \u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u63a5\u53e3\u4e2d\u5b9a\u4e49\u6784\u9020\u65b9\u6cd5\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u4ee3\u7801\u903b\u8f91\u6df7\u4e71\uff01","title":"\u56db\u3001\u6784\u9020\u65b9\u6cd5(constructor)"},{"location":"drupal/drupal8/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/#inherit","text":"\u7ee7\u627f\u662fOOP\u7684\u4e00\u4e2a\u91cd\u8981\u7684\u7279\u6027\uff0c\u7ee7\u627f\u662f\u5b50\u7c7b\u81ea\u52a8\u5171\u4eab\u7236\u7c7b\u6570\u636e\u7ed3\u6784\u548c\u65b9\u6cd5\u7684\u673a\u5236\uff0c\u8fd9\u662f\u7c7b\u4e4b\u95f4\u7684\u4e00\u79cd\u5173\u7cfb\u3002\u5982\uff1a class Student extends Person { public function __construct($name, $sex, $age) { $this->name = $name; $this->sex = $sex; $this->age = $age; } } $mystudent = new Student($name, $sex, $age); \u8fd9\u91cc\u58f0\u660e\u4e86Student\u7c7b\u662fPerson\u7684\u5b50\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u6ca1\u6709\u5b9a\u4e49getPerson\u65b9\u6cd5\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2a\u65b9\u6cd5\u7ee7\u627f\u81eaPerson\u7c7b\uff0c\u5982 mystudent->getPerson()\u548c mystudent->getPerson()\u548c mypeson->getPerson()\u6267\u884c\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\u3002\u6211\u4eec\u8fd9\u91cc\u4e5f\u6ca1\u6709\u5b9a\u4e49$name, $sex, $age\u8fd9\u4e9b\u5c5e\u6027\uff0c\u4ed6\u4eec\u4e5f\u662f\u7ee7\u627f\u81eaPerson\u7236\u7c7b\u3002 \u5728C++\u8bed\u8a00\u4e2d\uff0c\u4e00\u4e2a\u6d3e\u751f\u7c7b\u53ef\u4ee5\u4ece\u4e00\u4e2a\u57fa\u7c7b\u6d3e\u751f\uff0c\u4e5f\u53ef\u4ee5\u4ece\u591a\u4e2a\u57fa\u7c7b\u6d3e\u751f\u3002\u4ece\u4e00\u4e2a\u57fa\u7c7b\u6d3e\u751f\u7684\u7ee7\u627f\u79f0\u4e3a\u5355\u7ee7\u627f\uff1b\u4ece\u591a\u4e2a\u57fa\u7c7b\u6d3e\u751f\u7684\u7ee7\u627f\u79f0\u4e3a\u591a\u7ee7\u627f\u3002 \u4f46\u662f\u5728PHP\u548cJava\u8bed\u8a00\u91cc\u9762\u6ca1\u6709\u591a\u7ee7\u627f\uff0c\u53ea\u6709\u5355\u7ee7\u627f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u7c7b\u53ea\u80fd\u76f4\u63a5\u4ece\u4e00\u4e2a\u7c7b\u4e2d\u7ee7\u627f\u6570\u636e\uff0c \u8fd9\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u5355\u7ee7\u627f\u3002","title":"\u4e94\u3001\u7ee7\u627f(inherit)"},{"location":"drupal/drupal8/Drupal%E5%AF%BC%E5%85%A5%E7%BF%BB%E8%AF%91/","tags":"[drush]","text":"\u6709\u7684\u65f6\u5019po\u6587\u4ef6\u592a\u5927\uff0c\u5bfc\u5165\u7684\u65f6\u5019\u4f1a\u51fa\u73b0503\u9519\u8bef\u3002\u8fd9\u662f\u56e0\u4e3aphp\u8bf7\u6c42\u8d85\u65f6\u4e86\u3002\u8fd8\u597d\uff0c\u6709drush,\u7528drush \u5bfc\u5165\u6587\u4ef6\u975e\u5e38\u7b80\u5355\u3002 drush dl drush_language Usage drush language-add <langcode> > Add and import a new language definition. drush language-enable <langcode> > Enable an existing language. drush language-disable <langcode> > Disable an enabled language. drush language-default <langcode> > Assign an enabled language as default. drush language-import <langcode> <file.po> [--replace] [--group=<text-group>] > Import a .po file to a language. drush language-export <langcode> <file.po> [--group=<text-group>] > Export a language to a .po file. \u6bd4\u5982\u5bfc\u5165\u4e00\u4e2a\u7ffb\u8bd1\u6587\u4ef6\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a drush language-import zh-hans xxxx/drupal-7.22.zh-hans.po","title":"Drupal\u5bfc\u5165\u7ffb\u8bd1"},{"location":"drupal/drupal8/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/","tags":["drupal","vue"],"text":"\u4e00\u3001\u4ec0\u4e48\u662fvue \u00b6 \u70b9\u51fb\u8fd9\u91cc \u8df3\u8f6cvue\u5b98\u7f51 Vue.js\uff08\u8bfb\u97f3 /vju\u02d0/, \u7c7b\u4f3c\u4e8e view\uff09 \u662f\u4e00\u5957\u6784\u5efa\u7528\u6237\u754c\u9762\u7684 \u6e10\u8fdb\u5f0f\u6846\u67b6\u3002\u4e0e\u5176\u4ed6\u91cd\u91cf\u7ea7\u6846\u67b6\u4e0d\u540c\u7684\u662f\uff0cVue \u91c7\u7528\u81ea\u5e95\u5411\u4e0a\u589e\u91cf\u5f00\u53d1\u7684\u8bbe\u8ba1\u3002 Vue \u7684\u6838\u5fc3\u5e93\u53ea\u5173\u6ce8\u89c6\u56fe\u5c42\uff0c\u5e76\u4e14\u975e\u5e38\u5bb9\u6613\u5b66\u4e60\uff0c\u975e\u5e38\u5bb9\u6613\u4e0e\u5176\u5b83\u5e93\u6216\u5df2\u6709\u9879\u76ee\u6574\u5408\u3002 \u4e8c\u3001drupal\u878d\u5408vue \u00b6 OK\uff0c\u65b0\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c cloud_system \uff0c\u521d\u59cb\u5316\u4e00\u4e2a vue \u5728 drupal \u4e2d\u7684\u6839\u6a21\u7248\uff0c\u5982\u4e0b\uff1a < div id = \"main-content\" > < router-view ></ router-view > </ div > \u8fd9\u6837\uff0c\u6240\u6709\u7684\u8def\u7531\u90fd\u8f93\u51fa\u8fd9\u4e2a\u6a21\u7248\uff0c\u4e4b\u540e\u524d\u7aef\u8def\u7531\u89e3\u6790\u586b\u5145 router-view \u4e09\u3001vue\u7684\u6a21\u5757\u5316\u5f00\u53d1 \u00b6 \u8be6\u89c1**vue\u5728drupal\u4e2d\u7684\u6a21\u5757\u5316\u5f00\u53d1**","title":"drupal8\u4e2d\u4f7f\u7528vue"},{"location":"drupal/drupal8/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/#vue","text":"\u70b9\u51fb\u8fd9\u91cc \u8df3\u8f6cvue\u5b98\u7f51 Vue.js\uff08\u8bfb\u97f3 /vju\u02d0/, \u7c7b\u4f3c\u4e8e view\uff09 \u662f\u4e00\u5957\u6784\u5efa\u7528\u6237\u754c\u9762\u7684 \u6e10\u8fdb\u5f0f\u6846\u67b6\u3002\u4e0e\u5176\u4ed6\u91cd\u91cf\u7ea7\u6846\u67b6\u4e0d\u540c\u7684\u662f\uff0cVue \u91c7\u7528\u81ea\u5e95\u5411\u4e0a\u589e\u91cf\u5f00\u53d1\u7684\u8bbe\u8ba1\u3002 Vue \u7684\u6838\u5fc3\u5e93\u53ea\u5173\u6ce8\u89c6\u56fe\u5c42\uff0c\u5e76\u4e14\u975e\u5e38\u5bb9\u6613\u5b66\u4e60\uff0c\u975e\u5e38\u5bb9\u6613\u4e0e\u5176\u5b83\u5e93\u6216\u5df2\u6709\u9879\u76ee\u6574\u5408\u3002","title":"\u4e00\u3001\u4ec0\u4e48\u662fvue"},{"location":"drupal/drupal8/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/#drupalvue","text":"OK\uff0c\u65b0\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c cloud_system \uff0c\u521d\u59cb\u5316\u4e00\u4e2a vue \u5728 drupal \u4e2d\u7684\u6839\u6a21\u7248\uff0c\u5982\u4e0b\uff1a < div id = \"main-content\" > < router-view ></ router-view > </ div > \u8fd9\u6837\uff0c\u6240\u6709\u7684\u8def\u7531\u90fd\u8f93\u51fa\u8fd9\u4e2a\u6a21\u7248\uff0c\u4e4b\u540e\u524d\u7aef\u8def\u7531\u89e3\u6790\u586b\u5145 router-view","title":"\u4e8c\u3001drupal\u878d\u5408vue"},{"location":"drupal/drupal8/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/#vue_1","text":"\u8be6\u89c1**vue\u5728drupal\u4e2d\u7684\u6a21\u5757\u5316\u5f00\u53d1**","title":"\u4e09\u3001vue\u7684\u6a21\u5757\u5316\u5f00\u53d1"},{"location":"drupal/drupal8/understanding-drupal8/","tags":"[drupal8]","text":"\u5982\u4f55\u5b66\u4e60drupal8\uff1f\u56fd\u5185\u6587\u6863\u5be5\u5be5\u53ef\u6570\uff0c\u540e\u53d1\u73b0\u8001\u5916\u7684\u4e00\u7bc7\u6587\u7ae0\uff0c\u53ef\u505a\u5165\u95e8\uff0c\u9042\u7ffb\u8bd1\u5982\u4e0b\u3002\u539f\u521b\u5185\u5bb9\uff0c\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\uff01 \u4e00\u3001\u7ed3\u6784 \u00b6 Drupal 8\u6765\u4e86\u3002\u8fd9\u662f\u4e00\u4e2a\u9769\u547d\uff01\u548cDrupal6\u5230Drupal7\u7684\u6f14\u5316\u4e0d\u540c\uff0c\u8fd9\u662f\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u67b6\u6784\u548c\u7f16\u7801\u65b9\u5f0f\u3002\u6211\u786e\u4fe1\u8fd9\u4e9b\u53d8\u5316\u5bf9\u4e13\u4e1a\u5316\u548c\u73b0\u4ee3\u5316CMS\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002\u6211\u76f8\u4fe1\u8f6c\u5411\u9762\u5411\u5bf9\u8c61\u5c06\u4f1a\u5438\u5f15\u5f00\u53d1\u8005\uff0c\u5e76\u5c06\u63d0\u5347\u8f6f\u4ef6\u7684\u6574\u4f53\u8d28\u91cf\u3002\u6211\u611f\u8c22Drupal\u5185\u6838\u5f00\u53d1\u8005\u7684\u52c7\u6c14\u4ee5\u53ca\u4e3a\u6b64\u6240\u505a\u7684\u5de5\u4f5c\u3002 \u7136\u800c\uff0c\u5bf9\u4e8e\u73b0\u6709\uff08\u5305\u62ec\u65b0\u7684\uff09Web\u5f00\u53d1\u8005\uff0c\u5b66\u4e60drupal\u5c06\u662f\u4e00\u4e2a\u5de8\u5927\u7684\u6311\u6218\u3002\u901a\u8fc7\u9605\u8bfb\u8fd9\u7bc7\u6587\u7ae0\uff0c\u60a8\u5c06\u66f4\u5177\u4f18\u52bf\u3002\u5728\u4f60\u6df1\u5165Drupal 8\u6a21\u5757\u5f00\u53d1\u524d\uff0c\u8fd9\u7bc7\u6587\u7ae0\u4f1a\u7ed9\u4f60\u5e26\u53bb\u4e9b\u8bb8\u542f\u793a\u3002\u5728\u6211\u5199\u4e0b\u8fd9\u7bc7\u6587\u7ae0\u4e4b\u524d\uff0c\u6211\u82b1\u4e86\u6570\u5929\uff0c\u901a\u8fc7\u4e00\u6b65\u6b65\u7684\u8c03\u8bd5\u3001\u9605\u8bfb\u4ee3\u7801\u548c\u5728\u7ebf\u6587\u7ae0\uff0c\u6df1\u5165\u5730\u5b66\u4e60\u4e86symfony2 \u548c Drupal8\u3002\u6211\u662f\u4e00\u4e2a\u7ecf\u9a8c\u4e30\u5bcc\u7684Drupal7\u5f00\u53d1\u8005\uff0c\u4f46\u662f\u5bf9symfony\u4e00\u65e0\u6240\u77e5\uff0c\u5e76\u4e14\u81f3\u4eca\u6ca1\u6709\u5bf9Druapl8\u5185\u6838\u6709\u6240\u8d21\u732e\u3002\u6211\u76f8\u4fe1\uff0c\u901a\u8fc7\u5206\u4eab\u6211\u6240\u5b66\u5230\u7684\uff0c\u4e5f\u80fd\u52a9\u4f60\u63d0\u5347\u5bf9\u5b83\u7684\u7406\u89e3\u3002 \u5728\u63a5\u4e0b\u6765\u7684\u56db\u5468\u91cc\uff0c\u8fd9\u7bc7\u6587\u7ae0\u5c06\u53d1\u5e03\u6210\u56db\u90e8\u5206\u3002\u5728\u8fd9\u7b2c\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u4e00\u77a5Drupal 8 \u6846\u67b6\u7684\u603b\u4f53\u67b6\u6784\uff0c\u7279\u522b\u662f\u4e0esymfony2 \u7ec4\u4ef6\u7684\u8054\u7cfb\u3002\u6211\u4eec\u5c06\u770b\u5230\u54ea\u4e9bsymfony2 \u7ec4\u4ef6\u5728Drupal\u4e2d\u7528\u5230\u4e86\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u3002\u5728\u4e0b\u4e00\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5b66\u4e60\u975e\u5e38\u91cd\u8981\u7684\u7c7b\u5bb9\u5668\u3002\u5728\u7b2c\u4e09\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5b66\u4e60Drupal 8 \u7684\u5f15\u5bfc\u548c\u8def\u7531\u3002\u4f60\u5c06\u5b66\u5230\u5982\u4f55\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u3002\u5728\u7b2c\u56db\u4e5f\u662f\u6700\u540e\u4e00\u90e8\u5206\uff0c\u5c06\u4f1a\u4ecb\u7ecddrupal 8\u7684\u5176\u5b83\u4e00\u4e9b\u4ee4\u4eba\u5174\u594b\u7684\u3001\u5168\u65b0\u7684\u7279\u6027\u3002 1\u3001Symfony2 \u00b6 Symfony\u6846\u67b6\u88ab\u8bbe\u8ba1\u7528\u6765\u4f7f\u5f00\u53d1\u8005\u80fd\u591f\u6784\u5efa\u81ea\u5b9a\u4e49\u7684Web\u5e94\u7528\u3002Symfony\u4e0d\u662f\u4e00\u4e2aCMS\uff0c\u56e0\u4e3a\u5b83\u4e0d\u80fd\u7528\u6765\u7ba1\u7406\u4e00\u4e2a\u7ad9\u70b9\u3002\u76f8\u53cd\uff0c\u8981\u6784\u5efa\u5e94\u7528\uff0c\u5fc5\u987b\u8981\u5199\u4ee3\u7801\u3002\u4e3a\u6b64\uff0csymfony\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u6cd5\u4f7f\u5f00\u53d1\u66f4\u5177\u6548\u7387\u3002\u7406\u8bba\u4e0a\uff0cCMS\u53ef\u4ee5\u57fa\u4e8eSymfony\u5f00\u53d1\uff0c\u4f46\u4e8b\u5b9e\u4e0a\uff0cSymfony\u7684\u9ed8\u8ba4\u65b9\u5f0f\u5bf9Drupal\u6765\u8bf4\u5e76\u4e0d\u7075\u6d3b\u3002 \u56e0\u6b64\uff0cDrupal 8\u53ea\u91c7\u7528\u4e86Symfony\u7684\u975e\u5e38\u4f18\u79c0\u7684\u5185\u6838\u5c42\uff0c\u5e76\u4e14\u6269\u5c55\u5b83\u4ee5\u652f\u6301Drupal\u6a21\u5757\u3002\u8fd9\u4fc3\u751f\u4e86\u4e00\u4e2a\u975e\u5e38\u5e73\u8861\u7684\u7cfb\u7edf\uff0c\u5b83\u91c7\u7528Symfony\u90e8\u5206\u4f18\u79c0\u7684\u5185\u6838\uff08\u800c\u4e14\u672a\u7ecf\u4fee\u6539\uff09\uff0c\u4f46\u662f\u53ef\u4ee5\u57fa\u4e8e\u4e00\u4e2a\u975e\u5e38\u7075\u6d3b\u7684CMS\u5c42\u6269\u5c55\u5b83\u3002 2\u3001\u7ec4\u4ef6 \u00b6 Symfony\u6846\u67b6\u7531\u6570\u4e2a\u7ec4\u4ef6\u6784\u6210\u3002\u6709\u4e9b\u5bf9\u7cfb\u7edf\u662f\u81f3\u5173\u91cd\u8981\u7684\uff0c\u4f8b\u5982\u80fd\u7406\u89e3HTTP\u534f\u8bae\u5e76\u4e14\u4e3a\u5176\u4ed6\u7ec4\u4ef6\u63d0\u4f9b\u826f\u597drequest\u548cresponse\u5bf9\u8c61\u7684Http Foundation\u7ec4\u4ef6\u3002\u5176\u4ed6\u7684\u4ec5\u662f\u8f85\u52a9\u7ec4\u4ef6\uff0c\u4f8b\u5982\u6821\u9a8c\u6570\u636e\u7684Validator\u7ec4\u4ef6\uff08\u68c0\u6d4b\u662f\u5426\u662f\u5408\u6cd5\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740/URL/\u6570\u5b57/\u7b49\u7b49\uff1f\uff09\u3002\u7cfb\u7edf\u7684\u6838\u5fc3\u662fKernel\u7ec4\u4ef6\u3002\u8fd9\u4e2a\u5185\u6838\u603b\u7684\u6765\u8bf4\u5c31\u662f\u4e00\u4e2a\u4e3b\u7c7b\uff0c\u5b83\u7ba1\u7406\u73af\u5883\uff08\u7c7b\u548c\u7a0b\u5e8f\u96c6\uff09\u5e76\u8d1f\u8d23\u5904\u7406http\u8bf7\u6c42\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u6269\u5c55\u5185\u6838\u6765\u6269\u5c55\u7cfb\u7edf\uff0c\u4f8b\u5982AppKernal\u5c31\u662f\u6269\u5c55\u4e86Kernal\uff0c\u5e76\u4e14\u5728\u91cc\u9762\u6dfb\u52a0\u4e86\u81ea\u5df1\u7684\u7a0b\u5e8f\u96c6\u3002\u8fd9\u4e9b\u7a0b\u5e8f\u96c6\u53ef\u4ee5\u6784\u5efa\u4e00\u7cfb\u5217\u8fde\u8d2f\u7684\u529f\u80fd\u96c6\u5408\uff0c\u975e\u5e38\u7c7b\u4f3c\u4e8eDrupal\u7684\u6a21\u5757\u3002 Drupal\u53ea\u4f7f\u7528\u4e86Symfony\u7684\u4e00\u90e8\u5206\u7ec4\u4ef6\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 3\u3001Drupal 8\u5982\u4f55\u6269\u5c55Symfony \u00b6 Drupal\u4e0d\u6269\u5c55\u5185\u6838\uff0c\u800cSymfony\u5e94\u7528\u4f1a\u3002\u901a\u8fc7\u5b9e\u73b0\u5185\u6838\u63a5\u53e3\uff0cDrupal\u63d0\u4f9b\u4e86\u76f8\u4f3c\u7684\u529f\u80fd\u7c7b\u578b\u3002\u8fd9\u662f\u56e0\u4e3aDrupal\u4e0d\u5171\u4eabSymfony\u7684\u7a0b\u5e8f\u96c6\u65b9\u6cd5\u3002\u7a0b\u5e8f\u96c6\u63d0\u4f9b\u4e86\u6781\u597d\u7684\u65b9\u5f0f\u6765\u6784\u5efa\u81ea\u5b9a\u4e49\u7684web\u5e94\u7528\uff0c\u4f46\u662f\u4e0d\u9002\u5408\u6784\u5efa\u9700\u8981\u7075\u6d3b\u6027\u548c\u6269\u5c55\u6027\u7684CMS\u3002DrupalKernal\u52a0\u8f7d\u73af\u5883\uff08\u53ef\u7528\u7684\u7c7b\u548c\u6a21\u5757\uff09\u7684\u65b9\u5f0f\u4e0eKernal\u7a0d\u5fae\u4e0d\u540c\uff0c\u4f46\u662f\u548cSymfony Kernal\u4e00\u6837\uff0c\u90fd\u662f\u628a\u5c06http\u8bf7\u6c42\u59d4\u6258\u7ed9HttpKernel\u3002 \u4e0e\u6b64\u540c\u65f6\uff0cDrupal 8\u5f15\u5165\u4e86\u81ea\u5df1\u7684\uff08\u7b2c\u4e09\u65b9\uff09\u7ec4\u4ef6\u548c\u6838\u5fc3\u4ee3\u7801\uff0c\u793a\u610f\u6982\u89c8\u5982\u4e0b\u56fe\u6240\u793a\uff1a 4\u3001\u7ed3\u8bba \u00b6 \u8fd9\u91cc\u603b\u7ed3\u4e86\u201c\u5f00\u59cb\u5b66\u4e60Drupal 8\u201d\u8fd9\u7bc7\u6587\u7ae0\u3002\u4e0b\u5468\u6211\u4eec\u5c06\u5f00\u59cb\u5b66\u4e60\u7c7b\u5bb9\u5668\uff0c\u53ef\u4ee5\u7406\u89e3\u6210Drupal\u7cfb\u7edf\u7684\u9aa8\u67b6\u3002\u5728\u7406\u89e3\u4efb\u4f55\u5176\u4ed6\u7ec4\u4ef6\u524d\u4f60\u5fc5\u987b\u5148\u4e86\u89e3\u5b83\u3002 \u4e8c\u3001\u670d\u52a1\u5bb9\u5668 \u00b6 \u8fd9\u662f\u201c\u7406\u89e3Drupal 8\u201d\u7684\u7b2c\u4e8c\u90e8\u5206\u3002\u5728\u7b2c\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86Drupal 8\u7684\u603b\u4f53\u67b6\u6784\u4ee5\u53ca\u5b83\u4e0eSymfony\u7684\u5173\u8054\u3002Symfony\uff08\u548cDrupal 8\uff09\u5305\u542b\u7740\u8bb8\u591a\u7ec4\u4ef6\u3002\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\uff0c\u4f60\u5c06\u4f1a\u5b66\u4e60\u5230\u4ec0\u4e48\u662f\u670d\u52a1\u5bb9\u5668\uff0c\u4ee5\u53ca\u5728Drupal 8\u4e2d\u600e\u4e48\u4f7f\u7528\u5b83\u3002\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\uff0c\u5728\u5b66\u4e60\u8def\u7531\u4e4b\u524d\u6211\u4eec\u5f97\u5148\u7406\u89e3\u670d\u52a1\u5bb9\u5668\u3002 Symfony\u91c7\u7528\u4e86\u670d\u52a1\u5668\u5bb9\u5668\uff0c\u5b83\u53ef\u4ee5\u9ad8\u6548\u5730\u7ba1\u7406\u5e94\u7528\u4e2d\u7684services\u3002\u8fd9\u4e2a\u6982\u5ff5\u4e5f\u5c31\u662f\u6240\u8c13\u7684Dependency Injection\u3002 \u670d\u52a1\u5bb9\u5668\u662f\u4e00\u4e2a\u5728\u5904\u7406\u8bf7\u6c42\u4e4b\u524d\u7531Kernal\u521b\u5efa\u5e76\u5305\u542b\u7684\u5168\u5c40\u5bf9\u8c61\u3002\u5b83\u80fd\u88ab\u7528\u6765\u83b7\u53d6\u670d\u52a1\uff0c\u52a8\u6001\u52a0\u8f7d\u670d\u52a1\u3002\u670d\u52a1\u662f\u7528\u4e8e\u5b8c\u6210\u7279\u5b9a\u4efb\u52a1\u7684\u5168\u5c40\u5bf9\u8c61\uff0c\u4f8b\u5982\u90ae\u4ef6\u670d\u52a1\u6216\u6570\u636e\u5e93\u8fde\u63a5\u3002\u4e00\u4e2a\u670d\u52a1\u5bf9\u5e94\u7740\u4e00\u4e2a\u786e\u5207\u7684\u7c7b\u3002\u670d\u52a1\u5bb9\u5668\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u5305\u542b\u53ef\u7528\u670d\u52a1\uff0c\u77e5\u9053\u5b83\u4eec\u7684\u8054\u7cfb\u548c\u914d\u7f6e\u4fe1\u606f\uff0c\u751a\u81f3\u6784\u9020\u5b83\u4eec\u3002 1\u3001\u4f9d\u8d56\u548c\u53c2\u6570 \u00b6 \u4e00\u4e2a\u670d\u52a1\u53ef\u80fd\u4f9d\u8d56\u4e8e\u5176\u4ed6\u670d\u52a1\u3002Symfony\u6587\u6863\u4e3e\u4e86\u4e2a\u901a\u8baf\u7ba1\u7406\u670d\u52a1\u4f9d\u8d56\u90ae\u4ef6\u670d\u52a1\u6765\u53d1\u9001\u90ae\u4ef6\u7684\u4f8b\u5b50\u3002\u670d\u52a1\u5bb9\u4e5f\u7ba1\u7406\u7740\u8fd9\u4e9b\u4f9d\u8d56\u3002\u5f53\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u65f6\uff0c\u5b83\u7684\u4f9d\u8d56\u4f1a\u901a\u8fc7\u7c7b\u6784\u9020\u5668\u4e2d\u7684\u53c2\u6570\u8fdb\u884c\u4f20\u9012\u3002\u63a5\u53e3\u7528\u6765\u5b9a\u4e49\u4f9d\u8d56\u670d\u52a1\u8981\u63d0\u4f9b\u54ea\u4e9b\u65b9\u6cd5\uff0c\u8fd9\u6837\u5b9e\u73b0\u7684\u8fd9\u4e2a\u670d\u52a1\u624d\u80fd\u5728\u5fc5\u8981\u65f6\u4e0e\u53e6\u4e00\u4e2a\u670d\u52a1\u8fdb\u884c\u4ea4\u6362\u3002 2\u3001\u914d\u7f6e \u00b6 \u670d\u52a1\u5bb9\u5668\u4e2d\u7684\u670d\u52a1\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u8fdb\u884c\u914d\u7f6e\uff1a\u4ee3\u7801\uff08\u6240\u8c13\u7684\u6269\u5c55\uff09\uff0cXML\uff0cYAML\uff0c\u7b49\u7b49\u3002Symfony\u6df7\u5408\u7740\u4f7f\u7528\u8fd9\u4e9b\u65b9\u5f0f\uff0c\u4f46\u662f\u628a\u5927\u591a\u6570\u6838\u5fc3\u670d\u52a1\u914d\u7f6e\u7559\u7ed9\u4e86\u7a0b\u5e8f\u96c6\u4ee3\u7801\u3002Drupal\u7684\u670d\u52a1\u914d\u7f6e\u5219\u4e0d\u540c\uff0c\u5927\u90e8\u5206\u57fa\u4e8eyaml\u6587\u4ef6\u3002Drupal\u4f7f\u7528services.core.yml\u6765\u5173\u8054\u6240\u6709\u4e0e\u5185\u6838\u76f8\u5173\u7684\u914d\u7f6e\u3002\u8fd9\u4e2a\u914d\u7f6e\u53ef\u4ee5\u88ab\u6a21\u5757\u548cServiceProvider\u7c7b\u6269\u5c55\u3002 YAML\u63d0\u4f9b\u4e86\u53ef\u8bfb\u7684\u548c\u7075\u6d3b\u7684\u8bed\u6cd5\u3002Drupal 8\u4e2d\u7684\u4e00\u4e2a\u4f8b\u5b50\uff08\u6458\u81easervices.core.yml\uff09\uff1a services: ... router_listener: class: Symfony\\Component\\HttpKernel\\EventListener\\RouterListener tags: - { name: event_subscriber } arguments: ['@router'] ... router: class: Symfony\\Cmf\\Component\\Routing\\ChainRouter calls: - [setContext, ['@router.request_context']] - [add, ['@router.dynamic']] ... \u8fd9\u91cc\u5b9a\u4e49\u4e86router_listener\u670d\u52a1\u3002\u5bf9\u5e94\u7684\u7c7b\u8981\u6c42\u80fd\u591f\u52a0\u8f7d\u8fd9\u4e2a\u76d1\u542c\u5668\u3002arguments\u5c5e\u6027\u5b9a\u4e49\u4e86RouterListener \u6784\u9020\u5668\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff08URL\u6216\u8bf7\u6c42\u5339\u914d\u5668\uff09\u5e94\u8be5\u662fservice id\u662frouter\u7684\u670d\u52a1\uff1a\u2018 @router \u2019\u3002\u8fd9\u4e2a\u8def\u7531\u4e5f\u88ab\u5b9a\u4e49\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u800c\u4e14\u662f\u4e00\u4e2a\u4e0d\u540c\u4e8eSymfony\u4e2d\u4f7f\u7528\u7684\u2018\u7c7b\u2019\u3002 3\u3001\u6807\u7b7e\u5316\u7684\u670d\u52a1 \u00b6 \u6807\u7b7e\u88ab\u7528\u6765\u52a0\u8f7d\u7279\u5b9a\u7684\u6807\u7b7e\u5316\u7684\u670d\u52a1\u3002\u5728\u5b9e\u8df5\u4e2d\uff0cdrupal\u6709\u65f6\u4f7f\u7528\u94a9\u5b50\u65b9\u5f0f\u3002\u5728\u4ee5\u4e0b\u4f8b\u5b50\u4e2d\uff08node.services.yml\uff09\uff0cnode\u6a21\u5757\u4e3a'add node'\u9875\u9762\u589e\u52a0\u4e86\u4e00\u4e2a\u8bbf\u95ee\u68c0\u67e5\uff0c\u57fa\u4e8eaccess_check\u670d\u52a1\u6a21\u5f0f\uff0c\u5f53\u8bbf\u95ee\u65f6\uff0c\u5c06\u4f1a\u68c0\u67e5\u8bbf\u95ee\u662f\u5426\u88ab\u5141\u8bb8\u3002 services: ... access_check.node.add: class: Drupal\\node\\Access\\NodeAddAccessCheck arguments: ['@plugin.manager.entity'] tags: - { name: access_check } ... 4\u3001Compiler passes \u00b6 Drupal\u662f\u5982\u4f55\u7406\u89e3\u8fd9\u4e9b\u6807\u7b7e\u4ee5\u53ca\u5982\u4f55\u5904\u7406\u5b83\u4eec\u7684\u5462\uff1f\u597d\uff0cSymfony\u5df2\u7ecf\u6709\u53e6\u5916\u4e00\u79cd\u52a8\u6001\u914d\u7f6e\u670d\u52a1\u5bb9\u5668\u7684\u65b9\u6cd5\uff1aCompiler pasess\u3002\u670d\u52a1\u5bb9\u5668\u5b9e\u9645\u4e0a\u5728\u7528\u9759\u6001\u914d\u7f6e\u6784\u5efa\u4e4b\u540e\u5c31\u88ab\u7f16\u8bd1\u4e86\u3002\u5728\u8fd9\u4e2a\u671f\u95f4\uff0c\u5b83\u5141\u8bb8\u5bf9\u8c61\u5b9e\u73b0CompilerPassInterface \u7c7b\u6765\u66f4\u6539\u914d\u7f6e\u3002\u5728Drupal\u4e2d\uff0cCoreServiceProvider \u6ce8\u518c\u4e86\u4e00\u4e9b\u975e\u5e38\u91cd\u8981\u7684Compiler pasess\uff0c\u4f8b\u5982RegisterAccessChecksPass\uff0c\u5b83\u4f1a\u8bd5\u56fe\u627e\u5230\u6240\u6709\u52a0\u4e86access_check\u6807\u7b7e\u7684\u670d\u52a1\uff08\u89c1\u4e0a\u4f8b\uff09\u7136\u540e\u628a\u5b83\u6dfb\u52a0\u5230AccessManager\uff08\u901a\u8fc7\u4f7f\u7528addMethodCall\u5bb9\u5668\u6307\u4ee4\uff09\u4e2d\u3002\u5728\u8def\u7531\u9636\u6bb5\uff0cAccessManager \u4f1a\u68c0\u67e5\u8bbf\u95ee\u6743\u9650\uff0c\u5b83\u5c06\u5728\u5176\u4ed6\u7c7b\u4e4b\u95f4\u68c0\u67e5NodeAddAccessCheck\u3002\u5728drupal\u5185\u6838\u4e2d\u8fd8\u6709\u51e0\u4e2a\u5176\u4ed6\u7684Compiler pasess\uff0c\u4f8b\u5982\u7528\u4e8e\u5c06\u8def\u7531\u53c2\u6570\u8f6c\u6362\u6210\u5bf9\u8c61\u548c\u8f6c\u4e49\u5b57\u7b26\u4e32\u7684Compiler passes\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u4f60\u6709\u65f6\u9700\u8981\u5728\u6a21\u5757\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u6807\u7b7e\u5316\u7684\u670d\u52a1\u6765\u589e\u52a0\u81ea\u5b9a\u4e49\u8bbf\u95ee\u6821\u9a8c\uff0c\u8f6c\u6362\u8def\u5f84\u53c2\u6570\u3002 5\u3001Swapping services \u00b6 \u670d\u52a1\u5bb9\u5668\u4f7f\u7075\u6d3b\u7684\u670d\u52a1\u914d\u7f6e\u6210\u4e3a\u53ef\u80fd\u3002Drupal 8\u4f7f\u7528\u670d\u52a1\u53c2\u6570\u6539\u53d8\u4e86Symfony\u4f7f\u7528\u8fd9\u4e9b\u53c2\u6570\u5b9e\u73b0\u81ea\u5df1\u529f\u80fd\u7684\u65b9\u5f0f\u3002\u4f8b\u5982\uff0cdrupal\u9700\u8981\u4e00\u4e2a\u4e0d\u540c\u4e8eSymfony\u7684url\u8def\u7531\u673a\u5236\u3002\u4e0eSymfony\u7684(Symfony\\Bundle\\FrameworkBundle\\Routing\\Router)\u76f8\u6bd4\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e0d\u540c\u7684\u8def\u7531\u670d\u52a1(Symfony\\Cmf\\Component\\Routing\\ChainRouter)\u6765\u5b9e\u73b0\u3002\u800c\u8fd9\u4e2a \u4e0d\u9700\u8981\u6539\u53d8router_listerner (Symfony\\Component\\HttpKernel\\EventListener\\RouterListener)\u7c7b\u672c\u8eab\u7684\u4efb\u4f55\u4e00\u884c\u4ee3\u7801\u3002\u7531\u4e8e\u4e24\u4e2a\u8def\u7531\u90fd\u5b9e\u73b0\u4e86RequestMatcherInterface\u63a5\u53e3\uff0c\u800c\u8fd9\u4e2a\u63a5\u53e3\u662fRouterListener\u7684\u7b2c\u4e00\u4e2a\u5fc5\u8981\u53c2\u6570\uff0c\u6240\u4ee5\u8fd9\u4e2a\u662f\u53ef\u4ee5\u5b9e\u73b0\u7684\u3002 6\u3001\u7ed3\u8bba \u00b6 \u5728\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5b66\u4e60\u4e86Drupal 8 \u7684\u670d\u52a1\u5bb9\u5668\u7ec4\u4ef6\u3002\u73b0\u5728\uff0c\u4f60\u5bf9Drupal8\u4e0d\u4fee\u6539\u4e00\u884c\u4ee3\u7801\u5b9e\u73b0\u81ea\u5df1\u7684\u670d\u52a1\u66ff\u6362Symfony2\u7684\u670d\u52a1\u5e94\u8be5\u6709\u4e86\u66f4\u597d\u7684\u8ba4\u8bc6\u3002\u8fd9\u5141\u8bb8drupal\u5185\u6838\u7ef4\u62a4\u8005\u8f7b\u677e\u5730\u5347\u7ea7Symfony2\u3002\u5f53\u5b66\u4e60Drupal 8\u65f6\uff0c\u4f60\u4f1a\u7ecf\u5e38\u7ffb\u9605core.services.yml\u6587\u4ef6\u67e5\u627e\u6b63\u5728\u4f7f\u7528\u7684\u670d\u52a1\u3002 \u4e0b\u5468\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5b66\u4e60Drupal 8\u7684\u63a7\u5236\u6d41\u7a0b\u548c\u8def\u7531\u3002 \u4e09\u3001\u8def\u7531 \u00b6 \u8fd9\u662f'\u7406\u89e3drupal8'\u7684\u7b2c\u4e09\u90e8\u5206\uff0c\u5728\u524d2\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5b66\u4e60\u4e86drupal8\u548cSymfony\u7684\u7ed3\u6784\u5316\u5dee\u5f02\u3002\u8fd9\u90e8\u5206\u6211\u4eec\u5c06\u5b66\u4e60drupal8\u5982\u4f55\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u3002\u9996\u5148\uff0c\u6211\u4eec\u5c06\u770b\u4e0b\u5f15\u5bfc\u9636\u6bb5\u4ee5\u53ca\u63a7\u5236\u6d41\u7a0b\uff0c\u7136\u540e\u6211\u4eec\u5c06\u4f1a\u5b66\u4e60\u4e8b\u4ef6\u8ba2\u9605\uff0c\u8fd9\u662f\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u9700\u8981\u4f60\u5728\u5b66\u4e60\u8bf7\u6c42\u5904\u7406\u4e4b\u524d\u5c31\u7406\u89e3\u5b83\u3002 1\u3001\u6d41\u7a0b\u63a7\u5236(Flow of control) \u00b6 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u5b66\u4e60\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\u4e4b\u540e\uff0cdrupal8\u662f\u5982\u4f55\u5904\u7406\u7684\u3002 1)\u3001bootstrap\u914d\u7f6e \u00b6 \u2460\u3001\u8bfb\u53d6settings.php\u6587\u4ef6\uff08\u4e00\u822c\u5728sites/default/\u4e0b\uff09\uff0c\u52a8\u6001\u751f\u6210\u4e00\u4e9b\u5176\u5b83\u8bbe\u7f6e\u4fe1\u606f\uff0c\u4fdd\u5b58\u5230\u5168\u5c40\u53d8\u91cf\u548cDrupal\\Component\\Utility\\Settings\u5bf9\u8c61\u4e2d\u3002 \u2461\u3001\u6267\u884c\u7c7b\u52a0\u8f7d\u5668(class loader)\uff0c\u52a0\u8f7d\u7c7b\u3002 \u2462\u3001\u8bbe\u7f6eDrupal\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002 \u2463\u3001\u68c0\u6d4bDrupal\u662f\u5426\u6b63\u786e\u5b89\u88c5\uff0c\u5982\u6ca1\u6709\uff0c\u5219\u8df3\u8f6c\u5230\u5b89\u88c5\u754c\u9762\u3002 2)\u3001\u6784\u5efaDrupal\u5185\u6838 \u00b6 3)\u3001\u521d\u59cb\u5316service container\uff08\u4ece\u7f13\u5b58\u6216\u8005\u91cd\u5efa\uff09 \u00b6 4)\u3001\u628acontainer\u6dfb\u52a0\u5230Drupal\u9759\u6001\u7c7b \u00b6 5)\u3001\u5c1d\u8bd5\u52a0\u8f7d\u7f13\u5b58\u7684\u9759\u6001\u9875(\u7c7b\u4f3cDrupal7) \u00b6 6)\u3001\u52a0\u8f7d\u6240\u6709\u53d8\u91cf(variable_get) \uff1f\u8fd9\u4e2a\u51fd\u6570\u5df2\u7ecf\u53bb\u6389\u4e86 \u00b6 7)\u3001\u52a0\u8f7d\u5176\u4ed6\u5fc5\u8981\u7684\u6587\u4ef6 \u00b6 8)\u3001\u6ce8\u518cstream wrappers(public://, private://, temp://\uff0c\u81ea\u5b9a\u4e49) \u00b6 9)\u3001\u521b\u5efaHTTP\u8bf7\u6c42\u5bf9\u8c61\uff08\u4f7f\u7528Symfony HttpFoundation\uff09 \u00b6 10)\u3001DrupalKernel\u5904\u7406\u5e76\u8fd4\u56de\u7ed3\u679c \u00b6 11)\u3001\u53d1\u9001\u8fd4\u56de\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef \u00b6 12)\u3001\u4e2d\u65ad\u8bf7\u6c42 \u00b6 \u5176\u4e2d\u6700\u503c\u5f97\u63a2\u8ba8\u7684\u662f\u5728\u8bf7\u6c42\u5904\u7406\u9636\u6bb5\u7a76\u7adf\u53d1\u751f\u4e86\u4ec0\u4e48?\u8981\u4e86\u89e3\u8fd9\u70b9\uff0c\u6211\u4eec\u5148\u6765\u5b66\u4e60\u4e8b\u4ef6\u76d1\u542c\u3002 2\u3001\u4e8b\u4ef6\u8ba2\u9605(Event subscribers) \u00b6 \u4e4b\u524d\uff0c\u6211\u4eec\u63a2\u8ba8\u4e86Compiler passes\u3002\u6807\u7b7e\u5316\u670d\u52a1\u4e00\u4e2a\u6700\u91cd\u8981\u7684\u7528\u5904\u5c31\u662f\uff0cevent_subscriber-tagged\u670d\u52a1\u3002\u8fd9\u4e9b\u670d\u52a1\u5e94\u8be5\u5b9e\u73b0\u4e86EventSubscriberInterface\uff0c\u5e76\u4e14\u57fa\u672c\u4e0a\u90fd\u662f\u4e8b\u4ef6\u76d1\u542c\u5668\u3002\u4e8b\u4ef6\u4f1a\u58f0\u660e\u4e00\u4e2agetSubscribedEvents\u65b9\u6cd5\u5b9a\u4e49\u54ea\u4e2a\u4e8b\u4ef6\u5e94\u8be5\u6620\u5c04\u5230\u54ea\u4e2a\u5904\u7406\u65b9\u6cd5\uff0c\u5e76\u8bbe\u7f6e\u4e00\u4e2a\u5c5e\u6027\u6765\u51b3\u5b9a\u4e8b\u4ef6\u52a8\u4f5c\u6267\u884c\u7684\u987a\u5e8f\u3002\u5728Drupal\u6838\u5fc3\u4e2d\u53ea\u6709\u5c11\u6570\u4e8b\u4ef6\u5728\u8c03\u7528\uff1a \u2460\u3001kernel.request \u8bf7\u6c42\u5206\u53d1\u7684\u6700\u521d\u9636\u6bb5\u8c03\u7528 \u2461\u3001kernel.response \u8bf7\u6c42\u54cd\u5e94\u7684\u65f6\u5019\u8c03\u7528 \u2462\u3001routing.route_dynamic \u5141\u8bb8\u6a21\u5757\u52a0\u8f7d\u989d\u5916\u7684\u8def\u7531 \u2463\u3001routing.route_alter \u5141\u8bb8\u5728route collection\u4e2d\u6539\u53d8routes\u3002\u4e3b\u8981\u7528\u4e8e\u6838\u5fc3\u6dfb\u52a0\u4e00\u4e9b\u6821\u9a8c\u548c\u53c2\u6570\u8f6c\u6362\u3002 \u6bcf\u4e2aDrupal\u5f00\u53d1\u8005\u90fd\u5e94\u8be5\u4e86\u89e3\u4e8b\u4ef6\u8ba2\u9605\u3002\u5c24\u5176\u662fkernel.request\uff0c\u56e0\u4e3a\u5b83\u66ff\u6362\u4e86hook_init(Drupal7)\u3002\u53e6\u5916\u4e00\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u4e8b\u4ef6\u662frouting.route_dynamic\u4e8b\u4ef6\u3002\u56e0\u4e3a\u5b83\u53ef\u4ee5\u521b\u5efa\u52a8\u6001\u8def\u7531\uff0c\u800c\u4e00\u822c\u8def\u7531\u662f\u5728yaml\u6587\u4ef6\u4e2d\u9759\u6001\u914d\u7f6e\u7684\u3002\u5728Drupal8\u4e4b\u524d\uff0c\u90fd\u662f\u5728hook_menu\u4e2d\u5b9e\u73b0\uff0c\u4f46\u73b0\u5728hook_menu\u4ec5\u7528\u4e8e\u751f\u6210\u83dc\u5355\u9879\u3002\u5982block\u6a21\u5757\u5728\\Drupal\\block\\Routing\\RouteSubscriber\u7528 routing.route_dynamic\u6ce8\u518c\u8def\u7531\u7528\u4e8e\u533a\u5757\u914d\u7f6e\u9875\u9762\u3002 \u4f60\u53ef\u80fd\u4f1a\u5947\u602a\u4e8b\u4ef6\u8ba2\u9605\u5e72\u561b\u4e0d\u7528hook\u5462\uff1f\u56e0\u4e3a\u8fd9\u662f\u4e00\u79cd\u5f88\u6709\u6548\u7684\u65b9\u5f0f\uff0c\u6240\u6709\u53ef\u7528\u7684\u4e8b\u4ef6\u76d1\u542c\u90fd\u5df2\u7ecf\u7f16\u8bd1\u5230\u4e86\u670d\u52a1\u5bb9\u5668\u4e2d\uff0c\u800c\u4e14\u8fd8\u88ab\u7f13\u5b58\u7740\uff01\u540c\u65f6\uff0c\u5b83\u4e5f\u4f1a\u8ba9Drupal\u66f4\u52a0\u8d8b\u4e8e\u9762\u5411\u5bf9\u8c61\u3002 3\u3001\u4ece\u8bf7\u6c42\u5230\u54cd\u5e94(From request to response) \u00b6 \u5f53\u4e00\u4e2a\u8bf7\u6c42\u6765\u65f6\uff0c\u7cfb\u7edf\u5f00\u59cb\u5f15\u5bfc\uff0c\u542f\u52a8DrupalKernel\uff0c\u8c03\u7528\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0c\u59d4\u6d3e\u8bf7\u6c42\u7ed9Symfony2\u7684HttpKernel\u505a\u8fdb\u4e00\u6b65\u5904\u7406\u3002 HttpKernel\u5206\u53d1kernel.request\u4e8b\u4ef6\uff0c\u4e00\u4e9b\u8ba2\u9605\u76d1\u542c\u4e8b\u4ef6\u5c06\u6309\u7167\u987a\u5e8f\u6267\u884c\uff1a \u2460\u3001AuhtenticationSubscriber \u52a0\u8f7dsession\uff0c\u8bbe\u7f6e\u5168\u5c40\u7528\u6237 \u2461\u3001LanguageRequestSubscriber \u68c0\u6d4b\u5f53\u524d\u8bed\u8a00 \u2462\u3001PathSubscriber \u5c06url\u8f6c\u6362\u4e3a\u7cfb\u7edf\u8def\u5f84(url\u522b\u540d\u7b49) \u2463\u3001LegacyRequestSubscriber \u5141\u8bb8\u8bbe\u7f6e\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e3b\u9898\u5e76\u521d\u59cb\u5316 \u2464\u3001MaintenanceModeSubscriber \u5982\u679c\u662f\u7ef4\u62a4\u6a21\u5f0f\uff0c\u663e\u793a\u7ef4\u62a4\u9875\u9762 \u2465\u3001RouteListener \u83b7\u53d6\u6240\u6709\u5df2\u52a0\u8f7d\u7684\u8def\u7531\u5bf9\u8c61 \u2466\u3001AccessSubscriber \u68c0\u67e5\u5ba2\u6237\u7aef\u7684\u8bbf\u95ee\u6743\u9650 RouterListener\u5728\u8def\u7531\u5de5\u4f5c\u7684\u65f6\u5019\u8c03\u7528\uff0c\u83b7\u53d6\u8def\u7531\u670d\u52a1\u8fd4\u56de\u7684\u8def\u7531\u5c5e\u6027\u3002Drupal\u7684\u8def\u7531\u670d\u52a1\u8ddfSymfony\u7684\u4e0d\u540c\uff1aDynamicRouter\u5728Symfony\u4e2d\u4ec5\u4ec5\u4ee5\u63d2\u4ef6\u5f62\u5f0f\u63d0\u4f9b\uff0c\u89c1http://cmf.symfony.com/\u3002\u4e0eSymfony\u5e38\u89c4\u8def\u7531\u7684\u4e3b\u8981\u533a\u522b\u5728\u4e8e\uff0cDrupal\u7684DynamicRouter\u652f\u6301\u589e\u5f3a\uff0c\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8ba8\u8bba\u3002DynamicRouter\u7c7b\u63a5\u4e0b\u6765\u4f1a\u628a\u67e5\u627e\u5f53\u524d\u8def\u7531\u7684\u4efb\u52a1\uff08\u7c7b\u4f3c\u4e8eDrupal 7\u4e2d\u7684current_path\uff09\u59d4\u6d3e\u7ed9NestedMatcher, \u800cNestedMatcher\u53c8\u4f1a\u628a\u8fd9\u4e2a\u4efb\u52a1\u59d4\u6d3e\u7ed9RouteProvider\u3002RouteProvider\u4f1a\u5728router\u8868\u4e2d\u627e\u5230\u5339\u914d\u8be5\u8def\u7531\u7684\u8def\u7531\uff0c\u4e5f\u5305\u62ec\u5728CMS\u4e2d\u7684\u5df2\u7f13\u5b58\u7684\u8def\u7531\u3002\u8fd9\u4e2a\u8def\u7531\u8868\u662f\u7531route builder\u521b\u5efa\uff0c\u7ad9\u70b9\u6211\u4eec\u7a0d\u540e\u518d\u505a\u4ecb\u7ecd\u3002\u8def\u7531\u6309\u7167\u8def\u5f84\u957f\u5ea6\u8fdb\u884c\u5339\u914d\uff1a\u6700\u957f\u7684\u5339\u914d\u8def\u5f84\u88ab\u8ba4\u4e3a\u662f\u6b63\u786e\u7684\u3002\u7136\u540e\uff0cNestedMatcher\u8981\u6c42UrlMatcher\u5728\u8def\u7531\u96c6\u4e2d\u9009\u5b9a\u90a3\u4e2a\u7279\u5b9a\u7684\u6d3b\u8dc3\u8def\u7531\u3002\u901a\u5e38\uff0c\u80fd\u6b63\u786e\u7684\u901a\u8fc7http/https\u901a\u8fc7GET/POST\u65b9\u5f0f\u8bbf\u95ee\u7684\u8def\u7531\u5c06\u88abUrlMatcher\u4f18\u5148\u5339\u914d(\u6700\u957f\u5339\u914d)\u3002\u5f53\u7136\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ea\u4f1a\u5b9a\u4e49\u4e00\u4e2a\u8def\u7531\uff0c\u6240\u4ee5UrlMatcher\u7684\u4f5c\u7528\u5f88\u6709\u9650\u3002\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u662f\u5339\u914d\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u6d3b\u8dc3\u8def\u7531\uff0c\u5982node.add_page\u3002 \u63a5\u4e0b\u6765\u6211\u4eec\u4e86\u89e3\u4e00\u4e0broute filters\uff0c\u53ef\u80fd\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u5e76\u4e0d\u4e00\u5b9a\u7528\u5230\u3002\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u6253\u4e86\u6807\u7b7e\u540d\u4e3aroute_filter\u7684service\uff0c\u8fd9\u4e9broute filters\u5c06\u88abNestedMatcher\u8c03\u7528\uff0c\u5728RouteProvider\u8fd4\u56de\u6b63\u786e\u8def\u7531\u4fe1\u606f\u4e4b\u540e\u76f4\u63a5\u8fc7\u6ee4\u8def\u7531\u96c6\u3002Drupal\u6838\u5fc3\u4ec5\u5bf9\u6ca1\u6709\u8fd4\u56deMIME\u7c7b\u578b\u7684\u8def\u7531\u91c7\u7528mechanism\u540d\u505a\u8fc7\u6ee4\u64cd\u4f5c\uff0c\u5f53\u7136\uff0c\u8fd8\u5f97\u663e\u793a\u6307\u5b9a\"_format\"\u3002 \u5339\u914d\u5230\u8bf7\u6c42\u8def\u7531\u540e\uff0cDynamicRouter\u7ee7\u7eed\u8c03\u7528\u8def\u7531\u7684\u589e\u5f3a\u5c5e\u6027\uff0c\u5305\u542b\u8def\u7531\u5c5e\u6027\uff0c\u8f6c\u6362\u8def\u7531\u53c2\u6570\u3002\u4e0b\u4e00\u8282\u5c06\u8bb2\u8ff0\u8fd9\u4e2a\u8fc7\u7a0b\u3002\u7136\u540e\u8def\u7531\u5c5e\u6027\u4f1a\u8fd4\u56de\u7ed9RouterListener\uff0c\u5e76\u8bbe\u7f6e\u5728\u8bf7\u6c42\u5bf9\u8c61\u4e2d\u3002\u63a5\u4e0b\u6765\uff0c\u6267\u884c\u6743\u9650\u68c0\u67e5(AccessSubscriber)\uff0c\u6700\u540e\uff0c\u4f7f\u7528\u6b63\u786e\u7684\u53c2\u6570\u8c03\u7528\u63a7\u5236\u5668\u65b9\u6cd5\uff0c\u63a7\u5236\u5668\u8fd4\u56de\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef\u3002 \u73b0\u5728\u6211\u4eec\u77e5\u9053\u4e86\u8bf7\u6c42\u7684\u5904\u7406\u8fc7\u7a0b\uff0c\u63a5\u4e0b\u6765\u518d\u6765\u7814\u7a76\u4e00\u4e0b\u8def\u7531\u3002 4\u3001\u8def\u7531 \u00b6 \u5728Drupal7\u4e2d\uff0chook_menu\u7528\u4e8e\u6ce8\u518c\u9875\u9762\u56de\u6389\u51fd\u6570(page callbacks)\u3001\u6807\u9898(titles)\u3001\u53c2\u6570(arguments)\u3001\u8bbf\u95ee\u8981\u6c42(requirements)\u7b49\uff0cDrupal8\u4e2d,\u91c7\u7528\u4e86Symfony\u7684\u8def\u7531\uff0c\u5c06\u66f4\u52a0\u7075\u6d3b\uff0c\u4e5f\u66f4\u590d\u6742\u3002 Drupal8\u4e2d\u5c06\u4e0d\u4f1a\u518d\u6709\u9875\u9762\u56de\u6389\u51fd\u6570\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u63a7\u5236\u5668\u7c7b\u7684\u65b9\u6cd5\u3002\u8fd9\u4e9b\u6709\u6548\u7684\u8def\u7531\u73b0\u5728\u4f1a\u88ab\u914d\u7f6e\u5728\u6a21\u5757\u76ee\u5f55\u4e0b\u7684{module}.routing.yml\u6587\u4ef6\u4e2d\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u7528\u6237\u9000\u51fa\u767b\u9646\u7684\u914d\u7f6e\uff1a user.logout: path: '/user/logout' defaults: _controller: '\\Drupal\\user\\Controller\\UserController::logout' requirements: _user_is_logged_in: 'TRUE' \u6ce8\u610f\uff1a\u4efb\u4f55\u8def\u7531\u90fd\u9700\u8981\u4e00\u4e2aID(user.logout)\u548c\u8def\u5f84(/user/logout)\u3002\u5728\u8def\u5f84\u4e2d\u4e5f\u53ef\u5305\u542b\u53c2\u6570\uff0c\u540e\u9762\u518d\u6765\u8ba8\u8bba\u3002'default'\u975e\u5e38\u91cd\u8981\uff0c\u5b83\u7528\u4e8e\u63a7\u5236\u8bf7\u6c42\u8def\u5f84\u5339\u914d\u65f6\u9700\u8981\u505a\u4ec0\u4e48\u3002'requirement'\u5b9a\u4e49\u4e86\u662f\u5426\u5e94\u8be5\u5904\u7406\u8bf7\u6c42\uff0c\u901a\u5e38\u5305\u62ec\u8bbf\u95ee\u68c0\u67e5\uff0cSymfony\u66ff\u4ee3\u4e86Drupal7\u7684'access arguments'\u548c'access callback'\u3002 \u5e38\u7528'default'\u952e\uff1a \u00b6 \u2460\u3001_controller \u8fd4\u56de\u4e00\u4e2a\u9884\u671f\u7684\u7ed3\u679c\uff0c\u901a\u8fc7\u8c03\u7528\u7279\u5b9a\u7684\u65b9\u6cd5\u3002 \u2461\u3001_content \u5982\u6307\u5b9a\uff0c\u57fa\u4e8e\u8bf7\u6c42\u7684MIME\u7c7b\u578b\u8bbe\u7f6e_controller\uff0c\u5e76\u7528\u7279\u5b9a\u7684\u65b9\u6cd5(\u901a\u5e38\u662f\u5b57\u7b26\u4e32\u6216\u6570\u7ec4)\u586b\u5145\u8fd4\u56de\u503c \u2462\u3001_form \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6e\u7ed9HtmlFormController::content\u54cd\u5e94\u7279\u5b9a\u7684\u8868\u5355\u3002\u8fd9\u4e2aform\u662f\u4e00\u4e2a\u7c7b\u540d\uff0c\u5b9e\u73b0\u4e86FormInterface\uff0c\u800c\u4e14\u901a\u5e38\u7ee7\u627f\u81eaFormBase\u3002\u5f53\u7136\u8868\u5355\u7684\u6784\u5efa\u4e5f\u662f\u9762\u5411\u5bf9\u8c61\u7684\u3002 \u2463\u3001_entity_form \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6e\u7ed9HtmlEntityFormController::content\u8fd4\u56de\u7279\u5b9a\u7684\u5b9e\u4f53\u8868\u5355(\u5982{entity_type}.{add|edit|delete}) \u2464\u3001_entity_list \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6e\u7ed9HtmlFormController::content\uff0c_content\u8bbe\u7f6e\u7ed9EntityListController::listing\uff0c\u57fa\u4e8e\u5b9e\u4f53\u7c7b\u578b\u5217\u8868\u63a7\u5236\u5668\u8fd4\u56de\u4e00\u4e2a\u5b9e\u4f53\u5217\u8868\uff0c\u4f7f\u7528\u671f\u671b\u5b9e\u4f53\u7684EntityListController\u63d0\u4f9b\u4e00\u4e2a\u5b9e\u4f53\u5217\u8868\u3002\u4f8b:_entity_list: view_mode\u8fd4\u56de\u4e00\u4e2a\u89c6\u56fe\u6a21\u5f0f\u7684\u6e32\u67d3\u6570\u7ec4\u3002 \u2465\u3001_entity_view \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6eHtmlFormController::content\uff0c_content\u8bbe\u7f6eEntityViewController::view \uff0c\u5728\u7ed9\u5b9a\u7684\u89c6\u56fe\u6a21\u5f0f\u4e0b\uff0c\u901a\u8fc7\u8def\u5f84\u548c\u6e32\u67d3\u6a21\u5f0f\u4e0b\u67e5\u627e\u4e00\u4e2a\u5b9e\u4f53\u3002\u5982: _entity_view:node.teaser\u3002 \u5728\u89c6\u56fe\u6a21\u5f0f\u4e0b\u5c06\u8fd4\u56de\u4e00\u4e2a{node}\u7684\u6e32\u67d3\u6570\u7ec4\u3002 \u2466\u3001_title \u9875\u9762\u7684\u6807\u9898(\u5b57\u7b26\u4e32) \u2467\u3001_title_callback \u9875\u9762\u7684\u6807\u9898(\u65b9\u6cd5\u56de\u8c03) \u5e38\u7528'requirement'\u952e\uff1a \u00b6 \u2460\u3001_permission \u6307\u5b9a\u5f53\u524d\u7528\u6237\u9700\u8981\u62e5\u6709\u7684\u7279\u5b9a\u6743\u9650 \u2461\u3001_role \u6307\u5b9a\u5f53\u524d\u7528\u6237\u9700\u8981\u62e5\u6709\u7684\u7279\u5b9a\u89d2\u8272 \u2462\u3001_method \u5141\u8bb8\u7684HTTP\u65b9\u6cd5\uff0c\u5982GET\u3001POST\u7b49 \u2463\u3001_schema \u4e00\u822c\u4e3ahttp\u6216https\uff0c\u5e76\u4e14\u8bf7\u6c42\u7684scheme\u548c\u5b9a\u4e49\u7684schema\u8981\u4e00\u81f4\u3002\u5f53\u4f7f\u7528Drupal::url()\u8f93\u51faurl\u65f6\u4e5f\u4f1a\u5e26\u5165\u8fd9\u4e2a\u5c5e\u6027\u3002 \u2464\u3001_node_add_access \u5b9a\u4e49\u67d0\u4e9bnode type\u7684\u8bbf\u95ee\u63a7\u5236 \u2465\u3001_entity_access \u5b9e\u4f8b\u7684\u8bbf\u95ee\u63a7\u5236 \u2466\u3001_format \u683c\u5f0f\u5316MIME\u7c7b\u578b \u4e0a\u9762\u6240\u5217\u7684\u5927\u591a\u6570(\u4f46\u4e0d\u662f\u6240\u6709)\u7684requirement'\u662f\u7531access checkers'\u8fdb\u884c\u6821\u9a8c\uff0c\u8fd9\u4e2a\u6211\u4eec\u7a0d\u540e\u4ecb\u7ecd\u3002\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684access checkers,\u56e0\u4e3aDrupal 7\u7684'access callback'\u5df2\u4e0d\u518d\u53ef\u7528\u3002\u50cfnode\u6a21\u5757\u4e2d\u7684'_node_add_access',\u901a\u8fc7\u5b9a\u5236\u7684\u6743\u9650\u63a7\u5236(NodeAddAccessCheck)\u6765\u5904\u7406\u3002 AccessManager\u6267\u884c\u6743\u9650\u63a7\u5236,\u8ba2\u9605kernel.requet\u7684\u4e8b\u4ef6\u3002\u8c03\u7528\u6743\u9650\u68c0\u6d4b\uff0c\u5fc5\u987b\u5b9e\u73b0AccessInterface\u7c7b\u3002\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5230\u6743\u9650\u68c0\u6d4b\u4f1a\u88ab\u6ce8\u518c\u4e3a\u6253\u4e86\u6807\u7b7eaccess_check\u7684services\u3002\u6743\u9650\u68c0\u6d4b\u4f1a\u6709\u4e00\u4e2a\u65b9\u6cd5\u53bb\u68c0\u6d4b\u5ba2\u6237\u7aef\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u6307\u5b9a\u7684\u8def\u7531\uff0c\u5982\u679c\u8bbf\u95ee\u88ab\u62d2\u7edd,\u4f1a\u629b\u51fa\u4e00\u4e2a\u201c\u62d2\u7edd\u8bbf\u95ee\u201d\u9875\u9762\u3002 \u8def\u5f84\u53c2\u6570(path parameters) \u00b6 \u5728\u5b9e\u8df5\u4e2d\u4f60\u7ecf\u5e38\u9700\u8981\u53c2\u6570\u53bb\u63a7\u5236\u9875\u9762\u56de\u8c03\u3002\u4e0b\u9762\u7684\u8def\u7531\u5b9a\u4e49\u5b9e\u4f8b\u4e2d\uff0c\u8def\u5f84\u5305\u542b\u4e00\u4e2a\u540d\u4e3a'node'\u7684\u53c2\u6570\u3002\u6bcf\u4e00\u4e2a\u8def\u7531\u5b58\u50a8\u76f8\u5e94\u7684\u9009\u9879\u3002\u63a7\u5236\u5668\u65b9\u6cd5\u63a5\u6536\u8fd9\u4e9b\u53c2\u6570\u4f5c\u4e3a\u53c2\u6570\u3002\u6240\u4ee5\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b,NodeController\u65b9\u6cd5\u6709\u4e00\u4e2a\u53c2\u6570:$node\u3002\u4e00\u4e2a\u8def\u7531\u53ef\u4ee5\u6709\u591a\u4e2a\u53c2\u6570,\u4f46\u662f\u4ed6\u4eec\u7684\u540d\u5b57\u5e94\u8be5\u662f\u552f\u4e00\u7684\u3002 node.view: path: '/node/{node}' defaults: _content: '\\Drupal\\node\\Controller\\NodeController::page' _title_callback: '\\Drupal\\node\\Controller\\NodeController::pageTitle' requirements: _entity_access: 'node.view' \u53c2\u6570\u4f20\u9012\u7684\u503c\u9ed8\u8ba4\u5c31\u662furl\u4e2d\u7684\u503c(\u4e00\u4e2a\u5b57\u7b26\u4e32)\uff0c\u4f46\u901a\u5e38\u4f1a\u901a\u8fc7parameter converter\u8fdb\u884c\u8f6c\u6362\u3002\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d,NodeController\u4e0d\u4f1a\u5f97\u5230node id\uff0c\u800c\u662f\u4e00\u4e2a\u52a0\u8f7d\u7684node\u5b9e\u4f53\u3002 \u53c2\u6570\u8f6c\u6362\u662f\u7531\u8ba2\u9605\u7740kernel.request\u4e8b\u4ef6\u7684ParamConverterManager\u5b8c\u6210\u3002ParamConverterManager\u5305\u542b\u53ef\u6240\u6709\u6ce8\u518c\u4e86\u7684ParamConverterInterface(\u6807\u7b7e\u540d\u4e3aparamconverter\u7684\u670d\u52a1)\u7684\u5b9e\u73b0\u3002\u5f53\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6,ParamConverterManager\u4f1a\u904d\u5386\u6d3b\u8dc3\u8def\u7531\u7684\u53c2\u6570\u5e76\u8c03\u7528\u53c2\u6570\u8f6c\u6362\u5668\u7684\u8f6c\u6362\u65b9\u6cd5\u3002\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u4e00\u4e2a'string'\u53c2\u6570\u4f1a\u88ab\u66ff\u6362\u4e3a\u4e00\u4e2a\u5b8c\u6574\u7684\u5bf9\u8c61\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u63a7\u5236\u5668\u65b9\u6cd5\u7684\u53c2\u6570\u6ca1\u6709\u660e\u786e\u7684\u7c7b\u578b\u6697\u793a\uff0c\u5c06\u4f1a\u4f20\u9012\u672a\u53d1\u751f\u8f6c\u6362\u7684\u53c2\u6570\u3002 EntityConverter\u662fDrupal\u6838\u5fc3\u4e2d\u552f\u4e00\u4e00\u4e2a\u63d0\u4f9b\u53c2\u6570\u8f6c\u6362\u7684\u7c7b\uff0c\u4f46\u662f\u5728Drupal\u4e2d\u4f7f\u7528\u5f97\u5f88\u5e7f\u3002\u5982\u679c\u4e00\u4e2a\u53c2\u6570\u540d\u5339\u914d\u5230\u4e86\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u578b('node', 'user'\u7b49)\uff0c\u5b83\u5c31\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6362\u4e3a\u5b9e\u4f53\u5bf9\u8c61\u3002\u5b83\u7684\u503c\u88ab\u8ba4\u4e3a\u662f\u5b9e\u4f53\u7684id\u3002\u5982\u679c\u5b9e\u4f53\u4e0d\u5b58\u5728\u6216\u8f6c\u6362\u5931\u8d25\uff0c\u5219\u8fd4\u56de404\u3002 \u4f60\u4e5f\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e9b\u503c\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u53ef\u9009\u53c2\u6570\uff0c\u8fd9\u53ea\u9002\u7528\u4e8e\u53c2\u6570\u4e0d\u88ab\u8f6c\u6362\u7684\u60c5\u51b5\u3002 4\u3001\u8def\u7531\u751f\u6210(Route building) \u00b6 \u8def\u7531\uff0c\u663e\u7136\u662f\u5728\u8bf7\u6c42\u4e2d\u5b8c\u6210\u7684\uff0c\u5b83\u4f7f\u7528\u4e4b\u524d\u6784\u5efa\u7684'router'\u8868\u3002RouteBuilder service\u8d1f\u8d23\u586b\u5145\u8def\u7531\u8868(\u4f8b\u5982,\u5f53\u6e05\u7406\u7f13\u5b58\u540e)\u3002\u5f53\u4e00\u4e2a\u8bf7\u6c42\u6765\u65f6\uff0c\u8fd9\u4e2a\u8def\u7531\u8868\u7528\u4e8e\u67e5\u627e\u5bf9\u5e94\u7684\u8def\u7531\u5e76\u5b8c\u6210\u5b83\u3002\u8fd9\u4e48\u505a\u662f\u51fa\u4e8e\u6027\u80fd\u7684\u8003\u8651\u3002RouteBuilder\u901a\u8fc7\u6536\u96c6\u6240\u6709\u7684\u5df2\u914d\u7f6e\u7684\u9759\u6001\u8def\u7531(yml-files)\u5e76\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5b83\u4eec\u7684\u96c6\u5408\u3002\u5b83\u4e5f\u8c03\u7528route.route_dynamics\u4e8b\u4ef6\uff0c\u5728\u8fd9\u4e2a\u4e8b\u4ef6\u4e2d\uff0c\u4e8b\u4ef6\u8ba2\u9605\u8005\u8fd8\u53ef\u4ee5\u6ce8\u518c\u989d\u5916\u7684\u8def\u7531(\u89c1\u4e0a\u9762\u7684\u793a\u4f8bblock\u6a21\u5757)\u3002\u7136\u540e\u8c03\u7528routing.route_alter\u4e8b\u4ef6\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u53ef\u80fd\u6709\u591a\u4e2a\u8ba2\u9605\u8005\u3002\u53e6\u5916\u4e00\u4e9b\u7279\u522b\u91cd\u8981\u7684\u5982\u8bbf\u95ee\u63a7\u5236\u548c\u53c2\u6570\u8f6c\u6362\u3002 \u6211\u4eec\u521a\u521a\u63d0\u5230\u7684\u8bbf\u95ee\u68c0\u6d4b\u3002\u5f53\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6\uff0c\u8bbf\u95ee\u68c0\u6d4b\u4f1a\u68c0\u6d4b\u5ba2\u6237\u7aef\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u3002\u5f53\u7136\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u8def\u7531\u90fd\u9700\u8981\u6743\u9650\u3002\u5b9e\u9645\u4e0a\uff0c\u5728\u6784\u5efa\u8def\u7531\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u51b3\u5b9a\u6bcf\u4e2a\u8def\u7531\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8fd9\u9879\u5de5\u4f5c\u7531\u76d1\u542crouter.route_alter\u4e8b\u4ef6\u7684AccessManager\u5b8c\u6210\uff0c\u5305\u542b\u9759\u6001\u548c\u52a8\u6001\u7684\u8bbf\u95ee\u63a7\u5236\u3002StaticAccessCheckInterface\u6709\u4e00\u4e2a\u65b9\u6cd5appliesTo,\u7528\u4e8e\u8fd4\u56de\u4e00\u4e2arequirement\u6570\u7ec4\u3002\u52a8\u6001\u8bbf\u95ee\u63a7\u5236\u901a\u8fc7applies\u65b9\u6cd5\u6765\u6d4b\u8bd5\u6bcf\u4e2a\u8def\u7531\u3002AccessManager\u5728router\u8868\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u9009\u9879\u201c_access_checks\u201d\uff0c\u8fd9\u5e38\u7528\u4e8e\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6\u505a\u8def\u7531\u7684\u6743\u9650\u63a7\u5236\u3002\u6ce8\u610f\uff0c\u6bcf\u4e00\u4e2a\u8def\u7531\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u8bbf\u95ee\u68c0\u6d4b\uff0c\u5426\u5219\u6c38\u8fdc\u4e0d\u4f1a\u8bbf\u95ee\u8def\u7531! \u6211\u4eec\u4e5f\u63d0\u5230\u53c2\u6570\u8f6c\u6362\u5668\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u53c2\u6570\u5982\u4f55\u88ab\u8f6c\u6362\u5668\u8f6c\u6362\u3002\u6bcf\u4e2a\u53c2\u6570\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u9002\u7528\u7684\u8f6c\u6362\u5668(\u6216\u6ca1\u6709)\u3002\u5c31\u50cf\u8bbf\u95ee\u63a7\u5236\uff0c\u8fd9\u4e2a\u9002\u7528\u7684\u8f6c\u6362\u5668\u4f1a\u5728ParamConverterManager\u521b\u5efa\u8def\u7531\u65f6\u88ab\u641c\u7d22\u5230\u3002\u8fd9\u4e2a\u670d\u52a1\u4f1a\u68c0\u67e5\u6bcf\u4e00\u4e2a\u5b58\u5728\u7684\u8def\u7531\u53c2\u6570\uff0c\u4ee5\u53ca\u5bf9\u5e94\u53c2\u6570\u8f6c\u5316\u5668\u7684applies\u65b9\u6cd5\uff0c\u5e76\u5728router\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u9009\u9879\u201cconverter\u201d\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u5904\u7406\u65f6\uff0c\u8f6c\u6362\u53c2\u6570\u3002 5\u3001\u603b\u7ed3(Conclusion) \u00b6 \u5728\u672c\u8282\u4e2d,\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u5904\u7406\u8bf7\u6c42\u3002\u540c\u65f6,\u4f60\u73b0\u5728\u5e94\u8be5\u4e86\u89e3Drupal 8\u7684\u8def\u7531\u4ee5\u53ca\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684!\u4e8b\u5b9e\u4e0a,\u4f60\u5df2\u7ecf\u77e5\u9053\u4e86\u4ece\u8bf7\u6c42\u5230\u54cd\u5e94\u8fd9\u4e00\u57fa\u672c\u6d41\u7a0b\u3002\u7136\u800c\uff0cDrupal8\u4e2d\u4ecd\u7136\u6709\u4e00\u4e9b\u6709\u8da3\u7684\u6982\u5ff5\u5b58\u5728\uff0c\u8fd9\u90e8\u5206\u5185\u5bb9\u5c06\u5728\u4e0b\u4e2a\u90e8\u5206\u4e5f\u662f\u6700\u540e\u4e00\u90e8\u5206\u91cc\u9762\u8fdb\u884c\u63a2\u8ba8\u3002\u597d\u4e86\uff0c\u6211\u4eec\u4e0b\u5468\u518d\u6765\u8ba8\u8bba\u3002 \u56db\u3001Drupal8\u5176\u5b83\u6982\u5ff5 \u00b6 \u5728\u8fc7\u53bb\u7684\u51e0\u5468\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86Drupal\u7684\u7ed3\u6784\u548c\u5982\u4f55\u5904\u7406\u8bf7\u6c42\u3002\u6211\u4eec\u8fd8\u6ca1\u6709\u4e86\u89e3\u5982\u4f55\u5b89\u88c5\u914d\u7f6eDrupal8\u3002\u5728\u4f60\u6df1\u5165\u5177\u4f53\u7684\u6838\u5fc3\u6a21\u5757\u4ee3\u7801\u4e4b\u524d,\u4f60\u5e94\u8be5\u4e86\u89e3\u4e00\u4e9b\u91cd\u8981\u7684\u65b0\u7684\u6216\u53d8\u66f4\u7684Drupal8\u6982\u5ff5\u3002\u6211\u5728\u672c\u6587\u7684\u6700\u540e\u4e00\u90e8\u5206\u5c06\u63cf\u8ff0\u5b83\u4eec\u3002 1\u3001\u914d\u7f6e(Configuration) \u00b6 Drupal8\u7684\u914d\u7f6e\u7cfb\u7edf\u505a\u4e86\u5f88\u591a\u4ee4\u4eba\u5174\u594b\u7684\u6539\u8fdb\u3002\u6700\u503c\u5f97\u6ce8\u610f\u7684\u662f,\u73b0\u5728\u914d\u7f6e\u5b58\u50a8\u5728\u4e00\u4e2aYAML-files\u4e2d\uff0c\u76ee\u5f55\u7ed3\u6784\u4e00\u822c\u4e3a'/sites/{name}/files/config_{HASH}/active'\u3002\u6587\u4ef6\u540d\u5e94\u8be5\u51c6\u786e\u63cf\u8ff0\u8be5\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982,\u201cnode.settings.yml\u201d\u662f\u8282\u70b9\u6a21\u5757\u7684\u8bbe\u7f6e\uff0c\u201cviews.view.content.yml\u201d\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u673a\u5668\u540d\u79f0\u4e3a'content'\u89c6\u56fe\u5b9a\u4e49! \u4f60\u53ef\u80fd\u8ba4\u4e3a\u914d\u7f6e\u6587\u4ef6\u975e\u5e38\u4e0d\u7075\u6d3b\u3002\u4f46\u5728\u5b9e\u8df5\u4e2d,\u60a8\u53ef\u4ee5\u4f7f\u7528YAML-syntax\u6784\u5efa\u4fe1\u606f\u7684\u5173\u8054\u6570\u7ec4\u3002\u6b64\u5916,Drupal\u63d0\u4f9b\u4e00\u4e2aConfig\u5bf9\u8c61\u53ef\u4ee5\u7528\u6765\u6539\u53d8\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u4e0d\u5fc5\u624b\u52a8\u7f16\u8f91\u8fd9\u6837\u4e00\u4e2a\u6587\u4ef6!\u5f53\u60a8\u901a\u8fc7Drupal UI\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b57\u6bb5\uff0c\u8282\u70b9\u7c7b\u578b\uff0c\u533a\u5757\u7c7b\u578b\u6216\u89c6\u56fe\u65f6\uff0c\u7cfb\u7edf\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u3002\u5185\u5bb9(nodes)\u548c\u6570\u636e\u4f9d\u7136\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5426\u5219\u4f60\u5c06\u65e0\u6cd5\u5efa\u7acb\u5feb\u901f\u67e5\u8be2\u3002 \u4e00\u4e2a\u6a21\u5757\u53ef\u4ee5\u5305\u542bconf\u5b50\u76ee\u5f55\u3002\u5f53\u542f\u7528\u4e86\u4e00\u4e2a\u6a21\u5757\uff0c\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u4f1a\u88ab\u590d\u5236\u5230\u7f51\u7ad9\u7684\u914d\u7f6e\u76ee\u5f55\u4e0b\uff0c\u5f53\u6587\u4ef6\u6dfb\u52a0\u5b8c\u6bd5\uff08\u800c\u4e14\u7f13\u5b58\u5df2\u7ecf\u60c5\u51b5\uff09\uff0c\u914d\u7f6e\u4f1a\u88ab\u7cfb\u7edf\u68c0\u6d4b\u5230\u5e76\u4e14\u81ea\u52a8\u751f\u6548\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f,\u4e00\u4e2a\u6a21\u5757\u53ef\u4ee5\u63d0\u4f9b\u989d\u5916\u7684node types, image styles, views\u7b49\u65e0\u9700\u5b9e\u73b0Drupal7\u4e2d\u7684\u8bf8\u5982hook_node_info\u7684\u94a9\u5b50\u3002 \u914d\u7f6e\u6587\u4ef6\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u5730\u65b9\uff0c\u8fd9\u6709\u5229\u4e8e\u5728\u6700\u540e\u9636\u6bb5\u66f4\u6539\u914d\u7f6e! \u914d\u7f6e\u6587\u4ef6\u4e5f\u53ef\u80fd\u6709\u4e00\u4e2a\u5173\u8054\u7684schema\uff0c\u8be6\u7ec6\u63cf\u8ff0\u4e86\u4e00\u4e2aview/block/image style/\u7684\u914d\u7f6e\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u7684\u3002\u8fd9\u6837\u53ef\u4ee5\u66f4\u597d\u7684\u9a8c\u8bc1\u3001\u7ffb\u8bd1\u914d\u7f6e\u3002 2\u3001\u5b9e\u4f53(Entities) \u00b6 Drupal7\u5f15\u5165\u4e86\u5b9e\u4f53\uff0c\u4f7f\u7528\u5b9e\u4f53\u4f5c\u4e3a\u4e3b\u8981\u7684\u62bd\u8c61\u5185\u5bb9\uff0c\u662fDrupal\u5e95\u5c42\u67b6\u6784\u6700\u5927\u7684\u53d8\u5316\u3002\u4f8b\u5982,\u5b57\u6bb5\u53ef\u88ab\u8fde\u63a5\uff0c\u53ef\u4ee5\u5b9a\u4e49\u8bbf\u95ee\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5173\u8054\u89c6\u56fe\u7b49\u3002\u5b9e\u4f53\u73b0\u5728\u53d8\u7684\u975e\u5e38\u5f3a\u5927\u3002\u5728Drupal8\u4e2d, \u5b9e\u4f53\u5df2\u7ecf\u53d8\u7684\u5bf9\u4e8eCMS\u6765\u8bf4\u66f4\u52a0\u6838\u5fc3\u3002\u4e0d\u4ec5\u5185\u5bb9\u6570\u636e(\u8282\u70b9nodes\u3001\u5206\u7c7btaxonomy terms\u3001\u7528\u6237users)\u90fd\u662f\u5b9e\u4f53,\u800c\u4e14non-fieldable\u6bd4\u5982\u89c6\u56fe(views)\u3001\u6570\u636e\u64cd\u4f5c(actions)\u3001\u83dc\u5355(menus)\u3001\u56fe\u50cf(image styles)\u7b49\u90fd\u662f\u6269\u5c55\u5b9e\u4f53\u7c7b\uff0c\u4e5f\u5305\u8282\u70b9\u7c7b\u578b\u548c\u8bcd\u6c47\u7b49\u5b9e\u4f53\u3002 \u4f7f\u7528attributes\u5b9a\u4e49\u4e00\u4e2a\u5b9e\u4f53\u7684\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u8fd9\u91cc\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u5b9e\u4f53\u662f\u5426fieldable\u6216\u8005\u5b83\u5e94\u8be5\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u5b9e\u4f53\u7684\u4e00\u4e2a\u96c6\u5408\u3002\u5b9e\u4f53\u4f9d\u8d56\u4e8e\u63a7\u5236\u5668\uff0c\u4e0d\u4e00\u5b9a\u9700\u8981\u4fdd\u5b58\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u63a7\u5236\u5668\u7ee7\u627fConfigStorageController,\u5c06\u88ab\u4fdd\u5b58\u4e3a\u914d\u7f6e\u6587\u4ef6\u3002\u867d\u7136\u914d\u7f6e\u6587\u4ef6\u6709\u597d\u5904\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u4e0d\u80fd\u4f7f\u7528\u6570\u636e\u5e93\u67e5\u8be2\u5b83\u4eec\u3002\u5982\u679c\u4f60\u60f3\u641c\u7d22\u5b83\u4eec,\u4f60\u8981\u52a0\u8f7d\u6240\u6709\u9879\u76ee\u5e76\u4f7f\u7528for\u5faa\u73af\u53bb\u68c0\u7d22\u3002\u5982\u679c\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u4f8b\u5982\u8282\u70b9\u548c\u7528\u6237,\u5c31\u53ef\u4ee5\u4f7f\u7528FieldableDatabaseStorageController\u3002\u8282\u70b9\u3001\u7528\u6237\u3001\u5206\u7c7b\u90fd\u662f\u4e00\u6837\u3002\u4f46\u7ed3\u679c\u5c31\u662f\uff0c\u8fd9\u4e9b\u5185\u5bb9\u4e0d\u80fd\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4f20\u9012\u3002\u5bf9\u6211\u6765\u8bf4,\u73b0\u5728\u8fd8\u4e0d\u6e05\u695a\u662f\u5426\u6709\u53ef\u80fd\u6709\u4e00\u4e2afieldable\u914d\u7f6e\u5b58\u50a8\u63a7\u5236\u5668! \u5982\u679c\u8981\u52a0\u6df1\u5b9e\u4f53\u7684\u7406\u89e3\uff0c\u6211\u5efa\u8bae\u4f60\u770b\u4e00\u770bImageStyle\u7c7b,\u8fd9\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684\u57fa\u4e8e\u914d\u7f6e\u7684\u5b9e\u4f53\uff0ctaxonomy term,\u5b83\u662f\u4e00\u4e2a\u5b57\u6bb5\u5316\u57fa\u4e8e\u6570\u636e\u5e93\u5b58\u50a8\u7684\u5b9e\u4f53\uff0c\u8fd8\u6709Vocabulary\uff0c\u5b83\u662f\u4e00\u4e2a\u5b9e\u4f53\u96c6\u3002 3\u3001\u63d2\u4ef6(Plugins) \u00b6 \u63d2\u4ef6\u53ef\u4ee5\u770b\u4f5c\u662f\u94a9\u5b50\u7684\u9762\u5411\u5bf9\u8c61\u7248\u672c\u3002\u4ed6\u4eec\u7528\u4e8e\u6a21\u5757\u5316\u5305\u62ec\u81ea\u5b9a\u4e49\u6a21\u5757\uff0c\u56fe\u50cf\u6548\u679c\u7b49\u3002 \u5b66\u4e60\u63d2\u4ef6\u6709\u4e2a\u5f88\u597d\u7684\u793a\u4f8b\u5c31\u662fBlockBase\u62bd\u8c61\u7c7b\u3002\u4e3a\u4e86\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u81ea\u5b9a\u4e49block\u65f6\uff0c\u5c31\u5fc5\u987b\u7ee7\u627f\u8fd9\u4e2a\u7c7b\uff0c\u8fd9\u4e48\u505a\u7c7b\u4f3c\u4e8e\u8bba\u575b\u6a21\u5757\u7684ActiveTopicsBlock\u7c7b\u3002\u4e00\u4e9b\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u5fc5\u987b\u8986\u76d6\u5176\u8bbf\u95ee\u68c0\u67e5\u3001\u89c6\u56fe\u5efa\u7acb\u3001\u6539\u53d8\u5757\u7684\u5f62\u5f0f\u7b49\u3002 \u63d2\u4ef6\u7ba1\u7406\u5668\u7528\u6765\u5b9a\u4e49\u63d2\u4ef6\u7c7b\u578b\uff0c\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u5217\u8868\u4ee5\u53ca\u7528\u4e8e\u5b58\u653e\u63d2\u4ef6\u7684\u5b50\u76ee\u5f55\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f,\u4efb\u4f55\u6a21\u5757\u53ef\u4ee5\u6dfb\u52a0\u63d2\u4ef6\u3002\u63d2\u4ef6\u901a\u8fc7\u6ce8\u91ca\u7c7b\u7684\u65b9\u5f0f\u8fdb\u884c\u8bbe\u7f6e\u3002\u6b64\u5916\uff0c\u6839\u636e\u4e0d\u540c\u7684\u63d2\u4ef6\u7c7b\u578b\uff0c\u6ce8\u91ca\u4e2d\u5fc5\u987b\u8981\u6307\u5b9a\u4e00\u4e9b\u914d\u7f6e\u5c5e\u6027\u3002 4\u3001\u7c7b(Drupal class) \u00b6 Drupal 8\u6838\u5fc3\u4ee3\u7801\u4e3b\u8981\u662f\u9762\u5411\u5bf9\u8c61\u7684\u3002\u7136\u800c\uff0c\u6a21\u5757\u4e2d\u7684\u94a9\u5b50\u4ee3\u7801\u4ecd\u7136\u662f\u9762\u5411\u8fc7\u7a0b\u7684\u3002\u8fd9\u91cc\u5c31\u51fa\u73b0\u4e86\u7591\u95ee,\u56e0\u4e3aSymfony\u662f\u5b8c\u5168\u9762\u5411\u5bf9\u8c61\u7684\uff01\u5728Symfony\u4e2d\uff0c\u5982\u679c\u60a8\u9700\u8981\u4f9d\u8d56\u4e8e\u53e6\u4e00\u4e2aservice\u521b\u5efa\u4e00\u4e9b\u529f\u80fd,\u60a8\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u670d\u52a1\u5e76\u4e14\u5728\u670d\u52a1\u5bb9\u5668\u5b9a\u4e49\u6240\u9700\u7684\u5fc5\u987b\u4f9d\u8d56\u9879\u3002\u4f46\u5982\u679c\u4f60\u60f3\u7528Drupal\u7684\u94a9\u5b50\u5b9e\u73b0\u4e00\u4e2a\u7279\u5b9a\u7684service,\u5c06\u521b\u5efa\u4e00\u4e2a\u9759\u6001Drupal\u7c7b\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528Drupal::service(\u201c{service_id}\u201d),\u6216\u7740\u901a\u8fc7\u4f7f\u7528\u7279\u5b9a\u7684\u50cfDrupal::request(),Drupal:currentUser(),Drupal:entityManager()\u7684\u670d\u52a1\u8bbf\u95ee\u5668\u7c7b\u83b7\u7a0b\u5e8f\u6d41\u7a0b\u4e2d\u7684services\u3002\u540e\u8005\u7684\u4f18\u52bf\u662f\u53ef\u4ee5\u4e3a\u4f60\u63d0\u4f9b\u66f4\u597d\u7684\u4ee3\u7801\u8865\u5168\u529f\u80fd\u3002\u6b64\u5916,\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u4fbf\u50cfDrupal::url()\u7684\u8f85\u52a9\u65b9\u6cd5\uff0c\u76f8\u5f53\u4e8eDrupal7\u7684url()\u65b9\u6cd5\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u91c7\u7528Drupal class\u7684\u4f8b\u5b50\uff0c\u4f4d\u4e8enode.module\u4e2d\u7684node_access\u65b9\u6cd5: function node_access($op, $node, $account = NULL, $langcode = NULL) { $access_controller = \\Drupal::entityManager()->getAccessController('node'); ... return $access_controller->access($node, $op, $langcode, $account); } 5\u3001\u603b\u7ed3(Conclusion) \u00b6 \u5728\u672c\u6587\u4e2d,\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86Drupal8\u7684\u7ed3\u6784\uff0c\u4ee5\u53ca\u4e0eSymfony2\u5bf9\u6bd4\u3002\u6211\u4eec\u8fd8\u5b66\u4e60\u4e86\u670d\u52a1\u5bb9\u5668\u7ba1\u7406\u7740\u6240\u6709\u670d\u52a1,\u800c\u670d\u52a1\u53ef\u4ee5\u8fdb\u884c\u914d\u7f6e\u3002\u4e4b\u540e\u6211\u4eec\u5b66\u4e60\u4e86\u8def\u7531\u548c\u5904\u7406\u8bf7\u6c42\u7684\u8fc7\u7a0b\u3002\u6700\u540e\u6211\u4eec\u4ecb\u7ecd\u4e86Drupal8\u4e2d\u4e00\u4e9b\u91cd\u8981\u7684\u65b0\u6982\u5ff5:Drupal\u7c7b,\u63d2\u4ef6\u548c\u914d\u7f6eDrupal8\u3002 \u6211\u5e0c\u671b\u6240\u6709\u8fd9\u4e9b\u4f1a\u5e2e\u52a9\u4f60\u63a2\u7d22\u548c\u4e86\u89e3Drupal8\u3002\u6211\u5e0c\u671b\u4f60\u80fd\u591f\u4e86\u89e3Drupal8\u6a21\u5757\u5f00\u53d1\uff0c\u5e76\u5bf9\u8fd9\u4e2a\u4f1f\u5927\u7684\u9879\u76ee\u6709\u6240\u8d21\u732e\u3002 \u539f\u6587\u51fa\u5904\uff1a https://cipix.nl/understanding-drupal-8-part-1-general-structure-framework","title":"\"understanding drupal8-drupal8\u521d\u7aa5\""},{"location":"drupal/drupal8/understanding-drupal8/#_1","text":"Drupal 8\u6765\u4e86\u3002\u8fd9\u662f\u4e00\u4e2a\u9769\u547d\uff01\u548cDrupal6\u5230Drupal7\u7684\u6f14\u5316\u4e0d\u540c\uff0c\u8fd9\u662f\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u67b6\u6784\u548c\u7f16\u7801\u65b9\u5f0f\u3002\u6211\u786e\u4fe1\u8fd9\u4e9b\u53d8\u5316\u5bf9\u4e13\u4e1a\u5316\u548c\u73b0\u4ee3\u5316CMS\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002\u6211\u76f8\u4fe1\u8f6c\u5411\u9762\u5411\u5bf9\u8c61\u5c06\u4f1a\u5438\u5f15\u5f00\u53d1\u8005\uff0c\u5e76\u5c06\u63d0\u5347\u8f6f\u4ef6\u7684\u6574\u4f53\u8d28\u91cf\u3002\u6211\u611f\u8c22Drupal\u5185\u6838\u5f00\u53d1\u8005\u7684\u52c7\u6c14\u4ee5\u53ca\u4e3a\u6b64\u6240\u505a\u7684\u5de5\u4f5c\u3002 \u7136\u800c\uff0c\u5bf9\u4e8e\u73b0\u6709\uff08\u5305\u62ec\u65b0\u7684\uff09Web\u5f00\u53d1\u8005\uff0c\u5b66\u4e60drupal\u5c06\u662f\u4e00\u4e2a\u5de8\u5927\u7684\u6311\u6218\u3002\u901a\u8fc7\u9605\u8bfb\u8fd9\u7bc7\u6587\u7ae0\uff0c\u60a8\u5c06\u66f4\u5177\u4f18\u52bf\u3002\u5728\u4f60\u6df1\u5165Drupal 8\u6a21\u5757\u5f00\u53d1\u524d\uff0c\u8fd9\u7bc7\u6587\u7ae0\u4f1a\u7ed9\u4f60\u5e26\u53bb\u4e9b\u8bb8\u542f\u793a\u3002\u5728\u6211\u5199\u4e0b\u8fd9\u7bc7\u6587\u7ae0\u4e4b\u524d\uff0c\u6211\u82b1\u4e86\u6570\u5929\uff0c\u901a\u8fc7\u4e00\u6b65\u6b65\u7684\u8c03\u8bd5\u3001\u9605\u8bfb\u4ee3\u7801\u548c\u5728\u7ebf\u6587\u7ae0\uff0c\u6df1\u5165\u5730\u5b66\u4e60\u4e86symfony2 \u548c Drupal8\u3002\u6211\u662f\u4e00\u4e2a\u7ecf\u9a8c\u4e30\u5bcc\u7684Drupal7\u5f00\u53d1\u8005\uff0c\u4f46\u662f\u5bf9symfony\u4e00\u65e0\u6240\u77e5\uff0c\u5e76\u4e14\u81f3\u4eca\u6ca1\u6709\u5bf9Druapl8\u5185\u6838\u6709\u6240\u8d21\u732e\u3002\u6211\u76f8\u4fe1\uff0c\u901a\u8fc7\u5206\u4eab\u6211\u6240\u5b66\u5230\u7684\uff0c\u4e5f\u80fd\u52a9\u4f60\u63d0\u5347\u5bf9\u5b83\u7684\u7406\u89e3\u3002 \u5728\u63a5\u4e0b\u6765\u7684\u56db\u5468\u91cc\uff0c\u8fd9\u7bc7\u6587\u7ae0\u5c06\u53d1\u5e03\u6210\u56db\u90e8\u5206\u3002\u5728\u8fd9\u7b2c\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u4e00\u77a5Drupal 8 \u6846\u67b6\u7684\u603b\u4f53\u67b6\u6784\uff0c\u7279\u522b\u662f\u4e0esymfony2 \u7ec4\u4ef6\u7684\u8054\u7cfb\u3002\u6211\u4eec\u5c06\u770b\u5230\u54ea\u4e9bsymfony2 \u7ec4\u4ef6\u5728Drupal\u4e2d\u7528\u5230\u4e86\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u3002\u5728\u4e0b\u4e00\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5b66\u4e60\u975e\u5e38\u91cd\u8981\u7684\u7c7b\u5bb9\u5668\u3002\u5728\u7b2c\u4e09\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5b66\u4e60Drupal 8 \u7684\u5f15\u5bfc\u548c\u8def\u7531\u3002\u4f60\u5c06\u5b66\u5230\u5982\u4f55\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u3002\u5728\u7b2c\u56db\u4e5f\u662f\u6700\u540e\u4e00\u90e8\u5206\uff0c\u5c06\u4f1a\u4ecb\u7ecddrupal 8\u7684\u5176\u5b83\u4e00\u4e9b\u4ee4\u4eba\u5174\u594b\u7684\u3001\u5168\u65b0\u7684\u7279\u6027\u3002","title":"\u4e00\u3001\u7ed3\u6784"},{"location":"drupal/drupal8/understanding-drupal8/#1symfony2","text":"Symfony\u6846\u67b6\u88ab\u8bbe\u8ba1\u7528\u6765\u4f7f\u5f00\u53d1\u8005\u80fd\u591f\u6784\u5efa\u81ea\u5b9a\u4e49\u7684Web\u5e94\u7528\u3002Symfony\u4e0d\u662f\u4e00\u4e2aCMS\uff0c\u56e0\u4e3a\u5b83\u4e0d\u80fd\u7528\u6765\u7ba1\u7406\u4e00\u4e2a\u7ad9\u70b9\u3002\u76f8\u53cd\uff0c\u8981\u6784\u5efa\u5e94\u7528\uff0c\u5fc5\u987b\u8981\u5199\u4ee3\u7801\u3002\u4e3a\u6b64\uff0csymfony\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u6cd5\u4f7f\u5f00\u53d1\u66f4\u5177\u6548\u7387\u3002\u7406\u8bba\u4e0a\uff0cCMS\u53ef\u4ee5\u57fa\u4e8eSymfony\u5f00\u53d1\uff0c\u4f46\u4e8b\u5b9e\u4e0a\uff0cSymfony\u7684\u9ed8\u8ba4\u65b9\u5f0f\u5bf9Drupal\u6765\u8bf4\u5e76\u4e0d\u7075\u6d3b\u3002 \u56e0\u6b64\uff0cDrupal 8\u53ea\u91c7\u7528\u4e86Symfony\u7684\u975e\u5e38\u4f18\u79c0\u7684\u5185\u6838\u5c42\uff0c\u5e76\u4e14\u6269\u5c55\u5b83\u4ee5\u652f\u6301Drupal\u6a21\u5757\u3002\u8fd9\u4fc3\u751f\u4e86\u4e00\u4e2a\u975e\u5e38\u5e73\u8861\u7684\u7cfb\u7edf\uff0c\u5b83\u91c7\u7528Symfony\u90e8\u5206\u4f18\u79c0\u7684\u5185\u6838\uff08\u800c\u4e14\u672a\u7ecf\u4fee\u6539\uff09\uff0c\u4f46\u662f\u53ef\u4ee5\u57fa\u4e8e\u4e00\u4e2a\u975e\u5e38\u7075\u6d3b\u7684CMS\u5c42\u6269\u5c55\u5b83\u3002","title":"1\u3001Symfony2"},{"location":"drupal/drupal8/understanding-drupal8/#2","text":"Symfony\u6846\u67b6\u7531\u6570\u4e2a\u7ec4\u4ef6\u6784\u6210\u3002\u6709\u4e9b\u5bf9\u7cfb\u7edf\u662f\u81f3\u5173\u91cd\u8981\u7684\uff0c\u4f8b\u5982\u80fd\u7406\u89e3HTTP\u534f\u8bae\u5e76\u4e14\u4e3a\u5176\u4ed6\u7ec4\u4ef6\u63d0\u4f9b\u826f\u597drequest\u548cresponse\u5bf9\u8c61\u7684Http Foundation\u7ec4\u4ef6\u3002\u5176\u4ed6\u7684\u4ec5\u662f\u8f85\u52a9\u7ec4\u4ef6\uff0c\u4f8b\u5982\u6821\u9a8c\u6570\u636e\u7684Validator\u7ec4\u4ef6\uff08\u68c0\u6d4b\u662f\u5426\u662f\u5408\u6cd5\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740/URL/\u6570\u5b57/\u7b49\u7b49\uff1f\uff09\u3002\u7cfb\u7edf\u7684\u6838\u5fc3\u662fKernel\u7ec4\u4ef6\u3002\u8fd9\u4e2a\u5185\u6838\u603b\u7684\u6765\u8bf4\u5c31\u662f\u4e00\u4e2a\u4e3b\u7c7b\uff0c\u5b83\u7ba1\u7406\u73af\u5883\uff08\u7c7b\u548c\u7a0b\u5e8f\u96c6\uff09\u5e76\u8d1f\u8d23\u5904\u7406http\u8bf7\u6c42\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u6269\u5c55\u5185\u6838\u6765\u6269\u5c55\u7cfb\u7edf\uff0c\u4f8b\u5982AppKernal\u5c31\u662f\u6269\u5c55\u4e86Kernal\uff0c\u5e76\u4e14\u5728\u91cc\u9762\u6dfb\u52a0\u4e86\u81ea\u5df1\u7684\u7a0b\u5e8f\u96c6\u3002\u8fd9\u4e9b\u7a0b\u5e8f\u96c6\u53ef\u4ee5\u6784\u5efa\u4e00\u7cfb\u5217\u8fde\u8d2f\u7684\u529f\u80fd\u96c6\u5408\uff0c\u975e\u5e38\u7c7b\u4f3c\u4e8eDrupal\u7684\u6a21\u5757\u3002 Drupal\u53ea\u4f7f\u7528\u4e86Symfony\u7684\u4e00\u90e8\u5206\u7ec4\u4ef6\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"2\u3001\u7ec4\u4ef6"},{"location":"drupal/drupal8/understanding-drupal8/#3drupal-8symfony","text":"Drupal\u4e0d\u6269\u5c55\u5185\u6838\uff0c\u800cSymfony\u5e94\u7528\u4f1a\u3002\u901a\u8fc7\u5b9e\u73b0\u5185\u6838\u63a5\u53e3\uff0cDrupal\u63d0\u4f9b\u4e86\u76f8\u4f3c\u7684\u529f\u80fd\u7c7b\u578b\u3002\u8fd9\u662f\u56e0\u4e3aDrupal\u4e0d\u5171\u4eabSymfony\u7684\u7a0b\u5e8f\u96c6\u65b9\u6cd5\u3002\u7a0b\u5e8f\u96c6\u63d0\u4f9b\u4e86\u6781\u597d\u7684\u65b9\u5f0f\u6765\u6784\u5efa\u81ea\u5b9a\u4e49\u7684web\u5e94\u7528\uff0c\u4f46\u662f\u4e0d\u9002\u5408\u6784\u5efa\u9700\u8981\u7075\u6d3b\u6027\u548c\u6269\u5c55\u6027\u7684CMS\u3002DrupalKernal\u52a0\u8f7d\u73af\u5883\uff08\u53ef\u7528\u7684\u7c7b\u548c\u6a21\u5757\uff09\u7684\u65b9\u5f0f\u4e0eKernal\u7a0d\u5fae\u4e0d\u540c\uff0c\u4f46\u662f\u548cSymfony Kernal\u4e00\u6837\uff0c\u90fd\u662f\u628a\u5c06http\u8bf7\u6c42\u59d4\u6258\u7ed9HttpKernel\u3002 \u4e0e\u6b64\u540c\u65f6\uff0cDrupal 8\u5f15\u5165\u4e86\u81ea\u5df1\u7684\uff08\u7b2c\u4e09\u65b9\uff09\u7ec4\u4ef6\u548c\u6838\u5fc3\u4ee3\u7801\uff0c\u793a\u610f\u6982\u89c8\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"3\u3001Drupal 8\u5982\u4f55\u6269\u5c55Symfony"},{"location":"drupal/drupal8/understanding-drupal8/#4","text":"\u8fd9\u91cc\u603b\u7ed3\u4e86\u201c\u5f00\u59cb\u5b66\u4e60Drupal 8\u201d\u8fd9\u7bc7\u6587\u7ae0\u3002\u4e0b\u5468\u6211\u4eec\u5c06\u5f00\u59cb\u5b66\u4e60\u7c7b\u5bb9\u5668\uff0c\u53ef\u4ee5\u7406\u89e3\u6210Drupal\u7cfb\u7edf\u7684\u9aa8\u67b6\u3002\u5728\u7406\u89e3\u4efb\u4f55\u5176\u4ed6\u7ec4\u4ef6\u524d\u4f60\u5fc5\u987b\u5148\u4e86\u89e3\u5b83\u3002","title":"4\u3001\u7ed3\u8bba"},{"location":"drupal/drupal8/understanding-drupal8/#_2","text":"\u8fd9\u662f\u201c\u7406\u89e3Drupal 8\u201d\u7684\u7b2c\u4e8c\u90e8\u5206\u3002\u5728\u7b2c\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86Drupal 8\u7684\u603b\u4f53\u67b6\u6784\u4ee5\u53ca\u5b83\u4e0eSymfony\u7684\u5173\u8054\u3002Symfony\uff08\u548cDrupal 8\uff09\u5305\u542b\u7740\u8bb8\u591a\u7ec4\u4ef6\u3002\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\uff0c\u4f60\u5c06\u4f1a\u5b66\u4e60\u5230\u4ec0\u4e48\u662f\u670d\u52a1\u5bb9\u5668\uff0c\u4ee5\u53ca\u5728Drupal 8\u4e2d\u600e\u4e48\u4f7f\u7528\u5b83\u3002\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\uff0c\u5728\u5b66\u4e60\u8def\u7531\u4e4b\u524d\u6211\u4eec\u5f97\u5148\u7406\u89e3\u670d\u52a1\u5bb9\u5668\u3002 Symfony\u91c7\u7528\u4e86\u670d\u52a1\u5668\u5bb9\u5668\uff0c\u5b83\u53ef\u4ee5\u9ad8\u6548\u5730\u7ba1\u7406\u5e94\u7528\u4e2d\u7684services\u3002\u8fd9\u4e2a\u6982\u5ff5\u4e5f\u5c31\u662f\u6240\u8c13\u7684Dependency Injection\u3002 \u670d\u52a1\u5bb9\u5668\u662f\u4e00\u4e2a\u5728\u5904\u7406\u8bf7\u6c42\u4e4b\u524d\u7531Kernal\u521b\u5efa\u5e76\u5305\u542b\u7684\u5168\u5c40\u5bf9\u8c61\u3002\u5b83\u80fd\u88ab\u7528\u6765\u83b7\u53d6\u670d\u52a1\uff0c\u52a8\u6001\u52a0\u8f7d\u670d\u52a1\u3002\u670d\u52a1\u662f\u7528\u4e8e\u5b8c\u6210\u7279\u5b9a\u4efb\u52a1\u7684\u5168\u5c40\u5bf9\u8c61\uff0c\u4f8b\u5982\u90ae\u4ef6\u670d\u52a1\u6216\u6570\u636e\u5e93\u8fde\u63a5\u3002\u4e00\u4e2a\u670d\u52a1\u5bf9\u5e94\u7740\u4e00\u4e2a\u786e\u5207\u7684\u7c7b\u3002\u670d\u52a1\u5bb9\u5668\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u5305\u542b\u53ef\u7528\u670d\u52a1\uff0c\u77e5\u9053\u5b83\u4eec\u7684\u8054\u7cfb\u548c\u914d\u7f6e\u4fe1\u606f\uff0c\u751a\u81f3\u6784\u9020\u5b83\u4eec\u3002","title":"\u4e8c\u3001\u670d\u52a1\u5bb9\u5668"},{"location":"drupal/drupal8/understanding-drupal8/#1","text":"\u4e00\u4e2a\u670d\u52a1\u53ef\u80fd\u4f9d\u8d56\u4e8e\u5176\u4ed6\u670d\u52a1\u3002Symfony\u6587\u6863\u4e3e\u4e86\u4e2a\u901a\u8baf\u7ba1\u7406\u670d\u52a1\u4f9d\u8d56\u90ae\u4ef6\u670d\u52a1\u6765\u53d1\u9001\u90ae\u4ef6\u7684\u4f8b\u5b50\u3002\u670d\u52a1\u5bb9\u4e5f\u7ba1\u7406\u7740\u8fd9\u4e9b\u4f9d\u8d56\u3002\u5f53\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u65f6\uff0c\u5b83\u7684\u4f9d\u8d56\u4f1a\u901a\u8fc7\u7c7b\u6784\u9020\u5668\u4e2d\u7684\u53c2\u6570\u8fdb\u884c\u4f20\u9012\u3002\u63a5\u53e3\u7528\u6765\u5b9a\u4e49\u4f9d\u8d56\u670d\u52a1\u8981\u63d0\u4f9b\u54ea\u4e9b\u65b9\u6cd5\uff0c\u8fd9\u6837\u5b9e\u73b0\u7684\u8fd9\u4e2a\u670d\u52a1\u624d\u80fd\u5728\u5fc5\u8981\u65f6\u4e0e\u53e6\u4e00\u4e2a\u670d\u52a1\u8fdb\u884c\u4ea4\u6362\u3002","title":"1\u3001\u4f9d\u8d56\u548c\u53c2\u6570"},{"location":"drupal/drupal8/understanding-drupal8/#2_1","text":"\u670d\u52a1\u5bb9\u5668\u4e2d\u7684\u670d\u52a1\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u8fdb\u884c\u914d\u7f6e\uff1a\u4ee3\u7801\uff08\u6240\u8c13\u7684\u6269\u5c55\uff09\uff0cXML\uff0cYAML\uff0c\u7b49\u7b49\u3002Symfony\u6df7\u5408\u7740\u4f7f\u7528\u8fd9\u4e9b\u65b9\u5f0f\uff0c\u4f46\u662f\u628a\u5927\u591a\u6570\u6838\u5fc3\u670d\u52a1\u914d\u7f6e\u7559\u7ed9\u4e86\u7a0b\u5e8f\u96c6\u4ee3\u7801\u3002Drupal\u7684\u670d\u52a1\u914d\u7f6e\u5219\u4e0d\u540c\uff0c\u5927\u90e8\u5206\u57fa\u4e8eyaml\u6587\u4ef6\u3002Drupal\u4f7f\u7528services.core.yml\u6765\u5173\u8054\u6240\u6709\u4e0e\u5185\u6838\u76f8\u5173\u7684\u914d\u7f6e\u3002\u8fd9\u4e2a\u914d\u7f6e\u53ef\u4ee5\u88ab\u6a21\u5757\u548cServiceProvider\u7c7b\u6269\u5c55\u3002 YAML\u63d0\u4f9b\u4e86\u53ef\u8bfb\u7684\u548c\u7075\u6d3b\u7684\u8bed\u6cd5\u3002Drupal 8\u4e2d\u7684\u4e00\u4e2a\u4f8b\u5b50\uff08\u6458\u81easervices.core.yml\uff09\uff1a services: ... router_listener: class: Symfony\\Component\\HttpKernel\\EventListener\\RouterListener tags: - { name: event_subscriber } arguments: ['@router'] ... router: class: Symfony\\Cmf\\Component\\Routing\\ChainRouter calls: - [setContext, ['@router.request_context']] - [add, ['@router.dynamic']] ... \u8fd9\u91cc\u5b9a\u4e49\u4e86router_listener\u670d\u52a1\u3002\u5bf9\u5e94\u7684\u7c7b\u8981\u6c42\u80fd\u591f\u52a0\u8f7d\u8fd9\u4e2a\u76d1\u542c\u5668\u3002arguments\u5c5e\u6027\u5b9a\u4e49\u4e86RouterListener \u6784\u9020\u5668\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff08URL\u6216\u8bf7\u6c42\u5339\u914d\u5668\uff09\u5e94\u8be5\u662fservice id\u662frouter\u7684\u670d\u52a1\uff1a\u2018 @router \u2019\u3002\u8fd9\u4e2a\u8def\u7531\u4e5f\u88ab\u5b9a\u4e49\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u800c\u4e14\u662f\u4e00\u4e2a\u4e0d\u540c\u4e8eSymfony\u4e2d\u4f7f\u7528\u7684\u2018\u7c7b\u2019\u3002","title":"2\u3001\u914d\u7f6e"},{"location":"drupal/drupal8/understanding-drupal8/#3","text":"\u6807\u7b7e\u88ab\u7528\u6765\u52a0\u8f7d\u7279\u5b9a\u7684\u6807\u7b7e\u5316\u7684\u670d\u52a1\u3002\u5728\u5b9e\u8df5\u4e2d\uff0cdrupal\u6709\u65f6\u4f7f\u7528\u94a9\u5b50\u65b9\u5f0f\u3002\u5728\u4ee5\u4e0b\u4f8b\u5b50\u4e2d\uff08node.services.yml\uff09\uff0cnode\u6a21\u5757\u4e3a'add node'\u9875\u9762\u589e\u52a0\u4e86\u4e00\u4e2a\u8bbf\u95ee\u68c0\u67e5\uff0c\u57fa\u4e8eaccess_check\u670d\u52a1\u6a21\u5f0f\uff0c\u5f53\u8bbf\u95ee\u65f6\uff0c\u5c06\u4f1a\u68c0\u67e5\u8bbf\u95ee\u662f\u5426\u88ab\u5141\u8bb8\u3002 services: ... access_check.node.add: class: Drupal\\node\\Access\\NodeAddAccessCheck arguments: ['@plugin.manager.entity'] tags: - { name: access_check } ...","title":"3\u3001\u6807\u7b7e\u5316\u7684\u670d\u52a1"},{"location":"drupal/drupal8/understanding-drupal8/#4compiler-passes","text":"Drupal\u662f\u5982\u4f55\u7406\u89e3\u8fd9\u4e9b\u6807\u7b7e\u4ee5\u53ca\u5982\u4f55\u5904\u7406\u5b83\u4eec\u7684\u5462\uff1f\u597d\uff0cSymfony\u5df2\u7ecf\u6709\u53e6\u5916\u4e00\u79cd\u52a8\u6001\u914d\u7f6e\u670d\u52a1\u5bb9\u5668\u7684\u65b9\u6cd5\uff1aCompiler pasess\u3002\u670d\u52a1\u5bb9\u5668\u5b9e\u9645\u4e0a\u5728\u7528\u9759\u6001\u914d\u7f6e\u6784\u5efa\u4e4b\u540e\u5c31\u88ab\u7f16\u8bd1\u4e86\u3002\u5728\u8fd9\u4e2a\u671f\u95f4\uff0c\u5b83\u5141\u8bb8\u5bf9\u8c61\u5b9e\u73b0CompilerPassInterface \u7c7b\u6765\u66f4\u6539\u914d\u7f6e\u3002\u5728Drupal\u4e2d\uff0cCoreServiceProvider \u6ce8\u518c\u4e86\u4e00\u4e9b\u975e\u5e38\u91cd\u8981\u7684Compiler pasess\uff0c\u4f8b\u5982RegisterAccessChecksPass\uff0c\u5b83\u4f1a\u8bd5\u56fe\u627e\u5230\u6240\u6709\u52a0\u4e86access_check\u6807\u7b7e\u7684\u670d\u52a1\uff08\u89c1\u4e0a\u4f8b\uff09\u7136\u540e\u628a\u5b83\u6dfb\u52a0\u5230AccessManager\uff08\u901a\u8fc7\u4f7f\u7528addMethodCall\u5bb9\u5668\u6307\u4ee4\uff09\u4e2d\u3002\u5728\u8def\u7531\u9636\u6bb5\uff0cAccessManager \u4f1a\u68c0\u67e5\u8bbf\u95ee\u6743\u9650\uff0c\u5b83\u5c06\u5728\u5176\u4ed6\u7c7b\u4e4b\u95f4\u68c0\u67e5NodeAddAccessCheck\u3002\u5728drupal\u5185\u6838\u4e2d\u8fd8\u6709\u51e0\u4e2a\u5176\u4ed6\u7684Compiler pasess\uff0c\u4f8b\u5982\u7528\u4e8e\u5c06\u8def\u7531\u53c2\u6570\u8f6c\u6362\u6210\u5bf9\u8c61\u548c\u8f6c\u4e49\u5b57\u7b26\u4e32\u7684Compiler passes\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u4f60\u6709\u65f6\u9700\u8981\u5728\u6a21\u5757\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u6807\u7b7e\u5316\u7684\u670d\u52a1\u6765\u589e\u52a0\u81ea\u5b9a\u4e49\u8bbf\u95ee\u6821\u9a8c\uff0c\u8f6c\u6362\u8def\u5f84\u53c2\u6570\u3002","title":"4\u3001Compiler passes"},{"location":"drupal/drupal8/understanding-drupal8/#5swapping-services","text":"\u670d\u52a1\u5bb9\u5668\u4f7f\u7075\u6d3b\u7684\u670d\u52a1\u914d\u7f6e\u6210\u4e3a\u53ef\u80fd\u3002Drupal 8\u4f7f\u7528\u670d\u52a1\u53c2\u6570\u6539\u53d8\u4e86Symfony\u4f7f\u7528\u8fd9\u4e9b\u53c2\u6570\u5b9e\u73b0\u81ea\u5df1\u529f\u80fd\u7684\u65b9\u5f0f\u3002\u4f8b\u5982\uff0cdrupal\u9700\u8981\u4e00\u4e2a\u4e0d\u540c\u4e8eSymfony\u7684url\u8def\u7531\u673a\u5236\u3002\u4e0eSymfony\u7684(Symfony\\Bundle\\FrameworkBundle\\Routing\\Router)\u76f8\u6bd4\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e0d\u540c\u7684\u8def\u7531\u670d\u52a1(Symfony\\Cmf\\Component\\Routing\\ChainRouter)\u6765\u5b9e\u73b0\u3002\u800c\u8fd9\u4e2a \u4e0d\u9700\u8981\u6539\u53d8router_listerner (Symfony\\Component\\HttpKernel\\EventListener\\RouterListener)\u7c7b\u672c\u8eab\u7684\u4efb\u4f55\u4e00\u884c\u4ee3\u7801\u3002\u7531\u4e8e\u4e24\u4e2a\u8def\u7531\u90fd\u5b9e\u73b0\u4e86RequestMatcherInterface\u63a5\u53e3\uff0c\u800c\u8fd9\u4e2a\u63a5\u53e3\u662fRouterListener\u7684\u7b2c\u4e00\u4e2a\u5fc5\u8981\u53c2\u6570\uff0c\u6240\u4ee5\u8fd9\u4e2a\u662f\u53ef\u4ee5\u5b9e\u73b0\u7684\u3002","title":"5\u3001Swapping services"},{"location":"drupal/drupal8/understanding-drupal8/#6","text":"\u5728\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5b66\u4e60\u4e86Drupal 8 \u7684\u670d\u52a1\u5bb9\u5668\u7ec4\u4ef6\u3002\u73b0\u5728\uff0c\u4f60\u5bf9Drupal8\u4e0d\u4fee\u6539\u4e00\u884c\u4ee3\u7801\u5b9e\u73b0\u81ea\u5df1\u7684\u670d\u52a1\u66ff\u6362Symfony2\u7684\u670d\u52a1\u5e94\u8be5\u6709\u4e86\u66f4\u597d\u7684\u8ba4\u8bc6\u3002\u8fd9\u5141\u8bb8drupal\u5185\u6838\u7ef4\u62a4\u8005\u8f7b\u677e\u5730\u5347\u7ea7Symfony2\u3002\u5f53\u5b66\u4e60Drupal 8\u65f6\uff0c\u4f60\u4f1a\u7ecf\u5e38\u7ffb\u9605core.services.yml\u6587\u4ef6\u67e5\u627e\u6b63\u5728\u4f7f\u7528\u7684\u670d\u52a1\u3002 \u4e0b\u5468\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5b66\u4e60Drupal 8\u7684\u63a7\u5236\u6d41\u7a0b\u548c\u8def\u7531\u3002","title":"6\u3001\u7ed3\u8bba"},{"location":"drupal/drupal8/understanding-drupal8/#_3","text":"\u8fd9\u662f'\u7406\u89e3drupal8'\u7684\u7b2c\u4e09\u90e8\u5206\uff0c\u5728\u524d2\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5b66\u4e60\u4e86drupal8\u548cSymfony\u7684\u7ed3\u6784\u5316\u5dee\u5f02\u3002\u8fd9\u90e8\u5206\u6211\u4eec\u5c06\u5b66\u4e60drupal8\u5982\u4f55\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u3002\u9996\u5148\uff0c\u6211\u4eec\u5c06\u770b\u4e0b\u5f15\u5bfc\u9636\u6bb5\u4ee5\u53ca\u63a7\u5236\u6d41\u7a0b\uff0c\u7136\u540e\u6211\u4eec\u5c06\u4f1a\u5b66\u4e60\u4e8b\u4ef6\u8ba2\u9605\uff0c\u8fd9\u662f\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u9700\u8981\u4f60\u5728\u5b66\u4e60\u8bf7\u6c42\u5904\u7406\u4e4b\u524d\u5c31\u7406\u89e3\u5b83\u3002","title":"\u4e09\u3001\u8def\u7531"},{"location":"drupal/drupal8/understanding-drupal8/#1flow-of-control","text":"\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u5b66\u4e60\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\u4e4b\u540e\uff0cdrupal8\u662f\u5982\u4f55\u5904\u7406\u7684\u3002","title":"1\u3001\u6d41\u7a0b\u63a7\u5236(Flow of control)"},{"location":"drupal/drupal8/understanding-drupal8/#1bootstrap","text":"\u2460\u3001\u8bfb\u53d6settings.php\u6587\u4ef6\uff08\u4e00\u822c\u5728sites/default/\u4e0b\uff09\uff0c\u52a8\u6001\u751f\u6210\u4e00\u4e9b\u5176\u5b83\u8bbe\u7f6e\u4fe1\u606f\uff0c\u4fdd\u5b58\u5230\u5168\u5c40\u53d8\u91cf\u548cDrupal\\Component\\Utility\\Settings\u5bf9\u8c61\u4e2d\u3002 \u2461\u3001\u6267\u884c\u7c7b\u52a0\u8f7d\u5668(class loader)\uff0c\u52a0\u8f7d\u7c7b\u3002 \u2462\u3001\u8bbe\u7f6eDrupal\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002 \u2463\u3001\u68c0\u6d4bDrupal\u662f\u5426\u6b63\u786e\u5b89\u88c5\uff0c\u5982\u6ca1\u6709\uff0c\u5219\u8df3\u8f6c\u5230\u5b89\u88c5\u754c\u9762\u3002","title":"1)\u3001bootstrap\u914d\u7f6e"},{"location":"drupal/drupal8/understanding-drupal8/#2drupal","text":"","title":"2)\u3001\u6784\u5efaDrupal\u5185\u6838"},{"location":"drupal/drupal8/understanding-drupal8/#3service-container","text":"","title":"3)\u3001\u521d\u59cb\u5316service container\uff08\u4ece\u7f13\u5b58\u6216\u8005\u91cd\u5efa\uff09"},{"location":"drupal/drupal8/understanding-drupal8/#4containerdrupal","text":"","title":"4)\u3001\u628acontainer\u6dfb\u52a0\u5230Drupal\u9759\u6001\u7c7b"},{"location":"drupal/drupal8/understanding-drupal8/#5drupal7","text":"","title":"5)\u3001\u5c1d\u8bd5\u52a0\u8f7d\u7f13\u5b58\u7684\u9759\u6001\u9875(\u7c7b\u4f3cDrupal7)"},{"location":"drupal/drupal8/understanding-drupal8/#6variable_get","text":"","title":"6)\u3001\u52a0\u8f7d\u6240\u6709\u53d8\u91cf(variable_get) \uff1f\u8fd9\u4e2a\u51fd\u6570\u5df2\u7ecf\u53bb\u6389\u4e86"},{"location":"drupal/drupal8/understanding-drupal8/#7","text":"","title":"7)\u3001\u52a0\u8f7d\u5176\u4ed6\u5fc5\u8981\u7684\u6587\u4ef6"},{"location":"drupal/drupal8/understanding-drupal8/#8stream-wrapperspublic-private-temp","text":"","title":"8)\u3001\u6ce8\u518cstream wrappers(public://, private://, temp://\uff0c\u81ea\u5b9a\u4e49)"},{"location":"drupal/drupal8/understanding-drupal8/#9httpsymfony-httpfoundation","text":"","title":"9)\u3001\u521b\u5efaHTTP\u8bf7\u6c42\u5bf9\u8c61\uff08\u4f7f\u7528Symfony HttpFoundation\uff09"},{"location":"drupal/drupal8/understanding-drupal8/#10drupalkernel","text":"","title":"10)\u3001DrupalKernel\u5904\u7406\u5e76\u8fd4\u56de\u7ed3\u679c"},{"location":"drupal/drupal8/understanding-drupal8/#11","text":"","title":"11)\u3001\u53d1\u9001\u8fd4\u56de\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef"},{"location":"drupal/drupal8/understanding-drupal8/#12","text":"\u5176\u4e2d\u6700\u503c\u5f97\u63a2\u8ba8\u7684\u662f\u5728\u8bf7\u6c42\u5904\u7406\u9636\u6bb5\u7a76\u7adf\u53d1\u751f\u4e86\u4ec0\u4e48?\u8981\u4e86\u89e3\u8fd9\u70b9\uff0c\u6211\u4eec\u5148\u6765\u5b66\u4e60\u4e8b\u4ef6\u76d1\u542c\u3002","title":"12)\u3001\u4e2d\u65ad\u8bf7\u6c42"},{"location":"drupal/drupal8/understanding-drupal8/#2event-subscribers","text":"\u4e4b\u524d\uff0c\u6211\u4eec\u63a2\u8ba8\u4e86Compiler passes\u3002\u6807\u7b7e\u5316\u670d\u52a1\u4e00\u4e2a\u6700\u91cd\u8981\u7684\u7528\u5904\u5c31\u662f\uff0cevent_subscriber-tagged\u670d\u52a1\u3002\u8fd9\u4e9b\u670d\u52a1\u5e94\u8be5\u5b9e\u73b0\u4e86EventSubscriberInterface\uff0c\u5e76\u4e14\u57fa\u672c\u4e0a\u90fd\u662f\u4e8b\u4ef6\u76d1\u542c\u5668\u3002\u4e8b\u4ef6\u4f1a\u58f0\u660e\u4e00\u4e2agetSubscribedEvents\u65b9\u6cd5\u5b9a\u4e49\u54ea\u4e2a\u4e8b\u4ef6\u5e94\u8be5\u6620\u5c04\u5230\u54ea\u4e2a\u5904\u7406\u65b9\u6cd5\uff0c\u5e76\u8bbe\u7f6e\u4e00\u4e2a\u5c5e\u6027\u6765\u51b3\u5b9a\u4e8b\u4ef6\u52a8\u4f5c\u6267\u884c\u7684\u987a\u5e8f\u3002\u5728Drupal\u6838\u5fc3\u4e2d\u53ea\u6709\u5c11\u6570\u4e8b\u4ef6\u5728\u8c03\u7528\uff1a \u2460\u3001kernel.request \u8bf7\u6c42\u5206\u53d1\u7684\u6700\u521d\u9636\u6bb5\u8c03\u7528 \u2461\u3001kernel.response \u8bf7\u6c42\u54cd\u5e94\u7684\u65f6\u5019\u8c03\u7528 \u2462\u3001routing.route_dynamic \u5141\u8bb8\u6a21\u5757\u52a0\u8f7d\u989d\u5916\u7684\u8def\u7531 \u2463\u3001routing.route_alter \u5141\u8bb8\u5728route collection\u4e2d\u6539\u53d8routes\u3002\u4e3b\u8981\u7528\u4e8e\u6838\u5fc3\u6dfb\u52a0\u4e00\u4e9b\u6821\u9a8c\u548c\u53c2\u6570\u8f6c\u6362\u3002 \u6bcf\u4e2aDrupal\u5f00\u53d1\u8005\u90fd\u5e94\u8be5\u4e86\u89e3\u4e8b\u4ef6\u8ba2\u9605\u3002\u5c24\u5176\u662fkernel.request\uff0c\u56e0\u4e3a\u5b83\u66ff\u6362\u4e86hook_init(Drupal7)\u3002\u53e6\u5916\u4e00\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u4e8b\u4ef6\u662frouting.route_dynamic\u4e8b\u4ef6\u3002\u56e0\u4e3a\u5b83\u53ef\u4ee5\u521b\u5efa\u52a8\u6001\u8def\u7531\uff0c\u800c\u4e00\u822c\u8def\u7531\u662f\u5728yaml\u6587\u4ef6\u4e2d\u9759\u6001\u914d\u7f6e\u7684\u3002\u5728Drupal8\u4e4b\u524d\uff0c\u90fd\u662f\u5728hook_menu\u4e2d\u5b9e\u73b0\uff0c\u4f46\u73b0\u5728hook_menu\u4ec5\u7528\u4e8e\u751f\u6210\u83dc\u5355\u9879\u3002\u5982block\u6a21\u5757\u5728\\Drupal\\block\\Routing\\RouteSubscriber\u7528 routing.route_dynamic\u6ce8\u518c\u8def\u7531\u7528\u4e8e\u533a\u5757\u914d\u7f6e\u9875\u9762\u3002 \u4f60\u53ef\u80fd\u4f1a\u5947\u602a\u4e8b\u4ef6\u8ba2\u9605\u5e72\u561b\u4e0d\u7528hook\u5462\uff1f\u56e0\u4e3a\u8fd9\u662f\u4e00\u79cd\u5f88\u6709\u6548\u7684\u65b9\u5f0f\uff0c\u6240\u6709\u53ef\u7528\u7684\u4e8b\u4ef6\u76d1\u542c\u90fd\u5df2\u7ecf\u7f16\u8bd1\u5230\u4e86\u670d\u52a1\u5bb9\u5668\u4e2d\uff0c\u800c\u4e14\u8fd8\u88ab\u7f13\u5b58\u7740\uff01\u540c\u65f6\uff0c\u5b83\u4e5f\u4f1a\u8ba9Drupal\u66f4\u52a0\u8d8b\u4e8e\u9762\u5411\u5bf9\u8c61\u3002","title":"2\u3001\u4e8b\u4ef6\u8ba2\u9605(Event subscribers)"},{"location":"drupal/drupal8/understanding-drupal8/#3from-request-to-response","text":"\u5f53\u4e00\u4e2a\u8bf7\u6c42\u6765\u65f6\uff0c\u7cfb\u7edf\u5f00\u59cb\u5f15\u5bfc\uff0c\u542f\u52a8DrupalKernel\uff0c\u8c03\u7528\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0c\u59d4\u6d3e\u8bf7\u6c42\u7ed9Symfony2\u7684HttpKernel\u505a\u8fdb\u4e00\u6b65\u5904\u7406\u3002 HttpKernel\u5206\u53d1kernel.request\u4e8b\u4ef6\uff0c\u4e00\u4e9b\u8ba2\u9605\u76d1\u542c\u4e8b\u4ef6\u5c06\u6309\u7167\u987a\u5e8f\u6267\u884c\uff1a \u2460\u3001AuhtenticationSubscriber \u52a0\u8f7dsession\uff0c\u8bbe\u7f6e\u5168\u5c40\u7528\u6237 \u2461\u3001LanguageRequestSubscriber \u68c0\u6d4b\u5f53\u524d\u8bed\u8a00 \u2462\u3001PathSubscriber \u5c06url\u8f6c\u6362\u4e3a\u7cfb\u7edf\u8def\u5f84(url\u522b\u540d\u7b49) \u2463\u3001LegacyRequestSubscriber \u5141\u8bb8\u8bbe\u7f6e\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e3b\u9898\u5e76\u521d\u59cb\u5316 \u2464\u3001MaintenanceModeSubscriber \u5982\u679c\u662f\u7ef4\u62a4\u6a21\u5f0f\uff0c\u663e\u793a\u7ef4\u62a4\u9875\u9762 \u2465\u3001RouteListener \u83b7\u53d6\u6240\u6709\u5df2\u52a0\u8f7d\u7684\u8def\u7531\u5bf9\u8c61 \u2466\u3001AccessSubscriber \u68c0\u67e5\u5ba2\u6237\u7aef\u7684\u8bbf\u95ee\u6743\u9650 RouterListener\u5728\u8def\u7531\u5de5\u4f5c\u7684\u65f6\u5019\u8c03\u7528\uff0c\u83b7\u53d6\u8def\u7531\u670d\u52a1\u8fd4\u56de\u7684\u8def\u7531\u5c5e\u6027\u3002Drupal\u7684\u8def\u7531\u670d\u52a1\u8ddfSymfony\u7684\u4e0d\u540c\uff1aDynamicRouter\u5728Symfony\u4e2d\u4ec5\u4ec5\u4ee5\u63d2\u4ef6\u5f62\u5f0f\u63d0\u4f9b\uff0c\u89c1http://cmf.symfony.com/\u3002\u4e0eSymfony\u5e38\u89c4\u8def\u7531\u7684\u4e3b\u8981\u533a\u522b\u5728\u4e8e\uff0cDrupal\u7684DynamicRouter\u652f\u6301\u589e\u5f3a\uff0c\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8ba8\u8bba\u3002DynamicRouter\u7c7b\u63a5\u4e0b\u6765\u4f1a\u628a\u67e5\u627e\u5f53\u524d\u8def\u7531\u7684\u4efb\u52a1\uff08\u7c7b\u4f3c\u4e8eDrupal 7\u4e2d\u7684current_path\uff09\u59d4\u6d3e\u7ed9NestedMatcher, \u800cNestedMatcher\u53c8\u4f1a\u628a\u8fd9\u4e2a\u4efb\u52a1\u59d4\u6d3e\u7ed9RouteProvider\u3002RouteProvider\u4f1a\u5728router\u8868\u4e2d\u627e\u5230\u5339\u914d\u8be5\u8def\u7531\u7684\u8def\u7531\uff0c\u4e5f\u5305\u62ec\u5728CMS\u4e2d\u7684\u5df2\u7f13\u5b58\u7684\u8def\u7531\u3002\u8fd9\u4e2a\u8def\u7531\u8868\u662f\u7531route builder\u521b\u5efa\uff0c\u7ad9\u70b9\u6211\u4eec\u7a0d\u540e\u518d\u505a\u4ecb\u7ecd\u3002\u8def\u7531\u6309\u7167\u8def\u5f84\u957f\u5ea6\u8fdb\u884c\u5339\u914d\uff1a\u6700\u957f\u7684\u5339\u914d\u8def\u5f84\u88ab\u8ba4\u4e3a\u662f\u6b63\u786e\u7684\u3002\u7136\u540e\uff0cNestedMatcher\u8981\u6c42UrlMatcher\u5728\u8def\u7531\u96c6\u4e2d\u9009\u5b9a\u90a3\u4e2a\u7279\u5b9a\u7684\u6d3b\u8dc3\u8def\u7531\u3002\u901a\u5e38\uff0c\u80fd\u6b63\u786e\u7684\u901a\u8fc7http/https\u901a\u8fc7GET/POST\u65b9\u5f0f\u8bbf\u95ee\u7684\u8def\u7531\u5c06\u88abUrlMatcher\u4f18\u5148\u5339\u914d(\u6700\u957f\u5339\u914d)\u3002\u5f53\u7136\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ea\u4f1a\u5b9a\u4e49\u4e00\u4e2a\u8def\u7531\uff0c\u6240\u4ee5UrlMatcher\u7684\u4f5c\u7528\u5f88\u6709\u9650\u3002\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u662f\u5339\u914d\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u6d3b\u8dc3\u8def\u7531\uff0c\u5982node.add_page\u3002 \u63a5\u4e0b\u6765\u6211\u4eec\u4e86\u89e3\u4e00\u4e0broute filters\uff0c\u53ef\u80fd\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u5e76\u4e0d\u4e00\u5b9a\u7528\u5230\u3002\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u6253\u4e86\u6807\u7b7e\u540d\u4e3aroute_filter\u7684service\uff0c\u8fd9\u4e9broute filters\u5c06\u88abNestedMatcher\u8c03\u7528\uff0c\u5728RouteProvider\u8fd4\u56de\u6b63\u786e\u8def\u7531\u4fe1\u606f\u4e4b\u540e\u76f4\u63a5\u8fc7\u6ee4\u8def\u7531\u96c6\u3002Drupal\u6838\u5fc3\u4ec5\u5bf9\u6ca1\u6709\u8fd4\u56deMIME\u7c7b\u578b\u7684\u8def\u7531\u91c7\u7528mechanism\u540d\u505a\u8fc7\u6ee4\u64cd\u4f5c\uff0c\u5f53\u7136\uff0c\u8fd8\u5f97\u663e\u793a\u6307\u5b9a\"_format\"\u3002 \u5339\u914d\u5230\u8bf7\u6c42\u8def\u7531\u540e\uff0cDynamicRouter\u7ee7\u7eed\u8c03\u7528\u8def\u7531\u7684\u589e\u5f3a\u5c5e\u6027\uff0c\u5305\u542b\u8def\u7531\u5c5e\u6027\uff0c\u8f6c\u6362\u8def\u7531\u53c2\u6570\u3002\u4e0b\u4e00\u8282\u5c06\u8bb2\u8ff0\u8fd9\u4e2a\u8fc7\u7a0b\u3002\u7136\u540e\u8def\u7531\u5c5e\u6027\u4f1a\u8fd4\u56de\u7ed9RouterListener\uff0c\u5e76\u8bbe\u7f6e\u5728\u8bf7\u6c42\u5bf9\u8c61\u4e2d\u3002\u63a5\u4e0b\u6765\uff0c\u6267\u884c\u6743\u9650\u68c0\u67e5(AccessSubscriber)\uff0c\u6700\u540e\uff0c\u4f7f\u7528\u6b63\u786e\u7684\u53c2\u6570\u8c03\u7528\u63a7\u5236\u5668\u65b9\u6cd5\uff0c\u63a7\u5236\u5668\u8fd4\u56de\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef\u3002 \u73b0\u5728\u6211\u4eec\u77e5\u9053\u4e86\u8bf7\u6c42\u7684\u5904\u7406\u8fc7\u7a0b\uff0c\u63a5\u4e0b\u6765\u518d\u6765\u7814\u7a76\u4e00\u4e0b\u8def\u7531\u3002","title":"3\u3001\u4ece\u8bf7\u6c42\u5230\u54cd\u5e94(From request to response)"},{"location":"drupal/drupal8/understanding-drupal8/#4_1","text":"\u5728Drupal7\u4e2d\uff0chook_menu\u7528\u4e8e\u6ce8\u518c\u9875\u9762\u56de\u6389\u51fd\u6570(page callbacks)\u3001\u6807\u9898(titles)\u3001\u53c2\u6570(arguments)\u3001\u8bbf\u95ee\u8981\u6c42(requirements)\u7b49\uff0cDrupal8\u4e2d,\u91c7\u7528\u4e86Symfony\u7684\u8def\u7531\uff0c\u5c06\u66f4\u52a0\u7075\u6d3b\uff0c\u4e5f\u66f4\u590d\u6742\u3002 Drupal8\u4e2d\u5c06\u4e0d\u4f1a\u518d\u6709\u9875\u9762\u56de\u6389\u51fd\u6570\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u63a7\u5236\u5668\u7c7b\u7684\u65b9\u6cd5\u3002\u8fd9\u4e9b\u6709\u6548\u7684\u8def\u7531\u73b0\u5728\u4f1a\u88ab\u914d\u7f6e\u5728\u6a21\u5757\u76ee\u5f55\u4e0b\u7684{module}.routing.yml\u6587\u4ef6\u4e2d\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u7528\u6237\u9000\u51fa\u767b\u9646\u7684\u914d\u7f6e\uff1a user.logout: path: '/user/logout' defaults: _controller: '\\Drupal\\user\\Controller\\UserController::logout' requirements: _user_is_logged_in: 'TRUE' \u6ce8\u610f\uff1a\u4efb\u4f55\u8def\u7531\u90fd\u9700\u8981\u4e00\u4e2aID(user.logout)\u548c\u8def\u5f84(/user/logout)\u3002\u5728\u8def\u5f84\u4e2d\u4e5f\u53ef\u5305\u542b\u53c2\u6570\uff0c\u540e\u9762\u518d\u6765\u8ba8\u8bba\u3002'default'\u975e\u5e38\u91cd\u8981\uff0c\u5b83\u7528\u4e8e\u63a7\u5236\u8bf7\u6c42\u8def\u5f84\u5339\u914d\u65f6\u9700\u8981\u505a\u4ec0\u4e48\u3002'requirement'\u5b9a\u4e49\u4e86\u662f\u5426\u5e94\u8be5\u5904\u7406\u8bf7\u6c42\uff0c\u901a\u5e38\u5305\u62ec\u8bbf\u95ee\u68c0\u67e5\uff0cSymfony\u66ff\u4ee3\u4e86Drupal7\u7684'access arguments'\u548c'access callback'\u3002","title":"4\u3001\u8def\u7531"},{"location":"drupal/drupal8/understanding-drupal8/#default","text":"\u2460\u3001_controller \u8fd4\u56de\u4e00\u4e2a\u9884\u671f\u7684\u7ed3\u679c\uff0c\u901a\u8fc7\u8c03\u7528\u7279\u5b9a\u7684\u65b9\u6cd5\u3002 \u2461\u3001_content \u5982\u6307\u5b9a\uff0c\u57fa\u4e8e\u8bf7\u6c42\u7684MIME\u7c7b\u578b\u8bbe\u7f6e_controller\uff0c\u5e76\u7528\u7279\u5b9a\u7684\u65b9\u6cd5(\u901a\u5e38\u662f\u5b57\u7b26\u4e32\u6216\u6570\u7ec4)\u586b\u5145\u8fd4\u56de\u503c \u2462\u3001_form \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6e\u7ed9HtmlFormController::content\u54cd\u5e94\u7279\u5b9a\u7684\u8868\u5355\u3002\u8fd9\u4e2aform\u662f\u4e00\u4e2a\u7c7b\u540d\uff0c\u5b9e\u73b0\u4e86FormInterface\uff0c\u800c\u4e14\u901a\u5e38\u7ee7\u627f\u81eaFormBase\u3002\u5f53\u7136\u8868\u5355\u7684\u6784\u5efa\u4e5f\u662f\u9762\u5411\u5bf9\u8c61\u7684\u3002 \u2463\u3001_entity_form \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6e\u7ed9HtmlEntityFormController::content\u8fd4\u56de\u7279\u5b9a\u7684\u5b9e\u4f53\u8868\u5355(\u5982{entity_type}.{add|edit|delete}) \u2464\u3001_entity_list \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6e\u7ed9HtmlFormController::content\uff0c_content\u8bbe\u7f6e\u7ed9EntityListController::listing\uff0c\u57fa\u4e8e\u5b9e\u4f53\u7c7b\u578b\u5217\u8868\u63a7\u5236\u5668\u8fd4\u56de\u4e00\u4e2a\u5b9e\u4f53\u5217\u8868\uff0c\u4f7f\u7528\u671f\u671b\u5b9e\u4f53\u7684EntityListController\u63d0\u4f9b\u4e00\u4e2a\u5b9e\u4f53\u5217\u8868\u3002\u4f8b:_entity_list: view_mode\u8fd4\u56de\u4e00\u4e2a\u89c6\u56fe\u6a21\u5f0f\u7684\u6e32\u67d3\u6570\u7ec4\u3002 \u2465\u3001_entity_view \u5982\u6307\u5b9a\uff0c_controller\u8bbe\u7f6eHtmlFormController::content\uff0c_content\u8bbe\u7f6eEntityViewController::view \uff0c\u5728\u7ed9\u5b9a\u7684\u89c6\u56fe\u6a21\u5f0f\u4e0b\uff0c\u901a\u8fc7\u8def\u5f84\u548c\u6e32\u67d3\u6a21\u5f0f\u4e0b\u67e5\u627e\u4e00\u4e2a\u5b9e\u4f53\u3002\u5982: _entity_view:node.teaser\u3002 \u5728\u89c6\u56fe\u6a21\u5f0f\u4e0b\u5c06\u8fd4\u56de\u4e00\u4e2a{node}\u7684\u6e32\u67d3\u6570\u7ec4\u3002 \u2466\u3001_title \u9875\u9762\u7684\u6807\u9898(\u5b57\u7b26\u4e32) \u2467\u3001_title_callback \u9875\u9762\u7684\u6807\u9898(\u65b9\u6cd5\u56de\u8c03)","title":"\u5e38\u7528'default'\u952e\uff1a"},{"location":"drupal/drupal8/understanding-drupal8/#requirement","text":"\u2460\u3001_permission \u6307\u5b9a\u5f53\u524d\u7528\u6237\u9700\u8981\u62e5\u6709\u7684\u7279\u5b9a\u6743\u9650 \u2461\u3001_role \u6307\u5b9a\u5f53\u524d\u7528\u6237\u9700\u8981\u62e5\u6709\u7684\u7279\u5b9a\u89d2\u8272 \u2462\u3001_method \u5141\u8bb8\u7684HTTP\u65b9\u6cd5\uff0c\u5982GET\u3001POST\u7b49 \u2463\u3001_schema \u4e00\u822c\u4e3ahttp\u6216https\uff0c\u5e76\u4e14\u8bf7\u6c42\u7684scheme\u548c\u5b9a\u4e49\u7684schema\u8981\u4e00\u81f4\u3002\u5f53\u4f7f\u7528Drupal::url()\u8f93\u51faurl\u65f6\u4e5f\u4f1a\u5e26\u5165\u8fd9\u4e2a\u5c5e\u6027\u3002 \u2464\u3001_node_add_access \u5b9a\u4e49\u67d0\u4e9bnode type\u7684\u8bbf\u95ee\u63a7\u5236 \u2465\u3001_entity_access \u5b9e\u4f8b\u7684\u8bbf\u95ee\u63a7\u5236 \u2466\u3001_format \u683c\u5f0f\u5316MIME\u7c7b\u578b \u4e0a\u9762\u6240\u5217\u7684\u5927\u591a\u6570(\u4f46\u4e0d\u662f\u6240\u6709)\u7684requirement'\u662f\u7531access checkers'\u8fdb\u884c\u6821\u9a8c\uff0c\u8fd9\u4e2a\u6211\u4eec\u7a0d\u540e\u4ecb\u7ecd\u3002\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684access checkers,\u56e0\u4e3aDrupal 7\u7684'access callback'\u5df2\u4e0d\u518d\u53ef\u7528\u3002\u50cfnode\u6a21\u5757\u4e2d\u7684'_node_add_access',\u901a\u8fc7\u5b9a\u5236\u7684\u6743\u9650\u63a7\u5236(NodeAddAccessCheck)\u6765\u5904\u7406\u3002 AccessManager\u6267\u884c\u6743\u9650\u63a7\u5236,\u8ba2\u9605kernel.requet\u7684\u4e8b\u4ef6\u3002\u8c03\u7528\u6743\u9650\u68c0\u6d4b\uff0c\u5fc5\u987b\u5b9e\u73b0AccessInterface\u7c7b\u3002\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5230\u6743\u9650\u68c0\u6d4b\u4f1a\u88ab\u6ce8\u518c\u4e3a\u6253\u4e86\u6807\u7b7eaccess_check\u7684services\u3002\u6743\u9650\u68c0\u6d4b\u4f1a\u6709\u4e00\u4e2a\u65b9\u6cd5\u53bb\u68c0\u6d4b\u5ba2\u6237\u7aef\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u6307\u5b9a\u7684\u8def\u7531\uff0c\u5982\u679c\u8bbf\u95ee\u88ab\u62d2\u7edd,\u4f1a\u629b\u51fa\u4e00\u4e2a\u201c\u62d2\u7edd\u8bbf\u95ee\u201d\u9875\u9762\u3002","title":"\u5e38\u7528'requirement'\u952e\uff1a"},{"location":"drupal/drupal8/understanding-drupal8/#path-parameters","text":"\u5728\u5b9e\u8df5\u4e2d\u4f60\u7ecf\u5e38\u9700\u8981\u53c2\u6570\u53bb\u63a7\u5236\u9875\u9762\u56de\u8c03\u3002\u4e0b\u9762\u7684\u8def\u7531\u5b9a\u4e49\u5b9e\u4f8b\u4e2d\uff0c\u8def\u5f84\u5305\u542b\u4e00\u4e2a\u540d\u4e3a'node'\u7684\u53c2\u6570\u3002\u6bcf\u4e00\u4e2a\u8def\u7531\u5b58\u50a8\u76f8\u5e94\u7684\u9009\u9879\u3002\u63a7\u5236\u5668\u65b9\u6cd5\u63a5\u6536\u8fd9\u4e9b\u53c2\u6570\u4f5c\u4e3a\u53c2\u6570\u3002\u6240\u4ee5\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b,NodeController\u65b9\u6cd5\u6709\u4e00\u4e2a\u53c2\u6570:$node\u3002\u4e00\u4e2a\u8def\u7531\u53ef\u4ee5\u6709\u591a\u4e2a\u53c2\u6570,\u4f46\u662f\u4ed6\u4eec\u7684\u540d\u5b57\u5e94\u8be5\u662f\u552f\u4e00\u7684\u3002 node.view: path: '/node/{node}' defaults: _content: '\\Drupal\\node\\Controller\\NodeController::page' _title_callback: '\\Drupal\\node\\Controller\\NodeController::pageTitle' requirements: _entity_access: 'node.view' \u53c2\u6570\u4f20\u9012\u7684\u503c\u9ed8\u8ba4\u5c31\u662furl\u4e2d\u7684\u503c(\u4e00\u4e2a\u5b57\u7b26\u4e32)\uff0c\u4f46\u901a\u5e38\u4f1a\u901a\u8fc7parameter converter\u8fdb\u884c\u8f6c\u6362\u3002\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d,NodeController\u4e0d\u4f1a\u5f97\u5230node id\uff0c\u800c\u662f\u4e00\u4e2a\u52a0\u8f7d\u7684node\u5b9e\u4f53\u3002 \u53c2\u6570\u8f6c\u6362\u662f\u7531\u8ba2\u9605\u7740kernel.request\u4e8b\u4ef6\u7684ParamConverterManager\u5b8c\u6210\u3002ParamConverterManager\u5305\u542b\u53ef\u6240\u6709\u6ce8\u518c\u4e86\u7684ParamConverterInterface(\u6807\u7b7e\u540d\u4e3aparamconverter\u7684\u670d\u52a1)\u7684\u5b9e\u73b0\u3002\u5f53\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6,ParamConverterManager\u4f1a\u904d\u5386\u6d3b\u8dc3\u8def\u7531\u7684\u53c2\u6570\u5e76\u8c03\u7528\u53c2\u6570\u8f6c\u6362\u5668\u7684\u8f6c\u6362\u65b9\u6cd5\u3002\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u4e00\u4e2a'string'\u53c2\u6570\u4f1a\u88ab\u66ff\u6362\u4e3a\u4e00\u4e2a\u5b8c\u6574\u7684\u5bf9\u8c61\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u63a7\u5236\u5668\u65b9\u6cd5\u7684\u53c2\u6570\u6ca1\u6709\u660e\u786e\u7684\u7c7b\u578b\u6697\u793a\uff0c\u5c06\u4f1a\u4f20\u9012\u672a\u53d1\u751f\u8f6c\u6362\u7684\u53c2\u6570\u3002 EntityConverter\u662fDrupal\u6838\u5fc3\u4e2d\u552f\u4e00\u4e00\u4e2a\u63d0\u4f9b\u53c2\u6570\u8f6c\u6362\u7684\u7c7b\uff0c\u4f46\u662f\u5728Drupal\u4e2d\u4f7f\u7528\u5f97\u5f88\u5e7f\u3002\u5982\u679c\u4e00\u4e2a\u53c2\u6570\u540d\u5339\u914d\u5230\u4e86\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u578b('node', 'user'\u7b49)\uff0c\u5b83\u5c31\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6362\u4e3a\u5b9e\u4f53\u5bf9\u8c61\u3002\u5b83\u7684\u503c\u88ab\u8ba4\u4e3a\u662f\u5b9e\u4f53\u7684id\u3002\u5982\u679c\u5b9e\u4f53\u4e0d\u5b58\u5728\u6216\u8f6c\u6362\u5931\u8d25\uff0c\u5219\u8fd4\u56de404\u3002 \u4f60\u4e5f\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e9b\u503c\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u53ef\u9009\u53c2\u6570\uff0c\u8fd9\u53ea\u9002\u7528\u4e8e\u53c2\u6570\u4e0d\u88ab\u8f6c\u6362\u7684\u60c5\u51b5\u3002","title":"\u8def\u5f84\u53c2\u6570(path parameters)"},{"location":"drupal/drupal8/understanding-drupal8/#4route-building","text":"\u8def\u7531\uff0c\u663e\u7136\u662f\u5728\u8bf7\u6c42\u4e2d\u5b8c\u6210\u7684\uff0c\u5b83\u4f7f\u7528\u4e4b\u524d\u6784\u5efa\u7684'router'\u8868\u3002RouteBuilder service\u8d1f\u8d23\u586b\u5145\u8def\u7531\u8868(\u4f8b\u5982,\u5f53\u6e05\u7406\u7f13\u5b58\u540e)\u3002\u5f53\u4e00\u4e2a\u8bf7\u6c42\u6765\u65f6\uff0c\u8fd9\u4e2a\u8def\u7531\u8868\u7528\u4e8e\u67e5\u627e\u5bf9\u5e94\u7684\u8def\u7531\u5e76\u5b8c\u6210\u5b83\u3002\u8fd9\u4e48\u505a\u662f\u51fa\u4e8e\u6027\u80fd\u7684\u8003\u8651\u3002RouteBuilder\u901a\u8fc7\u6536\u96c6\u6240\u6709\u7684\u5df2\u914d\u7f6e\u7684\u9759\u6001\u8def\u7531(yml-files)\u5e76\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5b83\u4eec\u7684\u96c6\u5408\u3002\u5b83\u4e5f\u8c03\u7528route.route_dynamics\u4e8b\u4ef6\uff0c\u5728\u8fd9\u4e2a\u4e8b\u4ef6\u4e2d\uff0c\u4e8b\u4ef6\u8ba2\u9605\u8005\u8fd8\u53ef\u4ee5\u6ce8\u518c\u989d\u5916\u7684\u8def\u7531(\u89c1\u4e0a\u9762\u7684\u793a\u4f8bblock\u6a21\u5757)\u3002\u7136\u540e\u8c03\u7528routing.route_alter\u4e8b\u4ef6\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u53ef\u80fd\u6709\u591a\u4e2a\u8ba2\u9605\u8005\u3002\u53e6\u5916\u4e00\u4e9b\u7279\u522b\u91cd\u8981\u7684\u5982\u8bbf\u95ee\u63a7\u5236\u548c\u53c2\u6570\u8f6c\u6362\u3002 \u6211\u4eec\u521a\u521a\u63d0\u5230\u7684\u8bbf\u95ee\u68c0\u6d4b\u3002\u5f53\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6\uff0c\u8bbf\u95ee\u68c0\u6d4b\u4f1a\u68c0\u6d4b\u5ba2\u6237\u7aef\u662f\u5426\u6709\u6743\u9650\u8bbf\u95ee\u3002\u5f53\u7136\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u8def\u7531\u90fd\u9700\u8981\u6743\u9650\u3002\u5b9e\u9645\u4e0a\uff0c\u5728\u6784\u5efa\u8def\u7531\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u51b3\u5b9a\u6bcf\u4e2a\u8def\u7531\u7684\u8bbf\u95ee\u6743\u9650\u3002\u8fd9\u9879\u5de5\u4f5c\u7531\u76d1\u542crouter.route_alter\u4e8b\u4ef6\u7684AccessManager\u5b8c\u6210\uff0c\u5305\u542b\u9759\u6001\u548c\u52a8\u6001\u7684\u8bbf\u95ee\u63a7\u5236\u3002StaticAccessCheckInterface\u6709\u4e00\u4e2a\u65b9\u6cd5appliesTo,\u7528\u4e8e\u8fd4\u56de\u4e00\u4e2arequirement\u6570\u7ec4\u3002\u52a8\u6001\u8bbf\u95ee\u63a7\u5236\u901a\u8fc7applies\u65b9\u6cd5\u6765\u6d4b\u8bd5\u6bcf\u4e2a\u8def\u7531\u3002AccessManager\u5728router\u8868\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u9009\u9879\u201c_access_checks\u201d\uff0c\u8fd9\u5e38\u7528\u4e8e\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42\u65f6\u505a\u8def\u7531\u7684\u6743\u9650\u63a7\u5236\u3002\u6ce8\u610f\uff0c\u6bcf\u4e00\u4e2a\u8def\u7531\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u8bbf\u95ee\u68c0\u6d4b\uff0c\u5426\u5219\u6c38\u8fdc\u4e0d\u4f1a\u8bbf\u95ee\u8def\u7531! \u6211\u4eec\u4e5f\u63d0\u5230\u53c2\u6570\u8f6c\u6362\u5668\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u53c2\u6570\u5982\u4f55\u88ab\u8f6c\u6362\u5668\u8f6c\u6362\u3002\u6bcf\u4e2a\u53c2\u6570\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u9002\u7528\u7684\u8f6c\u6362\u5668(\u6216\u6ca1\u6709)\u3002\u5c31\u50cf\u8bbf\u95ee\u63a7\u5236\uff0c\u8fd9\u4e2a\u9002\u7528\u7684\u8f6c\u6362\u5668\u4f1a\u5728ParamConverterManager\u521b\u5efa\u8def\u7531\u65f6\u88ab\u641c\u7d22\u5230\u3002\u8fd9\u4e2a\u670d\u52a1\u4f1a\u68c0\u67e5\u6bcf\u4e00\u4e2a\u5b58\u5728\u7684\u8def\u7531\u53c2\u6570\uff0c\u4ee5\u53ca\u5bf9\u5e94\u53c2\u6570\u8f6c\u5316\u5668\u7684applies\u65b9\u6cd5\uff0c\u5e76\u5728router\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u9009\u9879\u201cconverter\u201d\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u5904\u7406\u65f6\uff0c\u8f6c\u6362\u53c2\u6570\u3002","title":"4\u3001\u8def\u7531\u751f\u6210(Route building)"},{"location":"drupal/drupal8/understanding-drupal8/#5conclusion","text":"\u5728\u672c\u8282\u4e2d,\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u5904\u7406\u8bf7\u6c42\u3002\u540c\u65f6,\u4f60\u73b0\u5728\u5e94\u8be5\u4e86\u89e3Drupal 8\u7684\u8def\u7531\u4ee5\u53ca\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684!\u4e8b\u5b9e\u4e0a,\u4f60\u5df2\u7ecf\u77e5\u9053\u4e86\u4ece\u8bf7\u6c42\u5230\u54cd\u5e94\u8fd9\u4e00\u57fa\u672c\u6d41\u7a0b\u3002\u7136\u800c\uff0cDrupal8\u4e2d\u4ecd\u7136\u6709\u4e00\u4e9b\u6709\u8da3\u7684\u6982\u5ff5\u5b58\u5728\uff0c\u8fd9\u90e8\u5206\u5185\u5bb9\u5c06\u5728\u4e0b\u4e2a\u90e8\u5206\u4e5f\u662f\u6700\u540e\u4e00\u90e8\u5206\u91cc\u9762\u8fdb\u884c\u63a2\u8ba8\u3002\u597d\u4e86\uff0c\u6211\u4eec\u4e0b\u5468\u518d\u6765\u8ba8\u8bba\u3002","title":"5\u3001\u603b\u7ed3(Conclusion)"},{"location":"drupal/drupal8/understanding-drupal8/#drupal8","text":"\u5728\u8fc7\u53bb\u7684\u51e0\u5468\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86Drupal\u7684\u7ed3\u6784\u548c\u5982\u4f55\u5904\u7406\u8bf7\u6c42\u3002\u6211\u4eec\u8fd8\u6ca1\u6709\u4e86\u89e3\u5982\u4f55\u5b89\u88c5\u914d\u7f6eDrupal8\u3002\u5728\u4f60\u6df1\u5165\u5177\u4f53\u7684\u6838\u5fc3\u6a21\u5757\u4ee3\u7801\u4e4b\u524d,\u4f60\u5e94\u8be5\u4e86\u89e3\u4e00\u4e9b\u91cd\u8981\u7684\u65b0\u7684\u6216\u53d8\u66f4\u7684Drupal8\u6982\u5ff5\u3002\u6211\u5728\u672c\u6587\u7684\u6700\u540e\u4e00\u90e8\u5206\u5c06\u63cf\u8ff0\u5b83\u4eec\u3002","title":"\u56db\u3001Drupal8\u5176\u5b83\u6982\u5ff5"},{"location":"drupal/drupal8/understanding-drupal8/#1configuration","text":"Drupal8\u7684\u914d\u7f6e\u7cfb\u7edf\u505a\u4e86\u5f88\u591a\u4ee4\u4eba\u5174\u594b\u7684\u6539\u8fdb\u3002\u6700\u503c\u5f97\u6ce8\u610f\u7684\u662f,\u73b0\u5728\u914d\u7f6e\u5b58\u50a8\u5728\u4e00\u4e2aYAML-files\u4e2d\uff0c\u76ee\u5f55\u7ed3\u6784\u4e00\u822c\u4e3a'/sites/{name}/files/config_{HASH}/active'\u3002\u6587\u4ef6\u540d\u5e94\u8be5\u51c6\u786e\u63cf\u8ff0\u8be5\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982,\u201cnode.settings.yml\u201d\u662f\u8282\u70b9\u6a21\u5757\u7684\u8bbe\u7f6e\uff0c\u201cviews.view.content.yml\u201d\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u673a\u5668\u540d\u79f0\u4e3a'content'\u89c6\u56fe\u5b9a\u4e49! \u4f60\u53ef\u80fd\u8ba4\u4e3a\u914d\u7f6e\u6587\u4ef6\u975e\u5e38\u4e0d\u7075\u6d3b\u3002\u4f46\u5728\u5b9e\u8df5\u4e2d,\u60a8\u53ef\u4ee5\u4f7f\u7528YAML-syntax\u6784\u5efa\u4fe1\u606f\u7684\u5173\u8054\u6570\u7ec4\u3002\u6b64\u5916,Drupal\u63d0\u4f9b\u4e00\u4e2aConfig\u5bf9\u8c61\u53ef\u4ee5\u7528\u6765\u6539\u53d8\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u4e0d\u5fc5\u624b\u52a8\u7f16\u8f91\u8fd9\u6837\u4e00\u4e2a\u6587\u4ef6!\u5f53\u60a8\u901a\u8fc7Drupal UI\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b57\u6bb5\uff0c\u8282\u70b9\u7c7b\u578b\uff0c\u533a\u5757\u7c7b\u578b\u6216\u89c6\u56fe\u65f6\uff0c\u7cfb\u7edf\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u3002\u5185\u5bb9(nodes)\u548c\u6570\u636e\u4f9d\u7136\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5426\u5219\u4f60\u5c06\u65e0\u6cd5\u5efa\u7acb\u5feb\u901f\u67e5\u8be2\u3002 \u4e00\u4e2a\u6a21\u5757\u53ef\u4ee5\u5305\u542bconf\u5b50\u76ee\u5f55\u3002\u5f53\u542f\u7528\u4e86\u4e00\u4e2a\u6a21\u5757\uff0c\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u4f1a\u88ab\u590d\u5236\u5230\u7f51\u7ad9\u7684\u914d\u7f6e\u76ee\u5f55\u4e0b\uff0c\u5f53\u6587\u4ef6\u6dfb\u52a0\u5b8c\u6bd5\uff08\u800c\u4e14\u7f13\u5b58\u5df2\u7ecf\u60c5\u51b5\uff09\uff0c\u914d\u7f6e\u4f1a\u88ab\u7cfb\u7edf\u68c0\u6d4b\u5230\u5e76\u4e14\u81ea\u52a8\u751f\u6548\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f,\u4e00\u4e2a\u6a21\u5757\u53ef\u4ee5\u63d0\u4f9b\u989d\u5916\u7684node types, image styles, views\u7b49\u65e0\u9700\u5b9e\u73b0Drupal7\u4e2d\u7684\u8bf8\u5982hook_node_info\u7684\u94a9\u5b50\u3002 \u914d\u7f6e\u6587\u4ef6\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u5730\u65b9\uff0c\u8fd9\u6709\u5229\u4e8e\u5728\u6700\u540e\u9636\u6bb5\u66f4\u6539\u914d\u7f6e! \u914d\u7f6e\u6587\u4ef6\u4e5f\u53ef\u80fd\u6709\u4e00\u4e2a\u5173\u8054\u7684schema\uff0c\u8be6\u7ec6\u63cf\u8ff0\u4e86\u4e00\u4e2aview/block/image style/\u7684\u914d\u7f6e\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u7684\u3002\u8fd9\u6837\u53ef\u4ee5\u66f4\u597d\u7684\u9a8c\u8bc1\u3001\u7ffb\u8bd1\u914d\u7f6e\u3002","title":"1\u3001\u914d\u7f6e(Configuration)"},{"location":"drupal/drupal8/understanding-drupal8/#2entities","text":"Drupal7\u5f15\u5165\u4e86\u5b9e\u4f53\uff0c\u4f7f\u7528\u5b9e\u4f53\u4f5c\u4e3a\u4e3b\u8981\u7684\u62bd\u8c61\u5185\u5bb9\uff0c\u662fDrupal\u5e95\u5c42\u67b6\u6784\u6700\u5927\u7684\u53d8\u5316\u3002\u4f8b\u5982,\u5b57\u6bb5\u53ef\u88ab\u8fde\u63a5\uff0c\u53ef\u4ee5\u5b9a\u4e49\u8bbf\u95ee\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5173\u8054\u89c6\u56fe\u7b49\u3002\u5b9e\u4f53\u73b0\u5728\u53d8\u7684\u975e\u5e38\u5f3a\u5927\u3002\u5728Drupal8\u4e2d, \u5b9e\u4f53\u5df2\u7ecf\u53d8\u7684\u5bf9\u4e8eCMS\u6765\u8bf4\u66f4\u52a0\u6838\u5fc3\u3002\u4e0d\u4ec5\u5185\u5bb9\u6570\u636e(\u8282\u70b9nodes\u3001\u5206\u7c7btaxonomy terms\u3001\u7528\u6237users)\u90fd\u662f\u5b9e\u4f53,\u800c\u4e14non-fieldable\u6bd4\u5982\u89c6\u56fe(views)\u3001\u6570\u636e\u64cd\u4f5c(actions)\u3001\u83dc\u5355(menus)\u3001\u56fe\u50cf(image styles)\u7b49\u90fd\u662f\u6269\u5c55\u5b9e\u4f53\u7c7b\uff0c\u4e5f\u5305\u8282\u70b9\u7c7b\u578b\u548c\u8bcd\u6c47\u7b49\u5b9e\u4f53\u3002 \u4f7f\u7528attributes\u5b9a\u4e49\u4e00\u4e2a\u5b9e\u4f53\u7684\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u8fd9\u91cc\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u5b9e\u4f53\u662f\u5426fieldable\u6216\u8005\u5b83\u5e94\u8be5\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u5b9e\u4f53\u7684\u4e00\u4e2a\u96c6\u5408\u3002\u5b9e\u4f53\u4f9d\u8d56\u4e8e\u63a7\u5236\u5668\uff0c\u4e0d\u4e00\u5b9a\u9700\u8981\u4fdd\u5b58\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u63a7\u5236\u5668\u7ee7\u627fConfigStorageController,\u5c06\u88ab\u4fdd\u5b58\u4e3a\u914d\u7f6e\u6587\u4ef6\u3002\u867d\u7136\u914d\u7f6e\u6587\u4ef6\u6709\u597d\u5904\uff0c\u8fd9\u610f\u5473\u7740\u60a8\u4e0d\u80fd\u4f7f\u7528\u6570\u636e\u5e93\u67e5\u8be2\u5b83\u4eec\u3002\u5982\u679c\u4f60\u60f3\u641c\u7d22\u5b83\u4eec,\u4f60\u8981\u52a0\u8f7d\u6240\u6709\u9879\u76ee\u5e76\u4f7f\u7528for\u5faa\u73af\u53bb\u68c0\u7d22\u3002\u5982\u679c\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u4f8b\u5982\u8282\u70b9\u548c\u7528\u6237,\u5c31\u53ef\u4ee5\u4f7f\u7528FieldableDatabaseStorageController\u3002\u8282\u70b9\u3001\u7528\u6237\u3001\u5206\u7c7b\u90fd\u662f\u4e00\u6837\u3002\u4f46\u7ed3\u679c\u5c31\u662f\uff0c\u8fd9\u4e9b\u5185\u5bb9\u4e0d\u80fd\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4f20\u9012\u3002\u5bf9\u6211\u6765\u8bf4,\u73b0\u5728\u8fd8\u4e0d\u6e05\u695a\u662f\u5426\u6709\u53ef\u80fd\u6709\u4e00\u4e2afieldable\u914d\u7f6e\u5b58\u50a8\u63a7\u5236\u5668! \u5982\u679c\u8981\u52a0\u6df1\u5b9e\u4f53\u7684\u7406\u89e3\uff0c\u6211\u5efa\u8bae\u4f60\u770b\u4e00\u770bImageStyle\u7c7b,\u8fd9\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684\u57fa\u4e8e\u914d\u7f6e\u7684\u5b9e\u4f53\uff0ctaxonomy term,\u5b83\u662f\u4e00\u4e2a\u5b57\u6bb5\u5316\u57fa\u4e8e\u6570\u636e\u5e93\u5b58\u50a8\u7684\u5b9e\u4f53\uff0c\u8fd8\u6709Vocabulary\uff0c\u5b83\u662f\u4e00\u4e2a\u5b9e\u4f53\u96c6\u3002","title":"2\u3001\u5b9e\u4f53(Entities)"},{"location":"drupal/drupal8/understanding-drupal8/#3plugins","text":"\u63d2\u4ef6\u53ef\u4ee5\u770b\u4f5c\u662f\u94a9\u5b50\u7684\u9762\u5411\u5bf9\u8c61\u7248\u672c\u3002\u4ed6\u4eec\u7528\u4e8e\u6a21\u5757\u5316\u5305\u62ec\u81ea\u5b9a\u4e49\u6a21\u5757\uff0c\u56fe\u50cf\u6548\u679c\u7b49\u3002 \u5b66\u4e60\u63d2\u4ef6\u6709\u4e2a\u5f88\u597d\u7684\u793a\u4f8b\u5c31\u662fBlockBase\u62bd\u8c61\u7c7b\u3002\u4e3a\u4e86\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u81ea\u5b9a\u4e49block\u65f6\uff0c\u5c31\u5fc5\u987b\u7ee7\u627f\u8fd9\u4e2a\u7c7b\uff0c\u8fd9\u4e48\u505a\u7c7b\u4f3c\u4e8e\u8bba\u575b\u6a21\u5757\u7684ActiveTopicsBlock\u7c7b\u3002\u4e00\u4e9b\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u5fc5\u987b\u8986\u76d6\u5176\u8bbf\u95ee\u68c0\u67e5\u3001\u89c6\u56fe\u5efa\u7acb\u3001\u6539\u53d8\u5757\u7684\u5f62\u5f0f\u7b49\u3002 \u63d2\u4ef6\u7ba1\u7406\u5668\u7528\u6765\u5b9a\u4e49\u63d2\u4ef6\u7c7b\u578b\uff0c\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u5217\u8868\u4ee5\u53ca\u7528\u4e8e\u5b58\u653e\u63d2\u4ef6\u7684\u5b50\u76ee\u5f55\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f,\u4efb\u4f55\u6a21\u5757\u53ef\u4ee5\u6dfb\u52a0\u63d2\u4ef6\u3002\u63d2\u4ef6\u901a\u8fc7\u6ce8\u91ca\u7c7b\u7684\u65b9\u5f0f\u8fdb\u884c\u8bbe\u7f6e\u3002\u6b64\u5916\uff0c\u6839\u636e\u4e0d\u540c\u7684\u63d2\u4ef6\u7c7b\u578b\uff0c\u6ce8\u91ca\u4e2d\u5fc5\u987b\u8981\u6307\u5b9a\u4e00\u4e9b\u914d\u7f6e\u5c5e\u6027\u3002","title":"3\u3001\u63d2\u4ef6(Plugins)"},{"location":"drupal/drupal8/understanding-drupal8/#4drupal-class","text":"Drupal 8\u6838\u5fc3\u4ee3\u7801\u4e3b\u8981\u662f\u9762\u5411\u5bf9\u8c61\u7684\u3002\u7136\u800c\uff0c\u6a21\u5757\u4e2d\u7684\u94a9\u5b50\u4ee3\u7801\u4ecd\u7136\u662f\u9762\u5411\u8fc7\u7a0b\u7684\u3002\u8fd9\u91cc\u5c31\u51fa\u73b0\u4e86\u7591\u95ee,\u56e0\u4e3aSymfony\u662f\u5b8c\u5168\u9762\u5411\u5bf9\u8c61\u7684\uff01\u5728Symfony\u4e2d\uff0c\u5982\u679c\u60a8\u9700\u8981\u4f9d\u8d56\u4e8e\u53e6\u4e00\u4e2aservice\u521b\u5efa\u4e00\u4e9b\u529f\u80fd,\u60a8\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u670d\u52a1\u5e76\u4e14\u5728\u670d\u52a1\u5bb9\u5668\u5b9a\u4e49\u6240\u9700\u7684\u5fc5\u987b\u4f9d\u8d56\u9879\u3002\u4f46\u5982\u679c\u4f60\u60f3\u7528Drupal\u7684\u94a9\u5b50\u5b9e\u73b0\u4e00\u4e2a\u7279\u5b9a\u7684service,\u5c06\u521b\u5efa\u4e00\u4e2a\u9759\u6001Drupal\u7c7b\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528Drupal::service(\u201c{service_id}\u201d),\u6216\u7740\u901a\u8fc7\u4f7f\u7528\u7279\u5b9a\u7684\u50cfDrupal::request(),Drupal:currentUser(),Drupal:entityManager()\u7684\u670d\u52a1\u8bbf\u95ee\u5668\u7c7b\u83b7\u7a0b\u5e8f\u6d41\u7a0b\u4e2d\u7684services\u3002\u540e\u8005\u7684\u4f18\u52bf\u662f\u53ef\u4ee5\u4e3a\u4f60\u63d0\u4f9b\u66f4\u597d\u7684\u4ee3\u7801\u8865\u5168\u529f\u80fd\u3002\u6b64\u5916,\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u65b9\u4fbf\u50cfDrupal::url()\u7684\u8f85\u52a9\u65b9\u6cd5\uff0c\u76f8\u5f53\u4e8eDrupal7\u7684url()\u65b9\u6cd5\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u91c7\u7528Drupal class\u7684\u4f8b\u5b50\uff0c\u4f4d\u4e8enode.module\u4e2d\u7684node_access\u65b9\u6cd5: function node_access($op, $node, $account = NULL, $langcode = NULL) { $access_controller = \\Drupal::entityManager()->getAccessController('node'); ... return $access_controller->access($node, $op, $langcode, $account); }","title":"4\u3001\u7c7b(Drupal class)"},{"location":"drupal/drupal8/understanding-drupal8/#5conclusion_1","text":"\u5728\u672c\u6587\u4e2d,\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86Drupal8\u7684\u7ed3\u6784\uff0c\u4ee5\u53ca\u4e0eSymfony2\u5bf9\u6bd4\u3002\u6211\u4eec\u8fd8\u5b66\u4e60\u4e86\u670d\u52a1\u5bb9\u5668\u7ba1\u7406\u7740\u6240\u6709\u670d\u52a1,\u800c\u670d\u52a1\u53ef\u4ee5\u8fdb\u884c\u914d\u7f6e\u3002\u4e4b\u540e\u6211\u4eec\u5b66\u4e60\u4e86\u8def\u7531\u548c\u5904\u7406\u8bf7\u6c42\u7684\u8fc7\u7a0b\u3002\u6700\u540e\u6211\u4eec\u4ecb\u7ecd\u4e86Drupal8\u4e2d\u4e00\u4e9b\u91cd\u8981\u7684\u65b0\u6982\u5ff5:Drupal\u7c7b,\u63d2\u4ef6\u548c\u914d\u7f6eDrupal8\u3002 \u6211\u5e0c\u671b\u6240\u6709\u8fd9\u4e9b\u4f1a\u5e2e\u52a9\u4f60\u63a2\u7d22\u548c\u4e86\u89e3Drupal8\u3002\u6211\u5e0c\u671b\u4f60\u80fd\u591f\u4e86\u89e3Drupal8\u6a21\u5757\u5f00\u53d1\uff0c\u5e76\u5bf9\u8fd9\u4e2a\u4f1f\u5927\u7684\u9879\u76ee\u6709\u6240\u8d21\u732e\u3002 \u539f\u6587\u51fa\u5904\uff1a https://cipix.nl/understanding-drupal-8-part-1-general-structure-framework","title":"5\u3001\u603b\u7ed3(Conclusion)"},{"location":"go/","text":"test","title":"Index"},{"location":"javascript/%3Bfunction%28%24%2Cundefined%29-%E5%89%8D%E9%9D%A2%E7%9A%84%E5%88%86%E5%8F%B7%E9%87%8A%E7%96%91/","tags":"[jquery]","text":";(function( ){ ){ .extend($.fn... \u4e00\u822c\u5728\u4e00\u4e9b JQuery \u51fd\u6570\u524d\u9762\u6709\u5206\u53f7,\u5728\u524d\u9762\u52a0\u5206\u53f7\u53ef\u4ee5\u6709\u591a\u79cd\u7528\u9014: 1\u3001\u9632\u6b62\u591a\u6587\u4ef6\u96c6\u6210\u6210\u4e00\u4e2a\u6587\u4ef6\u540e\uff0c\u9ad8\u538b\u7f29\u51fa\u73b0\u8bed\u6cd5\u9519\u8bef\u3002 2\u3001\u8fd9\u662f\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u4e00\u822cjs\u5e93\u90fd\u91c7\u7528\u8fd9\u79cd\u81ea\u6267\u884c\u7684\u533f\u540d\u51fd\u6570\u6765\u4fdd\u62a4\u5185\u90e8\u53d8\u91cf (function(){})()\u3002 3\u3001\u56e0\u4e3aundefined\u662fwindow\u7684\u5c5e\u6027\uff0c\u58f0\u660e\u4e3a\u5c40\u90e8\u53d8\u91cf\u4e4b\u540e\uff0c\u5728\u51fd\u6570\u4e2d\u5982\u679c\u518d\u6709\u53d8\u91cf\u4e0eundefined\u4f5c\u6bd4\u8f83\u7684\u8bdd\uff0c\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u4e0d\u7528\u641c\u7d22undefined\u5230window\uff0c\u53ef\u4ee5\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\u3002","title":";function($,undefined) \u524d\u9762\u7684\u5206\u53f7\u91ca\u7591"},{"location":"javascript/%E4%BD%BF%E7%94%A8safari%E5%AF%B9webview%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95/","tags":"[ios]","text":"\u5728web\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6293\u5305\u3001\u8c03\u8bd5\u9875\u9762\u6837\u5f0f\u3001\u67e5\u770b\u8bf7\u6c42\u5934\u662f\u5f88\u5e38\u7528\u7684\u6280\u5de7\u3002\u5176\u5b9e\u5728iOS\u5f00\u53d1\u4e2d\uff0c\u8fd9\u4e9b\u6280\u5de7\u4e5f\u80fd\u7528\uff08\u65e0\u8bba\u662f\u6a21\u62df\u5668\u8fd8\u662f\u771f\u673a\uff09\uff0c\u4e0d\u8fc7\u6211\u4eec\u9700\u8981\u7528\u5230mac\u81ea\u5e26\u7684\u6d4f\u89c8\u5668Safari\u3002\u6240\u4ee5\uff0c\u672c\u6587\u5c06\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528Safari\u5bf9iOS\u7a0b\u5e8f\u4e2d\u7684webview\u8fdb\u884c\u8c03\u8bd5\u3002 \u73af\u5883\u4fe1\u606f\uff1a Mac OS X 10.10.1 Xcode 6.1.1 iOS 8.1 1\u3001\u6253\u5f00\u6a21\u62df\u5668\uff08\u771f\u673a\uff09\u7684\u5f00\u53d1\u8005\u6a21\u5f0f \u3010\u8bbe\u7f6e\u3011->\u3010Safari\u3011->\u3010\u9ad8\u7ea7\u3011->\u3010Web\u68c0\u67e5\u5668\u3011\u6253\u5f00 \u6253\u5f00iphone\u8bbe\u5907\u4e2d\u7684web\u68c0\u67e5\u5668 2\u3001\u6253\u5f00Mac\u4e0aSafari\u7684\u5f00\u53d1\u8005\u6a21\u5f0f \u3010Safari\u3011->\u3010\u504f\u597d\u8bbe\u7f6e\u3011->\u3010\u9ad8\u7ea7\u3011->\u3010\u5728\u83dc\u5355\u680f\u4e2d\u663e\u793a\u201c\u5f00\u53d1\u201d\u83dc\u5355\u3011\u52fe\u9009 \u6253\u5f00Safari\u4e2d\u7684\u5f00\u53d1\u8005\u6a21\u5f0f 3\u3001\u5199\u4e00\u4e2awebview\u5e76\u52a0\u8f7d\u4e00\u4e2a\u7f51\u9875 #import \"ViewController.h\" @interfaceViewController () @property ( strong, nonatomic ) UIWebView *webView ; @end @implementation ViewController - ( void ) viewDidLoad { [ superviewDidLoad ] ; // Do any additional setup after loading the view, typically from a nib. _webView = [[ UIWebViewalloc ] initWithFrame:self.view.bounds ] ; [ _webView loadRequest: [ NSURLRequest requestWithURL: [ NSURL URLWithString:@ \"http://www.baidu.com\" ]]] ; [ self.view addSubview:_webView ] ; } @end 4\u3001\u5728\u6a21\u62df\u5668\uff08\u771f\u673a\uff09\u4e2d\u6253\u5f00webview\u5e94\u7528\uff0c\u5e76\u6253\u5f00Safari\u67e5\u770b\u7f51\u7edc\u4fe1\u606f \u3010\u5f00\u53d1\u3011->\u3010iOS Simulator\u3011->\u3010\u6b63\u5728\u8c03\u8bd5\u7684\u7f51\u7ad9\u3011 \u6ce8\u610f\uff1a\u5fc5\u987b\u8981webview\u5728\u52a0\u8f7d\u7f51\u9875\u65f6\uff0c\u6253\u5f00Safari\u624d\u53ef\u4ee5\u770b\u5230\u8c03\u8bd5\u6a21\u5f0f\u3002 \u6253\u5f00Safari\u4e2d\u7684\u8c03\u8bd5 \u5728\u5f39\u51fa\u7684\u8c03\u8bd5\u7a97\u53e3\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u6b63\u5728\u52a0\u8f7d\u7f51\u9875\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5305\u62ec\u6e90\u7801\u3001\u8bf7\u6c42\u5934\u3001\u56fe\u7247\u3001\u52a0\u8f7d\u7684\u8d44\u6e90\u4e0e\u811a\u672c\u3001\u63a7\u5236\u53f0\u8f93\u51fa\u7b49\u3002\u5e76\u4e14\u5b83\u548cweb\u524d\u7aef\u7684\u8c03\u8bd5\u65b9\u5f0f\u76f8\u540c\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u7f51\u9875\u7684CSS\u6837\u5f0f\uff0c\u5bf9\u7f51\u9875\u5e03\u5c40\u7b49\u8fdb\u884c\u4fee\u6539\uff0c\u800c\u4e0d\u7528\u91cd\u65b0\u8fd0\u884c\u6574\u4e2aApp\u3002 5\u3001\u4fee\u6539web\u6837\u5f0f \u5c06\u5149\u6807\u9009\u4e2d\u5230\u8981\u4fee\u6539\u7684\u6837\u5f0f\uff0c\u8fdb\u884c\u4fee\u6539\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u6a21\u62df\u5668\u4e2d\u770b\u5230\u4fee\u6539\u540e\u7684\u6548\u679c\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539webview\u4e2d\u7684\u6837\u5f0f\u3002","title":"\u4f7f\u7528safari\u5bf9webview\u8fdb\u884c\u8c03\u8bd5"},{"location":"javascript/%E5%86%99%E4%B8%AA%E8%84%9A%E6%9C%AC%E5%8E%8B%E7%BC%A9JS-CSS/","tags":"yuicompressor","text":"1\u3001\u4e0b\u8f7d\u6700\u65b0\u7248\u7684yuicompressor.jar https://github.com/yui/yuicompressor/releases 2\u3001\u904d\u5386\u76ee\u5f55\uff0c\u538b\u7f29JS\u3001CSS #!/bin/bash for i in `find path -name \"*.css\"`; do echo \"compress $i\" java -jar yuicompressor-2.4.8.jar --charset=utf8 -o $i $i --nomunge done","title":"\"\u5199\u4e2a\u811a\u672c\u538b\u7f29JS,CSS\""},{"location":"other/","tags":["web"],"text":"\u6587\u4ef6\u7f16\u7801 \u00b6 \u524d\u7aef\u5f00\u53d1\u6d89\u53ca\u7684\u6240\u6587\u4ef6\u7edf\u4e00\u4f7f\u7528 utf-8 \u7f16\u7801 \u6587\u4ef6\u547d\u540d\u89c4\u5219 \u00b6 \u5168\u90e8\u5c0f\u5199\u65b9\u5f0f\uff0c\u4ee5\u4e0b\u5212\u7ebf\u5206\u9694 \u4f8b\uff1amy_project \u7279\u4f8b\uff1adrupal\u4e2d\u7684\u6a21\u7248\u6587\u4ef6 HTML \u00b6 \u8bed\u6cd5 \u00b6 \u7f29\u8fdb\u4f7f\u75282\u4e2a\u7a7a\u683c\uff1b \u5d4c\u5957\u7684\u8282\u70b9\u5e94\u8be5\u7f29\u8fdb\uff1b \u5728\u5c5e\u6027\u4e0a\uff0c\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u4e0d\u8981\u4f7f\u7528\u5355\u5f15\u53f7\uff1b \u5c5e\u6027\u540d\u5168\u5c0f\u5199\uff0c\u7528\u4e2d\u5212\u7ebf\u505a\u5206\u9694\u7b26\uff1b \u4e0d\u8981\u5728\u81ea\u52a8\u95ed\u5408\u6807\u7b7e\u7ed3\u5c3e\u5904\u4f7f\u7528\u659c\u7ebf\uff08 HTML5 \u89c4\u8303 \u6307\u51fa\u4ed6\u4eec\u662f\u53ef\u9009\u7684\uff09\uff1b \u4e0d\u8981\u5ffd\u7565\u53ef\u9009\u7684\u5173\u95ed\u6807\u7b7e\uff0c\u4f8b\uff1a </li> \u548c </body> \u3002 <!DOCTYPE html> < html > < head > < title > Page title </ title > </ head > < body > < img src = \"images/company_logo.png\" alt = \"Company\" > < h1 class = \"hello-world\" > Hello, world! </ h1 > </ body > </ html > HTML5 doctype \u00b6 \u5728\u9875\u9762\u5f00\u5934\u4f7f\u7528\u8fd9\u4e2a\u7b80\u5355\u5730doctype\u6765\u542f\u7528\u6807\u51c6\u6a21\u5f0f\uff0c\u4f7f\u5176\u5728\u6bcf\u4e2a\u6d4f\u89c8\u5668\u4e2d\u5c3d\u53ef\u80fd\u4e00\u81f4\u7684\u5c55\u73b0\uff1b <!DOCTYPE html> < html > ... </ html > lang\u5c5e\u6027 \u00b6 \u6839\u636eHTML5\u89c4\u8303\uff1a \u5e94\u5728html\u6807\u7b7e\u4e0a\u52a0\u4e0alang\u5c5e\u6027\u3002\u8fd9\u4f1a\u7ed9\u8bed\u97f3\u5de5\u5177\u548c\u7ffb\u8bd1\u5de5\u5177\u5e2e\u52a9\uff0c\u544a\u8bc9\u5b83\u4eec\u5e94\u5f53\u600e\u4e48\u53bb\u53d1\u97f3\u548c\u7ffb\u8bd1\u3002 \u5728sitepoint\u4e0a\u53ef\u4ee5\u67e5\u5230 \u8bed\u8a00\u5217\u8868 \uff1b \u4f46sitepoint\u53ea\u662f\u7ed9\u51fa\u4e86\u8bed\u8a00\u7684\u5927\u7c7b\uff0c\u4f8b\u5982\u4e2d\u6587\u53ea\u7ed9\u51fa\u4e86zh\uff0c\u4f46\u662f\u6ca1\u6709\u533a\u5206\u9999\u6e2f\uff0c\u53f0\u6e7e\uff0c\u5927\u9646\u3002\u800c\u5fae\u8f6f\u7ed9\u51fa\u4e86\u4e00\u4efd\u66f4\u52a0 \u8be6\u7ec6\u7684\u8bed\u8a00\u5217\u8868 \uff0c\u5176\u4e2d\u7ec6\u5206\u4e86zh-cn, zh-hk, zh-tw\u3002 \u5b57\u7b26\u7f16\u7801 \u00b6 \u901a\u8fc7\u58f0\u660e\u4e00\u4e2a\u660e\u786e\u7684\u5b57\u7b26\u7f16\u7801\uff0c\u8ba9\u6d4f\u89c8\u5668\u8f7b\u677e\u3001\u5feb\u901f\u7684\u786e\u5b9a\u9002\u5408\u7f51\u9875\u5185\u5bb9\u7684\u6e32\u67d3\u65b9\u5f0f\uff0c\u901a\u5e38\u6307\u5b9a\u4e3a UTF-8 \u3002 <!DOCTYPE html> < html > < head > < meta charset = \"UTF-8\" > </ head > ... </ html > IE\u517c\u5bb9\u6a21\u5f0f \u00b6 \u7528 <meta> \u6807\u7b7e\u53ef\u4ee5\u6307\u5b9a\u9875\u9762\u5e94\u8be5\u7528\u4ec0\u4e48\u7248\u672c\u7684IE\u6765\u6e32\u67d3\uff1b <!DOCTYPE html> < html > < head > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=Edge\" > </ head > ... </ html > \u5f15\u5165CSS, JS \u00b6 \u6839\u636eHTML5\u89c4\u8303, \u901a\u5e38\u5728\u5f15\u5165CSS\u548cJS\u65f6\u4e0d\u9700\u8981\u6307\u660e type\uff0c\u56e0\u4e3a text/css \u548c text/javascript \u5206\u522b\u662f\u4ed6\u4eec\u7684\u9ed8\u8ba4\u503c\u3002 <!-- External CSS --> < link rel = \"stylesheet\" href = \"code_guide.css\" > <!-- In-document CSS --> < style > ... </ style > <!-- External JS --> < script src = \"code_guide.js\" ></ script > <!-- In-document JS --> < script > ... </ script > \u5c5e\u6027\u987a\u5e8f \u00b6 \u5c5e\u6027\u5e94\u8be5\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u51fa\u73b0\u4ee5\u4fdd\u8bc1\u6613\u8bfb\u6027\uff1b class id name data-* src , for , type , href , value , max-length , max , min , pattern placeholder , title , alt aria-* , role required , readonly , disabled class\u662f\u4e3a\u9ad8\u53ef\u590d\u7528\u7ec4\u4ef6\u8bbe\u8ba1\u7684\uff0c\u6240\u4ee5\u5e94\u5904\u5728\u7b2c\u4e00\u4f4d\uff1b id\u66f4\u52a0\u5177\u4f53\u4e14\u5e94\u8be5\u5c3d\u91cf\u5c11\u4f7f\u7528\uff0c\u6240\u4ee5\u5c06\u5b83\u653e\u5728\u7b2c\u4e8c\u4f4d\u3002 < a class = \"...\" id = \"...\" data-modal = \"toggle\" href = \"#\" > Example link </ a > < input class = \"form-control\" type = \"text\" > < img src = \"...\" alt = \"...\" > boolean\u5c5e\u6027 \u00b6 boolean\u5c5e\u6027\u6307\u4e0d\u9700\u8981\u58f0\u660e\u53d6\u503c\u7684\u5c5e\u6027\uff0cXHTML\u9700\u8981\u6bcf\u4e2a\u5c5e\u6027\u58f0\u660e\u53d6\u503c\uff0c\u4f46\u662fHTML5\u5e76\u4e0d\u9700\u8981\uff1b \u66f4\u591a\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003 WhatWG section on boolean attributes \uff1a boolean\u5c5e\u6027\u7684\u5b58\u5728\u8868\u793a\u53d6\u503c\u4e3atrue\uff0c\u4e0d\u5b58\u5728\u5219\u8868\u793a\u53d6\u503c\u4e3afalse\u3002 < input type = \"text\" disabled > < input type = \"checkbox\" value = \"1\" checked > < select > < option value = \"1\" selected > 1 </ option > </ select > \u51cf\u5c11\u6807\u7b7e\u6570\u91cf \u00b6 \u5728\u7f16\u5199HTML\u4ee3\u7801\u65f6\uff0c\u9700\u8981\u5c3d\u91cf\u907f\u514d\u591a\u4f59\u7684\u7236\u8282\u70b9\uff1b \u5f88\u591a\u65f6\u5019\uff0c\u9700\u8981\u901a\u8fc7\u8fed\u4ee3\u548c\u91cd\u6784\u6765\u4f7fHTML\u53d8\u5f97\u66f4\u5c11\u3002 <!-- Not well --> < span class = \"avatar\" > < img src = \"...\" > </ span > <!-- Better --> < img class = \"avatar\" src = \"...\" > \u8bed\u4e49\u5316 \u00b6 \u4f7f\u7528\u7b26\u5408\u8bed\u4e49\u7684\u6807\u7b7e\u4e66\u5199 HTML \u6587\u6863, \u9009\u62e9\u6070\u5f53\u7684\u5143\u7d20\u8868\u8fbe\u6240\u9700\u7684\u542b\u4e49\u3002 \u7ed3\u6784\u6027\u5143\u7d20 p \u8868\u793a\u6bb5\u843d. \u53ea\u80fd\u5305\u542b\u5185\u8054\u5143\u7d20, \u4e0d\u80fd\u5305\u542b\u5757\u7ea7\u5143\u7d20; li \u672c\u8eab\u65e0\u7279\u6b8a\u542b\u4e49, \u53ef\u7528\u4e8e\u5e03\u5c40. \u51e0\u4e4e\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u5143\u7d20; br \u8868\u793a\u6362\u884c\u7b26; hr \u8868\u793a\u6c34\u5e73\u5206\u5272\u7ebf; h1-h6 \u8868\u793a\u6807\u9898. \u5176\u4e2d h1 \u7528\u4e8e\u8868\u793a\u5f53\u524d\u9875\u9762\u6700\u91cd\u8981\u7684\u5185\u5bb9\u7684\u6807\u9898; blockquote \u8868\u793a\u5f15\u7528, \u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u6bb5\u843d. \u8bf7\u52ff\u7eaf\u7cb9\u4e3a\u4e86\u7f29\u8fdb\u800c\u4f7f\u7528blockquote, \u5927\u90e8\u5206\u6d4f\u89c8\u5668\u9ed8\u8ba4\u5c06 blockquote \u6e32\u67d3\u4e3a\u5e26\u6709\u5de6\u53f3\u7f29\u8fdb; pre \u8868\u793a\u4e00\u6bb5\u683c\u5f0f\u5316\u597d\u7684\u6587\u672c\uff1b \u5934\u90e8\u5143\u7d20 title \u6bcf\u4e2a\u9875\u9762\u5fc5\u987b\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a title \u5143\u7d20; base \u53ef\u7528\u573a\u666f\uff1a\u9996\u9875\u3001\u9891\u9053\u7b49\u5927\u90e8\u5206\u94fe\u63a5\u90fd\u4e3a\u65b0\u7a97\u53e3\u6253\u5f00\u7684\u9875\u9762; link \u7528\u4e8e\u5f15\u5165 css \u8d44\u6e90\u65f6, \u53ef\u7701\u53bb media(\u9ed8\u8ba4\u4e3aall) \u548c type(\u9ed8\u8ba4\u4e3atext/css) \u5c5e\u6027; style type \u9ed8\u8ba4\u4e3a text/css, \u53ef\u4ee5\u7701\u53bb; script type \u5c5e\u6027\u53ef\u4ee5\u7701\u53bb; \u4e0d\u8d5e\u6210\u4f7f\u7528lang\u5c5e\u6027; \u4e0d\u8981\u4f7f\u7528\u53e4\u8001\u7684<!\u2013 //\u2013>\u8fd9\u79cdhack\u811a\u672c, \u5b83\u7528\u4e8e\u963b\u6b62\u7b2c\u4e00\u4ee3\u6d4f\u89c8\u5668(Netscape 1\u548cMosaic)\u5c06\u811a\u672c\u663e\u793a\u6210\u6587\u5b57; noscript \u5728\u7528\u6237\u4ee3\u7406\u4e0d\u652f\u6301 JavaScript \u7684\u60c5\u51b5\u4e0b\u63d0\u4f9b\u8bf4\u660e\uff1b \u6587\u672c\u5143\u7d20 a \u5b58\u5728 href \u5c5e\u6027\u65f6\u8868\u793a\u94fe\u63a5, \u65e0 href \u5c5e\u6027\u4f46\u6709 name \u5c5e\u6027\u8868\u793a\u951a\u70b9; em,strong em \u8868\u793a\u53e5\u610f\u5f3a\u8c03, \u52a0\u4e0e\u4e0d\u52a0\u4f1a\u5f15\u8d77\u8bed\u4e49\u53d8\u5316, \u53ef\u7528\u4e8e\u8868\u793a\u4e0d\u540c\u7684\u5fc3\u60c5\u6216\u8bed\u8c03; strong \u8868\u793a\u91cd\u8981\u6027\u5f3a\u8c03, \u53ef\u7528\u4e8e\u5c40\u90e8\u6216\u5168\u5c40, strong\u5f3a\u8c03\u7684\u662f\u91cd\u8981\u6027, \u4e0d\u4f1a\u6539\u53d8\u53e5\u610f; abbr \u8868\u793a\u7f29\u5199; sub,sup \u4e3b\u8981\u7528\u4e8e\u6570\u5b66\u548c\u5316\u5b66\u516c\u5f0f, sup\u8fd8\u53ef\u7528\u4e8e\u811a\u6ce8; span \u672c\u8eab\u65e0\u7279\u6b8a\u542b\u4e49; ins,del \u5206\u522b\u8868\u793a\u4ece\u6587\u6863\u4e2d\u589e\u52a0(\u63d2\u5165)\u548c\u5220\u9664\uff1b \u5a92\u4f53\u5143\u7d20 img \u8bf7\u52ff\u5c06img\u5143\u7d20\u4f5c\u4e3a\u5b9a\u4f4d\u5e03\u5c40\u7684\u5de5\u5177, \u4e0d\u8981\u7528\u4ed6\u663e\u793a\u7a7a\u767d\u56fe\u7247; \u5fc5\u8981\u65f6\u7ed9img\u5143\u7d20\u589e\u52a0alt\u5c5e\u6027; object \u53ef\u4ee5\u7528\u6765\u63d2\u5165Flash; \u5217\u8868\u5143\u7d20 dl \u8868\u793a\u5173\u8054\u5217\u8868, dd \u662f\u5bf9 dt \u7684\u89e3\u91ca; dt \u548cdd\u7684\u5bf9\u5e94\u5173\u7cfb\u6bd4\u8f83\u968f\u610f\uff1a\u4e00\u4e2a dt \u5bf9\u5e94\u591a\u4e2a dd \u3001\u591a\u4e2a dt \u5bf9\u5e94\u4e00\u4e2a dd \u3001\u591a\u4e2a dt \u5bf9\u5e94\u591a\u4e2a dd , \u90fd\u5408\u6cd5; \u53ef\u7528\u4e8e\u540d\u8bcd/\u5355\u8bcd\u89e3\u91ca\u3001\u65e5\u7a0b\u5217\u8868\u3001\u7ad9\u70b9\u76ee\u5f55; ul \u8868\u793a\u65e0\u5e8f\u5217\u8868; ol \u8868\u793a\u6709\u5e8f\u5217\u8868, \u53ef\u7528\u4e8e\u6392\u884c\u699c\u7b49; li \u8868\u793a\u5217\u8868\u9879, \u5fc5\u987b\u662f ul/ol \u7684\u5b50\u5143\u7d20; \u8868\u5355\u5143\u7d20 \u63a8\u8350\u4f7f\u7528 button \u4ee3\u66ff input , \u4f46\u5fc5\u987b\u58f0\u660e type ; \u63a8\u8350\u4f7f\u7528 fieldset , legend \u7ec4\u7ec7\u8868\u5355\uff1b \u8868\u5355\u5143\u7d20\u7684 name \u4e0d\u80fd\u8bbe\u5b9a\u4e3a action , enctype , method , novalidate , target , submit \u4f1a\u5bfc\u81f4\u8868\u5355\u63d0\u4ea4\u6df7\u4e71\uff1b id \u548c class \u547d\u540d\u7ea6\u5b9a \u00b6 \u5efa\u8bae\u5c11\u7528id\uff0c\u5fc5\u987b\u4fdd\u8bc1id\u552f\u4e00\u6027 id \u548c class \u7684\u547d\u540d\u603b\u89c4\u5219\u4e3a\uff1a \u5185\u5bb9\u4f18\u5148, \u4f4d\u7f6e\u6b21\u4e4b, \u8868\u73b0\u4e3a\u8f85. \u9996\u5148\u6839\u636e\u5185\u5bb9\u6765\u547d\u540d, \u6bd4\u5982 main-nav\uff0c\u5176\u6b21\u662f\u4f4d\u7f6e\uff0c\u6bd4\u5982 top-nav, left-nav \uff0c\u6700\u540e\u518d\u7ed3\u5408\u8868\u73b0\u6765\u5b9a, \u6bd4\u5982 skin-blue, present-tab, col-main id \u548c class \u540d\u79f0\u4e00\u5f8b\u5c0f\u5199, \u591a\u4e2a\u5355\u8bcd\u7528\u8fde\u5b57\u7b26\u8fde\u63a5, \u6bd4\u5982 recommend-presents id \u548c class \u540d\u79f0\u4e2d\u53ea\u80fd\u51fa\u73b0\u5c0f\u5199\u7684 26 \u4e2a\u82f1\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u8fde\u5b57\u7b26(-), \u4efb\u4f55\u5176\u5b83\u5b57\u7b26\u90fd\u4e25\u7981\u51fa\u73b0 id \u548c class \u5c3d\u91cf\u7528\u82f1\u6587\u5355\u8bcd\u547d\u540d \u5728\u4e0d\u5f71\u54cd\u8bed\u4e49\u7684\u60c5\u51b5\u4e0b, id \u548c class \u540d\u79f0\u4e2d\u53ef\u4ee5\u9002\u5f53\u91c7\u7528\u82f1\u6587\u5355\u8bcd\u7f29\u5199, \u6bd4\u5982 col , nav , hd , bd , ft \u7b49, \u4f46\u5207\u5fcc\u81ea\u9020\u7f29\u5199 id \u548c class \u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u8bcd\u5fc5\u987b\u662f\u5355\u8bcd\u5168\u62fc\u6216\u8bed\u4e49\u975e\u5e38\u6e05\u6670\u7684\u5355\u8bcd\u7f29\u5199, \u6bd4\u5982 present , col CSS \u00b6 \u7f29\u8fdb \u00b6 \u4f7f\u75282\u4e2a\u7a7a\u683c\u7f29\u8fdb . element { position : absolute ; top : 10 px ; left : 10 px ; border-radius : 10 px ; width : 50 px ; height : 50 px ; } \u5206\u53f7 \u00b6 \u6bcf\u4e2a\u5c5e\u6027\u58f0\u660e\u672b\u5c3e\u90fd\u8981\u52a0\u5206\u53f7 . element { width : 20 px ; height : 20 px ; background-color : red ; } \u7a7a\u683c \u00b6 \u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0d\u9700\u8981\u7a7a\u683c\uff1a - \u5c5e\u6027\u540d\u540e - \u591a\u4e2a\u89c4\u5219\u7684\u5206\u9694\u7b26','\u524d - !important '!'\u540e - \u5c5e\u6027\u503c\u4e2d'('\u540e\u548c')'\u524d - \u884c\u672b\u4e0d\u8981\u6709\u591a\u4f59\u7684\u7a7a\u683c \u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u9700\u8981\u7a7a\u683c\uff1a - \u5c5e\u6027\u503c\u524d - \u9009\u62e9\u5668 > , + , ~ \u524d\u540e - { \u524d - !important '!'\u524d - \u5c5e\u6027\u503c\u4e2d\u7684 , \u540e - \u6ce8\u91ca /* \u540e\u548c */ \u524d - \u5c5e\u6027\u5192\u53f7\u540e /* not good */ . element { color : red ! important ; background-color : rgba ( 0 , 0 , 0 , .5 ); } /* good */ . element { color : red !important ; background-color : rgba ( 0 , 0 , 0 , .5 ); } /* not good */ . element , . dialog { ... } /* good */ . element , . dialog { } /* not good */ . element > . dialog { ... } /* good */ . element > . dialog { ... } /* not good */ . element { ... } /* good */ . element { ... } \u6362\u884c \u00b6 \u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0d\u9700\u8981\u6362\u884c\uff1a - { \u524d \u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u9700\u8981\u6362\u884c\uff1a - { \u540e\u548c } \u524d - \u6bcf\u4e2a\u5c5e\u6027\u72ec\u5360\u4e00\u884c - \u591a\u4e2a\u89c4\u5219\u7684\u5206\u9694\u7b26 , \u540e /* not good */ . element { color : red ; background-color : black ;} /* good */ . element { color : red ; background-color : black ; } /* not good */ . element , . dialog { ... } /* good */ . element , . dialog { ... } \u6ce8\u91ca \u00b6 \u6ce8\u91ca\u7edf\u4e00\u7528 /* */ \u7f29\u8fdb\u4e0e\u4e0b\u4e00\u884c\u4ee3\u7801\u4fdd\u6301\u4e00\u81f4 \u53ef\u4f4d\u4e8e\u4e00\u4e2a\u4ee3\u7801\u884c\u7684\u672b\u5c3e\uff0c\u4e0e\u4ee3\u7801\u95f4\u9694\u4e00\u4e2a\u7a7a\u683c /* Modal header */ . modal-header { ... } /* * Modal header */ . modal-header { ... } . modal-header { /* 50px */ width : 50 px ; color : red ; /* color red */ } \u5f15\u53f7 \u00b6 \u6700\u5916\u5c42\u7edf\u4e00\u4f7f\u7528\u53cc\u5f15\u53f7\uff1b url\u7684\u5185\u5bb9\u8981\u7528\u5f15\u53f7\uff1b \u5c5e\u6027\u9009\u62e9\u5668\u4e2d\u7684\u5c5e\u6027\u503c\u9700\u8981\u5f15\u53f7\u3002 . element : after { content : \"\" ; background-image : url ( \"logo.png\" ); } li [ data-type = \"single\" ] { ... } \u547d\u540d \u00b6 \u7c7b\u540d\u4f7f\u7528\u5c0f\u5199\u5b57\u6bcd\uff0c\u4ee5\u4e2d\u5212\u7ebf\u5206\u9694 id\u91c7\u7528\u9a7c\u5cf0\u5f0f\u547d\u540d /* class */ . element-content { ... } /* id */ # myDialog { ... } \u5c5e\u6027\u58f0\u660e\u987a\u5e8f \u00b6 \u76f8\u5173\u7684\u5c5e\u6027\u58f0\u660e\u6309\u7167\u987a\u5e8f\u505a\u5206\u7ec4\u5904\u7406\uff0c\u7ec4\u4e4b\u95f4\u9700\u8981\u6709\u4e00\u4e2a\u7a7a\u884c\uff0c\u8fd9\u4e2a\u53ef\u9009 \u7531\u5916\u5411\u91cc\u5199\u5c5e\u6027\uff0c\u5148\u662f\u5916\u58f3\u600e\u4e48\u5c5e\u6027\uff0c display \uff0c float \uff0c\u63a5\u7740\u662f\u5b9a\u4f4d\u76f8\u5173\u7684\u5c5e\u6027\uff0c position \u7b49\uff0c\u7136\u540e\u662f\u5f00\u59cb\u63cf\u5916\u8fb9\u8ddd margin \uff0c\u8fb9\u6846\u7c97\u7ec6\u3001\u989c\u8272 border \uff0c\u7136\u540e\u662f\u5185\u8fb9\u8ddd\uff0c\u54e6\uff0c\u5f53\u7136\uff0c\u53ef\u80fd\u6709\u65f6\u5019\u8fd8\u6765\u4e2a\u5706\u89d2\uff0c\u6846\u5b50\u63cf\u5b8c\u4e86\u5c31\u5f00\u59cb\u63cf\u9ad8\u5ea6\u5bbd\u5ea6 width , height \uff0c\u63a5\u7740\u662f\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u5b57\u4f53\u600e\u4e48\u663e\u793a\uff08\u5b57\u4f53\u989c\u8272\uff0c\u5c45\u4e2d\u8fd8\u662f\u5c45\u5de6\u7b49\u7b49\uff09\uff0c\u7136\u540e\u662f\u80cc\u666f\u56fe\u554a\u4e4b\u7c7b\u7684\uff0c\u6700\u540e\u662f\u4e00\u4e9b\u6742\u9879\uff0c\u900f\u660e\u5ea6\uff0c\u9f20\u6807\uff0c\u52a8\u753b\u7b49 . declaration-order { display : block ; float : right ; position : absolute ; top : 0 ; right : 0 ; bottom : 0 ; left : 0 ; z-index : 100 ; border : 1 px solid #e5e5e5 ; border-radius : 3 px ; width : 100 px ; height : 100 px ; font : normal 13 px \"Helvetica Neue\" , sans-serif ; line-height : 1.5 ; text-align : center ; color : #333 ; background-color : #f5f5f5 ; opacity : 1 ; } // \u4e0b\u9762\u662f\u63a8\u8350\u7684\u5c5e\u6027\u7684\u987a\u5e8f [ [ \"display\" , \"visibility\" , \"float\" , \"clear\" , \"overflow\" , \"overflow-x\" , \"overflow-y\" , \"clip\" , \"zoom\" ], [ \"table-layout\" , \"empty-cells\" , \"caption-side\" , \"border-spacing\" , \"border-collapse\" , \"list-style\" , \"list-style-position\" , \"list-style-type\" , \"list-style-image\" ], [ \"-webkit-box-orient\" , \"-webkit-box-direction\" , \"-webkit-box-decoration-break\" , \"-webkit-box-pack\" , \"-webkit-box-align\" , \"-webkit-box-flex\" ], [ \"position\" , \"top\" , \"right\" , \"bottom\" , \"left\" , \"z-index\" ], [ \"margin\" , \"margin-top\" , \"margin-right\" , \"margin-bottom\" , \"margin-left\" , \"-webkit-box-sizing\" , \"-moz-box-sizing\" , \"box-sizing\" , \"border\" , \"border-width\" , \"border-style\" , \"border-color\" , \"border-top\" , \"border-top-width\" , \"border-top-style\" , \"border-top-color\" , \"border-right\" , \"border-right-width\" , \"border-right-style\" , \"border-right-color\" , \"border-bottom\" , \"border-bottom-width\" , \"border-bottom-style\" , \"border-bottom-color\" , \"border-left\" , \"border-left-width\" , \"border-left-style\" , \"border-left-color\" , \"-webkit-border-radius\" , \"-moz-border-radius\" , \"border-radius\" , \"-webkit-border-top-left-radius\" , \"-moz-border-radius-topleft\" , \"border-top-left-radius\" , \"-webkit-border-top-right-radius\" , \"-moz-border-radius-topright\" , \"border-top-right-radius\" , \"-webkit-border-bottom-right-radius\" , \"-moz-border-radius-bottomright\" , \"border-bottom-right-radius\" , \"-webkit-border-bottom-left-radius\" , \"-moz-border-radius-bottomleft\" , \"border-bottom-left-radius\" , \"-webkit-border-image\" , \"-moz-border-image\" , \"-o-border-image\" , \"border-image\" , \"-webkit-border-image-source\" , \"-moz-border-image-source\" , \"-o-border-image-source\" , \"border-image-source\" , \"-webkit-border-image-slice\" , \"-moz-border-image-slice\" , \"-o-border-image-slice\" , \"border-image-slice\" , \"-webkit-border-image-width\" , \"-moz-border-image-width\" , \"-o-border-image-width\" , \"border-image-width\" , \"-webkit-border-image-outset\" , \"-moz-border-image-outset\" , \"-o-border-image-outset\" , \"border-image-outset\" , \"-webkit-border-image-repeat\" , \"-moz-border-image-repeat\" , \"-o-border-image-repeat\" , \"border-image-repeat\" , \"padding\" , \"padding-top\" , \"padding-right\" , \"padding-bottom\" , \"padding-left\" , \"width\" , \"min-width\" , \"max-width\" , \"height\" , \"min-height\" , \"max-height\" ], [ \"font\" , \"font-family\" , \"font-size\" , \"font-weight\" , \"font-style\" , \"font-variant\" , \"font-size-adjust\" , \"font-stretch\" , \"font-effect\" , \"font-emphasize\" , \"font-emphasize-position\" , \"font-emphasize-style\" , \"font-smooth\" , \"line-height\" , \"text-align\" , \"-webkit-text-align-last\" , \"-moz-text-align-last\" , \"-ms-text-align-last\" , \"text-align-last\" , \"vertical-align\" , \"white-space\" , \"text-decoration\" , \"text-emphasis\" , \"text-emphasis-color\" , \"text-emphasis-style\" , \"text-emphasis-position\" , \"text-indent\" , \"-ms-text-justify\" , \"text-justify\" , \"letter-spacing\" , \"word-spacing\" , \"-ms-writing-mode\" , \"text-outline\" , \"text-transform\" , \"text-wrap\" , \"-ms-text-overflow\" , \"text-overflow\" , \"text-overflow-ellipsis\" , \"text-overflow-mode\" , \"-ms-word-wrap\" , \"word-wrap\" , \"-ms-word-break\" , \"word-break\" ], [ \"color\" , \"background\" , \"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader\" , \"background-color\" , \"background-image\" , \"background-repeat\" , \"background-attachment\" , \"background-position\" , \"-ms-background-position-x\" , \"background-position-x\" , \"-ms-background-position-y\" , \"background-position-y\" , \"-webkit-background-clip\" , \"-moz-background-clip\" , \"background-clip\" , \"background-origin\" , \"-webkit-background-size\" , \"-moz-background-size\" , \"-o-background-size\" , \"background-size\" ], [ \"outline\" , \"outline-width\" , \"outline-style\" , \"outline-color\" , \"outline-offset\" , \"opacity\" , \"filter:progid:DXImageTransform.Microsoft.Alpha(Opacity\" , \"-ms-filter:\\\\'progid:DXImageTransform.Microsoft.Alpha\" , \"-ms-interpolation-mode\" , \"-webkit-box-shadow\" , \"-moz-box-shadow\" , \"box-shadow\" , \"filter:progid:DXImageTransform.Microsoft.gradient\" , \"-ms-filter:\\\\'progid:DXImageTransform.Microsoft.gradient\" , \"text-shadow\" ], [ \"-webkit-transition\" , \"-moz-transition\" , \"-ms-transition\" , \"-o-transition\" , \"transition\" , \"-webkit-transition-delay\" , \"-moz-transition-delay\" , \"-ms-transition-delay\" , \"-o-transition-delay\" , \"transition-delay\" , \"-webkit-transition-timing-function\" , \"-moz-transition-timing-function\" , \"-ms-transition-timing-function\" , \"-o-transition-timing-function\" , \"transition-timing-function\" , \"-webkit-transition-duration\" , \"-moz-transition-duration\" , \"-ms-transition-duration\" , \"-o-transition-duration\" , \"transition-duration\" , \"-webkit-transition-property\" , \"-moz-transition-property\" , \"-ms-transition-property\" , \"-o-transition-property\" , \"transition-property\" , \"-webkit-transform\" , \"-moz-transform\" , \"-ms-transform\" , \"-o-transform\" , \"transform\" , \"-webkit-transform-origin\" , \"-moz-transform-origin\" , \"-ms-transform-origin\" , \"-o-transform-origin\" , \"transform-origin\" , \"-webkit-animation\" , \"-moz-animation\" , \"-ms-animation\" , \"-o-animation\" , \"animation\" , \"-webkit-animation-name\" , \"-moz-animation-name\" , \"-ms-animation-name\" , \"-o-animation-name\" , \"animation-name\" , \"-webkit-animation-duration\" , \"-moz-animation-duration\" , \"-ms-animation-duration\" , \"-o-animation-duration\" , \"animation-duration\" , \"-webkit-animation-play-state\" , \"-moz-animation-play-state\" , \"-ms-animation-play-state\" , \"-o-animation-play-state\" , \"animation-play-state\" , \"-webkit-animation-timing-function\" , \"-moz-animation-timing-function\" , \"-ms-animation-timing-function\" , \"-o-animation-timing-function\" , \"animation-timing-function\" , \"-webkit-animation-delay\" , \"-moz-animation-delay\" , \"-ms-animation-delay\" , \"-o-animation-delay\" , \"animation-delay\" , \"-webkit-animation-iteration-count\" , \"-moz-animation-iteration-count\" , \"-ms-animation-iteration-count\" , \"-o-animation-iteration-count\" , \"animation-iteration-count\" , \"-webkit-animation-direction\" , \"-moz-animation-direction\" , \"-ms-animation-direction\" , \"-o-animation-direction\" , \"animation-direction\" ] ] \u989c\u8272 \u00b6 \u989c\u827216\u8fdb\u5236\u7528\u5c0f\u5199\u5b57\u6bcd\uff1b \u989c\u827216\u8fdb\u5236\u5c3d\u91cf\u7528\u7b80\u5199\u3002 /* not good */ . element { color : #ABCDEF ; background-color : #001122 ; } /* good */ . element { color : #abcdef ; background-color : #012 ; } \u5c5e\u6027\u7b80\u5199 \u00b6 \u5c5e\u6027\u7b80\u5199\u9700\u8981\u4f60\u975e\u5e38\u6e05\u695a\u5c5e\u6027\u503c\u7684\u6b63\u786e\u987a\u5e8f\uff0c\u800c\u4e14\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5e76\u4e0d\u9700\u8981\u8bbe\u7f6e\u5c5e\u6027\u7b80\u5199\u4e2d\u5305\u542b\u7684\u6240\u6709\u503c\uff0c\u6240\u4ee5\u5efa\u8bae\u5c3d\u91cf\u5206\u5f00\u58f0\u660e\u4f1a\u66f4\u52a0\u6e05\u6670\uff1b margin \u548c padding \u76f8\u53cd\uff0c\u9700\u8981\u4f7f\u7528\u7b80\u5199\uff1b \u5e38\u89c1\u7684\u5c5e\u6027\u7b80\u5199\u5305\u62ec\uff1a - font - background - transition - animation /* not good */ . element { transition : opacity 1 s linear 2 s ; } /* good */ . element { transition-delay : 2 s ; transition-timing-function : linear ; transition-duration : 1 s ; transition-property : opacity ; } \u5a92\u4f53\u67e5\u8be2 \u00b6 \u5c3d\u91cf\u5c06\u5a92\u4f53\u67e5\u8be2\u7684\u89c4\u5219\u9760\u8fd1\u4e0e\u4ed6\u4eec\u76f8\u5173\u7684\u89c4\u5219\uff0c\u4e0d\u8981\u5c06\u4ed6\u4eec\u4e00\u8d77\u653e\u5230\u4e00\u4e2a\u72ec\u7acb\u7684\u6837\u5f0f\u6587\u4ef6\u4e2d\uff0c\u6216\u8005\u4e22\u5728\u6587\u6863\u7684\u6700\u5e95\u90e8\uff0c\u8fd9\u6837\u505a\u53ea\u4f1a\u8ba9\u5927\u5bb6\u4ee5\u540e\u66f4\u5bb9\u6613\u5fd8\u8bb0\u4ed6\u4eec . element { ... } . element-avatar { ... } @ media ( min-width : 480px ) { . element { ... } . element-avatar { ... } } \u6742\u9879 \u00b6 \u4e0d\u5141\u8bb8\u6709\u7a7a\u7684\u89c4\u5219\uff1b \u5143\u7d20\u9009\u62e9\u5668\u7528\u5c0f\u5199\u5b57\u6bcd\uff1b \u53bb\u6389\u5c0f\u6570\u70b9\u524d\u9762\u76840\uff1b \u53bb\u6389\u6570\u5b57\u4e2d\u4e0d\u5fc5\u8981\u7684\u5c0f\u6570\u70b9\u548c\u672b\u5c3e\u76840\uff1b \u5c5e\u6027\u503c 0 \u540e\u9762\u4e0d\u8981\u52a0\u5355\u4f4d\uff1b \u540c\u4e2a\u5c5e\u6027\u4e0d\u540c\u524d\u7f00\u7684\u5199\u6cd5\u9700\u8981\u5728\u5782\u76f4\u65b9\u5411\u4fdd\u6301\u5bf9\u9f50\uff0c\u5177\u4f53\u53c2\u7167\u53f3\u8fb9\u7684\u5199\u6cd5\uff1b \u65e0\u524d\u7f00\u7684\u6807\u51c6\u5c5e\u6027\u5e94\u8be5\u5199\u5728\u6709\u524d\u7f00\u7684\u5c5e\u6027\u540e\u9762\uff1b \u4e0d\u8981\u5728\u540c\u4e2a\u89c4\u5219\u91cc\u51fa\u73b0\u91cd\u590d\u7684\u5c5e\u6027\uff0c\u5982\u679c\u91cd\u590d\u7684\u5c5e\u6027\u662f\u8fde\u7eed\u7684\u5219\u6ca1\u5173\u7cfb\uff1b \u4e0d\u8981\u5728\u4e00\u4e2a\u6587\u4ef6\u91cc\u51fa\u73b0\u4e24\u4e2a\u76f8\u540c\u7684\u89c4\u5219\uff1b \u7528 border: 0 ; \u4ee3\u66ff border: none; \uff1b \u9009\u62e9\u5668\u4e0d\u8981\u8d85\u8fc74\u5c42\uff08\u5728scss\u4e2d\u5982\u679c\u8d85\u8fc74\u5c42\u5e94\u8be5\u8003\u8651\u7528\u5d4c\u5957\u7684\u65b9\u5f0f\u6765\u5199\uff09\uff1b \u53d1\u5e03\u7684\u4ee3\u7801\u4e2d\u4e0d\u8981\u6709 @import \uff1b \u5c3d\u91cf\u5c11\u7528'*'\u9009\u62e9\u5668\u3002 /* not good */ . element { } /* not good */ LI { ... } /* good */ li { ... } /* not good */ . element { color : rgba ( 0 , 0 , 0 , 0.5 ); } /* good */ . element { color : rgba ( 0 , 0 , 0 , .5 ); } /* not good */ . element { width : 50.0 px ; } /* good */ . element { width : 50 px ; } /* not good */ . element { width : 0 px ; } /* good */ . element { width : 0 ; } /* not good */ . element { border-radius : 3 px ; -webkit- border-radius : 3 px ; -moz- border-radius : 3 px ; background : linear-gradient ( to bottom , #fff 0 , #eee 100 % ); background : -webkit- linear-gradient ( top , #fff 0 , #eee 100 % ); background : -moz- linear-gradient ( top , #fff 0 , #eee 100 % ); } /* good */ . element { -webkit- border-radius : 3 px ; -moz- border-radius : 3 px ; border-radius : 3 px ; background : -webkit- linear-gradient ( top , #fff 0 , #eee 100 % ); background : -moz- linear-gradient ( top , #fff 0 , #eee 100 % ); background : linear-gradient ( to bottom , #fff 0 , #eee 100 % ); } /* not good */ . element { color : rgb ( 0 , 0 , 0 ); width : 50 px ; color : rgba ( 0 , 0 , 0 , .5 ); } /* good */ . element { color : rgb ( 0 , 0 , 0 ); color : rgba ( 0 , 0 , 0 , .5 ); }","title":"web\u5f00\u53d1\u89c4\u8303"},{"location":"other/#_1","text":"\u524d\u7aef\u5f00\u53d1\u6d89\u53ca\u7684\u6240\u6587\u4ef6\u7edf\u4e00\u4f7f\u7528 utf-8 \u7f16\u7801","title":"\u6587\u4ef6\u7f16\u7801"},{"location":"other/#_2","text":"\u5168\u90e8\u5c0f\u5199\u65b9\u5f0f\uff0c\u4ee5\u4e0b\u5212\u7ebf\u5206\u9694 \u4f8b\uff1amy_project \u7279\u4f8b\uff1adrupal\u4e2d\u7684\u6a21\u7248\u6587\u4ef6","title":"\u6587\u4ef6\u547d\u540d\u89c4\u5219"},{"location":"other/#html","text":"","title":"HTML"},{"location":"other/#_3","text":"\u7f29\u8fdb\u4f7f\u75282\u4e2a\u7a7a\u683c\uff1b \u5d4c\u5957\u7684\u8282\u70b9\u5e94\u8be5\u7f29\u8fdb\uff1b \u5728\u5c5e\u6027\u4e0a\uff0c\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u4e0d\u8981\u4f7f\u7528\u5355\u5f15\u53f7\uff1b \u5c5e\u6027\u540d\u5168\u5c0f\u5199\uff0c\u7528\u4e2d\u5212\u7ebf\u505a\u5206\u9694\u7b26\uff1b \u4e0d\u8981\u5728\u81ea\u52a8\u95ed\u5408\u6807\u7b7e\u7ed3\u5c3e\u5904\u4f7f\u7528\u659c\u7ebf\uff08 HTML5 \u89c4\u8303 \u6307\u51fa\u4ed6\u4eec\u662f\u53ef\u9009\u7684\uff09\uff1b \u4e0d\u8981\u5ffd\u7565\u53ef\u9009\u7684\u5173\u95ed\u6807\u7b7e\uff0c\u4f8b\uff1a </li> \u548c </body> \u3002 <!DOCTYPE html> < html > < head > < title > Page title </ title > </ head > < body > < img src = \"images/company_logo.png\" alt = \"Company\" > < h1 class = \"hello-world\" > Hello, world! </ h1 > </ body > </ html >","title":"\u8bed\u6cd5"},{"location":"other/#html5-doctype","text":"\u5728\u9875\u9762\u5f00\u5934\u4f7f\u7528\u8fd9\u4e2a\u7b80\u5355\u5730doctype\u6765\u542f\u7528\u6807\u51c6\u6a21\u5f0f\uff0c\u4f7f\u5176\u5728\u6bcf\u4e2a\u6d4f\u89c8\u5668\u4e2d\u5c3d\u53ef\u80fd\u4e00\u81f4\u7684\u5c55\u73b0\uff1b <!DOCTYPE html> < html > ... </ html >","title":"HTML5 doctype"},{"location":"other/#lang","text":"\u6839\u636eHTML5\u89c4\u8303\uff1a \u5e94\u5728html\u6807\u7b7e\u4e0a\u52a0\u4e0alang\u5c5e\u6027\u3002\u8fd9\u4f1a\u7ed9\u8bed\u97f3\u5de5\u5177\u548c\u7ffb\u8bd1\u5de5\u5177\u5e2e\u52a9\uff0c\u544a\u8bc9\u5b83\u4eec\u5e94\u5f53\u600e\u4e48\u53bb\u53d1\u97f3\u548c\u7ffb\u8bd1\u3002 \u5728sitepoint\u4e0a\u53ef\u4ee5\u67e5\u5230 \u8bed\u8a00\u5217\u8868 \uff1b \u4f46sitepoint\u53ea\u662f\u7ed9\u51fa\u4e86\u8bed\u8a00\u7684\u5927\u7c7b\uff0c\u4f8b\u5982\u4e2d\u6587\u53ea\u7ed9\u51fa\u4e86zh\uff0c\u4f46\u662f\u6ca1\u6709\u533a\u5206\u9999\u6e2f\uff0c\u53f0\u6e7e\uff0c\u5927\u9646\u3002\u800c\u5fae\u8f6f\u7ed9\u51fa\u4e86\u4e00\u4efd\u66f4\u52a0 \u8be6\u7ec6\u7684\u8bed\u8a00\u5217\u8868 \uff0c\u5176\u4e2d\u7ec6\u5206\u4e86zh-cn, zh-hk, zh-tw\u3002","title":"lang\u5c5e\u6027"},{"location":"other/#_4","text":"\u901a\u8fc7\u58f0\u660e\u4e00\u4e2a\u660e\u786e\u7684\u5b57\u7b26\u7f16\u7801\uff0c\u8ba9\u6d4f\u89c8\u5668\u8f7b\u677e\u3001\u5feb\u901f\u7684\u786e\u5b9a\u9002\u5408\u7f51\u9875\u5185\u5bb9\u7684\u6e32\u67d3\u65b9\u5f0f\uff0c\u901a\u5e38\u6307\u5b9a\u4e3a UTF-8 \u3002 <!DOCTYPE html> < html > < head > < meta charset = \"UTF-8\" > </ head > ... </ html >","title":"\u5b57\u7b26\u7f16\u7801"},{"location":"other/#ie","text":"\u7528 <meta> \u6807\u7b7e\u53ef\u4ee5\u6307\u5b9a\u9875\u9762\u5e94\u8be5\u7528\u4ec0\u4e48\u7248\u672c\u7684IE\u6765\u6e32\u67d3\uff1b <!DOCTYPE html> < html > < head > < meta http-equiv = \"X-UA-Compatible\" content = \"IE=Edge\" > </ head > ... </ html >","title":"IE\u517c\u5bb9\u6a21\u5f0f"},{"location":"other/#css-js","text":"\u6839\u636eHTML5\u89c4\u8303, \u901a\u5e38\u5728\u5f15\u5165CSS\u548cJS\u65f6\u4e0d\u9700\u8981\u6307\u660e type\uff0c\u56e0\u4e3a text/css \u548c text/javascript \u5206\u522b\u662f\u4ed6\u4eec\u7684\u9ed8\u8ba4\u503c\u3002 <!-- External CSS --> < link rel = \"stylesheet\" href = \"code_guide.css\" > <!-- In-document CSS --> < style > ... </ style > <!-- External JS --> < script src = \"code_guide.js\" ></ script > <!-- In-document JS --> < script > ... </ script >","title":"\u5f15\u5165CSS, JS"},{"location":"other/#_5","text":"\u5c5e\u6027\u5e94\u8be5\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u51fa\u73b0\u4ee5\u4fdd\u8bc1\u6613\u8bfb\u6027\uff1b class id name data-* src , for , type , href , value , max-length , max , min , pattern placeholder , title , alt aria-* , role required , readonly , disabled class\u662f\u4e3a\u9ad8\u53ef\u590d\u7528\u7ec4\u4ef6\u8bbe\u8ba1\u7684\uff0c\u6240\u4ee5\u5e94\u5904\u5728\u7b2c\u4e00\u4f4d\uff1b id\u66f4\u52a0\u5177\u4f53\u4e14\u5e94\u8be5\u5c3d\u91cf\u5c11\u4f7f\u7528\uff0c\u6240\u4ee5\u5c06\u5b83\u653e\u5728\u7b2c\u4e8c\u4f4d\u3002 < a class = \"...\" id = \"...\" data-modal = \"toggle\" href = \"#\" > Example link </ a > < input class = \"form-control\" type = \"text\" > < img src = \"...\" alt = \"...\" >","title":"\u5c5e\u6027\u987a\u5e8f"},{"location":"other/#boolean","text":"boolean\u5c5e\u6027\u6307\u4e0d\u9700\u8981\u58f0\u660e\u53d6\u503c\u7684\u5c5e\u6027\uff0cXHTML\u9700\u8981\u6bcf\u4e2a\u5c5e\u6027\u58f0\u660e\u53d6\u503c\uff0c\u4f46\u662fHTML5\u5e76\u4e0d\u9700\u8981\uff1b \u66f4\u591a\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003 WhatWG section on boolean attributes \uff1a boolean\u5c5e\u6027\u7684\u5b58\u5728\u8868\u793a\u53d6\u503c\u4e3atrue\uff0c\u4e0d\u5b58\u5728\u5219\u8868\u793a\u53d6\u503c\u4e3afalse\u3002 < input type = \"text\" disabled > < input type = \"checkbox\" value = \"1\" checked > < select > < option value = \"1\" selected > 1 </ option > </ select >","title":"boolean\u5c5e\u6027"},{"location":"other/#_6","text":"\u5728\u7f16\u5199HTML\u4ee3\u7801\u65f6\uff0c\u9700\u8981\u5c3d\u91cf\u907f\u514d\u591a\u4f59\u7684\u7236\u8282\u70b9\uff1b \u5f88\u591a\u65f6\u5019\uff0c\u9700\u8981\u901a\u8fc7\u8fed\u4ee3\u548c\u91cd\u6784\u6765\u4f7fHTML\u53d8\u5f97\u66f4\u5c11\u3002 <!-- Not well --> < span class = \"avatar\" > < img src = \"...\" > </ span > <!-- Better --> < img class = \"avatar\" src = \"...\" >","title":"\u51cf\u5c11\u6807\u7b7e\u6570\u91cf"},{"location":"other/#_7","text":"\u4f7f\u7528\u7b26\u5408\u8bed\u4e49\u7684\u6807\u7b7e\u4e66\u5199 HTML \u6587\u6863, \u9009\u62e9\u6070\u5f53\u7684\u5143\u7d20\u8868\u8fbe\u6240\u9700\u7684\u542b\u4e49\u3002 \u7ed3\u6784\u6027\u5143\u7d20 p \u8868\u793a\u6bb5\u843d. \u53ea\u80fd\u5305\u542b\u5185\u8054\u5143\u7d20, \u4e0d\u80fd\u5305\u542b\u5757\u7ea7\u5143\u7d20; li \u672c\u8eab\u65e0\u7279\u6b8a\u542b\u4e49, \u53ef\u7528\u4e8e\u5e03\u5c40. \u51e0\u4e4e\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u5143\u7d20; br \u8868\u793a\u6362\u884c\u7b26; hr \u8868\u793a\u6c34\u5e73\u5206\u5272\u7ebf; h1-h6 \u8868\u793a\u6807\u9898. \u5176\u4e2d h1 \u7528\u4e8e\u8868\u793a\u5f53\u524d\u9875\u9762\u6700\u91cd\u8981\u7684\u5185\u5bb9\u7684\u6807\u9898; blockquote \u8868\u793a\u5f15\u7528, \u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u6bb5\u843d. \u8bf7\u52ff\u7eaf\u7cb9\u4e3a\u4e86\u7f29\u8fdb\u800c\u4f7f\u7528blockquote, \u5927\u90e8\u5206\u6d4f\u89c8\u5668\u9ed8\u8ba4\u5c06 blockquote \u6e32\u67d3\u4e3a\u5e26\u6709\u5de6\u53f3\u7f29\u8fdb; pre \u8868\u793a\u4e00\u6bb5\u683c\u5f0f\u5316\u597d\u7684\u6587\u672c\uff1b \u5934\u90e8\u5143\u7d20 title \u6bcf\u4e2a\u9875\u9762\u5fc5\u987b\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a title \u5143\u7d20; base \u53ef\u7528\u573a\u666f\uff1a\u9996\u9875\u3001\u9891\u9053\u7b49\u5927\u90e8\u5206\u94fe\u63a5\u90fd\u4e3a\u65b0\u7a97\u53e3\u6253\u5f00\u7684\u9875\u9762; link \u7528\u4e8e\u5f15\u5165 css \u8d44\u6e90\u65f6, \u53ef\u7701\u53bb media(\u9ed8\u8ba4\u4e3aall) \u548c type(\u9ed8\u8ba4\u4e3atext/css) \u5c5e\u6027; style type \u9ed8\u8ba4\u4e3a text/css, \u53ef\u4ee5\u7701\u53bb; script type \u5c5e\u6027\u53ef\u4ee5\u7701\u53bb; \u4e0d\u8d5e\u6210\u4f7f\u7528lang\u5c5e\u6027; \u4e0d\u8981\u4f7f\u7528\u53e4\u8001\u7684<!\u2013 //\u2013>\u8fd9\u79cdhack\u811a\u672c, \u5b83\u7528\u4e8e\u963b\u6b62\u7b2c\u4e00\u4ee3\u6d4f\u89c8\u5668(Netscape 1\u548cMosaic)\u5c06\u811a\u672c\u663e\u793a\u6210\u6587\u5b57; noscript \u5728\u7528\u6237\u4ee3\u7406\u4e0d\u652f\u6301 JavaScript \u7684\u60c5\u51b5\u4e0b\u63d0\u4f9b\u8bf4\u660e\uff1b \u6587\u672c\u5143\u7d20 a \u5b58\u5728 href \u5c5e\u6027\u65f6\u8868\u793a\u94fe\u63a5, \u65e0 href \u5c5e\u6027\u4f46\u6709 name \u5c5e\u6027\u8868\u793a\u951a\u70b9; em,strong em \u8868\u793a\u53e5\u610f\u5f3a\u8c03, \u52a0\u4e0e\u4e0d\u52a0\u4f1a\u5f15\u8d77\u8bed\u4e49\u53d8\u5316, \u53ef\u7528\u4e8e\u8868\u793a\u4e0d\u540c\u7684\u5fc3\u60c5\u6216\u8bed\u8c03; strong \u8868\u793a\u91cd\u8981\u6027\u5f3a\u8c03, \u53ef\u7528\u4e8e\u5c40\u90e8\u6216\u5168\u5c40, strong\u5f3a\u8c03\u7684\u662f\u91cd\u8981\u6027, \u4e0d\u4f1a\u6539\u53d8\u53e5\u610f; abbr \u8868\u793a\u7f29\u5199; sub,sup \u4e3b\u8981\u7528\u4e8e\u6570\u5b66\u548c\u5316\u5b66\u516c\u5f0f, sup\u8fd8\u53ef\u7528\u4e8e\u811a\u6ce8; span \u672c\u8eab\u65e0\u7279\u6b8a\u542b\u4e49; ins,del \u5206\u522b\u8868\u793a\u4ece\u6587\u6863\u4e2d\u589e\u52a0(\u63d2\u5165)\u548c\u5220\u9664\uff1b \u5a92\u4f53\u5143\u7d20 img \u8bf7\u52ff\u5c06img\u5143\u7d20\u4f5c\u4e3a\u5b9a\u4f4d\u5e03\u5c40\u7684\u5de5\u5177, \u4e0d\u8981\u7528\u4ed6\u663e\u793a\u7a7a\u767d\u56fe\u7247; \u5fc5\u8981\u65f6\u7ed9img\u5143\u7d20\u589e\u52a0alt\u5c5e\u6027; object \u53ef\u4ee5\u7528\u6765\u63d2\u5165Flash; \u5217\u8868\u5143\u7d20 dl \u8868\u793a\u5173\u8054\u5217\u8868, dd \u662f\u5bf9 dt \u7684\u89e3\u91ca; dt \u548cdd\u7684\u5bf9\u5e94\u5173\u7cfb\u6bd4\u8f83\u968f\u610f\uff1a\u4e00\u4e2a dt \u5bf9\u5e94\u591a\u4e2a dd \u3001\u591a\u4e2a dt \u5bf9\u5e94\u4e00\u4e2a dd \u3001\u591a\u4e2a dt \u5bf9\u5e94\u591a\u4e2a dd , \u90fd\u5408\u6cd5; \u53ef\u7528\u4e8e\u540d\u8bcd/\u5355\u8bcd\u89e3\u91ca\u3001\u65e5\u7a0b\u5217\u8868\u3001\u7ad9\u70b9\u76ee\u5f55; ul \u8868\u793a\u65e0\u5e8f\u5217\u8868; ol \u8868\u793a\u6709\u5e8f\u5217\u8868, \u53ef\u7528\u4e8e\u6392\u884c\u699c\u7b49; li \u8868\u793a\u5217\u8868\u9879, \u5fc5\u987b\u662f ul/ol \u7684\u5b50\u5143\u7d20; \u8868\u5355\u5143\u7d20 \u63a8\u8350\u4f7f\u7528 button \u4ee3\u66ff input , \u4f46\u5fc5\u987b\u58f0\u660e type ; \u63a8\u8350\u4f7f\u7528 fieldset , legend \u7ec4\u7ec7\u8868\u5355\uff1b \u8868\u5355\u5143\u7d20\u7684 name \u4e0d\u80fd\u8bbe\u5b9a\u4e3a action , enctype , method , novalidate , target , submit \u4f1a\u5bfc\u81f4\u8868\u5355\u63d0\u4ea4\u6df7\u4e71\uff1b","title":"\u8bed\u4e49\u5316"},{"location":"other/#id-class","text":"\u5efa\u8bae\u5c11\u7528id\uff0c\u5fc5\u987b\u4fdd\u8bc1id\u552f\u4e00\u6027 id \u548c class \u7684\u547d\u540d\u603b\u89c4\u5219\u4e3a\uff1a \u5185\u5bb9\u4f18\u5148, \u4f4d\u7f6e\u6b21\u4e4b, \u8868\u73b0\u4e3a\u8f85. \u9996\u5148\u6839\u636e\u5185\u5bb9\u6765\u547d\u540d, \u6bd4\u5982 main-nav\uff0c\u5176\u6b21\u662f\u4f4d\u7f6e\uff0c\u6bd4\u5982 top-nav, left-nav \uff0c\u6700\u540e\u518d\u7ed3\u5408\u8868\u73b0\u6765\u5b9a, \u6bd4\u5982 skin-blue, present-tab, col-main id \u548c class \u540d\u79f0\u4e00\u5f8b\u5c0f\u5199, \u591a\u4e2a\u5355\u8bcd\u7528\u8fde\u5b57\u7b26\u8fde\u63a5, \u6bd4\u5982 recommend-presents id \u548c class \u540d\u79f0\u4e2d\u53ea\u80fd\u51fa\u73b0\u5c0f\u5199\u7684 26 \u4e2a\u82f1\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u8fde\u5b57\u7b26(-), \u4efb\u4f55\u5176\u5b83\u5b57\u7b26\u90fd\u4e25\u7981\u51fa\u73b0 id \u548c class \u5c3d\u91cf\u7528\u82f1\u6587\u5355\u8bcd\u547d\u540d \u5728\u4e0d\u5f71\u54cd\u8bed\u4e49\u7684\u60c5\u51b5\u4e0b, id \u548c class \u540d\u79f0\u4e2d\u53ef\u4ee5\u9002\u5f53\u91c7\u7528\u82f1\u6587\u5355\u8bcd\u7f29\u5199, \u6bd4\u5982 col , nav , hd , bd , ft \u7b49, \u4f46\u5207\u5fcc\u81ea\u9020\u7f29\u5199 id \u548c class \u540d\u79f0\u4e2d\u7684\u7b2c\u4e00\u4e2a\u8bcd\u5fc5\u987b\u662f\u5355\u8bcd\u5168\u62fc\u6216\u8bed\u4e49\u975e\u5e38\u6e05\u6670\u7684\u5355\u8bcd\u7f29\u5199, \u6bd4\u5982 present , col","title":"id \u548c class \u547d\u540d\u7ea6\u5b9a"},{"location":"other/#css","text":"","title":"CSS"},{"location":"other/#_8","text":"\u4f7f\u75282\u4e2a\u7a7a\u683c\u7f29\u8fdb . element { position : absolute ; top : 10 px ; left : 10 px ; border-radius : 10 px ; width : 50 px ; height : 50 px ; }","title":"\u7f29\u8fdb"},{"location":"other/#_9","text":"\u6bcf\u4e2a\u5c5e\u6027\u58f0\u660e\u672b\u5c3e\u90fd\u8981\u52a0\u5206\u53f7 . element { width : 20 px ; height : 20 px ; background-color : red ; }","title":"\u5206\u53f7"},{"location":"other/#_10","text":"\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0d\u9700\u8981\u7a7a\u683c\uff1a - \u5c5e\u6027\u540d\u540e - \u591a\u4e2a\u89c4\u5219\u7684\u5206\u9694\u7b26','\u524d - !important '!'\u540e - \u5c5e\u6027\u503c\u4e2d'('\u540e\u548c')'\u524d - \u884c\u672b\u4e0d\u8981\u6709\u591a\u4f59\u7684\u7a7a\u683c \u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u9700\u8981\u7a7a\u683c\uff1a - \u5c5e\u6027\u503c\u524d - \u9009\u62e9\u5668 > , + , ~ \u524d\u540e - { \u524d - !important '!'\u524d - \u5c5e\u6027\u503c\u4e2d\u7684 , \u540e - \u6ce8\u91ca /* \u540e\u548c */ \u524d - \u5c5e\u6027\u5192\u53f7\u540e /* not good */ . element { color : red ! important ; background-color : rgba ( 0 , 0 , 0 , .5 ); } /* good */ . element { color : red !important ; background-color : rgba ( 0 , 0 , 0 , .5 ); } /* not good */ . element , . dialog { ... } /* good */ . element , . dialog { } /* not good */ . element > . dialog { ... } /* good */ . element > . dialog { ... } /* not good */ . element { ... } /* good */ . element { ... }","title":"\u7a7a\u683c"},{"location":"other/#_11","text":"\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0d\u9700\u8981\u6362\u884c\uff1a - { \u524d \u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u9700\u8981\u6362\u884c\uff1a - { \u540e\u548c } \u524d - \u6bcf\u4e2a\u5c5e\u6027\u72ec\u5360\u4e00\u884c - \u591a\u4e2a\u89c4\u5219\u7684\u5206\u9694\u7b26 , \u540e /* not good */ . element { color : red ; background-color : black ;} /* good */ . element { color : red ; background-color : black ; } /* not good */ . element , . dialog { ... } /* good */ . element , . dialog { ... }","title":"\u6362\u884c"},{"location":"other/#_12","text":"\u6ce8\u91ca\u7edf\u4e00\u7528 /* */ \u7f29\u8fdb\u4e0e\u4e0b\u4e00\u884c\u4ee3\u7801\u4fdd\u6301\u4e00\u81f4 \u53ef\u4f4d\u4e8e\u4e00\u4e2a\u4ee3\u7801\u884c\u7684\u672b\u5c3e\uff0c\u4e0e\u4ee3\u7801\u95f4\u9694\u4e00\u4e2a\u7a7a\u683c /* Modal header */ . modal-header { ... } /* * Modal header */ . modal-header { ... } . modal-header { /* 50px */ width : 50 px ; color : red ; /* color red */ }","title":"\u6ce8\u91ca"},{"location":"other/#_13","text":"\u6700\u5916\u5c42\u7edf\u4e00\u4f7f\u7528\u53cc\u5f15\u53f7\uff1b url\u7684\u5185\u5bb9\u8981\u7528\u5f15\u53f7\uff1b \u5c5e\u6027\u9009\u62e9\u5668\u4e2d\u7684\u5c5e\u6027\u503c\u9700\u8981\u5f15\u53f7\u3002 . element : after { content : \"\" ; background-image : url ( \"logo.png\" ); } li [ data-type = \"single\" ] { ... }","title":"\u5f15\u53f7"},{"location":"other/#_14","text":"\u7c7b\u540d\u4f7f\u7528\u5c0f\u5199\u5b57\u6bcd\uff0c\u4ee5\u4e2d\u5212\u7ebf\u5206\u9694 id\u91c7\u7528\u9a7c\u5cf0\u5f0f\u547d\u540d /* class */ . element-content { ... } /* id */ # myDialog { ... }","title":"\u547d\u540d"},{"location":"other/#_15","text":"\u76f8\u5173\u7684\u5c5e\u6027\u58f0\u660e\u6309\u7167\u987a\u5e8f\u505a\u5206\u7ec4\u5904\u7406\uff0c\u7ec4\u4e4b\u95f4\u9700\u8981\u6709\u4e00\u4e2a\u7a7a\u884c\uff0c\u8fd9\u4e2a\u53ef\u9009 \u7531\u5916\u5411\u91cc\u5199\u5c5e\u6027\uff0c\u5148\u662f\u5916\u58f3\u600e\u4e48\u5c5e\u6027\uff0c display \uff0c float \uff0c\u63a5\u7740\u662f\u5b9a\u4f4d\u76f8\u5173\u7684\u5c5e\u6027\uff0c position \u7b49\uff0c\u7136\u540e\u662f\u5f00\u59cb\u63cf\u5916\u8fb9\u8ddd margin \uff0c\u8fb9\u6846\u7c97\u7ec6\u3001\u989c\u8272 border \uff0c\u7136\u540e\u662f\u5185\u8fb9\u8ddd\uff0c\u54e6\uff0c\u5f53\u7136\uff0c\u53ef\u80fd\u6709\u65f6\u5019\u8fd8\u6765\u4e2a\u5706\u89d2\uff0c\u6846\u5b50\u63cf\u5b8c\u4e86\u5c31\u5f00\u59cb\u63cf\u9ad8\u5ea6\u5bbd\u5ea6 width , height \uff0c\u63a5\u7740\u662f\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u5b57\u4f53\u600e\u4e48\u663e\u793a\uff08\u5b57\u4f53\u989c\u8272\uff0c\u5c45\u4e2d\u8fd8\u662f\u5c45\u5de6\u7b49\u7b49\uff09\uff0c\u7136\u540e\u662f\u80cc\u666f\u56fe\u554a\u4e4b\u7c7b\u7684\uff0c\u6700\u540e\u662f\u4e00\u4e9b\u6742\u9879\uff0c\u900f\u660e\u5ea6\uff0c\u9f20\u6807\uff0c\u52a8\u753b\u7b49 . declaration-order { display : block ; float : right ; position : absolute ; top : 0 ; right : 0 ; bottom : 0 ; left : 0 ; z-index : 100 ; border : 1 px solid #e5e5e5 ; border-radius : 3 px ; width : 100 px ; height : 100 px ; font : normal 13 px \"Helvetica Neue\" , sans-serif ; line-height : 1.5 ; text-align : center ; color : #333 ; background-color : #f5f5f5 ; opacity : 1 ; } // \u4e0b\u9762\u662f\u63a8\u8350\u7684\u5c5e\u6027\u7684\u987a\u5e8f [ [ \"display\" , \"visibility\" , \"float\" , \"clear\" , \"overflow\" , \"overflow-x\" , \"overflow-y\" , \"clip\" , \"zoom\" ], [ \"table-layout\" , \"empty-cells\" , \"caption-side\" , \"border-spacing\" , \"border-collapse\" , \"list-style\" , \"list-style-position\" , \"list-style-type\" , \"list-style-image\" ], [ \"-webkit-box-orient\" , \"-webkit-box-direction\" , \"-webkit-box-decoration-break\" , \"-webkit-box-pack\" , \"-webkit-box-align\" , \"-webkit-box-flex\" ], [ \"position\" , \"top\" , \"right\" , \"bottom\" , \"left\" , \"z-index\" ], [ \"margin\" , \"margin-top\" , \"margin-right\" , \"margin-bottom\" , \"margin-left\" , \"-webkit-box-sizing\" , \"-moz-box-sizing\" , \"box-sizing\" , \"border\" , \"border-width\" , \"border-style\" , \"border-color\" , \"border-top\" , \"border-top-width\" , \"border-top-style\" , \"border-top-color\" , \"border-right\" , \"border-right-width\" , \"border-right-style\" , \"border-right-color\" , \"border-bottom\" , \"border-bottom-width\" , \"border-bottom-style\" , \"border-bottom-color\" , \"border-left\" , \"border-left-width\" , \"border-left-style\" , \"border-left-color\" , \"-webkit-border-radius\" , \"-moz-border-radius\" , \"border-radius\" , \"-webkit-border-top-left-radius\" , \"-moz-border-radius-topleft\" , \"border-top-left-radius\" , \"-webkit-border-top-right-radius\" , \"-moz-border-radius-topright\" , \"border-top-right-radius\" , \"-webkit-border-bottom-right-radius\" , \"-moz-border-radius-bottomright\" , \"border-bottom-right-radius\" , \"-webkit-border-bottom-left-radius\" , \"-moz-border-radius-bottomleft\" , \"border-bottom-left-radius\" , \"-webkit-border-image\" , \"-moz-border-image\" , \"-o-border-image\" , \"border-image\" , \"-webkit-border-image-source\" , \"-moz-border-image-source\" , \"-o-border-image-source\" , \"border-image-source\" , \"-webkit-border-image-slice\" , \"-moz-border-image-slice\" , \"-o-border-image-slice\" , \"border-image-slice\" , \"-webkit-border-image-width\" , \"-moz-border-image-width\" , \"-o-border-image-width\" , \"border-image-width\" , \"-webkit-border-image-outset\" , \"-moz-border-image-outset\" , \"-o-border-image-outset\" , \"border-image-outset\" , \"-webkit-border-image-repeat\" , \"-moz-border-image-repeat\" , \"-o-border-image-repeat\" , \"border-image-repeat\" , \"padding\" , \"padding-top\" , \"padding-right\" , \"padding-bottom\" , \"padding-left\" , \"width\" , \"min-width\" , \"max-width\" , \"height\" , \"min-height\" , \"max-height\" ], [ \"font\" , \"font-family\" , \"font-size\" , \"font-weight\" , \"font-style\" , \"font-variant\" , \"font-size-adjust\" , \"font-stretch\" , \"font-effect\" , \"font-emphasize\" , \"font-emphasize-position\" , \"font-emphasize-style\" , \"font-smooth\" , \"line-height\" , \"text-align\" , \"-webkit-text-align-last\" , \"-moz-text-align-last\" , \"-ms-text-align-last\" , \"text-align-last\" , \"vertical-align\" , \"white-space\" , \"text-decoration\" , \"text-emphasis\" , \"text-emphasis-color\" , \"text-emphasis-style\" , \"text-emphasis-position\" , \"text-indent\" , \"-ms-text-justify\" , \"text-justify\" , \"letter-spacing\" , \"word-spacing\" , \"-ms-writing-mode\" , \"text-outline\" , \"text-transform\" , \"text-wrap\" , \"-ms-text-overflow\" , \"text-overflow\" , \"text-overflow-ellipsis\" , \"text-overflow-mode\" , \"-ms-word-wrap\" , \"word-wrap\" , \"-ms-word-break\" , \"word-break\" ], [ \"color\" , \"background\" , \"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader\" , \"background-color\" , \"background-image\" , \"background-repeat\" , \"background-attachment\" , \"background-position\" , \"-ms-background-position-x\" , \"background-position-x\" , \"-ms-background-position-y\" , \"background-position-y\" , \"-webkit-background-clip\" , \"-moz-background-clip\" , \"background-clip\" , \"background-origin\" , \"-webkit-background-size\" , \"-moz-background-size\" , \"-o-background-size\" , \"background-size\" ], [ \"outline\" , \"outline-width\" , \"outline-style\" , \"outline-color\" , \"outline-offset\" , \"opacity\" , \"filter:progid:DXImageTransform.Microsoft.Alpha(Opacity\" , \"-ms-filter:\\\\'progid:DXImageTransform.Microsoft.Alpha\" , \"-ms-interpolation-mode\" , \"-webkit-box-shadow\" , \"-moz-box-shadow\" , \"box-shadow\" , \"filter:progid:DXImageTransform.Microsoft.gradient\" , \"-ms-filter:\\\\'progid:DXImageTransform.Microsoft.gradient\" , \"text-shadow\" ], [ \"-webkit-transition\" , \"-moz-transition\" , \"-ms-transition\" , \"-o-transition\" , \"transition\" , \"-webkit-transition-delay\" , \"-moz-transition-delay\" , \"-ms-transition-delay\" , \"-o-transition-delay\" , \"transition-delay\" , \"-webkit-transition-timing-function\" , \"-moz-transition-timing-function\" , \"-ms-transition-timing-function\" , \"-o-transition-timing-function\" , \"transition-timing-function\" , \"-webkit-transition-duration\" , \"-moz-transition-duration\" , \"-ms-transition-duration\" , \"-o-transition-duration\" , \"transition-duration\" , \"-webkit-transition-property\" , \"-moz-transition-property\" , \"-ms-transition-property\" , \"-o-transition-property\" , \"transition-property\" , \"-webkit-transform\" , \"-moz-transform\" , \"-ms-transform\" , \"-o-transform\" , \"transform\" , \"-webkit-transform-origin\" , \"-moz-transform-origin\" , \"-ms-transform-origin\" , \"-o-transform-origin\" , \"transform-origin\" , \"-webkit-animation\" , \"-moz-animation\" , \"-ms-animation\" , \"-o-animation\" , \"animation\" , \"-webkit-animation-name\" , \"-moz-animation-name\" , \"-ms-animation-name\" , \"-o-animation-name\" , \"animation-name\" , \"-webkit-animation-duration\" , \"-moz-animation-duration\" , \"-ms-animation-duration\" , \"-o-animation-duration\" , \"animation-duration\" , \"-webkit-animation-play-state\" , \"-moz-animation-play-state\" , \"-ms-animation-play-state\" , \"-o-animation-play-state\" , \"animation-play-state\" , \"-webkit-animation-timing-function\" , \"-moz-animation-timing-function\" , \"-ms-animation-timing-function\" , \"-o-animation-timing-function\" , \"animation-timing-function\" , \"-webkit-animation-delay\" , \"-moz-animation-delay\" , \"-ms-animation-delay\" , \"-o-animation-delay\" , \"animation-delay\" , \"-webkit-animation-iteration-count\" , \"-moz-animation-iteration-count\" , \"-ms-animation-iteration-count\" , \"-o-animation-iteration-count\" , \"animation-iteration-count\" , \"-webkit-animation-direction\" , \"-moz-animation-direction\" , \"-ms-animation-direction\" , \"-o-animation-direction\" , \"animation-direction\" ] ]","title":"\u5c5e\u6027\u58f0\u660e\u987a\u5e8f"},{"location":"other/#_16","text":"\u989c\u827216\u8fdb\u5236\u7528\u5c0f\u5199\u5b57\u6bcd\uff1b \u989c\u827216\u8fdb\u5236\u5c3d\u91cf\u7528\u7b80\u5199\u3002 /* not good */ . element { color : #ABCDEF ; background-color : #001122 ; } /* good */ . element { color : #abcdef ; background-color : #012 ; }","title":"\u989c\u8272"},{"location":"other/#_17","text":"\u5c5e\u6027\u7b80\u5199\u9700\u8981\u4f60\u975e\u5e38\u6e05\u695a\u5c5e\u6027\u503c\u7684\u6b63\u786e\u987a\u5e8f\uff0c\u800c\u4e14\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5e76\u4e0d\u9700\u8981\u8bbe\u7f6e\u5c5e\u6027\u7b80\u5199\u4e2d\u5305\u542b\u7684\u6240\u6709\u503c\uff0c\u6240\u4ee5\u5efa\u8bae\u5c3d\u91cf\u5206\u5f00\u58f0\u660e\u4f1a\u66f4\u52a0\u6e05\u6670\uff1b margin \u548c padding \u76f8\u53cd\uff0c\u9700\u8981\u4f7f\u7528\u7b80\u5199\uff1b \u5e38\u89c1\u7684\u5c5e\u6027\u7b80\u5199\u5305\u62ec\uff1a - font - background - transition - animation /* not good */ . element { transition : opacity 1 s linear 2 s ; } /* good */ . element { transition-delay : 2 s ; transition-timing-function : linear ; transition-duration : 1 s ; transition-property : opacity ; }","title":"\u5c5e\u6027\u7b80\u5199"},{"location":"other/#_18","text":"\u5c3d\u91cf\u5c06\u5a92\u4f53\u67e5\u8be2\u7684\u89c4\u5219\u9760\u8fd1\u4e0e\u4ed6\u4eec\u76f8\u5173\u7684\u89c4\u5219\uff0c\u4e0d\u8981\u5c06\u4ed6\u4eec\u4e00\u8d77\u653e\u5230\u4e00\u4e2a\u72ec\u7acb\u7684\u6837\u5f0f\u6587\u4ef6\u4e2d\uff0c\u6216\u8005\u4e22\u5728\u6587\u6863\u7684\u6700\u5e95\u90e8\uff0c\u8fd9\u6837\u505a\u53ea\u4f1a\u8ba9\u5927\u5bb6\u4ee5\u540e\u66f4\u5bb9\u6613\u5fd8\u8bb0\u4ed6\u4eec . element { ... } . element-avatar { ... } @ media ( min-width : 480px ) { . element { ... } . element-avatar { ... } }","title":"\u5a92\u4f53\u67e5\u8be2"},{"location":"other/#_19","text":"\u4e0d\u5141\u8bb8\u6709\u7a7a\u7684\u89c4\u5219\uff1b \u5143\u7d20\u9009\u62e9\u5668\u7528\u5c0f\u5199\u5b57\u6bcd\uff1b \u53bb\u6389\u5c0f\u6570\u70b9\u524d\u9762\u76840\uff1b \u53bb\u6389\u6570\u5b57\u4e2d\u4e0d\u5fc5\u8981\u7684\u5c0f\u6570\u70b9\u548c\u672b\u5c3e\u76840\uff1b \u5c5e\u6027\u503c 0 \u540e\u9762\u4e0d\u8981\u52a0\u5355\u4f4d\uff1b \u540c\u4e2a\u5c5e\u6027\u4e0d\u540c\u524d\u7f00\u7684\u5199\u6cd5\u9700\u8981\u5728\u5782\u76f4\u65b9\u5411\u4fdd\u6301\u5bf9\u9f50\uff0c\u5177\u4f53\u53c2\u7167\u53f3\u8fb9\u7684\u5199\u6cd5\uff1b \u65e0\u524d\u7f00\u7684\u6807\u51c6\u5c5e\u6027\u5e94\u8be5\u5199\u5728\u6709\u524d\u7f00\u7684\u5c5e\u6027\u540e\u9762\uff1b \u4e0d\u8981\u5728\u540c\u4e2a\u89c4\u5219\u91cc\u51fa\u73b0\u91cd\u590d\u7684\u5c5e\u6027\uff0c\u5982\u679c\u91cd\u590d\u7684\u5c5e\u6027\u662f\u8fde\u7eed\u7684\u5219\u6ca1\u5173\u7cfb\uff1b \u4e0d\u8981\u5728\u4e00\u4e2a\u6587\u4ef6\u91cc\u51fa\u73b0\u4e24\u4e2a\u76f8\u540c\u7684\u89c4\u5219\uff1b \u7528 border: 0 ; \u4ee3\u66ff border: none; \uff1b \u9009\u62e9\u5668\u4e0d\u8981\u8d85\u8fc74\u5c42\uff08\u5728scss\u4e2d\u5982\u679c\u8d85\u8fc74\u5c42\u5e94\u8be5\u8003\u8651\u7528\u5d4c\u5957\u7684\u65b9\u5f0f\u6765\u5199\uff09\uff1b \u53d1\u5e03\u7684\u4ee3\u7801\u4e2d\u4e0d\u8981\u6709 @import \uff1b \u5c3d\u91cf\u5c11\u7528'*'\u9009\u62e9\u5668\u3002 /* not good */ . element { } /* not good */ LI { ... } /* good */ li { ... } /* not good */ . element { color : rgba ( 0 , 0 , 0 , 0.5 ); } /* good */ . element { color : rgba ( 0 , 0 , 0 , .5 ); } /* not good */ . element { width : 50.0 px ; } /* good */ . element { width : 50 px ; } /* not good */ . element { width : 0 px ; } /* good */ . element { width : 0 ; } /* not good */ . element { border-radius : 3 px ; -webkit- border-radius : 3 px ; -moz- border-radius : 3 px ; background : linear-gradient ( to bottom , #fff 0 , #eee 100 % ); background : -webkit- linear-gradient ( top , #fff 0 , #eee 100 % ); background : -moz- linear-gradient ( top , #fff 0 , #eee 100 % ); } /* good */ . element { -webkit- border-radius : 3 px ; -moz- border-radius : 3 px ; border-radius : 3 px ; background : -webkit- linear-gradient ( top , #fff 0 , #eee 100 % ); background : -moz- linear-gradient ( top , #fff 0 , #eee 100 % ); background : linear-gradient ( to bottom , #fff 0 , #eee 100 % ); } /* not good */ . element { color : rgb ( 0 , 0 , 0 ); width : 50 px ; color : rgba ( 0 , 0 , 0 , .5 ); } /* good */ . element { color : rgb ( 0 , 0 , 0 ); color : rgba ( 0 , 0 , 0 , .5 ); }","title":"\u6742\u9879"},{"location":"other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/","tags":"[oracle]","text":"\u4e00\u3001\u786c\u4ef6\u8981\u6c42 \u00b6 1\u3001\u5185\u5b58 & swap Minimum: 1 GB of RAM Recommended: 2 GB of RAM or more \u68c0\u67e5\u5185\u5b58\u60c5\u51b5 grep MemTotal /proc/meminfo grep SwapTotal /proc/meminfo 2\u3001\u786c\u76d8 \u7531\u4e8eCentOS\u5b89\u88c5\u540e\u5dee\u4e0d\u591a\u67094~5G\uff0c\u518d\u52a0\u4e0aOracle\u7b49\u7b49\u7684\u5b89\u88c5\uff0c\u6240\u4ee5\u8bf7\u51c6\u5907\u81f3\u5c1110G\u7684\u786c\u76d8\u7a7a\u95f4\u3002 \u68c0\u67e5\u78c1\u76d8\u60c5\u51b5 df -h \u4e8c\u3001\u8f6f\u4ef6 \u00b6 \u7cfb\u7edf\u5e73\u53f0\uff1aCentOS 6.3(x86_64) CentOS-6.3-x86_64-bin-DVD1.iso Oracle\u7248\u672c\uff1aOracle 10g R2 10201_database_linux_x86_64.cpio \u4e09\u3001\u7cfb\u7edf\u5b89\u88c5\u6ce8\u610f \u00b6 \u7cfb\u7edf\u5b89\u88c5\u65f6\u4e00\u5b9a\u8981\u5b89\u88c5\u684c\u9762\u6a21\u5f0f\uff0c\u5426\u5219\u65e0\u6cd5\u5b89\u88c5oracle\uff0c\u53e6\u5916\u8bf7\u52ff\u5f00\u542fSELinux\uff0coracle\u5b98\u65b9\u4e0d\u5efa\u8bae\u4f7f\u7528SELinux\uff0cCentOS \u7684\u9632\u706b\u5899\u4e5f\u8bf7\u6682\u65f6\u5173\u95ed\uff0c\u51cf\u5c11\u5b89\u88c5\u65f6\u7684\u56f0\u6270\u3002\u4e3a\u9632\u6b62Oracle\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e71\u7801\uff0c\u5efa\u8bae\u4f7f\u7528\u82f1\u6587\u4f5c\u4e3a\u7cfb\u7edf\u8bed\u8a00\uff0c\u8fdb\u884cOracle\u7684\u5b89\u88c5\u5de5\u4f5c\u3002 \u672c\u6587\u4e2d\u6240\u63cf\u8ff0\u7684\u7cfb\u7edf\u547d\u4ee4\uff0c\u672a\u7ecf\u7279\u6b8a\u6807\u793a\uff0c\u5747\u4e3a\u201c#\u201d\u4ee3\u8868root\u6743\u9650\uff0c\u201c$\u201d\u4ee3\u8868oracle\u6743\u9650\u3002 \u56db\u3001\u5b89\u88c5Oracle\u524d\u7684\u7cfb\u7edf\u51c6\u5907\u5de5\u4f5c \u00b6 \u9996\u5148\uff0c\u8bf7\u5148\u4ee5root\u8d26\u53f7\u767b\u5165\u4f5c\u4e00\u4e9b\u524d\u7f6e\u8bbe\u5b9a\u4f5c\u4e1a\u3002 1\u3001\u5173\u95ed\u9632\u706b\u5899\u3001\u7981\u7528SELinux setup vi /etc/selinux/config \u4fee\u6539SELINUX=disabled\uff0c\u7136\u540e\u91cd\u542f\u3002 \u5982\u679c\u4e0d\u60f3\u91cd\u542f\u7cfb\u7edf\uff0c\u4f7f\u7528\u547d\u4ee4setenforce 0 2\u3001\u5b89\u88c5\u4f9d\u8d56\u5305 Oracle\u5b98\u65b9\u6587\u6863\u8981\u6c42\u7684\u5b89\u88c5\u5305\uff1a \u67e5\u770bOracle\u76f8\u5173\u5305\u662f\u5426\u5df2\u7ecf\u5b89\u88c5\uff1a \u7528yum\u65b9\u5f0f\u5b89\u88c5\u6240\u9700\u7684\u5305\uff1a yum -y install binutils compat-libstdc++-33 compat-libstdc++-33.i686 elfutils-libelf elfutils-libelf-devel gcc gcc-c++ glibc glibc.i686 glibc-common glibc-devel glibc-devel.i686 glibc-headers ksh libaio libaio.i686 libaio-devel libaio-devel.i686 libgcc libgcc.i686 libstdc++ libstdc++.i686 libstdc++-devel make sysstat \u6700\u540e\u8fd8\u9700\u8981\u5b89\u88c5libXp\u8fd9\u4e2aLibrary\uff0c\u8fd9\u4e2a\u4e00\u5b9a\u8981\u5b89\u88c5\uff0c\u5426\u5219\u5b89\u88c5Oracle\u65f6\u4f1a\u51fa\u73b0java Exception\u3002 yum install libXp 3\u3001\u521b\u5efaOracle\u7528\u6237\u4e0e\u7ec4 \u5728\u8fd9\u91cc\u53ea\u8ba8\u8bba\u5355\u4e3b\u673a\u73af\u5883\uff0c\u4e0d\u8003\u8651RAC\u73af\u5883\u7684\u914d\u7f6e\u3002 \u6267\u884c\u4ee5\u4e0b\u6307\u4ee4\u4ee5\u65b0\u589eoracle\u5b89\u88c5\u65f6\u6240\u9700\u8981\u7684\u4f7f\u7528\u8005\u4e0e\u7fa4\u7ec4\u3002 (1) \u5efa\u7acb\u7fa4\u7ec4oinstall groupadd oinstall (2) \u5efa\u7acb\u7fa4\u7ec4dba groupadd dba (3) \u65b0\u589e\u4f7f\u7528\u8005oracle\u5e76\u5c06\u5176\u52a0\u5165oinstall\u548cdba\u7fa4\u7ec4 useradd -m -g oinstall -G dba oracle (4) \u6d4b\u8bd5oracle\u8d26\u53f7\u662f\u5426\u5efa\u7acb\u5b8c\u6210 id oracle (5) \u5efa\u7acboracle\u7684\u65b0\u5bc6\u7801 passwd oracle (6) \u5efa\u7acboracle\u5b89\u88c5\u76ee\u5f55 mkdir -p /home/app/oracle chown -R oracle:oinstall /home/app/oracle chmod -R 775 /home/app/oracle 4\u3001\u5c06oracle\u4f7f\u7528\u8005\u52a0\u5165\u5230sudo\u7fa4\u7ec4\u4e2d vi /etc/sudoers \u627e\u5230 root ALL =( ALL ) ALL \u8fd9\u884c\uff0c\u5e76\u4e14\u5728\u5e95\u4e0b\u518d\u52a0\u5165 oracle ALL =( ALL ) ALL \u8f93\u5165wq!\uff08\u7531\u4e8e\u8fd9\u662f\u4e00\u4efd\u53ea\u8bfb\u6587\u6863\u6240\u4ee5\u9700\u8981\u518d\u52a0\u4e0a!\uff09\u5e76\u4e14\u6309\u4e0bEnter 5\u3001\u914d\u7f6e\u7cfb\u7edf\u5185\u6838\u53c2\u6570 vi /etc/sysctl.conf \u4fee\u6539\u548c\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a kernel.shmall = 4294967296 //\u8868\u793a\u7cfb\u7edf\u4e00\u6b21\u53ef\u4ee5\u4f7f\u7528\u7684\u5171\u4eab\u5185\u5b58\u603b\u91cf\uff08\u4ee5\u9875\u4e3a\u5355\u4f4d\uff09\u3002\u7f3a\u7701\u503c\u5c31\u662f2097152\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4fee\u6539 kernel.shmmax = 68719476736 //\u5b9a\u4e49\u4e86\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u6700\u5927\u5c3a\u5bf8\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\u3002\u7f3a\u7701\u4e3a32M\uff0c\u5bf9\u4e8eoracle\u6765\u8bf4\uff0c\u8be5\u7f3a\u7701\u503c\u592a\u4f4e\u4e86\uff0c\u901a\u5e38\u5c06\u5176\u8bbe\u7f6e\u4e3a2G kernel.shmmni = 4096 //\u7528\u4e8e\u8bbe\u7f6e\u7cfb\u7edf\u8303\u56f4\u5185\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u6700\u5927\u6570\u91cf\u3002\u8be5\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u662f 4096 \u3002\u901a\u5e38\u4e0d\u9700\u8981\u66f4\u6539 kernel.sem = 250 32000 100 128 //\u8868\u793a\u8bbe\u7f6e\u7684\u4fe1\u53f7\u91cf net.ipv4.ip_local_port_range = 1024 65000 net.core.rmem_default = 4194304 //\u9ed8\u8ba4\u7684\u63a5\u6536\u7a97\u53e3\u5927\u5c0f net.core.rmem_max = 4194304 //\u63a5\u6536\u7a97\u53e3\u7684\u6700\u5927\u5927\u5c0f net.core.wmem_default = 262144 //\u9ed8\u8ba4\u7684\u53d1\u9001\u7a97\u53e3\u5927\u5c0f net.core.wmem_max = 262144 //\u53d1\u9001\u7a97\u53e3\u7684\u6700\u5927\u5927\u5c0f \u4f1a\u6709\u4e00\u4e9b\u4e0e\u76ee\u524d\u7684\u53c2\u6570\u91cd\u590d\u7684\uff0c\u5c31\u4fee\u6539\u6210\u6587\u4ef6\u4e0a\u63d0\u4f9b\u7684\u3002 \u7f16\u8f91\u5b8c\u4e4b\u540e\uff0c\u50a8\u5b58\uff0c\u7136\u540e\u6267\u884c\uff1a sysctl \u2013p \u542f\u7528\u521a\u521a\u6240\u505a\u7684\u53d8\u66f4\u3002 6\u3001\u7f16\u8f91/etc/security/limits.conf vi /etc/security/limits.conf \u6dfb\u52a0\u4ee5\u4e0b\u56db\u884c oracle soft nproc 2047 oracle hard nproc 16384 oracle soft nofile 1024 oracle hard nofile 65536 7\u3001\u7f16\u8f91/etc/pam.d/login vi /etc/pam.d/login \u6dfb\u52a0\u4ee5\u4e0b\u4e24\u884c session required /lib64/security/pam_limits.so session required pam_limits.so 8\u3001\u4fee\u6539/etc/profile vi /etc/profile \u5c06\u4ee5\u4e0b\u4ee3\u7801\u65b0\u589e\u5230profile\u6863\u6848\u4e2d\u3002 if [ $USER = \"oracle\" ] ; then if [ $SHELL = \"/bin/ksh\" ] ; then ulimit -p 16384 ulimit -n 65536 else ulimit -u 16384 -n 65536 fi fi 9\u3001\u4fee\u6539Linux\u53d1\u884c\u7248\u672c\u4fe1\u606f \u7531\u4e8eOracle 10g\u53d1\u884c\u7684\u65f6\u5019\uff0cCentOS 6\u6ca1\u6709\u53d1\u884c\uff0c\u6240\u4ee5Oracle 10g\u5e76\u6ca1\u6709\u5bf9CentOS 6\u786e\u8ba4\u652f\u6301\uff0c\u9700\u8981\u4fee\u6539\u6587\u4ef6\u8ba9Oracle 10g\u652f\u6301CentOS 6\u3002 \u6211\u4eec\u9700\u8981\u624b\u5de5\u4fee\u6539Linux\u7684\u53d1\u884c\u6ce8\u8bb0\uff0c\u8ba9Oracle 10g\u652f\u6301CentOS 6\u3002 \u7f16\u8f91/etc/redhat-release\u6587\u4ef6 vi /etc/redhat-release \u5c06\u5176\u4e2d\u7684\u5185\u5bb9CentOS release 6.3 (Final)\u4fee\u6539\u4e3aredhat 4 10\u3001\u521b\u5efaOracle\u5b89\u88c5\u6587\u4ef6\u5939\u4ee5\u53ca\u6570\u636e\u5b58\u653e\u6587\u4ef6\u5939 mkdir /opt/oracle mkdir /opt/oracle/102 chown -R oracle:dba /opt/oracle 11\u3001\u914d\u7f6eLinux\u4e3b\u673a \u68c0\u67e5/etc/hosts\u6587\u4ef6\u4e2d\u662f\u5426\u6709localhost\u7684\u8bb0\u5f55\uff08\u6307\u5411127.0.0.1\u5373\u53ef\uff09\uff0c\u82e5\u6ca1\u6709\u7684\u8bdd\uff0c\u5728\u540e\u9762\u914d\u7f6eOracle\u76d1\u542c\u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\uff0c\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8\u76d1\u542c\uff0c\u5728\u6b64\u624b\u5de5\u6dfb\u52a0\u6b64\u8bb0\u5f55\u5373\u53ef\u3002 \u7b2c\u4e00\u9636\u6bb5\u5230\u6b64\u5b8c\u6bd5\uff0c\u63a5\u4e0b\u6765\uff0c\u5b8c\u6210\u8fd9\u4e9b\u8bbe\u5b9a\u4e4b\u540e\uff0c\u8bf7\u5148\u6ce8\u9500root\u8d26\u53f7\uff0c\u5e76\u4e14\u4ee5oracle\u8d26\u53f7\u518d\u6b21\u767b\u5165\u7cfb\u7edf\u3002 12\u3001\u914d\u7f6eoracle\u7528\u6237\u73af\u5883\u53d8\u91cf cd /home/oracle vi .bash_profile \u4fee\u6539\u5e76\u52a0\u5165\u4ee5\u4e0b\u5167\u5bb9 export ORACLE_BASE = /home/app/oracle export ORACLE_HOME = $ORACLE_BASE /product/10.2.0/db_1 export ORACLE_SID = pltest02 export PATH = .: ${ PATH } : $HOME /bin: $ORACLE_HOME /bin export PATH = ${ PATH } :/usr/bin:/bin:/usr/bin/X11:/usr/local/bin export PATH = ${ PATH } : $ORACLE_BASE /common/oracle/bin export ORACLE_TERM = xterm export TNS_ADMIN = $ORACLE_HOME /network/admin export ORA_NLS10 = $ORACLE_HOME /nls/data export LD_LIBRARY_PATH32 = $ORACLE_HOME /lib32 export LD_LIBRARY_PATH = $ORACLE_HOME /lib export LD_LIBRARY_PATH = ${ LD_LIBRARY_PATH } : $ORACLE_HOME /oracm/lib export LD_LIBRARY_PATH = ${ LD_LIBRARY_PATH } :/lib:/usr/lib:/usr/local/lib export CLASSPATH = $ORACLE_HOME /jre export CLASSPATH = ${ CLASSPATH } : $ORACLE_HOME /jlib export CLASSPATH = ${ CLASSPATH } : $ORACLE_HOME /rdbms/jlib export CLASSPATH = ${ CLASSPATH } : $ORACLE_HOME /network/jlib export THREADS_FLAG = native export TEMP = /tmp export TMPDIR = /tmp export NLS_LANG = AMERICAN_AMERICA.ZHS16GBK \u4fdd\u5b58\u540e\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff0c\u4f7f\u8bbe\u7f6e\u751f\u6548\uff1a source /home/oracle/.bash_profile \u4e94\u3001\u5b89\u88c5Oracle\uff0c\u5e76\u8fdb\u884c\u76f8\u5173\u8bbe\u7f6e \u00b6 1\u3001\u89e3\u538b\u7f29\u5b89\u88c5\u6587\u4ef6 \u5c06\u4e0b\u8f7d\u768410201_database_linux_x86_64.cpio\u653e\u81f3\u5373\u5c06\u5b89\u88c5oracle\u7684\u6587\u4ef6\u5939/opt/oracle \u56de\u5230\u7ec8\u7aef\u6a21\u5f0f\u5e76\u4e14\u8fdb\u5165\u5230oracle\u6587\u4ef6\u5939\uff1a cd /opt/oracle \u89e3\u538b\u7f2910201_database_linux_x86_64.cpio cpio -idmv < 10201_database_linux_x86_64.cpio \u63a5\u7740\u4f1a\u770b\u5230\u4e00\u8fde\u4e32\u7684\u89e3\u538b\u7f29\u52a8\u4f5c\u3002 \u89e3\u538b\u7f29\u5b8c\u6210\u4f1a\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u5939\u4e2d\u770b\u5230database\u7684\u6587\u4ef6\u5939\uff0c\u8bf7\u8fdb\u5165\u5230database\u6587\u4ef6\u5939\u4e2d\uff1a cd database \u51c6\u5907\u6267\u884c\u6570\u636e\u5e93\u5b89\u88c5\uff0c\u5982\u679c\u4f60\u7684centos\u662f\u4e2d\u6587\u73af\u5883\uff0c\u5b89\u88c5\u65f6\u4f1a\u51fa\u73b0\u4e2d\u6587\u4e71\u7801\uff0c\u8bf7\u4e0b\u4ee5\u4e0b\u6307\u4ee4 export LANG = en_US \u63a5\u7740\u6267\u884c ./runInstaller \u5982\u679c\u65e0\u6cd5\u770b\u5230\u5b89\u88c5\u754c\u9762\uff0c\u8bf7\u4f7f\u7528root\u5e10\u6237\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u540e\u518d\u8fd0\u884c\u5b89\u88c5\u7a0b\u5e8f\uff1a export DISPLAY = :0.0 xhost + ./runInstaller \u9047\u5230\u9519\u8bef\uff1aException in ...... /lib/i386/libawt.so: libXp.so.6: cannot open shared object file: No such file or directory \u89e3\u51b3\uff1a yum -y install libXp.i686 \u5206\u6790\uff1a\u770b\u62a5\u9519\u4fe1\u606f\"/lib/i386/libawt.so: libXp.so.6: cannot open shared object file: No such file or directory\"\uff0clibXp\u9700\u8981\u5b89\u88c5i386\u7684\u5305\uff0c\u800c\u4e0d\u80fd\u5b89\u88c5X64\u7684\u5305\u3002\u4e0a\u9762\u8ba4\u4e3a64\u4f4d\u7684linux\u9700\u8981\u5b89\u88c564\u4f4d\u7684libXp\u5305\uff0c\u6240\u4ee5\u5bfc\u81f4\u8fd9\u4e2a\u95ee\u9898\u3002 \u518d\u6b21\u6267\u884c $ ./runInstaller \u9047\u5230\u9519\u8bef\uff1aException in ...... /lib/i386/libawt.so: libXt.so.6: cannot open shared object file: No such file or directory \u89e3\u51b3\uff1a yum -y install libXt.i686 \u518d\u6b21\u6267\u884c $ ./runInstaller \u9047\u5230\u9519\u8bef\uff1aException in ...... /lib/i386/libawt.so: libXtst.so.6: cannot open shared object file: No such file or directory \u89e3\u51b3\uff1a yum -y install libXtst.i686 \u518d\u6b21\u6267\u884c $ ./runInstaller \u5f00\u59cb\u6267\u884c\u5b89\u88c5\u7a0b\u5e8f\u3002 \u7531\u4e8e\u76f8\u5173\u7684\u524d\u7f6e\u4f5c\u4e1a\u5df2\u7ecf\u5728\u4e4b\u524d\u505a\u597d\u4e86\uff0c\u5728\u8fd9\u4e2a\u6b65\u9aa4\u53ea\u9700\u8981\u5c06UNIX DBA Group\u9009\u62e9\u4e3adba\u4ee5\u53ca\u8f93\u5165SYS, SYSTEM\u7b49\u8d26\u53f7\u5171\u4eab\u7684database Password\u5373\u53ef\u3002\u7136\u540e\u9009\u62e9Next\u5373\u53ef\u3002 \u540c\u6837\u7684\uff0c\u5c06\u7fa4\u7ec4\u9009\u62e9\u4e3adba\u7fa4\u7ec4\uff0c\u6309Next \u5728\u8fd9\u4e2a\u6b65\u9aa4\u4e2d\uff0c\u8bf7\u70b9\u9009Checking Network Configuration requirements\u4e3aUser Verified\uff0c\u63a5\u7740\u6309\u4e0bNext \u6700\u540e\u51fa\u73b0Install Summary\u753b\u9762\uff0c\u6b64\u65f6\u53ea\u8981\u6309\u4e0bInstall\u6309\u94ae\uff0c\u7cfb\u7edf\u5373\u5f00\u59cb\u5b89\u88c5\u3002 \u5b89\u88c5\u8fc7\u7a0b... \u5b89\u88c5\u8fdb\u5ea6\u5927\u7ea6\u523065%\u65f6\u4f1a\u6709\u9519\u8bef\u63d0\u793a\uff1a Error in invoking target 'collector' of makefile '/opt/oracle/102/sysman/lib/ins_emdb.mk'. \u540c\u65f6oraInventory/logs/\u76ee\u5f55\u4e0b\u7684\u5b89\u88c5\u65e5\u5fd7\u6587\u4ef6\u91cc\u9762\u4f1a\u6709\u5982\u4e0b\u7c7b\u4f3c\u9519\u8bef\u63d0\u793a\uff1a \u8fd9\u662foracle\u5b89\u88c5\u7a0b\u5e8f\u7684\u4e00\u4e2abug\uff0c\u53ef\u4ee5\u5ffd\u7565\u6b64\u9519\u8bef\u7ee7\u7eed\u5b89\u88c5\uff0c\u5bf9\u7cfb\u7edf\u6ca1\u4ec0\u4e48\u5f71\u54cd\u3002 \u5728Configuration Assistants \u65f6\u4f1a\u51fa\u73b0\u9519\u8bef\u63d0\u793a\uff1a OUI-25031:Some of the configuration assistants failed. \u5206\u6790\uff1a\u4e3b\u673a\u540d\u6620\u5c04\u9519\u8bef \u89e3\u51b3\uff1a\u4fee\u6539/etc/hosts\u6587\u4ef6\uff0c\u589e\u52a0IP\u5730\u5740\u4e0e\u4e3b\u673a\u540d\u7684\u6620\u5c04\u5982\u4e0b\uff1a \u63a5\u7740\u4f1a\u9047\u5230\u9519\u8bef\u63d0\u793a\uff1a ORA-27125:unable to create shared memory segment \u89e3\u51b3\uff1a 1. \u786e\u5b9a\u5b89\u88c5oracle\u6240\u4f7f\u7528\u7684\u7528\u6237\u7ec4 id oracle \u53ef\u4ee5\u770b\u5230oracle\u7ec4dba id \u4e3a501\u3002 2. \u4fee\u6539\u5185\u6838\u53c2\u6570 echo \"501\" >/proc/sys/vm/hugetlb_shm_group \u5c31\u53ef\u4ee5\u4e86\u3002 \u5b89\u88c5\u5230\u6570\u636e\u5e93\u8bbe\u7f6e\u52a9\u7406\uff0c\u53ef\u4ee5\u5728\u8fd9\u8fb9\u9009\u53d6password management\u4f5c\u5bc6\u7801\u7684\u4fee\u6539\uff0c\u5982\u4e0d\u9700\u8981\u4fee\u6539\uff0c\u53ea\u9700\u8981\u6309\u4e0bok\u6309\u94ae\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\u524d\uff0c\u51fa\u73b0\u4ee5\u4e0b\u7684\u8bbe\u7f6e\u811a\u672c\uff1a \u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0csu\u5230root\u3002 \u5c06\u8981\u6c42\u6267\u884c\u7684\u4e24\u6bb5script\u4f9d\u5e8f\u6267\u884c\u3002 /opt/oracle/oraInventory/orainstRoot.sh /opt/oracle/102/root.sh \u6267\u884c\u753b\u9762\u5982\u4e0a\u56fe\u3002 \u6267\u884c\u5b8c\u540e\uff0c\u56de\u5230\u5b89\u88c5\u7a97\u53e3\u6309\u4e0bOK\u5b8c\u6210\u6240\u6709\u7684oracle\u5b89\u88c5\u3002\u5b89\u88c5\u5b8c\u6210\u4f1a\u51fa\u73b0\u4ee5\u4e0b\u753b\u9762\u3002\u5b89\u88c5 \u6b64\u65f6\uff0c\u60a8\u53ef\u4ee5\u4ee5\u4e0a\u8ff0\u7f51\u5740\uff0c\u4f5c\u4e3a\u6d4b\u8bd5\uff0c\u767b\u5165\u8d26\u53f7\u53ef\u4ee5\u4e3asys\u6216system http://CentOS-Oracle:5560/isqlplus http://CentOS-Oracle:5560/isqlplus/dba http://CentOS-Oracle:1158/em \u4ee5\u4e0a\u753b\u9762\u90fd\u6210\u529f\u4ee3\u8868oracle\u5df2\u7ecf\u6b63\u5e38\u5b89\u88c5\u4e86\u3002","title":"\"CentOS6.4\u5b89\u88c5oracle 10g\u6559\u7a0b\""},{"location":"other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/#_1","text":"1\u3001\u5185\u5b58 & swap Minimum: 1 GB of RAM Recommended: 2 GB of RAM or more \u68c0\u67e5\u5185\u5b58\u60c5\u51b5 grep MemTotal /proc/meminfo grep SwapTotal /proc/meminfo 2\u3001\u786c\u76d8 \u7531\u4e8eCentOS\u5b89\u88c5\u540e\u5dee\u4e0d\u591a\u67094~5G\uff0c\u518d\u52a0\u4e0aOracle\u7b49\u7b49\u7684\u5b89\u88c5\uff0c\u6240\u4ee5\u8bf7\u51c6\u5907\u81f3\u5c1110G\u7684\u786c\u76d8\u7a7a\u95f4\u3002 \u68c0\u67e5\u78c1\u76d8\u60c5\u51b5 df -h","title":"\u4e00\u3001\u786c\u4ef6\u8981\u6c42"},{"location":"other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/#_2","text":"\u7cfb\u7edf\u5e73\u53f0\uff1aCentOS 6.3(x86_64) CentOS-6.3-x86_64-bin-DVD1.iso Oracle\u7248\u672c\uff1aOracle 10g R2 10201_database_linux_x86_64.cpio","title":"\u4e8c\u3001\u8f6f\u4ef6"},{"location":"other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/#_3","text":"\u7cfb\u7edf\u5b89\u88c5\u65f6\u4e00\u5b9a\u8981\u5b89\u88c5\u684c\u9762\u6a21\u5f0f\uff0c\u5426\u5219\u65e0\u6cd5\u5b89\u88c5oracle\uff0c\u53e6\u5916\u8bf7\u52ff\u5f00\u542fSELinux\uff0coracle\u5b98\u65b9\u4e0d\u5efa\u8bae\u4f7f\u7528SELinux\uff0cCentOS \u7684\u9632\u706b\u5899\u4e5f\u8bf7\u6682\u65f6\u5173\u95ed\uff0c\u51cf\u5c11\u5b89\u88c5\u65f6\u7684\u56f0\u6270\u3002\u4e3a\u9632\u6b62Oracle\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e71\u7801\uff0c\u5efa\u8bae\u4f7f\u7528\u82f1\u6587\u4f5c\u4e3a\u7cfb\u7edf\u8bed\u8a00\uff0c\u8fdb\u884cOracle\u7684\u5b89\u88c5\u5de5\u4f5c\u3002 \u672c\u6587\u4e2d\u6240\u63cf\u8ff0\u7684\u7cfb\u7edf\u547d\u4ee4\uff0c\u672a\u7ecf\u7279\u6b8a\u6807\u793a\uff0c\u5747\u4e3a\u201c#\u201d\u4ee3\u8868root\u6743\u9650\uff0c\u201c$\u201d\u4ee3\u8868oracle\u6743\u9650\u3002","title":"\u4e09\u3001\u7cfb\u7edf\u5b89\u88c5\u6ce8\u610f"},{"location":"other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/#oracle","text":"\u9996\u5148\uff0c\u8bf7\u5148\u4ee5root\u8d26\u53f7\u767b\u5165\u4f5c\u4e00\u4e9b\u524d\u7f6e\u8bbe\u5b9a\u4f5c\u4e1a\u3002 1\u3001\u5173\u95ed\u9632\u706b\u5899\u3001\u7981\u7528SELinux setup vi /etc/selinux/config \u4fee\u6539SELINUX=disabled\uff0c\u7136\u540e\u91cd\u542f\u3002 \u5982\u679c\u4e0d\u60f3\u91cd\u542f\u7cfb\u7edf\uff0c\u4f7f\u7528\u547d\u4ee4setenforce 0 2\u3001\u5b89\u88c5\u4f9d\u8d56\u5305 Oracle\u5b98\u65b9\u6587\u6863\u8981\u6c42\u7684\u5b89\u88c5\u5305\uff1a \u67e5\u770bOracle\u76f8\u5173\u5305\u662f\u5426\u5df2\u7ecf\u5b89\u88c5\uff1a \u7528yum\u65b9\u5f0f\u5b89\u88c5\u6240\u9700\u7684\u5305\uff1a yum -y install binutils compat-libstdc++-33 compat-libstdc++-33.i686 elfutils-libelf elfutils-libelf-devel gcc gcc-c++ glibc glibc.i686 glibc-common glibc-devel glibc-devel.i686 glibc-headers ksh libaio libaio.i686 libaio-devel libaio-devel.i686 libgcc libgcc.i686 libstdc++ libstdc++.i686 libstdc++-devel make sysstat \u6700\u540e\u8fd8\u9700\u8981\u5b89\u88c5libXp\u8fd9\u4e2aLibrary\uff0c\u8fd9\u4e2a\u4e00\u5b9a\u8981\u5b89\u88c5\uff0c\u5426\u5219\u5b89\u88c5Oracle\u65f6\u4f1a\u51fa\u73b0java Exception\u3002 yum install libXp 3\u3001\u521b\u5efaOracle\u7528\u6237\u4e0e\u7ec4 \u5728\u8fd9\u91cc\u53ea\u8ba8\u8bba\u5355\u4e3b\u673a\u73af\u5883\uff0c\u4e0d\u8003\u8651RAC\u73af\u5883\u7684\u914d\u7f6e\u3002 \u6267\u884c\u4ee5\u4e0b\u6307\u4ee4\u4ee5\u65b0\u589eoracle\u5b89\u88c5\u65f6\u6240\u9700\u8981\u7684\u4f7f\u7528\u8005\u4e0e\u7fa4\u7ec4\u3002 (1) \u5efa\u7acb\u7fa4\u7ec4oinstall groupadd oinstall (2) \u5efa\u7acb\u7fa4\u7ec4dba groupadd dba (3) \u65b0\u589e\u4f7f\u7528\u8005oracle\u5e76\u5c06\u5176\u52a0\u5165oinstall\u548cdba\u7fa4\u7ec4 useradd -m -g oinstall -G dba oracle (4) \u6d4b\u8bd5oracle\u8d26\u53f7\u662f\u5426\u5efa\u7acb\u5b8c\u6210 id oracle (5) \u5efa\u7acboracle\u7684\u65b0\u5bc6\u7801 passwd oracle (6) \u5efa\u7acboracle\u5b89\u88c5\u76ee\u5f55 mkdir -p /home/app/oracle chown -R oracle:oinstall /home/app/oracle chmod -R 775 /home/app/oracle 4\u3001\u5c06oracle\u4f7f\u7528\u8005\u52a0\u5165\u5230sudo\u7fa4\u7ec4\u4e2d vi /etc/sudoers \u627e\u5230 root ALL =( ALL ) ALL \u8fd9\u884c\uff0c\u5e76\u4e14\u5728\u5e95\u4e0b\u518d\u52a0\u5165 oracle ALL =( ALL ) ALL \u8f93\u5165wq!\uff08\u7531\u4e8e\u8fd9\u662f\u4e00\u4efd\u53ea\u8bfb\u6587\u6863\u6240\u4ee5\u9700\u8981\u518d\u52a0\u4e0a!\uff09\u5e76\u4e14\u6309\u4e0bEnter 5\u3001\u914d\u7f6e\u7cfb\u7edf\u5185\u6838\u53c2\u6570 vi /etc/sysctl.conf \u4fee\u6539\u548c\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a kernel.shmall = 4294967296 //\u8868\u793a\u7cfb\u7edf\u4e00\u6b21\u53ef\u4ee5\u4f7f\u7528\u7684\u5171\u4eab\u5185\u5b58\u603b\u91cf\uff08\u4ee5\u9875\u4e3a\u5355\u4f4d\uff09\u3002\u7f3a\u7701\u503c\u5c31\u662f2097152\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u4fee\u6539 kernel.shmmax = 68719476736 //\u5b9a\u4e49\u4e86\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u6700\u5927\u5c3a\u5bf8\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\u3002\u7f3a\u7701\u4e3a32M\uff0c\u5bf9\u4e8eoracle\u6765\u8bf4\uff0c\u8be5\u7f3a\u7701\u503c\u592a\u4f4e\u4e86\uff0c\u901a\u5e38\u5c06\u5176\u8bbe\u7f6e\u4e3a2G kernel.shmmni = 4096 //\u7528\u4e8e\u8bbe\u7f6e\u7cfb\u7edf\u8303\u56f4\u5185\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u6700\u5927\u6570\u91cf\u3002\u8be5\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u662f 4096 \u3002\u901a\u5e38\u4e0d\u9700\u8981\u66f4\u6539 kernel.sem = 250 32000 100 128 //\u8868\u793a\u8bbe\u7f6e\u7684\u4fe1\u53f7\u91cf net.ipv4.ip_local_port_range = 1024 65000 net.core.rmem_default = 4194304 //\u9ed8\u8ba4\u7684\u63a5\u6536\u7a97\u53e3\u5927\u5c0f net.core.rmem_max = 4194304 //\u63a5\u6536\u7a97\u53e3\u7684\u6700\u5927\u5927\u5c0f net.core.wmem_default = 262144 //\u9ed8\u8ba4\u7684\u53d1\u9001\u7a97\u53e3\u5927\u5c0f net.core.wmem_max = 262144 //\u53d1\u9001\u7a97\u53e3\u7684\u6700\u5927\u5927\u5c0f \u4f1a\u6709\u4e00\u4e9b\u4e0e\u76ee\u524d\u7684\u53c2\u6570\u91cd\u590d\u7684\uff0c\u5c31\u4fee\u6539\u6210\u6587\u4ef6\u4e0a\u63d0\u4f9b\u7684\u3002 \u7f16\u8f91\u5b8c\u4e4b\u540e\uff0c\u50a8\u5b58\uff0c\u7136\u540e\u6267\u884c\uff1a sysctl \u2013p \u542f\u7528\u521a\u521a\u6240\u505a\u7684\u53d8\u66f4\u3002 6\u3001\u7f16\u8f91/etc/security/limits.conf vi /etc/security/limits.conf \u6dfb\u52a0\u4ee5\u4e0b\u56db\u884c oracle soft nproc 2047 oracle hard nproc 16384 oracle soft nofile 1024 oracle hard nofile 65536 7\u3001\u7f16\u8f91/etc/pam.d/login vi /etc/pam.d/login \u6dfb\u52a0\u4ee5\u4e0b\u4e24\u884c session required /lib64/security/pam_limits.so session required pam_limits.so 8\u3001\u4fee\u6539/etc/profile vi /etc/profile \u5c06\u4ee5\u4e0b\u4ee3\u7801\u65b0\u589e\u5230profile\u6863\u6848\u4e2d\u3002 if [ $USER = \"oracle\" ] ; then if [ $SHELL = \"/bin/ksh\" ] ; then ulimit -p 16384 ulimit -n 65536 else ulimit -u 16384 -n 65536 fi fi 9\u3001\u4fee\u6539Linux\u53d1\u884c\u7248\u672c\u4fe1\u606f \u7531\u4e8eOracle 10g\u53d1\u884c\u7684\u65f6\u5019\uff0cCentOS 6\u6ca1\u6709\u53d1\u884c\uff0c\u6240\u4ee5Oracle 10g\u5e76\u6ca1\u6709\u5bf9CentOS 6\u786e\u8ba4\u652f\u6301\uff0c\u9700\u8981\u4fee\u6539\u6587\u4ef6\u8ba9Oracle 10g\u652f\u6301CentOS 6\u3002 \u6211\u4eec\u9700\u8981\u624b\u5de5\u4fee\u6539Linux\u7684\u53d1\u884c\u6ce8\u8bb0\uff0c\u8ba9Oracle 10g\u652f\u6301CentOS 6\u3002 \u7f16\u8f91/etc/redhat-release\u6587\u4ef6 vi /etc/redhat-release \u5c06\u5176\u4e2d\u7684\u5185\u5bb9CentOS release 6.3 (Final)\u4fee\u6539\u4e3aredhat 4 10\u3001\u521b\u5efaOracle\u5b89\u88c5\u6587\u4ef6\u5939\u4ee5\u53ca\u6570\u636e\u5b58\u653e\u6587\u4ef6\u5939 mkdir /opt/oracle mkdir /opt/oracle/102 chown -R oracle:dba /opt/oracle 11\u3001\u914d\u7f6eLinux\u4e3b\u673a \u68c0\u67e5/etc/hosts\u6587\u4ef6\u4e2d\u662f\u5426\u6709localhost\u7684\u8bb0\u5f55\uff08\u6307\u5411127.0.0.1\u5373\u53ef\uff09\uff0c\u82e5\u6ca1\u6709\u7684\u8bdd\uff0c\u5728\u540e\u9762\u914d\u7f6eOracle\u76d1\u542c\u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\uff0c\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8\u76d1\u542c\uff0c\u5728\u6b64\u624b\u5de5\u6dfb\u52a0\u6b64\u8bb0\u5f55\u5373\u53ef\u3002 \u7b2c\u4e00\u9636\u6bb5\u5230\u6b64\u5b8c\u6bd5\uff0c\u63a5\u4e0b\u6765\uff0c\u5b8c\u6210\u8fd9\u4e9b\u8bbe\u5b9a\u4e4b\u540e\uff0c\u8bf7\u5148\u6ce8\u9500root\u8d26\u53f7\uff0c\u5e76\u4e14\u4ee5oracle\u8d26\u53f7\u518d\u6b21\u767b\u5165\u7cfb\u7edf\u3002 12\u3001\u914d\u7f6eoracle\u7528\u6237\u73af\u5883\u53d8\u91cf cd /home/oracle vi .bash_profile \u4fee\u6539\u5e76\u52a0\u5165\u4ee5\u4e0b\u5167\u5bb9 export ORACLE_BASE = /home/app/oracle export ORACLE_HOME = $ORACLE_BASE /product/10.2.0/db_1 export ORACLE_SID = pltest02 export PATH = .: ${ PATH } : $HOME /bin: $ORACLE_HOME /bin export PATH = ${ PATH } :/usr/bin:/bin:/usr/bin/X11:/usr/local/bin export PATH = ${ PATH } : $ORACLE_BASE /common/oracle/bin export ORACLE_TERM = xterm export TNS_ADMIN = $ORACLE_HOME /network/admin export ORA_NLS10 = $ORACLE_HOME /nls/data export LD_LIBRARY_PATH32 = $ORACLE_HOME /lib32 export LD_LIBRARY_PATH = $ORACLE_HOME /lib export LD_LIBRARY_PATH = ${ LD_LIBRARY_PATH } : $ORACLE_HOME /oracm/lib export LD_LIBRARY_PATH = ${ LD_LIBRARY_PATH } :/lib:/usr/lib:/usr/local/lib export CLASSPATH = $ORACLE_HOME /jre export CLASSPATH = ${ CLASSPATH } : $ORACLE_HOME /jlib export CLASSPATH = ${ CLASSPATH } : $ORACLE_HOME /rdbms/jlib export CLASSPATH = ${ CLASSPATH } : $ORACLE_HOME /network/jlib export THREADS_FLAG = native export TEMP = /tmp export TMPDIR = /tmp export NLS_LANG = AMERICAN_AMERICA.ZHS16GBK \u4fdd\u5b58\u540e\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff0c\u4f7f\u8bbe\u7f6e\u751f\u6548\uff1a source /home/oracle/.bash_profile","title":"\u56db\u3001\u5b89\u88c5Oracle\u524d\u7684\u7cfb\u7edf\u51c6\u5907\u5de5\u4f5c"},{"location":"other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/#oracle_1","text":"1\u3001\u89e3\u538b\u7f29\u5b89\u88c5\u6587\u4ef6 \u5c06\u4e0b\u8f7d\u768410201_database_linux_x86_64.cpio\u653e\u81f3\u5373\u5c06\u5b89\u88c5oracle\u7684\u6587\u4ef6\u5939/opt/oracle \u56de\u5230\u7ec8\u7aef\u6a21\u5f0f\u5e76\u4e14\u8fdb\u5165\u5230oracle\u6587\u4ef6\u5939\uff1a cd /opt/oracle \u89e3\u538b\u7f2910201_database_linux_x86_64.cpio cpio -idmv < 10201_database_linux_x86_64.cpio \u63a5\u7740\u4f1a\u770b\u5230\u4e00\u8fde\u4e32\u7684\u89e3\u538b\u7f29\u52a8\u4f5c\u3002 \u89e3\u538b\u7f29\u5b8c\u6210\u4f1a\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u5939\u4e2d\u770b\u5230database\u7684\u6587\u4ef6\u5939\uff0c\u8bf7\u8fdb\u5165\u5230database\u6587\u4ef6\u5939\u4e2d\uff1a cd database \u51c6\u5907\u6267\u884c\u6570\u636e\u5e93\u5b89\u88c5\uff0c\u5982\u679c\u4f60\u7684centos\u662f\u4e2d\u6587\u73af\u5883\uff0c\u5b89\u88c5\u65f6\u4f1a\u51fa\u73b0\u4e2d\u6587\u4e71\u7801\uff0c\u8bf7\u4e0b\u4ee5\u4e0b\u6307\u4ee4 export LANG = en_US \u63a5\u7740\u6267\u884c ./runInstaller \u5982\u679c\u65e0\u6cd5\u770b\u5230\u5b89\u88c5\u754c\u9762\uff0c\u8bf7\u4f7f\u7528root\u5e10\u6237\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u540e\u518d\u8fd0\u884c\u5b89\u88c5\u7a0b\u5e8f\uff1a export DISPLAY = :0.0 xhost + ./runInstaller \u9047\u5230\u9519\u8bef\uff1aException in ...... /lib/i386/libawt.so: libXp.so.6: cannot open shared object file: No such file or directory \u89e3\u51b3\uff1a yum -y install libXp.i686 \u5206\u6790\uff1a\u770b\u62a5\u9519\u4fe1\u606f\"/lib/i386/libawt.so: libXp.so.6: cannot open shared object file: No such file or directory\"\uff0clibXp\u9700\u8981\u5b89\u88c5i386\u7684\u5305\uff0c\u800c\u4e0d\u80fd\u5b89\u88c5X64\u7684\u5305\u3002\u4e0a\u9762\u8ba4\u4e3a64\u4f4d\u7684linux\u9700\u8981\u5b89\u88c564\u4f4d\u7684libXp\u5305\uff0c\u6240\u4ee5\u5bfc\u81f4\u8fd9\u4e2a\u95ee\u9898\u3002 \u518d\u6b21\u6267\u884c $ ./runInstaller \u9047\u5230\u9519\u8bef\uff1aException in ...... /lib/i386/libawt.so: libXt.so.6: cannot open shared object file: No such file or directory \u89e3\u51b3\uff1a yum -y install libXt.i686 \u518d\u6b21\u6267\u884c $ ./runInstaller \u9047\u5230\u9519\u8bef\uff1aException in ...... /lib/i386/libawt.so: libXtst.so.6: cannot open shared object file: No such file or directory \u89e3\u51b3\uff1a yum -y install libXtst.i686 \u518d\u6b21\u6267\u884c $ ./runInstaller \u5f00\u59cb\u6267\u884c\u5b89\u88c5\u7a0b\u5e8f\u3002 \u7531\u4e8e\u76f8\u5173\u7684\u524d\u7f6e\u4f5c\u4e1a\u5df2\u7ecf\u5728\u4e4b\u524d\u505a\u597d\u4e86\uff0c\u5728\u8fd9\u4e2a\u6b65\u9aa4\u53ea\u9700\u8981\u5c06UNIX DBA Group\u9009\u62e9\u4e3adba\u4ee5\u53ca\u8f93\u5165SYS, SYSTEM\u7b49\u8d26\u53f7\u5171\u4eab\u7684database Password\u5373\u53ef\u3002\u7136\u540e\u9009\u62e9Next\u5373\u53ef\u3002 \u540c\u6837\u7684\uff0c\u5c06\u7fa4\u7ec4\u9009\u62e9\u4e3adba\u7fa4\u7ec4\uff0c\u6309Next \u5728\u8fd9\u4e2a\u6b65\u9aa4\u4e2d\uff0c\u8bf7\u70b9\u9009Checking Network Configuration requirements\u4e3aUser Verified\uff0c\u63a5\u7740\u6309\u4e0bNext \u6700\u540e\u51fa\u73b0Install Summary\u753b\u9762\uff0c\u6b64\u65f6\u53ea\u8981\u6309\u4e0bInstall\u6309\u94ae\uff0c\u7cfb\u7edf\u5373\u5f00\u59cb\u5b89\u88c5\u3002 \u5b89\u88c5\u8fc7\u7a0b... \u5b89\u88c5\u8fdb\u5ea6\u5927\u7ea6\u523065%\u65f6\u4f1a\u6709\u9519\u8bef\u63d0\u793a\uff1a Error in invoking target 'collector' of makefile '/opt/oracle/102/sysman/lib/ins_emdb.mk'. \u540c\u65f6oraInventory/logs/\u76ee\u5f55\u4e0b\u7684\u5b89\u88c5\u65e5\u5fd7\u6587\u4ef6\u91cc\u9762\u4f1a\u6709\u5982\u4e0b\u7c7b\u4f3c\u9519\u8bef\u63d0\u793a\uff1a \u8fd9\u662foracle\u5b89\u88c5\u7a0b\u5e8f\u7684\u4e00\u4e2abug\uff0c\u53ef\u4ee5\u5ffd\u7565\u6b64\u9519\u8bef\u7ee7\u7eed\u5b89\u88c5\uff0c\u5bf9\u7cfb\u7edf\u6ca1\u4ec0\u4e48\u5f71\u54cd\u3002 \u5728Configuration Assistants \u65f6\u4f1a\u51fa\u73b0\u9519\u8bef\u63d0\u793a\uff1a OUI-25031:Some of the configuration assistants failed. \u5206\u6790\uff1a\u4e3b\u673a\u540d\u6620\u5c04\u9519\u8bef \u89e3\u51b3\uff1a\u4fee\u6539/etc/hosts\u6587\u4ef6\uff0c\u589e\u52a0IP\u5730\u5740\u4e0e\u4e3b\u673a\u540d\u7684\u6620\u5c04\u5982\u4e0b\uff1a \u63a5\u7740\u4f1a\u9047\u5230\u9519\u8bef\u63d0\u793a\uff1a ORA-27125:unable to create shared memory segment \u89e3\u51b3\uff1a 1. \u786e\u5b9a\u5b89\u88c5oracle\u6240\u4f7f\u7528\u7684\u7528\u6237\u7ec4 id oracle \u53ef\u4ee5\u770b\u5230oracle\u7ec4dba id \u4e3a501\u3002 2. \u4fee\u6539\u5185\u6838\u53c2\u6570 echo \"501\" >/proc/sys/vm/hugetlb_shm_group \u5c31\u53ef\u4ee5\u4e86\u3002 \u5b89\u88c5\u5230\u6570\u636e\u5e93\u8bbe\u7f6e\u52a9\u7406\uff0c\u53ef\u4ee5\u5728\u8fd9\u8fb9\u9009\u53d6password management\u4f5c\u5bc6\u7801\u7684\u4fee\u6539\uff0c\u5982\u4e0d\u9700\u8981\u4fee\u6539\uff0c\u53ea\u9700\u8981\u6309\u4e0bok\u6309\u94ae\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\u524d\uff0c\u51fa\u73b0\u4ee5\u4e0b\u7684\u8bbe\u7f6e\u811a\u672c\uff1a \u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0csu\u5230root\u3002 \u5c06\u8981\u6c42\u6267\u884c\u7684\u4e24\u6bb5script\u4f9d\u5e8f\u6267\u884c\u3002 /opt/oracle/oraInventory/orainstRoot.sh /opt/oracle/102/root.sh \u6267\u884c\u753b\u9762\u5982\u4e0a\u56fe\u3002 \u6267\u884c\u5b8c\u540e\uff0c\u56de\u5230\u5b89\u88c5\u7a97\u53e3\u6309\u4e0bOK\u5b8c\u6210\u6240\u6709\u7684oracle\u5b89\u88c5\u3002\u5b89\u88c5\u5b8c\u6210\u4f1a\u51fa\u73b0\u4ee5\u4e0b\u753b\u9762\u3002\u5b89\u88c5 \u6b64\u65f6\uff0c\u60a8\u53ef\u4ee5\u4ee5\u4e0a\u8ff0\u7f51\u5740\uff0c\u4f5c\u4e3a\u6d4b\u8bd5\uff0c\u767b\u5165\u8d26\u53f7\u53ef\u4ee5\u4e3asys\u6216system http://CentOS-Oracle:5560/isqlplus http://CentOS-Oracle:5560/isqlplus/dba http://CentOS-Oracle:1158/em \u4ee5\u4e0a\u753b\u9762\u90fd\u6210\u529f\u4ee3\u8868oracle\u5df2\u7ecf\u6b63\u5e38\u5b89\u88c5\u4e86\u3002","title":"\u4e94\u3001\u5b89\u88c5Oracle\uff0c\u5e76\u8fdb\u884c\u76f8\u5173\u8bbe\u7f6e"},{"location":"other/Converting-7-x-modules-to-8-x/","tags":"[drupal8]","text":"\u672c\u8282\u4e3b\u8981\u4ecb\u7ecd\u5982\u4f55\u628adrupal7\u7684\u6a21\u5757\u8f6c\u5316\u4e3adrupal8\u3002\u53c2\u8003\u8d44\u6599https:// www.drupal.org/update/modules/7/8 \u5148\u4ecb\u7ecd\u4e00\u4e2a\u6a21\u5757drupalmoduleupgrader\uff0c\u4ed6\u4f1a\u5206\u6790drupal7\u7684\u6a21\u5757\uff0c\u5e76\u63d0\u4f9b\u5347\u7ea7\u7684\u6307\u5bfc\u8bf4\u660e\uff0c\u53e6\u5916\u8fd8\u53ef\u4ee5\u76f4\u63a5\u5347\u7ea7\u4e3adrupal8\u3002\u5b89\u88c5\u65b9\u5f0f\u4e5f\u6bd4\u8f83\u7b80\u5355\uff0c\u5982\u4e0b\uff1a drush dl drupalmoduleupgrader cd modules/drupalmoduleupgrader composer install #\u5b89\u88c5\u4f9d\u8d56 drush en drupalmoduleupgrader #\u542f\u7528\u6b64\u6a21\u5757 \u5982\u4f55\u5206\u6790\uff1f \u00b6 cp\u4e00\u4e2adrupal7\u7684\u6a21\u5757\u5230drupal8\u7684modules\u76ee\u5f55\u4e0b\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5206\u6790: drush dmu-analyze hello_world \u4f1a\u91ca\u51fa\u4e00\u4e2aupgrade-info.html\u7684\u6587\u4ef6\uff0c\u975e\u5e38\u8be6\u7ec6\u7684\u6807\u660e\u54ea\u4e9bAPI\u9700\u8981\u4fee\u6539\u3002 \u5982\u4f55\u5347\u7ea7\uff1f \u00b6 \u6267\u884c\u547d\u4ee4 drush dmu-upgrade hello_world \u4f1a\u81ea\u52a8\u91ca\u51fa\u4e00\u4e2adrupal8\u7684\u7248\u672c\u3002 \u8f6c\u6362\u539f\u7406\uff1f \u00b6 \u4f7f\u7528\u4e86pharborist\u505a\u4ee3\u7801\u8f6c\u6362\uff0c\u89c1https://github.com/grom358/pharborist \u600e\u4e48\u6837\uff1f\u7070\u5e38\u7b80\u5355\u5427\uff01","title":"\"Converting 7.x modules to 8.x\""},{"location":"other/Converting-7-x-modules-to-8-x/#_1","text":"cp\u4e00\u4e2adrupal7\u7684\u6a21\u5757\u5230drupal8\u7684modules\u76ee\u5f55\u4e0b\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5206\u6790: drush dmu-analyze hello_world \u4f1a\u91ca\u51fa\u4e00\u4e2aupgrade-info.html\u7684\u6587\u4ef6\uff0c\u975e\u5e38\u8be6\u7ec6\u7684\u6807\u660e\u54ea\u4e9bAPI\u9700\u8981\u4fee\u6539\u3002","title":"\u5982\u4f55\u5206\u6790\uff1f"},{"location":"other/Converting-7-x-modules-to-8-x/#_2","text":"\u6267\u884c\u547d\u4ee4 drush dmu-upgrade hello_world \u4f1a\u81ea\u52a8\u91ca\u51fa\u4e00\u4e2adrupal8\u7684\u7248\u672c\u3002","title":"\u5982\u4f55\u5347\u7ea7\uff1f"},{"location":"other/Converting-7-x-modules-to-8-x/#_3","text":"\u4f7f\u7528\u4e86pharborist\u505a\u4ee3\u7801\u8f6c\u6362\uff0c\u89c1https://github.com/grom358/pharborist \u600e\u4e48\u6837\uff1f\u7070\u5e38\u7b80\u5355\u5427\uff01","title":"\u8f6c\u6362\u539f\u7406\uff1f"},{"location":"other/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/","tags":"[haproxy]","text":"\u4e00\u3001\u5b89\u88c5 \u00b6 yum install haproxy \u4fee\u6539\u65e5\u5fd7 vim /etc/rsyslog.conf \u8fd9\u4e00\u884c #*.info;mail.none;authpriv.none;cron.none /var/log/messages \u6539\u4e3a *.info ; mail.none ; authpriv.none ; cron.none ; local2.none /var/log/messages \u518d\u589e\u52a0\u4e00\u884c # haproxy local2.* /var/log/haproxy.log \u4e8c\u3001haproxy\u914d\u7f6e\u8be6\u89e3 \u00b6 HAProxy\u914d\u7f6e\u4e2d\u5206\u4e94\u5927\u90e8\u5206\uff1a global\uff1a\u5168\u5c40\u914d\u7f6e\u53c2\u6570\uff0c\u8fdb\u7a0b\u7ea7\u7684\uff0c\u7528\u6765\u63a7\u5236Haproxy\u542f\u52a8\u524d\u7684\u4e00\u4e9b\u8fdb\u7a0b\u53ca\u7cfb\u7edf\u8bbe\u7f6e defaults\uff1a\u914d\u7f6e\u4e00\u4e9b\u9ed8\u8ba4\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u88abfrontend\uff0cbackend\uff0clisten\u6bb5\u7ee7\u627f\u4f7f\u7528 frontend\uff1a\u7528\u6765\u5339\u914d\u63a5\u6536\u5ba2\u6237\u6240\u8bf7\u6c42\u7684\u57df\u540d\uff0curi\u7b49\uff0c\u5e76\u9488\u5bf9\u4e0d\u540c\u7684\u5339\u914d\uff0c\u505a\u4e0d\u540c\u7684\u8bf7\u6c42\u5904\u7406 backend\uff1a\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u96c6\u7fa4\uff0c\u4ee5\u53ca\u5bf9\u540e\u7aef\u670d\u52a1\u5668\u7684\u4e00\u4e9b\u6743\u91cd\u3001\u961f\u5217\u3001\u8fde\u63a5\u6570\u7b49\u9009\u9879\u7684\u8bbe\u7f6e\uff0c\u6211\u5c06\u5176\u7406\u89e3\u4e3aNginx\u4e2d\u7684upstream\u5757 listen\uff1afrontend\u548cbackend\u7684\u7ec4\u5408\u4f53 \u914d\u7f6e\u6848\u4f8b\uff1a global # \u5168\u5c40\u53c2\u6570\u7684\u8bbe\u7f6e log 127 .0.0.1 local0 info # log\u8bed\u6cd5\uff1alog [max_level_1] # \u5168\u5c40\u7684\u65e5\u5fd7\u914d\u7f6e\uff0c\u4f7f\u7528log\u5173\u952e\u5b57\uff0c\u6307\u5b9a\u4f7f\u7528127.0.0.1\u4e0a\u7684syslog\u670d\u52a1\u4e2d\u7684local0\u65e5\u5fd7\u8bbe\u5907\uff0c \u8bb0\u5f55\u65e5\u5fd7\u7b49\u7ea7\u4e3ainfo\u7684\u65e5\u5fd7 user haproxy group haproxy # \u8bbe\u7f6e\u8fd0\u884chaproxy\u7684\u7528\u6237\u548c\u7ec4\uff0c\u4e5f\u53ef\u4f7f\u7528uid\uff0cgid\u5173\u952e\u5b57\u66ff\u4ee3\u4e4b daemon # \u4ee5\u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c nbproc 16 # \u8bbe\u7f6ehaproxy\u542f\u52a8\u65f6\u7684\u8fdb\u7a0b\u6570\uff0c\u6839\u636e\u5b98\u65b9\u6587\u6863\u7684\u89e3\u91ca\uff0c\u6211\u5c06\u5176\u7406\u89e3\u4e3a\uff1a\u8be5\u503c\u7684\u8bbe\u7f6e\u5e94\u8be5\u548c\u670d\u52a1 #\u5668\u7684CPU\u6838\u5fc3\u6570\u4e00\u81f4\uff0c\u5373\u5e38\u89c1\u76842\u98978\u6838\u5fc3CPU\u7684\u670d\u52a1\u5668\uff0c\u5373\u5171\u670916\u6838\u5fc3\uff0c\u5219\u53ef\u4ee5\u5c06\u5176\u503c\u8bbe\u7f6e\u4e3a\uff1a #<=16 \uff0c\u521b\u5efa\u591a\u4e2a\u8fdb\u7a0b\u6570\uff0c\u53ef\u4ee5\u51cf\u5c11\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u4efb\u52a1\u961f\u5217\uff0c\u4f46\u662f\u8fc7\u591a\u7684\u8fdb\u7a0b\u6570\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fdb\u7a0b #\u7684\u5d29\u6e83\u3002\u8fd9\u91cc\u6211\u8bbe\u7f6e\u4e3a16 maxconn 4096 # \u5b9a\u4e49\u6bcf\u4e2ahaproxy\u8fdb\u7a0b\u7684\u6700\u5927\u8fde\u63a5\u6570 \uff0c\u7531\u4e8e\u6bcf\u4e2a\u8fde\u63a5\u5305\u62ec\u4e00\u4e2a\u5ba2\u6237\u7aef\u548c\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\uff0c\u6240\u4ee5\u5355 #\u4e2a\u8fdb\u7a0b\u7684TCP\u4f1a\u8bdd\u6700\u5927\u6570\u76ee\u5c06\u662f\u8be5\u503c\u7684\u4e24\u500d\u3002 #ulimit -n 65536 # \u8bbe\u7f6e\u6700\u5927\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\uff0c\u57281.4\u7684\u5b98\u65b9\u6587\u6863\u4e2d\u63d0\u793a\uff0c\u8be5\u503c\u4f1a\u81ea\u52a8\u8ba1\u7b97\uff0c\u6240\u4ee5\u4e0d\u5efa\u8bae\u8fdb\u884c #\u8bbe\u7f6e pidfile /var/run/haproxy.pid # \u5b9a\u4e49haproxy\u7684pid defaults # \u9ed8\u8ba4\u90e8\u5206\u7684\u5b9a\u4e49 mode http # mode\u8bed\u6cd5\uff1amode {http|tcp|health} \u3002http\u662f\u4e03\u5c42\u6a21\u5f0f\uff0ctcp\u662f\u56db\u5c42\u6a21\u5f0f\uff0chealth\u662f\u5065\u5eb7\u68c0\u6d4b #\uff0c\u8fd4\u56deOK log 127 .0.0.1 local2 err # \u4f7f\u7528127.0.0.1\u4e0a\u7684syslog\u670d\u52a1\u7684local3\u8bbe\u5907\u8bb0\u5f55\u9519\u8bef\u4fe1\u606f retries 3 # \u5b9a\u4e49\u8fde\u63a5\u540e\u7aef\u670d\u52a1\u5668\u7684\u5931\u8d25\u91cd\u8fde\u6b21\u6570\uff0c\u8fde\u63a5\u5931\u8d25\u6b21\u6570\u8d85\u8fc7\u6b64\u503c\u540e\u5c06\u4f1a\u5c06\u5bf9\u5e94\u540e\u7aef\u670d\u52a1\u5668\u6807\u8bb0\u4e3a #\u4e0d\u53ef\u7528 option http-server-close # \u6253\u5f00http\u534f\u8bae\u4e2d\u670d\u52a1\u5668\u7aef\u5173\u95ed\u529f\u80fd\uff0c\u4f7f\u5f97\u652f\u6301\u957f\u8fde\u63a5\uff0c\u4f7f\u5f97\u4f1a\u8bdd\u53ef\u4ee5\u88ab\u91cd\u7528\uff0c\u4f7f\u5f97\u6bcf\u4e00\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u90fd\u4f1a\u88ab\u8bb0\u5f55\u3002 option forwardfor except 127 .0.0.0/8 # \u5982\u679c\u4e0a\u6e38\u670d\u52a1\u5668\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u60f3\u8bb0\u5f55\u5ba2\u6237\u7aef\u7684\u771f\u5b9eIP\u5730\u5740\uff0chaproxy\u4f1a\u628a\u5ba2\u6237\u7aef\u7684IP\u4fe1\u606f\u53d1\u9001\u7ed9\u4e0a\u6e38\u670d\u52a1\u5668\uff0c\u5728HTTP\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u201dX-Forwarded-For\u201d\u5b57\u6bb5,\u4f46\u5f53\u662fhaproxy\u81ea\u8eab\u7684\u5065\u5eb7\u68c0\u6d4b\u673a\u5236\u53bb\u8bbf\u95ee\u4e0a\u6e38\u670d\u52a1\u5668\u65f6\u662f\u4e0d\u5e94\u8be5\u628a\u8fd9\u6837\u7684\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\u7684\uff0c\u6240\u4ee5\u7528except\u6765\u6392\u9664127.0.0.0\uff0c\u5373haproxy\u8eab\u3002 option httplog # \u542f\u7528\u65e5\u5fd7\u8bb0\u5f55HTTP\u8bf7\u6c42\uff0c\u9ed8\u8ba4haproxy\u65e5\u5fd7\u8bb0\u5f55\u662f\u4e0d\u8bb0\u5f55HTTP\u8bf7\u6c42\u7684\uff0c\u53ea\u8bb0\u5f55\u201c\u65f6\u95f4[Jan 5 13 #:23:46] \u65e5\u5fd7\u670d\u52a1\u5668[127.0.0.1] \u5b9e\u4f8b\u540d\u5df2\u7ecfpid[haproxy[25218]] \u4fe1\u606f[Proxy http_80_in s #topped.]\u201d\uff0c\u65e5\u5fd7\u683c\u5f0f\u5f88\u7b80\u5355\u3002 option redispatch # \u5f53\u4f7f\u7528\u4e86cookie\u65f6\uff0chaproxy\u5c06\u4f1a\u5c06\u5176\u8bf7\u6c42\u7684\u540e\u7aef\u670d\u52a1\u5668\u7684serverID\u63d2\u5165\u5230cookie\u4e2d\uff0c\u4ee5\u4fdd\u8bc1 #\u4f1a\u8bdd\u7684SESSION\u6301\u4e45\u6027\uff1b\u800c\u6b64\u65f6\uff0c\u5982\u679c\u540e\u7aef\u7684\u670d\u52a1\u5668\u5b95\u6389\u4e86\uff0c\u4f46\u662f\u5ba2\u6237\u7aef\u7684cookie\u662f\u4e0d\u4f1a\u5237\u65b0\u7684 #\uff0c\u5982\u679c\u8bbe\u7f6e\u6b64\u53c2\u6570\uff0c\u5c06\u4f1a\u5c06\u5ba2\u6237\u7684\u8bf7\u6c42\u5f3a\u5236\u5b9a\u5411\u5230\u53e6\u5916\u4e00\u4e2a\u540e\u7aefserver\u4e0a\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7684\u6b63\u5e38 option abortonclose # \u5f53\u670d\u52a1\u5668\u8d1f\u8f7d\u5f88\u9ad8\u7684\u65f6\u5019\uff0c\u81ea\u52a8\u7ed3\u675f\u6389\u5f53\u524d\u961f\u5217\u5904\u7406\u6bd4\u8f83\u4e45\u7684\u94fe\u63a5 option dontlognull # \u542f\u7528\u8be5\u9879\uff0c\u65e5\u5fd7\u4e2d\u5c06\u4e0d\u4f1a\u8bb0\u5f55\u7a7a\u8fde\u63a5\u3002\u6240\u8c13\u7a7a\u8fde\u63a5\u5c31\u662f\u5728\u4e0a\u6e38\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u6216\u8005\u76d1\u63a7\u7cfb\u7edf\u4e3a\u4e86 #\u63a2\u6d4b\u8be5\u670d\u52a1\u662f\u5426\u5b58\u6d3b\u53ef\u7528\u65f6\uff0c\u9700\u8981\u5b9a\u671f\u7684\u8fde\u63a5\u6216\u8005\u83b7\u53d6\u67d0\u4e00\u56fa\u5b9a\u7684\u7ec4\u4ef6\u6216\u9875\u9762\uff0c\u6216\u8005\u63a2\u6d4b\u626b\u63cf #\u7aef\u53e3\u662f\u5426\u5728\u76d1\u542c\u6216\u5f00\u653e\u7b49\u52a8\u4f5c\u88ab\u79f0\u4e3a\u7a7a\u8fde\u63a5\uff1b\u5b98\u65b9\u6587\u6863\u4e2d\u6807\u6ce8\uff0c\u5982\u679c\u8be5\u670d\u52a1\u4e0a\u6e38\u6ca1\u6709\u5176\u4ed6\u7684\u8d1f #\u8f7d\u5747\u8861\u5668\u7684\u8bdd\uff0c\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u56e0\u4e3a\u4e92\u8054\u7f51\u4e0a\u7684\u6076\u610f\u626b\u63cf\u6216\u5176\u4ed6\u52a8\u4f5c\u5c31\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765 option httpclose # \u8fd9\u4e2a\u53c2\u6570\u6211\u662f\u8fd9\u6837\u7406\u89e3\u7684\uff1a\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u6bcf\u5904\u7406\u5b8c\u4e00\u4e2arequest\u65f6\uff0chaproxy\u90fd\u4f1a\u53bb\u68c0\u67e5http\u5934 #\u4e2d\u7684Connection\u7684\u503c\uff0c\u5982\u679c\u8be5\u503c\u4e0d\u662fclose\uff0chaproxy\u5c06\u4f1a\u5c06\u5176***\uff0c\u5982\u679c\u8be5\u503c\u4e3a\u7a7a\u5c06\u4f1a\u6dfb\u52a0\u4e3a\uff1a #Connection: close\u3002\u4f7f\u6bcf\u4e2a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u5728\u5b8c\u6210\u4e00\u6b21\u4f20\u8f93\u540e\u90fd\u4f1a\u4e3b\u52a8\u5173\u95edTCP\u8fde\u63a5\u3002\u4e0e\u8be5 #\u53c2\u6570\u7c7b\u4f3c\u7684\u53e6\u5916\u4e00\u4e2a\u53c2\u6570\u662f\u201coption forceclose\u201d\uff0c\u8be5\u53c2\u6570\u7684\u4f5c\u7528\u662f\u5f3a\u5236\u5173\u95ed\u5bf9\u5916\u7684\u670d\u52a1\u901a\u9053 #\uff0c\u56e0\u4e3a\u6709\u7684\u670d\u52a1\u5668\u7aef\u6536\u5230Connection: close\u65f6\uff0c\u4e5f\u4e0d\u4f1a\u81ea\u52a8\u5173\u95edTCP\u8fde\u63a5\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u4e5f\u4e0d\u5173 #\u95ed\uff0c\u8fde\u63a5\u5c31\u4f1a\u4e00\u76f4\u5904\u4e8e\u6253\u5f00\uff0c\u76f4\u5230\u8d85\u65f6\u3002 timeout http-request 10s # \u5ba2\u6237\u7aef\u53d1\u9001http\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout queue 1m # \u5f53\u4e0a\u6e38\u670d\u52a1\u5668\u5728\u9ad8\u8d1f\u8f7d\u54cd\u5e94haproxy\u65f6\uff0c\u4f1a\u628ahaproxy\u53d1\u9001\u6765\u7684\u8bf7\u6c42\u653e\u8fdb\u4e00\u4e2a\u961f\u5217\u4e2d\uff0ctimeout queue\u5b9a\u4e49\u653e\u5165\u8fd9\u4e2a\u961f\u5217\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout connect 5s # haproxy\u4e0e\u540e\u7aef\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5982\u679c\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u53ef\u8bbe\u7f6e\u8f83\u5c0f\u7684\u65f6\u95f4\u3002 timeout client 1m # \u5b9a\u4e49\u5ba2\u6237\u7aef\u4e0ehaproxy\u8fde\u63a5\u540e\uff0c\u6570\u636e\u4f20\u8f93\u5b8c\u6bd5\uff0c\u4e0d\u518d\u6709\u6570\u636e\u4f20\u8f93\uff0c\u5373\u975e\u6d3b\u52a8\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout server 1m # \u5b9a\u4e49haproxy\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668\u975e\u6d3b\u52a8\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout http-keep-alive 10s # \u8bbe\u7f6e\u65b0\u7684http\u8bf7\u6c42\u8fde\u63a5\u5efa\u7acb\u7684\u6700\u5927\u8d85\u65f6\u65f6\u95f4\uff0c\u65f6\u95f4\u8f83\u77ed\u65f6\u53ef\u4ee5\u5c3d\u5feb\u91ca\u653e\u51fa\u8d44\u6e90\uff0c\u8282\u7ea6\u8d44\u6e90\u3002 timeout check 10s # \u5065\u5eb7\u68c0\u6d4b\u7684\u65f6\u95f4\u7684\u6700\u5927\u8d85\u65f6\u65f6\u95f4\u3002 contimeout 5000 # \u8bbe\u7f6e\u6210\u529f\u8fde\u63a5\u5230\u4e00\u53f0\u670d\u52a1\u5668\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba4\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u65b0\u7248\u672c\u7684haproxy\u4f7f\u7528timeout #connect\u66ff\u4ee3\uff0c\u8be5\u53c2\u6570\u5411\u540e\u517c\u5bb9 clitimeout 3000 # \u8bbe\u7f6e\u8fde\u63a5\u5ba2\u6237\u7aef\u53d1\u9001\u6570\u636e\u65f6\u7684\u6210\u529f\u8fde\u63a5\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba4\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u65b0\u7248\u672chaproxy\u4f7f\u7528 #timeout client\u66ff\u4ee3\u3002\u8be5\u53c2\u6570\u5411\u540e\u517c\u5bb9 srvtimeout 3000 # \u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u56de\u5e94\u5ba2\u6237\u5ea6\u6570\u636e\u53d1\u9001\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba4\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u65b0\u7248\u672chaproxy\u4f7f\u7528 #timeout server\u66ff\u4ee3\u3002\u8be5\u53c2\u6570\u5411\u540e\u517c\u5bb9 listen status # \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3astatus\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u5728listen\u6307\u4ee4\u6307\u5b9a\u7684\u533a\u57df\u4e2d\u5b9a\u4e49\u5339\u914d\u89c4\u5219\u548c\u540e\u7aef\u670d\u52a1\u5668ip\uff0c #\u76f8\u5f53\u4e8e\u9700\u8981\u5728\u5176\u4e2d\u914d\u7f6efrontend\uff0cbackend\u7684\u529f\u80fd\u3002\u4e00\u822c\u505atcp\u8f6c\u53d1\u6bd4\u8f83\u5408\u9002\uff0c\u4e0d\u7528\u592a\u591a\u7684\u89c4\u5219 #\u5339\u914d\u3002 bind 0 .0.0.0:1080 # \u5b9a\u4e49\u76d1\u542c\u7684\u5957\u63a5\u5b57 mode http # \u5b9a\u4e49\u4e3aHTTP\u6a21\u5f0f log global # \u7ee7\u627fglobal\u4e2dlog\u7684\u5b9a\u4e49 stats refresh 30s # stats\u662fhaproxy\u7684\u4e00\u4e2a\u7edf\u8ba1\u9875\u9762\u7684\u5957\u63a5\u5b57\uff0c\u8be5\u53c2\u6570\u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u7684\u5237\u65b0\u95f4\u9694\u4e3a30s stats uri /admin?stats # \u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u7684uri\u4e3a/admin?stats stats realm Private lands # \u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u8ba4\u8bc1\u65f6\u7684\u63d0\u793a\u5185\u5bb9 stats auth admin:password # \u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u8ba4\u8bc1\u7684\u7528\u6237\u548c\u5bc6\u7801\uff0c\u5982\u679c\u8981\u8bbe\u7f6e\u591a\u4e2a\uff0c\u53e6\u8d77\u4e00\u884c\u5199\u5165\u5373\u53ef stats hide-version # \u9690\u85cf\u7edf\u8ba1\u9875\u9762\u4e0a\u7684haproxy\u7248\u672c\u4fe1\u606f frontend http_80_in # \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3ahttp_80_in\u7684\u524d\u7aef\u90e8\u5206\uff0chaproxy\u4f1a\u76d1\u542cbind\u7684\u7aef\u53e3 bind 0 .0.0.0:80 # http_80_in\u5b9a\u4e49\u524d\u7aef\u90e8\u5206\u76d1\u542c\u7684\u5957\u63a5\u5b57 mode http # \u5b9a\u4e49\u4e3aHTTP\u6a21\u5f0f log global # \u7ee7\u627fglobal\u4e2dlog\u7684\u5b9a\u4e49 option forwardfor # \u542f\u7528X-Forwarded-For\uff0c\u5728requests\u5934\u90e8\u63d2\u5165\u5ba2\u6237\u7aefIP\u53d1\u9001\u7ed9\u540e\u7aef\u7684server\uff0c\u4f7f\u540e\u7aefserver\u83b7 #\u53d6\u5230\u5ba2\u6237\u7aef\u7684\u771f\u5b9eIP acl static_down nbsrv ( static_server ) lt 1 # \u5b9a\u4e49\u4e00\u4e2a\u540d\u53ebstatic_down\u7684acl\uff0c\u5f53backend static_sever\u4e2d\u5b58\u6d3b\u673a\u5668\u6570\u5c0f\u4e8e1\u65f6\u4f1a\u88ab\u5339\u914d\u5230 acl php_web url_reg /*.php$ #acl php_web path_end .php # \u5b9a\u4e49\u4e00\u4e2a\u540d\u53ebphp_web\u7684acl\uff0c\u5f53\u8bf7\u6c42\u7684url\u672b\u5c3e\u662f\u4ee5.php\u7ed3\u5c3e\u7684\uff0c\u5c06\u4f1a\u88ab\u5339\u914d\u5230\uff0c\u4e0a\u9762\u4e24\u79cd\u5199 #\u6cd5\u4efb\u9009\u5176\u4e00 acl static_web url_reg /*. ( css | jpg | png | jpeg | js | gif ) $ #acl static_web path_end .gif .png .jpg .css .js .jpeg # \u5b9a\u4e49\u4e00\u4e2a\u540d\u53ebstatic_web\u7684acl\uff0c\u5f53\u8bf7\u6c42\u7684url\u672b\u5c3e\u662f\u4ee5.css\u3001.jpg\u3001.png\u3001.jpeg\u3001.js\u3001.gif #\u7ed3\u5c3e\u7684\uff0c\u5c06\u4f1a\u88ab\u5339\u914d\u5230\uff0c\u4e0a\u9762\u4e24\u79cd\u5199\u6cd5\u4efb\u9009\u5176\u4e00 use_backend php_server if static_down # \u5982\u679c\u6ee1\u8db3\u7b56\u7565static_down\u65f6\uff0c\u5c31\u5c06\u8bf7\u6c42\u4ea4\u4e88backend php_server use_backend php_server if php_web # \u5982\u679c\u6ee1\u8db3\u7b56\u7565php_web\u65f6\uff0c\u5c31\u5c06\u8bf7\u6c42\u4ea4\u4e88backend php_server use_backend static_server if static_web # \u5982\u679c\u6ee1\u8db3\u7b56\u7565static_web\u65f6\uff0c\u5c31\u5c06\u8bf7\u6c42\u4ea4\u4e88backend static_server default_backend defaultbackserver #\u5982\u679cacl\u5168\u90e8\u4e0d\u6ee1\u8db3\uff0c\u542f\u7528\u9ed8\u8ba4\u540e\u7aef\u7684\u5730\u5740\u6c60 backend php_server #\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3aphp_server\u7684\u540e\u7aef\u90e8\u5206\uff0cfrontend\u5b9a\u4e49\u7684\u8bf7\u6c42\u4f1a\u5230\u5230\u8fd9\u91cc\u5904\u7406 mode http # \u8bbe\u7f6e\u4e3ahttp\u6a21\u5f0f balance source # \u8bbe\u7f6ehaproxy\u7684\u8c03\u5ea6\u7b97\u6cd5\u4e3a\u6e90\u5730\u5740hash cookie SERVERID # \u5141\u8bb8\u5411cookie\u63d2\u5165SERVERID\uff0c\u6bcf\u53f0\u670d\u52a1\u5668\u7684SERVERID\u53ef\u5728\u4e0b\u9762\u4f7f\u7528cookie\u5173\u952e\u5b57\u5b9a\u4e49 option httpchk GET /test/index.php # \u5f00\u542f\u5bf9\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u6d4b\uff0c\u901a\u8fc7GET /test/index.php\u6765\u5224\u65ad\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u60c5\u51b5 server php_server_1 10 .12.25.68:80 cookie 1 check inter 2000 rise 3 fall 3 weight 2 server php_server_2 10 .12.25.72:80 cookie 2 check inter 2000 rise 3 fall 3 weight 1 server php_server_bak 10 .12.25.79:80 cookie 3 check inter 1500 rise 3 fall 3 backup # server\u8bed\u6cd5\uff1aserver [:port] [param*] # \u4f7f\u7528server\u5173\u952e\u5b57\u6765\u8bbe\u7f6e\u540e\u7aef\u670d\u52a1\u5668\uff1b\u4e3a\u540e\u7aef\u670d\u52a1\u5668\u6240\u8bbe\u7f6e\u7684\u5185\u90e8\u540d\u79f0[php_server_1]\uff0c\u8be5\u540d #\u79f0\u5c06\u4f1a\u5448\u73b0\u5728\u65e5\u5fd7\u6216\u8b66\u62a5\u4e2d\u3001\u540e\u7aef\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff0c\u652f\u6301\u7aef\u53e3\u6620\u5c04[10.12.25.68:80]\u3001\u6307\u5b9a\u8be5 #\u670d\u52a1\u5668\u7684SERVERID\u4e3a1[cookie 1]\u3001\u63a5\u53d7\u5065\u5eb7\u76d1\u6d4b[check]\u3001\u76d1\u6d4b\u7684\u95f4\u9694\u65f6\u957f\uff0c\u5355\u4f4d\u6beb\u79d2[inter #2000]\u3001\u76d1\u6d4b\u6b63\u5e38\u591a\u5c11\u6b21\u540e\u88ab\u8ba4\u4e3a\u540e\u7aef\u670d\u52a1\u5668\u662f\u53ef\u7528\u7684[rise 3]\u3001\u76d1\u6d4b\u5931\u8d25\u591a\u5c11\u6b21\u540e\u88ab\u8ba4\u4e3a\u540e\u7aef #\u670d\u52a1\u5668\u662f\u4e0d\u53ef\u7528\u7684[fall 3]\u3001\u5206\u53d1\u7684\u6743\u91cd[weight 2]\u3001\u6700\u4e3a\u5907\u4efd\u7528\u7684\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5f53\u6b63\u5e38\u7684\u670d #\u52a1\u5668\u5168\u90e8\u90fd\u5b95\u673a\u540e\uff0c\u624d\u4f1a\u542f\u7528\u5907\u4efd\u670d\u52a1\u5668[backup] backend static_server mode http option httpchk GET /test/index.html server static_server_1 10 .12.25.83:80 cookie 3 check inter 2000 rise 3 fall 3 \u5b98\u65b9\u914d\u7f6e\uff1a http://haproxy.1wt.eu/download/1.4/doc/configuration.txt \u4e09\u3001haproxy\u5b9e\u73b0\u6301\u4e45\u8fde\u63a5 \u00b6 1\u3001\u8c03\u5ea6\u7b97\u6cd5source haroxy \u5c06\u7528\u6237IP\u7ecf\u8fc7hash\u8ba1\u7b97\u540e \u6307\u5b9a\u5230\u56fa\u5b9a\u7684\u771f\u5b9e\u670d\u52a1\u5668\u4e0a\uff08\u7c7b\u4f3c\u4e8enginx \u7684IP hash \u6307\u4ee4\uff09 \u914d\u7f6e\u6307\u4ee4 balance source 2\u3001cookie \u8bc6\u522b haproxy \u5c06WEB\u670d\u52a1\u7aef\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684cookie\u4e2d\u63d2\u5165(\u6216\u6dfb\u52a0\u52a0\u524d\u7f00)haproxy\u5b9a\u4e49\u7684\u540e\u7aef\u7684\u670d\u52a1\u5668COOKIE ID\u3002 \u914d\u7f6e\u6307\u4ee4\u4f8b\u4e3e cookie SESSION_COOKIE insert indirect nocache 3\u3001session \u8bc6\u522b haproxy \u5c06\u540e\u7aef\u670d\u52a1\u5668\u4ea7\u751f\u7684session\u548c\u540e\u7aef\u670d\u52a1\u5668\u6807\u8bc6\u5b58\u5728haproxy\u4e2d\u7684\u4e00\u5f20\u8868\u91cc\u3002\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\u5148\u67e5\u8be2\u8fd9\u5f20\u8868\u3002\u7136\u540e\u6839\u636esession\u5206\u914d\u540e\u7aefserver\u3002 \u914d\u7f6e\u6307\u4ee4\uff1aappsession len timeout","title":"\"Haproxy web\u8d1f\u8f7d\u5747\u8861\""},{"location":"other/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_1","text":"yum install haproxy \u4fee\u6539\u65e5\u5fd7 vim /etc/rsyslog.conf \u8fd9\u4e00\u884c #*.info;mail.none;authpriv.none;cron.none /var/log/messages \u6539\u4e3a *.info ; mail.none ; authpriv.none ; cron.none ; local2.none /var/log/messages \u518d\u589e\u52a0\u4e00\u884c # haproxy local2.* /var/log/haproxy.log","title":"\u4e00\u3001\u5b89\u88c5"},{"location":"other/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#haproxy","text":"HAProxy\u914d\u7f6e\u4e2d\u5206\u4e94\u5927\u90e8\u5206\uff1a global\uff1a\u5168\u5c40\u914d\u7f6e\u53c2\u6570\uff0c\u8fdb\u7a0b\u7ea7\u7684\uff0c\u7528\u6765\u63a7\u5236Haproxy\u542f\u52a8\u524d\u7684\u4e00\u4e9b\u8fdb\u7a0b\u53ca\u7cfb\u7edf\u8bbe\u7f6e defaults\uff1a\u914d\u7f6e\u4e00\u4e9b\u9ed8\u8ba4\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u88abfrontend\uff0cbackend\uff0clisten\u6bb5\u7ee7\u627f\u4f7f\u7528 frontend\uff1a\u7528\u6765\u5339\u914d\u63a5\u6536\u5ba2\u6237\u6240\u8bf7\u6c42\u7684\u57df\u540d\uff0curi\u7b49\uff0c\u5e76\u9488\u5bf9\u4e0d\u540c\u7684\u5339\u914d\uff0c\u505a\u4e0d\u540c\u7684\u8bf7\u6c42\u5904\u7406 backend\uff1a\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u96c6\u7fa4\uff0c\u4ee5\u53ca\u5bf9\u540e\u7aef\u670d\u52a1\u5668\u7684\u4e00\u4e9b\u6743\u91cd\u3001\u961f\u5217\u3001\u8fde\u63a5\u6570\u7b49\u9009\u9879\u7684\u8bbe\u7f6e\uff0c\u6211\u5c06\u5176\u7406\u89e3\u4e3aNginx\u4e2d\u7684upstream\u5757 listen\uff1afrontend\u548cbackend\u7684\u7ec4\u5408\u4f53 \u914d\u7f6e\u6848\u4f8b\uff1a global # \u5168\u5c40\u53c2\u6570\u7684\u8bbe\u7f6e log 127 .0.0.1 local0 info # log\u8bed\u6cd5\uff1alog [max_level_1] # \u5168\u5c40\u7684\u65e5\u5fd7\u914d\u7f6e\uff0c\u4f7f\u7528log\u5173\u952e\u5b57\uff0c\u6307\u5b9a\u4f7f\u7528127.0.0.1\u4e0a\u7684syslog\u670d\u52a1\u4e2d\u7684local0\u65e5\u5fd7\u8bbe\u5907\uff0c \u8bb0\u5f55\u65e5\u5fd7\u7b49\u7ea7\u4e3ainfo\u7684\u65e5\u5fd7 user haproxy group haproxy # \u8bbe\u7f6e\u8fd0\u884chaproxy\u7684\u7528\u6237\u548c\u7ec4\uff0c\u4e5f\u53ef\u4f7f\u7528uid\uff0cgid\u5173\u952e\u5b57\u66ff\u4ee3\u4e4b daemon # \u4ee5\u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c nbproc 16 # \u8bbe\u7f6ehaproxy\u542f\u52a8\u65f6\u7684\u8fdb\u7a0b\u6570\uff0c\u6839\u636e\u5b98\u65b9\u6587\u6863\u7684\u89e3\u91ca\uff0c\u6211\u5c06\u5176\u7406\u89e3\u4e3a\uff1a\u8be5\u503c\u7684\u8bbe\u7f6e\u5e94\u8be5\u548c\u670d\u52a1 #\u5668\u7684CPU\u6838\u5fc3\u6570\u4e00\u81f4\uff0c\u5373\u5e38\u89c1\u76842\u98978\u6838\u5fc3CPU\u7684\u670d\u52a1\u5668\uff0c\u5373\u5171\u670916\u6838\u5fc3\uff0c\u5219\u53ef\u4ee5\u5c06\u5176\u503c\u8bbe\u7f6e\u4e3a\uff1a #<=16 \uff0c\u521b\u5efa\u591a\u4e2a\u8fdb\u7a0b\u6570\uff0c\u53ef\u4ee5\u51cf\u5c11\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u4efb\u52a1\u961f\u5217\uff0c\u4f46\u662f\u8fc7\u591a\u7684\u8fdb\u7a0b\u6570\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fdb\u7a0b #\u7684\u5d29\u6e83\u3002\u8fd9\u91cc\u6211\u8bbe\u7f6e\u4e3a16 maxconn 4096 # \u5b9a\u4e49\u6bcf\u4e2ahaproxy\u8fdb\u7a0b\u7684\u6700\u5927\u8fde\u63a5\u6570 \uff0c\u7531\u4e8e\u6bcf\u4e2a\u8fde\u63a5\u5305\u62ec\u4e00\u4e2a\u5ba2\u6237\u7aef\u548c\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\uff0c\u6240\u4ee5\u5355 #\u4e2a\u8fdb\u7a0b\u7684TCP\u4f1a\u8bdd\u6700\u5927\u6570\u76ee\u5c06\u662f\u8be5\u503c\u7684\u4e24\u500d\u3002 #ulimit -n 65536 # \u8bbe\u7f6e\u6700\u5927\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\uff0c\u57281.4\u7684\u5b98\u65b9\u6587\u6863\u4e2d\u63d0\u793a\uff0c\u8be5\u503c\u4f1a\u81ea\u52a8\u8ba1\u7b97\uff0c\u6240\u4ee5\u4e0d\u5efa\u8bae\u8fdb\u884c #\u8bbe\u7f6e pidfile /var/run/haproxy.pid # \u5b9a\u4e49haproxy\u7684pid defaults # \u9ed8\u8ba4\u90e8\u5206\u7684\u5b9a\u4e49 mode http # mode\u8bed\u6cd5\uff1amode {http|tcp|health} \u3002http\u662f\u4e03\u5c42\u6a21\u5f0f\uff0ctcp\u662f\u56db\u5c42\u6a21\u5f0f\uff0chealth\u662f\u5065\u5eb7\u68c0\u6d4b #\uff0c\u8fd4\u56deOK log 127 .0.0.1 local2 err # \u4f7f\u7528127.0.0.1\u4e0a\u7684syslog\u670d\u52a1\u7684local3\u8bbe\u5907\u8bb0\u5f55\u9519\u8bef\u4fe1\u606f retries 3 # \u5b9a\u4e49\u8fde\u63a5\u540e\u7aef\u670d\u52a1\u5668\u7684\u5931\u8d25\u91cd\u8fde\u6b21\u6570\uff0c\u8fde\u63a5\u5931\u8d25\u6b21\u6570\u8d85\u8fc7\u6b64\u503c\u540e\u5c06\u4f1a\u5c06\u5bf9\u5e94\u540e\u7aef\u670d\u52a1\u5668\u6807\u8bb0\u4e3a #\u4e0d\u53ef\u7528 option http-server-close # \u6253\u5f00http\u534f\u8bae\u4e2d\u670d\u52a1\u5668\u7aef\u5173\u95ed\u529f\u80fd\uff0c\u4f7f\u5f97\u652f\u6301\u957f\u8fde\u63a5\uff0c\u4f7f\u5f97\u4f1a\u8bdd\u53ef\u4ee5\u88ab\u91cd\u7528\uff0c\u4f7f\u5f97\u6bcf\u4e00\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u90fd\u4f1a\u88ab\u8bb0\u5f55\u3002 option forwardfor except 127 .0.0.0/8 # \u5982\u679c\u4e0a\u6e38\u670d\u52a1\u5668\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u60f3\u8bb0\u5f55\u5ba2\u6237\u7aef\u7684\u771f\u5b9eIP\u5730\u5740\uff0chaproxy\u4f1a\u628a\u5ba2\u6237\u7aef\u7684IP\u4fe1\u606f\u53d1\u9001\u7ed9\u4e0a\u6e38\u670d\u52a1\u5668\uff0c\u5728HTTP\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u201dX-Forwarded-For\u201d\u5b57\u6bb5,\u4f46\u5f53\u662fhaproxy\u81ea\u8eab\u7684\u5065\u5eb7\u68c0\u6d4b\u673a\u5236\u53bb\u8bbf\u95ee\u4e0a\u6e38\u670d\u52a1\u5668\u65f6\u662f\u4e0d\u5e94\u8be5\u628a\u8fd9\u6837\u7684\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\u7684\uff0c\u6240\u4ee5\u7528except\u6765\u6392\u9664127.0.0.0\uff0c\u5373haproxy\u8eab\u3002 option httplog # \u542f\u7528\u65e5\u5fd7\u8bb0\u5f55HTTP\u8bf7\u6c42\uff0c\u9ed8\u8ba4haproxy\u65e5\u5fd7\u8bb0\u5f55\u662f\u4e0d\u8bb0\u5f55HTTP\u8bf7\u6c42\u7684\uff0c\u53ea\u8bb0\u5f55\u201c\u65f6\u95f4[Jan 5 13 #:23:46] \u65e5\u5fd7\u670d\u52a1\u5668[127.0.0.1] \u5b9e\u4f8b\u540d\u5df2\u7ecfpid[haproxy[25218]] \u4fe1\u606f[Proxy http_80_in s #topped.]\u201d\uff0c\u65e5\u5fd7\u683c\u5f0f\u5f88\u7b80\u5355\u3002 option redispatch # \u5f53\u4f7f\u7528\u4e86cookie\u65f6\uff0chaproxy\u5c06\u4f1a\u5c06\u5176\u8bf7\u6c42\u7684\u540e\u7aef\u670d\u52a1\u5668\u7684serverID\u63d2\u5165\u5230cookie\u4e2d\uff0c\u4ee5\u4fdd\u8bc1 #\u4f1a\u8bdd\u7684SESSION\u6301\u4e45\u6027\uff1b\u800c\u6b64\u65f6\uff0c\u5982\u679c\u540e\u7aef\u7684\u670d\u52a1\u5668\u5b95\u6389\u4e86\uff0c\u4f46\u662f\u5ba2\u6237\u7aef\u7684cookie\u662f\u4e0d\u4f1a\u5237\u65b0\u7684 #\uff0c\u5982\u679c\u8bbe\u7f6e\u6b64\u53c2\u6570\uff0c\u5c06\u4f1a\u5c06\u5ba2\u6237\u7684\u8bf7\u6c42\u5f3a\u5236\u5b9a\u5411\u5230\u53e6\u5916\u4e00\u4e2a\u540e\u7aefserver\u4e0a\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7684\u6b63\u5e38 option abortonclose # \u5f53\u670d\u52a1\u5668\u8d1f\u8f7d\u5f88\u9ad8\u7684\u65f6\u5019\uff0c\u81ea\u52a8\u7ed3\u675f\u6389\u5f53\u524d\u961f\u5217\u5904\u7406\u6bd4\u8f83\u4e45\u7684\u94fe\u63a5 option dontlognull # \u542f\u7528\u8be5\u9879\uff0c\u65e5\u5fd7\u4e2d\u5c06\u4e0d\u4f1a\u8bb0\u5f55\u7a7a\u8fde\u63a5\u3002\u6240\u8c13\u7a7a\u8fde\u63a5\u5c31\u662f\u5728\u4e0a\u6e38\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u6216\u8005\u76d1\u63a7\u7cfb\u7edf\u4e3a\u4e86 #\u63a2\u6d4b\u8be5\u670d\u52a1\u662f\u5426\u5b58\u6d3b\u53ef\u7528\u65f6\uff0c\u9700\u8981\u5b9a\u671f\u7684\u8fde\u63a5\u6216\u8005\u83b7\u53d6\u67d0\u4e00\u56fa\u5b9a\u7684\u7ec4\u4ef6\u6216\u9875\u9762\uff0c\u6216\u8005\u63a2\u6d4b\u626b\u63cf #\u7aef\u53e3\u662f\u5426\u5728\u76d1\u542c\u6216\u5f00\u653e\u7b49\u52a8\u4f5c\u88ab\u79f0\u4e3a\u7a7a\u8fde\u63a5\uff1b\u5b98\u65b9\u6587\u6863\u4e2d\u6807\u6ce8\uff0c\u5982\u679c\u8be5\u670d\u52a1\u4e0a\u6e38\u6ca1\u6709\u5176\u4ed6\u7684\u8d1f #\u8f7d\u5747\u8861\u5668\u7684\u8bdd\uff0c\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u56e0\u4e3a\u4e92\u8054\u7f51\u4e0a\u7684\u6076\u610f\u626b\u63cf\u6216\u5176\u4ed6\u52a8\u4f5c\u5c31\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765 option httpclose # \u8fd9\u4e2a\u53c2\u6570\u6211\u662f\u8fd9\u6837\u7406\u89e3\u7684\uff1a\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u6bcf\u5904\u7406\u5b8c\u4e00\u4e2arequest\u65f6\uff0chaproxy\u90fd\u4f1a\u53bb\u68c0\u67e5http\u5934 #\u4e2d\u7684Connection\u7684\u503c\uff0c\u5982\u679c\u8be5\u503c\u4e0d\u662fclose\uff0chaproxy\u5c06\u4f1a\u5c06\u5176***\uff0c\u5982\u679c\u8be5\u503c\u4e3a\u7a7a\u5c06\u4f1a\u6dfb\u52a0\u4e3a\uff1a #Connection: close\u3002\u4f7f\u6bcf\u4e2a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u5728\u5b8c\u6210\u4e00\u6b21\u4f20\u8f93\u540e\u90fd\u4f1a\u4e3b\u52a8\u5173\u95edTCP\u8fde\u63a5\u3002\u4e0e\u8be5 #\u53c2\u6570\u7c7b\u4f3c\u7684\u53e6\u5916\u4e00\u4e2a\u53c2\u6570\u662f\u201coption forceclose\u201d\uff0c\u8be5\u53c2\u6570\u7684\u4f5c\u7528\u662f\u5f3a\u5236\u5173\u95ed\u5bf9\u5916\u7684\u670d\u52a1\u901a\u9053 #\uff0c\u56e0\u4e3a\u6709\u7684\u670d\u52a1\u5668\u7aef\u6536\u5230Connection: close\u65f6\uff0c\u4e5f\u4e0d\u4f1a\u81ea\u52a8\u5173\u95edTCP\u8fde\u63a5\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u4e5f\u4e0d\u5173 #\u95ed\uff0c\u8fde\u63a5\u5c31\u4f1a\u4e00\u76f4\u5904\u4e8e\u6253\u5f00\uff0c\u76f4\u5230\u8d85\u65f6\u3002 timeout http-request 10s # \u5ba2\u6237\u7aef\u53d1\u9001http\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout queue 1m # \u5f53\u4e0a\u6e38\u670d\u52a1\u5668\u5728\u9ad8\u8d1f\u8f7d\u54cd\u5e94haproxy\u65f6\uff0c\u4f1a\u628ahaproxy\u53d1\u9001\u6765\u7684\u8bf7\u6c42\u653e\u8fdb\u4e00\u4e2a\u961f\u5217\u4e2d\uff0ctimeout queue\u5b9a\u4e49\u653e\u5165\u8fd9\u4e2a\u961f\u5217\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout connect 5s # haproxy\u4e0e\u540e\u7aef\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5982\u679c\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u53ef\u8bbe\u7f6e\u8f83\u5c0f\u7684\u65f6\u95f4\u3002 timeout client 1m # \u5b9a\u4e49\u5ba2\u6237\u7aef\u4e0ehaproxy\u8fde\u63a5\u540e\uff0c\u6570\u636e\u4f20\u8f93\u5b8c\u6bd5\uff0c\u4e0d\u518d\u6709\u6570\u636e\u4f20\u8f93\uff0c\u5373\u975e\u6d3b\u52a8\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout server 1m # \u5b9a\u4e49haproxy\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668\u975e\u6d3b\u52a8\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002 timeout http-keep-alive 10s # \u8bbe\u7f6e\u65b0\u7684http\u8bf7\u6c42\u8fde\u63a5\u5efa\u7acb\u7684\u6700\u5927\u8d85\u65f6\u65f6\u95f4\uff0c\u65f6\u95f4\u8f83\u77ed\u65f6\u53ef\u4ee5\u5c3d\u5feb\u91ca\u653e\u51fa\u8d44\u6e90\uff0c\u8282\u7ea6\u8d44\u6e90\u3002 timeout check 10s # \u5065\u5eb7\u68c0\u6d4b\u7684\u65f6\u95f4\u7684\u6700\u5927\u8d85\u65f6\u65f6\u95f4\u3002 contimeout 5000 # \u8bbe\u7f6e\u6210\u529f\u8fde\u63a5\u5230\u4e00\u53f0\u670d\u52a1\u5668\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba4\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u65b0\u7248\u672c\u7684haproxy\u4f7f\u7528timeout #connect\u66ff\u4ee3\uff0c\u8be5\u53c2\u6570\u5411\u540e\u517c\u5bb9 clitimeout 3000 # \u8bbe\u7f6e\u8fde\u63a5\u5ba2\u6237\u7aef\u53d1\u9001\u6570\u636e\u65f6\u7684\u6210\u529f\u8fde\u63a5\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba4\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u65b0\u7248\u672chaproxy\u4f7f\u7528 #timeout client\u66ff\u4ee3\u3002\u8be5\u53c2\u6570\u5411\u540e\u517c\u5bb9 srvtimeout 3000 # \u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u56de\u5e94\u5ba2\u6237\u5ea6\u6570\u636e\u53d1\u9001\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u9ed8\u8ba4\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u65b0\u7248\u672chaproxy\u4f7f\u7528 #timeout server\u66ff\u4ee3\u3002\u8be5\u53c2\u6570\u5411\u540e\u517c\u5bb9 listen status # \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3astatus\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u5728listen\u6307\u4ee4\u6307\u5b9a\u7684\u533a\u57df\u4e2d\u5b9a\u4e49\u5339\u914d\u89c4\u5219\u548c\u540e\u7aef\u670d\u52a1\u5668ip\uff0c #\u76f8\u5f53\u4e8e\u9700\u8981\u5728\u5176\u4e2d\u914d\u7f6efrontend\uff0cbackend\u7684\u529f\u80fd\u3002\u4e00\u822c\u505atcp\u8f6c\u53d1\u6bd4\u8f83\u5408\u9002\uff0c\u4e0d\u7528\u592a\u591a\u7684\u89c4\u5219 #\u5339\u914d\u3002 bind 0 .0.0.0:1080 # \u5b9a\u4e49\u76d1\u542c\u7684\u5957\u63a5\u5b57 mode http # \u5b9a\u4e49\u4e3aHTTP\u6a21\u5f0f log global # \u7ee7\u627fglobal\u4e2dlog\u7684\u5b9a\u4e49 stats refresh 30s # stats\u662fhaproxy\u7684\u4e00\u4e2a\u7edf\u8ba1\u9875\u9762\u7684\u5957\u63a5\u5b57\uff0c\u8be5\u53c2\u6570\u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u7684\u5237\u65b0\u95f4\u9694\u4e3a30s stats uri /admin?stats # \u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u7684uri\u4e3a/admin?stats stats realm Private lands # \u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u8ba4\u8bc1\u65f6\u7684\u63d0\u793a\u5185\u5bb9 stats auth admin:password # \u8bbe\u7f6e\u7edf\u8ba1\u9875\u9762\u8ba4\u8bc1\u7684\u7528\u6237\u548c\u5bc6\u7801\uff0c\u5982\u679c\u8981\u8bbe\u7f6e\u591a\u4e2a\uff0c\u53e6\u8d77\u4e00\u884c\u5199\u5165\u5373\u53ef stats hide-version # \u9690\u85cf\u7edf\u8ba1\u9875\u9762\u4e0a\u7684haproxy\u7248\u672c\u4fe1\u606f frontend http_80_in # \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3ahttp_80_in\u7684\u524d\u7aef\u90e8\u5206\uff0chaproxy\u4f1a\u76d1\u542cbind\u7684\u7aef\u53e3 bind 0 .0.0.0:80 # http_80_in\u5b9a\u4e49\u524d\u7aef\u90e8\u5206\u76d1\u542c\u7684\u5957\u63a5\u5b57 mode http # \u5b9a\u4e49\u4e3aHTTP\u6a21\u5f0f log global # \u7ee7\u627fglobal\u4e2dlog\u7684\u5b9a\u4e49 option forwardfor # \u542f\u7528X-Forwarded-For\uff0c\u5728requests\u5934\u90e8\u63d2\u5165\u5ba2\u6237\u7aefIP\u53d1\u9001\u7ed9\u540e\u7aef\u7684server\uff0c\u4f7f\u540e\u7aefserver\u83b7 #\u53d6\u5230\u5ba2\u6237\u7aef\u7684\u771f\u5b9eIP acl static_down nbsrv ( static_server ) lt 1 # \u5b9a\u4e49\u4e00\u4e2a\u540d\u53ebstatic_down\u7684acl\uff0c\u5f53backend static_sever\u4e2d\u5b58\u6d3b\u673a\u5668\u6570\u5c0f\u4e8e1\u65f6\u4f1a\u88ab\u5339\u914d\u5230 acl php_web url_reg /*.php$ #acl php_web path_end .php # \u5b9a\u4e49\u4e00\u4e2a\u540d\u53ebphp_web\u7684acl\uff0c\u5f53\u8bf7\u6c42\u7684url\u672b\u5c3e\u662f\u4ee5.php\u7ed3\u5c3e\u7684\uff0c\u5c06\u4f1a\u88ab\u5339\u914d\u5230\uff0c\u4e0a\u9762\u4e24\u79cd\u5199 #\u6cd5\u4efb\u9009\u5176\u4e00 acl static_web url_reg /*. ( css | jpg | png | jpeg | js | gif ) $ #acl static_web path_end .gif .png .jpg .css .js .jpeg # \u5b9a\u4e49\u4e00\u4e2a\u540d\u53ebstatic_web\u7684acl\uff0c\u5f53\u8bf7\u6c42\u7684url\u672b\u5c3e\u662f\u4ee5.css\u3001.jpg\u3001.png\u3001.jpeg\u3001.js\u3001.gif #\u7ed3\u5c3e\u7684\uff0c\u5c06\u4f1a\u88ab\u5339\u914d\u5230\uff0c\u4e0a\u9762\u4e24\u79cd\u5199\u6cd5\u4efb\u9009\u5176\u4e00 use_backend php_server if static_down # \u5982\u679c\u6ee1\u8db3\u7b56\u7565static_down\u65f6\uff0c\u5c31\u5c06\u8bf7\u6c42\u4ea4\u4e88backend php_server use_backend php_server if php_web # \u5982\u679c\u6ee1\u8db3\u7b56\u7565php_web\u65f6\uff0c\u5c31\u5c06\u8bf7\u6c42\u4ea4\u4e88backend php_server use_backend static_server if static_web # \u5982\u679c\u6ee1\u8db3\u7b56\u7565static_web\u65f6\uff0c\u5c31\u5c06\u8bf7\u6c42\u4ea4\u4e88backend static_server default_backend defaultbackserver #\u5982\u679cacl\u5168\u90e8\u4e0d\u6ee1\u8db3\uff0c\u542f\u7528\u9ed8\u8ba4\u540e\u7aef\u7684\u5730\u5740\u6c60 backend php_server #\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3aphp_server\u7684\u540e\u7aef\u90e8\u5206\uff0cfrontend\u5b9a\u4e49\u7684\u8bf7\u6c42\u4f1a\u5230\u5230\u8fd9\u91cc\u5904\u7406 mode http # \u8bbe\u7f6e\u4e3ahttp\u6a21\u5f0f balance source # \u8bbe\u7f6ehaproxy\u7684\u8c03\u5ea6\u7b97\u6cd5\u4e3a\u6e90\u5730\u5740hash cookie SERVERID # \u5141\u8bb8\u5411cookie\u63d2\u5165SERVERID\uff0c\u6bcf\u53f0\u670d\u52a1\u5668\u7684SERVERID\u53ef\u5728\u4e0b\u9762\u4f7f\u7528cookie\u5173\u952e\u5b57\u5b9a\u4e49 option httpchk GET /test/index.php # \u5f00\u542f\u5bf9\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u6d4b\uff0c\u901a\u8fc7GET /test/index.php\u6765\u5224\u65ad\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u60c5\u51b5 server php_server_1 10 .12.25.68:80 cookie 1 check inter 2000 rise 3 fall 3 weight 2 server php_server_2 10 .12.25.72:80 cookie 2 check inter 2000 rise 3 fall 3 weight 1 server php_server_bak 10 .12.25.79:80 cookie 3 check inter 1500 rise 3 fall 3 backup # server\u8bed\u6cd5\uff1aserver [:port] [param*] # \u4f7f\u7528server\u5173\u952e\u5b57\u6765\u8bbe\u7f6e\u540e\u7aef\u670d\u52a1\u5668\uff1b\u4e3a\u540e\u7aef\u670d\u52a1\u5668\u6240\u8bbe\u7f6e\u7684\u5185\u90e8\u540d\u79f0[php_server_1]\uff0c\u8be5\u540d #\u79f0\u5c06\u4f1a\u5448\u73b0\u5728\u65e5\u5fd7\u6216\u8b66\u62a5\u4e2d\u3001\u540e\u7aef\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff0c\u652f\u6301\u7aef\u53e3\u6620\u5c04[10.12.25.68:80]\u3001\u6307\u5b9a\u8be5 #\u670d\u52a1\u5668\u7684SERVERID\u4e3a1[cookie 1]\u3001\u63a5\u53d7\u5065\u5eb7\u76d1\u6d4b[check]\u3001\u76d1\u6d4b\u7684\u95f4\u9694\u65f6\u957f\uff0c\u5355\u4f4d\u6beb\u79d2[inter #2000]\u3001\u76d1\u6d4b\u6b63\u5e38\u591a\u5c11\u6b21\u540e\u88ab\u8ba4\u4e3a\u540e\u7aef\u670d\u52a1\u5668\u662f\u53ef\u7528\u7684[rise 3]\u3001\u76d1\u6d4b\u5931\u8d25\u591a\u5c11\u6b21\u540e\u88ab\u8ba4\u4e3a\u540e\u7aef #\u670d\u52a1\u5668\u662f\u4e0d\u53ef\u7528\u7684[fall 3]\u3001\u5206\u53d1\u7684\u6743\u91cd[weight 2]\u3001\u6700\u4e3a\u5907\u4efd\u7528\u7684\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5f53\u6b63\u5e38\u7684\u670d #\u52a1\u5668\u5168\u90e8\u90fd\u5b95\u673a\u540e\uff0c\u624d\u4f1a\u542f\u7528\u5907\u4efd\u670d\u52a1\u5668[backup] backend static_server mode http option httpchk GET /test/index.html server static_server_1 10 .12.25.83:80 cookie 3 check inter 2000 rise 3 fall 3 \u5b98\u65b9\u914d\u7f6e\uff1a http://haproxy.1wt.eu/download/1.4/doc/configuration.txt","title":"\u4e8c\u3001haproxy\u914d\u7f6e\u8be6\u89e3"},{"location":"other/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#haproxy_1","text":"1\u3001\u8c03\u5ea6\u7b97\u6cd5source haroxy \u5c06\u7528\u6237IP\u7ecf\u8fc7hash\u8ba1\u7b97\u540e \u6307\u5b9a\u5230\u56fa\u5b9a\u7684\u771f\u5b9e\u670d\u52a1\u5668\u4e0a\uff08\u7c7b\u4f3c\u4e8enginx \u7684IP hash \u6307\u4ee4\uff09 \u914d\u7f6e\u6307\u4ee4 balance source 2\u3001cookie \u8bc6\u522b haproxy \u5c06WEB\u670d\u52a1\u7aef\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684cookie\u4e2d\u63d2\u5165(\u6216\u6dfb\u52a0\u52a0\u524d\u7f00)haproxy\u5b9a\u4e49\u7684\u540e\u7aef\u7684\u670d\u52a1\u5668COOKIE ID\u3002 \u914d\u7f6e\u6307\u4ee4\u4f8b\u4e3e cookie SESSION_COOKIE insert indirect nocache 3\u3001session \u8bc6\u522b haproxy \u5c06\u540e\u7aef\u670d\u52a1\u5668\u4ea7\u751f\u7684session\u548c\u540e\u7aef\u670d\u52a1\u5668\u6807\u8bc6\u5b58\u5728haproxy\u4e2d\u7684\u4e00\u5f20\u8868\u91cc\u3002\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\u5148\u67e5\u8be2\u8fd9\u5f20\u8868\u3002\u7136\u540e\u6839\u636esession\u5206\u914d\u540e\u7aefserver\u3002 \u914d\u7f6e\u6307\u4ee4\uff1aappsession len timeout","title":"\u4e09\u3001haproxy\u5b9e\u73b0\u6301\u4e45\u8fde\u63a5"},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/","tags":"[netstat]","text":"\u67e5\u770b\u7aef\u53e3\u662f\u5426\u6253\u5f00 \u00b6 \u4f7f\u7528 netstat \u547d\u4ee4 \u00b6 a. ` netstat -nat | grep <\u7aef\u53e3\u53f7> ` , \u5982\u547d\u4ee4 ` netstat -nat | grep 3306 ` b. ` netstat -nat | grep LISTEN ` \u4f7f\u7528 lsof \u547d\u4ee4 \u00b6 # yongfu-pro at yongfu-pro.local in ~ [22:39:32] $ lsof -n -P -i TCP -s TCP:LISTEN COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME php-fpm 387 yongfu-pro 6u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) Dropbox 413 yongfu-pro 26u IPv4 0x6d7f5d3c445e2c09 0t0 TCP *:17500 ( LISTEN ) php-fpm 418 yongfu-pro 0u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) php-fpm 419 yongfu-pro 0u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) php-fpm 420 yongfu-pro 0u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) stunnel 586 yongfu-pro 9u IPv4 0x6d7f5d3c439ff679 0t0 TCP 127 .0.0.1:1997 ( LISTEN ) lsof\u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u7684\u6240\u6709\u7f51\u7edc\u60c5\u51b5\uff0c \u6b64\u547d\u4ee4\u7684\u89e3\u91ca\u5982\u4e0b\uff1a -n \u8868\u793a\u4e3b\u673a\u4ee5ip\u5730\u5740\u663e\u793a -P \u8868\u793a\u7aef\u53e3\u4ee5\u6570\u5b57\u5f62\u5f0f\u663e\u793a\uff0c\u9ed8\u8ba4\u4e3a\u7aef\u53e3\u540d\u79f0 -i \u610f\u4e49\u8f83\u591a\uff0c\u5177\u4f53 man lsof, \u4e3b\u8981\u662f\u7528\u6765\u8fc7\u6ee4lsof\u7684\u8f93\u51fa\u7ed3\u679c -s \u548c -i \u914d\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u8fc7\u6ee4\u8f93\u51fa \u4f7f\u7528telnet \u547d\u4ee4 \u00b6 \u68c0\u67e5\u672c\u673a\u76843306\u7aef\u53e3\u662f\u5426\u6253\u5f00\uff0c \u5982\u4e0b telnet 127.0.0.1 3306 \u82e5\u8be5\u7aef\u53e3\u6ca1\u6709\u6253\u5f00\uff0c\u5219\u4f1a\u81ea\u52a8\u9000\u51fa\uff0c\u5e76\u663e\u793a\u5982\u4e0b\u5185\u5bb9\uff1a Trying 127 .0.0.1... telnet: connect to address 127 .0.0.1: Connection refused telnet: Unable to connect to remote host \u82e5\u8be5\u7aef\u53e3\u4e3a\u5df2\u6253\u5f00\u7684\u72b6\u6001\uff0c\u5219\u4f1a\u4e00\u76f4\u4fdd\u6301\u8fde\u63a5\u3002 \u4f7f\u7528 nc \u547d\u4ee4 \u00b6 ```bash yongfu at yf-mac.local in ~ [9:33:14] \u00b6 $ nc -w 10 -n -z 127.0.0.1 1990-1999 Connection to 127.0.0.1 port 1997 [tcp/ ] succeeded! Connection to 127.0.0.1 port 1998 [tcp/ ] succeeded! -w 10 \u8868\u793a\u7b49\u5f85\u8fde\u63a5\u65f6\u95f4\u4e3a10\u79d2 -n \u5c3d\u91cf\u5c06\u7aef\u53e3\u53f7\u540d\u79f0\u8f6c\u6362\u4e3a\u7aef\u53e3\u53f7\u6570\u5b57 -z \u5bf9\u9700\u8981\u68c0\u67e5\u7684\u7aef\u53e3\u6ca1\u6709\u8f93\u5165\u8f93\u51fa\uff0c\u7528\u4e8e\u7aef\u53e3\u626b\u63cf\u6a21\u5f0f 127.0.0.1 \u9700\u8981\u68c0\u67e5\u7684ip\u5730\u5740 1990-1999 \u53ef\u4ee5\u662f\u4e00\u4e2a\u7aef\u53e3\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u6bb5\u7aef\u53e3 \u8fd4\u56de\u7ed3\u679c\u4e3a\u5f00\u653e\u7684\u7aef\u53e3\uff0c \u5982\u672c\u4f8b\u4e2d\u7684 1997 \u548c 1998 \u7aef\u53e3 ```","title":"\"MacOS \u67e5\u770b\u7f51\u7edc\u7aef\u53e3\u60c5\u51b5\""},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#_1","text":"","title":"\u67e5\u770b\u7aef\u53e3\u662f\u5426\u6253\u5f00"},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#netstat","text":"a. ` netstat -nat | grep <\u7aef\u53e3\u53f7> ` , \u5982\u547d\u4ee4 ` netstat -nat | grep 3306 ` b. ` netstat -nat | grep LISTEN `","title":"\u4f7f\u7528 netstat \u547d\u4ee4"},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#lsof","text":"# yongfu-pro at yongfu-pro.local in ~ [22:39:32] $ lsof -n -P -i TCP -s TCP:LISTEN COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME php-fpm 387 yongfu-pro 6u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) Dropbox 413 yongfu-pro 26u IPv4 0x6d7f5d3c445e2c09 0t0 TCP *:17500 ( LISTEN ) php-fpm 418 yongfu-pro 0u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) php-fpm 419 yongfu-pro 0u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) php-fpm 420 yongfu-pro 0u IPv4 0x6d7f5d3c3a615679 0t0 TCP 127 .0.0.1:9000 ( LISTEN ) stunnel 586 yongfu-pro 9u IPv4 0x6d7f5d3c439ff679 0t0 TCP 127 .0.0.1:1997 ( LISTEN ) lsof\u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u7684\u6240\u6709\u7f51\u7edc\u60c5\u51b5\uff0c \u6b64\u547d\u4ee4\u7684\u89e3\u91ca\u5982\u4e0b\uff1a -n \u8868\u793a\u4e3b\u673a\u4ee5ip\u5730\u5740\u663e\u793a -P \u8868\u793a\u7aef\u53e3\u4ee5\u6570\u5b57\u5f62\u5f0f\u663e\u793a\uff0c\u9ed8\u8ba4\u4e3a\u7aef\u53e3\u540d\u79f0 -i \u610f\u4e49\u8f83\u591a\uff0c\u5177\u4f53 man lsof, \u4e3b\u8981\u662f\u7528\u6765\u8fc7\u6ee4lsof\u7684\u8f93\u51fa\u7ed3\u679c -s \u548c -i \u914d\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u8fc7\u6ee4\u8f93\u51fa","title":"\u4f7f\u7528 lsof \u547d\u4ee4"},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#telnet","text":"\u68c0\u67e5\u672c\u673a\u76843306\u7aef\u53e3\u662f\u5426\u6253\u5f00\uff0c \u5982\u4e0b telnet 127.0.0.1 3306 \u82e5\u8be5\u7aef\u53e3\u6ca1\u6709\u6253\u5f00\uff0c\u5219\u4f1a\u81ea\u52a8\u9000\u51fa\uff0c\u5e76\u663e\u793a\u5982\u4e0b\u5185\u5bb9\uff1a Trying 127 .0.0.1... telnet: connect to address 127 .0.0.1: Connection refused telnet: Unable to connect to remote host \u82e5\u8be5\u7aef\u53e3\u4e3a\u5df2\u6253\u5f00\u7684\u72b6\u6001\uff0c\u5219\u4f1a\u4e00\u76f4\u4fdd\u6301\u8fde\u63a5\u3002","title":"\u4f7f\u7528telnet \u547d\u4ee4"},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#nc","text":"```bash","title":"\u4f7f\u7528 nc \u547d\u4ee4"},{"location":"other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#yongfu-at-yf-maclocal-in-93314","text":"$ nc -w 10 -n -z 127.0.0.1 1990-1999 Connection to 127.0.0.1 port 1997 [tcp/ ] succeeded! Connection to 127.0.0.1 port 1998 [tcp/ ] succeeded! -w 10 \u8868\u793a\u7b49\u5f85\u8fde\u63a5\u65f6\u95f4\u4e3a10\u79d2 -n \u5c3d\u91cf\u5c06\u7aef\u53e3\u53f7\u540d\u79f0\u8f6c\u6362\u4e3a\u7aef\u53e3\u53f7\u6570\u5b57 -z \u5bf9\u9700\u8981\u68c0\u67e5\u7684\u7aef\u53e3\u6ca1\u6709\u8f93\u5165\u8f93\u51fa\uff0c\u7528\u4e8e\u7aef\u53e3\u626b\u63cf\u6a21\u5f0f 127.0.0.1 \u9700\u8981\u68c0\u67e5\u7684ip\u5730\u5740 1990-1999 \u53ef\u4ee5\u662f\u4e00\u4e2a\u7aef\u53e3\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u6bb5\u7aef\u53e3 \u8fd4\u56de\u7ed3\u679c\u4e3a\u5f00\u653e\u7684\u7aef\u53e3\uff0c \u5982\u672c\u4f8b\u4e2d\u7684 1997 \u548c 1998 \u7aef\u53e3 ```","title":"yongfu at yf-mac.local in ~ [9:33:14]"},{"location":"other/Mariadb-ColumnStore%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B5%8B%E8%AF%95/","tags":"[ColumnStore]","text":"\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662fMariadb\u4e3a\u4e86\u5927\u6570\u636e\u800c\u5f00\u53d1\u7684\u5217\u5f0f\u6570\u636e\u5e93\u3002\u540e\u6765\u53d1\u73b0\uff0c\u8fd9\u8d27\u5c31\u662fInfiniDB\u7684\u7ffb\u7248\uff0cInfiniDB\u88abMariaDB\u6536\u8d2d\u4e86\u4ee5\u540e\u91cd\u65b0\u5f00\u53d1\u7684\u65b0\u7248\u672c\u3002 MariaDB [( none )] > show engines ; +--------------------+---------+--------------------------------------------------------------------------------------------------+--------------+------+------------+ | Engine | Support | Comment | Transactions | XA | Savepoints | +--------------------+---------+--------------------------------------------------------------------------------------------------+--------------+------+------------+ | Columnstore | YES | Columnstore storage engine | YES | NO | NO | | MRG_MyISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | | CSV | YES | CSV storage engine | NO | NO | NO | | MyISAM | YES | MyISAM storage engine | NO | NO | NO | | MEMORY | YES | Hash based, stored in memory, useful for temporary tables | NO | NO | NO | | InfiniDB | YES | Columnstore storage engine ( deprecated: use columnstore ) | YES | NO | NO | | InnoDB | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, foreign keys and encryption for tables | YES | YES | YES | | SEQUENCE | YES | Generated tables filled with sequential values | YES | NO | YES | | Aria | YES | Crash-safe tables with MyISAM heritage | NO | NO | NO | | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | +--------------------+---------+--------------------------------------------------------------------------------------------------+--------------+------+------------+ 10 rows in set ( 0 .00 sec ) \u8fd8\u80fd\u770b\u5230InfiniDB\u5f15\u64ce\u7684\u5f71\u5b50\u3002 \u6d4b\u8bd5\u73af\u5883\uff1a centos 6.6 8\u68388G ssd 100G mariadb columnstore 1.0.6 GA 1\u3001\u5b89\u88c5 \u5b89\u88c5\u4f9d\u8d56 # yum -y install expect perl perl-DBI openssl zlib perl-DBD-MySQL cmake \u5fc5\u987b\u8981boost1.50\u4ee5\u4e0a\u7248\u672c\u3002 # wget https://static.verycloud.cn/rpm/boost_1_55_0.tgz # wget https://static.verycloud.cn/rpm/mariadb-columnstore-1.0.6-1-centos6.x86_64.rpm.tar.gz \u5b89\u88c5boost. # tar -zxvf boost_1_55_0.tgz # tar -zxvf mariadb-columnstore-1.0.6-1-centos6.x86_64.rpm.tar.gz # cd boost_1_55_0 # ./bootstrap.sh --with-libraries=atomic,date_time,exception,filesystem,iostreams,locale,program_options,regex,signals,system,test,thread,timer,log --prefix=/usr # ./b2 install \u5b89\u88c5mariadb columnstore. # rpm -ivh mariadb-columnstore-1.0.6-1-x86_64-centos6-* 2\u3001\u521d\u59cb\u5316 # /usr/local/mariadb/columnstore/bin/post-install \u8fd9\u65f6\u4f1a\u63d0\u793a The next step is: /usr/local/mariadb/columnstore/bin/postConfigure \u6267\u884c\uff0c\u5b8c\u6210\u5b89\u88c5\uff0c\u9009\u62e9single server # /usr/local/mariadb/columnstore/bin/postConfigure \u751f\u6210\u522b\u540d # . /data/mariadb/columnstore/bin/columnstoreAlias \u6267\u884c mcsmysql\uff0c\u4f1a\u770b\u5230\u63d0\u793a Welcome to the MariaDB monitor. Commands end with ; or \\g . Your MariaDB connection id is 5 Server version: 10 .1.19-MariaDB Columnstore 1 .0.6-1 Copyright ( c ) 2000 , 2016 , Oracle, MariaDB Corporation Ab and others. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. MariaDB [( none )] > \u8bf4\u660e\u5b89\u88c5\u6210\u529f\u4e86\uff01 3\u3001\u6570\u636e\u5bfc\u5165 \u6267\u884c # mcsmysql --local-infile # LOAD DATA LOCAL INFILE '/root/data.txt' INTO TABLE your_table FIELDS TERMINATED BY '\\t'; Query OK, 95981370 rows affected ( 6 min 8 .62 sec ) Records: 95981370 Deleted: 0 Skipped: 0 Warnings: 0 \u5bfc\u51651\u4ebf\u6761\u6570\u636e\u89816\u5206\u949f\u3002","title":"Mariadb ColumnStore\u6570\u636e\u5e93\u6d4b\u8bd5"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/","tags":"[mysql_install]","text":"1\u3001\u6dfb\u52a0yum\u6e90 \u00b6 wget \u00b6 --------------- On RHEL/CentOS 7 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm --------------- On RHEL/CentOS 6 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-el6-7.noarch.rpm --------------- On RHEL/CentOS 5 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm --------------- On Fedora 23 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-fc23-7.noarch.rpm --------------- On Fedora 22 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-fc22-7.noarch.rpm --------------- On Fedora 21 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-fc21-7.noarch.rpm \u5b89\u88c5 \u00b6 --------------- On RHEL/CentOS 7 --------------- # yum localinstall mysql57-community-release-el7-7.noarch.rpm --------------- On RHEL/CentOS 6 --------------- # yum localinstall mysql57-community-release-el6-7.noarch.rpm --------------- On RHEL/CentOS 5 --------------- # yum localinstall mysql57-community-release-el5-7.noarch.rpm --------------- On Fedora 23 --------------- # dnf localinstall mysql57-community-release-fc23-7.noarch.rpm --------------- On Fedora 22 --------------- # dnf localinstall mysql57-community-release-fc22-7.noarch.rpm --------------- On Fedora 21 --------------- # yum localinstall mysql57-community-release-fc21-7.noarch.rpm \u6821\u9a8c\u6e90 \u00b6 # yum repolist enabled | grep \"mysql.*-community.*\" # dnf repolist enabled | grep \"mysql.*-community.*\" [On Fedora 22+ versions] 2\u3001\u5b89\u88c5mysql \u00b6 # yum install mysql-community-server mysql mysql-libs mysql-devel # dnf install mysql-community-server mysql mysql-libs mysql-devel [On Fedora 22+ versions] 3\u3001\u5f00\u542fmysql \u00b6 service mysqld start \u67e5\u770bmysql\u7248\u672c # mysql --version mysql Ver 14 .14 Distrib 5 .7.12, for Linux ( x86_64 ) using EditLine wrapper 4\u3001\u914d\u7f6emysql \u00b6 \u67e5\u770b\u9ed8\u8ba4\u5bc6\u7801 \u00b6 # grep 'temporary password' /var/log/mysqld.log \u6267\u884c # mysql_secure_installation \u914d\u7f6e\u793a\u4f8b\uff1a Securing the MySQL server deployment. Enter password for user root: Enter New Root Password VALIDATE PASSWORD PLUGIN can be used to test passwords and improve security. It checks the strength of password and allows the users to set only those passwords which are secure enough. Would you like to setup VALIDATE PASSWORD plugin? Press y | Y for Yes, any other key for No: y There are three levels of password validation policy: LOW Length > = 8 MEDIUM Length > = 8 , numeric, mixed case , and special characters STRONG Length > = 8 , numeric, mixed case , special characters and dictionary file Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 2 Using existing password for root. Estimated strength of the password: 50 Change the password for root ? (( Press y | Y for Yes, any other key for No ) : y New password: Set New MySQL Password Re-enter new password: Re-enter New MySQL Password Estimated strength of the password: 100 Do you wish to continue with the password provided? ( Press y | Y for Yes, any other key for No ) : y By default, a MySQL installation has an anonymous user, allowing anyone to log into MySQL without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment. Remove anonymous users? ( Press y | Y for Yes, any other key for No ) : y Success. Normally, root should only be allowed to connect from 'localhost' . This ensures that someone cannot guess at the root password from the network. Disallow root login remotely? ( Press y | Y for Yes, any other key for No ) : y Success. By default, MySQL comes with a database named 'test' that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment. Remove test database and access to it? ( Press y | Y for Yes, any other key for No ) : y - Dropping test database... Success. - Removing privileges on test database... Success. Reloading the privilege tables will ensure that all changes made so far will take effect immediately. Reload privilege tables now? ( Press y | Y for Yes, any other key for No ) : y Success. All done ! \u81f3\u6b64\uff0c\u5b89\u88c5\u5b8c\u6210\uff01","title":"\"mysql-5.7.x\u5b89\u88c5\""},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#1yum","text":"","title":"1\u3001\u6dfb\u52a0yum\u6e90"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#wget","text":"--------------- On RHEL/CentOS 7 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm --------------- On RHEL/CentOS 6 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-el6-7.noarch.rpm --------------- On RHEL/CentOS 5 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm --------------- On Fedora 23 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-fc23-7.noarch.rpm --------------- On Fedora 22 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-fc22-7.noarch.rpm --------------- On Fedora 21 --------------- # wget http://dev.mysql.com/get/mysql57-community-release-fc21-7.noarch.rpm","title":"wget"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#_1","text":"--------------- On RHEL/CentOS 7 --------------- # yum localinstall mysql57-community-release-el7-7.noarch.rpm --------------- On RHEL/CentOS 6 --------------- # yum localinstall mysql57-community-release-el6-7.noarch.rpm --------------- On RHEL/CentOS 5 --------------- # yum localinstall mysql57-community-release-el5-7.noarch.rpm --------------- On Fedora 23 --------------- # dnf localinstall mysql57-community-release-fc23-7.noarch.rpm --------------- On Fedora 22 --------------- # dnf localinstall mysql57-community-release-fc22-7.noarch.rpm --------------- On Fedora 21 --------------- # yum localinstall mysql57-community-release-fc21-7.noarch.rpm","title":"\u5b89\u88c5"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#_2","text":"# yum repolist enabled | grep \"mysql.*-community.*\" # dnf repolist enabled | grep \"mysql.*-community.*\" [On Fedora 22+ versions]","title":"\u6821\u9a8c\u6e90"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#2mysql","text":"# yum install mysql-community-server mysql mysql-libs mysql-devel # dnf install mysql-community-server mysql mysql-libs mysql-devel [On Fedora 22+ versions]","title":"2\u3001\u5b89\u88c5mysql"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#3mysql","text":"service mysqld start \u67e5\u770bmysql\u7248\u672c # mysql --version mysql Ver 14 .14 Distrib 5 .7.12, for Linux ( x86_64 ) using EditLine wrapper","title":"3\u3001\u5f00\u542fmysql"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#4mysql","text":"","title":"4\u3001\u914d\u7f6emysql"},{"location":"other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#_3","text":"# grep 'temporary password' /var/log/mysqld.log \u6267\u884c # mysql_secure_installation \u914d\u7f6e\u793a\u4f8b\uff1a Securing the MySQL server deployment. Enter password for user root: Enter New Root Password VALIDATE PASSWORD PLUGIN can be used to test passwords and improve security. It checks the strength of password and allows the users to set only those passwords which are secure enough. Would you like to setup VALIDATE PASSWORD plugin? Press y | Y for Yes, any other key for No: y There are three levels of password validation policy: LOW Length > = 8 MEDIUM Length > = 8 , numeric, mixed case , and special characters STRONG Length > = 8 , numeric, mixed case , special characters and dictionary file Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 2 Using existing password for root. Estimated strength of the password: 50 Change the password for root ? (( Press y | Y for Yes, any other key for No ) : y New password: Set New MySQL Password Re-enter new password: Re-enter New MySQL Password Estimated strength of the password: 100 Do you wish to continue with the password provided? ( Press y | Y for Yes, any other key for No ) : y By default, a MySQL installation has an anonymous user, allowing anyone to log into MySQL without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment. Remove anonymous users? ( Press y | Y for Yes, any other key for No ) : y Success. Normally, root should only be allowed to connect from 'localhost' . This ensures that someone cannot guess at the root password from the network. Disallow root login remotely? ( Press y | Y for Yes, any other key for No ) : y Success. By default, MySQL comes with a database named 'test' that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment. Remove test database and access to it? ( Press y | Y for Yes, any other key for No ) : y - Dropping test database... Success. - Removing privileges on test database... Success. Reloading the privilege tables will ensure that all changes made so far will take effect immediately. Reload privilege tables now? ( Press y | Y for Yes, any other key for No ) : y Success. All done ! \u81f3\u6b64\uff0c\u5b89\u88c5\u5b8c\u6210\uff01","title":"\u67e5\u770b\u9ed8\u8ba4\u5bc6\u7801"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/","tags":"[\u6570\u636e\u5e93\u8bbe\u8ba1]","text":"\u9002\u7528\u573a\u666f\uff1a\u5e76\u53d1\u91cf\u5927\u3001\u6570\u636e\u91cf\u5927\u7684\u4e92\u8054\u7f51\u4e1a\u52a1 \u4e00\u3001\u57fa\u7840\u89c4\u8303 \u00b6 \uff081\uff09\u5fc5\u987b\u4f7f\u7528InnoDB\u5b58\u50a8\u5f15\u64ce \u89e3\u8bfb\uff1a\u652f\u6301\u4e8b\u52a1\u3001\u884c\u7ea7\u9501\u3001\u5e76\u53d1\u6027\u80fd\u66f4\u597d\u3001CPU\u53ca\u5185\u5b58\u7f13\u5b58\u9875\u4f18\u5316\u4f7f\u5f97\u8d44\u6e90\u5229\u7528\u7387\u66f4\u9ad8 \uff082\uff09\u5fc5\u987b\u4f7f\u7528UTF8\u5b57\u7b26\u96c6 \u89e3\u8bfb\uff1a\u4e07\u56fd\u7801\uff0c\u65e0\u9700\u8f6c\u7801\uff0c\u65e0\u4e71\u7801\u98ce\u9669 \u5b57\u7b26\u96c6\u63a8\u8350\u4f7f\u7528utf8mb4\u5b57\u7b26\u96c6,utf8mb4\u662futf8\u7684\u8d85\u96c6\uff0cemoji\u8868\u60c5\u4ee5\u53ca\u90e8\u5206\u4e0d\u5e38\u89c1\u6c49\u5b57\u5728utf8\u4e0b\u4f1a\u8868\u73b0\u4e3a\u4e71\u7801\uff0c\u6545\u9700\u8981\u5347\u7ea7\u81f3utf8mb4\u3002 \uff083\uff09\u6570\u636e\u8868\u3001\u6570\u636e\u5b57\u6bb5\u5fc5\u987b\u52a0\u5165\u4e2d\u6587\u6ce8\u91ca \u89e3\u8bfb\uff1aN\u5e74\u540e\u8c01tm\u77e5\u9053\u8fd9\u4e2ar1,r2,r3\u5b57\u6bb5\u662f\u5e72\u561b\u7684 \uff084\uff09\u7981\u6b62\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\u3001\u89c6\u56fe\u3001\u89e6\u53d1\u5668\u3001Event \u89e3\u8bfb\uff1a\u9ad8\u5e76\u53d1\u5927\u6570\u636e\u7684\u4e92\u8054\u7f51\u4e1a\u52a1\uff0c\u67b6\u6784\u8bbe\u8ba1\u601d\u8def\u662f\u201c\u89e3\u653e\u6570\u636e\u5e93CPU\uff0c\u5c06\u8ba1\u7b97\u8f6c\u79fb\u5230\u670d\u52a1\u5c42\u201d\uff0c\u5e76\u53d1\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9b\u529f\u80fd\u5f88\u53ef\u80fd\u5c06\u6570\u636e\u5e93\u62d6\u6b7b\uff0c\u4e1a\u52a1\u903b\u8f91\u653e\u5230\u670d\u52a1\u5c42\u5177\u5907\u66f4\u597d\u7684\u6269\u5c55\u6027\uff0c\u80fd\u591f\u8f7b\u6613\u5b9e\u73b0\u201c\u589e\u673a\u5668\u5c31\u52a0\u6027\u80fd\u201d\u3002\u6570\u636e\u5e93\u64c5\u957f\u5b58\u50a8\u4e0e\u7d22\u5f15\uff0cCPU\u8ba1\u7b97\u8fd8\u662f\u4e0a\u79fb\u5427 \uff085\uff09\u7981\u6b62\u5b58\u50a8\u5927\u6587\u4ef6\u6216\u8005\u5927\u7167\u7247 \u89e3\u8bfb\uff1a\u4e3a\u4f55\u8981\u8ba9\u6570\u636e\u5e93\u505a\u5b83\u4e0d\u64c5\u957f\u7684\u4e8b\u60c5\uff1f\u5927\u6587\u4ef6\u548c\u7167\u7247\u5b58\u50a8\u5728\u6587\u4ef6\u7cfb\u7edf\uff0c\u6570\u636e\u5e93\u91cc\u5b58URI\u591a\u597d \u4e8c\u3001\u547d\u540d\u89c4\u8303 \u00b6 \uff086\uff09\u53ea\u5141\u8bb8\u4f7f\u7528\u5185\u7f51\u57df\u540d\uff0c\u800c\u4e0d\u662fip\u8fde\u63a5\u6570\u636e\u5e93 \u89e3\u8bfb\uff1a\u4e0d\u53ea\u662f\u6570\u636e\u5e93\uff0c\u7f13\u5b58\uff08memcache\u3001redis\uff09\u7684\u8fde\u63a5\uff0c\u670d\u52a1\uff08service\uff09\u7684\u8fde\u63a5\u90fd\u5fc5\u987b\u4f7f\u7528\u5185\u7f51\u57df\u540d\uff0c\u673a\u5668\u8fc1\u79fb/\u5e73\u6ed1\u5347\u7ea7/\u8fd0\u7ef4\u7ba1\u7406\u2026\u592a\u591a\u592a\u591a\u7684\u597d\u5904\u3002 \uff087\uff09\u7ebf\u4e0a\u73af\u5883\u3001\u5f00\u53d1\u73af\u5883\u3001\u6d4b\u8bd5\u73af\u5883\u6570\u636e\u5e93\u5185\u7f51\u57df\u540d\u9075\u5faa\u547d\u540d\u89c4\u8303 \u4e1a\u52a1\u540d\u79f0\uff1axxx \u7ebf\u4e0a\u73af\u5883\uff1axxx.db \u5f00\u53d1\u73af\u5883\uff1axxx.rdb \u6d4b\u8bd5\u73af\u5883\uff1axxx.tdb \u4ece\u5e93\u5728\u540d\u79f0\u540e\u52a0-s\u6807\u8bc6\uff0c\u5907\u5e93\u5728\u540d\u79f0\u540e\u52a0-ss\u6807\u8bc6 \u7ebf\u4e0a\u4ece\u5e93\uff1axxx-s.db \u7ebf\u4e0a\u5907\u5e93\uff1axxx-sss.db \uff088\uff09\u5e93\u540d\u3001\u8868\u540d\u3001\u5b57\u6bb5\u540d\uff1a\u5c0f\u5199\uff0c\u4e0b\u5212\u7ebf\u98ce\u683c\uff0c\u4e0d\u8d85\u8fc732\u4e2a\u5b57\u7b26\uff0c\u5fc5\u987b\u89c1\u540d\u77e5\u610f\uff0c\u7981\u6b62\u62fc\u97f3\u82f1\u6587\u6df7\u7528 \uff089\uff09\u8868\u540dt_xxx\uff0c\u975e\u552f\u4e00\u7d22\u5f15\u540didx_xxx\uff0c\u552f\u4e00\u7d22\u5f15\u540duniq_xxx \u4e09\u3001\u8868\u8bbe\u8ba1\u89c4\u8303 \u00b6 \uff0810\uff09\u5355\u5b9e\u4f8b\u8868\u6570\u76ee\u5fc5\u987b\u5c0f\u4e8e500 \uff0811\uff09\u5355\u8868\u5217\u6570\u76ee\u5fc5\u987b\u5c0f\u4e8e30 \uff0812\uff09\u8868\u5fc5\u987b\u6709\u4e3b\u952e\uff0c\u4f8b\u5982\u81ea\u589e\u4e3b\u952e \u89e3\u8bfb\uff1a a\uff09\u4e3b\u952e\u9012\u589e\uff0c\u6570\u636e\u884c\u5199\u5165\u53ef\u4ee5\u63d0\u9ad8\u63d2\u5165\u6027\u80fd\uff0c\u53ef\u4ee5\u907f\u514dpage\u5206\u88c2\uff0c\u51cf\u5c11\u8868\u788e\u7247\u63d0\u5347\u7a7a\u95f4\u548c\u5185\u5b58\u7684\u4f7f\u7528 b\uff09\u4e3b\u952e\u8981\u9009\u62e9\u8f83\u77ed\u7684\u6570\u636e\u7c7b\u578b\uff0c Innodb\u5f15\u64ce\u666e\u901a\u7d22\u5f15\u90fd\u4f1a\u4fdd\u5b58\u4e3b\u952e\u7684\u503c\uff0c\u8f83\u77ed\u7684\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u6709\u6548\u7684\u51cf\u5c11\u7d22\u5f15\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u63d0\u9ad8\u7d22\u5f15\u7684\u7f13\u5b58\u6548\u7387 c\uff09 \u65e0\u4e3b\u952e\u7684\u8868\u5220\u9664\uff0c\u5728row\u6a21\u5f0f\u7684\u4e3b\u4ece\u67b6\u6784\uff0c\u4f1a\u5bfc\u81f4\u5907\u5e93\u592f\u4f4f \uff0813\uff09\u7981\u6b62\u4f7f\u7528\u5916\u952e\uff0c\u5982\u679c\u6709\u5916\u952e\u5b8c\u6574\u6027\u7ea6\u675f\uff0c\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236 \u89e3\u8bfb\uff1a\u5916\u952e\u4f1a\u5bfc\u81f4\u8868\u4e0e\u8868\u4e4b\u95f4\u8026\u5408\uff0cupdate\u4e0edelete\u64cd\u4f5c\u90fd\u4f1a\u6d89\u53ca\u76f8\u5173\u8054\u7684\u8868\uff0c\u5341\u5206\u5f71\u54cdsql \u7684\u6027\u80fd\uff0c\u751a\u81f3\u4f1a\u9020\u6210\u6b7b\u9501\u3002\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\u5bb9\u6613\u9020\u6210\u6570\u636e\u5e93\u6027\u80fd\uff0c\u5927\u6570\u636e\u9ad8\u5e76\u53d1\u4e1a\u52a1\u573a\u666f\u6570\u636e\u5e93\u4f7f\u7528\u4ee5\u6027\u80fd\u4f18\u5148 \u56db\u3001\u5b57\u6bb5\u8bbe\u8ba1\u89c4\u8303 \u00b6 \uff0814\uff09\u5fc5\u987b\u628a\u5b57\u6bb5\u5b9a\u4e49\u4e3aNOT NULL\u5e76\u4e14\u63d0\u4f9b\u9ed8\u8ba4\u503c \u89e3\u8bfb\uff1a a\uff09null\u7684\u5217\u4f7f\u7d22\u5f15/\u7d22\u5f15\u7edf\u8ba1/\u503c\u6bd4\u8f83\u90fd\u66f4\u52a0\u590d\u6742\uff0c\u5bf9MySQL\u6765\u8bf4\u66f4\u96be\u4f18\u5316 b\uff09null \u8fd9\u79cd\u7c7b\u578bMySQL\u5185\u90e8\u9700\u8981\u8fdb\u884c\u7279\u6b8a\u5904\u7406\uff0c\u589e\u52a0\u6570\u636e\u5e93\u5904\u7406\u8bb0\u5f55\u7684\u590d\u6742\u6027\uff1b\u540c\u7b49\u6761\u4ef6\u4e0b\uff0c\u8868\u4e2d\u6709\u8f83\u591a\u7a7a\u5b57\u6bb5\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u7684\u5904\u7406\u6027\u80fd\u4f1a\u964d\u4f4e\u5f88\u591a c\uff09null\u503c\u9700\u8981\u66f4\u591a\u7684\u5b58\u50a8\u7a7a\uff0c\u65e0\u8bba\u662f\u8868\u8fd8\u662f\u7d22\u5f15\u4e2d\u6bcf\u884c\u4e2d\u7684null\u7684\u5217\u90fd\u9700\u8981\u989d\u5916\u7684\u7a7a\u95f4\u6765\u6807\u8bc6 d\uff09\u5bf9null \u7684\u5904\u7406\u65f6\u5019\uff0c\u53ea\u80fd\u91c7\u7528is null\u6216is not null\uff0c\u800c\u4e0d\u80fd\u91c7\u7528=\u3001in\u3001<\u3001<>\u3001!=\u3001not in\u8fd9\u4e9b\u64cd\u4f5c\u7b26\u53f7\u3002\u5982\uff1awhere name!=\u2019shenjian\u2019\uff0c\u5982\u679c\u5b58\u5728name\u4e3anull\u503c\u7684\u8bb0\u5f55\uff0c\u67e5\u8be2\u7ed3\u679c\u5c31\u4e0d\u4f1a\u5305\u542bname\u4e3anull\u503c\u7684\u8bb0\u5f55 \uff0815\uff09\u7981\u6b62\u4f7f\u7528TEXT\u3001BLOB\u7c7b\u578b \u89e3\u8bfb\uff1a\u4f1a\u6d6a\u8d39\u66f4\u591a\u7684\u78c1\u76d8\u548c\u5185\u5b58\u7a7a\u95f4\uff0c\u975e\u5fc5\u8981\u7684\u5927\u91cf\u7684\u5927\u5b57\u6bb5\u67e5\u8be2\u4f1a\u6dd8\u6c70\u6389\u70ed\u6570\u636e\uff0c\u5bfc\u81f4\u5185\u5b58\u547d\u4e2d\u7387\u6025\u5267\u964d\u4f4e\uff0c\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd \uff0816\uff09\u7981\u6b62\u4f7f\u7528\u5c0f\u6570\u5b58\u50a8\u8d27\u5e01 \u89e3\u8bfb\uff1a\u4f7f\u7528\u6574\u6570\u5427\uff0c\u5c0f\u6570\u5bb9\u6613\u5bfc\u81f4\u94b1\u5bf9\u4e0d\u4e0a \u6709\u4eba\u95ee\u5b58\u50a8\u524d\u4e58\u4ee5100\uff0c\u53d6\u51fa\u540e\u9664\u4ee5100\u662f\u5426\u53ef\u884c\uff0c\u4e2a\u4eba\u5efa\u8bae\u201c\u5c3d\u91cf\u5c11\u7684\u4f7f\u7528\u9664\u6cd5\u201d\u3002 \u66fe\u7ecf\u8e29\u8fc7\u8fd9\u6837\u7684\u5751\uff0c100\u5143\u52063\u5929\u644a\u9500\uff0c\u6bcf\u5929\u644a\u9500100/3\u5143\uff0c\u7ed3\u679c\u5f97\u52303\u4e2a33.33\u3002\u540e\u6765\u5b9e\u65bd\u5bf9\u8d26\u7cfb\u7edf\uff0c\u59cb\u7ec8\u6709\u51e0\u5206\u94b1\u5bf9\u4e0d\u9f50\uff0c\u90c1\u95f7\u4e86\u5f88\u4e45\uff08\u4e0d\u662f\u51e0\u5206\u94b1\u7684\u4e8b\uff0c\u662f\u4e1a\u52a1\u65b9\u8d28\u7591\u7684\u773c\u795e\u8ba9\u7814\u53d1\u5f88\u4e0d\u723d\uff09\uff0c\u6700\u540e\u53d1\u73b0\u662f\u9664\u6cd5\u60f9\u7684\u7978\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u201c\u5206\u201d\u4f5c\u4e3a\u5355\u4f4d\uff0c\u8fd9\u6837\u6570\u636e\u5e93\u91cc\u5c31\u662f\u6574\u6570\u4e86\u3002 \uff0817\uff09\u5fc5\u987b\u4f7f\u7528varchar(20)\u5b58\u50a8\u624b\u673a\u53f7 \u89e3\u8bfb\uff1a a\uff09\u6d89\u53ca\u5230\u533a\u53f7\u6216\u8005\u56fd\u5bb6\u4ee3\u53f7\uff0c\u53ef\u80fd\u51fa\u73b0+-() b\uff09\u624b\u673a\u53f7\u4f1a\u53bb\u505a\u6570\u5b66\u8fd0\u7b97\u4e48\uff1f c\uff09varchar\u53ef\u4ee5\u652f\u6301\u6a21\u7cca\u67e5\u8be2\uff0c\u4f8b\u5982\uff1alike\u201c138%\u201d \uff0818\uff09\u7981\u6b62\u4f7f\u7528ENUM\uff0c\u53ef\u4f7f\u7528TINYINT\u4ee3\u66ff \u89e3\u8bfb\uff1a a\uff09\u589e\u52a0\u65b0\u7684ENUM\u503c\u8981\u505aDDL\u64cd\u4f5c b\uff09ENUM\u7684\u5185\u90e8\u5b9e\u9645\u5b58\u50a8\u5c31\u662f\u6574\u6570\uff0c\u4f60\u4ee5\u4e3a\u81ea\u5df1\u5b9a\u4e49\u7684\u662f\u5b57\u7b26\u4e32\uff1f \u4e94\u3001\u7d22\u5f15\u8bbe\u8ba1\u89c4\u8303 \u00b6 \uff0819\uff09\u5355\u8868\u7d22\u5f15\u5efa\u8bae\u63a7\u5236\u57285\u4e2a\u4ee5\u5185 \uff0820\uff09\u5355\u7d22\u5f15\u5b57\u6bb5\u6570\u4e0d\u5141\u8bb8\u8d85\u8fc75\u4e2a \u89e3\u8bfb\uff1a\u5b57\u6bb5\u8d85\u8fc75\u4e2a\u65f6\uff0c\u5b9e\u9645\u5df2\u7ecf\u8d77\u4e0d\u5230\u6709\u6548\u8fc7\u6ee4\u6570\u636e\u7684\u4f5c\u7528\u4e86 \uff0821\uff09\u7981\u6b62\u5728\u66f4\u65b0\u5341\u5206\u9891\u7e41\u3001\u533a\u5206\u5ea6\u4e0d\u9ad8\u7684\u5c5e\u6027\u4e0a\u5efa\u7acb\u7d22\u5f15 \u89e3\u8bfb\uff1a a\uff09\u66f4\u65b0\u4f1a\u53d8\u66f4B+\u6811\uff0c\u66f4\u65b0\u9891\u7e41\u7684\u5b57\u6bb5\u5efa\u7acb\u7d22\u5f15\u4f1a\u5927\u5927\u964d\u4f4e\u6570\u636e\u5e93\u6027\u80fd b\uff09\u201c\u6027\u522b\u201d\u8fd9\u79cd\u533a\u5206\u5ea6\u4e0d\u5927\u7684\u5c5e\u6027\uff0c\u5efa\u7acb\u7d22\u5f15\u662f\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49\u7684\uff0c\u4e0d\u80fd\u6709\u6548\u8fc7\u6ee4\u6570\u636e\uff0c\u6027\u80fd\u4e0e\u5168\u8868\u626b\u63cf\u7c7b\u4f3c \uff0822\uff09\u5efa\u7acb\u7ec4\u5408\u7d22\u5f15\uff0c\u5fc5\u987b\u628a\u533a\u5206\u5ea6\u9ad8\u7684\u5b57\u6bb5\u653e\u5728\u524d\u9762 \u89e3\u8bfb\uff1a\u80fd\u591f\u66f4\u52a0\u6709\u6548\u7684\u8fc7\u6ee4\u6570\u636e \u516d\u3001SQL\u4f7f\u7528\u89c4\u8303 \u00b6 \uff0823\uff09\u7981\u6b62\u4f7f\u7528SELECT *\uff0c\u53ea\u83b7\u53d6\u5fc5\u8981\u7684\u5b57\u6bb5\uff0c\u9700\u8981\u663e\u793a\u8bf4\u660e\u5217\u5c5e\u6027 \u89e3\u8bfb\uff1a a\uff09\u8bfb\u53d6\u4e0d\u9700\u8981\u7684\u5217\u4f1a\u589e\u52a0CPU\u3001IO\u3001NET\u6d88\u8017 b\uff09\u4e0d\u80fd\u6709\u6548\u7684\u5229\u7528\u8986\u76d6\u7d22\u5f15 c\uff09\u4f7f\u7528SELECT *\u5bb9\u6613\u5728\u589e\u52a0\u6216\u8005\u5220\u9664\u5b57\u6bb5\u540e\u51fa\u73b0\u7a0b\u5e8fBUG \uff0824\uff09\u7981\u6b62\u4f7f\u7528INSERT INTO t_xxx VALUES(xxx)\uff0c\u5fc5\u987b\u663e\u793a\u6307\u5b9a\u63d2\u5165\u7684\u5217\u5c5e\u6027 \u89e3\u8bfb\uff1a\u5bb9\u6613\u5728\u589e\u52a0\u6216\u8005\u5220\u9664\u5b57\u6bb5\u540e\u51fa\u73b0\u7a0b\u5e8fBUG \uff0825\uff09\u7981\u6b62\u4f7f\u7528\u5c5e\u6027\u9690\u5f0f\u8f6c\u6362 \u89e3\u8bfb\uff1aSELECT uid FROM t_user WHERE phone=13812345678 \u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf\uff0c\u800c\u4e0d\u80fd\u547d\u4e2dphone\u7d22\u5f15\uff0c\u731c\u731c\u4e3a\u4ec0\u4e48\uff1f\uff08\u8fd9\u4e2a\u7ebf\u4e0a\u95ee\u9898\u4e0d\u6b62\u51fa\u73b0\u8fc7\u4e00\u6b21\uff09 \u89e3\u51b3\u65b9\u6848\uff1aphone\u662fvarchar\u7c7b\u578b\uff0cSQL\u8bed\u53e5\u5e26\u5165\u7684\u662f\u6574\u5f62\uff0c\u6545\u4e0d\u4f1a\u547d\u4e2d\u7d22\u5f15\uff0c\u52a0\u4e2a\u5f15\u53f7\u5c31\u597d\u4e86 SELECT uid FROM t_user WHERE phone=\u201913812345678\u2019 \uff0826\uff09\u7981\u6b62\u5728WHERE\u6761\u4ef6\u7684\u5c5e\u6027\u4e0a\u4f7f\u7528\u51fd\u6570\u6216\u8005\u8868\u8fbe\u5f0f \u89e3\u8bfb\uff1aSELECT uid FROM t_user WHERE from_unixtime(day)>='2017-02-15' \u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf \u6b63\u786e\u7684\u5199\u6cd5\u662f\uff1aSELECT uid FROM t_user WHERE day>= unix_timestamp('2017-02-15 00:00:00') \uff0827\uff09\u7981\u6b62\u8d1f\u5411\u67e5\u8be2\uff0c\u4ee5\u53ca%\u5f00\u5934\u7684\u6a21\u7cca\u67e5\u8be2 \u89e3\u8bfb\uff1a a\uff09\u8d1f\u5411\u67e5\u8be2\u6761\u4ef6\uff1aNOT\u3001!=\u3001<>\u3001!<\u3001!>\u3001NOT IN\u3001NOT LIKE\u7b49\uff0c\u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf b\uff09%\u5f00\u5934\u7684\u6a21\u7cca\u67e5\u8be2\uff0c\u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf \u4e3e\u4f8b\uff1a \u4e00\u822c\u6765\u8bf4\uff0cWHERE\u8fc7\u6ee4\u6761\u4ef6\u4e0d\u4f1a\u53ea\u5e26\u8fd9\u4e48\u4e00\u4e2a\u201c\u8d1f\u5411\u67e5\u8be2\u6761\u4ef6\u201d\uff0c\u8fd8\u4f1a\u6709\u5176\u4ed6\u8fc7\u6ee4\u6761\u4ef6\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u67e5\u8be2\u6c88\u5251\u5df2\u5b8c\u6210\u8ba2\u5355\u4e4b\u5916\u7684\u8ba2\u5355\uff08\u597d\u62d7\u53e3\uff09\uff1a SELECT oid FROM t_order WHERE uid=123 AND status != 1; \u8ba2\u5355\u88685000w\u6570\u636e\uff0c\u4f46uid=123\u5c31\u4f1a\u8fc5\u901f\u7684\u5c06\u6570\u636e\u91cf\u8fc7\u6ee4\u5230\u5f88\u5c11\u7684\u7ea7\u522b\uff08uid\u5efa\u7acb\u4e86\u7d22\u5f15\uff09\uff0c\u6b64\u65f6\u518d\u63a5\u4e0a\u4e00\u4e2a\u8d1f\u5411\u7684\u67e5\u8be2\u6761\u4ef6\u5c31\u65e0\u6240\u8c13\u4e86\uff0c\u626b\u63cf\u7684\u884c\u6570\u672c\u8eab\u5c31\u4f1a\u5f88\u5c11\u3002 \u4f46\u5982\u679c\u8981\u67e5\u8be2\u6240\u6709\u5df2\u5b8c\u6210\u8ba2\u5355\u4e4b\u5916\u7684\u8ba2\u5355\uff1a SELECT oid FROM t_order WHERE status != 1; \u8fd9\u5c31\u6302\u4e86\uff0c\u7acb\u9a6cCPU100%\uff0cstatus\u7d22\u5f15\u4f1a\u5931\u6548\uff0c\u8d1f\u5411\u67e5\u8be2\u5bfc\u81f4\u5168\u8868\u626b\u63cf\u3002 \uff0828\uff09\u7981\u6b62\u5927\u8868\u4f7f\u7528JOIN\u67e5\u8be2\uff0c\u7981\u6b62\u5927\u8868\u4f7f\u7528\u5b50\u67e5\u8be2 \u89e3\u8bfb\uff1a\u4f1a\u4ea7\u751f\u4e34\u65f6\u8868\uff0c\u6d88\u8017\u8f83\u591a\u5185\u5b58\u4e0eCPU\uff0c\u6781\u5927\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd \uff0829\uff09\u7981\u6b62\u4f7f\u7528OR\u6761\u4ef6\uff0c\u5fc5\u987b\u6539\u4e3aIN\u67e5\u8be2 \u89e3\u8bfb\uff1a\u65e7\u7248\u672cMysql\u7684OR\u67e5\u8be2\u662f\u4e0d\u80fd\u547d\u4e2d\u7d22\u5f15\u7684\uff0c\u5373\u4f7f\u80fd\u547d\u4e2d\u7d22\u5f15\uff0c\u4e3a\u4f55\u8981\u8ba9\u6570\u636e\u5e93\u8017\u8d39\u66f4\u591a\u7684CPU\u5e2e\u52a9\u5b9e\u65bd\u67e5\u8be2\u4f18\u5316\u5462\uff1f \uff0830\uff09\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u6355\u83b7SQL\u5f02\u5e38\uff0c\u5e76\u6709\u76f8\u5e94\u5904\u7406 \u603b\u7ed3\uff1a\u5927\u6570\u636e\u91cf\u9ad8\u5e76\u53d1\u7684\u4e92\u8054\u7f51\u4e1a\u52a1\uff0c\u6781\u5927\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd\u7684\u90fd\u4e0d\u8ba9\u7528\uff0c\u4e0d\u8ba9\u7528\u54df\u3002","title":"MySQL\u4e92\u8054\u7f51\u4e1a\u52a1\u6570\u636e\u5e93\u8bbe\u8ba1\u89c4\u8303"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_1","text":"\uff081\uff09\u5fc5\u987b\u4f7f\u7528InnoDB\u5b58\u50a8\u5f15\u64ce \u89e3\u8bfb\uff1a\u652f\u6301\u4e8b\u52a1\u3001\u884c\u7ea7\u9501\u3001\u5e76\u53d1\u6027\u80fd\u66f4\u597d\u3001CPU\u53ca\u5185\u5b58\u7f13\u5b58\u9875\u4f18\u5316\u4f7f\u5f97\u8d44\u6e90\u5229\u7528\u7387\u66f4\u9ad8 \uff082\uff09\u5fc5\u987b\u4f7f\u7528UTF8\u5b57\u7b26\u96c6 \u89e3\u8bfb\uff1a\u4e07\u56fd\u7801\uff0c\u65e0\u9700\u8f6c\u7801\uff0c\u65e0\u4e71\u7801\u98ce\u9669 \u5b57\u7b26\u96c6\u63a8\u8350\u4f7f\u7528utf8mb4\u5b57\u7b26\u96c6,utf8mb4\u662futf8\u7684\u8d85\u96c6\uff0cemoji\u8868\u60c5\u4ee5\u53ca\u90e8\u5206\u4e0d\u5e38\u89c1\u6c49\u5b57\u5728utf8\u4e0b\u4f1a\u8868\u73b0\u4e3a\u4e71\u7801\uff0c\u6545\u9700\u8981\u5347\u7ea7\u81f3utf8mb4\u3002 \uff083\uff09\u6570\u636e\u8868\u3001\u6570\u636e\u5b57\u6bb5\u5fc5\u987b\u52a0\u5165\u4e2d\u6587\u6ce8\u91ca \u89e3\u8bfb\uff1aN\u5e74\u540e\u8c01tm\u77e5\u9053\u8fd9\u4e2ar1,r2,r3\u5b57\u6bb5\u662f\u5e72\u561b\u7684 \uff084\uff09\u7981\u6b62\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\u3001\u89c6\u56fe\u3001\u89e6\u53d1\u5668\u3001Event \u89e3\u8bfb\uff1a\u9ad8\u5e76\u53d1\u5927\u6570\u636e\u7684\u4e92\u8054\u7f51\u4e1a\u52a1\uff0c\u67b6\u6784\u8bbe\u8ba1\u601d\u8def\u662f\u201c\u89e3\u653e\u6570\u636e\u5e93CPU\uff0c\u5c06\u8ba1\u7b97\u8f6c\u79fb\u5230\u670d\u52a1\u5c42\u201d\uff0c\u5e76\u53d1\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9b\u529f\u80fd\u5f88\u53ef\u80fd\u5c06\u6570\u636e\u5e93\u62d6\u6b7b\uff0c\u4e1a\u52a1\u903b\u8f91\u653e\u5230\u670d\u52a1\u5c42\u5177\u5907\u66f4\u597d\u7684\u6269\u5c55\u6027\uff0c\u80fd\u591f\u8f7b\u6613\u5b9e\u73b0\u201c\u589e\u673a\u5668\u5c31\u52a0\u6027\u80fd\u201d\u3002\u6570\u636e\u5e93\u64c5\u957f\u5b58\u50a8\u4e0e\u7d22\u5f15\uff0cCPU\u8ba1\u7b97\u8fd8\u662f\u4e0a\u79fb\u5427 \uff085\uff09\u7981\u6b62\u5b58\u50a8\u5927\u6587\u4ef6\u6216\u8005\u5927\u7167\u7247 \u89e3\u8bfb\uff1a\u4e3a\u4f55\u8981\u8ba9\u6570\u636e\u5e93\u505a\u5b83\u4e0d\u64c5\u957f\u7684\u4e8b\u60c5\uff1f\u5927\u6587\u4ef6\u548c\u7167\u7247\u5b58\u50a8\u5728\u6587\u4ef6\u7cfb\u7edf\uff0c\u6570\u636e\u5e93\u91cc\u5b58URI\u591a\u597d","title":"\u4e00\u3001\u57fa\u7840\u89c4\u8303"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_2","text":"\uff086\uff09\u53ea\u5141\u8bb8\u4f7f\u7528\u5185\u7f51\u57df\u540d\uff0c\u800c\u4e0d\u662fip\u8fde\u63a5\u6570\u636e\u5e93 \u89e3\u8bfb\uff1a\u4e0d\u53ea\u662f\u6570\u636e\u5e93\uff0c\u7f13\u5b58\uff08memcache\u3001redis\uff09\u7684\u8fde\u63a5\uff0c\u670d\u52a1\uff08service\uff09\u7684\u8fde\u63a5\u90fd\u5fc5\u987b\u4f7f\u7528\u5185\u7f51\u57df\u540d\uff0c\u673a\u5668\u8fc1\u79fb/\u5e73\u6ed1\u5347\u7ea7/\u8fd0\u7ef4\u7ba1\u7406\u2026\u592a\u591a\u592a\u591a\u7684\u597d\u5904\u3002 \uff087\uff09\u7ebf\u4e0a\u73af\u5883\u3001\u5f00\u53d1\u73af\u5883\u3001\u6d4b\u8bd5\u73af\u5883\u6570\u636e\u5e93\u5185\u7f51\u57df\u540d\u9075\u5faa\u547d\u540d\u89c4\u8303 \u4e1a\u52a1\u540d\u79f0\uff1axxx \u7ebf\u4e0a\u73af\u5883\uff1axxx.db \u5f00\u53d1\u73af\u5883\uff1axxx.rdb \u6d4b\u8bd5\u73af\u5883\uff1axxx.tdb \u4ece\u5e93\u5728\u540d\u79f0\u540e\u52a0-s\u6807\u8bc6\uff0c\u5907\u5e93\u5728\u540d\u79f0\u540e\u52a0-ss\u6807\u8bc6 \u7ebf\u4e0a\u4ece\u5e93\uff1axxx-s.db \u7ebf\u4e0a\u5907\u5e93\uff1axxx-sss.db \uff088\uff09\u5e93\u540d\u3001\u8868\u540d\u3001\u5b57\u6bb5\u540d\uff1a\u5c0f\u5199\uff0c\u4e0b\u5212\u7ebf\u98ce\u683c\uff0c\u4e0d\u8d85\u8fc732\u4e2a\u5b57\u7b26\uff0c\u5fc5\u987b\u89c1\u540d\u77e5\u610f\uff0c\u7981\u6b62\u62fc\u97f3\u82f1\u6587\u6df7\u7528 \uff089\uff09\u8868\u540dt_xxx\uff0c\u975e\u552f\u4e00\u7d22\u5f15\u540didx_xxx\uff0c\u552f\u4e00\u7d22\u5f15\u540duniq_xxx","title":"\u4e8c\u3001\u547d\u540d\u89c4\u8303"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_3","text":"\uff0810\uff09\u5355\u5b9e\u4f8b\u8868\u6570\u76ee\u5fc5\u987b\u5c0f\u4e8e500 \uff0811\uff09\u5355\u8868\u5217\u6570\u76ee\u5fc5\u987b\u5c0f\u4e8e30 \uff0812\uff09\u8868\u5fc5\u987b\u6709\u4e3b\u952e\uff0c\u4f8b\u5982\u81ea\u589e\u4e3b\u952e \u89e3\u8bfb\uff1a a\uff09\u4e3b\u952e\u9012\u589e\uff0c\u6570\u636e\u884c\u5199\u5165\u53ef\u4ee5\u63d0\u9ad8\u63d2\u5165\u6027\u80fd\uff0c\u53ef\u4ee5\u907f\u514dpage\u5206\u88c2\uff0c\u51cf\u5c11\u8868\u788e\u7247\u63d0\u5347\u7a7a\u95f4\u548c\u5185\u5b58\u7684\u4f7f\u7528 b\uff09\u4e3b\u952e\u8981\u9009\u62e9\u8f83\u77ed\u7684\u6570\u636e\u7c7b\u578b\uff0c Innodb\u5f15\u64ce\u666e\u901a\u7d22\u5f15\u90fd\u4f1a\u4fdd\u5b58\u4e3b\u952e\u7684\u503c\uff0c\u8f83\u77ed\u7684\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u6709\u6548\u7684\u51cf\u5c11\u7d22\u5f15\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u63d0\u9ad8\u7d22\u5f15\u7684\u7f13\u5b58\u6548\u7387 c\uff09 \u65e0\u4e3b\u952e\u7684\u8868\u5220\u9664\uff0c\u5728row\u6a21\u5f0f\u7684\u4e3b\u4ece\u67b6\u6784\uff0c\u4f1a\u5bfc\u81f4\u5907\u5e93\u592f\u4f4f \uff0813\uff09\u7981\u6b62\u4f7f\u7528\u5916\u952e\uff0c\u5982\u679c\u6709\u5916\u952e\u5b8c\u6574\u6027\u7ea6\u675f\uff0c\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236 \u89e3\u8bfb\uff1a\u5916\u952e\u4f1a\u5bfc\u81f4\u8868\u4e0e\u8868\u4e4b\u95f4\u8026\u5408\uff0cupdate\u4e0edelete\u64cd\u4f5c\u90fd\u4f1a\u6d89\u53ca\u76f8\u5173\u8054\u7684\u8868\uff0c\u5341\u5206\u5f71\u54cdsql \u7684\u6027\u80fd\uff0c\u751a\u81f3\u4f1a\u9020\u6210\u6b7b\u9501\u3002\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\u5bb9\u6613\u9020\u6210\u6570\u636e\u5e93\u6027\u80fd\uff0c\u5927\u6570\u636e\u9ad8\u5e76\u53d1\u4e1a\u52a1\u573a\u666f\u6570\u636e\u5e93\u4f7f\u7528\u4ee5\u6027\u80fd\u4f18\u5148","title":"\u4e09\u3001\u8868\u8bbe\u8ba1\u89c4\u8303"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_4","text":"\uff0814\uff09\u5fc5\u987b\u628a\u5b57\u6bb5\u5b9a\u4e49\u4e3aNOT NULL\u5e76\u4e14\u63d0\u4f9b\u9ed8\u8ba4\u503c \u89e3\u8bfb\uff1a a\uff09null\u7684\u5217\u4f7f\u7d22\u5f15/\u7d22\u5f15\u7edf\u8ba1/\u503c\u6bd4\u8f83\u90fd\u66f4\u52a0\u590d\u6742\uff0c\u5bf9MySQL\u6765\u8bf4\u66f4\u96be\u4f18\u5316 b\uff09null \u8fd9\u79cd\u7c7b\u578bMySQL\u5185\u90e8\u9700\u8981\u8fdb\u884c\u7279\u6b8a\u5904\u7406\uff0c\u589e\u52a0\u6570\u636e\u5e93\u5904\u7406\u8bb0\u5f55\u7684\u590d\u6742\u6027\uff1b\u540c\u7b49\u6761\u4ef6\u4e0b\uff0c\u8868\u4e2d\u6709\u8f83\u591a\u7a7a\u5b57\u6bb5\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u7684\u5904\u7406\u6027\u80fd\u4f1a\u964d\u4f4e\u5f88\u591a c\uff09null\u503c\u9700\u8981\u66f4\u591a\u7684\u5b58\u50a8\u7a7a\uff0c\u65e0\u8bba\u662f\u8868\u8fd8\u662f\u7d22\u5f15\u4e2d\u6bcf\u884c\u4e2d\u7684null\u7684\u5217\u90fd\u9700\u8981\u989d\u5916\u7684\u7a7a\u95f4\u6765\u6807\u8bc6 d\uff09\u5bf9null \u7684\u5904\u7406\u65f6\u5019\uff0c\u53ea\u80fd\u91c7\u7528is null\u6216is not null\uff0c\u800c\u4e0d\u80fd\u91c7\u7528=\u3001in\u3001<\u3001<>\u3001!=\u3001not in\u8fd9\u4e9b\u64cd\u4f5c\u7b26\u53f7\u3002\u5982\uff1awhere name!=\u2019shenjian\u2019\uff0c\u5982\u679c\u5b58\u5728name\u4e3anull\u503c\u7684\u8bb0\u5f55\uff0c\u67e5\u8be2\u7ed3\u679c\u5c31\u4e0d\u4f1a\u5305\u542bname\u4e3anull\u503c\u7684\u8bb0\u5f55 \uff0815\uff09\u7981\u6b62\u4f7f\u7528TEXT\u3001BLOB\u7c7b\u578b \u89e3\u8bfb\uff1a\u4f1a\u6d6a\u8d39\u66f4\u591a\u7684\u78c1\u76d8\u548c\u5185\u5b58\u7a7a\u95f4\uff0c\u975e\u5fc5\u8981\u7684\u5927\u91cf\u7684\u5927\u5b57\u6bb5\u67e5\u8be2\u4f1a\u6dd8\u6c70\u6389\u70ed\u6570\u636e\uff0c\u5bfc\u81f4\u5185\u5b58\u547d\u4e2d\u7387\u6025\u5267\u964d\u4f4e\uff0c\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd \uff0816\uff09\u7981\u6b62\u4f7f\u7528\u5c0f\u6570\u5b58\u50a8\u8d27\u5e01 \u89e3\u8bfb\uff1a\u4f7f\u7528\u6574\u6570\u5427\uff0c\u5c0f\u6570\u5bb9\u6613\u5bfc\u81f4\u94b1\u5bf9\u4e0d\u4e0a \u6709\u4eba\u95ee\u5b58\u50a8\u524d\u4e58\u4ee5100\uff0c\u53d6\u51fa\u540e\u9664\u4ee5100\u662f\u5426\u53ef\u884c\uff0c\u4e2a\u4eba\u5efa\u8bae\u201c\u5c3d\u91cf\u5c11\u7684\u4f7f\u7528\u9664\u6cd5\u201d\u3002 \u66fe\u7ecf\u8e29\u8fc7\u8fd9\u6837\u7684\u5751\uff0c100\u5143\u52063\u5929\u644a\u9500\uff0c\u6bcf\u5929\u644a\u9500100/3\u5143\uff0c\u7ed3\u679c\u5f97\u52303\u4e2a33.33\u3002\u540e\u6765\u5b9e\u65bd\u5bf9\u8d26\u7cfb\u7edf\uff0c\u59cb\u7ec8\u6709\u51e0\u5206\u94b1\u5bf9\u4e0d\u9f50\uff0c\u90c1\u95f7\u4e86\u5f88\u4e45\uff08\u4e0d\u662f\u51e0\u5206\u94b1\u7684\u4e8b\uff0c\u662f\u4e1a\u52a1\u65b9\u8d28\u7591\u7684\u773c\u795e\u8ba9\u7814\u53d1\u5f88\u4e0d\u723d\uff09\uff0c\u6700\u540e\u53d1\u73b0\u662f\u9664\u6cd5\u60f9\u7684\u7978\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u201c\u5206\u201d\u4f5c\u4e3a\u5355\u4f4d\uff0c\u8fd9\u6837\u6570\u636e\u5e93\u91cc\u5c31\u662f\u6574\u6570\u4e86\u3002 \uff0817\uff09\u5fc5\u987b\u4f7f\u7528varchar(20)\u5b58\u50a8\u624b\u673a\u53f7 \u89e3\u8bfb\uff1a a\uff09\u6d89\u53ca\u5230\u533a\u53f7\u6216\u8005\u56fd\u5bb6\u4ee3\u53f7\uff0c\u53ef\u80fd\u51fa\u73b0+-() b\uff09\u624b\u673a\u53f7\u4f1a\u53bb\u505a\u6570\u5b66\u8fd0\u7b97\u4e48\uff1f c\uff09varchar\u53ef\u4ee5\u652f\u6301\u6a21\u7cca\u67e5\u8be2\uff0c\u4f8b\u5982\uff1alike\u201c138%\u201d \uff0818\uff09\u7981\u6b62\u4f7f\u7528ENUM\uff0c\u53ef\u4f7f\u7528TINYINT\u4ee3\u66ff \u89e3\u8bfb\uff1a a\uff09\u589e\u52a0\u65b0\u7684ENUM\u503c\u8981\u505aDDL\u64cd\u4f5c b\uff09ENUM\u7684\u5185\u90e8\u5b9e\u9645\u5b58\u50a8\u5c31\u662f\u6574\u6570\uff0c\u4f60\u4ee5\u4e3a\u81ea\u5df1\u5b9a\u4e49\u7684\u662f\u5b57\u7b26\u4e32\uff1f","title":"\u56db\u3001\u5b57\u6bb5\u8bbe\u8ba1\u89c4\u8303"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_5","text":"\uff0819\uff09\u5355\u8868\u7d22\u5f15\u5efa\u8bae\u63a7\u5236\u57285\u4e2a\u4ee5\u5185 \uff0820\uff09\u5355\u7d22\u5f15\u5b57\u6bb5\u6570\u4e0d\u5141\u8bb8\u8d85\u8fc75\u4e2a \u89e3\u8bfb\uff1a\u5b57\u6bb5\u8d85\u8fc75\u4e2a\u65f6\uff0c\u5b9e\u9645\u5df2\u7ecf\u8d77\u4e0d\u5230\u6709\u6548\u8fc7\u6ee4\u6570\u636e\u7684\u4f5c\u7528\u4e86 \uff0821\uff09\u7981\u6b62\u5728\u66f4\u65b0\u5341\u5206\u9891\u7e41\u3001\u533a\u5206\u5ea6\u4e0d\u9ad8\u7684\u5c5e\u6027\u4e0a\u5efa\u7acb\u7d22\u5f15 \u89e3\u8bfb\uff1a a\uff09\u66f4\u65b0\u4f1a\u53d8\u66f4B+\u6811\uff0c\u66f4\u65b0\u9891\u7e41\u7684\u5b57\u6bb5\u5efa\u7acb\u7d22\u5f15\u4f1a\u5927\u5927\u964d\u4f4e\u6570\u636e\u5e93\u6027\u80fd b\uff09\u201c\u6027\u522b\u201d\u8fd9\u79cd\u533a\u5206\u5ea6\u4e0d\u5927\u7684\u5c5e\u6027\uff0c\u5efa\u7acb\u7d22\u5f15\u662f\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49\u7684\uff0c\u4e0d\u80fd\u6709\u6548\u8fc7\u6ee4\u6570\u636e\uff0c\u6027\u80fd\u4e0e\u5168\u8868\u626b\u63cf\u7c7b\u4f3c \uff0822\uff09\u5efa\u7acb\u7ec4\u5408\u7d22\u5f15\uff0c\u5fc5\u987b\u628a\u533a\u5206\u5ea6\u9ad8\u7684\u5b57\u6bb5\u653e\u5728\u524d\u9762 \u89e3\u8bfb\uff1a\u80fd\u591f\u66f4\u52a0\u6709\u6548\u7684\u8fc7\u6ee4\u6570\u636e","title":"\u4e94\u3001\u7d22\u5f15\u8bbe\u8ba1\u89c4\u8303"},{"location":"other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#sql","text":"\uff0823\uff09\u7981\u6b62\u4f7f\u7528SELECT *\uff0c\u53ea\u83b7\u53d6\u5fc5\u8981\u7684\u5b57\u6bb5\uff0c\u9700\u8981\u663e\u793a\u8bf4\u660e\u5217\u5c5e\u6027 \u89e3\u8bfb\uff1a a\uff09\u8bfb\u53d6\u4e0d\u9700\u8981\u7684\u5217\u4f1a\u589e\u52a0CPU\u3001IO\u3001NET\u6d88\u8017 b\uff09\u4e0d\u80fd\u6709\u6548\u7684\u5229\u7528\u8986\u76d6\u7d22\u5f15 c\uff09\u4f7f\u7528SELECT *\u5bb9\u6613\u5728\u589e\u52a0\u6216\u8005\u5220\u9664\u5b57\u6bb5\u540e\u51fa\u73b0\u7a0b\u5e8fBUG \uff0824\uff09\u7981\u6b62\u4f7f\u7528INSERT INTO t_xxx VALUES(xxx)\uff0c\u5fc5\u987b\u663e\u793a\u6307\u5b9a\u63d2\u5165\u7684\u5217\u5c5e\u6027 \u89e3\u8bfb\uff1a\u5bb9\u6613\u5728\u589e\u52a0\u6216\u8005\u5220\u9664\u5b57\u6bb5\u540e\u51fa\u73b0\u7a0b\u5e8fBUG \uff0825\uff09\u7981\u6b62\u4f7f\u7528\u5c5e\u6027\u9690\u5f0f\u8f6c\u6362 \u89e3\u8bfb\uff1aSELECT uid FROM t_user WHERE phone=13812345678 \u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf\uff0c\u800c\u4e0d\u80fd\u547d\u4e2dphone\u7d22\u5f15\uff0c\u731c\u731c\u4e3a\u4ec0\u4e48\uff1f\uff08\u8fd9\u4e2a\u7ebf\u4e0a\u95ee\u9898\u4e0d\u6b62\u51fa\u73b0\u8fc7\u4e00\u6b21\uff09 \u89e3\u51b3\u65b9\u6848\uff1aphone\u662fvarchar\u7c7b\u578b\uff0cSQL\u8bed\u53e5\u5e26\u5165\u7684\u662f\u6574\u5f62\uff0c\u6545\u4e0d\u4f1a\u547d\u4e2d\u7d22\u5f15\uff0c\u52a0\u4e2a\u5f15\u53f7\u5c31\u597d\u4e86 SELECT uid FROM t_user WHERE phone=\u201913812345678\u2019 \uff0826\uff09\u7981\u6b62\u5728WHERE\u6761\u4ef6\u7684\u5c5e\u6027\u4e0a\u4f7f\u7528\u51fd\u6570\u6216\u8005\u8868\u8fbe\u5f0f \u89e3\u8bfb\uff1aSELECT uid FROM t_user WHERE from_unixtime(day)>='2017-02-15' \u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf \u6b63\u786e\u7684\u5199\u6cd5\u662f\uff1aSELECT uid FROM t_user WHERE day>= unix_timestamp('2017-02-15 00:00:00') \uff0827\uff09\u7981\u6b62\u8d1f\u5411\u67e5\u8be2\uff0c\u4ee5\u53ca%\u5f00\u5934\u7684\u6a21\u7cca\u67e5\u8be2 \u89e3\u8bfb\uff1a a\uff09\u8d1f\u5411\u67e5\u8be2\u6761\u4ef6\uff1aNOT\u3001!=\u3001<>\u3001!<\u3001!>\u3001NOT IN\u3001NOT LIKE\u7b49\uff0c\u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf b\uff09%\u5f00\u5934\u7684\u6a21\u7cca\u67e5\u8be2\uff0c\u4f1a\u5bfc\u81f4\u5168\u8868\u626b\u63cf \u4e3e\u4f8b\uff1a \u4e00\u822c\u6765\u8bf4\uff0cWHERE\u8fc7\u6ee4\u6761\u4ef6\u4e0d\u4f1a\u53ea\u5e26\u8fd9\u4e48\u4e00\u4e2a\u201c\u8d1f\u5411\u67e5\u8be2\u6761\u4ef6\u201d\uff0c\u8fd8\u4f1a\u6709\u5176\u4ed6\u8fc7\u6ee4\u6761\u4ef6\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u67e5\u8be2\u6c88\u5251\u5df2\u5b8c\u6210\u8ba2\u5355\u4e4b\u5916\u7684\u8ba2\u5355\uff08\u597d\u62d7\u53e3\uff09\uff1a SELECT oid FROM t_order WHERE uid=123 AND status != 1; \u8ba2\u5355\u88685000w\u6570\u636e\uff0c\u4f46uid=123\u5c31\u4f1a\u8fc5\u901f\u7684\u5c06\u6570\u636e\u91cf\u8fc7\u6ee4\u5230\u5f88\u5c11\u7684\u7ea7\u522b\uff08uid\u5efa\u7acb\u4e86\u7d22\u5f15\uff09\uff0c\u6b64\u65f6\u518d\u63a5\u4e0a\u4e00\u4e2a\u8d1f\u5411\u7684\u67e5\u8be2\u6761\u4ef6\u5c31\u65e0\u6240\u8c13\u4e86\uff0c\u626b\u63cf\u7684\u884c\u6570\u672c\u8eab\u5c31\u4f1a\u5f88\u5c11\u3002 \u4f46\u5982\u679c\u8981\u67e5\u8be2\u6240\u6709\u5df2\u5b8c\u6210\u8ba2\u5355\u4e4b\u5916\u7684\u8ba2\u5355\uff1a SELECT oid FROM t_order WHERE status != 1; \u8fd9\u5c31\u6302\u4e86\uff0c\u7acb\u9a6cCPU100%\uff0cstatus\u7d22\u5f15\u4f1a\u5931\u6548\uff0c\u8d1f\u5411\u67e5\u8be2\u5bfc\u81f4\u5168\u8868\u626b\u63cf\u3002 \uff0828\uff09\u7981\u6b62\u5927\u8868\u4f7f\u7528JOIN\u67e5\u8be2\uff0c\u7981\u6b62\u5927\u8868\u4f7f\u7528\u5b50\u67e5\u8be2 \u89e3\u8bfb\uff1a\u4f1a\u4ea7\u751f\u4e34\u65f6\u8868\uff0c\u6d88\u8017\u8f83\u591a\u5185\u5b58\u4e0eCPU\uff0c\u6781\u5927\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd \uff0829\uff09\u7981\u6b62\u4f7f\u7528OR\u6761\u4ef6\uff0c\u5fc5\u987b\u6539\u4e3aIN\u67e5\u8be2 \u89e3\u8bfb\uff1a\u65e7\u7248\u672cMysql\u7684OR\u67e5\u8be2\u662f\u4e0d\u80fd\u547d\u4e2d\u7d22\u5f15\u7684\uff0c\u5373\u4f7f\u80fd\u547d\u4e2d\u7d22\u5f15\uff0c\u4e3a\u4f55\u8981\u8ba9\u6570\u636e\u5e93\u8017\u8d39\u66f4\u591a\u7684CPU\u5e2e\u52a9\u5b9e\u65bd\u67e5\u8be2\u4f18\u5316\u5462\uff1f \uff0830\uff09\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u6355\u83b7SQL\u5f02\u5e38\uff0c\u5e76\u6709\u76f8\u5e94\u5904\u7406 \u603b\u7ed3\uff1a\u5927\u6570\u636e\u91cf\u9ad8\u5e76\u53d1\u7684\u4e92\u8054\u7f51\u4e1a\u52a1\uff0c\u6781\u5927\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd\u7684\u90fd\u4e0d\u8ba9\u7528\uff0c\u4e0d\u8ba9\u7528\u54df\u3002","title":"\u516d\u3001SQL\u4f7f\u7528\u89c4\u8303"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/","tags":"[\u6570\u636e\u5e93\u8bbe\u8ba1]","text":"\u4e00\u3001\u547d\u540d\u89c4\u8303 \u00b6 [\u6570\u636e\u5e93\u73af\u5883\u4ecb\u7ecd] \u00b6 \u901a\u5e38\u6765\u8bb2\uff0c\u5404\u4e2a\u4e92\u8054\u7f51\u516c\u53f8\u7684\u6570\u636e\u5e93\u5206\u4e3a5\u4e2a\u6570\u636e\u5e93\u73af\u5883\uff1a dev : \u5f00\u53d1\u73af\u5883, \u5f00\u53d1\u53ef\u8bfb\u5199,\u53ef\u4fee\u6539\u8868\u7ed3\u6784; \u5e38\u7528\u7684163\u7684\u6570\u636e\u5e93\u8868; \u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4fee\u6539\u8868\u7ed3\u6784, \u53ef\u4ee5\u968f\u610f\u4fee\u6539\u5176\u4e2d\u7684\u6570\u636e; \u4f46\u662f\u9700\u8981\u4fdd\u8bc1\u4e0d\u5f71\u54cd\u5176\u4ed6\u5f00\u53d1\u540c\u4e8b; qa : \u6d4b\u8bd5\u73af\u5883, \u5f00\u53d1\u53ef\u8bfb\u5199, \u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u901a\u8fc7\u5de5\u5177\u4fee\u6539\u8868\u7ed3\u6784; sim: \u6a21\u62df\u73af\u5883, \u5f00\u53d1\u53ef\u8bfb\u5199, \u901a\u8fc7web\u5e73\u53f0;\u53d1\u8d77\u4e0a\u7ebf\u8bf7\u6c42\u65f6\uff0c\u4f1a\u5148\u5728\u8fd9\u4e2a\u73af\u5883\u4e0a\u8fdb\u884c\u9884\u6267\u884c\uff0c \u8fd9\u4e2a\u73af\u5883\u4e5f\u53ef\u4f9b\u90e8\u7f72\u4e0a\u7ebf\u6f14\u7ec3\u6216\u538b\u529b\u6d4b\u8bd5\u4f7f\u7528 \u53ef\u4ee5\u8bfb\u5199; real: \u751f\u4ea7\u6570\u636e\u5e93\u4ece\u5e93\uff08\u51c6\u5b9e\u65f6\u540c\u6b65\uff09,\u53ea\u8bfb\u73af\u5883,\u4e0d\u5141\u8bb8\u4fee\u6539\u6570\u636e,\u4e0d\u5141\u8bb8\u4fee\u6539\u8868\u7ed3\u6784; \u4f9b\u7ebf\u4e0a\u95ee\u9898\u67e5\u627e,\u6570\u636e\u67e5\u8be2\u7b49\u4f7f\u7528; online: \u7ebf\u4e0a\u73af\u5883;\u5f00\u53d1\u4eba\u5458\u4e0d\u5141\u8bb8\u76f4\u63a5\u5728\u7ebf\u4e0a\u73af\u5883\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c,\u5982\u679c\u9700\u8981\u64cd\u4f5c\u5fc5\u987b\u627eDBA\u8fdb\u884c\u64cd\u4f5c\u5e76\u8fdb\u884c\u76f8\u5e94\u8bb0\u5f55; \u8fd9\u4e9b\u73af\u5883\u7684\u673a\u5668\uff0c\u4e00\u5b9a\u8981\u505a\u5230\u6743\u9650\u5212\u5206\u660e\u786e\uff0c\u8bfb\u5199\u5e10\u53f7\u5206\u79bb\uff0c\u5e76\u4e14\u6709\u8fa8\u8bc6\u5ea6\uff0c\u80fd\u533a\u5206\u5177\u4f53\u4e1a\u52a1\u3002\u4f8b\u5982\u7528\u6237\u540dw_wap, r_wap \u80fd\u770b\u51fa\u6765\uff0c\u8bfb\u5199\u5e10\u53f7\u662fwap\u5e94\u7528\u7684\u3002 [\u6570\u636e\u5e93\u547d\u540d\u89c4\u8303] \u00b6 \u5c3d\u91cf\u7b80\u6d01\u660e\u4e49\uff0c\u80fd\u591f\u4e00\u773c\u770b\u51fa\u6765\u8fd9\u4e2a\u6570\u636e\u5e93\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\uff1b \u4f7f\u7528\u540d\u8bcd\u4f5c\u4e3a\u6570\u636e\u5e93\u540d\u79f0\uff0c\u5e76\u4e14\u53ea\u7528\u82f1\u6587\uff0c\u4e0d\u7528\u4e2d\u6587\u62fc\u97f3\uff1b \u4f7f\u7528\u82f1\u6587\u5b57\u6bcd\uff0c\u5168\u90e8\u5c0f\u5199\uff0c\u63a7\u5236\u57283-7\u4e2a\u5b57\u6bcd\u4ee5\u5185\uff1b \u5982\u679c\u6709\u591a\u4e2a\u5355\u8bcd\uff0c\u5219\u4f7f\u7528\u4e0b\u5212\u7ebf\u9694\u5f00\uff0c\u4e0d\u5efa\u4e49\u9a7c\u5cf0\u547d\u540d\uff1b \u4f8b\u5982\uff0c\u6bcf\u4e2a\u516c\u53f8\u90fd\u6709crm\u4e1a\u52a1\uff0c\u90a3\u5c31\u53eb\u505axx_crm, \u5b57\u7b26\u96c6\u7edf\u4e00utf8\u3002\u5b57\u7b26\u96c6\u8e29\u8fc7\u7684\u5751\u5f88\u591a\uff0c\u4e3a\u4e86\u901a\u7528\u6027\u7edf\u4e00utf8\u3002 create database xx_crm default character set = utf8 ; [\u8868\u547d\u540d\u89c4\u8303] \u00b6 \u5177\u5907\u7edf\u4e00\u524d\u7f00\uff0c\u5bf9\u76f8\u5173\u529f\u80fd\u7684\u8868\u5e94\u5f53\u4f7f\u7528\u76f8\u540c\u524d\u7f00\uff0c\u5982acl_xxx\uff0chouse_xxx,ppc_xxx\uff1b\u5176\u4e2d\u524d\u7f00\u901a\u5e38\u4e3a\u8fd9\u4e2a\u8868\u7684\u6a21\u5757\u6216\u4f9d\u8d56\u4e3b\u5b9e\u4f53\u5bf9\u8c61\u7684\u540d\u5b57\uff0c\u901a\u5e38\u6765\u8bb2\u8868\u540d\u4e3a\uff1a\u4e1a\u52a1_\u52a8\u4f5c_\u7c7b\u578b\uff0c\u6216\u662f\u4e1a\u52a1_\u7c7b\u578b\uff1b \u8868\u540d\u4f7f\u7528\u82f1\u6587\u5c0f\u5199\u5355\u8bcd\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5355\u8bcd\u5219\u4f7f\u7528\u4e0b\u5212\u7ebf\u9694\u5f00\uff1b 3.\u8868\u540d\u7b80\u4ecb\uff0c\u4f7f\u7528\u5e38\u89c1\u5355\u8bcd\uff0c\u907f\u514d\u4f7f\u7528\u957f\u5355\u8bcd\u548c\u751f\u50fb\u8bcd\uff1b \u8868\u5f15\u64ce\u53d6\u51b3\u4e8e\u5b9e\u9645\u5e94\u7528\u573a\u666f\u53ca\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u7684\u5df2\u7ecf\u5b58\u5728\u7684\u5b58\u50a8\u5f15\u64ce\uff1b\u65e5\u5fd7\u53ca\u62a5\u8868\u7c7b\u8868\u5efa\u8bae\u7528myisam\uff0c\u4e0e\u4ea4\u6613\uff0c\u5ba1\u6838\uff0c\u91d1\u989d\u76f8\u5173\u7684\u8868\u5efa\u8bae\u7528innodb\u5f15\u64ce\u3002\u603b\u4f53\u6765\u8bb2\u6570\u636e\u5e93\u9ed8\u8ba4innodb\uff1b \u6570\u636e\u8868\u5fc5\u987b\u6709\u4e3b\u952e\uff0c\u4e14\u5efa\u8bae\u5747\u4f7f\u7528auto_increment\u7684id\u4f5c\u4e3a\u4e3b\u952e\uff08\u4e0e\u4e1a\u52a1\u65e0\u5173\uff09,\u548c\u4e1a\u52a1\u76f8\u5173\u7684\u8981\u505a\u4e3a\u552f\u4e00\u7d22\u5f15\uff1b \u9ed8\u8ba4\u4f7f\u7528utf8\u5b57\u7b26\u96c6\uff08\u7531\u4e8e\u6570\u636e\u5e93\u5b9a\u4e49\u4f7f\u7528\u4e86\u9ed8\u8ba4\uff0c\u6570\u636e\u8868\u53ef\u4ee5\u4e0d\u518d\u5b9a\u4e49\uff0c\u4f46\u4e3a\u4fdd\u9669\u8d77\u89c1\uff0c\u5efa\u8bae\u90fd\u5199\u4e0a\uff09\uff1b \u6240\u6709\u7684\u8868\u90fd\u5fc5\u987b\u6709\u5907\u6ce8\uff0c\u5199\u660e\u767d\u8fd9\u4e2a\u8868\u4e2d\u5b58\u653e\u7684\u6570\u636e\u5185\u5bb9\uff1b \u9884\u4f30\u8868\u6570\u636e\u91cf\uff0c\u5982\u679c\u6570\u636e\u91cf\u8f83\u5927\uff08\u8d85\u8fc7500w\uff09\u5219\u9700\u8981\u8003\u8651\u5206\u8868\u7b56\u7565\u3002\u53ef\u4ee5\u7b49\u91cf\u5747\u8861\u5206\u8868\u6216\u6839\u636e\u4e1a\u52a1\u89c4\u5219\u5206\u8868\u5747\u53ef\u3002\u8981\u5206\u8868\u7684\u6570\u636e\u8868\u5fc5\u987b\u4e0eDBA\u5546\u91cf\u5206\u8868\u7b56\u7565\uff1b \u804c\u8d23\u76f8\u8fd1\u7684\u8868\uff0c\u547d\u540d\u89c4\u5219\u5e94\u8be5\u76f8\u540c\uff1b\u5982\u5408\u540c\u7533\u8bf7\uff0c\u8d26\u6237\u4fe1\u606f\uff0c\u4ea4\u53cb\u76f8\u5173\u7b49\uff1b \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e00\u5f20\u5728\u7ebf\u51b2\u503c\u8bb0\u5f55\u8868\uff1auser_bank_deposit \u8fd9\u4e2a\u5c31\u975e\u5e38\u7b26\u5408\u6807\u51c6\uff0c\u5982\u679c\u53eb\u505auserBankDeposit\u6216\u662fuser_chongzhi\uff0c\u5c31\u975e\u5e38\u4e0d\u53cb\u597d\u3002 CREATE TABLE ` house_refresh_log ` ( ` id ` int ( 11 ) NOT NULL AUTO_INCREMENT COMMENT '\u81ea\u589eID' , ` fangid ` int ( 11 ) NOT NULL COMMENT '\u623f\u8d34\u5b50ID' , ` refresh_time ` int ( 11 ) NOT NULL COMMENT '\u5237\u65b0\u65f6\u95f4' , PRIMARY KEY ( ` id ` ) , UNIQUE KEY ` fangid ` ( ` fangid ` ) ) ENGINE = InnoDB DEFAULT CHARSET = utf8 COMMENT = '\u623f\u5237\u65b0\u8bb0\u5f55\u8868' [\u5b57\u6bb5\u547d\u540d\u89c4\u8303] \u00b6 \u6570\u636e\u5e93\u5b57\u6bb5\u547d\u540d\u4e0e\u8868\u540d\u547d\u540d\u7c7b\u4f3c\uff1a \u4f7f\u7528\u5c0f\u5199\u82f1\u6587\u5355\u8bcd\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5355\u8bcd\u4f7f\u7528\u4e0b\u5212\u7ebf\u9694\u5f00\uff1b \u4f7f\u7528\u7b80\u5355\u5355\u8bcd\uff0c\u907f\u514d\u751f\u50fb\u8bcd\uff1b \u5b57\u6bb5\u5e94\u5f53\u6709\u6ce8\u91ca\uff0c\u63cf\u8ff0\u8be5\u5b57\u6bb5\u7684\u7528\u9014\u53ca\u53ef\u80fd\u5b58\u50a8\u7684\u5185\u5bb9\uff0c\u5982\u679a\u4e3e\u503c\u5219\u5efa\u8bae\u5c06\u8be5\u5b57\u6bb5\u4e2d\u4f7f\u7528\u7684\u5185\u5bb9\u90fd\u5b9a\u4e49\u51fa\u6765\uff1b \u662f\u522b\u7684\u8868\u7684\u5916\u952e\u5747\u4f7f\u7528xxx_id\u7684\u65b9\u5f0f\u6765\u8868\u660e\uff1b \u8868\u7684\u4e3b\u952e\u4e00\u822c\u90fd\u7ea6\u5b9a\u6210\u4e3aid\uff0c\u81ea\u589e\u7c7b\u578b\uff1b \u65f6\u95f4\u5b57\u6bb5\uff0c\u9664\u7279\u6b8a\u60c5\u51b5\u4e00\u5f8b\u91c7\u7528int\u6765\u8bb0\u5f55unix_timestamp\uff1b \u7f51\u7edcIP\u5b57\u6bb5\uff0c\u9664\u7279\u6b8a\u60c5\u51b5\u4e00\u5f8b\u7528bigint\u6765\u8bb0\u5f55inet_aton\u503c\uff1b \u6240\u6709\u5b57\u6bb5\uff0c\u5747\u4e3a\u975e\u7a7a\uff0c\u6700\u597d\u663e\u793a\u6307\u5b9a\u9ed8\u8ba4\u503c\uff1b \u6709\u4e9b\u9a71\u52a8\u5bf9tinyint\u652f\u6301\u4e0d\u591f\u597d\uff0c\u901a\u5e38\u5efa\u4e49\u6309\u5bb9\u91cf\u6765\u9009\u62e9\u5b57\u6bb5\uff1b text\u5b57\u6bb5\u5c3d\u91cf\u5c11\u7528\uff0c\u6216\u662f\u62c6\u5230\u5197\u4f59\u8868\u4e2d\uff1b CREATE TABLE ` wanted_post ` ( ` id ` int ( 10 ) NOT NULL AUTO_INCREMENT, ` puid ` int ( 10 ) unsigned NOT NULL, ` user_id ` int ( 10 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684id' , ` username ` varchar ( 50 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684\u7528\u6237\u540d' , ` city ` smallint ( 4 ) NOT NULL COMMENT '\u6240\u5728\u57ce\u5e02' , ` ip ` bigint ( 14 ) NOT NULL COMMENT '\u53d1\u5e16\u4eba\u7684ip' , ` district_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u533a\u57df\u7684id' , ` district_name ` varchar ( 20 ) NOT NULL COMMENT '\u884c\u653f\u533a\u540d\u5b57' , ` street_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u8857\u9053(\u5730\u6807)\u7684id' , ` street_name ` varchar ( 20 ) NOT NULL COMMENT '\u5c0f\u533a\u540d\u5b57' , ` title ` varchar ( 255 ) NOT NULL COMMENT '\u5e16\u5b50\u7684\u6807\u9898' , ` description ` text NOT NULL COMMENT '\u5e16\u5b50\u8be6\u60c5\u63cf\u8ff0' , ` post_at ` int ( 11 ) NOT NULL COMMENT '\u7528\u6237\u53d1\u5e16\u65f6\u95f4,\u6570\u636e\u521b\u5efa\u7684\u65f6\u95f4,\u4f7f\u7528\u6574\u578b\u5b58\u50a8' , ` refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u88ab\u4fee\u6539\u7684\u65f6\u95f4,\u6574\u578b\u5b58\u50a8' , ` show_time ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u663e\u793a\u65f6\u95f4' , ` age_max ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5c0f\u5e74\u9f84' , ` age_min ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5927\u5e74\u9f84' , ` post_refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5237\u65b0\u65f6\u95f4' , PRIMARY KEY ( ` id ` ) , UNIQUE KEY ` idx_puid ` ( ` puid ` ) , KEY ` user_id_index ` ( ` user_id ` ) , KEY ` post_at_index ` ( ` post_at ` ) , KEY ` refresh_at_index ` ( ` refresh_at ` ) , KEY ` show_time_index ` ( ` show_time ` ) ) ENGINE = InnoDB AUTO_INCREMENT = 55295 DEFAULT CHARSET = utf8 COMMENT = '\u62db\u8058\u5e16\u5b50\u8868' \u4e8c\u3001\u8868\u8bbe\u8ba1\u539f\u5219 \u00b6 [\u804c\u8d23\u5206\u79bb\u539f\u5219] \u00b6 \u804c\u8d23\u5206\u79bb\u539f\u5219\u662f\u6307\u5728\u8bbe\u8ba1\u7684\u65f6\u5019\u5e94\u5f53\u8003\u8651\u5230\u6570\u636e\u7684\u4ea7\u751f\uff0c\u805a\u5408\u4f7f\u7528\u7b49\u539f\u5219\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u5e72\u81ea\u5df1\u80fd\u5e72\u7684\u4e8b\u60c5\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u53ea\u5e72\u81ea\u5df1\u7684\u4e8b\u60c5\u3002\u4e00\u4e2a\u6570\u636e\u8868\u5e94\u8be5\u653e\u5728\u54ea\u4e2a\u7cfb\u7edf\u4e2d\uff0c\u901a\u5e38\u53d6\u51b3\u4e8e\u51e0\u70b9\uff1a \u8c01\u4ea7\u751f\u8fd9\u4e2a\u4fe1\u606f\uff1a\u901a\u5e38\u60c5\u51b5\u4e0b\u8c01\u4ea7\u751f\u4e86\u8fd9\u4e2a\u6570\u636e\u5e94\u5f53\u5bf9\u6b64\u6570\u636e\u8d1f\u8d23\uff1b\u4e5f\u5c31\u662f\u8003\u8651\u8be5\u6570\u636e\u7684\u521b\u5efa\uff0c\u53d1\u5c55\uff0c\u9500\u6bc1\u7b49\u5168\u751f\u547d\u5468\u671f\u7684\u5b9a\u4e49\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5b9a\u4e49\u7ef4\u62a4\u8d77\u6765\u63d0\u4f9b\u7ed9\u6d88\u8d39\u8005\u4f5c\u4e3a\u6d88\u8d39\u539f\u5219\uff1b \u8c01\u6700\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e2a\u4fe1\u606f\uff1a\u5982\u679c\u67d0\u4e2a\u7cfb\u7edf\u6700\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\uff0c\u6700\u7ecf\u5e38\u53bb\u4fee\u6539\u67d0\u4e2a\u6570\u636e\uff0c\u4e5f\u5e94\u8be5\u7531\u8be5\u7cfb\u7edf\u6765\u8d1f\u8d23\u4fdd\u5b58\u7ef4\u62a4\u8be5\u6570\u636e\uff1b \u9075\u5b88\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\u7684\u8003\u8651\uff1a\u5728\u5b58\u653e\u6570\u636e\u7684\u65f6\u5019\u5982\u679c\u8003\u8651\u5230\u6570\u636e\u4f7f\u7528\u539f\u5219\u5bfc\u81f4\u4e86\u76f8\u5173\u5ea6\u975e\u5e38\u9ad8\u7684\u6570\u636e\u5b58\u653e\u5728\u591a\u4e2a\u5730\u65b9\uff0c\u9700\u8981\u591a\u4e2a\u7cfb\u7edf\u6765\u7ef4\u62a4\u8fd9\u4e2a\u6570\u636e\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u95f4\u7684\u8026\u5408\u6027\u589e\u5f3a\uff0c\u5e94\u5f53\u5c3d\u91cf\u907f\u514d\u3002 \u5728\u6211\u4eec\u8bbe\u8ba1\u6570\u636e\u5e93\u8868\u95f4\u7684\u5173\u7cfb\u7684\u65f6\u5019\u4e5f\u5e94\u5f53\u9075\u5b88\u76f8\u540c\u539f\u5219\uff0c\u804c\u8d23\u5206\u79bb\u964d\u4f4e\u8026\u5408\uff0c\u4f46\u540c\u65f6\u8981\u8003\u8651\u5230\u6027\u80fd\u60c5\u51b5\uff0c\u505a\u5230\u9002\u5f53\u5197\u4f59\u800c\u4e0d\u5bfc\u81f4\u4fee\u6539\u903b\u8f91\u590d\u6742\u3002 \u4e3e\u4e2a\u6700\u5e38\u89c1\u8d34\u5b50\u4e0e\u8bc4\u8bba\u7684\u4f8b\u5b50\uff1a CREATE TABLE ` wanted_post ` ( ` id ` int ( 10 ) NOT NULL AUTO_INCREMENT, ` puid ` int ( 10 ) unsigned NOT NULL, ` user_id ` int ( 10 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684id' , ` username ` varchar ( 50 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684\u7528\u6237\u540d' , ` city ` smallint ( 4 ) NOT NULL COMMENT '\u6240\u5728\u57ce\u5e02' , ` ip ` bigint ( 14 ) NOT NULL COMMENT '\u53d1\u5e16\u4eba\u7684ip' , ` district_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u533a\u57df\u7684id' , ` district_name ` varchar ( 20 ) NOT NULL COMMENT '\u884c\u653f\u533a\u540d\u5b57' , ` street_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u8857\u9053(\u5730\u6807)\u7684id' , ` street_name ` varchar ( 20 ) NOT NULL COMMENT '\u5c0f\u533a\u540d\u5b57' , ` title ` varchar ( 255 ) NOT NULL COMMENT '\u5e16\u5b50\u7684\u6807\u9898' , ` description ` text NOT NULL COMMENT '\u5e16\u5b50\u8be6\u60c5\u63cf\u8ff0' , ` post_at ` int ( 11 ) NOT NULL COMMENT '\u7528\u6237\u53d1\u5e16\u65f6\u95f4,\u6570\u636e\u521b\u5efa\u7684\u65f6\u95f4,\u4f7f\u7528\u6574\u578b\u5b58\u50a8' , ` refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u88ab\u4fee\u6539\u7684\u65f6\u95f4,\u6574\u578b\u5b58\u50a8' , ` show_time ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u663e\u793a\u65f6\u95f4' , ` age_max ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5c0f\u5e74\u9f84' , ` age_min ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5927\u5e74\u9f84' , ` post_refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5237\u65b0\u65f6\u95f4' , PRIMARY KEY ( ` id ` ) , UNIQUE KEY ` idx_puid ` ( ` puid ` ) , KEY ` user_id_index ` ( ` user_id ` ) , KEY ` post_at_index ` ( ` post_at ` ) , KEY ` refresh_at_index ` ( ` refresh_at ` ) , KEY ` show_time_index ` ( ` show_time ` ) ) ENGINE = InnoDB AUTO_INCREMENT = 55295 DEFAULT CHARSET = utf8 COMMENT = '\u62db\u8058\u5e16\u5b50\u8868' CREATE TABLE ` wanted_post_comment_99 ` ( ` id ` int ( 11 ) NOT NULL AUTO_INCREMENT, ` puid ` int ( 10 ) unsigned NOT NULL, ` user_id ` int ( 10 ) NOT NULL COMMENT '\u8bc4\u8bba\u7528\u6237ID' , ` post_at ` int ( 11 ) NOT NULL COMMENT '\u8bc4\u8bba\u65f6\u95f4' , ` detail ` text NOT NULL COMMENT '\u8bc4\u8bba\u8be6\u60c5' , PRIMARY KEY ( ` id ` ) , KEY ` user_id_index ` ( ` user_id ` ) , KEY ` puidid_index ` ( ` puid ` ) ) ENGINE = InnoDB AUTO_INCREMENT = 10 DEFAULT CHARSET = utf8 COMMENT = '\u62db\u8058\u8bc4\u8bba\u5206\u886899' \u7531\u4e8e\u8bc4\u8bba\u8868\u6570\u636e\u91cf\u5f88\u5927\uff0c\u5728\u9884\u5148\u505a\u597d\u5206\u8868\uff0c\u6309\u8d34\u5b50puid\u5206\u6210100\u5f20\u5b50\u8868\uff0c\u90a3\u4e48\u5f53\u524d\u8be6\u60c5\u9875\u6d89\u53casql\u5982\u4e0b\uff1a select * from wanted_post where puid = xxxx ; select * from wanted_post_comment_99 where puid = xxxx ; \u8fd9\u662f\u4e00\u4e2a\u7b80\u5316\u7684\u6a21\u578b\uff0c\u8bc4\u8bba\u591a\u4e86\uff0c\u8fd8\u8981\u6d89\u53ca\u5206\u9875\uff0c\u4e0d\u53ef\u80fd\u4e00\u6b21\u6027\u5168\u53d6\u51fa\u6765\u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u573a\u666f\uff0c\u4e25\u683c\u5c0a\u5b88\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\u7684\u539f\u5219\uff0c\u4e0d\u4f1a\u5b58\u50a8\u5197\u4f59\u6570\u636e\u3002\u76f8\u6bd4\u8f83\u8fd8\u6709\u4e00\u79cd\u6587\u6863\u578b\u6570\u636e\u5e93\uff0c\u4f8b\u5982mongo\uff0c\u5c31\u53ef\u4ee5\u5c06\u8bc4\u8bba\u4e0e\u8d34\u5b50\u5b58\u653e\u5728\u4e00\u8d77\uff0c\u8bbf\u95ee\u7684\u65f6\u5019\u53ea\u9700\u4e00\u6b21\u987a\u5e8fIO\u64cd\u4f5c\u3002\u6574\u4f53\u6765\u8bb2\u8868\u8bbe\u8ba1\uff0c\u8981\u6309\u7167\u804c\u8d23\u5212\u5206\u539f\u5219\u3002 [\u5728\u7ebf\u5904\u7406\u4e0e\u5206\u6790\u5206\u79bb] \u00b6 \u4e3a\u4e86\u4fdd\u969c\u7ebf\u4e0a\u6570\u636e\u5904\u7406\u7684\u6027\u80fd\uff0c\u5c06\u4e00\u4e9b\u5206\u6790\u76f8\u5173\u7684\u6570\u636e\u53ca\u5206\u6790\u7ed3\u679c\uff0c\u5e94\u5f53\u4f7f\u7528\u5355\u72ec\u7684\u5e93\u6765\u8fdb\u884c\u5b58\u50a8\uff0c\u907f\u514d\u5728\u6570\u636e\u5206\u6790\u7684\u65f6\u5019\u5bfc\u81f4\u4e1a\u52a1\u6570\u636e\u541e\u5410\u91cf\u4e0b\u964d\uff0c\u5f15\u8d77\u7cfb\u7edf\u95ee\u9898\u3002 \u4e13\u95e8\u7528\u4e8e\u5b58\u653e\u79bb\u7ebf\u62a5\u8868\u6570\u636e\uff0c\u5e76\u63d0\u4f9b\u7ebf\u4e0a\u6570\u636e\u67e5\u8be2\u65b9\u6cd5\uff0c\u5efa\u8bae\u5c06\u7edf\u8ba1\u7ed3\u679c\uff0c\u6c47\u603b\u7684\u6570\u636e\u90fd\u4ece\u5728\u7ebf\u5904\u7406\u6570\u636e\u5e93\u4e2d\u79fb\u8d70\u3002 \u5bf9\u4e8e\u4e0a\u9762\u7684wanted_post\u6c42\u804c\u8d34\u5b50\u8868\uff0c\u5728\u7ebf\u5904\u7406\u53ea\u80fd\u662f\u7528\u6237\u5728\u64cd\u4f5c\uff1a\u6d4f\u89c8\uff0c\u4fee\u6539\uff0c\u5220\u9664\uff0c\u5206\u522b\u5bf9\u5e94\u5982\u4e0bsql\uff1a select * from wanted_post where puid = xxxxx ; update wanted_post set xxx = xxx where puid = xxxx ; delete from wanted_post where puid = xxxx ; \u540c\u6837\uff0c\u5bf9\u4e8e\u540e\u53f0\u7edf\u8ba1\u6765\u8bb2\uff0c\u90fd\u662f\u4e9b\u805a\u5408\u64cd\u4f5c\uff0c\u975e\u5e38\u6d88\u8017\u6027\u80fd\uff0c\u4f8b\u5982\u67e5\u770b\u67d0\u4e00\u7528\u6237\u53d1\u8d34\u91cf\uff1a select count ( * ) from wanted_post where user_id = xxxx ; \u4e0a\u9762\u4e3e\u4e2a\u901a\u7528\u7684\u4f8b\u5b50\uff0c\u539f\u5219\u4e0a\u8981\u5c06\u5728\u7ebf\u7528\u6237\u8bf7\u6c42\u548c\u540e\u53f0\u7edf\u8ba1\u8bf7\u6c42\u5206\u5f00\u3002\u7b80\u5355\u6765\u8bb2\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u9700\u6c42\u5904\u7406\u5982\u4e0b\uff1a \u5c06\u8bf7\u6c42\u6307\u5411\u4e0d\u540cslave \uff0c\u8fd9\u79cd\u65b9\u6cd5\u7b80\u5355\u9ad8\u6548\uff0c\u7f3a\u70b9\u662f\u6570\u636e\u91cf\u589e\u5927\u5c31\u73a9\u4e0d\u8f6c\u3002 \u5efa\u7acb\u79bb\u7ebf\u62a5\u8868\u5e93\uff0c\u4e13\u95e8\u5b58\u653e\u7edf\u8ba1\u7ed3\u679c\uff0c\u8fd9\u6837\u5c06\u8ba1\u7b97\u4e0e\u5c55\u793a\u5f02\u6b65\u5904\u7406\uff0c\u7f3a\u70b9\u662f\u5bf9\u4e8e\u5b9e\u65f6\u4e1a\u52a1\u54cd\u5e94\u4e0d\u597d\u3002 \u5b9e\u65f6\u62c9\u53d6mysql row binlog\uff0c\u505a\u6570\u636e\u7684\u5f02\u6784\u5904\u7406(tungsten, canal)\uff0c\u5c06\u589e\u91cf\u7ed3\u679c\u5904\u7406\u540e(storm)\uff0c\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u57fa\u672c\u5b9e\u65f6\u3002 [\u4e8b\u52a1\u4e0e\u65e5\u5fd7\u5206\u79bb] \u00b6 \u7528\u6237\u751f\u6210\u5185\u5bb9\u548c\u7528\u6237\u884c\u4e3a\u65e5\u5fd7\u8981\u5206\u5f00\uff0c\u8fd9\u4e00\u70b9\u5f88\u597d\u7406\u89e3\uff0c\u4e3e\u4e24\u4e2a\u4f8b\u5b50\uff1a \u6e38\u620fDB\u91cc\u5b58\u653e\u73a9\u5bb6\u7684\u57fa\u7840\u4fe1\u606f\uff0c\u88c5\u5907\uff0c\u5c5e\u6027\uff0c\u597d\u53cb\u5217\u8868\u7b49\u7b49\uff0c\u8fd9\u4e9b\u653e\u5230\u6570\u636e\u5e93\u91cc\u9762\u3002\u4f46\u662f\u73a9\u5bb6\u7684\u884c\u4e3a\u65e5\u5fd7\uff0c\u6bd4\u5982\u6d88\u8017\u91d1\u5e01\uff0c\u4eca\u5929\u4e0b\u8fc7\u54ea\u4e9b\u526f\u672c\uff0c\u4e70\u8fc7\u4ec0\u4e48\u9876\u7ea7\u88c5\u5907\uff0c\u8fd9\u4e9b\u5c5e\u4e8e\u884c\u4e3a\u65e5\u5fd7\uff0c\u5e94\u8be5\u5355\u72ec\u5b58\u653e\u5e76\u5206\u6790\u5904\u7406\u3002 \u5bf9\u4e8eweb\u7528\u8bb0\uff0c\u6709\u597d\u591a\u7528\u6237\u7f6e\u9876\uff0c\u5237\u65b0\uff0c\u7ade\u4ef7\uff0c\u5c55\u793a\u7b49\u884c\u4e3a\uff0c\u8981\u6c42\u5b9e\u65f6\u5e76\u4e14\u91cf\u5f88\u5927\uff0c\u4e00\u5b9a\u8981\u548c\u8d34\u5b50\u5206\u5f00\u3002 \u884c\u4e3a\u65e5\u5fd7\uff0c\u9700\u8981\u505a\u5206\u6790\u5904\u7406\uff0c\u5e76\u4e14\u7531\u4e8e\u65f6\u6548\u6027\u4e0d\u5b9c\u5b58\u50a8\u5728mysql\u4e2d\uff0c\u540e\u671f\u7ef4\u62a4\u5c31\u662f\u5730\u96f7\u3002 [\u5386\u53f2\u53ef\u8ffd\u6eaf] \u00b6 \u5728\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u65f6\u5019\u4e3a\u4e86\u4fdd\u969c\u6570\u636e\u662f\u53ef\u8ffd\u6eaf\u7684\uff0c\u5e94\u5f53\u9075\u5faa\u4e00\u4e9b\u7b80\u5355\u7684\u7ea6\u5b9a\uff0c\u4e8b\u540e\u65b9\u4fbf\u6570\u636e\u7684\u67e5\u8be2\u548c\u7edf\u8ba1\uff1a \u5bf9\u4e8e\u72b6\u6001\u6570\u636e\uff0c\u5e94\u5f53\u8bbe\u8ba1\u76f8\u5e94\u72b6\u6001\u7684\u5b57\u6bb5\u6765\u4fdd\u5b58\u8be5\u6570\u636e\u7684\u6700\u540e\u72b6\u6001\uff0c\u540c\u65f6\u8bb0\u5f55\u4e0b\u6765\u8be5\u6570\u636e\u7684\u521d\u59cb\u521b\u5efa\u4eba\uff0c\u65f6\u95f4\u4ee5\u53ca\u8be5\u6570\u636e\u7684\u6700\u540e\u4fee\u6539\u4eba\u548c\u4fee\u6539\u65f6\u95f4\uff1b\u6240\u4ee5\u5728\u4ea4\u6613\u6570\u636e\uff08\u5982\u8ba2\u5355\u5408\u540c\uff09\uff0c\u5e7f\u544a\u6570\u636e\uff0c\u8d26\u6237\u8868\u7b49\u90fd\u5e94\u8be5\u9ed8\u8ba4\u6709\u72b6\u6001\uff08status\uff09\uff0c\u521b\u5efa\u4eba\uff08creator/creator_name\uff09\uff0c\u521b\u5efa\u65f6\u95f4\uff08created_at\uff09\uff0c\u6700\u540e\u4fee\u6539\u4eba\uff08modifier/modifier_name\uff09\uff0c\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff08modified_at\uff09\u7b49\u5b57\u6bb5\u7528\u6765\u8868\u660e\u6570\u636e\u7684\u5f53\u524d\u72b6\u6001\uff0c\u521b\u5efa\u4fe1\u606f\u53ca\u4fee\u6539\u4fe1\u606f\u3002 \u9488\u5bf9\u9700\u8981\u8ddf\u8e2a\u6bcf\u6b21\u4fee\u6539\u7684\u6570\u636e\uff0c\u9700\u8981\u5728\u6570\u636e\u53d1\u751f\u53d8\u5316\u7684\u65f6\u5019\u8bb0\u5f55\u4e00\u5f20\u65e5\u5fd7\u8868\uff0c\u7528\u4e8e\u8bb0\u5f55\u8be5\u6570\u636e\u53d1\u751f\u53d8\u5316\u7684\u5168\u751f\u547d\u5468\u671f\u3002\u9488\u5bf9\u53ea\u9700\u8981\u5173\u6ce8\u5173\u952e\u5b57\u6bb5\u53d8\u5316\u7684\u60c5\u51b5\uff0c\u5219\u65e5\u5fd7\u8868\u4e2d\u53ea\u9700\u8981\u8bb0\u5f55\u5173\u952e\u5b57\u6bb5\u53d8\u5316\u5373\u53ef\uff0c\u4f46\u64cd\u4f5c\u4eba\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u65f6\u95f4\u5e94\u5f53\u51c6\u786e\u8bb0\u5f55\uff0c\u65e5\u5fd7\u8868\u6570\u636e\u4e00\u65e6\u751f\u6210\u4e0d\u5141\u8bb8\u8fdb\u884c\u4fee\u6539\u3002\u5982\u7528\u6237\u8d26\u6237\u7684\u5145\u503c\u6d41\u6c34\uff0c\u6d88\u8d39\u6d41\u6c34\u90fd\u662f\u4e00\u4e9b\u4e1a\u52a1\u7d27\u76f8\u5173\u7684\u65e5\u5fd7\u3002\u800c\u5ba1\u6838\u65e5\u5fd7\uff0c\u64cd\u4f5c\u8bb0\u5f55\u7b49\u65e5\u5fd7\u5219\u5c5e\u4e8e\u4e0e\u4e1a\u52a1\u5173\u8054\u8f83\u5c0f\u7684\u65e5\u5fd7\u3002 \u9488\u5bf9\u6240\u6709\u5386\u53f2\u9700\u8981\u4fdd\u7559\u7684\u6570\u636e\u5219\u9700\u8981\u6bcf\u6b21\u53d8\u5316\u90fd\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u7248\u672c\uff0c\u6bd4\u5982\u7c7b\u76ee\u4fe1\u606f\u7b49\uff0c\u5bf9\u539f\u59cb\u6570\u636e\u6c38\u8fdc\u53ea\u505ainsert\u64cd\u4f5c\uff0c\u4e0d\u505adelete\u53caupdate\u64cd\u4f5c\u3002\u4f46\u8fd9\u79cd\u60c5\u51b5\u4ec5\u9650\u4e8e\u6781\u7aef\u6570\u636e\u5386\u53f2\u8981\u6c42\u6781\u9ad8\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002","title":"\"MySQL\u6570\u636e\u5e93\u8bbe\u8ba1\u89c4\u8303\""},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_1","text":"","title":"\u4e00\u3001\u547d\u540d\u89c4\u8303"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_2","text":"\u901a\u5e38\u6765\u8bb2\uff0c\u5404\u4e2a\u4e92\u8054\u7f51\u516c\u53f8\u7684\u6570\u636e\u5e93\u5206\u4e3a5\u4e2a\u6570\u636e\u5e93\u73af\u5883\uff1a dev : \u5f00\u53d1\u73af\u5883, \u5f00\u53d1\u53ef\u8bfb\u5199,\u53ef\u4fee\u6539\u8868\u7ed3\u6784; \u5e38\u7528\u7684163\u7684\u6570\u636e\u5e93\u8868; \u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4fee\u6539\u8868\u7ed3\u6784, \u53ef\u4ee5\u968f\u610f\u4fee\u6539\u5176\u4e2d\u7684\u6570\u636e; \u4f46\u662f\u9700\u8981\u4fdd\u8bc1\u4e0d\u5f71\u54cd\u5176\u4ed6\u5f00\u53d1\u540c\u4e8b; qa : \u6d4b\u8bd5\u73af\u5883, \u5f00\u53d1\u53ef\u8bfb\u5199, \u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u901a\u8fc7\u5de5\u5177\u4fee\u6539\u8868\u7ed3\u6784; sim: \u6a21\u62df\u73af\u5883, \u5f00\u53d1\u53ef\u8bfb\u5199, \u901a\u8fc7web\u5e73\u53f0;\u53d1\u8d77\u4e0a\u7ebf\u8bf7\u6c42\u65f6\uff0c\u4f1a\u5148\u5728\u8fd9\u4e2a\u73af\u5883\u4e0a\u8fdb\u884c\u9884\u6267\u884c\uff0c \u8fd9\u4e2a\u73af\u5883\u4e5f\u53ef\u4f9b\u90e8\u7f72\u4e0a\u7ebf\u6f14\u7ec3\u6216\u538b\u529b\u6d4b\u8bd5\u4f7f\u7528 \u53ef\u4ee5\u8bfb\u5199; real: \u751f\u4ea7\u6570\u636e\u5e93\u4ece\u5e93\uff08\u51c6\u5b9e\u65f6\u540c\u6b65\uff09,\u53ea\u8bfb\u73af\u5883,\u4e0d\u5141\u8bb8\u4fee\u6539\u6570\u636e,\u4e0d\u5141\u8bb8\u4fee\u6539\u8868\u7ed3\u6784; \u4f9b\u7ebf\u4e0a\u95ee\u9898\u67e5\u627e,\u6570\u636e\u67e5\u8be2\u7b49\u4f7f\u7528; online: \u7ebf\u4e0a\u73af\u5883;\u5f00\u53d1\u4eba\u5458\u4e0d\u5141\u8bb8\u76f4\u63a5\u5728\u7ebf\u4e0a\u73af\u5883\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c,\u5982\u679c\u9700\u8981\u64cd\u4f5c\u5fc5\u987b\u627eDBA\u8fdb\u884c\u64cd\u4f5c\u5e76\u8fdb\u884c\u76f8\u5e94\u8bb0\u5f55; \u8fd9\u4e9b\u73af\u5883\u7684\u673a\u5668\uff0c\u4e00\u5b9a\u8981\u505a\u5230\u6743\u9650\u5212\u5206\u660e\u786e\uff0c\u8bfb\u5199\u5e10\u53f7\u5206\u79bb\uff0c\u5e76\u4e14\u6709\u8fa8\u8bc6\u5ea6\uff0c\u80fd\u533a\u5206\u5177\u4f53\u4e1a\u52a1\u3002\u4f8b\u5982\u7528\u6237\u540dw_wap, r_wap \u80fd\u770b\u51fa\u6765\uff0c\u8bfb\u5199\u5e10\u53f7\u662fwap\u5e94\u7528\u7684\u3002","title":"[\u6570\u636e\u5e93\u73af\u5883\u4ecb\u7ecd]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_3","text":"\u5c3d\u91cf\u7b80\u6d01\u660e\u4e49\uff0c\u80fd\u591f\u4e00\u773c\u770b\u51fa\u6765\u8fd9\u4e2a\u6570\u636e\u5e93\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\uff1b \u4f7f\u7528\u540d\u8bcd\u4f5c\u4e3a\u6570\u636e\u5e93\u540d\u79f0\uff0c\u5e76\u4e14\u53ea\u7528\u82f1\u6587\uff0c\u4e0d\u7528\u4e2d\u6587\u62fc\u97f3\uff1b \u4f7f\u7528\u82f1\u6587\u5b57\u6bcd\uff0c\u5168\u90e8\u5c0f\u5199\uff0c\u63a7\u5236\u57283-7\u4e2a\u5b57\u6bcd\u4ee5\u5185\uff1b \u5982\u679c\u6709\u591a\u4e2a\u5355\u8bcd\uff0c\u5219\u4f7f\u7528\u4e0b\u5212\u7ebf\u9694\u5f00\uff0c\u4e0d\u5efa\u4e49\u9a7c\u5cf0\u547d\u540d\uff1b \u4f8b\u5982\uff0c\u6bcf\u4e2a\u516c\u53f8\u90fd\u6709crm\u4e1a\u52a1\uff0c\u90a3\u5c31\u53eb\u505axx_crm, \u5b57\u7b26\u96c6\u7edf\u4e00utf8\u3002\u5b57\u7b26\u96c6\u8e29\u8fc7\u7684\u5751\u5f88\u591a\uff0c\u4e3a\u4e86\u901a\u7528\u6027\u7edf\u4e00utf8\u3002 create database xx_crm default character set = utf8 ;","title":"[\u6570\u636e\u5e93\u547d\u540d\u89c4\u8303]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_4","text":"\u5177\u5907\u7edf\u4e00\u524d\u7f00\uff0c\u5bf9\u76f8\u5173\u529f\u80fd\u7684\u8868\u5e94\u5f53\u4f7f\u7528\u76f8\u540c\u524d\u7f00\uff0c\u5982acl_xxx\uff0chouse_xxx,ppc_xxx\uff1b\u5176\u4e2d\u524d\u7f00\u901a\u5e38\u4e3a\u8fd9\u4e2a\u8868\u7684\u6a21\u5757\u6216\u4f9d\u8d56\u4e3b\u5b9e\u4f53\u5bf9\u8c61\u7684\u540d\u5b57\uff0c\u901a\u5e38\u6765\u8bb2\u8868\u540d\u4e3a\uff1a\u4e1a\u52a1_\u52a8\u4f5c_\u7c7b\u578b\uff0c\u6216\u662f\u4e1a\u52a1_\u7c7b\u578b\uff1b \u8868\u540d\u4f7f\u7528\u82f1\u6587\u5c0f\u5199\u5355\u8bcd\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5355\u8bcd\u5219\u4f7f\u7528\u4e0b\u5212\u7ebf\u9694\u5f00\uff1b 3.\u8868\u540d\u7b80\u4ecb\uff0c\u4f7f\u7528\u5e38\u89c1\u5355\u8bcd\uff0c\u907f\u514d\u4f7f\u7528\u957f\u5355\u8bcd\u548c\u751f\u50fb\u8bcd\uff1b \u8868\u5f15\u64ce\u53d6\u51b3\u4e8e\u5b9e\u9645\u5e94\u7528\u573a\u666f\u53ca\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u7684\u5df2\u7ecf\u5b58\u5728\u7684\u5b58\u50a8\u5f15\u64ce\uff1b\u65e5\u5fd7\u53ca\u62a5\u8868\u7c7b\u8868\u5efa\u8bae\u7528myisam\uff0c\u4e0e\u4ea4\u6613\uff0c\u5ba1\u6838\uff0c\u91d1\u989d\u76f8\u5173\u7684\u8868\u5efa\u8bae\u7528innodb\u5f15\u64ce\u3002\u603b\u4f53\u6765\u8bb2\u6570\u636e\u5e93\u9ed8\u8ba4innodb\uff1b \u6570\u636e\u8868\u5fc5\u987b\u6709\u4e3b\u952e\uff0c\u4e14\u5efa\u8bae\u5747\u4f7f\u7528auto_increment\u7684id\u4f5c\u4e3a\u4e3b\u952e\uff08\u4e0e\u4e1a\u52a1\u65e0\u5173\uff09,\u548c\u4e1a\u52a1\u76f8\u5173\u7684\u8981\u505a\u4e3a\u552f\u4e00\u7d22\u5f15\uff1b \u9ed8\u8ba4\u4f7f\u7528utf8\u5b57\u7b26\u96c6\uff08\u7531\u4e8e\u6570\u636e\u5e93\u5b9a\u4e49\u4f7f\u7528\u4e86\u9ed8\u8ba4\uff0c\u6570\u636e\u8868\u53ef\u4ee5\u4e0d\u518d\u5b9a\u4e49\uff0c\u4f46\u4e3a\u4fdd\u9669\u8d77\u89c1\uff0c\u5efa\u8bae\u90fd\u5199\u4e0a\uff09\uff1b \u6240\u6709\u7684\u8868\u90fd\u5fc5\u987b\u6709\u5907\u6ce8\uff0c\u5199\u660e\u767d\u8fd9\u4e2a\u8868\u4e2d\u5b58\u653e\u7684\u6570\u636e\u5185\u5bb9\uff1b \u9884\u4f30\u8868\u6570\u636e\u91cf\uff0c\u5982\u679c\u6570\u636e\u91cf\u8f83\u5927\uff08\u8d85\u8fc7500w\uff09\u5219\u9700\u8981\u8003\u8651\u5206\u8868\u7b56\u7565\u3002\u53ef\u4ee5\u7b49\u91cf\u5747\u8861\u5206\u8868\u6216\u6839\u636e\u4e1a\u52a1\u89c4\u5219\u5206\u8868\u5747\u53ef\u3002\u8981\u5206\u8868\u7684\u6570\u636e\u8868\u5fc5\u987b\u4e0eDBA\u5546\u91cf\u5206\u8868\u7b56\u7565\uff1b \u804c\u8d23\u76f8\u8fd1\u7684\u8868\uff0c\u547d\u540d\u89c4\u5219\u5e94\u8be5\u76f8\u540c\uff1b\u5982\u5408\u540c\u7533\u8bf7\uff0c\u8d26\u6237\u4fe1\u606f\uff0c\u4ea4\u53cb\u76f8\u5173\u7b49\uff1b \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e00\u5f20\u5728\u7ebf\u51b2\u503c\u8bb0\u5f55\u8868\uff1auser_bank_deposit \u8fd9\u4e2a\u5c31\u975e\u5e38\u7b26\u5408\u6807\u51c6\uff0c\u5982\u679c\u53eb\u505auserBankDeposit\u6216\u662fuser_chongzhi\uff0c\u5c31\u975e\u5e38\u4e0d\u53cb\u597d\u3002 CREATE TABLE ` house_refresh_log ` ( ` id ` int ( 11 ) NOT NULL AUTO_INCREMENT COMMENT '\u81ea\u589eID' , ` fangid ` int ( 11 ) NOT NULL COMMENT '\u623f\u8d34\u5b50ID' , ` refresh_time ` int ( 11 ) NOT NULL COMMENT '\u5237\u65b0\u65f6\u95f4' , PRIMARY KEY ( ` id ` ) , UNIQUE KEY ` fangid ` ( ` fangid ` ) ) ENGINE = InnoDB DEFAULT CHARSET = utf8 COMMENT = '\u623f\u5237\u65b0\u8bb0\u5f55\u8868'","title":"[\u8868\u547d\u540d\u89c4\u8303]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_5","text":"\u6570\u636e\u5e93\u5b57\u6bb5\u547d\u540d\u4e0e\u8868\u540d\u547d\u540d\u7c7b\u4f3c\uff1a \u4f7f\u7528\u5c0f\u5199\u82f1\u6587\u5355\u8bcd\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5355\u8bcd\u4f7f\u7528\u4e0b\u5212\u7ebf\u9694\u5f00\uff1b \u4f7f\u7528\u7b80\u5355\u5355\u8bcd\uff0c\u907f\u514d\u751f\u50fb\u8bcd\uff1b \u5b57\u6bb5\u5e94\u5f53\u6709\u6ce8\u91ca\uff0c\u63cf\u8ff0\u8be5\u5b57\u6bb5\u7684\u7528\u9014\u53ca\u53ef\u80fd\u5b58\u50a8\u7684\u5185\u5bb9\uff0c\u5982\u679a\u4e3e\u503c\u5219\u5efa\u8bae\u5c06\u8be5\u5b57\u6bb5\u4e2d\u4f7f\u7528\u7684\u5185\u5bb9\u90fd\u5b9a\u4e49\u51fa\u6765\uff1b \u662f\u522b\u7684\u8868\u7684\u5916\u952e\u5747\u4f7f\u7528xxx_id\u7684\u65b9\u5f0f\u6765\u8868\u660e\uff1b \u8868\u7684\u4e3b\u952e\u4e00\u822c\u90fd\u7ea6\u5b9a\u6210\u4e3aid\uff0c\u81ea\u589e\u7c7b\u578b\uff1b \u65f6\u95f4\u5b57\u6bb5\uff0c\u9664\u7279\u6b8a\u60c5\u51b5\u4e00\u5f8b\u91c7\u7528int\u6765\u8bb0\u5f55unix_timestamp\uff1b \u7f51\u7edcIP\u5b57\u6bb5\uff0c\u9664\u7279\u6b8a\u60c5\u51b5\u4e00\u5f8b\u7528bigint\u6765\u8bb0\u5f55inet_aton\u503c\uff1b \u6240\u6709\u5b57\u6bb5\uff0c\u5747\u4e3a\u975e\u7a7a\uff0c\u6700\u597d\u663e\u793a\u6307\u5b9a\u9ed8\u8ba4\u503c\uff1b \u6709\u4e9b\u9a71\u52a8\u5bf9tinyint\u652f\u6301\u4e0d\u591f\u597d\uff0c\u901a\u5e38\u5efa\u4e49\u6309\u5bb9\u91cf\u6765\u9009\u62e9\u5b57\u6bb5\uff1b text\u5b57\u6bb5\u5c3d\u91cf\u5c11\u7528\uff0c\u6216\u662f\u62c6\u5230\u5197\u4f59\u8868\u4e2d\uff1b CREATE TABLE ` wanted_post ` ( ` id ` int ( 10 ) NOT NULL AUTO_INCREMENT, ` puid ` int ( 10 ) unsigned NOT NULL, ` user_id ` int ( 10 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684id' , ` username ` varchar ( 50 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684\u7528\u6237\u540d' , ` city ` smallint ( 4 ) NOT NULL COMMENT '\u6240\u5728\u57ce\u5e02' , ` ip ` bigint ( 14 ) NOT NULL COMMENT '\u53d1\u5e16\u4eba\u7684ip' , ` district_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u533a\u57df\u7684id' , ` district_name ` varchar ( 20 ) NOT NULL COMMENT '\u884c\u653f\u533a\u540d\u5b57' , ` street_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u8857\u9053(\u5730\u6807)\u7684id' , ` street_name ` varchar ( 20 ) NOT NULL COMMENT '\u5c0f\u533a\u540d\u5b57' , ` title ` varchar ( 255 ) NOT NULL COMMENT '\u5e16\u5b50\u7684\u6807\u9898' , ` description ` text NOT NULL COMMENT '\u5e16\u5b50\u8be6\u60c5\u63cf\u8ff0' , ` post_at ` int ( 11 ) NOT NULL COMMENT '\u7528\u6237\u53d1\u5e16\u65f6\u95f4,\u6570\u636e\u521b\u5efa\u7684\u65f6\u95f4,\u4f7f\u7528\u6574\u578b\u5b58\u50a8' , ` refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u88ab\u4fee\u6539\u7684\u65f6\u95f4,\u6574\u578b\u5b58\u50a8' , ` show_time ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u663e\u793a\u65f6\u95f4' , ` age_max ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5c0f\u5e74\u9f84' , ` age_min ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5927\u5e74\u9f84' , ` post_refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5237\u65b0\u65f6\u95f4' , PRIMARY KEY ( ` id ` ) , UNIQUE KEY ` idx_puid ` ( ` puid ` ) , KEY ` user_id_index ` ( ` user_id ` ) , KEY ` post_at_index ` ( ` post_at ` ) , KEY ` refresh_at_index ` ( ` refresh_at ` ) , KEY ` show_time_index ` ( ` show_time ` ) ) ENGINE = InnoDB AUTO_INCREMENT = 55295 DEFAULT CHARSET = utf8 COMMENT = '\u62db\u8058\u5e16\u5b50\u8868'","title":"[\u5b57\u6bb5\u547d\u540d\u89c4\u8303]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_6","text":"","title":"\u4e8c\u3001\u8868\u8bbe\u8ba1\u539f\u5219"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_7","text":"\u804c\u8d23\u5206\u79bb\u539f\u5219\u662f\u6307\u5728\u8bbe\u8ba1\u7684\u65f6\u5019\u5e94\u5f53\u8003\u8651\u5230\u6570\u636e\u7684\u4ea7\u751f\uff0c\u805a\u5408\u4f7f\u7528\u7b49\u539f\u5219\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u5e72\u81ea\u5df1\u80fd\u5e72\u7684\u4e8b\u60c5\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u53ea\u5e72\u81ea\u5df1\u7684\u4e8b\u60c5\u3002\u4e00\u4e2a\u6570\u636e\u8868\u5e94\u8be5\u653e\u5728\u54ea\u4e2a\u7cfb\u7edf\u4e2d\uff0c\u901a\u5e38\u53d6\u51b3\u4e8e\u51e0\u70b9\uff1a \u8c01\u4ea7\u751f\u8fd9\u4e2a\u4fe1\u606f\uff1a\u901a\u5e38\u60c5\u51b5\u4e0b\u8c01\u4ea7\u751f\u4e86\u8fd9\u4e2a\u6570\u636e\u5e94\u5f53\u5bf9\u6b64\u6570\u636e\u8d1f\u8d23\uff1b\u4e5f\u5c31\u662f\u8003\u8651\u8be5\u6570\u636e\u7684\u521b\u5efa\uff0c\u53d1\u5c55\uff0c\u9500\u6bc1\u7b49\u5168\u751f\u547d\u5468\u671f\u7684\u5b9a\u4e49\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5b9a\u4e49\u7ef4\u62a4\u8d77\u6765\u63d0\u4f9b\u7ed9\u6d88\u8d39\u8005\u4f5c\u4e3a\u6d88\u8d39\u539f\u5219\uff1b \u8c01\u6700\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e2a\u4fe1\u606f\uff1a\u5982\u679c\u67d0\u4e2a\u7cfb\u7edf\u6700\u7ecf\u5e38\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\uff0c\u6700\u7ecf\u5e38\u53bb\u4fee\u6539\u67d0\u4e2a\u6570\u636e\uff0c\u4e5f\u5e94\u8be5\u7531\u8be5\u7cfb\u7edf\u6765\u8d1f\u8d23\u4fdd\u5b58\u7ef4\u62a4\u8be5\u6570\u636e\uff1b \u9075\u5b88\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\u7684\u8003\u8651\uff1a\u5728\u5b58\u653e\u6570\u636e\u7684\u65f6\u5019\u5982\u679c\u8003\u8651\u5230\u6570\u636e\u4f7f\u7528\u539f\u5219\u5bfc\u81f4\u4e86\u76f8\u5173\u5ea6\u975e\u5e38\u9ad8\u7684\u6570\u636e\u5b58\u653e\u5728\u591a\u4e2a\u5730\u65b9\uff0c\u9700\u8981\u591a\u4e2a\u7cfb\u7edf\u6765\u7ef4\u62a4\u8fd9\u4e2a\u6570\u636e\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u95f4\u7684\u8026\u5408\u6027\u589e\u5f3a\uff0c\u5e94\u5f53\u5c3d\u91cf\u907f\u514d\u3002 \u5728\u6211\u4eec\u8bbe\u8ba1\u6570\u636e\u5e93\u8868\u95f4\u7684\u5173\u7cfb\u7684\u65f6\u5019\u4e5f\u5e94\u5f53\u9075\u5b88\u76f8\u540c\u539f\u5219\uff0c\u804c\u8d23\u5206\u79bb\u964d\u4f4e\u8026\u5408\uff0c\u4f46\u540c\u65f6\u8981\u8003\u8651\u5230\u6027\u80fd\u60c5\u51b5\uff0c\u505a\u5230\u9002\u5f53\u5197\u4f59\u800c\u4e0d\u5bfc\u81f4\u4fee\u6539\u903b\u8f91\u590d\u6742\u3002 \u4e3e\u4e2a\u6700\u5e38\u89c1\u8d34\u5b50\u4e0e\u8bc4\u8bba\u7684\u4f8b\u5b50\uff1a CREATE TABLE ` wanted_post ` ( ` id ` int ( 10 ) NOT NULL AUTO_INCREMENT, ` puid ` int ( 10 ) unsigned NOT NULL, ` user_id ` int ( 10 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684id' , ` username ` varchar ( 50 ) NOT NULL COMMENT '\u53d1\u8d34\u7528\u6237\u7684\u7528\u6237\u540d' , ` city ` smallint ( 4 ) NOT NULL COMMENT '\u6240\u5728\u57ce\u5e02' , ` ip ` bigint ( 14 ) NOT NULL COMMENT '\u53d1\u5e16\u4eba\u7684ip' , ` district_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u533a\u57df\u7684id' , ` district_name ` varchar ( 20 ) NOT NULL COMMENT '\u884c\u653f\u533a\u540d\u5b57' , ` street_id ` tinyint ( 2 ) NOT NULL COMMENT '\u6240\u5728\u8857\u9053(\u5730\u6807)\u7684id' , ` street_name ` varchar ( 20 ) NOT NULL COMMENT '\u5c0f\u533a\u540d\u5b57' , ` title ` varchar ( 255 ) NOT NULL COMMENT '\u5e16\u5b50\u7684\u6807\u9898' , ` description ` text NOT NULL COMMENT '\u5e16\u5b50\u8be6\u60c5\u63cf\u8ff0' , ` post_at ` int ( 11 ) NOT NULL COMMENT '\u7528\u6237\u53d1\u5e16\u65f6\u95f4,\u6570\u636e\u521b\u5efa\u7684\u65f6\u95f4,\u4f7f\u7528\u6574\u578b\u5b58\u50a8' , ` refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u88ab\u4fee\u6539\u7684\u65f6\u95f4,\u6574\u578b\u5b58\u50a8' , ` show_time ` int ( 11 ) NOT NULL COMMENT '\u5e16\u5b50\u663e\u793a\u65f6\u95f4' , ` age_max ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5c0f\u5e74\u9f84' , ` age_min ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '\u62db\u8058\u6700\u5927\u5e74\u9f84' , ` post_refresh_at ` int ( 11 ) NOT NULL COMMENT '\u5237\u65b0\u65f6\u95f4' , PRIMARY KEY ( ` id ` ) , UNIQUE KEY ` idx_puid ` ( ` puid ` ) , KEY ` user_id_index ` ( ` user_id ` ) , KEY ` post_at_index ` ( ` post_at ` ) , KEY ` refresh_at_index ` ( ` refresh_at ` ) , KEY ` show_time_index ` ( ` show_time ` ) ) ENGINE = InnoDB AUTO_INCREMENT = 55295 DEFAULT CHARSET = utf8 COMMENT = '\u62db\u8058\u5e16\u5b50\u8868' CREATE TABLE ` wanted_post_comment_99 ` ( ` id ` int ( 11 ) NOT NULL AUTO_INCREMENT, ` puid ` int ( 10 ) unsigned NOT NULL, ` user_id ` int ( 10 ) NOT NULL COMMENT '\u8bc4\u8bba\u7528\u6237ID' , ` post_at ` int ( 11 ) NOT NULL COMMENT '\u8bc4\u8bba\u65f6\u95f4' , ` detail ` text NOT NULL COMMENT '\u8bc4\u8bba\u8be6\u60c5' , PRIMARY KEY ( ` id ` ) , KEY ` user_id_index ` ( ` user_id ` ) , KEY ` puidid_index ` ( ` puid ` ) ) ENGINE = InnoDB AUTO_INCREMENT = 10 DEFAULT CHARSET = utf8 COMMENT = '\u62db\u8058\u8bc4\u8bba\u5206\u886899' \u7531\u4e8e\u8bc4\u8bba\u8868\u6570\u636e\u91cf\u5f88\u5927\uff0c\u5728\u9884\u5148\u505a\u597d\u5206\u8868\uff0c\u6309\u8d34\u5b50puid\u5206\u6210100\u5f20\u5b50\u8868\uff0c\u90a3\u4e48\u5f53\u524d\u8be6\u60c5\u9875\u6d89\u53casql\u5982\u4e0b\uff1a select * from wanted_post where puid = xxxx ; select * from wanted_post_comment_99 where puid = xxxx ; \u8fd9\u662f\u4e00\u4e2a\u7b80\u5316\u7684\u6a21\u578b\uff0c\u8bc4\u8bba\u591a\u4e86\uff0c\u8fd8\u8981\u6d89\u53ca\u5206\u9875\uff0c\u4e0d\u53ef\u80fd\u4e00\u6b21\u6027\u5168\u53d6\u51fa\u6765\u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u573a\u666f\uff0c\u4e25\u683c\u5c0a\u5b88\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\u7684\u539f\u5219\uff0c\u4e0d\u4f1a\u5b58\u50a8\u5197\u4f59\u6570\u636e\u3002\u76f8\u6bd4\u8f83\u8fd8\u6709\u4e00\u79cd\u6587\u6863\u578b\u6570\u636e\u5e93\uff0c\u4f8b\u5982mongo\uff0c\u5c31\u53ef\u4ee5\u5c06\u8bc4\u8bba\u4e0e\u8d34\u5b50\u5b58\u653e\u5728\u4e00\u8d77\uff0c\u8bbf\u95ee\u7684\u65f6\u5019\u53ea\u9700\u4e00\u6b21\u987a\u5e8fIO\u64cd\u4f5c\u3002\u6574\u4f53\u6765\u8bb2\u8868\u8bbe\u8ba1\uff0c\u8981\u6309\u7167\u804c\u8d23\u5212\u5206\u539f\u5219\u3002","title":"[\u804c\u8d23\u5206\u79bb\u539f\u5219]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_8","text":"\u4e3a\u4e86\u4fdd\u969c\u7ebf\u4e0a\u6570\u636e\u5904\u7406\u7684\u6027\u80fd\uff0c\u5c06\u4e00\u4e9b\u5206\u6790\u76f8\u5173\u7684\u6570\u636e\u53ca\u5206\u6790\u7ed3\u679c\uff0c\u5e94\u5f53\u4f7f\u7528\u5355\u72ec\u7684\u5e93\u6765\u8fdb\u884c\u5b58\u50a8\uff0c\u907f\u514d\u5728\u6570\u636e\u5206\u6790\u7684\u65f6\u5019\u5bfc\u81f4\u4e1a\u52a1\u6570\u636e\u541e\u5410\u91cf\u4e0b\u964d\uff0c\u5f15\u8d77\u7cfb\u7edf\u95ee\u9898\u3002 \u4e13\u95e8\u7528\u4e8e\u5b58\u653e\u79bb\u7ebf\u62a5\u8868\u6570\u636e\uff0c\u5e76\u63d0\u4f9b\u7ebf\u4e0a\u6570\u636e\u67e5\u8be2\u65b9\u6cd5\uff0c\u5efa\u8bae\u5c06\u7edf\u8ba1\u7ed3\u679c\uff0c\u6c47\u603b\u7684\u6570\u636e\u90fd\u4ece\u5728\u7ebf\u5904\u7406\u6570\u636e\u5e93\u4e2d\u79fb\u8d70\u3002 \u5bf9\u4e8e\u4e0a\u9762\u7684wanted_post\u6c42\u804c\u8d34\u5b50\u8868\uff0c\u5728\u7ebf\u5904\u7406\u53ea\u80fd\u662f\u7528\u6237\u5728\u64cd\u4f5c\uff1a\u6d4f\u89c8\uff0c\u4fee\u6539\uff0c\u5220\u9664\uff0c\u5206\u522b\u5bf9\u5e94\u5982\u4e0bsql\uff1a select * from wanted_post where puid = xxxxx ; update wanted_post set xxx = xxx where puid = xxxx ; delete from wanted_post where puid = xxxx ; \u540c\u6837\uff0c\u5bf9\u4e8e\u540e\u53f0\u7edf\u8ba1\u6765\u8bb2\uff0c\u90fd\u662f\u4e9b\u805a\u5408\u64cd\u4f5c\uff0c\u975e\u5e38\u6d88\u8017\u6027\u80fd\uff0c\u4f8b\u5982\u67e5\u770b\u67d0\u4e00\u7528\u6237\u53d1\u8d34\u91cf\uff1a select count ( * ) from wanted_post where user_id = xxxx ; \u4e0a\u9762\u4e3e\u4e2a\u901a\u7528\u7684\u4f8b\u5b50\uff0c\u539f\u5219\u4e0a\u8981\u5c06\u5728\u7ebf\u7528\u6237\u8bf7\u6c42\u548c\u540e\u53f0\u7edf\u8ba1\u8bf7\u6c42\u5206\u5f00\u3002\u7b80\u5355\u6765\u8bb2\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u9700\u6c42\u5904\u7406\u5982\u4e0b\uff1a \u5c06\u8bf7\u6c42\u6307\u5411\u4e0d\u540cslave \uff0c\u8fd9\u79cd\u65b9\u6cd5\u7b80\u5355\u9ad8\u6548\uff0c\u7f3a\u70b9\u662f\u6570\u636e\u91cf\u589e\u5927\u5c31\u73a9\u4e0d\u8f6c\u3002 \u5efa\u7acb\u79bb\u7ebf\u62a5\u8868\u5e93\uff0c\u4e13\u95e8\u5b58\u653e\u7edf\u8ba1\u7ed3\u679c\uff0c\u8fd9\u6837\u5c06\u8ba1\u7b97\u4e0e\u5c55\u793a\u5f02\u6b65\u5904\u7406\uff0c\u7f3a\u70b9\u662f\u5bf9\u4e8e\u5b9e\u65f6\u4e1a\u52a1\u54cd\u5e94\u4e0d\u597d\u3002 \u5b9e\u65f6\u62c9\u53d6mysql row binlog\uff0c\u505a\u6570\u636e\u7684\u5f02\u6784\u5904\u7406(tungsten, canal)\uff0c\u5c06\u589e\u91cf\u7ed3\u679c\u5904\u7406\u540e(storm)\uff0c\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u57fa\u672c\u5b9e\u65f6\u3002","title":"[\u5728\u7ebf\u5904\u7406\u4e0e\u5206\u6790\u5206\u79bb]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_9","text":"\u7528\u6237\u751f\u6210\u5185\u5bb9\u548c\u7528\u6237\u884c\u4e3a\u65e5\u5fd7\u8981\u5206\u5f00\uff0c\u8fd9\u4e00\u70b9\u5f88\u597d\u7406\u89e3\uff0c\u4e3e\u4e24\u4e2a\u4f8b\u5b50\uff1a \u6e38\u620fDB\u91cc\u5b58\u653e\u73a9\u5bb6\u7684\u57fa\u7840\u4fe1\u606f\uff0c\u88c5\u5907\uff0c\u5c5e\u6027\uff0c\u597d\u53cb\u5217\u8868\u7b49\u7b49\uff0c\u8fd9\u4e9b\u653e\u5230\u6570\u636e\u5e93\u91cc\u9762\u3002\u4f46\u662f\u73a9\u5bb6\u7684\u884c\u4e3a\u65e5\u5fd7\uff0c\u6bd4\u5982\u6d88\u8017\u91d1\u5e01\uff0c\u4eca\u5929\u4e0b\u8fc7\u54ea\u4e9b\u526f\u672c\uff0c\u4e70\u8fc7\u4ec0\u4e48\u9876\u7ea7\u88c5\u5907\uff0c\u8fd9\u4e9b\u5c5e\u4e8e\u884c\u4e3a\u65e5\u5fd7\uff0c\u5e94\u8be5\u5355\u72ec\u5b58\u653e\u5e76\u5206\u6790\u5904\u7406\u3002 \u5bf9\u4e8eweb\u7528\u8bb0\uff0c\u6709\u597d\u591a\u7528\u6237\u7f6e\u9876\uff0c\u5237\u65b0\uff0c\u7ade\u4ef7\uff0c\u5c55\u793a\u7b49\u884c\u4e3a\uff0c\u8981\u6c42\u5b9e\u65f6\u5e76\u4e14\u91cf\u5f88\u5927\uff0c\u4e00\u5b9a\u8981\u548c\u8d34\u5b50\u5206\u5f00\u3002 \u884c\u4e3a\u65e5\u5fd7\uff0c\u9700\u8981\u505a\u5206\u6790\u5904\u7406\uff0c\u5e76\u4e14\u7531\u4e8e\u65f6\u6548\u6027\u4e0d\u5b9c\u5b58\u50a8\u5728mysql\u4e2d\uff0c\u540e\u671f\u7ef4\u62a4\u5c31\u662f\u5730\u96f7\u3002","title":"[\u4e8b\u52a1\u4e0e\u65e5\u5fd7\u5206\u79bb]"},{"location":"other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#_10","text":"\u5728\u6570\u636e\u5e93\u8bbe\u8ba1\u7684\u65f6\u5019\u4e3a\u4e86\u4fdd\u969c\u6570\u636e\u662f\u53ef\u8ffd\u6eaf\u7684\uff0c\u5e94\u5f53\u9075\u5faa\u4e00\u4e9b\u7b80\u5355\u7684\u7ea6\u5b9a\uff0c\u4e8b\u540e\u65b9\u4fbf\u6570\u636e\u7684\u67e5\u8be2\u548c\u7edf\u8ba1\uff1a \u5bf9\u4e8e\u72b6\u6001\u6570\u636e\uff0c\u5e94\u5f53\u8bbe\u8ba1\u76f8\u5e94\u72b6\u6001\u7684\u5b57\u6bb5\u6765\u4fdd\u5b58\u8be5\u6570\u636e\u7684\u6700\u540e\u72b6\u6001\uff0c\u540c\u65f6\u8bb0\u5f55\u4e0b\u6765\u8be5\u6570\u636e\u7684\u521d\u59cb\u521b\u5efa\u4eba\uff0c\u65f6\u95f4\u4ee5\u53ca\u8be5\u6570\u636e\u7684\u6700\u540e\u4fee\u6539\u4eba\u548c\u4fee\u6539\u65f6\u95f4\uff1b\u6240\u4ee5\u5728\u4ea4\u6613\u6570\u636e\uff08\u5982\u8ba2\u5355\u5408\u540c\uff09\uff0c\u5e7f\u544a\u6570\u636e\uff0c\u8d26\u6237\u8868\u7b49\u90fd\u5e94\u8be5\u9ed8\u8ba4\u6709\u72b6\u6001\uff08status\uff09\uff0c\u521b\u5efa\u4eba\uff08creator/creator_name\uff09\uff0c\u521b\u5efa\u65f6\u95f4\uff08created_at\uff09\uff0c\u6700\u540e\u4fee\u6539\u4eba\uff08modifier/modifier_name\uff09\uff0c\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff08modified_at\uff09\u7b49\u5b57\u6bb5\u7528\u6765\u8868\u660e\u6570\u636e\u7684\u5f53\u524d\u72b6\u6001\uff0c\u521b\u5efa\u4fe1\u606f\u53ca\u4fee\u6539\u4fe1\u606f\u3002 \u9488\u5bf9\u9700\u8981\u8ddf\u8e2a\u6bcf\u6b21\u4fee\u6539\u7684\u6570\u636e\uff0c\u9700\u8981\u5728\u6570\u636e\u53d1\u751f\u53d8\u5316\u7684\u65f6\u5019\u8bb0\u5f55\u4e00\u5f20\u65e5\u5fd7\u8868\uff0c\u7528\u4e8e\u8bb0\u5f55\u8be5\u6570\u636e\u53d1\u751f\u53d8\u5316\u7684\u5168\u751f\u547d\u5468\u671f\u3002\u9488\u5bf9\u53ea\u9700\u8981\u5173\u6ce8\u5173\u952e\u5b57\u6bb5\u53d8\u5316\u7684\u60c5\u51b5\uff0c\u5219\u65e5\u5fd7\u8868\u4e2d\u53ea\u9700\u8981\u8bb0\u5f55\u5173\u952e\u5b57\u6bb5\u53d8\u5316\u5373\u53ef\uff0c\u4f46\u64cd\u4f5c\u4eba\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u65f6\u95f4\u5e94\u5f53\u51c6\u786e\u8bb0\u5f55\uff0c\u65e5\u5fd7\u8868\u6570\u636e\u4e00\u65e6\u751f\u6210\u4e0d\u5141\u8bb8\u8fdb\u884c\u4fee\u6539\u3002\u5982\u7528\u6237\u8d26\u6237\u7684\u5145\u503c\u6d41\u6c34\uff0c\u6d88\u8d39\u6d41\u6c34\u90fd\u662f\u4e00\u4e9b\u4e1a\u52a1\u7d27\u76f8\u5173\u7684\u65e5\u5fd7\u3002\u800c\u5ba1\u6838\u65e5\u5fd7\uff0c\u64cd\u4f5c\u8bb0\u5f55\u7b49\u65e5\u5fd7\u5219\u5c5e\u4e8e\u4e0e\u4e1a\u52a1\u5173\u8054\u8f83\u5c0f\u7684\u65e5\u5fd7\u3002 \u9488\u5bf9\u6240\u6709\u5386\u53f2\u9700\u8981\u4fdd\u7559\u7684\u6570\u636e\u5219\u9700\u8981\u6bcf\u6b21\u53d8\u5316\u90fd\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u7248\u672c\uff0c\u6bd4\u5982\u7c7b\u76ee\u4fe1\u606f\u7b49\uff0c\u5bf9\u539f\u59cb\u6570\u636e\u6c38\u8fdc\u53ea\u505ainsert\u64cd\u4f5c\uff0c\u4e0d\u505adelete\u53caupdate\u64cd\u4f5c\u3002\u4f46\u8fd9\u79cd\u60c5\u51b5\u4ec5\u9650\u4e8e\u6781\u7aef\u6570\u636e\u5386\u53f2\u8981\u6c42\u6781\u9ad8\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002","title":"[\u5386\u53f2\u53ef\u8ffd\u6eaf]"},{"location":"other/PHP-Trait%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E7%9A%84%E5%AE%9E%E7%8E%B0/","tags":"[php trait]","text":"\u5b98\u65b9\u5730\u5740\uff1a http://php.net/manual/en/language.oop5.traits.php \u81ea PHP 5.4.0 \u8d77\uff0cPHP \u5b9e\u73b0\u4e86\u4ee3\u7801\u590d\u7528\u7684\u4e00\u4e2a\u65b9\u6cd5\uff0c\u79f0\u4e3a traits\u3002 Traits \u662f\u4e00\u79cd\u4e3a\u7c7b\u4f3c PHP \u7684\u5355\u7ee7\u627f\u8bed\u8a00\u800c\u51c6\u5907\u7684\u4ee3\u7801\u590d\u7528\u673a\u5236\u3002Trait \u4e3a\u4e86\u51cf\u5c11\u5355\u7ee7\u627f\u8bed\u8a00\u7684\u9650\u5236\uff0c\u4f7f\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u81ea\u7531\u5730\u5728\u4e0d\u540c\u5c42\u6b21\u7ed3\u6784\u5185\u72ec\u7acb\u7684\u7c7b\u4e2d\u590d\u7528\u65b9\u6cd5\u96c6\u3002Traits \u548c\u7c7b\u7ec4\u5408\u7684\u8bed\u4e49\u662f\u5b9a\u4e49\u4e86\u4e00\u79cd\u65b9\u5f0f\u6765\u51cf\u5c11\u590d\u6742\u6027\uff0c\u907f\u514d\u4f20\u7edf\u591a\u7ee7\u627f\u548c\u6df7\u5165\u7c7b\uff08Mixin\uff09\u76f8\u5173\u7684\u5178\u578b\u95ee\u9898\u3002 Trait \u548c\u4e00\u4e2a\u7c7b\u76f8\u4f3c\uff0c\u4f46\u4ec5\u4ec5\u65e8\u5728\u7528\u7ec6\u7c92\u5ea6\u548c\u4e00\u81f4\u7684\u65b9\u5f0f\u6765\u7ec4\u5408\u529f\u80fd\u3002Trait \u4e0d\u80fd\u901a\u8fc7\u5b83\u81ea\u8eab\u6765\u5b9e\u4f8b\u5316\u3002\u5b83\u4e3a\u4f20\u7edf\u7ee7\u627f\u589e\u52a0\u4e86\u6c34\u5e73\u7279\u6027\u7684\u7ec4\u5408\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u5e94\u7528\u7c7b\u7684\u6210\u5458\u4e0d\u9700\u8981\u7ee7\u627f\u3002 \u5728\u6211\u7406\u89e3\u8bf4\u767d\u4e86\u5c31\u662f\u5728\u7ee7\u627f\u7c7b\u94fe\u4e2d\u9694\u79bb\u4e86\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u7684\u67d0\u4e9b\u7279\u6027\uff08\u5c31\u662f\u5b50\u7c7b\u201c\u8981\u7528\u7236\u7c7b\u7684\u7279\u6027\u7684\u65f6\u5019\u201d\uff0c\u5982\u679ctrait\u6709\uff0c\u5c31\u4f18\u5148\u8c03\u7528trait\u7684\u65b9\u6cd5\u3001\u5c5e\u6027\u7b49\uff09\u3002 <?php trait MyTrait { protected $var = \"MyTrait_var\" ; protected $var1 = \"MyTrait_var\" ; function __construct () { echo $this -> var . PHP_EOL ; } function a () { echo \"a\" . PHP_EOL ; } } interface MyInterface { function __construct (); function b (); } abstract class MyAbstract { protected $var2 = \"MyAbstract_var\" ; use MyTrait ; function b () { echo \"b\" . PHP_EOL ; } } class MyClass extends MyAbstract implements MyInterface { protected $var3 = \"MyClass_var\" ; //\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u5f15\u7528\uff0c\u4e0d\u533a\u5206\u7ee7\u627f\u5173\u7cfb //use MyTrait; function c () { echo \"c\" . PHP_EOL ; } } $class = new MyClass (); $class -> a (); $class -> b (); $class -> c (); \u8f93\u51fa\u7ed3\u679c MyTrait_var a b c \u603b\u7ed3\uff1a \u4ece\u672c\u8d28\u4e0a\u8bf4\uff0ctrait\u548cinclude\u6587\u4ef6\u7684\u6982\u5ff5\u5dee\u4e0d\u591a trait\u53ef\u4ee5\u66f4\u52a0\u65b9\u4fbf\u7684\u5b9e\u73b0\u4ee3\u7801\u590d\u7528\uff0c\u56e0\u4e3a\u6211\u4eec\u7528\u7ee7\u627f\u5173\u7cfb\u5b9e\u73b0\u7684\u65e0\u6cd5\u5728\u7236\u7c7b\u4e2d\u8bbf\u95ee\u5b50\u7c7b\u7684private\u5c5e\u6027\u4e0e\u65b9\u6cd5\uff0c\u800ctrait\u5c31\u548c\u628a\u4ee3\u7801\u76f4\u63a5\u5199\u5728\u5bf9\u8c61\u91cc\u6548\u679c\u4e00\u6837\u3002 \u4f7f\u7528trait\u65f6\u5019\u5e94\u8be5\u575a\u51b3\u907f\u514d\u547d\u540d\u51b2\u7a81\uff0c\u5c24\u5176\u662f\u540c\u65f6\u4f7f\u7528\u591a\u4e2atrait\u65f6\u3002 \u5982\u679c\u4ea7\u751f\u4e86\u547d\u540d\u51b2\u7a81\uff0c\u5982\u679c\u4e24\u8005\u7684\u53ef\u89c1\u6027\u3001\u521d\u59cb\u503c\u3001static\u4e0e\u5426\u5b8c\u5168\u76f8\u540c\uff0c\u5219trait\u4e2d\u7684\u4f1a\u8986\u76d6\u6389\u5bf9\u8c61\u4e2d\u7684\uff0c\u5e76\u629b\u51faE_STRICT\u9519\u8bef\uff0c\u5426\u5219\u4f1a\u629b\u51faE_COMPILE_ERROR\u9519\u8bef\uff0c\u7ec8\u6b62\u7f16\u8bd1\u3002","title":"\"PHP Trait\u591a\u91cd\u7ee7\u627f\u7684\u5b9e\u73b0\""},{"location":"other/SQLite-database-disk-image-is-malformed-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","tags":"[sqlite]","text":"\u6211\u78b0\u5230\u7684\u8fd9\u79cd\u60c5\u51b5\uff0c\u5e76\u4e0d\u662f\u7f51\u4e0a\u8bf4\u7684\u78c1\u76d8\u574f\u4e86\u3002\u800c\u662f\u7531\u4e8e\u9891\u7e41\u8bfb\u5199\uff0c\u5e76\u4e14\u6709BLOB\u5927\u6570\u636e\u9891\u7e41\u8bfb\u5199\u3002 \u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u901a\u8fc7\u5bfc\u51fa\u5bfc\u5165\u65b9\u5f0f\u5bf9\u635f\u574f\u7684\u5e93\u6587\u4ef6\u4f5c\u6062\u590d\u3002 \u9996\u5148\u5bfc\u51fa\u6570\u636e sqlite3 my.sqlite3 sqlite>.output tmp.sql sqlite>.dump sqlite>.quit \u518d\u5bfc\u5165\u5230\u4e00\u4e2a\u65b0\u5e93\u4e2d sqlite3 new.sqlite3 sqlite>.read tmp.sql sqlite>.quit \u8986\u76d6new.sqlite\u6587\u4ef6\u5230sites/default/files/.ht.sqlite\u5373\u53ef\u3002 \u53e6\u5916\uff0c\u5982\u679c\u53ea\u662f\u4e34\u65f6\u6570\u636e\uff0c\u53ef\u4ee5\u653e\u5230/dev/shm\uff0c\u5c31\u662f\u5185\u5b58\u6570\u636e\u5e93\u5566\u3002\u3002\u3002","title":"\"Drupal SQLite: database disk image is malformed \u89e3\u51b3\u65b9\u6cd5\""},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/","tags":"[tokudb]","text":"\u5728percona\u5b98\u7f51https:// www.percona.com/ \u4e0b\u8f7d\u5e26\u6709Tokudb\u7684\u4e8c\u8fdb\u5236\u5305\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u6e90\u7801\u7f16\u8bd1\u3002tokudb\u6709\u5355\u72ec\u7684\u5305. \u6211\u8fd9\u91cc\u4e0b\u8f7d\u7684\u662f\u6700\u65b0\u7684\u5305\uff0c5.6.25-73 Percona-Server-5.6.25-rel73.1-Linux.x86_64.ssl101.tar.gz Percona-Server-5.6.25-rel73.1-TokuDB.Linux.x86_64.ssl101.tar.gz \u524d\u671f\u8d26\u53f7\u521b\u5efa \u00b6 shell> groupadd mysql shell> useradd -g mysql mysql \u89e3\u538b\u8f6f\u4ef6\u5305 \u00b6 shell> cd /usr/local shell> tar -zxvf Percona-Server-5.6.25-rel73.1-Linux.x86_64.ssl101.tar.gz shell> tar -zxvf Percona-Server-5.6.25-rel73.1-TokuDB.Linux.x86_64.ssl101.tar.gz shell> ln -s Percona-Server-5.6.25-rel73.1-Linux.x86_64.ssl101 mysql \u8bbe\u7f6e\u6743\u9650 \u00b6 shell> cd mysql shell> chown -R mysql . shell> chgrp -R mysql . \u521b\u5efa\u914d\u7f6e\u6587\u4ef6/etc/my.cnf \u00b6 \u521b\u5efa\u5b58\u653e\u6570\u636e\u6e90\u7684\u76ee\u5f55 Shell> mkdir -p /var/lib/mysql Shell> mkdir -p /data/mysqldata /data/mysqllog Shell> chown -R mysql:mysql /var/lib/mysql /data/mysqldata /data/mysqllog \u5728\u9644\u4ef6\u4e2d\u7ed9\u51fa\uff0c\u8bf7\u53c2\u8003\u9644\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9 \u521d\u59cb\u5316DB \u00b6 Shell> scripts/mysql_install_db --user=mysql --defaults-file=/etc/my.cnf shell> chown -R root . \u4fee\u6539\u7cfb\u7edf\u53c2\u6570 \u00b6 echo never > /sys/kernel/mm/redhat_transparent_hugepage/defrag echo never > /sys/kernel/mm/redhat_transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/defrag \u5efa\u8bae\u5199\u5230 /etc/rc.local \u4e2d\uff0c\u91cd\u542f\u540e\u4e5f\u53ef\u751f\u6548 \u542f\u52a8\u6570\u636e\u5e93 \u00b6 shell> bin/mysqld_safe --user=mysql & \u628a\u542f\u52a8\u6587\u4ef6\u653e\u53bb\u81ea\u542f\u52a8\u4e2d \u00b6 cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld chkconfig --add mysqld service mysqld start service mysqld stop \u7136\u540e\u542f\u52a8\u3002 mysql> show engines; +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | Engine | Support | Comment | Transactions | XA | Savepoints | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | InnoDB | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys | YES | YES | YES | | CSV | YES | CSV storage engine | NO | NO | NO | | MRG_MYISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | | BLACKHOLE | YES | /dev/null storage engine (anything you write to it disappears) | NO | NO | NO | | MEMORY | YES | Hash based, stored in memory, useful for temporary tables | NO | NO | NO | | TokuDB | YES | Tokutek TokuDB Storage Engine with Fractal Tree(tm) Technology | YES | YES | YES | | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | | ARCHIVE | YES | Archive storage engine | NO | NO | NO | | MyISAM | YES | MyISAM storage engine | NO | NO | NO | | FEDERATED | NO | Federated MySQL storage engine | NULL | NULL | NULL | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ 10 rows in set (0.00 sec) \u770b\u5230\u4e0a\u9762\u4e00\u884c\u7ea2\u5b57\u5c31\u4ee3\u8868\u6570\u636e\u5e93\u652f\u6301TokuDB\u7684\u5b58\u50a8\u5f15\u64ce\u4e86\u3002 tokudb\u5b89\u88c5\u987a\u5229\u5b8c\u6210\uff0c\u540e\u9644\u914d\u7f6e\u6587\u4ef6 [ root@localhost mysql ] # cat /etc/my.cnf [ mysqld ] datadir = /var/lib/mysql socket = /var/lib/mysql/mysql.sock user = mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links = 0 #public max_connections = 3000 max_connect_errors = 6000 key_buffer_size = 384M low_priority_updates = 1 back_log = 1500 query_cache_type = 1 query_cache_size = 64M query_cache_limit = 4M query_cache_min_res_unit = 2k tmp_table_size = 256M read_buffer_size = 1M read_rnd_buffer_size = 16M bulk_insert_buffer_size = 64M max_allowed_packet = 64M thread_cache_size = 300 #file innodb_file_per_table #buffer innodb_buffer_pool_size = 2500M innodb_log_buffer_size = 64M join_buffer_size = 16M sort_buffer_size = 16M innodb_max_dirty_pages_pct = 90 innodb_lock_wait_timeout = 120 innodb_thread_concurrency = 16 innodb_flush_log_at_trx_commit = 2 character_set_server = utf8 init_connect = 'SET NAMES utf8' #tokudb plugin_dir = /usr/local/mysql/lib/mysql/plugin/ plugin_load = ha_tokudb.so #\u628aTokuDB datadir\u4ee5\u53calogdir\u548cMySQL\u7684datadir\u5206\u5f00\uff0c\u7f8e\u89c2\u70b9\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5206\u5f00\uff0c\u6ce8\u91ca\u6389\u672c\u884c\u4ee5\u53ca\u4e0b\u97622\u884c\u5373\u53ef tokudb_data-dir = /data/mysqldata tokudb_log-dir = /data/mysqllog #TokuDB\u7684\u884c\u6a21\u5f0f\uff0c\u5efa\u8bae\u7528 FAST \u5c31\u8db3\u591f\u4e86\uff0c\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u5f88\u7d27\u5f20\uff0c\u5efa\u8bae\u7528 SMALL tokudb_row_format = tokudb_small tokudb_row_format = tokudb_fast tokudb_cache_size = 2G #\u5176\u4ed6\u5927\u90e8\u5206\u914d\u7f6e\u5176\u5b9e\u53ef\u4ee5\u4e0d\u7528\u4fee\u6539\u7684\uff0c\u53ea\u9700\u8981\u51e0\u4e2a\u5173\u952e\u914d\u7f6e\u5373\u53ef tokudb_commit_sync = 0 tokudb_directio = 1 tokudb_read_block_size = 128K tokudb_read_buf_size = 128K [ mysqld_safe ] log-error = /var/log/mysqld.log pid-file = /var/run/mysqld/mysqld.pid malloc_lib = /usr/local/mysql/lib/mysql/libjemalloc.so #\u53ea\u80fd\u653e\u5728mysqld_safe\u4e2d\uff0c\u4e0d\u5f97\u62a5\u9519","title":"\"centos6.6\u5b89\u88c5Percona Tokudb\""},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#_1","text":"shell> groupadd mysql shell> useradd -g mysql mysql","title":"\u524d\u671f\u8d26\u53f7\u521b\u5efa"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#_2","text":"shell> cd /usr/local shell> tar -zxvf Percona-Server-5.6.25-rel73.1-Linux.x86_64.ssl101.tar.gz shell> tar -zxvf Percona-Server-5.6.25-rel73.1-TokuDB.Linux.x86_64.ssl101.tar.gz shell> ln -s Percona-Server-5.6.25-rel73.1-Linux.x86_64.ssl101 mysql","title":"\u89e3\u538b\u8f6f\u4ef6\u5305"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#_3","text":"shell> cd mysql shell> chown -R mysql . shell> chgrp -R mysql .","title":"\u8bbe\u7f6e\u6743\u9650"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#etcmycnf","text":"\u521b\u5efa\u5b58\u653e\u6570\u636e\u6e90\u7684\u76ee\u5f55 Shell> mkdir -p /var/lib/mysql Shell> mkdir -p /data/mysqldata /data/mysqllog Shell> chown -R mysql:mysql /var/lib/mysql /data/mysqldata /data/mysqllog \u5728\u9644\u4ef6\u4e2d\u7ed9\u51fa\uff0c\u8bf7\u53c2\u8003\u9644\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9","title":"\u521b\u5efa\u914d\u7f6e\u6587\u4ef6/etc/my.cnf"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#db","text":"Shell> scripts/mysql_install_db --user=mysql --defaults-file=/etc/my.cnf shell> chown -R root .","title":"\u521d\u59cb\u5316DB"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#_4","text":"echo never > /sys/kernel/mm/redhat_transparent_hugepage/defrag echo never > /sys/kernel/mm/redhat_transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/defrag \u5efa\u8bae\u5199\u5230 /etc/rc.local \u4e2d\uff0c\u91cd\u542f\u540e\u4e5f\u53ef\u751f\u6548","title":"\u4fee\u6539\u7cfb\u7edf\u53c2\u6570"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#_5","text":"shell> bin/mysqld_safe --user=mysql &","title":"\u542f\u52a8\u6570\u636e\u5e93"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#_6","text":"cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld chkconfig --add mysqld service mysqld start service mysqld stop \u7136\u540e\u542f\u52a8\u3002 mysql> show engines; +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | Engine | Support | Comment | Transactions | XA | Savepoints | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | InnoDB | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys | YES | YES | YES | | CSV | YES | CSV storage engine | NO | NO | NO | | MRG_MYISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | | BLACKHOLE | YES | /dev/null storage engine (anything you write to it disappears) | NO | NO | NO | | MEMORY | YES | Hash based, stored in memory, useful for temporary tables | NO | NO | NO | | TokuDB | YES | Tokutek TokuDB Storage Engine with Fractal Tree(tm) Technology | YES | YES | YES | | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | | ARCHIVE | YES | Archive storage engine | NO | NO | NO | | MyISAM | YES | MyISAM storage engine | NO | NO | NO | | FEDERATED | NO | Federated MySQL storage engine | NULL | NULL | NULL | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ 10 rows in set (0.00 sec) \u770b\u5230\u4e0a\u9762\u4e00\u884c\u7ea2\u5b57\u5c31\u4ee3\u8868\u6570\u636e\u5e93\u652f\u6301TokuDB\u7684\u5b58\u50a8\u5f15\u64ce\u4e86\u3002 tokudb\u5b89\u88c5\u987a\u5229\u5b8c\u6210\uff0c\u540e\u9644\u914d\u7f6e\u6587\u4ef6 [ root@localhost mysql ] # cat /etc/my.cnf [ mysqld ] datadir = /var/lib/mysql socket = /var/lib/mysql/mysql.sock user = mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links = 0 #public max_connections = 3000 max_connect_errors = 6000 key_buffer_size = 384M low_priority_updates = 1 back_log = 1500 query_cache_type = 1 query_cache_size = 64M query_cache_limit = 4M query_cache_min_res_unit = 2k tmp_table_size = 256M read_buffer_size = 1M read_rnd_buffer_size = 16M bulk_insert_buffer_size = 64M max_allowed_packet = 64M thread_cache_size = 300 #file innodb_file_per_table #buffer innodb_buffer_pool_size = 2500M innodb_log_buffer_size = 64M join_buffer_size = 16M sort_buffer_size = 16M innodb_max_dirty_pages_pct = 90 innodb_lock_wait_timeout = 120 innodb_thread_concurrency = 16 innodb_flush_log_at_trx_commit = 2 character_set_server = utf8 init_connect = 'SET NAMES utf8' #tokudb plugin_dir = /usr/local/mysql/lib/mysql/plugin/ plugin_load = ha_tokudb.so #\u628aTokuDB datadir\u4ee5\u53calogdir\u548cMySQL\u7684datadir\u5206\u5f00\uff0c\u7f8e\u89c2\u70b9\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5206\u5f00\uff0c\u6ce8\u91ca\u6389\u672c\u884c\u4ee5\u53ca\u4e0b\u97622\u884c\u5373\u53ef tokudb_data-dir = /data/mysqldata tokudb_log-dir = /data/mysqllog #TokuDB\u7684\u884c\u6a21\u5f0f\uff0c\u5efa\u8bae\u7528 FAST \u5c31\u8db3\u591f\u4e86\uff0c\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u5f88\u7d27\u5f20\uff0c\u5efa\u8bae\u7528 SMALL tokudb_row_format = tokudb_small tokudb_row_format = tokudb_fast tokudb_cache_size = 2G #\u5176\u4ed6\u5927\u90e8\u5206\u914d\u7f6e\u5176\u5b9e\u53ef\u4ee5\u4e0d\u7528\u4fee\u6539\u7684\uff0c\u53ea\u9700\u8981\u51e0\u4e2a\u5173\u952e\u914d\u7f6e\u5373\u53ef tokudb_commit_sync = 0 tokudb_directio = 1 tokudb_read_block_size = 128K tokudb_read_buf_size = 128K [ mysqld_safe ] log-error = /var/log/mysqld.log pid-file = /var/run/mysqld/mysqld.pid malloc_lib = /usr/local/mysql/lib/mysql/libjemalloc.so #\u53ea\u80fd\u653e\u5728mysqld_safe\u4e2d\uff0c\u4e0d\u5f97\u62a5\u9519","title":"\u628a\u542f\u52a8\u6587\u4ef6\u653e\u53bb\u81ea\u542f\u52a8\u4e2d"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/","tags":"[tokudb]","text":"ps: \u5982\u679c\u60f3\u5728mariadb10\u4e0a\u4f7f\u7528tokudb\u5c31\u53ea\u80fd\u81ea\u5df1\u7f16\u8bd1\u4e86\u3002\u3002\u3002\u3002 \u4e00\u3001\u73af\u5883\u51c6\u5907\uff1a \u00b6 tokudb\u7684\u7f16\u8bd1\u9700\u8981cmake 2.8.9+ \u548c gcc 4.7+ \u672c\u6587\u9009\u7528cmake 2.8.9 \u548c gcc4.8.1\u3002 \u8fd92\u4e2a\u8f6f\u4ef6\u90fd\u53ea\u80fd\u4f7f\u7528\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5\u3002 cmake\u7684\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u4e0b\u8f7d wget http://www.cmake.org/files/v2.8/cmake-2.8.9.tar.gz \u7136\u540e\u89e3\u538b\u8fdb\u884c\u7f16\u8bd1 ./configure make & make install \u4e8c\u3001\u5b89\u88c5gcc 4.8.1 \u00b6 1\u3001\u4e0b\u8f7dgcc 4.8.1\u6e90\u7801\u5305\uff1a \u00b6 http://ftp.tsukuba.wide.ad.jp/software/gcc/releases/gcc-4.8.1/gcc-4.8.1.tar.bz2 \u6211\u662f\u865a\u62df\u673a\u91cc\u9762\u88c5\u7684Linux\uff0c\u6211\u5accwget\u592a\u6162\uff0c\u6240\u4ee5\u81ea\u5df1\u5728Windows\u4e0a\u7528\u8fc5\u96f7\u4e0b\u597d\uff0c\u7136\u540e\u5171\u4eab\u5230Linux\u4e2d\u3002 2\u3001\u89e3\u538b\uff1a \u00b6 tar -jxvf gcc-4.8.1.tar.bz2 3\u3001\u4e0b\u8f7d\u7f16\u8bd1\u6240\u9700\u7684\u4f9d\u8d56\u5305\uff1a \u00b6 \u8fd9\u4e2a\u6b65\u9aa4\u6709\u4e24\u79cd\u65b9\u5f0f\u5b8c\u6210\uff1a a) \u5982\u679cLinux\u6709\u7f51\u7edc\u8fde\u63a5\uff0c\u76f4\u63a5\u8fd9\u6837\uff1a cd gcc-4.8.1 ./contrib/download_prerequisites cd .. b) \u5982\u679cLinux\u6ca1\u6709\u7f51\u7edc\u8fde\u63a5\uff08\u6211\u4e3b\u673a\u548c\u865a\u62df\u673a\u662fHost-only\uff0c\u4e0d\u80fd\u8054\u7f51\uff0c\u6240\u4ee5\u53e6\u5916\u60f3\u529e\u6cd5\uff09\uff0c\u5219\u7528Windows\u4e0a\u7f51\u4e0b\u8f7d\u8fd9\u51e0\u4e2a\u5305\uff1a ftp://ftp.gnu.org/gnu/gmp/gmp-4.3.2.tar.bz2 http://www.mpfr.org/mpfr-2.4.2/mpfr-2.4.2.tar.bz2 http://www.multiprecision.org/mpc/download/mpc-0.8.1.tar.gz \u6709\u4eba\u95ee\uff0c\u4e00\u5b9a\u8981\u4e0b\u8f7d\u51e0\u4e2a\u7248\u672c\u5417\uff1f\u4e0b\u8f7d\u6700\u65b0\u7684\u7248\u672c\u884c\u4e0d\u884c\uff1f\u6211\u6ca1\u8bd5\u8fc7\uff0c\u4e5f\u4e0d\u77e5\u9053\uff0c\u6211\u662f\u6309\u7167gcc-4.8.1/contrib/download_prerequisites\u811a\u672c\u91cc\u9762\u7684\u7248\u672c\u4e0b\u8f7d\u7684\u3002\u65e2\u7136\u91cc\u9762\u5df2\u7ecf\u8bf4\u4e86\u8fd9\u51e0\u4e2a\u7248\u672c\uff0c\u90a3\u6211\u5c31\u4e25\u683c\u6309\u7167\u5b83\u7684\u8981\u6c42\u6765\u505a\u3002 \u7136\u540e\u89e3\u538b\u5e76\u79fb\u52a8\u5230gcc-4.8.1\u4e0b\u9762\uff1a tar -xjf gmp-4.3.2.tar.bz2 tar -xjf mpfr-2.4.2.tar.bz2 tar -xzf mpc-0.8.1.tar.gz mv gmp-4.3.2 gcc-4.8.1/gmp mv mpfr-2.4.2 gcc-4.8.1/mpfr mv mpc-0.8.1 gcc-4.8.1/mpc \u8fd9\u6837\u7684\u505a\u6cd5\u597d\u5904\u662f\uff0c\u4e0d\u7528\u5355\u72ec\u7f16\u8bd1gmp\u3001mpfr\u548cmpc\u4e09\u4e2a\u5305\uff0c\u653e\u5728gcc\u6e90\u7801\u4e0b\u9762\u4e00\u8d77\u7f16\u8bd1\uff08\u4e8b\u5b9e\u4e0a\u8fd9\u4e5f\u662fgcc-4.8.1/contrib/download_prerequisites\u811a\u672c\u7684\u505a\u6cd5\uff0c\u4e2a\u4eba\u611f\u89c9\u66f4\u7b80\u6d01\u4e9b\uff09\u3002 4\u3001\u65b0\u5efa\u76ee\u5f55\u7528\u4e8e\u5b58\u653e\u7f16\u8bd1\u7ed3\u679c\uff1a \u00b6 mkdir gcc-build-4.8.1 5\u3001\u8fdb\u5165\u65b0\u76ee\u5f55\uff0c\u5e76\u6267\u884cconfigure\u547d\u4ee4\uff0c\u4ea7\u751fmakefile\uff1a \u00b6 cd gcc-build-4.8.1 ../gcc-4.8.1/configure --enable-checking = release --enable-languages = c,c++ --disable-multilib \u5177\u4f53\u9009\u9879\u4e0d\u591a\u89e3\u91ca\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u67e5\u770b\uff0c\u6211\u53ea\u7528\u5230c\u548cc++\uff0c\u6240\u4ee5\u53ea\u7f16\u8bd1\u8fd9\u4e24\u79cd\u8bed\u8a00\u7684\u7f16\u8bd1\u5668\u3002 6\u3001\u7f16\u8bd1\uff1a \u00b6 make -j4 \u6211\u662fi5\u56db\u6838\uff0c\u6240\u4ee5\u5f004\u4e2a\u7ebf\u7a0b\u540c\u65f6\u7f16\u8bd1\uff0c\u8981\u662f\u67098\u6838\u5c31\u66f4\u723d\u4e86~\u6211\u5728\u865a\u62df\u673a\u91cc\u9762\u82b1\u4e8630\u5206\u949f\u4e0d\u5230\u7684\u65f6\u95f4\uff0c\u4e0d\u7b97\u592a\u6162\u4e86\u3002 7\u3001\u5b89\u88c5\uff1a \u00b6 sudo make install 8\u3001\u5927\u529f\u544a\u6210\uff0c\u68c0\u67e5\u7248\u672c\uff1a \u00b6 g++ --version g++ ( GCC ) 4 .8.1 Copyright ( C ) 2013 Free Software Foundation, Inc. This is free software ; see the source for copying conditions. There is NO warranty ; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. \u4e09\u3001\u7f16\u8bd1\u5b89\u88c5 \u00b6 \u4e0b\u8f7dmariadb\u6e90\u7801mariadb-10.0.14.tar.gz https://downloads.mariadb.org/mariadb/10.0.14/ \u9996\u5148\u9700\u8981\u4fee\u6539tokudb\u7684cmake\u7f16\u8bd1\u6587\u4ef6\uff0c\u53bb\u6389fuse-linker-plugin\u76f8\u5173\u5185\u5bb9 \u4fee\u6539mariadb-10.0.14/storage/tokudb/ft-index/cmake_modules/TokuSetupCompiler.cmake \u53bb\u6389\u6240\u6709\u7684 -fuse-linker-plugin \uff1a # set(CMAKE_C_FLAGS_RELWITHDEBINFO \"-flto -fuse-linker-plugin ${CMAKE_C_FLAGS_RELWITHDEBINFO} -g -O3 -UNDEBUG\") # set(CMAKE_CXX_FLAGS_RELWITHDEBINFO \"-flto -fuse-linker-plugin ${CMAKE_CXX_FLAGS_RELWITHDEBINFO} -g -O3 -UNDEBUG\") # set(CMAKE_C_FLAGS_RELEASE \"-g -O3 -flto -fuse-linker-plugin ${CMAKE_C_FLAGS_RELEASE} -UNDEBUG\") # set(CMAKE_CXX_FLAGS_RELEASE \"-g -O3 -flto -fuse-linker-plugin ${CMAKE_CXX_FLAGS_RELEASE} -UNDEBUG\") # set(CMAKE_EXE_LINKER_FLAGS \"-g -fuse-linker-plugin ${CMAKE_EXE_LINKER_FLAGS}\") # set(CMAKE_SHARED_LINKER_FLAGS \"-g -fuse-linker-plugin ${CMAKE_SHARED_LINKER_FLAGS}\") set ( CMAKE_C_FLAGS_RELWITHDEBINFO \"-flto ${ CMAKE_C_FLAGS_RELWITHDEBINFO } -g -O3 -UNDEBUG\" ) set ( CMAKE_CXX_FLAGS_RELWITHDEBINFO \"-flto ${ CMAKE_CXX_FLAGS_RELWITHDEBINFO } -g -O3 -UNDEBUG\" ) set ( CMAKE_C_FLAGS_RELEASE \"-g -O3 -flto ${ CMAKE_C_FLAGS_RELEASE } -UNDEBUG\" ) set ( CMAKE_CXX_FLAGS_RELEASE \"-g -O3 -flto ${ CMAKE_CXX_FLAGS_RELEASE } -UNDEBUG\" ) set ( CMAKE_EXE_LINKER_FLAGS \"-g ${ CMAKE_EXE_LINKER_FLAGS } \" ) set ( CMAKE_SHARED_LINKER_FLAGS \"-g ${ CMAKE_SHARED_LINKER_FLAGS } \" ) \u7136\u540e\u662f/home/gao-compile/mariadb-10.0.14/storage/tokudb/CMakeLists.txt \u53bb\u6389\u6240\u6709\u7684 -fuse-linker-plugin \uff1a #SET(CMAKE_MODULE_LINKER_FLAGS_RELEASE \"${CMAKE_MODULE_LINKER_FLAGS_RELEASE} -flto -fuse-linker-plugin\") #SET(CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO \"${CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO} -flto -fuse-linker-plugin\") SET ( CMAKE_MODULE_LINKER_FLAGS_RELEASE \" ${ CMAKE_MODULE_LINKER_FLAGS_RELEASE } -flto\" ) SET ( CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO \" ${ CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO } -flto\" ) \u7136\u540e\u8fdb\u884c\u7f16\u8bd1\uff1a cd mariadb-10.0.14 mkdir release ./BUILD/compile-pentium64-max --prefix = /home/gao-compile/mariadb-10.0.14/release make install \u7136\u540e\u5728/home/gao-compile/mariadb-10.0.14/release/lib/plugin \u76ee\u5f55\u4e2d\u627e\u5230 ha_tokudb.so\u52a8\u6001\u5e93\u3002 \u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u8981\u7684\u4e1c\u897f\u4e86\uff01 \u6ce8\uff1a\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5728mariadb-10.0.14/storage/tokudb\u76ee\u5f55\u4e2d\u76f4\u63a5\u8fdb\u884c\u7f16\u8bd1\uff0c\u800c\u4e0d\u7528\u53bb\u7f16\u8bd1\u6574\u4e2amariadb\uff0c\u56e0\u4e3a\u7f16\u8bd1\u51fa\u6765\u7684\u4e5f\u65e0\u6cd5\u4f7f\u7528\uff0c mysqld\u53ef\u6267\u884c\u7a0b\u5e8f\u4f9d\u8d56GLIBCXX_3.4.15 [ root@GXX release ] # ldd bin/mysqld bin/mysqld: /usr/lib64/libstdc++.so.6: version ` GLIBCXX_3.4.15 ' not found ( required by bin/mysqld ) \u5728mariadb\u5b98\u7f51https://downloads.mariadb.org/mariadb/10.0.14/\u4e0b\u8f7d\u5e26\u6709mariadb\u7684\u4e8c\u8fdb\u5236\u5305\u3002\u4ecemariadb\u5b98\u7f51\u4e0b\u8f7d10.0.14\u7684\u4e0d\u5e26tokudb\u7684\u53ef\u6267\u884c\u7a0b\u5e8ftar\u5305\uff0c\u7136\u540e\u5c06\u6211\u4eec\u7f16\u8bd1\u597d\u7684tokudb.so\u62f7\u8d1d\u5230 [maradb10.0.14]/lib/plugin/\u4e0b \u6211\u8fd9\u91cc\u4e0b\u8f7d\u7684\u5305\uff0c10.0.14 mariadb-10.0.14-linux-x86_64.tar.gz \u56db\u3001\u521d\u59cb\u5316 \u00b6 1\u3001\u524d\u671f\u8d26\u53f7\u521b\u5efa \u00b6 shell> groupadd mysql shell> useradd -g mysql mysql 2\u3001\u89e3\u538b\u8f6f\u4ef6\u5305 \u00b6 shell> cd /usr/local shell> tar -zxvf mariadb-10.0.14-linux-x86_64.tar.gz shell> ln -s mariadb-10.0.14-linux-x86_64 mysql 3\u3001\u8bbe\u7f6e\u6743\u9650 \u00b6 shell> cd mysql shell> chown -R mysql . shell> chgrp -R mysql . 4\u3001\u521b\u5efa\u914d\u7f6e\u6587\u4ef6/etc/my.cnf \u00b6 \u521b\u5efa\u5b58\u653e\u6570\u636e\u6e90\u7684\u76ee\u5f55 Shell> mkdir -p /var/lib/mysql Shell> mkdir -p /data/mysqldata /data/mysqllog Shell> chown -R mysql:mysql /var/lib/mysql /data/mysqldata /data/mysqllog \u5728\u9644\u4ef6\u4e2d\u7ed9\u51fa\uff0c\u8bf7\u53c2\u8003\u9644\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9 5\u3001\u521d\u59cb\u5316DB \u00b6 Shell> scripts/mysql_install_db --user=mysql --defaults-file=/etc/my.cnf shell> chown -R root . 6\u3001\u4fee\u6539\u7cfb\u7edf\u53c2\u6570 \u00b6 echo never > /sys/kernel/mm/redhat_transparent_hugepage/defrag echo never > /sys/kernel/mm/redhat_transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/defrag \u5efa\u8bae\u5199\u5230 /etc/rc.local \u4e2d\uff0c\u91cd\u542f\u540e\u4e5f\u53ef\u751f\u6548 7\u3001\u542f\u52a8\u6570\u636e\u5e93 \u00b6 shell> bin/mysqld_safe --user=mysql & 8\u3001\u628a\u542f\u52a8\u6587\u4ef6\u653e\u53bb\u81ea\u542f\u52a8\u4e2d \u00b6 cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld chkconfig --add mysqld service mysqld start service mysqld stop 9\u3001\u5b89\u88c5tokudb\u652f\u6301 \u00b6 INSTALL SONAME 'ha_tokudb' ; \u67e5\u770b\u662f\u5426\u652f\u6301 MariaDB [( none )] > show engines -> ; +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | Engine | Support | Comment | Transactions | XA | Savepoints | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | MyISAM | YES | MyISAM storage engine | NO | NO | NO | | CSV | YES | CSV storage engine | NO | NO | NO | | MRG_MyISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | | BLACKHOLE | YES | /dev/null storage engine ( anything you write to it disappears ) | NO | NO | NO | | MEMORY | YES | Hash based, stored in memory, useful for temporary tables | NO | NO | NO | | TokuDB | YES | Tokutek TokuDB Storage Engine with Fractal Tree ( tm ) Technology | YES | YES | YES | | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | | ARCHIVE | YES | Archive storage engine | NO | NO | NO | | FEDERATED | YES | FederatedX pluggable storage engine | YES | NO | YES | | InnoDB | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys | YES | YES | YES | | Aria | YES | Crash-safe tables with MyISAM heritage | NO | NO | NO | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ 11 rows in set ( 0 .11 sec ) \u770b\u5230\u4e0a\u9762\u4e00\u884c\u7ea2\u5b57\u5c31\u4ee3\u8868\u6570\u636e\u5e93\u652f\u6301TokuDB\u7684\u5b58\u50a8\u5f15\u64ce\u4e86\u3002 tokudb\u5b89\u88c5\u987a\u5229\u5b8c\u6210\uff0c\u540e\u9644\u914d\u7f6e\u6587\u4ef6 [ root@localhost mysql ] # cat /etc/my.cnf [ mysqld ] datadir = /var/lib/mysql socket = /var/lib/mysql/mysql.sock user = mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links = 0 #public max_connections = 3000 max_connect_errors = 6000 key_buffer_size = 384M low_priority_updates = 1 back_log = 1500 query_cache_type = 1 query_cache_size = 64M query_cache_limit = 4M query_cache_min_res_unit = 2k tmp_table_size = 256M read_buffer_size = 1M read_rnd_buffer_size = 16M bulk_insert_buffer_size = 64M max_allowed_packet = 64M thread_cache_size = 300 #file innodb_file_per_table #buffer innodb_buffer_pool_size = 2500M innodb_log_buffer_size = 64M join_buffer_size = 16M sort_buffer_size = 16M innodb_max_dirty_pages_pct = 90 innodb_lock_wait_timeout = 120 innodb_thread_concurrency = 16 innodb_flush_log_at_trx_commit = 2 character_set_server = utf8 init_connect = 'SET NAMES utf8' #\u628aTokuDB datadir\u4ee5\u53calogdir\u548cMySQL\u7684datadir\u5206\u5f00\uff0c\u7f8e\u89c2\u70b9\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5206\u5f00\uff0c\u6ce8\u91ca\u6389\u672c\u884c\u4ee5\u53ca\u4e0b\u97622\u884c\u5373\u53ef tokudb_data-dir = /data/mysqldata tokudb_log-dir = /data/mysqllog #TokuDB\u7684\u884c\u6a21\u5f0f\uff0c\u5efa\u8bae\u7528 FAST \u5c31\u8db3\u591f\u4e86\uff0c\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u5f88\u7d27\u5f20\uff0c\u5efa\u8bae\u7528 SMALL tokudb_row_format = tokudb_small tokudb_row_format = tokudb_fast tokudb_cache_size = 2G #\u5176\u4ed6\u5927\u90e8\u5206\u914d\u7f6e\u5176\u5b9e\u53ef\u4ee5\u4e0d\u7528\u4fee\u6539\u7684\uff0c\u53ea\u9700\u8981\u51e0\u4e2a\u5173\u952e\u914d\u7f6e\u5373\u53ef tokudb_commit_sync = 0 tokudb_directio = 1 tokudb_read_block_size = 128K tokudb_read_buf_size = 128K [ mysqld_safe ] log-error = /var/log/mysqld.log pid-file = /var/run/mysqld/mysqld.pid","title":"\"centos6.6\u5b89\u88c5mariadb10 Tokudb\""},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#_1","text":"tokudb\u7684\u7f16\u8bd1\u9700\u8981cmake 2.8.9+ \u548c gcc 4.7+ \u672c\u6587\u9009\u7528cmake 2.8.9 \u548c gcc4.8.1\u3002 \u8fd92\u4e2a\u8f6f\u4ef6\u90fd\u53ea\u80fd\u4f7f\u7528\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5\u3002 cmake\u7684\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u4e0b\u8f7d wget http://www.cmake.org/files/v2.8/cmake-2.8.9.tar.gz \u7136\u540e\u89e3\u538b\u8fdb\u884c\u7f16\u8bd1 ./configure make & make install","title":"\u4e00\u3001\u73af\u5883\u51c6\u5907\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#gcc-481","text":"","title":"\u4e8c\u3001\u5b89\u88c5gcc 4.8.1"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#1gcc-481","text":"http://ftp.tsukuba.wide.ad.jp/software/gcc/releases/gcc-4.8.1/gcc-4.8.1.tar.bz2 \u6211\u662f\u865a\u62df\u673a\u91cc\u9762\u88c5\u7684Linux\uff0c\u6211\u5accwget\u592a\u6162\uff0c\u6240\u4ee5\u81ea\u5df1\u5728Windows\u4e0a\u7528\u8fc5\u96f7\u4e0b\u597d\uff0c\u7136\u540e\u5171\u4eab\u5230Linux\u4e2d\u3002","title":"1\u3001\u4e0b\u8f7dgcc 4.8.1\u6e90\u7801\u5305\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#2","text":"tar -jxvf gcc-4.8.1.tar.bz2","title":"2\u3001\u89e3\u538b\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#3","text":"\u8fd9\u4e2a\u6b65\u9aa4\u6709\u4e24\u79cd\u65b9\u5f0f\u5b8c\u6210\uff1a a) \u5982\u679cLinux\u6709\u7f51\u7edc\u8fde\u63a5\uff0c\u76f4\u63a5\u8fd9\u6837\uff1a cd gcc-4.8.1 ./contrib/download_prerequisites cd .. b) \u5982\u679cLinux\u6ca1\u6709\u7f51\u7edc\u8fde\u63a5\uff08\u6211\u4e3b\u673a\u548c\u865a\u62df\u673a\u662fHost-only\uff0c\u4e0d\u80fd\u8054\u7f51\uff0c\u6240\u4ee5\u53e6\u5916\u60f3\u529e\u6cd5\uff09\uff0c\u5219\u7528Windows\u4e0a\u7f51\u4e0b\u8f7d\u8fd9\u51e0\u4e2a\u5305\uff1a ftp://ftp.gnu.org/gnu/gmp/gmp-4.3.2.tar.bz2 http://www.mpfr.org/mpfr-2.4.2/mpfr-2.4.2.tar.bz2 http://www.multiprecision.org/mpc/download/mpc-0.8.1.tar.gz \u6709\u4eba\u95ee\uff0c\u4e00\u5b9a\u8981\u4e0b\u8f7d\u51e0\u4e2a\u7248\u672c\u5417\uff1f\u4e0b\u8f7d\u6700\u65b0\u7684\u7248\u672c\u884c\u4e0d\u884c\uff1f\u6211\u6ca1\u8bd5\u8fc7\uff0c\u4e5f\u4e0d\u77e5\u9053\uff0c\u6211\u662f\u6309\u7167gcc-4.8.1/contrib/download_prerequisites\u811a\u672c\u91cc\u9762\u7684\u7248\u672c\u4e0b\u8f7d\u7684\u3002\u65e2\u7136\u91cc\u9762\u5df2\u7ecf\u8bf4\u4e86\u8fd9\u51e0\u4e2a\u7248\u672c\uff0c\u90a3\u6211\u5c31\u4e25\u683c\u6309\u7167\u5b83\u7684\u8981\u6c42\u6765\u505a\u3002 \u7136\u540e\u89e3\u538b\u5e76\u79fb\u52a8\u5230gcc-4.8.1\u4e0b\u9762\uff1a tar -xjf gmp-4.3.2.tar.bz2 tar -xjf mpfr-2.4.2.tar.bz2 tar -xzf mpc-0.8.1.tar.gz mv gmp-4.3.2 gcc-4.8.1/gmp mv mpfr-2.4.2 gcc-4.8.1/mpfr mv mpc-0.8.1 gcc-4.8.1/mpc \u8fd9\u6837\u7684\u505a\u6cd5\u597d\u5904\u662f\uff0c\u4e0d\u7528\u5355\u72ec\u7f16\u8bd1gmp\u3001mpfr\u548cmpc\u4e09\u4e2a\u5305\uff0c\u653e\u5728gcc\u6e90\u7801\u4e0b\u9762\u4e00\u8d77\u7f16\u8bd1\uff08\u4e8b\u5b9e\u4e0a\u8fd9\u4e5f\u662fgcc-4.8.1/contrib/download_prerequisites\u811a\u672c\u7684\u505a\u6cd5\uff0c\u4e2a\u4eba\u611f\u89c9\u66f4\u7b80\u6d01\u4e9b\uff09\u3002","title":"3\u3001\u4e0b\u8f7d\u7f16\u8bd1\u6240\u9700\u7684\u4f9d\u8d56\u5305\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#4","text":"mkdir gcc-build-4.8.1","title":"4\u3001\u65b0\u5efa\u76ee\u5f55\u7528\u4e8e\u5b58\u653e\u7f16\u8bd1\u7ed3\u679c\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#5configuremakefile","text":"cd gcc-build-4.8.1 ../gcc-4.8.1/configure --enable-checking = release --enable-languages = c,c++ --disable-multilib \u5177\u4f53\u9009\u9879\u4e0d\u591a\u89e3\u91ca\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u67e5\u770b\uff0c\u6211\u53ea\u7528\u5230c\u548cc++\uff0c\u6240\u4ee5\u53ea\u7f16\u8bd1\u8fd9\u4e24\u79cd\u8bed\u8a00\u7684\u7f16\u8bd1\u5668\u3002","title":"5\u3001\u8fdb\u5165\u65b0\u76ee\u5f55\uff0c\u5e76\u6267\u884cconfigure\u547d\u4ee4\uff0c\u4ea7\u751fmakefile\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#6","text":"make -j4 \u6211\u662fi5\u56db\u6838\uff0c\u6240\u4ee5\u5f004\u4e2a\u7ebf\u7a0b\u540c\u65f6\u7f16\u8bd1\uff0c\u8981\u662f\u67098\u6838\u5c31\u66f4\u723d\u4e86~\u6211\u5728\u865a\u62df\u673a\u91cc\u9762\u82b1\u4e8630\u5206\u949f\u4e0d\u5230\u7684\u65f6\u95f4\uff0c\u4e0d\u7b97\u592a\u6162\u4e86\u3002","title":"6\u3001\u7f16\u8bd1\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#7","text":"sudo make install","title":"7\u3001\u5b89\u88c5\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#8","text":"g++ --version g++ ( GCC ) 4 .8.1 Copyright ( C ) 2013 Free Software Foundation, Inc. This is free software ; see the source for copying conditions. There is NO warranty ; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.","title":"8\u3001\u5927\u529f\u544a\u6210\uff0c\u68c0\u67e5\u7248\u672c\uff1a"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#_2","text":"\u4e0b\u8f7dmariadb\u6e90\u7801mariadb-10.0.14.tar.gz https://downloads.mariadb.org/mariadb/10.0.14/ \u9996\u5148\u9700\u8981\u4fee\u6539tokudb\u7684cmake\u7f16\u8bd1\u6587\u4ef6\uff0c\u53bb\u6389fuse-linker-plugin\u76f8\u5173\u5185\u5bb9 \u4fee\u6539mariadb-10.0.14/storage/tokudb/ft-index/cmake_modules/TokuSetupCompiler.cmake \u53bb\u6389\u6240\u6709\u7684 -fuse-linker-plugin \uff1a # set(CMAKE_C_FLAGS_RELWITHDEBINFO \"-flto -fuse-linker-plugin ${CMAKE_C_FLAGS_RELWITHDEBINFO} -g -O3 -UNDEBUG\") # set(CMAKE_CXX_FLAGS_RELWITHDEBINFO \"-flto -fuse-linker-plugin ${CMAKE_CXX_FLAGS_RELWITHDEBINFO} -g -O3 -UNDEBUG\") # set(CMAKE_C_FLAGS_RELEASE \"-g -O3 -flto -fuse-linker-plugin ${CMAKE_C_FLAGS_RELEASE} -UNDEBUG\") # set(CMAKE_CXX_FLAGS_RELEASE \"-g -O3 -flto -fuse-linker-plugin ${CMAKE_CXX_FLAGS_RELEASE} -UNDEBUG\") # set(CMAKE_EXE_LINKER_FLAGS \"-g -fuse-linker-plugin ${CMAKE_EXE_LINKER_FLAGS}\") # set(CMAKE_SHARED_LINKER_FLAGS \"-g -fuse-linker-plugin ${CMAKE_SHARED_LINKER_FLAGS}\") set ( CMAKE_C_FLAGS_RELWITHDEBINFO \"-flto ${ CMAKE_C_FLAGS_RELWITHDEBINFO } -g -O3 -UNDEBUG\" ) set ( CMAKE_CXX_FLAGS_RELWITHDEBINFO \"-flto ${ CMAKE_CXX_FLAGS_RELWITHDEBINFO } -g -O3 -UNDEBUG\" ) set ( CMAKE_C_FLAGS_RELEASE \"-g -O3 -flto ${ CMAKE_C_FLAGS_RELEASE } -UNDEBUG\" ) set ( CMAKE_CXX_FLAGS_RELEASE \"-g -O3 -flto ${ CMAKE_CXX_FLAGS_RELEASE } -UNDEBUG\" ) set ( CMAKE_EXE_LINKER_FLAGS \"-g ${ CMAKE_EXE_LINKER_FLAGS } \" ) set ( CMAKE_SHARED_LINKER_FLAGS \"-g ${ CMAKE_SHARED_LINKER_FLAGS } \" ) \u7136\u540e\u662f/home/gao-compile/mariadb-10.0.14/storage/tokudb/CMakeLists.txt \u53bb\u6389\u6240\u6709\u7684 -fuse-linker-plugin \uff1a #SET(CMAKE_MODULE_LINKER_FLAGS_RELEASE \"${CMAKE_MODULE_LINKER_FLAGS_RELEASE} -flto -fuse-linker-plugin\") #SET(CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO \"${CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO} -flto -fuse-linker-plugin\") SET ( CMAKE_MODULE_LINKER_FLAGS_RELEASE \" ${ CMAKE_MODULE_LINKER_FLAGS_RELEASE } -flto\" ) SET ( CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO \" ${ CMAKE_MODULE_LINKER_FLAGS_RELWITHDEBINFO } -flto\" ) \u7136\u540e\u8fdb\u884c\u7f16\u8bd1\uff1a cd mariadb-10.0.14 mkdir release ./BUILD/compile-pentium64-max --prefix = /home/gao-compile/mariadb-10.0.14/release make install \u7136\u540e\u5728/home/gao-compile/mariadb-10.0.14/release/lib/plugin \u76ee\u5f55\u4e2d\u627e\u5230 ha_tokudb.so\u52a8\u6001\u5e93\u3002 \u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u8981\u7684\u4e1c\u897f\u4e86\uff01 \u6ce8\uff1a\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5728mariadb-10.0.14/storage/tokudb\u76ee\u5f55\u4e2d\u76f4\u63a5\u8fdb\u884c\u7f16\u8bd1\uff0c\u800c\u4e0d\u7528\u53bb\u7f16\u8bd1\u6574\u4e2amariadb\uff0c\u56e0\u4e3a\u7f16\u8bd1\u51fa\u6765\u7684\u4e5f\u65e0\u6cd5\u4f7f\u7528\uff0c mysqld\u53ef\u6267\u884c\u7a0b\u5e8f\u4f9d\u8d56GLIBCXX_3.4.15 [ root@GXX release ] # ldd bin/mysqld bin/mysqld: /usr/lib64/libstdc++.so.6: version ` GLIBCXX_3.4.15 ' not found ( required by bin/mysqld ) \u5728mariadb\u5b98\u7f51https://downloads.mariadb.org/mariadb/10.0.14/\u4e0b\u8f7d\u5e26\u6709mariadb\u7684\u4e8c\u8fdb\u5236\u5305\u3002\u4ecemariadb\u5b98\u7f51\u4e0b\u8f7d10.0.14\u7684\u4e0d\u5e26tokudb\u7684\u53ef\u6267\u884c\u7a0b\u5e8ftar\u5305\uff0c\u7136\u540e\u5c06\u6211\u4eec\u7f16\u8bd1\u597d\u7684tokudb.so\u62f7\u8d1d\u5230 [maradb10.0.14]/lib/plugin/\u4e0b \u6211\u8fd9\u91cc\u4e0b\u8f7d\u7684\u5305\uff0c10.0.14 mariadb-10.0.14-linux-x86_64.tar.gz","title":"\u4e09\u3001\u7f16\u8bd1\u5b89\u88c5"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#_3","text":"","title":"\u56db\u3001\u521d\u59cb\u5316"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#1","text":"shell> groupadd mysql shell> useradd -g mysql mysql","title":"1\u3001\u524d\u671f\u8d26\u53f7\u521b\u5efa"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#2_1","text":"shell> cd /usr/local shell> tar -zxvf mariadb-10.0.14-linux-x86_64.tar.gz shell> ln -s mariadb-10.0.14-linux-x86_64 mysql","title":"2\u3001\u89e3\u538b\u8f6f\u4ef6\u5305"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#3_1","text":"shell> cd mysql shell> chown -R mysql . shell> chgrp -R mysql .","title":"3\u3001\u8bbe\u7f6e\u6743\u9650"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#4etcmycnf","text":"\u521b\u5efa\u5b58\u653e\u6570\u636e\u6e90\u7684\u76ee\u5f55 Shell> mkdir -p /var/lib/mysql Shell> mkdir -p /data/mysqldata /data/mysqllog Shell> chown -R mysql:mysql /var/lib/mysql /data/mysqldata /data/mysqllog \u5728\u9644\u4ef6\u4e2d\u7ed9\u51fa\uff0c\u8bf7\u53c2\u8003\u9644\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9","title":"4\u3001\u521b\u5efa\u914d\u7f6e\u6587\u4ef6/etc/my.cnf"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#5db","text":"Shell> scripts/mysql_install_db --user=mysql --defaults-file=/etc/my.cnf shell> chown -R root .","title":"5\u3001\u521d\u59cb\u5316DB"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#6_1","text":"echo never > /sys/kernel/mm/redhat_transparent_hugepage/defrag echo never > /sys/kernel/mm/redhat_transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/enabled echo never > /sys/kernel/mm/transparent_hugepage/defrag \u5efa\u8bae\u5199\u5230 /etc/rc.local \u4e2d\uff0c\u91cd\u542f\u540e\u4e5f\u53ef\u751f\u6548","title":"6\u3001\u4fee\u6539\u7cfb\u7edf\u53c2\u6570"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#7_1","text":"shell> bin/mysqld_safe --user=mysql &","title":"7\u3001\u542f\u52a8\u6570\u636e\u5e93"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#8_1","text":"cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld chkconfig --add mysqld service mysqld start service mysqld stop","title":"8\u3001\u628a\u542f\u52a8\u6587\u4ef6\u653e\u53bb\u81ea\u542f\u52a8\u4e2d"},{"location":"other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#9tokudb","text":"INSTALL SONAME 'ha_tokudb' ; \u67e5\u770b\u662f\u5426\u652f\u6301 MariaDB [( none )] > show engines -> ; +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | Engine | Support | Comment | Transactions | XA | Savepoints | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ | MyISAM | YES | MyISAM storage engine | NO | NO | NO | | CSV | YES | CSV storage engine | NO | NO | NO | | MRG_MyISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | | BLACKHOLE | YES | /dev/null storage engine ( anything you write to it disappears ) | NO | NO | NO | | MEMORY | YES | Hash based, stored in memory, useful for temporary tables | NO | NO | NO | | TokuDB | YES | Tokutek TokuDB Storage Engine with Fractal Tree ( tm ) Technology | YES | YES | YES | | PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | | ARCHIVE | YES | Archive storage engine | NO | NO | NO | | FEDERATED | YES | FederatedX pluggable storage engine | YES | NO | YES | | InnoDB | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, and foreign keys | YES | YES | YES | | Aria | YES | Crash-safe tables with MyISAM heritage | NO | NO | NO | +--------------------+---------+----------------------------------------------------------------------------+--------------+------+------------+ 11 rows in set ( 0 .11 sec ) \u770b\u5230\u4e0a\u9762\u4e00\u884c\u7ea2\u5b57\u5c31\u4ee3\u8868\u6570\u636e\u5e93\u652f\u6301TokuDB\u7684\u5b58\u50a8\u5f15\u64ce\u4e86\u3002 tokudb\u5b89\u88c5\u987a\u5229\u5b8c\u6210\uff0c\u540e\u9644\u914d\u7f6e\u6587\u4ef6 [ root@localhost mysql ] # cat /etc/my.cnf [ mysqld ] datadir = /var/lib/mysql socket = /var/lib/mysql/mysql.sock user = mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links = 0 #public max_connections = 3000 max_connect_errors = 6000 key_buffer_size = 384M low_priority_updates = 1 back_log = 1500 query_cache_type = 1 query_cache_size = 64M query_cache_limit = 4M query_cache_min_res_unit = 2k tmp_table_size = 256M read_buffer_size = 1M read_rnd_buffer_size = 16M bulk_insert_buffer_size = 64M max_allowed_packet = 64M thread_cache_size = 300 #file innodb_file_per_table #buffer innodb_buffer_pool_size = 2500M innodb_log_buffer_size = 64M join_buffer_size = 16M sort_buffer_size = 16M innodb_max_dirty_pages_pct = 90 innodb_lock_wait_timeout = 120 innodb_thread_concurrency = 16 innodb_flush_log_at_trx_commit = 2 character_set_server = utf8 init_connect = 'SET NAMES utf8' #\u628aTokuDB datadir\u4ee5\u53calogdir\u548cMySQL\u7684datadir\u5206\u5f00\uff0c\u7f8e\u89c2\u70b9\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5206\u5f00\uff0c\u6ce8\u91ca\u6389\u672c\u884c\u4ee5\u53ca\u4e0b\u97622\u884c\u5373\u53ef tokudb_data-dir = /data/mysqldata tokudb_log-dir = /data/mysqllog #TokuDB\u7684\u884c\u6a21\u5f0f\uff0c\u5efa\u8bae\u7528 FAST \u5c31\u8db3\u591f\u4e86\uff0c\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u5f88\u7d27\u5f20\uff0c\u5efa\u8bae\u7528 SMALL tokudb_row_format = tokudb_small tokudb_row_format = tokudb_fast tokudb_cache_size = 2G #\u5176\u4ed6\u5927\u90e8\u5206\u914d\u7f6e\u5176\u5b9e\u53ef\u4ee5\u4e0d\u7528\u4fee\u6539\u7684\uff0c\u53ea\u9700\u8981\u51e0\u4e2a\u5173\u952e\u914d\u7f6e\u5373\u53ef tokudb_commit_sync = 0 tokudb_directio = 1 tokudb_read_block_size = 128K tokudb_read_buf_size = 128K [ mysqld_safe ] log-error = /var/log/mysqld.log pid-file = /var/run/mysqld/mysqld.pid","title":"9\u3001\u5b89\u88c5tokudb\u652f\u6301"},{"location":"other/git%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/","tags":"[git]","text":"gitlab\u548cgithub\u90fd\u652f\u6301\u901a\u8fc7webhook\u81ea\u52a8\u90e8\u7f72\uff0c\u672c\u6587\u4f7f\u7528gitlab+webhook\u7684\u65b9\u5f0f\u5b9e\u73b0\u81ea\u52a8\u5316\u90e8\u7f72\u9879\u76ee\u3002 1\u3001\u586b\u5199\u56de\u8c03URL \u968f\u4fbf\u5728gitlab\u4e0a\u627e\u4e00\u4e2a\u9879\u76ee\uff0c\u586b\u5199\u56de\u8c03URL\uff0c\u5982\u679c\u6709Push\u8bf7\u6c42\uff0cgitlab\u4f1a\u81ea\u52a8\u56de\u8c03\u4f60\u586b\u5199\u7684\u8fd9\u4e2a\u5730\u5740\u3002 2\u3001\u5f00\u53d1\u670d\u52a1\u5668\u914d\u7f6e \u4e00\u822cphp\u662f\u901a\u8fc7php-fpm\u6765\u8fd0\u884c\uff0c\u800cphp-fpm\u4e00\u822c\u7531apache\u7528\u6237\u6765\u8fd0\u884c\u3002\u786e\u4fddclone\u4e0b\u6765\u7684\u4ed3\u5e93\u6743\u9650\u6bd4\u5982\u4e3aapache. \u53ef\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u4fee\u6539 # chown apache:apache you_project * -R \u521b\u5efaapache\u7528\u6237\u7684.ssh\u6587\u4ef6 sudo -u apache ssh-keygen -t rsa 3\u3001\u6d4b\u8bd5 \u5728\u672c\u5730commit\u4e00\u4e2a\u63d0\u4ea4. # git ci -am 'test webhook' # git push origin dev \u5728\u5f00\u53d1\u670d\u52a1\u5668\u4e0a\u67e5\u770b\u65e5\u5fd7 # tail -f /var/log/php-fpm/www-error.log \u53ef\u4ee5\u770b\u5230 [ 20 -Dec-2016 23 :00:59 Asia/Chongqing ] Array ( [ 0 ] = > From git.xxx.cn:your_project/project_name [ 1 ] = > * branch master -> FETCH_HEAD [ 2 ] = > Updating c02949b..f8c52c5 [ 3 ] = > Fast-forward [ 4 ] = > webhook.php | 42 ++++++++++++++++++++++++++++++++++++++++++ [ 5 ] = > 1 files changed, 42 insertions ( + ) , 0 deletions ( - ) [ 6 ] = > create mode 100644 webhook.php ) \u641e\u5b9a\uff01 \u9644\u3001webhook.php\u6e90\u7801 <?php $event = $_SERVER [ 'HTTP_X_GITLAB_EVENT' ]; $client_ip = $_SERVER [ 'REMOTE_ADDR' ]; $access_ip = array ( '192.168.112.151' ); // access ip if ( ! in_array ( $client_ip , $access_ip )) { echo \"Invalid ip [ { $client_ip } ]\" . PHP_EOL ; exit ( 0 ); } if ( $event == 'Push Hook' ) { // get json data $input = file_get_contents ( \"php://input\" ); $json = json_decode ( $input , true ); if ( $json [ 'project' ][ 'name' ] != 'portal' ) { exit ( 0 ); } $branch = $json [ 'ref' ]; switch ( $branch ) { case 'refs/heads/dev' : exec ( \"cd /var/www/html/voss/portal/;/usr/bin/git pull origin dev 2>&1\" , $output , $result ); error_log ( print_r ( 'pull dev' , true )); error_log ( print_r ( $output , true )); error_log ( print_r ( $result , true )); break ; default : exec ( \"cd /var/www/html/voss/portal/;/usr/bin/git pull origin master 2>&1\" , $output , $result ); error_log ( print_r ( 'pull master' , true )); error_log ( print_r ( $output , true )); error_log ( print_r ( $result , true )); break ; } }","title":"git\u81ea\u52a8\u5316\u90e8\u5c5e"},{"location":"other/hook_form%E4%B8%AD%E4%BD%BF%E7%94%A8drupalattachbehaviors/","tags":"[hook_form]","text":"\u5982\u679cform\u4e2d\u6709ajax\u4e8b\u4ef6\uff0c\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u7ed1\u5b9a\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u8fd9\u6837\u89e3\u51b3\uff0c\u4ee3\u7801\u5982\u4e0b /** * Implements hook_form_alter(). */ function xxx_form_alter(&$commands, &$form, $form_state) { //\u7528\u4e8eDrupal.attachBehaviors(document) $commands[] = ajax_command_invoke(NULL, 'xxx_form_alter_attach_behaviors'); } (function($) { Drupal.behaviors.xxx_form = { attach: function (context, settings) { //js here } } $.fn.xxx_form_alter_attach_behaviors = function() { Drupal.attachBehaviors(document); } })(jQuery);","title":"hook_form\u4e2d\u4f7f\u7528Drupal.attachBehaviors"},{"location":"other/infiniDB%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/","tags":"[infiniDB]","text":"infiniDB\u662f\u4e3a\u5927\u6570\u636e\u800c\u751f\u7684\u5217\u5f0f\u6570\u636e\u5e93\uff0c\u9002\u5408\u505a\u7edf\u8ba1\u5206\u6790\uff0c\u5982SUM,AVG,MAX,MIN\u7b49\u3002\u7b14\u8005\u6ca1\u6709\u7814\u7a76\u8fc7infoBright\uff0c\u8c8c\u4f3c\u9700\u8981\u6536\u8d39\uff0c\u5e76\u4e14\u793e\u533a\u7248\u672c\u4e0d\u652f\u6301DML\u3002 \u603b\u7ed3\u4e86\u4e00\u4e9binfiniDB\u7684\u7279\u70b9: 1\u3001\u6240\u6709\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u90fd\u4e3aNULL\uff0c\u4e0d\u9700\u8981\u8bbe\u7f6e\u5176\u4ed6\u503c\u3002 2\u3001\u4e0d\u9700\u8981\u521b\u5efa\u7d22\u5f15\uff0c\u4e0d\u9700\u8981\u4f18\u5316\u8868 3\u3001\u591a\u7ebf\u7a0b\u8bbe\u8ba1\uff0c\u67e5\u8be2\u65f6\u5b8c\u7f8e\u5229\u7528\u591aCPU 4\u3001\u9ad8\u5e76\u53d1:\u7406\u8bba\u4e0a\u65e0\u5e76\u53d1\u7684\u9650\u5236,\u53ea\u53d7\u5236\u4e8e\u670d\u52a1\u5668\u7684\u5bb9\u91cf 5\u3001DML(\u53ef\u4ee5\u89c6\u4e3a\u662fSQL\u7684\u5b50\u96c6)\u652f\u6301 : \u8bed\u53e5insert, update, delete 6\u3001\u6570\u636e\u5b58\u50a8\u65b9\u9762\u4e3b\u8981\u662f\u6309\u5217\u62c6\uff0c\u6309\u884c(\u8303\u56f4)\u62c6\uff0c\u6838\u5fc3\u7b97\u6cd5\u662fhash join\uff0c\u8ddforacle\u5f88\u7c7b\u4f3c\u3002 \u5177\u4f53\u6709\u4ee5\u4e0b\u51e0\u65b9\u9762\uff1a 1\uff09\u3001Block : 8k\u7684\u6570\u636e\u5757,\u6709Logical Block ID,\u5927\u5c0f\u4e0d\u80fd\u5b9a\u5236,\u4f46\u9884\u8bfb\u7684\u6570\u76ee\u53ef\u4ee5\u5b9a\u5236 2\uff09\u3001Extent : \u4e00\u4e2a\u903b\u8f91\u7a7a\u95f4\u5c3a\u5bf8,\u5b58\u5728\u4e8e\u4e00\u4e2a\u6216\u591a\u4e2a\u7684\u79f0\u4e3asegment\u6587\u4ef6\u7684\u7269\u7406\u6587\u4ef6\u4e2d. extent\u5927\u5c0f\u53d71)\u9ed8\u8ba4\u7684\u884c\u65702)\u4e00\u4e2a\u5217\u7684\u6570\u636e\u7c7b\u578b, \u5982\u9ed8\u8ba4\u884c\u6570\u662f8M,\u5bf9\u4e00\u5b57\u8282\u6570\u636e\u7c7b\u578b\u6765\u8bf4,Extent\u5927\u5c0f\u5c31\u662f8M; \u5bf9\u4e8e8\u5b57\u8282\u6570\u636e\u7c7b\u578b\u6765\u8bf4,\u5c31\u662f64M;\u5bf9\u4e8e\u53ef\u53d8\u957f\u6570\u636e\u7c7b\u578b\u6765\u8bf4\u4e5f\u662f64M.\u5f53\u4e00\u4e2aExtent\u6ee1\u4e86,\u4e00\u4e2a\u65b0\u7684Extent\u5c31\u4f1a\u88ab\u521b\u5efa\u51fa\u6765. 3\uff09\u3001Segment File : \u5f53\u4e00\u4e2aSegment\u6587\u4ef6\u8fbe\u5230\u5b83\u7684Extent\u5305\u542b\u7684\u6700\u5927\u6570\u76ee,\u4e00\u4e2a\u65b0\u7684Segment\u6587\u4ef6\u5c31\u4f1a\u88ab\u521b\u5efa\u51fa\u6765 4\uff09\u3001Partition : \u4e0erow-based DB\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5b83\u662f\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684\u5bf9\u8c61.\u7531\u4e00\u4e2a\u6216\u591a\u4e2aSegment\u6587\u4ef6\u7ec4\u6210. \u4e00\u4e2a\u5217\u7684partition\u6570\u76ee\u662f\u4e0d\u9650\u7684. \u5b89\u88c5\u8fc7\u7a0b\uff1a 1 \u3001\u8bbf\u95eehttps://github.com/infinidb/infinidb/blob/4.6.2-1/INSTALL\uff0c\u6309\u7167\u5e2e\u52a9\u6587\u6863\u8fdb\u884c\u5b89\u88c5\uff0c\u7b14\u8005\u5b89\u88c5\u7684\u7248\u672c\u662f4.6.2 \u6216\u8005\uff1a cd /root git clone http://github.com/infinidb/mysql git clone http://github.com/infinidb/infinidb -- or -- tar -zxf <srcfile> cd mysql ./configure --prefix = /data/mysql/ make make install cd ../infinidb ./configure --prefix = /data/ make make install \u6ce8\u610f\uff1aroot\u4e0b\u7684\u6587\u4ef6\u5939\u540d\u79f0\u5fc5\u987b\u4e3ainfinidb\u548cmysql\uff0c\u5426\u5219\u7f16\u8bd1\u7684\u65f6\u5019\u4f1a\u62a5\u9519\u3002 2 \u3001\u5b89\u88c5\u5b8c\u4ee5\u540e\u6267\u884c/usr/local/Calpont/bin/postConfigure\u8fdb\u884c\u914d\u7f6e\uff0c\u6309\u9ed8\u8ba4\u5c31\u884c 3 \u3001\u8bbe\u7f6e\u4e00\u4e9b\u522b\u540d\uff0c . /usr/local/Calpont/bin/calpontAlias 4 \u3001\u76f4\u63a5\u8bbf\u95eeidbmysql\u8fdb\u5165\u7ba1\u7406\u3002 \u6d4b\u8bd5 10\u4ebf\u6761\u6570\u636ecount: \u6027\u80fd\u6760\u6760\u6ef4\uff01","title":"\"infiniDB\u5b89\u88c5\u914d\u7f6e\""},{"location":"other/infinidb%E4%B8%8Eclickhouse%E5%AF%B9%E6%AF%94/","tags":"[clickhouse]","text":"\u673a\u5668\u914d\u7f6e\uff1a \u6d4b\u8bd5\u673a\uff1a dell R510 cpu\uff1a xeon E5620*2 RAID\u5361\uff1a H700 \u7cfb\u7edf \uff1aubuntu 14.04 \u5185\u6838\uff1a Linux ubuntu 4.2.0-27-generic raid\u7ea7\u522b\uff1a raid0 \u6587\u4ef6\u7cfb\u7edf\uff1a ext4 \u786c\u76d8\uff1a SSD 240G*2 IP\uff1a 192.168.112.73 \u4e00\u3001\u5b89\u88c5 1\u3001infiniDB\u7684\u5b89\u88c5\u89c1 http://verynull.com/2015/06/24/infiniDB\u5b89\u88c5\u914d\u7f6e/ 2\u3001clickhouse\u5b89\u88c5 \u53ea\u652f\u6301ubutu14.04,16.04\uff0c12.04\uff0c\u4f46\u662f\u6211\u572816.04\u4e0a\u6ca1\u6709\u5b89\u88c5\u8d77\u6765\u3002 sudo apt-key adv --keyserver keyserver.ubuntu.com --recv E0C56BD4# optional sudo mkdir -p /etc/apt/sources.list.d echo \"deb http://repo.yandex.ru/clickhouse/trusty stable main\" | sudo tee /etc/apt/sources.list.d/clickhouse.list sudo apt-get update sudo apt-get install clickhouse-server-common clickhouse-client sudo service clickhouse-server start clickhouse-client 3\u3001\u5c31\u5b89\u88c5\u8fc7\u7a0b\u800c\u8a00\uff0cclickhouse\u65b9\u4fbf\u5f88\u591a\uff0cinfiniDB\u8981\u7f16\u8bd1\u8001\u534a\u5929\u3002 \u4e8c\u3001\u6027\u80fd\u6d4b\u8bd5 1\u3001\u521b\u5efa\u8868 infiniDB: CREATE TABLE ` billing ` ( ` did ` int ( 11 ) NOT NULL DEFAULT '0' COMMENT '' , ` hit ` bigint ( 20 ) NOT NULL DEFAULT '0' COMMENT '' , ` reqs ` bigint ( 20 ) NOT NULL DEFAULT '0' COMMENT '' , ` rx ` bigint ( 20 ) NOT NULL DEFAULT '0' COMMENT '' , ` tx ` bigint ( 20 ) NOT NULL DEFAULT '0' COMMENT '' , ` logtime ` bigint ( 20 ) NOT NULL DEFAULT '0' COMMENT '' , ` tpr ` bigint ( 20 ) NOT NULL DEFAULT '0' COMMENT '' ) ENGINE = infiniDB DEFAULT CHARSET = latin1 clickhouse: CREATE TABLE billing ( id Int32,did Int32,hit Int64,reqs Int64,rx Int64,tx Int64,logtime Int64,tpr Int64 ) ENGINE = Log ; 2\u3001\u5bfc\u5165csv\u6570\u636e csv\u683c\u5f0f\u5982\u4e0b\uff1a 106 ,9,10,123,11858014,1467133200,330,0 122 ,0,2,506,621,1467133200,150,0 124 ,112,249,1131297,1899996,1467133200,49,0 127 ,3,12,64257,88503,1467133200,66,0 \u6570\u636e\u91cf9000\u4e07,\u5927\u5c0f4.5G\u3002 infiniDB: sudo /data/mysql/bin/mysql --defaults-file = /data/mysql/my.cnf --local-infile -u root monitor -e \"load data local infile '/root/1.txt' into table billing FIELDS TERMINATED BY ',';\" \u8017\u65f6\uff1a 0 .60user 2 .50system 4 :14.61elapsed 1 %CPU ( 0avgtext+0avgdata 3640maxresident ) k 0inputs+0outputs ( 0major+227minor ) pagefaults 0swaps clickhouse: cat 1 .txt | clickhouse-client --query = \"INSERT INTO monitor.monitor_data FORMAT CSV\" ; \u8017\u65f6\uff1a real1m6.809s user1m26.720s sys 0m6.724s clickhouse\u5bfc\u5165\u901f\u5ea6\u660e\u663e\u5feb\u5f88\u591a\u3002 3\u3001\u67e5\u8be2\u901f\u5ea6 SQL: SELECT logtime, SUM ( hit ) as hit, SUM ( reqs ) as reqs, SUM ( rx ) as rx,SUM ( tx ) as tx, round ( avg ( tpr )) as tpr FROM billingWHERE did > 0AND logtime > = 1467302400 AND logtime < = 1469980799 GROUP BY logtime ORDER BY l ogtime ; infiniDB: 9663 rows in set ( 1 .26 sec ) clickhouse: 8924 rows in set. Elapsed: 2 .676 sec. Processed 91 .80 million rows, 4 .77 GB ( 34 .30 million rows/s., 1 .78 GB/s. ) infiniDB\u901f\u5ea6\u8f83\u5feb\u3002 4\u30012\u4ebf\u6570\u636e\u5bf9\u6bd4 SQL\u540c\u4e0a infiniDB: 9663 rows in set ( 2 .24 sec ) clickhouse: 8924 rows in set. Elapsed: 4 .215 sec. Processed 183 .61 million rows, 9 .55 GB ( 43 .56 million rows/s., 2 .26 GB/s. ) infiniDB\u8f83\u5feb\u3002 5\u300110\u4ebf\u6570\u636e\u5bf9\u6bd4 SQL\u540c\u4e0a infiniDB: 9663 rows in set ( 9 .58 sec ) clickhouse: 8924 rows in set. Elapsed: 17 .040 sec. Processed 1 .01 billion rows, 52 .51 GB ( 56 .67 million rows/s., 2 .95 GB/s. ) infiniDB\u66f4\u5feb\u3002 6\u3001count\u5bf9\u6bd4 infiniDB: +------------+ | count ( * ) | +------------+ | 1009844583 | +------------+ 1 row in set ( 6 .14 sec ) clickhouse: SELECT count ( * ) FROM billing \u250c\u2500\u2500\u2500\u2500count () \u2500\u2510 \u2502 1009844583 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 1 rows in set. Elapsed: 1 .120 sec. Processed 1 .01 billion rows, 4 .04 GB ( 901 .82 million rows/s., 3 .61 GB/s. ) 7\u3001\u538b\u7f29\u6bd4 infiniDB: 22G billing clickhouse: 24G billing \u538b\u7f29\u6bd4\u76f8\u5dee\u4e0d\u591a\u3002 \u7ed3\u679c\uff1a 1\u3001infiniDB\u4f1a\u4f7f\u7528\u6240\u6709CPU\uff0c\u800cclickhouse\u6700\u591a\u4f7f\u752810\u4e2a\u3002 2\u3001clickhouse\u5728\u5927\u6570\u636e\u91cf\u7684\u65f6\u5019\uff0c\u5904\u7406\u901f\u5ea6\u8fd8\u662f\u6bd4\u8f83\u4ee4\u4eba\u6ee1\u610f\u7684\u3002 3\u3001clickhouse\u5728\u5bfc\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u67e5\u8be2\u4f1a\u88ab\u5361\u4f4f\uff0c\u800cinfiniDB\u4e0d\u4f1a\u3002 4\u3001infiniDB\u6027\u80fd\u66f4\u597d\u3002 \u9644\u5bf9\u6bd4\u56fe\uff1a \u8fd9\u91ccclickhouse\u662fLog\u5f15\u64ce\u3002 \u7ecf\u4e00\u4f4d\u4fc4\u7f57\u65af\u7f51\u53cb\u63d0\u9192,MergeTree\u5f15\u64ce\u6bd4Log\u5f15\u64ce\u66f4\u9ad8\u6548\uff0c\u56e0\u4e3aLog\u5f15\u64ce\u4f1a\u5168\u8868\u626b\u63cf\uff0c\u800cMergeTree\u7684\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a xxxx@ubuntu:/opt/clickhouse$ ls data/monitor/billing_mergetree 20150829_20150831_10964_10994_2 20160101_20160131_10_11360_30 20160401_20160430_12_9964_31 20160609_20160613_11302_11350_4 20160808_20160820_10972_11250_2 20150325_20150331_4_9822_23 20150901_20150930_1030_11316_50 20160201_20160229_244_10606_27 20160401_20160430_9982_11362_10 20160701_20160731_308_8668_14 20160820_20160820_11260_11260_0 20150401_20150430_16_9932_57 20151001_20151031_8_11352_39 20160220_20160229_10618_10788_10 20160501_20160531_530_11042_23 20160701_20160731_8678_10786_12 20160820_20160820_11266_11266_0 20150501_20150531_102_10032_75 20151009_20151011_11356_11356_0 20160229_20160229_10804_10812_1 20160528_20160531_11056_11124_6 20160731_20160731_10798_10798_0 detached \u8fd9\u79cd\u5b58\u50a8\u7ed3\u6784\u5c31\u662f\u628a\u6bcf\u4e2a\u6708\u7684\u6570\u636e\u5355\u72ec\u653e\u7f6e\u5728\u4e00\u4e2a\u6587\u4ef6\u5939\u4e2d\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u5168\u8868\u626b\u63cf\u3002 \u9644\u5bf9\u6bd4\u56fe: \u7ed3\u8bba\uff1a clickhouse\u901f\u5ea6\u66f4\u5feb\uff01","title":"\"infiniDB\u4e0eclickhouse\u5bf9\u6bd4\""},{"location":"other/kubernetes%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/","tags":"[kubernetes\u5b89\u88c5]","text":"1\u3001\u5b89\u88c5kubsphere 2\u3001\u5b89\u88c5\u76d1\u63a7prometheus 3\u3001\u5b89\u88c5\u65e5\u5fd7elk 4\u3001CI gitlab+jenkins \u955c\u50cfpush\u5230harbo 5\u3001CD \u5b89\u88c5spinaker \u81ea\u52a8\u90e8\u7f72\u5230k8s\u96c6\u7fa4 \u5148\u641eCI","title":"kubernetes\u5b89\u88c5\u90e8\u7f72\u5b9e\u6218"},{"location":"other/macvim%E5%A4%84%E7%90%86%E4%B8%AD%E6%96%87%E6%97%B6%E5%8D%A1%E9%A1%BF%E3%80%81cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/","tags":"[vim]","text":"\u5347\u7ea7\u5230vim 7.4\u4ee5\u540e\u60c5\u51b5\u6709\u70b9\u597d\u8f6c\u3002 \u00b6 \u6211\u4e00\u822c\u4f7f\u7528vim\u7f16\u7a0b\u3002\u4f46\u662f\u8f93\u5165\u4e2d\u6587\u548c&\u7b26\u53f7\u65f6\u65f6\u6bd4\u8f83\u75db\u82e6\u3002\u7ecf\u5e38\u51fa\u73b0\u5361\u987f\u3002 \u5076\u7136\u53d1\u73b0\uff0c\u5728Preferences\u5bf9\u8bdd\u6846\u4e2d\u9009\u62e9Advanced\u9009\u9879\u5361\uff0c\u53bb\u6389Use Core Text renderer\u9009\u9879\u7684\u52fe\u52fe\uff0c\u8f93\u5165\u5927\u6bb5\u4e2d\u6587\u4e5f\u4e0d\u4f1a\u9020\u6210\u5361\u987f\uff0c\u81f3\u6b64\u95ee\u9898\u89e3\u51b3\u3002 \u4f46\u662f\u8fd9\u6837\u4f1a\u5bfc\u81f4\u5c4f\u5e55\u4e0a\u4e0b\u6eda\u52a8\u7684\u65f6\u5019\u6709\u70b9\u6643\u773c\u3002\u96be\u9053\u662f\u8981\u6211\u629b\u5f03vim\u7684\u8282\u594f\uff1f","title":"MacVim\u5904\u7406\u4e2d\u6587\u65f6\u5361\u987f\u3001CPU\u5360\u7528\u8fc7\u9ad8\u95ee\u9898"},{"location":"other/macvim%E5%A4%84%E7%90%86%E4%B8%AD%E6%96%87%E6%97%B6%E5%8D%A1%E9%A1%BF%E3%80%81cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/#vim-74","text":"\u6211\u4e00\u822c\u4f7f\u7528vim\u7f16\u7a0b\u3002\u4f46\u662f\u8f93\u5165\u4e2d\u6587\u548c&\u7b26\u53f7\u65f6\u65f6\u6bd4\u8f83\u75db\u82e6\u3002\u7ecf\u5e38\u51fa\u73b0\u5361\u987f\u3002 \u5076\u7136\u53d1\u73b0\uff0c\u5728Preferences\u5bf9\u8bdd\u6846\u4e2d\u9009\u62e9Advanced\u9009\u9879\u5361\uff0c\u53bb\u6389Use Core Text renderer\u9009\u9879\u7684\u52fe\u52fe\uff0c\u8f93\u5165\u5927\u6bb5\u4e2d\u6587\u4e5f\u4e0d\u4f1a\u9020\u6210\u5361\u987f\uff0c\u81f3\u6b64\u95ee\u9898\u89e3\u51b3\u3002 \u4f46\u662f\u8fd9\u6837\u4f1a\u5bfc\u81f4\u5c4f\u5e55\u4e0a\u4e0b\u6eda\u52a8\u7684\u65f6\u5019\u6709\u70b9\u6643\u773c\u3002\u96be\u9053\u662f\u8981\u6211\u629b\u5f03vim\u7684\u8282\u594f\uff1f","title":"\u5347\u7ea7\u5230vim 7.4\u4ee5\u540e\u60c5\u51b5\u6709\u70b9\u597d\u8f6c\u3002"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/","tags":"[tokudb]","text":"MariaDB\u548cMysql\u5bf9\u6bd4\uff08\u914d\u7f6e4\u68384G\uff09: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 2 Server version: 5.6.25-73.1 Percona Server (GPL), Release 73.1, Revision 07b797f Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 4 Server version: 10.0.14-MariaDB MariaDB Server 1\u3001MariaDB\u5bfc\u5165\u6570\u636e\uff1a \u00b6 MariaDB [billing]> load data infile '/home/user_logs.txt' into table cloud_innodb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (1 min 18.02 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 MariaDB [billing]> load data infile '/home/user_logs.txt' into table cloud_tokudb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (36.83 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 Mysql\u5bfc\u5165\u6570\u636e\uff1a mysql> load data infile '/home/user_logs.txt' into table cloud_innodb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (1 min 10.75 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 mysql> load data infile '/home/user_logs.txt' into table cloud_tokudb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (33.35 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 \u603b\u7ed3\uff1a 1\uff09\u3001MariaDB\u5bfc\u5165\u6570\u636e\u6bd4Mysql\u8981\u6162\u4e00\u70b9 2\uff09\u3001TokuDB\u5bfc\u5165\u6570\u636e\u6bd4InnoDB\u901f\u5ea6\u5feb\u4e00\u500d 3\uff09\u3001TokuDB\u91c7\u7528\u591aCPU\u5e76\u53d1\u5bfc\u5165 2\u3001MariaDB\u5b58\u50a8\u7a7a\u95f4 \u00b6 [root@localhost billing]# ll -h -rw-rw----. 1 mysql mysql 1.5K Nov 4 14:16 cloud_innodb.frm -rw-rw----. 1 mysql mysql 568M Nov 4 14:40 cloud_innodb.ibd [root@localhost mysqldata]# ll -h -rw-rw----. 1 mysql mysql 26M Nov 4 14:31 _billing_cloud_tokudb_main_172d_1_1b_B_0.tokudb -rw-rw----. 1 mysql mysql 64K Nov 4 14:31 _billing_cloud_tokudb_status_1729_1_1b.tokudb Mysql\u5b58\u50a8\u7a7a\u95f4 [root@localhost billing]# ll -h -rw-rw----. 1 mysql mysql 8.9K Nov 4 14:17 cloud_innodb.frm -rw-rw----. 1 mysql mysql 568M Nov 4 14:36 cloud_innodb.ibd [root@localhost mysqldata]# ll -h -rw-rw----. 1 mysql mysql 26M Nov 4 14:37 _billing_cloud_tokudb_main_8be1_1_1c_B_0.tokudb -rw-rw----. 1 mysql mysql 64K Nov 4 14:37 _billing_cloud_tokudb_status_8bde_1_1c.tokudb \u603b\u7ed3\uff1a 1\uff09\u3001 MariaDB\u548cMysql\u5728\u91c7\u7528\u76f8\u540c\u5f15\u64ce\u7684\u65f6\u5019\u5b58\u50a8\u7a7a\u95f4\u76f8\u540c 2\uff09\u3001 TokuDB\u7684\u538b\u7f29\u6709\u5f88\u591a\u79cd\uff0c\u4e0a\u9762\u91c7\u7528tokudb_lzma,\u538b\u7f29\u6bd4\u4f8b\u6700\u5927\uff0c\u4f46\u975e\u5e38\u6d88\u8017CPU\uff0c\u5185\u5b58 3\uff09\u3001 TokuDB\u548cInnoDB\u4ece\u4e0a\u9762\u7684\u4f8b\u5b50\u6765\u770b\u538b\u7f29\u6bd4\u7387\u662f1\uff1a20\u5de6\u53f3\uff0c\u5982\u679c\u90fd\u662f\u6574\u578b\u6570\u636e\uff0c\u538b\u7f29\u6bd4\u7387\u57281\uff1a4\u5de6\u53f3\u3002 3\u3001MariaDB\u67e5\u8be2\u901f\u5ea6 \u00b6 \u91cd\u542f\u7b2c\u4e00\u6b21\u67e5\u8be2 MariaDB [billing]> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.58 sec) MariaDB [billing]> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (16.55 sec) \u6e05\u7f13\u5b58\uff08reset query cache\uff09 MariaDB [billing]> reset query cache; Query OK, 0 rows affected (0.02 sec) MariaDB [billing]> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.42 sec) MariaDB [billing]> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.43 sec) Mysql\u67e5\u8be2\u901f\u5ea6 mysql> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.66 sec) mysql> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (13.74 sec) \u6e05\u7f13\u5b58\uff08reset query cache\uff09 mysql> reset query cache; Query OK, 0 rows affected (0.03 sec) mysql> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.38 sec) mysql> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.49 sec) \u603b\u7ed3\uff1a 1\uff09\u3001 \u67e5\u8be2\u901f\u5ea6MariaDB\u548cMysql\u901f\u5ea6\u5dee\u4e0d\u591a 2\uff09\u3001 \u7b2c\u4e00\u6b21\u67e5\u8be2\u7684\u65f6\u5019InnoDB\u548cTokuDB\u901f\u5ea6\u76f8\u5dee\u5f88\u5927 3\uff09\u3001 \u6e05\u7f13\u5b58\u540e\u67e5\u8be2\u5dee\u4e0d\u591a 4\u3001\u5e76\u53d1\u67e5\u8be2 \u00b6 MariaDB\uff1a [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.509 seconds Minimum number of seconds to run all queries: 0.509 seconds Maximum number of seconds to run all queries: 0.509 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.600 seconds Minimum number of seconds to run all queries: 0.600 seconds Maximum number of seconds to run all queries: 0.600 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.901 seconds Minimum number of seconds to run all queries: 0.901 seconds Maximum number of seconds to run all queries: 0.901 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 1.028 seconds Minimum number of seconds to run all queries: 1.028 seconds Maximum number of seconds to run all queries: 1.028 seconds Number of clients running queries: 1000 Average number of queries per client: 0 Mysql\uff1a [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.496 seconds Minimum number of seconds to run all queries: 0.496 seconds Maximum number of seconds to run all queries: 0.496 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.483 seconds Minimum number of seconds to run all queries: 0.483 seconds Maximum number of seconds to run all queries: 0.483 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 1.231 seconds Minimum number of seconds to run all queries: 1.231 seconds Maximum number of seconds to run all queries: 1.231 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.739 seconds Minimum number of seconds to run all queries: 0.739 seconds Maximum number of seconds to run all queries: 0.739 seconds Number of clients running queries: 1000 Average number of queries per client: 0 \u603b\u7ed3 1\uff09\u3001 \u5e76\u53d1\u67e5\u8be2\u4e24\u6570\u636e\u76f8\u5dee\u4e0d\u662f\u5f88\u5927 2\uff09\u3001 Tokudb\u67e5\u8be2\u901f\u5ea6\u5728MariaDB\u4e2d\u6bd4InnoDB\u5f15\u64ce\u6162\u4e00\u70b9\uff0c\u4f46\u5728Mysql\u4e2d\u6bd4InnoDB\u5f15\u64ce\u901f\u5ea6\u8fd8\u5feb\uff08\u7f51\u4e0a\u8bf4\u7684TokuDB\u67e5\u8be2\u901f\u5ea6\u4e0d\u884c\uff0c\u6ca1\u6709\u9a8c\u8bc1\u51fa\u6765\uff0c\u4e0d\u77e5\u9053\u771f\u6b63\u5728\u7ebf\u901f\u5ea6\u600e\u4e48\u6837\uff0c\u6309\u7406\u8bf4\u538b\u7f29\u540e\u7684\u6570\u636e\u5e94\u8be5\u67e5\u8be2\u8981\u6162\u4e8e\u6ca1\u6709\u538b\u7f29\u7684\u6570\u636e\uff09 5\u3001 \u6279\u91cf\u66f4\u65b0 \u00b6 MariaDB [billing]> update cloud_innodb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 81099 rows affected (5.71 sec) Rows matched: 81099 Changed: 81099 Warnings: 0 MariaDB [billing]> update cloud_tokudb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 81099 rows affected (3.46 sec) mysql> update cloud_innodb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 80952 rows affected (5.32 sec) Rows matched: 81099 Changed: 80952 Warnings: 0 mysql> update cloud_tokudb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 80952 rows affected (3.40 sec) Rows matched: 81099 Changed: 80952 Warnings: 0 \u603b\u7ed3 1\uff09\u3001\u4e24\u6570\u636e\u5e93\u6027\u80fd\u5dee\u4e0d\u591a 2\uff09\u3001\u6279\u91cf\u66f4\u65b0\u611f\u89c9TokuDB\u901f\u5ea6\u6bd4InnoDB\u901f\u5ea6\u5feb\uff08\u548c\u7f51\u4e0a\u8bf4\u7684\u53c8\u4e0d\u4e00\u6837\uff09 6\u3001DDL\u64cd\u4f5c\u5bf9\u6bd4 \u00b6 \u6dfb\u52a0\u7d22\u5f15 MariaDB [billing]> create index idx_uid on cloud_innodb(uid); Query OK, 0 rows affected (12.23 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> create index idx_uid on cloud_tokudb(uid); Query OK, 0 rows affected (29.51 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> create index idx_uid on cloud_innodb(uid); Query OK, 0 rows affected (15.48 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> create index idx_uid on cloud_tokudb(uid); Query OK, 0 rows affected (31.10 sec) Records: 0 Duplicates: 0 Warnings: 0 \u5220\u9664\u7d22\u5f15 MariaDB [billing]> drop index idx_uid on cloud_innodb; Query OK, 0 rows affected (0.05 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> drop index idx_uid on cloud_tokudb; Query OK, 0 rows affected (0.09 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> drop index idx_uid on cloud_innodb; Query OK, 0 rows affected (0.07 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> drop index idx_uid on cloud_tokudb; Query OK, 0 rows affected (0.13 sec) Records: 0 Duplicates: 0 Warnings: 0 \u6dfb\u52a0\u5b57\u6bb5 MariaDB [billing]> alter table cloud_innodb add column test_flag varchar(20); Query OK, 0 rows affected (1 min 20.06 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> alter table cloud_tokudb add column test_flag varchar(20); Query OK, 0 rows affected (0.16 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_innodb add column test_flag varchar(20); Query OK, 0 rows affected (1 min 31.07 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_tokudb add column test_flag varchar(20); Query OK, 0 rows affected (0.23 sec) Records: 0 Duplicates: 0 Warnings: 0 \u5220\u9664\u5b57\u6bb5 MariaDB [billing]> alter table cloud_innodb drop column test_flag; Query OK, 0 rows affected (1 min 19.48 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> alter table cloud_tokudb drop column test_flag; Query OK, 0 rows affected (0.23 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_innodb drop column test_flag; Query OK, 0 rows affected (1 min 55.31 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_tokudb drop column test_flag; Query OK, 0 rows affected (1.28 sec) Records: 0 Duplicates: 0 Warnings: 0 \u603b\u7ed3 1\u3001MariaDB\u7684DDL\u64cd\u4f5c\u6bd4Mysql\u7684\u5feb 2\u3001InnoDB\u7684\u6dfb\u52a0\u7d22\u5f15\u6bd4TokuDB\u7684\u5feb 3\u3001\u5220\u9664\u7d22\u5f15\u4e24\u4e2a\u5f15\u64ce\u90fd\u5f88\u5feb 4\u3001\u6dfb\u52a0\u5b57\u6bb5TokuDB\u975e\u5e38\u5feb\uff0cInnoDB\u5f88\u6162 5\u3001\u5220\u9664\u5b57\u6bb5TokuDB\u975e\u5e38\u5feb\uff0cInnoDB\u5f88\u6162 \u7f51\u4e0a\u7684\u4e00\u4e9b\u603b\u7ed3 \u00b6 \u603b\u7ed3\uff1a TokuDB\u4f18\u70b9 1\uff0conline ddl \u975e\u5e38\u7ed9\u529b\uff0c\u7279\u522b\u662f\u5bf9\u5b57\u6bb5\u7684\u4fee\u6539\u975e\u5e38\u5feb 2\uff0c\u538b\u7f29\u6bd4\u975e\u5e38\u9ad8\u901a\u5e38\u90fd\u80fd\u8fbe\u52307,8\u500d\u7684\u538b\u7f29\u6bd4 3\uff0c\u5b8c\u5168\u652f\u6301ACID\u4e8b\u7269\u7684\u56db\u5927\u7279\u6027 TokuDB\u7f3a\u70b9 1\uff0c\u54cd\u5e94\u65f6\u95f4\u76f8\u5bf9\u8f83\u957f 2\uff0conline ddl \u5bf9text,blob\u7b49\u7c7b\u578b\u7684\u5b57\u6bb5\u4e0d\u9002\u7528 3\uff0c\u6ca1\u6709\u5408\u9002\u7684\u5907\u4efd\u5de5\u5177\uff0c\u53ea\u80fd\u901a\u8fc7mysqldump\u8fdb\u884c\u903b\u8f91\u5907\u4efd \u5efa\u8bae\u9002\u7528\u573a\u666f\uff1a 1\uff0c\u8bbf\u95ee\u9891\u7387\u4e0d\u9ad8\u7684\u6570\u636e\u6216\u5386\u53f2\u6570\u636e\u5f52\u6863 2\uff0c\u8868\u975e\u5e38\u5927\u5e76\u4e14\u65f6\u4e0d\u65f6\u8fd8\u9700\u8981\u8fdb\u884cddl\u64cd\u4f5c \u7279\u70b9\uff1a 1.\u63d2\u5165\u6027\u80fd\u5feb20~80\u500d\uff1b 2.\u538b\u7f29\u6570\u636e\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\uff1b 3.\u6570\u636e\u91cf\u53ef\u4ee5\u6269\u5c55\u5230\u51e0\u4e2aTB\uff1b 4.\u4e0d\u4f1a\u4ea7\u751f\u7d22\u5f15\u788e\u7247\uff1b 5.\u652f\u6301hot column addition \uff0c hot indexing\uff0c mvcc\uff1b \u5982\u4f55\u8003\u8651\u4f7f\u7528\uff1a 1.\u5982\u679c\u8981\u5b58\u50a8blob\uff0c\u4e0d\u8981\u4f7f\u7528tokuDB\uff0c\u56e0\u4e3a\u4ed6\u7684\u8bb0\u5f55\u4e0d\u80fd\u592a\u5927\uff1b 2.\u5982\u679c\u8bb0\u5f55\u6570\u8fc7\u4ebf\uff0c\u4f7f\u7528tokuDB\uff1b 3.\u5982\u679c\u6ce8\u91cdupdate\u7684\u6027\u80fd\uff0c\u4e0d\u8981\u4f7f\u7528tokuDB\uff0c\u4ed6\u6ca1\u6709innodb\u5feb\uff1b 4.\u5982\u679c\u8981\u5b58\u50a8\u65e7\u7684\u8bb0\u5f55\uff0c\u4f7f\u7528tokuDB\uff1b 5.\u5982\u679c\u8981\u7f29\u5c0f\u6570\u636e\u5360\u7528\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u4f7f\u7528tokuDB\uff1b \u603b\u7ed3\uff1a TokuDB\u7684\u4f18\u70b9\uff1a1\u3001\u9ad8\u538b\u7f29\u6bd4 2\u3001\u9ad8insert\u6027\u80fd 3\u3001\u589e\u5220\u5b57\u6bb5\u79d2\u7ea7\u3002 TokuDB\u7684\u7f3a\u70b9\uff1a1\u3001cpu usr\u6001\u6d88\u8017\u9ad8 2\u3001\u54cd\u5e94\u65f6\u95f4\u53d8\u957f\u3002","title":"\"MariaDB\u548cPercona\u7684\u5f15\u64cetokudb\u6027\u80fd\u5bf9\u6bd4\u6d4b\u8bd5\""},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#1mariadb","text":"MariaDB [billing]> load data infile '/home/user_logs.txt' into table cloud_innodb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (1 min 18.02 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 MariaDB [billing]> load data infile '/home/user_logs.txt' into table cloud_tokudb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (36.83 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 Mysql\u5bfc\u5165\u6570\u636e\uff1a mysql> load data infile '/home/user_logs.txt' into table cloud_innodb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (1 min 10.75 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 mysql> load data infile '/home/user_logs.txt' into table cloud_tokudb FIELDS TERMINATED BY '\\t'; Query OK, 641098 rows affected, 65535 warnings (33.35 sec) Records: 641098 Deleted: 0 Skipped: 0 Warnings: 641098 \u603b\u7ed3\uff1a 1\uff09\u3001MariaDB\u5bfc\u5165\u6570\u636e\u6bd4Mysql\u8981\u6162\u4e00\u70b9 2\uff09\u3001TokuDB\u5bfc\u5165\u6570\u636e\u6bd4InnoDB\u901f\u5ea6\u5feb\u4e00\u500d 3\uff09\u3001TokuDB\u91c7\u7528\u591aCPU\u5e76\u53d1\u5bfc\u5165","title":"1\u3001MariaDB\u5bfc\u5165\u6570\u636e\uff1a"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#2mariadb","text":"[root@localhost billing]# ll -h -rw-rw----. 1 mysql mysql 1.5K Nov 4 14:16 cloud_innodb.frm -rw-rw----. 1 mysql mysql 568M Nov 4 14:40 cloud_innodb.ibd [root@localhost mysqldata]# ll -h -rw-rw----. 1 mysql mysql 26M Nov 4 14:31 _billing_cloud_tokudb_main_172d_1_1b_B_0.tokudb -rw-rw----. 1 mysql mysql 64K Nov 4 14:31 _billing_cloud_tokudb_status_1729_1_1b.tokudb Mysql\u5b58\u50a8\u7a7a\u95f4 [root@localhost billing]# ll -h -rw-rw----. 1 mysql mysql 8.9K Nov 4 14:17 cloud_innodb.frm -rw-rw----. 1 mysql mysql 568M Nov 4 14:36 cloud_innodb.ibd [root@localhost mysqldata]# ll -h -rw-rw----. 1 mysql mysql 26M Nov 4 14:37 _billing_cloud_tokudb_main_8be1_1_1c_B_0.tokudb -rw-rw----. 1 mysql mysql 64K Nov 4 14:37 _billing_cloud_tokudb_status_8bde_1_1c.tokudb \u603b\u7ed3\uff1a 1\uff09\u3001 MariaDB\u548cMysql\u5728\u91c7\u7528\u76f8\u540c\u5f15\u64ce\u7684\u65f6\u5019\u5b58\u50a8\u7a7a\u95f4\u76f8\u540c 2\uff09\u3001 TokuDB\u7684\u538b\u7f29\u6709\u5f88\u591a\u79cd\uff0c\u4e0a\u9762\u91c7\u7528tokudb_lzma,\u538b\u7f29\u6bd4\u4f8b\u6700\u5927\uff0c\u4f46\u975e\u5e38\u6d88\u8017CPU\uff0c\u5185\u5b58 3\uff09\u3001 TokuDB\u548cInnoDB\u4ece\u4e0a\u9762\u7684\u4f8b\u5b50\u6765\u770b\u538b\u7f29\u6bd4\u7387\u662f1\uff1a20\u5de6\u53f3\uff0c\u5982\u679c\u90fd\u662f\u6574\u578b\u6570\u636e\uff0c\u538b\u7f29\u6bd4\u7387\u57281\uff1a4\u5de6\u53f3\u3002","title":"2\u3001MariaDB\u5b58\u50a8\u7a7a\u95f4"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#3mariadb","text":"\u91cd\u542f\u7b2c\u4e00\u6b21\u67e5\u8be2 MariaDB [billing]> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.58 sec) MariaDB [billing]> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (16.55 sec) \u6e05\u7f13\u5b58\uff08reset query cache\uff09 MariaDB [billing]> reset query cache; Query OK, 0 rows affected (0.02 sec) MariaDB [billing]> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.42 sec) MariaDB [billing]> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.43 sec) Mysql\u67e5\u8be2\u901f\u5ea6 mysql> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.66 sec) mysql> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (13.74 sec) \u6e05\u7f13\u5b58\uff08reset query cache\uff09 mysql> reset query cache; Query OK, 0 rows affected (0.03 sec) mysql> select count(*) from cloud_innodb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.38 sec) mysql> select count(*) from cloud_tokudb; +----------+ | count(*) | +----------+ | 641098 | +----------+ 1 row in set (0.49 sec) \u603b\u7ed3\uff1a 1\uff09\u3001 \u67e5\u8be2\u901f\u5ea6MariaDB\u548cMysql\u901f\u5ea6\u5dee\u4e0d\u591a 2\uff09\u3001 \u7b2c\u4e00\u6b21\u67e5\u8be2\u7684\u65f6\u5019InnoDB\u548cTokuDB\u901f\u5ea6\u76f8\u5dee\u5f88\u5927 3\uff09\u3001 \u6e05\u7f13\u5b58\u540e\u67e5\u8be2\u5dee\u4e0d\u591a","title":"3\u3001MariaDB\u67e5\u8be2\u901f\u5ea6"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#4","text":"MariaDB\uff1a [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.509 seconds Minimum number of seconds to run all queries: 0.509 seconds Maximum number of seconds to run all queries: 0.509 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.600 seconds Minimum number of seconds to run all queries: 0.600 seconds Maximum number of seconds to run all queries: 0.600 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.901 seconds Minimum number of seconds to run all queries: 0.901 seconds Maximum number of seconds to run all queries: 0.901 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost mysqldata]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 1.028 seconds Minimum number of seconds to run all queries: 1.028 seconds Maximum number of seconds to run all queries: 1.028 seconds Number of clients running queries: 1000 Average number of queries per client: 0 Mysql\uff1a [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.496 seconds Minimum number of seconds to run all queries: 0.496 seconds Maximum number of seconds to run all queries: 0.496 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select count(content) from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.483 seconds Minimum number of seconds to run all queries: 0.483 seconds Maximum number of seconds to run all queries: 0.483 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_innodb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 1.231 seconds Minimum number of seconds to run all queries: 1.231 seconds Maximum number of seconds to run all queries: 1.231 seconds Number of clients running queries: 1000 Average number of queries per client: 0 [root@localhost billing]# mysqlslap --concurrency=1000 --iterations=1 --create-schema='billing' --query='select content from cloud_tokudb where id >9950 and id < 9999;' --number-of-queries=10 Benchmark Average number of seconds to run all queries: 0.739 seconds Minimum number of seconds to run all queries: 0.739 seconds Maximum number of seconds to run all queries: 0.739 seconds Number of clients running queries: 1000 Average number of queries per client: 0 \u603b\u7ed3 1\uff09\u3001 \u5e76\u53d1\u67e5\u8be2\u4e24\u6570\u636e\u76f8\u5dee\u4e0d\u662f\u5f88\u5927 2\uff09\u3001 Tokudb\u67e5\u8be2\u901f\u5ea6\u5728MariaDB\u4e2d\u6bd4InnoDB\u5f15\u64ce\u6162\u4e00\u70b9\uff0c\u4f46\u5728Mysql\u4e2d\u6bd4InnoDB\u5f15\u64ce\u901f\u5ea6\u8fd8\u5feb\uff08\u7f51\u4e0a\u8bf4\u7684TokuDB\u67e5\u8be2\u901f\u5ea6\u4e0d\u884c\uff0c\u6ca1\u6709\u9a8c\u8bc1\u51fa\u6765\uff0c\u4e0d\u77e5\u9053\u771f\u6b63\u5728\u7ebf\u901f\u5ea6\u600e\u4e48\u6837\uff0c\u6309\u7406\u8bf4\u538b\u7f29\u540e\u7684\u6570\u636e\u5e94\u8be5\u67e5\u8be2\u8981\u6162\u4e8e\u6ca1\u6709\u538b\u7f29\u7684\u6570\u636e\uff09","title":"4\u3001\u5e76\u53d1\u67e5\u8be2"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#5","text":"MariaDB [billing]> update cloud_innodb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 81099 rows affected (5.71 sec) Rows matched: 81099 Changed: 81099 Warnings: 0 MariaDB [billing]> update cloud_tokudb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 81099 rows affected (3.46 sec) mysql> update cloud_innodb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 80952 rows affected (5.32 sec) Rows matched: 81099 Changed: 80952 Warnings: 0 mysql> update cloud_tokudb set content=\"ddddddddddddddddddddsssssss\" where id >8900 and id < 90000; Query OK, 80952 rows affected (3.40 sec) Rows matched: 81099 Changed: 80952 Warnings: 0 \u603b\u7ed3 1\uff09\u3001\u4e24\u6570\u636e\u5e93\u6027\u80fd\u5dee\u4e0d\u591a 2\uff09\u3001\u6279\u91cf\u66f4\u65b0\u611f\u89c9TokuDB\u901f\u5ea6\u6bd4InnoDB\u901f\u5ea6\u5feb\uff08\u548c\u7f51\u4e0a\u8bf4\u7684\u53c8\u4e0d\u4e00\u6837\uff09","title":"5\u3001 \u6279\u91cf\u66f4\u65b0"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#6ddl","text":"\u6dfb\u52a0\u7d22\u5f15 MariaDB [billing]> create index idx_uid on cloud_innodb(uid); Query OK, 0 rows affected (12.23 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> create index idx_uid on cloud_tokudb(uid); Query OK, 0 rows affected (29.51 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> create index idx_uid on cloud_innodb(uid); Query OK, 0 rows affected (15.48 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> create index idx_uid on cloud_tokudb(uid); Query OK, 0 rows affected (31.10 sec) Records: 0 Duplicates: 0 Warnings: 0 \u5220\u9664\u7d22\u5f15 MariaDB [billing]> drop index idx_uid on cloud_innodb; Query OK, 0 rows affected (0.05 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> drop index idx_uid on cloud_tokudb; Query OK, 0 rows affected (0.09 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> drop index idx_uid on cloud_innodb; Query OK, 0 rows affected (0.07 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> drop index idx_uid on cloud_tokudb; Query OK, 0 rows affected (0.13 sec) Records: 0 Duplicates: 0 Warnings: 0 \u6dfb\u52a0\u5b57\u6bb5 MariaDB [billing]> alter table cloud_innodb add column test_flag varchar(20); Query OK, 0 rows affected (1 min 20.06 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> alter table cloud_tokudb add column test_flag varchar(20); Query OK, 0 rows affected (0.16 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_innodb add column test_flag varchar(20); Query OK, 0 rows affected (1 min 31.07 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_tokudb add column test_flag varchar(20); Query OK, 0 rows affected (0.23 sec) Records: 0 Duplicates: 0 Warnings: 0 \u5220\u9664\u5b57\u6bb5 MariaDB [billing]> alter table cloud_innodb drop column test_flag; Query OK, 0 rows affected (1 min 19.48 sec) Records: 0 Duplicates: 0 Warnings: 0 MariaDB [billing]> alter table cloud_tokudb drop column test_flag; Query OK, 0 rows affected (0.23 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_innodb drop column test_flag; Query OK, 0 rows affected (1 min 55.31 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql> alter table cloud_tokudb drop column test_flag; Query OK, 0 rows affected (1.28 sec) Records: 0 Duplicates: 0 Warnings: 0 \u603b\u7ed3 1\u3001MariaDB\u7684DDL\u64cd\u4f5c\u6bd4Mysql\u7684\u5feb 2\u3001InnoDB\u7684\u6dfb\u52a0\u7d22\u5f15\u6bd4TokuDB\u7684\u5feb 3\u3001\u5220\u9664\u7d22\u5f15\u4e24\u4e2a\u5f15\u64ce\u90fd\u5f88\u5feb 4\u3001\u6dfb\u52a0\u5b57\u6bb5TokuDB\u975e\u5e38\u5feb\uff0cInnoDB\u5f88\u6162 5\u3001\u5220\u9664\u5b57\u6bb5TokuDB\u975e\u5e38\u5feb\uff0cInnoDB\u5f88\u6162","title":"6\u3001DDL\u64cd\u4f5c\u5bf9\u6bd4"},{"location":"other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_1","text":"\u603b\u7ed3\uff1a TokuDB\u4f18\u70b9 1\uff0conline ddl \u975e\u5e38\u7ed9\u529b\uff0c\u7279\u522b\u662f\u5bf9\u5b57\u6bb5\u7684\u4fee\u6539\u975e\u5e38\u5feb 2\uff0c\u538b\u7f29\u6bd4\u975e\u5e38\u9ad8\u901a\u5e38\u90fd\u80fd\u8fbe\u52307,8\u500d\u7684\u538b\u7f29\u6bd4 3\uff0c\u5b8c\u5168\u652f\u6301ACID\u4e8b\u7269\u7684\u56db\u5927\u7279\u6027 TokuDB\u7f3a\u70b9 1\uff0c\u54cd\u5e94\u65f6\u95f4\u76f8\u5bf9\u8f83\u957f 2\uff0conline ddl \u5bf9text,blob\u7b49\u7c7b\u578b\u7684\u5b57\u6bb5\u4e0d\u9002\u7528 3\uff0c\u6ca1\u6709\u5408\u9002\u7684\u5907\u4efd\u5de5\u5177\uff0c\u53ea\u80fd\u901a\u8fc7mysqldump\u8fdb\u884c\u903b\u8f91\u5907\u4efd \u5efa\u8bae\u9002\u7528\u573a\u666f\uff1a 1\uff0c\u8bbf\u95ee\u9891\u7387\u4e0d\u9ad8\u7684\u6570\u636e\u6216\u5386\u53f2\u6570\u636e\u5f52\u6863 2\uff0c\u8868\u975e\u5e38\u5927\u5e76\u4e14\u65f6\u4e0d\u65f6\u8fd8\u9700\u8981\u8fdb\u884cddl\u64cd\u4f5c \u7279\u70b9\uff1a 1.\u63d2\u5165\u6027\u80fd\u5feb20~80\u500d\uff1b 2.\u538b\u7f29\u6570\u636e\u51cf\u5c11\u5b58\u50a8\u7a7a\u95f4\uff1b 3.\u6570\u636e\u91cf\u53ef\u4ee5\u6269\u5c55\u5230\u51e0\u4e2aTB\uff1b 4.\u4e0d\u4f1a\u4ea7\u751f\u7d22\u5f15\u788e\u7247\uff1b 5.\u652f\u6301hot column addition \uff0c hot indexing\uff0c mvcc\uff1b \u5982\u4f55\u8003\u8651\u4f7f\u7528\uff1a 1.\u5982\u679c\u8981\u5b58\u50a8blob\uff0c\u4e0d\u8981\u4f7f\u7528tokuDB\uff0c\u56e0\u4e3a\u4ed6\u7684\u8bb0\u5f55\u4e0d\u80fd\u592a\u5927\uff1b 2.\u5982\u679c\u8bb0\u5f55\u6570\u8fc7\u4ebf\uff0c\u4f7f\u7528tokuDB\uff1b 3.\u5982\u679c\u6ce8\u91cdupdate\u7684\u6027\u80fd\uff0c\u4e0d\u8981\u4f7f\u7528tokuDB\uff0c\u4ed6\u6ca1\u6709innodb\u5feb\uff1b 4.\u5982\u679c\u8981\u5b58\u50a8\u65e7\u7684\u8bb0\u5f55\uff0c\u4f7f\u7528tokuDB\uff1b 5.\u5982\u679c\u8981\u7f29\u5c0f\u6570\u636e\u5360\u7528\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u4f7f\u7528tokuDB\uff1b \u603b\u7ed3\uff1a TokuDB\u7684\u4f18\u70b9\uff1a1\u3001\u9ad8\u538b\u7f29\u6bd4 2\u3001\u9ad8insert\u6027\u80fd 3\u3001\u589e\u5220\u5b57\u6bb5\u79d2\u7ea7\u3002 TokuDB\u7684\u7f3a\u70b9\uff1a1\u3001cpu usr\u6001\u6d88\u8017\u9ad8 2\u3001\u54cd\u5e94\u65f6\u95f4\u53d8\u957f\u3002","title":"\u7f51\u4e0a\u7684\u4e00\u4e9b\u603b\u7ed3"},{"location":"other/phantomjs%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/","tags":"[phantomjs]","text":"\u7528phantomjs\u53bb\u622a\u53d6\u4e2d\u6587\u9875\u9762\u7684\u7f51\u7ad9\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e71\u7801\u7684\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f\u622a\u56fe\u4e2d\u4e2d\u6587\u7684\u4f4d\u7f6e\u5168\u662f\u65b9\u6846\u3002 \u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u5b89\u88c5\u5b57\u4f53\u3002 \u5728centos\u4e2d\u6267\u884c\uff1ayum install bitmap-fonts bitmap-fonts-cjk \u5728ubuntu/debian\u4e2d\u6267\u884c\uff1asudo apt-get install xfonts-wqy \u8fd9\u6837\u518d\u53bb\u622a\u56fe\u4e2d\u6587\u7684\u9875\u9762\u5c31\u4e0d\u4f1a\u51fa\u73b0\u4e00\u5806\u7684\u65b9\u6846\u4e86\u3002 \u5982\u679c\u9700\u8981\u4f7f\u7528\u5fae\u8f6f\u96c5\u9ed1\u5b57\u4f53\uff0c\u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c\uff1a mkdir /usr/share/fonts/win/ \u2003\u2003\u4e0b\u8f7d\u5fae\u8f6f\u96c5\u9ed1\u5b57\u4f53: \u2003\u2003wget https://nipao.googlecode.com/files/msyh.ttf -O /usr/share/fonts/win/msyh.ttf \u2003\u2003\u5efa\u7acb\u5b57\u4f53\u7d22\u5f15\uff0c\u66f4\u65b0\u5b57\u4f53\u7f13\u5b58: \u2003\u2003 cd /usr/share/fonts/win/ \u2003\u2003mkfontscale \u2003\u2003mkfontdir \u2003\u2003fc-cache","title":"phantomjs\u4e2d\u6587\u95ee\u9898"},{"location":"other/php-extension%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/","tags":"[php\u6269\u5c55\u5f00\u53d1]","text":"\u89c1\uff1a http://blog.codinglabs.org/articles/php-extension-dev-guide.html","title":"PHP Extension\u5f00\u53d1\u57fa\u7840"},{"location":"other/php%E8%8E%B7%E5%8F%96raw-post-data%E6%95%B0%E6%8D%AE/","tags":"[Raw POST]","text":"\u901a\u5e38\u5728\u505a\u7f51\u7ad9\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u63a5\u6536POST\u6570\u7ec4\u901a\u8fc7 _POST\u5373\u53ef\u83b7\u53d6\uff0c\u4f46\u662f\u5982\u679c\u628a\u4e00\u6bb5 XML \u6587\u672c\u76f4\u63a5\u4f5c\u4e3aPOST DATA\u63d0\u4ea4\u5230\u670d\u52a1\u5668\u65f6\uff0c _POST\u5373\u53ef\u83b7\u53d6\uff0c\u4f46\u662f\u5982\u679c\u628a\u4e00\u6bb5 XML \u6587\u672c\u76f4\u63a5\u4f5c\u4e3aPOST DATA\u63d0\u4ea4\u5230\u670d\u52a1\u5668\u65f6\uff0c _POST\u662f\u4e00\u4e2a\u7a7a\u6570\u7ec4\uff0c\u5982\uff1a curl -X POST http://www.example.com -H \"Accept:application/json\" -d '{\"ip\":\"8.8.4.4\"}' \u5982\u4f55\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff0cPHP\u63d0\u4f9b\u4e86\u89e3\u6790Raw POST data\u7684\u65b9\u6cd5\uff0c\u89c1http:// www.php.net/manual/en/reserved.variables.httprawpostdata.php \uff0c\u7528\u6cd5\u5982\u4e0b\uff1a $postdata = file_get_contents(\"php://input\"); \u89e3\u91ca\u4e00\u4e0b\uff0cphp://input \u662f\u4e00\u4e2a\u8d44\u6e90\u6807\u8bc6\uff0c\u7528 file_get_contents \u4ece\u8fd9\u4e2a\u8d44\u6e90\u4e2d\u83b7\u53d6\u7684\u5185\u5bb9\uff0c\u5c31\u662f\u539f\u59cb\u7684 Raw POST Data\u3002","title":"PHP\u83b7\u53d6Raw POST Data\u6570\u636e"},{"location":"other/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/","tags":"[rsync]","text":"\u540c\u6b65\u670d\u52a1\u5668192.168.1.100 \u63a5\u6536\u670d\u52a1\u5668192.168.1.200 \u5373\u628a192.168.1.100\u7684\u4ee3\u7801\u5907\u4efd\u5230192.168.1.200\u3002 192.168.1.100\u4e0a\u7684\u914d\u7f6e\u5982\u4e0b\uff1a \u00b6 yum install rsync inotify-tools crontab -e */59 * * * * /bin/sh /usr/local/scripts/rsync.sh >> /var/log/rsync.log \u5373\u6bcf\u5c0f\u65f6\u7684\u7b2c59\u5206\u949f\u540c\u6b65\u4ee3\u7801 /usr/local/scripts/rsync.sh\u811a\u672c\u5185\u5bb9\u5982\u4e0b \u00b6 #!/bin/sh SRC = /var/www/html/ #\u8bb0\u5f97\u5728\u6700\u540e\u9762\u52a0/\u4e0d\u7136RYNC\u4f1a\u81ea\u52a8\u589e\u52a0\u4e00\u5c42\u76ee\u5f55 DES = rsync_data #192.168.1.200\u8ba4\u8bc1\u7684\u6a21\u5757\u540d\uff0c\u540e\u9762\u4f1a\u8bf4\u660e IP = 192 .168.1.200 USER = backup INWT = /usr/bin/inotifywait RSYNC = /usr/bin/rsync $RSYNC -auzviL --delete --progress --password-file = /root/rsync.pwd $SRC $USER @ $IP :: $DES rsync \u9009\u9879\u8bf4\u660e -a \u79f0\u4e3a\u5f52\u6863\u6a21\u5f0f\uff0c\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c \u9012\u5f52\u6a21\u5f0f \u4fdd\u7559\u7b26\u53f7\u94fe\u63a5 \u4fdd\u7559\u6743\u9650 \u4fdd\u7559\u65f6\u95f4\u6807\u8bb0 \u4fdd\u7559\u7528\u6237\u540d\u53ca\u7ec4\u540d -z \u5f00\u542f\u538b\u7f29 -v \u8be6\u60c5\u8f93\u51fa -u \u9009\u9879\u53ef\u4ee5\u6392\u9664\u88ab\u4fee\u6539\u8fc7\u7684\u76ee\u7684\u6587\u4ef6 -L \u628a\u8f6f\u8fde\u63a5\u6587\u4ef6\u5939\u540c\u6b65\u8fc7\u6765 \u67e5\u770b\u6bcf\u4e2a\u6587\u4ef6\u7684\u4f20\u8f93\u8fdb\u7a0b,\u7528 \u2013-progress \u53c2\u6570 \u5220\u9664\u5728\u76ee\u7684\u6587\u4ef6\u5939\u4e2d\u521b\u5efa\u7684\u6587\u4ef6,\u7528 \u2013-delete \u53c2\u6570 192.168.1.200\u4e0a\u7684\u914d\u7f6e\u5982\u4e0b\uff1a \u00b6 yum install rsync vim /etc/rsyncd.conf uid = root gid = root max connections = 36000 use chroot = no log file = /var/log/rsyncd.log pid file = /var/run/rsyncd.pid lock file = /var/run/rsyncd.lock [ rsync_data ] path = /data/192.168.1.100/ #192.168.1.100\u662f\u4e00\u4e2a\u5fc5\u987b\u5b58\u5728\u7684\u76ee\u5f55 comment = 192 .168.1.100 ignore errors = yes read only = no hosts allow = 192 .168.1.100 rsync\u542f\u52a8\u811a\u672c #! /bin/sh # # chkconfig: 2345 50 50 # description: The rsync daemon # source function library . /etc/rc.d/init.d/functions PROG = '/usr/bin/rsync' BASE = ${ 0 ##*/ } # Adapt the --config parameter to point to your rsync daemon configuration # The config file must contain following line: # pid file = /var/run/<filename>.pid # Where <filename> is the filename of the init script (= this file) OPTIONS = \"--daemon --config=/etc/rsyncd.conf\" case \" $1 \" in start ) echo -n $ \"Starting $BASE : \" daemon --check $BASE $PROG $OPTIONS RETVAL = $? [ $RETVAL -eq 0 ] && touch /var/lock/subsys/ $BASE echo ;; stop ) echo -n $ \"Shutting down $BASE : \" killproc $BASE RETVAL = $? [ $RETVAL -eq 0 ] && rm -f /var/lock/subsys/ $BASE echo ;; restart | force-reload ) $0 stop sleep 1 $0 start ;; * ) echo \"Usage: $0 {start|stop|restart|force-reload}\" > & 2 exit 1 ;; esac exit 0 \u81f3\u6b64\uff0c\u540c\u6b65\u5c31\u7b97\u5b8c\u6210\u3002\u53ef\u4ee5tailf /var/log/rsync.log\u67e5\u770b\u540c\u6b65\u65e5\u5fd7\u3002","title":"\"rsync\u4e3b\u5907\u4ee3\u7801\u540c\u6b65\""},{"location":"other/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/#1921681100","text":"yum install rsync inotify-tools crontab -e */59 * * * * /bin/sh /usr/local/scripts/rsync.sh >> /var/log/rsync.log \u5373\u6bcf\u5c0f\u65f6\u7684\u7b2c59\u5206\u949f\u540c\u6b65\u4ee3\u7801","title":"192.168.1.100\u4e0a\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"},{"location":"other/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/#usrlocalscriptsrsyncsh","text":"#!/bin/sh SRC = /var/www/html/ #\u8bb0\u5f97\u5728\u6700\u540e\u9762\u52a0/\u4e0d\u7136RYNC\u4f1a\u81ea\u52a8\u589e\u52a0\u4e00\u5c42\u76ee\u5f55 DES = rsync_data #192.168.1.200\u8ba4\u8bc1\u7684\u6a21\u5757\u540d\uff0c\u540e\u9762\u4f1a\u8bf4\u660e IP = 192 .168.1.200 USER = backup INWT = /usr/bin/inotifywait RSYNC = /usr/bin/rsync $RSYNC -auzviL --delete --progress --password-file = /root/rsync.pwd $SRC $USER @ $IP :: $DES rsync \u9009\u9879\u8bf4\u660e -a \u79f0\u4e3a\u5f52\u6863\u6a21\u5f0f\uff0c\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c \u9012\u5f52\u6a21\u5f0f \u4fdd\u7559\u7b26\u53f7\u94fe\u63a5 \u4fdd\u7559\u6743\u9650 \u4fdd\u7559\u65f6\u95f4\u6807\u8bb0 \u4fdd\u7559\u7528\u6237\u540d\u53ca\u7ec4\u540d -z \u5f00\u542f\u538b\u7f29 -v \u8be6\u60c5\u8f93\u51fa -u \u9009\u9879\u53ef\u4ee5\u6392\u9664\u88ab\u4fee\u6539\u8fc7\u7684\u76ee\u7684\u6587\u4ef6 -L \u628a\u8f6f\u8fde\u63a5\u6587\u4ef6\u5939\u540c\u6b65\u8fc7\u6765 \u67e5\u770b\u6bcf\u4e2a\u6587\u4ef6\u7684\u4f20\u8f93\u8fdb\u7a0b,\u7528 \u2013-progress \u53c2\u6570 \u5220\u9664\u5728\u76ee\u7684\u6587\u4ef6\u5939\u4e2d\u521b\u5efa\u7684\u6587\u4ef6,\u7528 \u2013-delete \u53c2\u6570","title":"/usr/local/scripts/rsync.sh\u811a\u672c\u5185\u5bb9\u5982\u4e0b"},{"location":"other/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/#1921681200","text":"yum install rsync vim /etc/rsyncd.conf uid = root gid = root max connections = 36000 use chroot = no log file = /var/log/rsyncd.log pid file = /var/run/rsyncd.pid lock file = /var/run/rsyncd.lock [ rsync_data ] path = /data/192.168.1.100/ #192.168.1.100\u662f\u4e00\u4e2a\u5fc5\u987b\u5b58\u5728\u7684\u76ee\u5f55 comment = 192 .168.1.100 ignore errors = yes read only = no hosts allow = 192 .168.1.100 rsync\u542f\u52a8\u811a\u672c #! /bin/sh # # chkconfig: 2345 50 50 # description: The rsync daemon # source function library . /etc/rc.d/init.d/functions PROG = '/usr/bin/rsync' BASE = ${ 0 ##*/ } # Adapt the --config parameter to point to your rsync daemon configuration # The config file must contain following line: # pid file = /var/run/<filename>.pid # Where <filename> is the filename of the init script (= this file) OPTIONS = \"--daemon --config=/etc/rsyncd.conf\" case \" $1 \" in start ) echo -n $ \"Starting $BASE : \" daemon --check $BASE $PROG $OPTIONS RETVAL = $? [ $RETVAL -eq 0 ] && touch /var/lock/subsys/ $BASE echo ;; stop ) echo -n $ \"Shutting down $BASE : \" killproc $BASE RETVAL = $? [ $RETVAL -eq 0 ] && rm -f /var/lock/subsys/ $BASE echo ;; restart | force-reload ) $0 stop sleep 1 $0 start ;; * ) echo \"Usage: $0 {start|stop|restart|force-reload}\" > & 2 exit 1 ;; esac exit 0 \u81f3\u6b64\uff0c\u540c\u6b65\u5c31\u7b97\u5b8c\u6210\u3002\u53ef\u4ee5tailf /var/log/rsync.log\u67e5\u770b\u540c\u6b65\u65e5\u5fd7\u3002","title":"192.168.1.200\u4e0a\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"},{"location":"other/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/","tags":"[sublime text]","text":"\u8be5\u65b9\u5f0f\u9002\u7528\u4e8esublime text2\u548c3\u3002 \u521b\u5efa\u4ee3\u7801\u7247\u6bb5 \u00b6 \u70b9\u51fb\u83dc\u5355\u680f\u91cc\u7684 Tools \u83dc\u5355\uff0c\u7136\u540e\u70b9\u51fb New Snippet\uff0c\u4e4b\u540e\u4f1a\u5728\u65b0\u7684 tab \u9875\u521b\u5efa\u4e00\u4e2a\u4ee3\u7801\u7247\u6bb5\u6a21\u677f\uff0c\u7f16\u8f91\u4ee3\u7801\u5982\u4e0b <snippet> <content><! [ CDATA [ /** * \u5b9a\u4e49\u51fd\u6570 * * \u51fd\u6570\u529f\u80fd\u63cf\u8ff0 * * @author panjun.liu <lpj163@gmail.com> * * @param int $param1 \u53c2\u6570\u91ca\u4e49 * @param string $param2 \u53c2\u6570\u91ca\u4e49 * * @return integer | string | array */ ]] ></content> <!-- Optional: Set a tabTrigger to define how to trigger the snippet --> <tabTrigger>phpdoc</tabTrigger> <!-- Optional: Set a scope to limit where the snippet will trigger --> <!-- <scope>source.python</scope> --> </snippet> \u6ce8\uff1a tabTrigger \u6b64\u8282\u662f\u53ef\u9009\u7684\u914d\u7f6e\uff0c\u9ed8\u8ba4\u662f\u88ab\u6ce8\u91ca\u6389\u7684\u3002\u9ed8\u8ba4 hello \u7684\u610f\u601d\u662f\uff1a\u5982\u679c\u4f60\u5728\u67d0\u4e2a\u6587\u6863\u91cc\u8f93\u5165\u4e86\u5355\u8bcd hello \uff0c\u7136\u540e\u6309\u4e0b Tab \u952e\uff0c\u63a5\u7740 hello \u5c31\u4f1a\u88ab\u66ff\u6362\u4e3a1\u4e2d\u5b9a\u4e49\u7684\u4ee3\u7801\u7247\u6bb5\u3002\u518d\u6b21\u6309\u4e0bTab\u952e\uff0c\u63a5\u7740snippet\u4f1a\u88ab\u66ff\u6362\u4e3a2\u4e2d\u5b9a\u4e49\u7684\u4ee3\u7801\u7247\u6bb5\u3002 \u4fdd\u5b58\u5230\u5f53\u524d\u7528\u6237\u4e3b\u76ee\u5f55\u4e0b\u7684\\Sublime Text 3\\Packages\\User\u76ee\u5f55\u4e2d\uff0c\u547d\u540d\u4e3aphpdoc.sublime-snippet(\u6ce8\u610f\uff1a\u540e\u7f00\u5fc5\u987b\u4e3a.sublime-snippet)\u3002 \u7ed1\u5b9a\u5feb\u6377\u952e \u00b6 \u53ef\u4ee5\u5c06\u4e0a\u8ff0\u7684\u64cd\u4f5c\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5feb\u6377\u952e\uff0c\u5728\u4e0d\u952e\u5165\u4efb\u4f55\u6587\u672c\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u6309\u5feb\u6377\u952e\u63d2\u5165\u4ee3\u7801\u7247\u6bb5\u3002 \u70b9\u51fb\u83dc\u5355\u680f\u7684 Preferences \u7684\u5b50\u83dc\u5355 Key Binding \u2013 User\uff0c\u5728\u6253\u5f00\u7684\u6587\u4ef6\u7684\u65b9\u62ec\u53f7\u5185\u90e8\u7c98\u8d34\u5982\u4e0b\u914d\u7f6e\uff1a [ { \"keys\" : [ \"phpdoc\" ] , \"command\" : \"insert_snippet\" , \"args\" : { \"name\" : \"Packages/User/phpdoc.sublime-snippet\" } } ] \u73b0\u5728\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u8fd9\u6bb5\u914d\u7f6e\uff1a \"keys\": [\"phpdoc\"] \u8fd9\u4e2a\u5b9a\u4e49\u4e86\u89e6\u53d1\u6b64\u547d\u4ee4\u7684\u5feb\u6377\u952e\u3002 \"command\": \"insert_snippet\" \u8fd9\u4e2a\u662f\u9700\u8981\u89e6\u53d1\u7684\u547d\u4ee4\u7684\u540d\u5b57\u3002 \"args\": {\"name\": \"Packages/User/phpdoc.sublime-snippet\"} \u8fd9\u4e2a\u662f\u9700\u8981\u4f20\u5165\u5230\u4e0a\u8ff0\u547d\u4ee4\u7684\u53c2\u6570\u3002\u8fd9\u91cc\u628a\u4ee3\u7801\u7247\u6bb5\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u4f20\u9012\u8fc7\u53bb\u3002 \u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\uff0c\u73b0\u5728\u5c31\u53ef\u4ee5\u7528\u5feb\u6377\u952e\u63d2\u5165\u4ee3\u7801\u7247\u6bb5\u4e86\u3002 \u81f3\u6b64\uff0c\u8f93\u5165phpdoc\uff0c\u7136\u540e\u6309tab\u952e\u5c31\u4f1a\u8f93\u51fa\u4f60\u5b9a\u4e49\u8fd9\u6bb5\u6ce8\u91ca\u3002","title":"\"sublime text\u521b\u5efa\u5feb\u6377\u6ce8\u91ca\u4fe1\u606f\""},{"location":"other/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/#_1","text":"\u70b9\u51fb\u83dc\u5355\u680f\u91cc\u7684 Tools \u83dc\u5355\uff0c\u7136\u540e\u70b9\u51fb New Snippet\uff0c\u4e4b\u540e\u4f1a\u5728\u65b0\u7684 tab \u9875\u521b\u5efa\u4e00\u4e2a\u4ee3\u7801\u7247\u6bb5\u6a21\u677f\uff0c\u7f16\u8f91\u4ee3\u7801\u5982\u4e0b <snippet> <content><! [ CDATA [ /** * \u5b9a\u4e49\u51fd\u6570 * * \u51fd\u6570\u529f\u80fd\u63cf\u8ff0 * * @author panjun.liu <lpj163@gmail.com> * * @param int $param1 \u53c2\u6570\u91ca\u4e49 * @param string $param2 \u53c2\u6570\u91ca\u4e49 * * @return integer | string | array */ ]] ></content> <!-- Optional: Set a tabTrigger to define how to trigger the snippet --> <tabTrigger>phpdoc</tabTrigger> <!-- Optional: Set a scope to limit where the snippet will trigger --> <!-- <scope>source.python</scope> --> </snippet> \u6ce8\uff1a tabTrigger \u6b64\u8282\u662f\u53ef\u9009\u7684\u914d\u7f6e\uff0c\u9ed8\u8ba4\u662f\u88ab\u6ce8\u91ca\u6389\u7684\u3002\u9ed8\u8ba4 hello \u7684\u610f\u601d\u662f\uff1a\u5982\u679c\u4f60\u5728\u67d0\u4e2a\u6587\u6863\u91cc\u8f93\u5165\u4e86\u5355\u8bcd hello \uff0c\u7136\u540e\u6309\u4e0b Tab \u952e\uff0c\u63a5\u7740 hello \u5c31\u4f1a\u88ab\u66ff\u6362\u4e3a1\u4e2d\u5b9a\u4e49\u7684\u4ee3\u7801\u7247\u6bb5\u3002\u518d\u6b21\u6309\u4e0bTab\u952e\uff0c\u63a5\u7740snippet\u4f1a\u88ab\u66ff\u6362\u4e3a2\u4e2d\u5b9a\u4e49\u7684\u4ee3\u7801\u7247\u6bb5\u3002 \u4fdd\u5b58\u5230\u5f53\u524d\u7528\u6237\u4e3b\u76ee\u5f55\u4e0b\u7684\\Sublime Text 3\\Packages\\User\u76ee\u5f55\u4e2d\uff0c\u547d\u540d\u4e3aphpdoc.sublime-snippet(\u6ce8\u610f\uff1a\u540e\u7f00\u5fc5\u987b\u4e3a.sublime-snippet)\u3002","title":"\u521b\u5efa\u4ee3\u7801\u7247\u6bb5"},{"location":"other/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/#_2","text":"\u53ef\u4ee5\u5c06\u4e0a\u8ff0\u7684\u64cd\u4f5c\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5feb\u6377\u952e\uff0c\u5728\u4e0d\u952e\u5165\u4efb\u4f55\u6587\u672c\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u6309\u5feb\u6377\u952e\u63d2\u5165\u4ee3\u7801\u7247\u6bb5\u3002 \u70b9\u51fb\u83dc\u5355\u680f\u7684 Preferences \u7684\u5b50\u83dc\u5355 Key Binding \u2013 User\uff0c\u5728\u6253\u5f00\u7684\u6587\u4ef6\u7684\u65b9\u62ec\u53f7\u5185\u90e8\u7c98\u8d34\u5982\u4e0b\u914d\u7f6e\uff1a [ { \"keys\" : [ \"phpdoc\" ] , \"command\" : \"insert_snippet\" , \"args\" : { \"name\" : \"Packages/User/phpdoc.sublime-snippet\" } } ] \u73b0\u5728\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u8fd9\u6bb5\u914d\u7f6e\uff1a \"keys\": [\"phpdoc\"] \u8fd9\u4e2a\u5b9a\u4e49\u4e86\u89e6\u53d1\u6b64\u547d\u4ee4\u7684\u5feb\u6377\u952e\u3002 \"command\": \"insert_snippet\" \u8fd9\u4e2a\u662f\u9700\u8981\u89e6\u53d1\u7684\u547d\u4ee4\u7684\u540d\u5b57\u3002 \"args\": {\"name\": \"Packages/User/phpdoc.sublime-snippet\"} \u8fd9\u4e2a\u662f\u9700\u8981\u4f20\u5165\u5230\u4e0a\u8ff0\u547d\u4ee4\u7684\u53c2\u6570\u3002\u8fd9\u91cc\u628a\u4ee3\u7801\u7247\u6bb5\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u4f20\u9012\u8fc7\u53bb\u3002 \u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\uff0c\u73b0\u5728\u5c31\u53ef\u4ee5\u7528\u5feb\u6377\u952e\u63d2\u5165\u4ee3\u7801\u7247\u6bb5\u4e86\u3002 \u81f3\u6b64\uff0c\u8f93\u5165phpdoc\uff0c\u7136\u540e\u6309tab\u952e\u5c31\u4f1a\u8f93\u51fa\u4f60\u5b9a\u4e49\u8fd9\u6bb5\u6ce8\u91ca\u3002","title":"\u7ed1\u5b9a\u5feb\u6377\u952e"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/","tags":"[sysbench]","text":"sysbench\u662f\u4e00\u4e2a\u6a21\u5757\u5316\u7684\u3001\u8de8\u5e73\u53f0\u3001\u591a\u7ebf\u7a0b\u57fa\u51c6\u6d4b\u8bd5\u5de5\u5177\uff0c\u4e3b\u8981\u7528\u4e8e\u8bc4\u4f30\u6d4b\u8bd5\u5404\u79cd\u4e0d\u540c\u7cfb\u7edf\u53c2\u6570\u4e0b\u7684\u6570\u636e\u5e93\u8d1f\u8f7d\u60c5\u51b5\u3002\u5173\u4e8e\u8fd9\u4e2a\u9879\u76ee\u7684\u8be6\u7ec6\u4ecb\u7ecd\u8bf7\u770b\uff1a https://launchpad.net/sysbench \u3002 \u5b83\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u7684\u6d4b\u8bd5\uff1a 1\u3001cpu\u6027\u80fd 2\u3001\u78c1\u76d8io\u6027\u80fd 3\u3001\u8c03\u5ea6\u7a0b\u5e8f\u6027\u80fd 4\u3001\u5185\u5b58\u5206\u914d\u53ca\u4f20\u8f93\u901f\u5ea6 5\u3001POSIX\u7ebf\u7a0b\u6027\u80fd 6\u3001\u6570\u636e\u5e93\u6027\u80fd(OLTP\u57fa\u51c6\u6d4b\u8bd5) \u76ee\u524dsysbench\u4e3b\u8981\u652f\u6301 MySQL,pgsql,oracle \u8fd93\u79cd\u6570\u636e\u5e93\u3002 \u4e00\u3001\u5b89\u88c5 \u00b6 \u73af\u5883\uff1a centos 6.7 mysql 5.7.10 yum install automake gcc gcc-c++ libtool mysql-devel git clone https://github.com/akopytov/sysbench.git ./autogen.sh ./configure make && make install \u5982\u679c\u60f3\u8981\u8ba9 sysbench \u652f\u6301 pgsql/oracle \u7684\u8bdd\uff0c\u5c31\u9700\u8981\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u52a0\u4e0a\u53c2\u6570 --with-pgsql \u6216\u8005 --with-oracle \u8fd92\u4e2a\u53c2\u6570\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff0c\u53ea\u6709 MySQL \u662f\u9ed8\u8ba4\u652f\u6301\u7684\u3002 \u4e8c\u3001\u6d4b\u8bd5 \u00b6 1\u3001cpu\u6027\u80fd\u6d4b\u8bd5 \u00b6 sysbench --test = cpu --cpu-max-prime = 20000 run cpu\u6d4b\u8bd5\u4e3b\u8981\u662f\u8fdb\u884c\u7d20\u6570\u7684\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6307\u5b9a\u4e86\u6700\u5927\u7684\u7d20\u6570\u4e3a 20000\uff0c\u81ea\u5df1\u53ef\u4ee5\u6839\u636e\u673a\u5668cpu\u7684\u6027\u80fd\u6765\u9002\u5f53\u8c03\u6574\u6570\u503c\u3002 2\u3001\u7ebf\u7a0b\u6d4b\u8bd5 \u00b6 sysbench --test = threads --num-threads = 64 --thread-yields = 100 --thread-locks = 2 run 3\u3001\u78c1\u76d8IO\u6027\u80fd\u6d4b\u8bd5 \u00b6 sysbench --test = fileio --num-threads = 16 --file-total-size = 3G --file-test-mode = rndrw prepare sysbench --test = fileio --num-threads = 16 --file-total-size = 3G --file-test-mode = rndrw run sysbench --test = fileio --num-threads = 16 --file-total-size = 3G --file-test-mode = rndrw cleanup \u4e0a\u8ff0\u53c2\u6570\u6307\u5b9a\u4e86\u6700\u5927\u521b\u5efa16\u4e2a\u7ebf\u7a0b\uff0c\u521b\u5efa\u7684\u6587\u4ef6\u603b\u5927\u5c0f\u4e3a3G\uff0c\u6587\u4ef6\u8bfb\u5199\u6a21\u5f0f\u4e3a\u968f\u673a\u8bfb\u3002 4\u3001\u5185\u5b58\u6d4b\u8bd5 \u00b6 sysbench --test = memory --memory-block-size = 8k --memory-total-size = 4G run \u4e0a\u8ff0\u53c2\u6570\u6307\u5b9a\u4e86\u672c\u6b21\u6d4b\u8bd5\u6574\u4e2a\u8fc7\u7a0b\u662f\u5728\u5185\u5b58\u4e2d\u4f20\u8f93 4G \u7684\u6570\u636e\u91cf\uff0c\u6bcf\u4e2a block \u5927\u5c0f\u4e3a 8K\u3002 5\u3001OLTP\u6d4b\u8bd5 \u00b6 sysbench --mysql-host = 127 .0.0.1 --mysql-port = 3306 --mysql-user = root --mysql-password = root --test = /root/sysbench/sysbench/tests/db/oltp.lua --oltp_tables_count = 10 --oltp-table-size = 100000 --rand-init = on prepare \u5173\u4e8e\u8fd9\u51e0\u4e2a\u53c2\u6570\u7684\u89e3\u91ca\uff1a --test=tests/db/oltp.lua \u8868\u793a\u8c03\u7528 tests/db/oltp.lua \u811a\u672c\u8fdb\u884c oltp \u6a21\u5f0f\u6d4b\u8bd5 --oltp_tables_count=10 \u8868\u793a\u4f1a\u751f\u6210 10 \u4e2a\u6d4b\u8bd5\u8868 --oltp-table-size=100000 \u8868\u793a\u6bcf\u4e2a\u6d4b\u8bd5\u8868\u586b\u5145\u6570\u636e\u91cf\u4e3a 100000 --rand-init=on \u8868\u793a\u6bcf\u4e2a\u6d4b\u8bd5\u8868\u90fd\u662f\u7528\u968f\u673a\u6570\u636e\u6765\u586b\u5145\u7684 \u5982\u679c\u5728\u672c\u673a\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 \u2013mysql-socket \u6307\u5b9a socket \u6587\u4ef6\u6765\u8fde\u63a5\u3002\u52a0\u8f7d\u6d4b\u8bd5\u6570\u636e\u65f6\u957f\u89c6\u6570\u636e\u91cf\u800c\u5b9a\uff0c\u82e5\u8fc7\u7a0b\u6bd4\u8f83\u4e45\u9700\u8981\u7a0d\u52a0\u8010\u5fc3\u7b49\u5f85\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u6570\u636e\u8868\u5efa\u8bae\u4e0d\u4f4e\u4e8e10\u4e2a\uff0c\u5355\u8868\u6570\u636e\u91cf\u4e0d\u4f4e\u4e8e500\u4e07\u884c\uff0c\u5f53\u7136\u4e86\uff0c\u8981\u89c6\u670d\u52a1\u5668\u786c\u4ef6\u914d\u7f6e\u800c\u5b9a\u3002\u5982\u679c\u662f\u914d\u5907\u4e86SSD\u6216\u8005PCIE SSD\u8fd9\u79cd\u9ad8IOPS\u8bbe\u5907\u7684\u8bdd\uff0c\u5219\u5efa\u8bae\u5355\u8868\u6570\u636e\u91cf\u6700\u5c11\u4e0d\u4f4e\u4e8e1\u4ebf\u884c\u3002 sysbench --mysql-host = 127 .0.0.1 --mysql-port = 3306 --mysql-user = root \\ --mysql-password = root --test = /root/sysbench/sysbench/tests/db/oltp.lua --oltp_tables_count = 10 \\ --oltp-table-size = 10000000 --num-threads = 8 --oltp-read-only = off \\ --report-interval = 10 --rand-type = uniform --max-time = 3600 \\ --max-requests = 0 --percentile = 99 run >> /tmp/sysbench_oltpX_8.log \u53c2\u6570\u89e3\u91ca\uff1a --num-threads=8 \u8868\u793a\u53d1\u8d77 8\u4e2a\u5e76\u53d1\u8fde\u63a5 --oltp-read-only=off \u8868\u793a\u4e0d\u8981\u8fdb\u884c\u53ea\u8bfb\u6d4b\u8bd5\uff0c\u4e5f\u5c31\u662f\u4f1a\u91c7\u7528\u8bfb\u5199\u6df7\u5408\u6a21\u5f0f\u6d4b\u8bd5 --report-interval=10 \u8868\u793a\u6bcf10\u79d2\u8f93\u51fa\u4e00\u6b21\u6d4b\u8bd5\u8fdb\u5ea6\u62a5\u544a --rand-type=uniform \u8868\u793a\u968f\u673a\u7c7b\u578b\u4e3a\u56fa\u5b9a\u6a21\u5f0f\uff0c\u5176\u4ed6\u51e0\u4e2a\u53ef\u9009\u968f\u673a\u6a21\u5f0f\uff1auniform(\u56fa\u5b9a),gaussian(\u9ad8\u65af),special(\u7279\u5b9a\u7684),pareto(\u5e15\u7d2f\u6258) --max-time=120 \u8868\u793a\u6700\u5927\u6267\u884c\u65f6\u957f\u4e3a 120\u79d2 --max-requests=0 \u8868\u793a\u603b\u8bf7\u6c42\u6570\u4e3a 0\uff0c\u56e0\u4e3a\u4e0a\u9762\u5df2\u7ecf\u5b9a\u4e49\u4e86\u603b\u6267\u884c\u65f6\u957f\uff0c\u6240\u4ee5\u603b\u8bf7\u6c42\u6570\u53ef\u4ee5\u8bbe\u5b9a\u4e3a 0\uff1b\u4e5f\u53ef\u4ee5\u53ea\u8bbe\u5b9a\u603b\u8bf7\u6c42\u6570\uff0c\u4e0d\u8bbe\u5b9a\u6700\u5927\u6267\u884c\u65f6\u957f --percentile=99 \u8868\u793a\u8bbe\u5b9a\u91c7\u6837\u6bd4\u4f8b\uff0c\u9ed8\u8ba4\u662f 95%\uff0c\u5373\u4e22\u5f031%\u7684\u957f\u8bf7\u6c42\uff0c\u5728\u5269\u4f59\u768499%\u91cc\u53d6\u6700\u5927\u503c \u5373\uff1a\u6a21\u62df \u5bf910\u4e2a\u8868\u5e76\u53d1OLTP\u6d4b\u8bd5\uff0c\u6bcf\u4e2a\u88681000\u4e07\u884c\u8bb0\u5f55\uff0c\u6301\u7eed\u538b\u6d4b\u65f6\u95f4\u4e3a 1\u5c0f\u65f6\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u5efa\u8bae\u6301\u7eed\u538b\u6d4b\u65f6\u957f\u4e0d\u5c0f\u4e8e30\u5206\u949f\uff0c\u5426\u5219\u6d4b\u8bd5\u6570\u636e\u53ef\u80fd\u4e0d\u5177\u53c2\u8003\u610f\u4e49\u3002 6\u3001\u6d4b\u8bd5\u7ed3\u679c\u89e3\u8bfb \u00b6 \u6d4b\u8bd5\u7ed3\u679c\u89e3\u8bfb\u5982\u4e0b\uff1a sysbench 0 .5: multi-threaded system evaluation benchmark Running the test with following options: Number of threads: 8 Report intermediate results every 10 second ( s ) Random number generator seed is 0 and will be ignored Threads started! -- \u6bcf10\u79d2\u949f\u62a5\u544a\u4e00\u6b21\u6d4b\u8bd5\u7ed3\u679c\uff0ctps\u3001\u6bcf\u79d2\u8bfb\u3001\u6bcf\u79d2\u5199\u300199%\u4ee5\u4e0a\u7684\u54cd\u5e94\u65f6\u957f\u7edf\u8ba1 [ 10s ] threads: 8 , tps: 1111 .51, reads/s: 15568 .42, writes/s: 4446 .13, response time: 9 .95ms ( 99 % ) [ 20s ] threads: 8 , tps: 1121 .90, reads/s: 15709 .62, writes/s: 4487 .80, response time: 9 .78ms ( 99 % ) [ 30s ] threads: 8 , tps: 1120 .00, reads/s: 15679 .10, writes/s: 4480 .20, response time: 9 .84ms ( 99 % ) [ 40s ] threads: 8 , tps: 1114 .20, reads/s: 15599 .39, writes/s: 4456 .30, response time: 9 .90ms ( 99 % ) [ 50s ] threads: 8 , tps: 1114 .00, reads/s: 15593 .60, writes/s: 4456 .70, response time: 9 .84ms ( 99 % ) [ 60s ] threads: 8 , tps: 1119 .30, reads/s: 15671 .60, writes/s: 4476 .50, response time: 9 .99ms ( 99 % ) OLTP test statistics: queries performed: read: 938224 -- \u8bfb\u603b\u6570 write: 268064 -- \u5199\u603b\u6570 other: 134032 -- \u5176\u4ed6\u64cd\u4f5c\u603b\u6570 ( SELECT\u3001INSERT\u3001UPDATE\u3001DELETE\u4e4b\u5916\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982COMMIT\u7b49 ) total: 1340320 -- \u5168\u90e8\u603b\u6570 transactions: 67016 ( 1116 .83 per sec. ) -- \u603b\u4e8b\u52a1\u6570 ( \u6bcf\u79d2\u4e8b\u52a1\u6570 ) deadlocks: 0 ( 0 .00 per sec. ) -- \u53d1\u751f\u6b7b\u9501\u603b\u6570 read/write requests: 1206288 ( 20103 .01 per sec. ) -- \u8bfb\u5199\u603b\u6570 ( \u6bcf\u79d2\u8bfb\u5199\u6b21\u6570 ) other operations: 134032 ( 2233 .67 per sec. ) -- \u5176\u4ed6\u64cd\u4f5c\u603b\u6570 ( \u6bcf\u79d2\u5176\u4ed6\u64cd\u4f5c\u6b21\u6570 ) General statistics: -- \u4e00\u4e9b\u7edf\u8ba1\u7ed3\u679c total time: 60 .0053s -- \u603b\u8017\u65f6 total number of events: 67016 -- \u5171\u53d1\u751f\u591a\u5c11\u4e8b\u52a1\u6570 total time taken by event execution: 479 .8171s -- \u6240\u6709\u4e8b\u52a1\u8017\u65f6\u76f8\u52a0 ( \u4e0d\u8003\u8651\u5e76\u884c\u56e0\u7d20 ) response time: -- \u54cd\u5e94\u65f6\u957f\u7edf\u8ba1 min: 4 .27ms -- \u6700\u5c0f\u8017\u65f6 avg: 7 .16ms -- \u5e73\u5747\u8017\u65f6 max: 13 .80ms -- \u6700\u957f\u8017\u65f6 approx. 99 percentile: 9 .88ms -- \u8d85\u8fc799%\u5e73\u5747\u8017\u65f6 Threads fairness: events ( avg/stddev ) : 8377 .0000/44.33 execution time ( avg/stddev ) : 59 .9771/0.00 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://imysql.com/2014/10/17/sysbench-full-user-manual.shtml 2\u3001 http://imysql.com/2015/07/28/mysql-benchmark-reference.shtml","title":"\"sysbench\u6d4b\u8bd5mysql\u6027\u80fd\""},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#_1","text":"\u73af\u5883\uff1a centos 6.7 mysql 5.7.10 yum install automake gcc gcc-c++ libtool mysql-devel git clone https://github.com/akopytov/sysbench.git ./autogen.sh ./configure make && make install \u5982\u679c\u60f3\u8981\u8ba9 sysbench \u652f\u6301 pgsql/oracle \u7684\u8bdd\uff0c\u5c31\u9700\u8981\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u52a0\u4e0a\u53c2\u6570 --with-pgsql \u6216\u8005 --with-oracle \u8fd92\u4e2a\u53c2\u6570\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff0c\u53ea\u6709 MySQL \u662f\u9ed8\u8ba4\u652f\u6301\u7684\u3002","title":"\u4e00\u3001\u5b89\u88c5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#_2","text":"","title":"\u4e8c\u3001\u6d4b\u8bd5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#1cpu","text":"sysbench --test = cpu --cpu-max-prime = 20000 run cpu\u6d4b\u8bd5\u4e3b\u8981\u662f\u8fdb\u884c\u7d20\u6570\u7684\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6307\u5b9a\u4e86\u6700\u5927\u7684\u7d20\u6570\u4e3a 20000\uff0c\u81ea\u5df1\u53ef\u4ee5\u6839\u636e\u673a\u5668cpu\u7684\u6027\u80fd\u6765\u9002\u5f53\u8c03\u6574\u6570\u503c\u3002","title":"1\u3001cpu\u6027\u80fd\u6d4b\u8bd5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#2","text":"sysbench --test = threads --num-threads = 64 --thread-yields = 100 --thread-locks = 2 run","title":"2\u3001\u7ebf\u7a0b\u6d4b\u8bd5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#3io","text":"sysbench --test = fileio --num-threads = 16 --file-total-size = 3G --file-test-mode = rndrw prepare sysbench --test = fileio --num-threads = 16 --file-total-size = 3G --file-test-mode = rndrw run sysbench --test = fileio --num-threads = 16 --file-total-size = 3G --file-test-mode = rndrw cleanup \u4e0a\u8ff0\u53c2\u6570\u6307\u5b9a\u4e86\u6700\u5927\u521b\u5efa16\u4e2a\u7ebf\u7a0b\uff0c\u521b\u5efa\u7684\u6587\u4ef6\u603b\u5927\u5c0f\u4e3a3G\uff0c\u6587\u4ef6\u8bfb\u5199\u6a21\u5f0f\u4e3a\u968f\u673a\u8bfb\u3002","title":"3\u3001\u78c1\u76d8IO\u6027\u80fd\u6d4b\u8bd5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#4","text":"sysbench --test = memory --memory-block-size = 8k --memory-total-size = 4G run \u4e0a\u8ff0\u53c2\u6570\u6307\u5b9a\u4e86\u672c\u6b21\u6d4b\u8bd5\u6574\u4e2a\u8fc7\u7a0b\u662f\u5728\u5185\u5b58\u4e2d\u4f20\u8f93 4G \u7684\u6570\u636e\u91cf\uff0c\u6bcf\u4e2a block \u5927\u5c0f\u4e3a 8K\u3002","title":"4\u3001\u5185\u5b58\u6d4b\u8bd5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#5oltp","text":"sysbench --mysql-host = 127 .0.0.1 --mysql-port = 3306 --mysql-user = root --mysql-password = root --test = /root/sysbench/sysbench/tests/db/oltp.lua --oltp_tables_count = 10 --oltp-table-size = 100000 --rand-init = on prepare \u5173\u4e8e\u8fd9\u51e0\u4e2a\u53c2\u6570\u7684\u89e3\u91ca\uff1a --test=tests/db/oltp.lua \u8868\u793a\u8c03\u7528 tests/db/oltp.lua \u811a\u672c\u8fdb\u884c oltp \u6a21\u5f0f\u6d4b\u8bd5 --oltp_tables_count=10 \u8868\u793a\u4f1a\u751f\u6210 10 \u4e2a\u6d4b\u8bd5\u8868 --oltp-table-size=100000 \u8868\u793a\u6bcf\u4e2a\u6d4b\u8bd5\u8868\u586b\u5145\u6570\u636e\u91cf\u4e3a 100000 --rand-init=on \u8868\u793a\u6bcf\u4e2a\u6d4b\u8bd5\u8868\u90fd\u662f\u7528\u968f\u673a\u6570\u636e\u6765\u586b\u5145\u7684 \u5982\u679c\u5728\u672c\u673a\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 \u2013mysql-socket \u6307\u5b9a socket \u6587\u4ef6\u6765\u8fde\u63a5\u3002\u52a0\u8f7d\u6d4b\u8bd5\u6570\u636e\u65f6\u957f\u89c6\u6570\u636e\u91cf\u800c\u5b9a\uff0c\u82e5\u8fc7\u7a0b\u6bd4\u8f83\u4e45\u9700\u8981\u7a0d\u52a0\u8010\u5fc3\u7b49\u5f85\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u6570\u636e\u8868\u5efa\u8bae\u4e0d\u4f4e\u4e8e10\u4e2a\uff0c\u5355\u8868\u6570\u636e\u91cf\u4e0d\u4f4e\u4e8e500\u4e07\u884c\uff0c\u5f53\u7136\u4e86\uff0c\u8981\u89c6\u670d\u52a1\u5668\u786c\u4ef6\u914d\u7f6e\u800c\u5b9a\u3002\u5982\u679c\u662f\u914d\u5907\u4e86SSD\u6216\u8005PCIE SSD\u8fd9\u79cd\u9ad8IOPS\u8bbe\u5907\u7684\u8bdd\uff0c\u5219\u5efa\u8bae\u5355\u8868\u6570\u636e\u91cf\u6700\u5c11\u4e0d\u4f4e\u4e8e1\u4ebf\u884c\u3002 sysbench --mysql-host = 127 .0.0.1 --mysql-port = 3306 --mysql-user = root \\ --mysql-password = root --test = /root/sysbench/sysbench/tests/db/oltp.lua --oltp_tables_count = 10 \\ --oltp-table-size = 10000000 --num-threads = 8 --oltp-read-only = off \\ --report-interval = 10 --rand-type = uniform --max-time = 3600 \\ --max-requests = 0 --percentile = 99 run >> /tmp/sysbench_oltpX_8.log \u53c2\u6570\u89e3\u91ca\uff1a --num-threads=8 \u8868\u793a\u53d1\u8d77 8\u4e2a\u5e76\u53d1\u8fde\u63a5 --oltp-read-only=off \u8868\u793a\u4e0d\u8981\u8fdb\u884c\u53ea\u8bfb\u6d4b\u8bd5\uff0c\u4e5f\u5c31\u662f\u4f1a\u91c7\u7528\u8bfb\u5199\u6df7\u5408\u6a21\u5f0f\u6d4b\u8bd5 --report-interval=10 \u8868\u793a\u6bcf10\u79d2\u8f93\u51fa\u4e00\u6b21\u6d4b\u8bd5\u8fdb\u5ea6\u62a5\u544a --rand-type=uniform \u8868\u793a\u968f\u673a\u7c7b\u578b\u4e3a\u56fa\u5b9a\u6a21\u5f0f\uff0c\u5176\u4ed6\u51e0\u4e2a\u53ef\u9009\u968f\u673a\u6a21\u5f0f\uff1auniform(\u56fa\u5b9a),gaussian(\u9ad8\u65af),special(\u7279\u5b9a\u7684),pareto(\u5e15\u7d2f\u6258) --max-time=120 \u8868\u793a\u6700\u5927\u6267\u884c\u65f6\u957f\u4e3a 120\u79d2 --max-requests=0 \u8868\u793a\u603b\u8bf7\u6c42\u6570\u4e3a 0\uff0c\u56e0\u4e3a\u4e0a\u9762\u5df2\u7ecf\u5b9a\u4e49\u4e86\u603b\u6267\u884c\u65f6\u957f\uff0c\u6240\u4ee5\u603b\u8bf7\u6c42\u6570\u53ef\u4ee5\u8bbe\u5b9a\u4e3a 0\uff1b\u4e5f\u53ef\u4ee5\u53ea\u8bbe\u5b9a\u603b\u8bf7\u6c42\u6570\uff0c\u4e0d\u8bbe\u5b9a\u6700\u5927\u6267\u884c\u65f6\u957f --percentile=99 \u8868\u793a\u8bbe\u5b9a\u91c7\u6837\u6bd4\u4f8b\uff0c\u9ed8\u8ba4\u662f 95%\uff0c\u5373\u4e22\u5f031%\u7684\u957f\u8bf7\u6c42\uff0c\u5728\u5269\u4f59\u768499%\u91cc\u53d6\u6700\u5927\u503c \u5373\uff1a\u6a21\u62df \u5bf910\u4e2a\u8868\u5e76\u53d1OLTP\u6d4b\u8bd5\uff0c\u6bcf\u4e2a\u88681000\u4e07\u884c\u8bb0\u5f55\uff0c\u6301\u7eed\u538b\u6d4b\u65f6\u95f4\u4e3a 1\u5c0f\u65f6\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u5efa\u8bae\u6301\u7eed\u538b\u6d4b\u65f6\u957f\u4e0d\u5c0f\u4e8e30\u5206\u949f\uff0c\u5426\u5219\u6d4b\u8bd5\u6570\u636e\u53ef\u80fd\u4e0d\u5177\u53c2\u8003\u610f\u4e49\u3002","title":"5\u3001OLTP\u6d4b\u8bd5"},{"location":"other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#6","text":"\u6d4b\u8bd5\u7ed3\u679c\u89e3\u8bfb\u5982\u4e0b\uff1a sysbench 0 .5: multi-threaded system evaluation benchmark Running the test with following options: Number of threads: 8 Report intermediate results every 10 second ( s ) Random number generator seed is 0 and will be ignored Threads started! -- \u6bcf10\u79d2\u949f\u62a5\u544a\u4e00\u6b21\u6d4b\u8bd5\u7ed3\u679c\uff0ctps\u3001\u6bcf\u79d2\u8bfb\u3001\u6bcf\u79d2\u5199\u300199%\u4ee5\u4e0a\u7684\u54cd\u5e94\u65f6\u957f\u7edf\u8ba1 [ 10s ] threads: 8 , tps: 1111 .51, reads/s: 15568 .42, writes/s: 4446 .13, response time: 9 .95ms ( 99 % ) [ 20s ] threads: 8 , tps: 1121 .90, reads/s: 15709 .62, writes/s: 4487 .80, response time: 9 .78ms ( 99 % ) [ 30s ] threads: 8 , tps: 1120 .00, reads/s: 15679 .10, writes/s: 4480 .20, response time: 9 .84ms ( 99 % ) [ 40s ] threads: 8 , tps: 1114 .20, reads/s: 15599 .39, writes/s: 4456 .30, response time: 9 .90ms ( 99 % ) [ 50s ] threads: 8 , tps: 1114 .00, reads/s: 15593 .60, writes/s: 4456 .70, response time: 9 .84ms ( 99 % ) [ 60s ] threads: 8 , tps: 1119 .30, reads/s: 15671 .60, writes/s: 4476 .50, response time: 9 .99ms ( 99 % ) OLTP test statistics: queries performed: read: 938224 -- \u8bfb\u603b\u6570 write: 268064 -- \u5199\u603b\u6570 other: 134032 -- \u5176\u4ed6\u64cd\u4f5c\u603b\u6570 ( SELECT\u3001INSERT\u3001UPDATE\u3001DELETE\u4e4b\u5916\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982COMMIT\u7b49 ) total: 1340320 -- \u5168\u90e8\u603b\u6570 transactions: 67016 ( 1116 .83 per sec. ) -- \u603b\u4e8b\u52a1\u6570 ( \u6bcf\u79d2\u4e8b\u52a1\u6570 ) deadlocks: 0 ( 0 .00 per sec. ) -- \u53d1\u751f\u6b7b\u9501\u603b\u6570 read/write requests: 1206288 ( 20103 .01 per sec. ) -- \u8bfb\u5199\u603b\u6570 ( \u6bcf\u79d2\u8bfb\u5199\u6b21\u6570 ) other operations: 134032 ( 2233 .67 per sec. ) -- \u5176\u4ed6\u64cd\u4f5c\u603b\u6570 ( \u6bcf\u79d2\u5176\u4ed6\u64cd\u4f5c\u6b21\u6570 ) General statistics: -- \u4e00\u4e9b\u7edf\u8ba1\u7ed3\u679c total time: 60 .0053s -- \u603b\u8017\u65f6 total number of events: 67016 -- \u5171\u53d1\u751f\u591a\u5c11\u4e8b\u52a1\u6570 total time taken by event execution: 479 .8171s -- \u6240\u6709\u4e8b\u52a1\u8017\u65f6\u76f8\u52a0 ( \u4e0d\u8003\u8651\u5e76\u884c\u56e0\u7d20 ) response time: -- \u54cd\u5e94\u65f6\u957f\u7edf\u8ba1 min: 4 .27ms -- \u6700\u5c0f\u8017\u65f6 avg: 7 .16ms -- \u5e73\u5747\u8017\u65f6 max: 13 .80ms -- \u6700\u957f\u8017\u65f6 approx. 99 percentile: 9 .88ms -- \u8d85\u8fc799%\u5e73\u5747\u8017\u65f6 Threads fairness: events ( avg/stddev ) : 8377 .0000/44.33 execution time ( avg/stddev ) : 59 .9771/0.00 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://imysql.com/2014/10/17/sysbench-full-user-manual.shtml 2\u3001 http://imysql.com/2015/07/28/mysql-benchmark-reference.shtml","title":"6\u3001\u6d4b\u8bd5\u7ed3\u679c\u89e3\u8bfb"},{"location":"other/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/","tags":"[sysbench]","text":"TPC-C\u662f\u4e13\u95e8\u9488\u5bf9\u8054\u673a\u4ea4\u6613\u5904\u7406\u7cfb\u7edf\uff08OLTP\u7cfb\u7edf\uff09\u7684\u89c4\u8303\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u6211\u4eec\u4e5f\u628a\u8fd9\u7c7b\u7cfb\u7edf\u79f0\u4e3a\u4e1a\u52a1\u5904\u7406\u7cfb\u7edf\u3002 tpcc-mysql\u662fpercona\u57fa\u4e8eTPC-C(\u4e0b\u9762\u7b80\u5199\u6210TPCC)\u884d\u751f\u51fa\u6765\u7684\u4ea7\u54c1\uff0c\u4e13\u7528\u4e8eMySQL\u57fa\u51c6\u6d4b\u8bd5\u3002\u5176\u6e90\u7801\u653e\u5728launchpad\u4e0a\uff0c\u7528bazaar\u7ba1\u7406\uff0c\u9879\u76ee\u5730\u5740\uff1a https://code.launchpad.net/~percona-dev/perconatools/tpcc-mysql \u3002 \u4e5f\u53ef\u4ee5\u7528\u53f6\u91d1\u8363\u7684\u7248\u672c\uff0c https://github.com/yejr/tpcc-mysql-autoinc-pk \u3002 tpcc-mysql\u7684\u4e1a\u52a1\u903b\u8f91\u53ca\u5176\u76f8\u5173\u7684\u51e0\u4e2a\u8868\u4f5c\u7528\u5982\u4e0b\uff1a New-Order\uff1a\u65b0\u8ba2\u5355\uff0c\u4e00\u6b21\u5b8c\u6574\u7684\u8ba2\u5355\u4e8b\u52a1\uff0c\u51e0\u4e4e\u6d89\u53ca\u5230\u5168\u90e8\u8868 Payment\uff1a\u652f\u4ed8\uff0c\u4e3b\u8981\u5bf9\u5e94 orders\u3001history \u8868 Order-Status\uff1a\u8ba2\u5355\u72b6\u6001\uff0c\u4e3b\u8981\u5bf9\u5e94 orders\u3001order_line \u8868 Delivery\uff1a\u53d1\u8d27\uff0c\u4e3b\u8981\u5bf9\u5e94 order_line \u8868 Stock-Level\uff1a\u5e93\u5b58\uff0c\u4e3b\u8981\u5bf9\u5e94 stock \u8868 \u5176\u4ed6\u76f8\u5173\u8868\uff1a \u5ba2\u6237\uff1a\u4e3b\u8981\u5bf9\u5e94 customer \u8868 \u5730\u533a\uff1a\u4e3b\u8981\u5bf9\u5e94 district \u8868 \u5546\u54c1\uff1a\u4e3b\u8981\u5bf9\u5e94 item \u8868 \u4ed3\u5e93\uff1a\u4e3b\u8981\u5bf9\u5e94 warehouse \u8868 \u4e00\u3001\u7f16\u8bd1\u5b89\u88c5 \u00b6 \u7f16\u8bd1\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u4e00\u4e2a make \u5373\u53ef\u3002 cd /tmp/tpcc-mysql/src make \u5982\u679c make \u6ca1\u6709\u62a5\u9519\uff0c\u5c31\u4f1a\u5728 /tmp/tpcc-mysql \u4e0b\u751f\u6210 tpcc \u4e8c\u8fdb\u5236\u547d\u4ee4\u884c\u5de5\u5177 tpcc_load\u3001 tpcc_start \u4e8c\u3001TPCC\u6d4b\u8bd5\u524d\u51c6\u5907 \u00b6 \u521d\u59cb\u5316\u6d4b\u8bd5\u5e93\u73af\u5883 cd /tmp/tpcc-mysql mysqladmin create tpcc mysql -uroot -proot tpcc < create_table.sql tpcc_load\u7528\u6cd5\u5982\u4e0b\uff1a tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] OR tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] [ part ] [ min_wh ] [ max_wh ] \u9009\u9879 warehouse \u610f\u4e3a\u6307\u5b9a\u6d4b\u8bd5\u5e93\u4e0b\u7684\u4ed3\u5e93\u6570\u91cf\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u4ed3\u5e93\u6570\u4e00\u822c\u4e0d\u5efa\u8bae\u5c11\u4e8e100\u4e2a\uff0c\u89c6\u670d\u52a1\u5668\u786c\u4ef6\u914d\u7f6e\u800c\u5b9a\uff0c\u5982\u679c\u662f\u914d\u5907\u4e86SSD\u6216\u8005PCIE SSD\u8fd9\u79cd\u9ad8IOPS\u8bbe\u5907\u7684\u8bdd\uff0c\u5efa\u8bae\u6700\u5c11\u4e0d\u4f4e\u4e8e1000\u4e2a\u3002 \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5f00\u59cb\u704c\u5165\u6d4b\u8bd5\u6570\u636e\uff1a cd /tmp/tpcc-mysql ./tpcc_load localhost tpcc tpcc_user \"tpcc_password\" 1000 \u5728\u8fd9\u91cc\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f tpcc \u9ed8\u8ba4\u4f1a\u8bfb\u53d6 /var/lib/mysql/mysql.sock \u8fd9\u4e2asocket \u6587\u4ef6\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u4f60\u7684 socket \u6587\u4ef6\u4e0d\u5728\u76f8\u5e94\u8def\u5f84\u7684\u8bdd\uff0c\u53ef\u4ee5\u505a\u4e2a\u8f6f\u8fde\u63a5\uff0c\u6216\u8005\u901a\u8fc7TCP/IP\u7684\u65b9\u5f0f\u8fde\u63a5\u6d4b\u8bd5\u670d\u52a1\u5668\uff0c\u4f8b\u5982\uff1a cd /tmp/tpcc-mysql ./tpcc_load 1 .2.3.4:3306 tpcc1000 tpcc_user \"tpcc_password\" 1000 \u52a0\u8f7d\u6d4b\u8bd5\u6570\u636e\u65f6\u957f\u89c6\u4ed3\u5e93\u6570\u91cf\u800c\u5b9a\uff0c\u82e5\u8fc7\u7a0b\u6bd4\u8f83\u4e45\u9700\u8981\u7a0d\u52a0\u8010\u5fc3\u7b49\u5f85\u3002 tpcc_load\u5176\u5b9e\u662f\u53ef\u4ee5\u5e76\u884c\u52a0\u8f7d\u7684\uff0c\u4e00\u65b9\u9762\u662f\u53ef\u4ee5\u533a\u5206 ITEMS\u3001WAREHOUSE\u3001CUSTOMER\u3001ORDERS \u56db\u4e2a\u7ef4\u5ea6\u7684\u6570\u636e\u5e76\u884c\u52a0\u8f7d\u3002 \u53e6\u5916\uff0c\u6bd4\u5982\u6700\u7ec8\u60f3\u52a0\u8f7d1000\u4e2a warehouse\u7684\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u5206\u5f00\u62101000\u4e2a\u5e76\u53d1\u5e76\u884c\u52a0\u8f7d\u7684\u3002\u770b\u4e0b tpcc_load \u5de5\u5177\u7684\u53c2\u6570\u5c31\u77e5\u9053\u4e86\uff1a usage: tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] OR tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] [ part ] [ min_wh ] [ max_wh ] [part]: 1=ITEMS 2=WAREHOUSE 3=CUSTOMER 4=ORDERS \u672c\u6765\u60f3\u81ea\u5df1\u5199\u4e2a\u5e76\u884c\u52a0\u8f7d\u811a\u672c\u7684\uff0c\u540e\u6765\u53d1\u73b0\u4e07\u80fd\u7684github\u4e0a\u5df2\u7ecf\u6709\u4eba\u505a\u597d\u4e86\uff0c\u6211\u5c31\u76f4\u63a5\u62ff\u6765\u7528\u4e86\uff0c\u8fd9\u662f\u9879\u76ee\u94fe\u63a5 tpcc_load_parallel.sh \uff0c\u52a0\u8f7d\u6548\u7387\u81f3\u5c11\u63d0\u534710\u500d\u4ee5\u4e0a\u3002 \u4e8c\u3001\u8fdb\u884cTPCC\u6d4b\u8bd5 tpcc_start \u5de5\u5177\u7528\u4e8etpcc\u538b\u6d4b\uff0c\u5176\u7528\u6cd5\u5982\u4e0b\uff1a tpcc_start -h server_host -P port -d database_name -u mysql_user \\ -p mysql_password -w warehouses -c connections -r warmup_time \\ -l running_time -i report_interval -f report_file \u51e0\u4e2a\u9009\u9879\u7a0d\u5fae\u89e3\u91ca\u4e0b\uff1a -w \u6307\u5b9a\u4ed3\u5e93\u6570\u91cf -c \u6307\u5b9a\u5e76\u53d1\u8fde\u63a5\u6570 -r \u6307\u5b9a\u5f00\u59cb\u6d4b\u8bd5\u524d\u8fdb\u884cwarmup\u7684\u65f6\u95f4\uff0c\u8fdb\u884c\u9884\u70ed\u540e\uff0c\u6d4b\u8bd5\u6548\u679c\u66f4\u597d -l \u6307\u5b9a\u6d4b\u8bd5\u6301\u7eed\u65f6\u95f4 -i \u6307\u5b9a\u751f\u6210\u62a5\u544a\u95f4\u9694\u65f6\u957f -f \u6307\u5b9a\u751f\u6210\u7684\u62a5\u544a\u6587\u4ef6\u540d \u73b0\u5728\u6211\u4eec\u6765\u5f00\u542f\u4e00\u4e2a\u6d4b\u8bd5\u6848\u4f8b\uff1a tpcc_start -hlocalhost -d tpcc1000 -u tpcc_user -p \"tpcc_password\" \\ -w 1000 -c 32 -r 120 -l 3600 \\ -f tpcc_mysql_20140921.log >> tpcc_caseX_20140921.log 2 > & 1 \u5373\uff1a\u6a21\u62df 1000\u4e2a\u4ed3\u5e93\u89c4\u6a21\uff0c\u5e76\u53d1 16\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u6d4b\u8bd5\uff0c\u70ed\u8eab\u65f6\u95f4\u4e3a 60\u79d2, \u538b\u6d4b\u65f6\u95f4\u4e3a 1\u5c0f\u65f6\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u5efa\u8bae\u9884\u70ed\u65f6\u95f4\u4e0d\u5c0f\u4e8e5\u5206\u949f\uff0c\u6301\u7eed\u538b\u6d4b\u65f6\u957f\u4e0d\u5c0f\u4e8e30\u5206\u949f\uff0c\u5426\u5219\u6d4b\u8bd5\u6570\u636e\u53ef\u80fd\u4e0d\u5177\u53c2\u8003\u610f\u4e49\u3002 \u4e09\u3001TPCC\u6d4b\u8bd5\u7ed3\u679c\u89e3\u8bfb\uff1a \u00b6 \u53d1\u8d77\u6d4b\u8bd5 ./tpcc_start -h 1 .2.3.4 -P 3306 -d tpcc10 -u tpcc -p tpcc \\ -w 10 -c 64 -r 30 -l 120 \\ -f tpcclog_201409211538_64_THREADS.log >> tpcc_noaid_2_20140921_64.log 2 > & 1 \u6d4b\u8bd5\u7ed3\u679c\u8f93\u51fa\u5982\u4e0b\uff1a -- \u672c\u8f6etpcc\u538b\u6d4b\u7684\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f *************************************** *** ###easy### TPC-C Load Generator *** *************************************** option h with value '1.2.3.4' -- \u4e3b\u673a option P with value '3306' -- \u7aef\u53e3 option d with value 'tpcc10' -- \u6570\u636e\u5e93 option u with value 'tpcc' -- \u8d26\u53f7 option p with value 'tpcc' -- \u5bc6\u7801 option w with value '10' -- \u4ed3\u5e93\u6570 option c with value '64' -- \u5e76\u53d1\u7ebf\u7a0b\u6570 option r with value '30' -- \u6570\u636e\u9884\u70ed\u65f6\u957f option l with value '120' -- \u538b\u6d4b\u65f6\u957f option f with value 'tpcclog_20140921_64_THREADS.res' -- \u8f93\u51fa\u62a5\u544a\u65e5\u5fd7\u6587\u4ef6 [ server ] : 1 .2.3.4 [ port ] : 3306 [ DBname ] : tpcc10 [ user ] : tpcc [ pass ] : tpcc [ warehouse ] : 10 [ connection ] : 64 [ rampup ] : 30 ( sec. ) [ measure ] : 120 ( sec. ) RAMP-UP TIME. ( 30 sec. ) -- \u9884\u70ed\u7ed3\u675f\uff0c\u5f00\u59cb\u8fdb\u884c\u538b\u6d4b MEASURING START. -- \u6bcf10\u79d2\u949f\u8f93\u51fa\u4e00\u6b21\u538b\u6d4b\u6570\u636e 10 , 8376 ( 0 ) :2.744 | 3 .211, 8374 ( 0 ) :0.523 | 1 .626, 838 ( 0 ) :0.250 | 0 .305, 837 ( 0 ) :3.241 | 3 .518, 839 ( 0 ) :9.086 | 10 .676 20 , 8294 ( 0 ) :2.175 | 2 .327, 8292 ( 0 ) :0.420 | 0 .495, 829 ( 0 ) :0.206 | 0 .243, 827 ( 0 ) :2.489 | 2 .593, 827 ( 0 ) :7.214 | 7 .646 \u2026 110 , 8800 ( 0 ) :2.149 | 2 .458, 8792 ( 0 ) :0.424 | 0 .710, 879 ( 0 ) :0.207 | 0 .244, 878 ( 0 ) :2.461 | 2 .556, 878 ( 0 ) :7.042 | 7 .341 120 , 8819 ( 0 ) :2.147 | 2 .327, 8820 ( 0 ) :0.424 | 0 .568, 882 ( 0 ) :0.208 | 0 .237, 881 ( 0 ) :2.483 | 2 .561, 883 ( 0 ) :7.025 | 7 .405 -- \u4ee5\u9017\u53f7\u5206\u9694\uff0c\u51716\u5217 -- \u7b2c\u4e00\u5217\uff0c\u7b2cN\u6b2110\u79d2 -- \u7b2c\u4e8c\u5217\uff0c\u65b0\u8ba2\u5355\u6210\u529f\u6267\u884c\u538b\u6d4b\u7684\u6b21\u6570 ( \u63a8\u8fdf\u6267\u884c\u538b\u6d4b\u7684\u6b21\u6570 ) :90%\u4e8b\u52a1\u7684\u54cd\u5e94\u65f6\u95f4 | \u672c\u8f6e\u6d4b\u8bd5\u6700\u5927\u54cd\u5e94\u65f6\u95f4\uff0c\u65b0\u8ba2\u5355\u4e8b\u52a1\u6570\u4e5f\u88ab\u8ba4\u4e3a\u662f\u603b\u6709\u6548\u4e8b\u52a1\u6570\u7684\u6307\u6807 -- \u7b2c\u4e09\u5217\uff0c\u652f\u4ed8\u4e1a\u52a1\u6210\u529f\u6267\u884c\u6b21\u6570 ( \u63a8\u8fdf\u6267\u884c\u6b21\u6570 ) :90%\u4e8b\u52a1\u7684\u54cd\u5e94\u65f6\u95f4 | \u672c\u8f6e\u6d4b\u8bd5\u6700\u5927\u54cd\u5e94\u65f6\u95f4 -- \u7b2c\u56db\u5217\uff0c\u8ba2\u5355\u72b6\u6001\u4e1a\u52a1\u7684\u7ed3\u679c\uff0c\u540e\u9762\u51e0\u4e2a\u7684\u610f\u4e49\u540c\u4e0a -- \u7b2c\u4e94\u5217\uff0c\u7269\u6d41\u53d1\u8d27\u4e1a\u52a1\u7684\u7ed3\u679c\uff0c\u540e\u9762\u51e0\u4e2a\u7684\u610f\u4e49\u540c\u4e0a -- \u7b2c\u516d\u5217\uff0c\u5e93\u5b58\u4ed3\u50a8\u4e1a\u52a1\u7684\u7ed3\u679c\uff0c\u540e\u9762\u51e0\u4e2a\u7684\u610f\u4e49\u540c\u4e0a -- \u538b\u6d4b\u7ed3\u675f STOPPING THREADS................................................................ -- \u7b2c\u4e00\u6b21\u7ed3\u679c\u7edf\u8ba1 [ 0 ] sc:100589 lt:0 rt:0 fl:0 -- New-Order\uff0c\u65b0\u8ba2\u5355\u4e1a\u52a1\u6210\u529f ( success,\u7b80\u5199sc ) \u6b21\u6570\uff0c\u5ef6\u8fdf ( late,\u7b80\u5199lt ) \u6b21\u6570\uff0c\u91cd\u8bd5 ( retry,\u7b80\u5199rt ) \u6b21\u6570\uff0c\u5931\u8d25 ( failure,\u7b80\u5199fl ) \u6b21\u6570 [ 1 ] sc:100552 lt:0 rt:0 fl:0 -- Payment\uff0c\u652f\u4ed8\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a [ 2 ] sc:10059 lt:0 rt:0 fl:0 -- Order-Status\uff0c\u8ba2\u5355\u72b6\u6001\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a [ 3 ] sc:10057 lt:0 rt:0 fl:0 -- Delivery\uff0c\u53d1\u8d27\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a [ 4 ] sc:10058 lt:0 rt:0 fl:0 -- Stock-Level\uff0c\u5e93\u5b58\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a in 120 sec. -- \u7b2c\u4e8c\u6b21\u7edf\u8ba1\u7ed3\u679c\uff0c\u5176\u4ed6\u540c\u4e0a [ 0 ] sc:100590 lt:0 rt:0 fl:0 [ 1 ] sc:100582 lt:0 rt:0 fl:0 [ 2 ] sc:10059 lt:0 rt:0 fl:0 [ 3 ] sc:10057 lt:0 rt:0 fl:0 [ 4 ] sc:10059 lt:0 rt:0 fl:0 ( all must be [ OK ]) -- \u4e0b\u9762\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u7ed3\u679c\u90fd\u5fc5\u987b\u4e3a OK \u624d\u884c [ transaction percentage ] Payment: 43 .47% ( > = 43 .0% ) [ OK ] -- \u652f\u4ed8\u6210\u529f\u6b21\u6570 ( \u4e0a\u8ff0\u7edf\u8ba1\u7ed3\u679c\u4e2d sc + lt ) \u5fc5\u987b\u5927\u4e8e43.0%\uff0c\u5426\u5219\u7ed3\u679c\u4e3aNG\uff0c\u800c\u4e0d\u662fOK Order-Status: 4 .35% ( > = 4 .0% ) [ OK ] -- \u8ba2\u5355\u72b6\u6001\uff0c\u5176\u4ed6\u540c\u4e0a Delivery: 4 .35% ( > = 4 .0% ) [ OK ] -- \u53d1\u8d27\uff0c\u5176\u4ed6\u540c\u4e0a Stock-Level: 4 .35% ( > = 4 .0% ) [ OK ] -- \u5e93\u5b58\uff0c\u5176\u4ed6\u540c\u4e0a [ response time ( at least 90 % passed )] -- \u54cd\u5e94\u8017\u65f6\u6307\u6807\u5fc5\u987b\u8d85\u8fc790%\u901a\u8fc7\u624d\u884c New-Order: 100 .00% [ OK ] -- \u4e0b\u9762\u51e0\u4e2a\u54cd\u5e94\u8017\u65f6\u6307\u6807\u5168\u90e8 100 % \u901a\u8fc7 Payment: 100 .00% [ OK ] Order-Status: 100 .00% [ OK ] Delivery: 100 .00% [ OK ] Stock-Level: 100 .00% [ OK ] 50294 .500 TpmC -- TpmC\u7ed3\u679c\u503c\uff08\u6bcf\u5206\u949f\u4e8b\u52a1\u6570\uff0c\u8be5\u503c\u662f\u7b2c\u4e00\u6b21\u7edf\u8ba1\u7ed3\u679c\u4e2d\u7684\u65b0\u8ba2\u5355\u4e8b\u52a1\u6570\u9664\u4ee5\u603b\u8017\u65f6\u5206\u949f\u6570\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u662f\uff1a100589/2 = 50294 .500\uff09 script\u76ee\u5f55\u4e0b\u7684\u4e00\u4e9b\u811a\u672c\u4e3b\u8981\u662f\u4e00\u4e9b\u6027\u80fd\u6570\u636e\u91c7\u96c6\u4ee5\u53ca\u5206\u6790\u7684\uff0c\u53ef\u4ee5\u81ea\u884c\u6478\u7d22\u4e0b\u600e\u4e48\u7528\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://imysql.com/2014/10/10/tpcc-mysql-full-user-manual.shtml 2\u3001 https://github.com/yejr/tpcc-mysql-autoinc-pk","title":"\"tpcc\u6d4b\u8bd5mysql\u6027\u80fd\""},{"location":"other/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#_1","text":"\u7f16\u8bd1\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u4e00\u4e2a make \u5373\u53ef\u3002 cd /tmp/tpcc-mysql/src make \u5982\u679c make \u6ca1\u6709\u62a5\u9519\uff0c\u5c31\u4f1a\u5728 /tmp/tpcc-mysql \u4e0b\u751f\u6210 tpcc \u4e8c\u8fdb\u5236\u547d\u4ee4\u884c\u5de5\u5177 tpcc_load\u3001 tpcc_start","title":"\u4e00\u3001\u7f16\u8bd1\u5b89\u88c5"},{"location":"other/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#tpcc","text":"\u521d\u59cb\u5316\u6d4b\u8bd5\u5e93\u73af\u5883 cd /tmp/tpcc-mysql mysqladmin create tpcc mysql -uroot -proot tpcc < create_table.sql tpcc_load\u7528\u6cd5\u5982\u4e0b\uff1a tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] OR tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] [ part ] [ min_wh ] [ max_wh ] \u9009\u9879 warehouse \u610f\u4e3a\u6307\u5b9a\u6d4b\u8bd5\u5e93\u4e0b\u7684\u4ed3\u5e93\u6570\u91cf\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u4ed3\u5e93\u6570\u4e00\u822c\u4e0d\u5efa\u8bae\u5c11\u4e8e100\u4e2a\uff0c\u89c6\u670d\u52a1\u5668\u786c\u4ef6\u914d\u7f6e\u800c\u5b9a\uff0c\u5982\u679c\u662f\u914d\u5907\u4e86SSD\u6216\u8005PCIE SSD\u8fd9\u79cd\u9ad8IOPS\u8bbe\u5907\u7684\u8bdd\uff0c\u5efa\u8bae\u6700\u5c11\u4e0d\u4f4e\u4e8e1000\u4e2a\u3002 \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5f00\u59cb\u704c\u5165\u6d4b\u8bd5\u6570\u636e\uff1a cd /tmp/tpcc-mysql ./tpcc_load localhost tpcc tpcc_user \"tpcc_password\" 1000 \u5728\u8fd9\u91cc\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f tpcc \u9ed8\u8ba4\u4f1a\u8bfb\u53d6 /var/lib/mysql/mysql.sock \u8fd9\u4e2asocket \u6587\u4ef6\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u4f60\u7684 socket \u6587\u4ef6\u4e0d\u5728\u76f8\u5e94\u8def\u5f84\u7684\u8bdd\uff0c\u53ef\u4ee5\u505a\u4e2a\u8f6f\u8fde\u63a5\uff0c\u6216\u8005\u901a\u8fc7TCP/IP\u7684\u65b9\u5f0f\u8fde\u63a5\u6d4b\u8bd5\u670d\u52a1\u5668\uff0c\u4f8b\u5982\uff1a cd /tmp/tpcc-mysql ./tpcc_load 1 .2.3.4:3306 tpcc1000 tpcc_user \"tpcc_password\" 1000 \u52a0\u8f7d\u6d4b\u8bd5\u6570\u636e\u65f6\u957f\u89c6\u4ed3\u5e93\u6570\u91cf\u800c\u5b9a\uff0c\u82e5\u8fc7\u7a0b\u6bd4\u8f83\u4e45\u9700\u8981\u7a0d\u52a0\u8010\u5fc3\u7b49\u5f85\u3002 tpcc_load\u5176\u5b9e\u662f\u53ef\u4ee5\u5e76\u884c\u52a0\u8f7d\u7684\uff0c\u4e00\u65b9\u9762\u662f\u53ef\u4ee5\u533a\u5206 ITEMS\u3001WAREHOUSE\u3001CUSTOMER\u3001ORDERS \u56db\u4e2a\u7ef4\u5ea6\u7684\u6570\u636e\u5e76\u884c\u52a0\u8f7d\u3002 \u53e6\u5916\uff0c\u6bd4\u5982\u6700\u7ec8\u60f3\u52a0\u8f7d1000\u4e2a warehouse\u7684\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u5206\u5f00\u62101000\u4e2a\u5e76\u53d1\u5e76\u884c\u52a0\u8f7d\u7684\u3002\u770b\u4e0b tpcc_load \u5de5\u5177\u7684\u53c2\u6570\u5c31\u77e5\u9053\u4e86\uff1a usage: tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] OR tpcc_load [ server ] [ DB ] [ user ] [ pass ] [ warehouse ] [ part ] [ min_wh ] [ max_wh ] [part]: 1=ITEMS 2=WAREHOUSE 3=CUSTOMER 4=ORDERS \u672c\u6765\u60f3\u81ea\u5df1\u5199\u4e2a\u5e76\u884c\u52a0\u8f7d\u811a\u672c\u7684\uff0c\u540e\u6765\u53d1\u73b0\u4e07\u80fd\u7684github\u4e0a\u5df2\u7ecf\u6709\u4eba\u505a\u597d\u4e86\uff0c\u6211\u5c31\u76f4\u63a5\u62ff\u6765\u7528\u4e86\uff0c\u8fd9\u662f\u9879\u76ee\u94fe\u63a5 tpcc_load_parallel.sh \uff0c\u52a0\u8f7d\u6548\u7387\u81f3\u5c11\u63d0\u534710\u500d\u4ee5\u4e0a\u3002 \u4e8c\u3001\u8fdb\u884cTPCC\u6d4b\u8bd5 tpcc_start \u5de5\u5177\u7528\u4e8etpcc\u538b\u6d4b\uff0c\u5176\u7528\u6cd5\u5982\u4e0b\uff1a tpcc_start -h server_host -P port -d database_name -u mysql_user \\ -p mysql_password -w warehouses -c connections -r warmup_time \\ -l running_time -i report_interval -f report_file \u51e0\u4e2a\u9009\u9879\u7a0d\u5fae\u89e3\u91ca\u4e0b\uff1a -w \u6307\u5b9a\u4ed3\u5e93\u6570\u91cf -c \u6307\u5b9a\u5e76\u53d1\u8fde\u63a5\u6570 -r \u6307\u5b9a\u5f00\u59cb\u6d4b\u8bd5\u524d\u8fdb\u884cwarmup\u7684\u65f6\u95f4\uff0c\u8fdb\u884c\u9884\u70ed\u540e\uff0c\u6d4b\u8bd5\u6548\u679c\u66f4\u597d -l \u6307\u5b9a\u6d4b\u8bd5\u6301\u7eed\u65f6\u95f4 -i \u6307\u5b9a\u751f\u6210\u62a5\u544a\u95f4\u9694\u65f6\u957f -f \u6307\u5b9a\u751f\u6210\u7684\u62a5\u544a\u6587\u4ef6\u540d \u73b0\u5728\u6211\u4eec\u6765\u5f00\u542f\u4e00\u4e2a\u6d4b\u8bd5\u6848\u4f8b\uff1a tpcc_start -hlocalhost -d tpcc1000 -u tpcc_user -p \"tpcc_password\" \\ -w 1000 -c 32 -r 120 -l 3600 \\ -f tpcc_mysql_20140921.log >> tpcc_caseX_20140921.log 2 > & 1 \u5373\uff1a\u6a21\u62df 1000\u4e2a\u4ed3\u5e93\u89c4\u6a21\uff0c\u5e76\u53d1 16\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u6d4b\u8bd5\uff0c\u70ed\u8eab\u65f6\u95f4\u4e3a 60\u79d2, \u538b\u6d4b\u65f6\u95f4\u4e3a 1\u5c0f\u65f6\u3002 \u771f\u5b9e\u6d4b\u8bd5\u573a\u666f\u4e2d\uff0c\u5efa\u8bae\u9884\u70ed\u65f6\u95f4\u4e0d\u5c0f\u4e8e5\u5206\u949f\uff0c\u6301\u7eed\u538b\u6d4b\u65f6\u957f\u4e0d\u5c0f\u4e8e30\u5206\u949f\uff0c\u5426\u5219\u6d4b\u8bd5\u6570\u636e\u53ef\u80fd\u4e0d\u5177\u53c2\u8003\u610f\u4e49\u3002","title":"\u4e8c\u3001TPCC\u6d4b\u8bd5\u524d\u51c6\u5907"},{"location":"other/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#tpcc_1","text":"\u53d1\u8d77\u6d4b\u8bd5 ./tpcc_start -h 1 .2.3.4 -P 3306 -d tpcc10 -u tpcc -p tpcc \\ -w 10 -c 64 -r 30 -l 120 \\ -f tpcclog_201409211538_64_THREADS.log >> tpcc_noaid_2_20140921_64.log 2 > & 1 \u6d4b\u8bd5\u7ed3\u679c\u8f93\u51fa\u5982\u4e0b\uff1a -- \u672c\u8f6etpcc\u538b\u6d4b\u7684\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f *************************************** *** ###easy### TPC-C Load Generator *** *************************************** option h with value '1.2.3.4' -- \u4e3b\u673a option P with value '3306' -- \u7aef\u53e3 option d with value 'tpcc10' -- \u6570\u636e\u5e93 option u with value 'tpcc' -- \u8d26\u53f7 option p with value 'tpcc' -- \u5bc6\u7801 option w with value '10' -- \u4ed3\u5e93\u6570 option c with value '64' -- \u5e76\u53d1\u7ebf\u7a0b\u6570 option r with value '30' -- \u6570\u636e\u9884\u70ed\u65f6\u957f option l with value '120' -- \u538b\u6d4b\u65f6\u957f option f with value 'tpcclog_20140921_64_THREADS.res' -- \u8f93\u51fa\u62a5\u544a\u65e5\u5fd7\u6587\u4ef6 [ server ] : 1 .2.3.4 [ port ] : 3306 [ DBname ] : tpcc10 [ user ] : tpcc [ pass ] : tpcc [ warehouse ] : 10 [ connection ] : 64 [ rampup ] : 30 ( sec. ) [ measure ] : 120 ( sec. ) RAMP-UP TIME. ( 30 sec. ) -- \u9884\u70ed\u7ed3\u675f\uff0c\u5f00\u59cb\u8fdb\u884c\u538b\u6d4b MEASURING START. -- \u6bcf10\u79d2\u949f\u8f93\u51fa\u4e00\u6b21\u538b\u6d4b\u6570\u636e 10 , 8376 ( 0 ) :2.744 | 3 .211, 8374 ( 0 ) :0.523 | 1 .626, 838 ( 0 ) :0.250 | 0 .305, 837 ( 0 ) :3.241 | 3 .518, 839 ( 0 ) :9.086 | 10 .676 20 , 8294 ( 0 ) :2.175 | 2 .327, 8292 ( 0 ) :0.420 | 0 .495, 829 ( 0 ) :0.206 | 0 .243, 827 ( 0 ) :2.489 | 2 .593, 827 ( 0 ) :7.214 | 7 .646 \u2026 110 , 8800 ( 0 ) :2.149 | 2 .458, 8792 ( 0 ) :0.424 | 0 .710, 879 ( 0 ) :0.207 | 0 .244, 878 ( 0 ) :2.461 | 2 .556, 878 ( 0 ) :7.042 | 7 .341 120 , 8819 ( 0 ) :2.147 | 2 .327, 8820 ( 0 ) :0.424 | 0 .568, 882 ( 0 ) :0.208 | 0 .237, 881 ( 0 ) :2.483 | 2 .561, 883 ( 0 ) :7.025 | 7 .405 -- \u4ee5\u9017\u53f7\u5206\u9694\uff0c\u51716\u5217 -- \u7b2c\u4e00\u5217\uff0c\u7b2cN\u6b2110\u79d2 -- \u7b2c\u4e8c\u5217\uff0c\u65b0\u8ba2\u5355\u6210\u529f\u6267\u884c\u538b\u6d4b\u7684\u6b21\u6570 ( \u63a8\u8fdf\u6267\u884c\u538b\u6d4b\u7684\u6b21\u6570 ) :90%\u4e8b\u52a1\u7684\u54cd\u5e94\u65f6\u95f4 | \u672c\u8f6e\u6d4b\u8bd5\u6700\u5927\u54cd\u5e94\u65f6\u95f4\uff0c\u65b0\u8ba2\u5355\u4e8b\u52a1\u6570\u4e5f\u88ab\u8ba4\u4e3a\u662f\u603b\u6709\u6548\u4e8b\u52a1\u6570\u7684\u6307\u6807 -- \u7b2c\u4e09\u5217\uff0c\u652f\u4ed8\u4e1a\u52a1\u6210\u529f\u6267\u884c\u6b21\u6570 ( \u63a8\u8fdf\u6267\u884c\u6b21\u6570 ) :90%\u4e8b\u52a1\u7684\u54cd\u5e94\u65f6\u95f4 | \u672c\u8f6e\u6d4b\u8bd5\u6700\u5927\u54cd\u5e94\u65f6\u95f4 -- \u7b2c\u56db\u5217\uff0c\u8ba2\u5355\u72b6\u6001\u4e1a\u52a1\u7684\u7ed3\u679c\uff0c\u540e\u9762\u51e0\u4e2a\u7684\u610f\u4e49\u540c\u4e0a -- \u7b2c\u4e94\u5217\uff0c\u7269\u6d41\u53d1\u8d27\u4e1a\u52a1\u7684\u7ed3\u679c\uff0c\u540e\u9762\u51e0\u4e2a\u7684\u610f\u4e49\u540c\u4e0a -- \u7b2c\u516d\u5217\uff0c\u5e93\u5b58\u4ed3\u50a8\u4e1a\u52a1\u7684\u7ed3\u679c\uff0c\u540e\u9762\u51e0\u4e2a\u7684\u610f\u4e49\u540c\u4e0a -- \u538b\u6d4b\u7ed3\u675f STOPPING THREADS................................................................ -- \u7b2c\u4e00\u6b21\u7ed3\u679c\u7edf\u8ba1 [ 0 ] sc:100589 lt:0 rt:0 fl:0 -- New-Order\uff0c\u65b0\u8ba2\u5355\u4e1a\u52a1\u6210\u529f ( success,\u7b80\u5199sc ) \u6b21\u6570\uff0c\u5ef6\u8fdf ( late,\u7b80\u5199lt ) \u6b21\u6570\uff0c\u91cd\u8bd5 ( retry,\u7b80\u5199rt ) \u6b21\u6570\uff0c\u5931\u8d25 ( failure,\u7b80\u5199fl ) \u6b21\u6570 [ 1 ] sc:100552 lt:0 rt:0 fl:0 -- Payment\uff0c\u652f\u4ed8\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a [ 2 ] sc:10059 lt:0 rt:0 fl:0 -- Order-Status\uff0c\u8ba2\u5355\u72b6\u6001\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a [ 3 ] sc:10057 lt:0 rt:0 fl:0 -- Delivery\uff0c\u53d1\u8d27\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a [ 4 ] sc:10058 lt:0 rt:0 fl:0 -- Stock-Level\uff0c\u5e93\u5b58\u4e1a\u52a1\u7edf\u8ba1\uff0c\u5176\u4ed6\u540c\u4e0a in 120 sec. -- \u7b2c\u4e8c\u6b21\u7edf\u8ba1\u7ed3\u679c\uff0c\u5176\u4ed6\u540c\u4e0a [ 0 ] sc:100590 lt:0 rt:0 fl:0 [ 1 ] sc:100582 lt:0 rt:0 fl:0 [ 2 ] sc:10059 lt:0 rt:0 fl:0 [ 3 ] sc:10057 lt:0 rt:0 fl:0 [ 4 ] sc:10059 lt:0 rt:0 fl:0 ( all must be [ OK ]) -- \u4e0b\u9762\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u7ed3\u679c\u90fd\u5fc5\u987b\u4e3a OK \u624d\u884c [ transaction percentage ] Payment: 43 .47% ( > = 43 .0% ) [ OK ] -- \u652f\u4ed8\u6210\u529f\u6b21\u6570 ( \u4e0a\u8ff0\u7edf\u8ba1\u7ed3\u679c\u4e2d sc + lt ) \u5fc5\u987b\u5927\u4e8e43.0%\uff0c\u5426\u5219\u7ed3\u679c\u4e3aNG\uff0c\u800c\u4e0d\u662fOK Order-Status: 4 .35% ( > = 4 .0% ) [ OK ] -- \u8ba2\u5355\u72b6\u6001\uff0c\u5176\u4ed6\u540c\u4e0a Delivery: 4 .35% ( > = 4 .0% ) [ OK ] -- \u53d1\u8d27\uff0c\u5176\u4ed6\u540c\u4e0a Stock-Level: 4 .35% ( > = 4 .0% ) [ OK ] -- \u5e93\u5b58\uff0c\u5176\u4ed6\u540c\u4e0a [ response time ( at least 90 % passed )] -- \u54cd\u5e94\u8017\u65f6\u6307\u6807\u5fc5\u987b\u8d85\u8fc790%\u901a\u8fc7\u624d\u884c New-Order: 100 .00% [ OK ] -- \u4e0b\u9762\u51e0\u4e2a\u54cd\u5e94\u8017\u65f6\u6307\u6807\u5168\u90e8 100 % \u901a\u8fc7 Payment: 100 .00% [ OK ] Order-Status: 100 .00% [ OK ] Delivery: 100 .00% [ OK ] Stock-Level: 100 .00% [ OK ] 50294 .500 TpmC -- TpmC\u7ed3\u679c\u503c\uff08\u6bcf\u5206\u949f\u4e8b\u52a1\u6570\uff0c\u8be5\u503c\u662f\u7b2c\u4e00\u6b21\u7edf\u8ba1\u7ed3\u679c\u4e2d\u7684\u65b0\u8ba2\u5355\u4e8b\u52a1\u6570\u9664\u4ee5\u603b\u8017\u65f6\u5206\u949f\u6570\uff0c\u4f8b\u5982\u672c\u4f8b\u4e2d\u662f\uff1a100589/2 = 50294 .500\uff09 script\u76ee\u5f55\u4e0b\u7684\u4e00\u4e9b\u811a\u672c\u4e3b\u8981\u662f\u4e00\u4e9b\u6027\u80fd\u6570\u636e\u91c7\u96c6\u4ee5\u53ca\u5206\u6790\u7684\uff0c\u53ef\u4ee5\u81ea\u884c\u6478\u7d22\u4e0b\u600e\u4e48\u7528\u3002 \u53c2\u8003\u6587\u7ae0\uff1a 1\u3001 http://imysql.com/2014/10/10/tpcc-mysql-full-user-manual.shtml 2\u3001 https://github.com/yejr/tpcc-mysql-autoinc-pk","title":"\u4e09\u3001TPCC\u6d4b\u8bd5\u7ed3\u679c\u89e3\u8bfb\uff1a"},{"location":"other/windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/","tags":"","text":"drupalconsole windows categories: drupal drupalconsole\u662f\u5565 \u00b6 The new CLI for Drupal. A tool to generate boilerplate code, interact with and debug Drupal. \u4ee5\u4e0a\u662f\u5b98\u7f51\u7684\u7b80\u4ecb\uff0c\u603b\u800c\u8a00\u4e4b\u662f\u4e3adrupal8\u800c\u751f\u7684\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177 \u8fd9\u91cc\u662f\u5b98\u7f51 drupalconsole\u5728windows\u4e0b\u7684\u5b89\u88c5 \u00b6 \u672c\u7bc7\u4ec5\u4ecb\u7ecd\u5728windows\u4e0b\u7684\u5b89\u88c5\u914d\u7f6e\uff0clinux\u8bf7\u53c2\u89c1\u5b98\u7f51 1\u3001\u4e0b\u8f7d drupalconsole \u70b9\u51fb\u8fd9\u91cc \u4e0b\u8f7d drupalconsole \uff0c\u66f4\u540d drupal 2\u3001\u627e\u4e2a\u76ee\u5f55\u7ed9\u4ed6\u5b89\u987f \u4f8b\u5982\uff1a D:\\system\\drupalconsole \uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 3\u3001\u914d\u7f6e\u73af\u5883\u53d8\u91cf \u628a php.exe \u6240\u5728\u7684\u76ee\u5f55\u52a0\u5165\u73af\u5883\u53d8\u91cf PATH \u4e2d \u518d\u628a\u4e0a\u4e00\u6b65 drupalconsole \u7684\u5b89\u987f\u76ee\u5f55\u52a0\u5165 windows \u7684\u73af\u5883\u53d8\u91cf PATH \u4e2d\uff0c\u7528\u6237\u6216\u8005\u7cfb\u7edf\u7684\u90fd\u53ef\u4ee5 \u5982\u4e0b\u56fe\uff1a 4\u3001\u6253\u5f00 git \u7684\u547d\u4ee4\u884c\u5de5\u5177\u6d4b\u8bd5\u4e00\u4e0b \u518d\u63d2\u4e00\u53e5\uff0c\u8c8c\u4f3cwindows\u4e0d\u8ba4\u8bc6\u975eexe\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u9700\u8981\u5b89\u88c5\u4e2agit\u7684\u547d\u4ee4\u884c\u5de5\u5177","title":"windows\u4e0b\u5b89\u88c5\u914d\u7f6edrupalconsole"},{"location":"other/windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/#drupalconsole","text":"The new CLI for Drupal. A tool to generate boilerplate code, interact with and debug Drupal. \u4ee5\u4e0a\u662f\u5b98\u7f51\u7684\u7b80\u4ecb\uff0c\u603b\u800c\u8a00\u4e4b\u662f\u4e3adrupal8\u800c\u751f\u7684\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177 \u8fd9\u91cc\u662f\u5b98\u7f51","title":"drupalconsole\u662f\u5565"},{"location":"other/windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/#drupalconsolewindows","text":"\u672c\u7bc7\u4ec5\u4ecb\u7ecd\u5728windows\u4e0b\u7684\u5b89\u88c5\u914d\u7f6e\uff0clinux\u8bf7\u53c2\u89c1\u5b98\u7f51 1\u3001\u4e0b\u8f7d drupalconsole \u70b9\u51fb\u8fd9\u91cc \u4e0b\u8f7d drupalconsole \uff0c\u66f4\u540d drupal 2\u3001\u627e\u4e2a\u76ee\u5f55\u7ed9\u4ed6\u5b89\u987f \u4f8b\u5982\uff1a D:\\system\\drupalconsole \uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 3\u3001\u914d\u7f6e\u73af\u5883\u53d8\u91cf \u628a php.exe \u6240\u5728\u7684\u76ee\u5f55\u52a0\u5165\u73af\u5883\u53d8\u91cf PATH \u4e2d \u518d\u628a\u4e0a\u4e00\u6b65 drupalconsole \u7684\u5b89\u987f\u76ee\u5f55\u52a0\u5165 windows \u7684\u73af\u5883\u53d8\u91cf PATH \u4e2d\uff0c\u7528\u6237\u6216\u8005\u7cfb\u7edf\u7684\u90fd\u53ef\u4ee5 \u5982\u4e0b\u56fe\uff1a 4\u3001\u6253\u5f00 git \u7684\u547d\u4ee4\u884c\u5de5\u5177\u6d4b\u8bd5\u4e00\u4e0b \u518d\u63d2\u4e00\u53e5\uff0c\u8c8c\u4f3cwindows\u4e0d\u8ba4\u8bc6\u975eexe\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u9700\u8981\u5b89\u88c5\u4e2agit\u7684\u547d\u4ee4\u884c\u5de5\u5177","title":"drupalconsole\u5728windows\u4e0b\u7684\u5b89\u88c5"},{"location":"other/yum-errno-14-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","tags":"[yum]","text":"\u4eca\u5929\u5728\u5b89\u88c5supervisor\u7684\u65f6\u5019\uff0c\u62a5\u5982\u4e0b\u9519\u8bef [root@admin yum.repos.d]# yum repolist Loaded plugins: fastestmirror Determining fastest mirrors http://balabala/repodata/repomd.xml: [Errno 14] problem making ssl connection Trying other mirror. http://balabala/repodata/repomd.xml: [Errno 14] problem making ssl connection Trying other mirror. \u6392\u67e5\u5e94\u8be5\u662fssl\u8bc1\u4e66\u95ee\u9898\u6709\u5173\uff0c\u7f51\u4e0a\u67e5\u4e86\u8d44\u6599\u53d1\u73b0\u9700\u8981\u5b89\u88c5 ca-certificates \u624d\u884c\u3002 yum install ca-certificates -y","title":"yum Errno 14 \u89e3\u51b3\u65b9\u6cd5"},{"location":"other/%E4%B8%80%E4%BA%9B%E6%BA%90%EF%BC%9Aepel%2Crpmforge%2Cremi%E6%BA%90/","tags":"[yum]","text":"\u4e3a\u4e86\u4fdd\u8bc1\u5b98\u65b9\u6e90\u7684\u987a\u5e8f\u8981\u9ad8\u4e8e\u7b2c\u4e09\u65b9\u6e90\u7684\u987a\u5e8f: yum install yum-priorities \u52a0\u8f7depel\u6e90 CentOS and Red Hat Enterprise Linux 6.x rpm -Uvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm CentOS and Red Hat Enterprise Linux 7.x https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm \u52a0\u8f7dRPMForge\u6e90 rpm -Uvh http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm \u52a0\u8f7dRemi\u6e90 CentOS and Red Hat Enterprise Linux 6.x rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm CentOS and Red Hat Enterprise Linux 7.x rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm \u7531\u4e8eCentOS\u5b98\u65b9\u8bf4RPMFusion\u6e90\u91cc\u9762\u7684\u8f6f\u4ef6\u7a33\u5b9a\u6027\u4e0d\u5982rpmforge\uff0c\u53ef\u4ee5\u4e0d\u52a0RPMFusion\u6e90.","title":"\u4e00\u4e9b\u6e90\uff1aepel,RPMForge,Remi\u6e90"},{"location":"other/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E5%90%84%E7%A7%8Die%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/","tags":"[ie]","text":"\u67e5\u770bbaidu.com\u7684\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u6709\u4e00\u884c Edge \u6a21\u5f0f\u901a\u77e5IE\u4ee5\u6700\u9ad8\u7ea7\u522b\u7684\u53ef\u7528\u6a21\u5f0f\u663e\u793a\u5185\u5bb9\u3002\u5373\u5982\u679c\u4f60\u6709IE9\u7684\u8bdd\u8bf4\u660e\u4f60\u6709IE789\uff0c\u90a3\u4e48\u5c31\u8c03\u7528\u9ad8\u7248\u672c\u7684\u90a3\u4e2a\u4e5f\u5c31\u662fIE9\u3002","title":"\u4e00\u884c\u4ee3\u7801\u89e3\u51b3\u5404\u79cdIE\u517c\u5bb9\u95ee\u9898"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/","tags":"[Vue]","text":"\u7ec4\u4ef6 \u00b6 \u4ec0\u4e48\u662f\u7ec4\u4ef6\uff1f \u7ec4\u4ef6\uff08Component\uff09\u662f Vue.js \u6700\u5f3a\u5927\u7684\u529f\u80fd\u4e4b\u4e00\u3002\u7ec4\u4ef6\u53ef\u4ee5\u6269\u5c55 HTML \u5143\u7d20\uff0c\u5c01\u88c5\u53ef\u91cd\u7528\u7684\u4ee3\u7801\u3002\u5728\u8f83\u9ad8\u5c42\u9762\u4e0a\uff0c\u7ec4\u4ef6\u662f\u81ea\u5b9a\u4e49\u5143\u7d20\uff0c Vue.js \u7684\u7f16\u8bd1\u5668\u4e3a\u5b83\u6dfb\u52a0\u7279\u6b8a\u529f\u80fd\u3002\u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u662f\u539f\u751f HTML \u5143\u7d20\u7684\u5f62\u5f0f\uff0c\u4ee5 js \u7279\u6027\u6269\u5c55\u3002 \u4f8b\u5b50 \u00b6 \u4e3e\u4e2a\u5c0f\u4f8b\u5b50\uff1a\u8c46\u74e3\u7535\u5f71\u6392\u884c\u699c \u6b64\u4f8b\u5b50\u5305\u542b\u6587\u7ae0\u5217\u8868\uff0c\u5206\u9875\uff0c\u8fd9\u91cc\u628a\u5217\u8868\u548c\u5206\u9875\u5206\u522b\u5f53\u4f5c\u5355\u72ec\u7684\u7ec4\u4ef6\uff0c\u52a0\u4e0a\u7236\u9875\u9762\u7ec4\u4ef6\u4e00\u5171\u662f3\u4e2a \u7236\u7ec4\u4ef6\uff1a app.vue \u5b50\u7ec4\u4ef6\uff1a list.vue pagination.vue \u63a5\u53e3\u7528\u7684\u662f\u8c46\u74e3\u7684jsonp\uff0c https://api.douban.com/v2/movie/top250 \u9996\u5148\u5728main.js\u5f15\u5165\u7236\u7ec4\u4ef6\uff0c\u5f15\u5165less\uff0c\u5f15\u5165VueResource\uff0c\u5b9e\u4f8b\u5316vue //main.js import Vue from 'vue' import app from './example1/app.vue' import './example1/style.less' import VueResource from 'vue-resource' Vue . use ( VueResource ) new Vue ({ render : h => h ( app ) }). $mount ( '#app' ) \u4ece\u5206\u9875\u5f00\u59cb\uff0c\u5728src/example1/components\u6587\u4ef6\u5939\u4e0b\u5efa\u7acb\u4e00\u4e2apagination.vue\u6587\u4ef6 <!--pagination.vue--> < template > < div class = \"text-center\" > < ul class = \"pagination\" > < li ></ li > </ ul > </ div > </ template > < script type = \"text/javascript\" > export default { data () { return { } }, props : { }, methods : { }, computed : { }, components : { }, mounted () { } } </ script > \u901a\u8fc7props\u4ece\u7236\u7ec4\u4ef6\u63a5\u6536\u6570\u636e\u3002\u7ec4\u4ef6\u53ef\u4ee5\u4e3aprops\u6307\u5b9a\u9a8c\u8bc1\u8981\u6c42\u3002\u5982\u679c\u672a\u6307\u5b9a\u9a8c\u8bc1\u8981\u6c42\uff0cVue\u4f1a\u53d1\u51fa\u8b66\u544a\uff0c\u5982\u679c\u4e0d\u9700\u8981\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u7528\u6570\u7ec4\u5f62\u5f0f //pagination.vue props : { //\u5f53\u524d\u9875\u7801 now : { type : Number , default : 1 }, //\u603b\u9875\u6570 all : { type : Number , default : 1 , required : 1 } } \u7236\u7ec4\u4ef6app.vue\u5f15\u5165\u7ec4\u4ef6\uff0c\u5e76\u4e14\u628a\u6570\u636e\u4f20\u7ed9\u5b50\u7ec4\u4ef6 <!--app.vue--> <!--\u4ee3\u7801\u7247\u6bb5--> < pagination :now = \"page.now\" :all = \"page.all\" ></ pagination > <!--\u4ee3\u7801\u7247\u6bb5--> < script type = \"text/javascript\" > import pagination from './components/pagination.vue' export default { data () { return { page : { now : 1 , all : 10 } } }, components : { pagination } } </ script > \u6839\u636e\u4f20\u5165\u7684\u6570\u636e\u8ba1\u7b97\u5206\u9875\u6570\u636e //pagination.vue computed : { pages () { var pages = []; if ( this . now > 1 ) pages . push ({ text : '\u4e0a\u4e00\u9875' , num : this . now - 1 }); if ( this . now - 1 > 2 ) pages . push ({ text : 1 , num : 1 }); if ( this . now - 1 > 3 ) pages . push ({ text : '...' , num : 0 }); for ( var i = 1 ; i <= this . all ; i ++ ) { if ( this . now - i < 3 && this . now >= i || i - this . now < 3 && this . now <= i ){ pages . push ({ text : i , num : i }); } } if ( this . all - this . now > 3 ) pages . push ({ text : '...' , num : 0 }); if ( this . all - this . now > 2 ) pages . push ({ text : this . all , num : this . all }); if ( this . now < this . all ) pages . push ({ text : '\u4e0b\u4e00\u9875' , num : this . now + 1 }); return pages ; } } \u7528v-for\u628a\u5206\u9875\u6e32\u67d3\u51fa\u6765 <!--pagination.vue--> < template > < ul class = \"pagination\" > < li v-for = \"page in pages\" :class = \"{ 'active' : page.num == now }\" > < a v-if = \"page.num\" @ click = \"toPage(page.num)\" > {{ page.text }} </ a > < span v-else > {{ page.text }} </ span > </ li > </ ul > </ template > \u5b50\u7ec4\u4ef6\u901a\u8fc7\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u5411\u7236\u7ec4\u4ef6\u4f20\u4e8b\u4ef6\u548c\u6570\u636e //pagination.vue methods : { toPage ( page ) { this . $emit ( 'toPage' , page ); } } \u7236\u7ec4\u4ef6\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u7136\u540e\u8c03\u7528\u65b9\u6cd5changePage <!--app.vue--> < pagination :now = \"page.now\" :all = \"page.all\" @ toPage = \"changePage\" ></ pagination > < script > //\u4ee3\u7801\u7247\u6bb5 methods : { changePage ( page ) { this . page . now = page } } //\u4ee3\u7801\u7247\u6bb5 </ script > \u81f3\u6b64\u5b8c\u6210\u4e86\u7236\u7ec4\u4ef6\u628a\u6570\u636e\u4e22\u7ed9\u5b50\u7ec4\u4ef6\u5904\u7406\uff0c\u5b50\u7ec4\u4ef6\u628a\u64cd\u4f5c\u53cd\u9988\u7ed9\u7236\u7ec4\u4ef6\u8fd9\u4e00\u8fc7\u7a0b \u5217\u8868\u7ec4\u4ef6list.vue <!--list.vue--> < template > < div > < slot name = \"title\" ></ slot > < div class = \"list clearfix row\" > < div class = \"col-xs-6\" v-for = \"item in items\" > < div class = \"item\" > < div class = \"img\" > < img :src = \"item.images.small\" ></ div > < slot name = \"year\" :year = \"item.year\" > < div class = \"year\" > {{ item.year }} </ div > </ slot > < div class = \"title\" > {{ item.title }} </ div > < div class = \"dis\" > {{ item.original_title }} </ div > </ div > </ div > </ div > </ div > </ template > < script type = \"text/javascript\" > export default { data () { return { } }, props : [ 'items' ] } </ script > \u6765\u70b9\u52a8\u6001\u7684\u6570\u636e <!--app.vue--> < template > < div class = \"container\" > < div class = \"loading\" v-show = \"loading\" ></ div > < list :items = \"items\" > < h1 class = \"text-center\" slot = \"title\" > \u8c46\u74e3\u7535\u5f71\u6392\u884c\u699c </ h1 > < template slot = \"year\" scope = \"props\" > < div class = \"year red\" > {{ props.year }} </ div > </ template > </ list > < pagination :now = \"page.now\" :all = \"page.all\" @ toPage = \"changePage\" ></ pagination > </ div > </ template > < script type = \"text/javascript\" > import list from './components/list.vue' import pagination from './components/pagination.vue' export default { data () { return { loading : 0 , params : { //\u6bcf\u9875\u663e\u793a\u6761\u6570 count : 10 , //\u4ece\u7b2c\u51e0\u6761\u5f00\u59cb\u663e\u793a\uff0c\u521d\u59cb0 start : 0 , //\u603b\u6761\u6570 total : 250 }, items : [] } }, methods : { getItems () { this . loading = 1 ; this . $http . jsonp ( 'https://api.douban.com/v2/movie/top250' , { params : this . params }). then ( response => { if ( response . ok ) { this . items = response . data . subjects ; this . params = { count : response . data . count , start : response . data . start , total : response . data . total } } }, response => { console . log ( response ); }). finally ( function (){ this . loading = 0 ; }) }, changePage ( page ) { this . params . start = ( page - 1 ) * this . params . count ; this . getItems (); } }, components : { list , pagination }, computed : { page () { return { now : this . params . start / this . params . count + 1 , all : Math . ceil ( this . params . total / this . params . count ) } } }, mounted () { this . getItems (); } } </ script > \u51e0\u4e2a\u70b9\uff1a \u00b6 prop\u4f20\u9012\u6570\u636e \u00b6 \u7ec4\u4ef6\u5b9e\u4f8b\u7684\u4f5c\u7528\u57df\u662f\u5b64\u7acb\u7684\u3002\u8fd9\u610f\u5473\u7740\u4e0d\u80fd\u5e76\u4e14\u4e0d\u5e94\u8be5\u5728\u5b50\u7ec4\u4ef6\u7684\u6a21\u677f\u5185\u76f4\u63a5\u5f15\u7528\u7236\u7ec4\u4ef6\u7684\u6570\u636e\u3002\u53ef\u4ee5\u4f7f\u7528 props \u628a\u6570\u636e\u4f20\u7ed9\u5b50\u7ec4\u4ef6\u3002 \u7c7b\u4f3c\u4e8e\u7528 v-bind \u7ed1\u5b9a HTML \u7279\u6027\u5230\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528 v-bind \u52a8\u6001\u7ed1\u5b9a props \u7684\u503c\u5230\u7236\u7ec4\u4ef6\u7684\u6570\u636e\u4e2d\u3002\u6bcf\u5f53\u7236\u7ec4\u4ef6\u7684\u6570\u636e\u53d8\u5316\u65f6\uff0c\u8be5\u53d8\u5316\u4e5f\u4f1a\u4f20\u5bfc\u7ed9\u5b50\u7ec4\u4ef6\uff1a \u81ea\u5b9a\u4e49\u4e8b\u4ef6 \u00b6 \u7236\u7ec4\u4ef6\u53ef\u4ee5\u5728\u4f7f\u7528\u5b50\u7ec4\u4ef6\u7684\u5730\u65b9\u76f4\u63a5\u7528 v-on \u6765\u76d1\u542c\u5b50\u7ec4\u4ef6\u89e6\u53d1\u7684\u4e8b\u4ef6 slot\u5206\u53d1\u5185\u5bb9 \u00b6 \u7ec4\u4ef6\u4e0d\u77e5\u9053\u5b83\u7684\u6302\u8f7d\u70b9\u4f1a\u6709\u4ec0\u4e48\u5185\u5bb9\u3002\u6302\u8f7d\u70b9\u7684\u5185\u5bb9\u662f ~\u7531\u7236\u7ec4\u4ef6\u51b3 ~\u5b9a\u7684;\u7ec4\u4ef6\u5f88\u53ef\u80fd\u6709\u5b83\u81ea\u5df1\u7684\u6a21\u7248 \u4e3a\u4e86\u8ba9\u7ec4\u4ef6\u53ef\u4ee5\u7ec4\u5408\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u5f0f\u6765\u6df7\u5408\u7236\u7ec4\u4ef6\u7684\u5185\u5bb9\u4e0e\u5b50\u7ec4\u4ef6\u81ea\u5df1\u7684\u6a21\u677f\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e3a \u5185\u5bb9\u5206\u53d1 (\u6216 \u201ctransclusion\u201d \u5982\u679c\u4f60\u719f\u6089 Angular)\u3002Vue.js \u5b9e\u73b0\u4e86\u4e00\u4e2a\u5185\u5bb9\u5206\u53d1 API \uff0c\u53c2\u7167\u4e86\u5f53\u524d Web \u7ec4\u4ef6\u89c4\u8303\u8349\u6848\uff0c\u4f7f\u7528\u7279\u6b8a\u7684 <slot> \u5143\u7d20\u4f5c\u4e3a\u539f\u59cb\u5185\u5bb9\u7684\u63d2\u69fd\u3002 \u901a\u8fc7slot\u63d2\u69fd\u5c06\u6807\u9898\u63d2\u5165\u5230\u5b50\u7ec4\u4ef6 \u4f5c\u7528\u57df\u63d2\u69fd \u00b6 \u7236\u7ec4\u4ef6\u6a21\u677f\u7684\u5185\u5bb9\u5728\u7236\u7ec4\u4ef6\u4f5c\u7528\u57df\u5185\u7f16\u8bd1\uff1b\u5b50\u7ec4\u4ef6\u6a21\u677f\u7684\u5185\u5bb9\u5728\u5b50\u7ec4\u4ef6\u4f5c\u7528\u57df\u5185\u7f16\u8bd1 \u4f5c\u7528\u57df\u63d2\u69fd\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u63d2\u69fd\uff0c\u7528\u4f5c\u4f7f\u7528\u4e00\u4e2a\uff08\u80fd\u591f\u4f20\u9012\u6570\u636e\u5230\uff09\u53ef\u91cd\u7528\u6a21\u677f\u66ff\u6362\u5df2\u6e32\u67d3\u5143\u7d20\u3002 \u5728\u5b50\u7ec4\u4ef6\u4e2d\uff0c\u53ea\u9700\u5c06\u6570\u636e\u4f20\u9012\u5230\u63d2\u69fd\uff0c\u5c31\u50cf\u4f60\u5c06 prop \u4f20\u9012\u7ed9\u7ec4\u4ef6\u4e00\u6837 \u901a\u8fc7\u4f5c\u7528\u57df\u63d2\u69fd\u5c06\u5b50\u7ec4\u4ef6\u6570\u636e\u4f20\u7ed9\u7236\u7ec4\u4ef6\uff0c\u518d\u4f5c\u4e3a\u81ea\u5b9a\u4e49\u6a21\u677f\u91cd\u65b0\u63d2\u5165\u5230\u5b50\u7ec4\u4ef6 \u8ba1\u7b97 \u00b6 \u8c46\u74e3\u63a5\u53e3\u63a5\u6536\u53c2\u6570\u548c\u8bbe\u8ba1\u7684\u4e0d\u540c\uff0cpages\u9700\u8981\u901a\u8fc7computed\u8ba1\u7b97 \u5206\u9875\u7684\u7b97\u6cd5 \u00b6 \u5f15\u7533\u95ee\u9898\uff1a \u00b6 watch params\u53d8\u5316 loading\u5e7f\u64ad","title":"\"\u4ece\u7b80\u5355\u7684\u5217\u8868\u9875\u6d45\u8c08Vue\u7ec4\u4ef6\""},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_1","text":"\u4ec0\u4e48\u662f\u7ec4\u4ef6\uff1f \u7ec4\u4ef6\uff08Component\uff09\u662f Vue.js \u6700\u5f3a\u5927\u7684\u529f\u80fd\u4e4b\u4e00\u3002\u7ec4\u4ef6\u53ef\u4ee5\u6269\u5c55 HTML \u5143\u7d20\uff0c\u5c01\u88c5\u53ef\u91cd\u7528\u7684\u4ee3\u7801\u3002\u5728\u8f83\u9ad8\u5c42\u9762\u4e0a\uff0c\u7ec4\u4ef6\u662f\u81ea\u5b9a\u4e49\u5143\u7d20\uff0c Vue.js \u7684\u7f16\u8bd1\u5668\u4e3a\u5b83\u6dfb\u52a0\u7279\u6b8a\u529f\u80fd\u3002\u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u662f\u539f\u751f HTML \u5143\u7d20\u7684\u5f62\u5f0f\uff0c\u4ee5 js \u7279\u6027\u6269\u5c55\u3002","title":"\u7ec4\u4ef6"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_2","text":"\u4e3e\u4e2a\u5c0f\u4f8b\u5b50\uff1a\u8c46\u74e3\u7535\u5f71\u6392\u884c\u699c \u6b64\u4f8b\u5b50\u5305\u542b\u6587\u7ae0\u5217\u8868\uff0c\u5206\u9875\uff0c\u8fd9\u91cc\u628a\u5217\u8868\u548c\u5206\u9875\u5206\u522b\u5f53\u4f5c\u5355\u72ec\u7684\u7ec4\u4ef6\uff0c\u52a0\u4e0a\u7236\u9875\u9762\u7ec4\u4ef6\u4e00\u5171\u662f3\u4e2a \u7236\u7ec4\u4ef6\uff1a app.vue \u5b50\u7ec4\u4ef6\uff1a list.vue pagination.vue \u63a5\u53e3\u7528\u7684\u662f\u8c46\u74e3\u7684jsonp\uff0c https://api.douban.com/v2/movie/top250 \u9996\u5148\u5728main.js\u5f15\u5165\u7236\u7ec4\u4ef6\uff0c\u5f15\u5165less\uff0c\u5f15\u5165VueResource\uff0c\u5b9e\u4f8b\u5316vue //main.js import Vue from 'vue' import app from './example1/app.vue' import './example1/style.less' import VueResource from 'vue-resource' Vue . use ( VueResource ) new Vue ({ render : h => h ( app ) }). $mount ( '#app' ) \u4ece\u5206\u9875\u5f00\u59cb\uff0c\u5728src/example1/components\u6587\u4ef6\u5939\u4e0b\u5efa\u7acb\u4e00\u4e2apagination.vue\u6587\u4ef6 <!--pagination.vue--> < template > < div class = \"text-center\" > < ul class = \"pagination\" > < li ></ li > </ ul > </ div > </ template > < script type = \"text/javascript\" > export default { data () { return { } }, props : { }, methods : { }, computed : { }, components : { }, mounted () { } } </ script > \u901a\u8fc7props\u4ece\u7236\u7ec4\u4ef6\u63a5\u6536\u6570\u636e\u3002\u7ec4\u4ef6\u53ef\u4ee5\u4e3aprops\u6307\u5b9a\u9a8c\u8bc1\u8981\u6c42\u3002\u5982\u679c\u672a\u6307\u5b9a\u9a8c\u8bc1\u8981\u6c42\uff0cVue\u4f1a\u53d1\u51fa\u8b66\u544a\uff0c\u5982\u679c\u4e0d\u9700\u8981\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u7528\u6570\u7ec4\u5f62\u5f0f //pagination.vue props : { //\u5f53\u524d\u9875\u7801 now : { type : Number , default : 1 }, //\u603b\u9875\u6570 all : { type : Number , default : 1 , required : 1 } } \u7236\u7ec4\u4ef6app.vue\u5f15\u5165\u7ec4\u4ef6\uff0c\u5e76\u4e14\u628a\u6570\u636e\u4f20\u7ed9\u5b50\u7ec4\u4ef6 <!--app.vue--> <!--\u4ee3\u7801\u7247\u6bb5--> < pagination :now = \"page.now\" :all = \"page.all\" ></ pagination > <!--\u4ee3\u7801\u7247\u6bb5--> < script type = \"text/javascript\" > import pagination from './components/pagination.vue' export default { data () { return { page : { now : 1 , all : 10 } } }, components : { pagination } } </ script > \u6839\u636e\u4f20\u5165\u7684\u6570\u636e\u8ba1\u7b97\u5206\u9875\u6570\u636e //pagination.vue computed : { pages () { var pages = []; if ( this . now > 1 ) pages . push ({ text : '\u4e0a\u4e00\u9875' , num : this . now - 1 }); if ( this . now - 1 > 2 ) pages . push ({ text : 1 , num : 1 }); if ( this . now - 1 > 3 ) pages . push ({ text : '...' , num : 0 }); for ( var i = 1 ; i <= this . all ; i ++ ) { if ( this . now - i < 3 && this . now >= i || i - this . now < 3 && this . now <= i ){ pages . push ({ text : i , num : i }); } } if ( this . all - this . now > 3 ) pages . push ({ text : '...' , num : 0 }); if ( this . all - this . now > 2 ) pages . push ({ text : this . all , num : this . all }); if ( this . now < this . all ) pages . push ({ text : '\u4e0b\u4e00\u9875' , num : this . now + 1 }); return pages ; } } \u7528v-for\u628a\u5206\u9875\u6e32\u67d3\u51fa\u6765 <!--pagination.vue--> < template > < ul class = \"pagination\" > < li v-for = \"page in pages\" :class = \"{ 'active' : page.num == now }\" > < a v-if = \"page.num\" @ click = \"toPage(page.num)\" > {{ page.text }} </ a > < span v-else > {{ page.text }} </ span > </ li > </ ul > </ template > \u5b50\u7ec4\u4ef6\u901a\u8fc7\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u5411\u7236\u7ec4\u4ef6\u4f20\u4e8b\u4ef6\u548c\u6570\u636e //pagination.vue methods : { toPage ( page ) { this . $emit ( 'toPage' , page ); } } \u7236\u7ec4\u4ef6\u76d1\u542c\u8fd9\u4e2a\u4e8b\u4ef6\uff0c\u7136\u540e\u8c03\u7528\u65b9\u6cd5changePage <!--app.vue--> < pagination :now = \"page.now\" :all = \"page.all\" @ toPage = \"changePage\" ></ pagination > < script > //\u4ee3\u7801\u7247\u6bb5 methods : { changePage ( page ) { this . page . now = page } } //\u4ee3\u7801\u7247\u6bb5 </ script > \u81f3\u6b64\u5b8c\u6210\u4e86\u7236\u7ec4\u4ef6\u628a\u6570\u636e\u4e22\u7ed9\u5b50\u7ec4\u4ef6\u5904\u7406\uff0c\u5b50\u7ec4\u4ef6\u628a\u64cd\u4f5c\u53cd\u9988\u7ed9\u7236\u7ec4\u4ef6\u8fd9\u4e00\u8fc7\u7a0b \u5217\u8868\u7ec4\u4ef6list.vue <!--list.vue--> < template > < div > < slot name = \"title\" ></ slot > < div class = \"list clearfix row\" > < div class = \"col-xs-6\" v-for = \"item in items\" > < div class = \"item\" > < div class = \"img\" > < img :src = \"item.images.small\" ></ div > < slot name = \"year\" :year = \"item.year\" > < div class = \"year\" > {{ item.year }} </ div > </ slot > < div class = \"title\" > {{ item.title }} </ div > < div class = \"dis\" > {{ item.original_title }} </ div > </ div > </ div > </ div > </ div > </ template > < script type = \"text/javascript\" > export default { data () { return { } }, props : [ 'items' ] } </ script > \u6765\u70b9\u52a8\u6001\u7684\u6570\u636e <!--app.vue--> < template > < div class = \"container\" > < div class = \"loading\" v-show = \"loading\" ></ div > < list :items = \"items\" > < h1 class = \"text-center\" slot = \"title\" > \u8c46\u74e3\u7535\u5f71\u6392\u884c\u699c </ h1 > < template slot = \"year\" scope = \"props\" > < div class = \"year red\" > {{ props.year }} </ div > </ template > </ list > < pagination :now = \"page.now\" :all = \"page.all\" @ toPage = \"changePage\" ></ pagination > </ div > </ template > < script type = \"text/javascript\" > import list from './components/list.vue' import pagination from './components/pagination.vue' export default { data () { return { loading : 0 , params : { //\u6bcf\u9875\u663e\u793a\u6761\u6570 count : 10 , //\u4ece\u7b2c\u51e0\u6761\u5f00\u59cb\u663e\u793a\uff0c\u521d\u59cb0 start : 0 , //\u603b\u6761\u6570 total : 250 }, items : [] } }, methods : { getItems () { this . loading = 1 ; this . $http . jsonp ( 'https://api.douban.com/v2/movie/top250' , { params : this . params }). then ( response => { if ( response . ok ) { this . items = response . data . subjects ; this . params = { count : response . data . count , start : response . data . start , total : response . data . total } } }, response => { console . log ( response ); }). finally ( function (){ this . loading = 0 ; }) }, changePage ( page ) { this . params . start = ( page - 1 ) * this . params . count ; this . getItems (); } }, components : { list , pagination }, computed : { page () { return { now : this . params . start / this . params . count + 1 , all : Math . ceil ( this . params . total / this . params . count ) } } }, mounted () { this . getItems (); } } </ script >","title":"\u4f8b\u5b50"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_3","text":"","title":"\u51e0\u4e2a\u70b9\uff1a"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#prop","text":"\u7ec4\u4ef6\u5b9e\u4f8b\u7684\u4f5c\u7528\u57df\u662f\u5b64\u7acb\u7684\u3002\u8fd9\u610f\u5473\u7740\u4e0d\u80fd\u5e76\u4e14\u4e0d\u5e94\u8be5\u5728\u5b50\u7ec4\u4ef6\u7684\u6a21\u677f\u5185\u76f4\u63a5\u5f15\u7528\u7236\u7ec4\u4ef6\u7684\u6570\u636e\u3002\u53ef\u4ee5\u4f7f\u7528 props \u628a\u6570\u636e\u4f20\u7ed9\u5b50\u7ec4\u4ef6\u3002 \u7c7b\u4f3c\u4e8e\u7528 v-bind \u7ed1\u5b9a HTML \u7279\u6027\u5230\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528 v-bind \u52a8\u6001\u7ed1\u5b9a props \u7684\u503c\u5230\u7236\u7ec4\u4ef6\u7684\u6570\u636e\u4e2d\u3002\u6bcf\u5f53\u7236\u7ec4\u4ef6\u7684\u6570\u636e\u53d8\u5316\u65f6\uff0c\u8be5\u53d8\u5316\u4e5f\u4f1a\u4f20\u5bfc\u7ed9\u5b50\u7ec4\u4ef6\uff1a","title":"prop\u4f20\u9012\u6570\u636e"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_4","text":"\u7236\u7ec4\u4ef6\u53ef\u4ee5\u5728\u4f7f\u7528\u5b50\u7ec4\u4ef6\u7684\u5730\u65b9\u76f4\u63a5\u7528 v-on \u6765\u76d1\u542c\u5b50\u7ec4\u4ef6\u89e6\u53d1\u7684\u4e8b\u4ef6","title":"\u81ea\u5b9a\u4e49\u4e8b\u4ef6"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#slot","text":"\u7ec4\u4ef6\u4e0d\u77e5\u9053\u5b83\u7684\u6302\u8f7d\u70b9\u4f1a\u6709\u4ec0\u4e48\u5185\u5bb9\u3002\u6302\u8f7d\u70b9\u7684\u5185\u5bb9\u662f ~\u7531\u7236\u7ec4\u4ef6\u51b3 ~\u5b9a\u7684;\u7ec4\u4ef6\u5f88\u53ef\u80fd\u6709\u5b83\u81ea\u5df1\u7684\u6a21\u7248 \u4e3a\u4e86\u8ba9\u7ec4\u4ef6\u53ef\u4ee5\u7ec4\u5408\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u5f0f\u6765\u6df7\u5408\u7236\u7ec4\u4ef6\u7684\u5185\u5bb9\u4e0e\u5b50\u7ec4\u4ef6\u81ea\u5df1\u7684\u6a21\u677f\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e3a \u5185\u5bb9\u5206\u53d1 (\u6216 \u201ctransclusion\u201d \u5982\u679c\u4f60\u719f\u6089 Angular)\u3002Vue.js \u5b9e\u73b0\u4e86\u4e00\u4e2a\u5185\u5bb9\u5206\u53d1 API \uff0c\u53c2\u7167\u4e86\u5f53\u524d Web \u7ec4\u4ef6\u89c4\u8303\u8349\u6848\uff0c\u4f7f\u7528\u7279\u6b8a\u7684 <slot> \u5143\u7d20\u4f5c\u4e3a\u539f\u59cb\u5185\u5bb9\u7684\u63d2\u69fd\u3002 \u901a\u8fc7slot\u63d2\u69fd\u5c06\u6807\u9898\u63d2\u5165\u5230\u5b50\u7ec4\u4ef6","title":"slot\u5206\u53d1\u5185\u5bb9"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_5","text":"\u7236\u7ec4\u4ef6\u6a21\u677f\u7684\u5185\u5bb9\u5728\u7236\u7ec4\u4ef6\u4f5c\u7528\u57df\u5185\u7f16\u8bd1\uff1b\u5b50\u7ec4\u4ef6\u6a21\u677f\u7684\u5185\u5bb9\u5728\u5b50\u7ec4\u4ef6\u4f5c\u7528\u57df\u5185\u7f16\u8bd1 \u4f5c\u7528\u57df\u63d2\u69fd\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u63d2\u69fd\uff0c\u7528\u4f5c\u4f7f\u7528\u4e00\u4e2a\uff08\u80fd\u591f\u4f20\u9012\u6570\u636e\u5230\uff09\u53ef\u91cd\u7528\u6a21\u677f\u66ff\u6362\u5df2\u6e32\u67d3\u5143\u7d20\u3002 \u5728\u5b50\u7ec4\u4ef6\u4e2d\uff0c\u53ea\u9700\u5c06\u6570\u636e\u4f20\u9012\u5230\u63d2\u69fd\uff0c\u5c31\u50cf\u4f60\u5c06 prop \u4f20\u9012\u7ed9\u7ec4\u4ef6\u4e00\u6837 \u901a\u8fc7\u4f5c\u7528\u57df\u63d2\u69fd\u5c06\u5b50\u7ec4\u4ef6\u6570\u636e\u4f20\u7ed9\u7236\u7ec4\u4ef6\uff0c\u518d\u4f5c\u4e3a\u81ea\u5b9a\u4e49\u6a21\u677f\u91cd\u65b0\u63d2\u5165\u5230\u5b50\u7ec4\u4ef6","title":"\u4f5c\u7528\u57df\u63d2\u69fd"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_6","text":"\u8c46\u74e3\u63a5\u53e3\u63a5\u6536\u53c2\u6570\u548c\u8bbe\u8ba1\u7684\u4e0d\u540c\uff0cpages\u9700\u8981\u901a\u8fc7computed\u8ba1\u7b97","title":"\u8ba1\u7b97"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_7","text":"","title":"\u5206\u9875\u7684\u7b97\u6cd5"},{"location":"other/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#_8","text":"watch params\u53d8\u5316 loading\u5e7f\u64ad","title":"\u5f15\u7533\u95ee\u9898\uff1a"},{"location":"other/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/","tags":"[gdb]","text":"\u6709\u5f88\u591aphp\u5f00\u53d1\u4eba\u5458\u7ecf\u5e38\u95ee\u6211\uff0c\u5982\u679c\u6267\u884cphp\u4ee3\u7801\u7684\u65f6\u5019\u51fa\u73b0\u4e25\u91cd\u9519\u8bef\u7684\u65f6\u5019\uff0c\u5982\u4f55\u5feb\u901f\u5b9a\u4f4d\u95ee\u9898\u3002\u6211\u4e00\u822c\u63a8\u8350\u4ed6\u4eec\u7528gdb\u53bb\u8c03\u8bd5\u3002 \u4e0b\u9762\u7528php-fpm\u7684\u4e00\u4e2a\u6bb5\u9519\u8bef\u6765\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5982\uff1a WARNING: [ pool www ] child 15109 exited on signal 11 ( SIGSEGV ) after 654 .485221 seconds from start 1\u3001\u5b89\u88c5gdb \u00b6 yum install gdb php-dbg \u6709\u7684\u65f6\u5019\u53ef\u80fd\u9700\u8981\u5b89\u88c5debuginfo\u76f8\u5173\u7684\u5e93\uff0c\u5982: debuginfo-install php-fpm 2\u3001\u8bbe\u7f6ecoredump \u00b6 echo '/tmp/core-%e.%p' > /proc/sys/kernel/core_pattern echo 0 > /proc/sys/kernel/core_uses_pid ulimit -c unlimited \u5f53\u7136,coredump\u7684\u6587\u4ef6\u683c\u5f0f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5176\u4ed6\u7684\uff0c\u8fd9\u91cc\u662f\u8be6\u7ec6\u7684\u8bbe\u7f6e\u9879\u8bf4\u660e %% a single % character %c core file size soft resource limit of crashing process ( since Linux 2 .6.24 ) %d dump mode\u2014same as value returned by prctl ( 2 ) PR_GET_DUMPABLE ( since Linux 3 .7 ) %e executable filename ( without path prefix ) %E pathname of executable, with slashes ( '/' ) replaced by exclamation marks ( '!' ) ( since Linux 3 .0 ) . %g ( numeric ) real GID of dumped process %h hostname ( same as nodename returned by uname ( 2 )) %p PID of dumped process, as seen in the PID namespace in which the process resides %P PID of dumped process, as seen in the initial PID namespace ( since Linux 3 .12 ) %s number of signal causing dump %t time of dump, expressed as seconds since the Epoch, 1970 -01-01 00 :00:00 +0000 ( UTC ) %u ( numeric ) real UID of dumped process 3\u3001\u8bbe\u7f6ephp-fpm \u00b6 vim /etc/php-fpm.d/www.conf \u627e\u5230\u5173\u952e\u5b57 rlimit_core\uff0c\u5e76\u4fee\u6539\u4e3a rlimit_core = unlimited \u7136\u540e\u6267\u884c /usr/sbin/php-fpm --daemonize \u8fd9\u65f6\u5c31\u4f1a\u5728/tmp\u4e0b\u770b\u5230\u6709coredump\u6587\u4ef6\u751f\u6210\u4e86\u3002 [ root@localhost tmp ] # ls core-php-fpm.7279 4\u3001\u8ffd\u8e2a \u00b6 \u6267\u884c\u547d\u4ee4 gdb /usr/sbin/php-fpm /tmp/core-php-fpm.7279 \u6267\u884cbt\u547d\u4ee4\u5c31\u53ef\u4ee5\u67e5\u770b\u8be6\u7ec6\u7684\u9519\u8bef\u65e5\u5fd7\u4e86 ( gdb ) bt #0 _zend_hash_init (ht=0x2b4d1a4f8100, nSize=174762, pDestructor=0, persistent=1 '\\001') at /usr/src/debug/php-7.0.0RC8/Zend/zend_hash.c:172 #1 0x00002b4d0d0e87ac in zend_accel_init_shm (extension=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/ext/opcache/ZendAccelerator.c:2387 #2 accel_startup (extension=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/ext/opcache/ZendAccelerator.c:2640 #3 0x00000000005e8d21 in zend_extension_startup (extension=0x168c810) at /usr/src/debug/php-7.0.0RC8/Zend/zend_extensions.c:176 #4 0x00000000005d2293 in zend_llist_apply_with_del (l=0x9dd420, func=0x5e8d10 <zend_extension_startup>) at /usr/src/debug/php-7.0.0RC8/Zend/zend_llist.c:171 #5 0x00000000005e8d07 in zend_startup_extensions () at /usr/src/debug/php-7.0.0RC8/Zend/zend_extensions.c:197 #6 0x0000000000580985 in php_module_startup (sf=<value optimized out>, additional_modules=<value optimized out>, num_additional_modules=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/main/main.c:2197 #7 0x000000000067aec5 in php_cgi_startup (sapi_module=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/sapi/fpm/fpm/fpm_main.c:837 #8 0x000000000067bcfe in main (argc=2, argv=0x7fff1a037498) at /usr/src/debug/php-7.0.0RC8/sapi/fpm/fpm/fpm_main.c:1788 \u81f3\u6b64\uff0c\u6574\u4e2a\u8ffd\u8e2a\u8fc7\u7a0b\u7ed3\u675f\u3002","title":"\"\u4f7f\u7528gdb\u8c03\u8bd5php-fpm\""},{"location":"other/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/#1gdb","text":"yum install gdb php-dbg \u6709\u7684\u65f6\u5019\u53ef\u80fd\u9700\u8981\u5b89\u88c5debuginfo\u76f8\u5173\u7684\u5e93\uff0c\u5982: debuginfo-install php-fpm","title":"1\u3001\u5b89\u88c5gdb"},{"location":"other/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/#2coredump","text":"echo '/tmp/core-%e.%p' > /proc/sys/kernel/core_pattern echo 0 > /proc/sys/kernel/core_uses_pid ulimit -c unlimited \u5f53\u7136,coredump\u7684\u6587\u4ef6\u683c\u5f0f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u5176\u4ed6\u7684\uff0c\u8fd9\u91cc\u662f\u8be6\u7ec6\u7684\u8bbe\u7f6e\u9879\u8bf4\u660e %% a single % character %c core file size soft resource limit of crashing process ( since Linux 2 .6.24 ) %d dump mode\u2014same as value returned by prctl ( 2 ) PR_GET_DUMPABLE ( since Linux 3 .7 ) %e executable filename ( without path prefix ) %E pathname of executable, with slashes ( '/' ) replaced by exclamation marks ( '!' ) ( since Linux 3 .0 ) . %g ( numeric ) real GID of dumped process %h hostname ( same as nodename returned by uname ( 2 )) %p PID of dumped process, as seen in the PID namespace in which the process resides %P PID of dumped process, as seen in the initial PID namespace ( since Linux 3 .12 ) %s number of signal causing dump %t time of dump, expressed as seconds since the Epoch, 1970 -01-01 00 :00:00 +0000 ( UTC ) %u ( numeric ) real UID of dumped process","title":"2\u3001\u8bbe\u7f6ecoredump"},{"location":"other/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/#3php-fpm","text":"vim /etc/php-fpm.d/www.conf \u627e\u5230\u5173\u952e\u5b57 rlimit_core\uff0c\u5e76\u4fee\u6539\u4e3a rlimit_core = unlimited \u7136\u540e\u6267\u884c /usr/sbin/php-fpm --daemonize \u8fd9\u65f6\u5c31\u4f1a\u5728/tmp\u4e0b\u770b\u5230\u6709coredump\u6587\u4ef6\u751f\u6210\u4e86\u3002 [ root@localhost tmp ] # ls core-php-fpm.7279","title":"3\u3001\u8bbe\u7f6ephp-fpm"},{"location":"other/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/#4","text":"\u6267\u884c\u547d\u4ee4 gdb /usr/sbin/php-fpm /tmp/core-php-fpm.7279 \u6267\u884cbt\u547d\u4ee4\u5c31\u53ef\u4ee5\u67e5\u770b\u8be6\u7ec6\u7684\u9519\u8bef\u65e5\u5fd7\u4e86 ( gdb ) bt #0 _zend_hash_init (ht=0x2b4d1a4f8100, nSize=174762, pDestructor=0, persistent=1 '\\001') at /usr/src/debug/php-7.0.0RC8/Zend/zend_hash.c:172 #1 0x00002b4d0d0e87ac in zend_accel_init_shm (extension=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/ext/opcache/ZendAccelerator.c:2387 #2 accel_startup (extension=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/ext/opcache/ZendAccelerator.c:2640 #3 0x00000000005e8d21 in zend_extension_startup (extension=0x168c810) at /usr/src/debug/php-7.0.0RC8/Zend/zend_extensions.c:176 #4 0x00000000005d2293 in zend_llist_apply_with_del (l=0x9dd420, func=0x5e8d10 <zend_extension_startup>) at /usr/src/debug/php-7.0.0RC8/Zend/zend_llist.c:171 #5 0x00000000005e8d07 in zend_startup_extensions () at /usr/src/debug/php-7.0.0RC8/Zend/zend_extensions.c:197 #6 0x0000000000580985 in php_module_startup (sf=<value optimized out>, additional_modules=<value optimized out>, num_additional_modules=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/main/main.c:2197 #7 0x000000000067aec5 in php_cgi_startup (sapi_module=<value optimized out>) at /usr/src/debug/php-7.0.0RC8/sapi/fpm/fpm/fpm_main.c:837 #8 0x000000000067bcfe in main (argc=2, argv=0x7fff1a037498) at /usr/src/debug/php-7.0.0RC8/sapi/fpm/fpm/fpm_main.c:1788 \u81f3\u6b64\uff0c\u6574\u4e2a\u8ffd\u8e2a\u8fc7\u7a0b\u7ed3\u675f\u3002","title":"4\u3001\u8ffd\u8e2a"},{"location":"other/%E5%AE%89%E8%A3%85php7/","tags":"php7","text":"\u63a8\u8350\u7528\u963f\u91cc\u4e91\u4e3b\u673a\uff0c\u8bbf\u95ee\u56fd\u5916\u98de\u901f\u3002 git clone https://git.php.net/repository/php-src.git yum install -y gcc gcc-c++ make zlib zlib-devel pcre pcre-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel openssl openssl-devel openldap openldap-devel nss_ldap openldap-clients openldap-servers curl-devel libXpm-devel libc-client-devel re2c bison bison-devel libmcrypt libmcrypt-devel libcurl libcurl-devel ./buildconf ./configure --prefix = /usr/local/php7 --with-config-file-path = /usr/local/php7/etc --with-mcrypt = /usr/include --with-mysql-sock = /var/lib/mysql/mysql.sock --with-mysqli = mysqlnd --with-pdo-mysql = mysqlnd --with-gd --with-iconv --with-zlib --enable-xml --enable-mysqlnd --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-fpm --enable-mbstring --enable-ftp --enable-gd-native-ttf --with-openssl --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --without-pear --with-gettext --enable-session --with-curl --with-jpeg-dir --with-freetype-dir --enable-opcache --enable-debug make && make install \u8f6f\u8fde\u63a5 ln -s /usr/local/php7/bin/php /usr/bin/php \u5728\u5b89\u88c5\u76ee\u5f55\u4e0b\u6709\u4e24\u4e2aphp\u7684\u914d\u7f6e\u9879\uff0cphp.ini-development\u548cphp.ini-production,\u4e00\u4e2a\u662f\u5f00\u53d1\u73af\u5883\u7528\u7684\uff0c\u4e00\u4e2a\u7ebf\u4e0a\u73af\u5883\u7528\u7684\uff0c\u6539\u540dphp.ini\u5e76\u79fb\u5230/usr/local/php/etc\u76ee\u5f55\u3002 php -v ```php PHP 7.0.0-dev (cli) (built: Mar 20 2015 20:04:04) Copyright (c) 1997-2015 The PHP Group Zend Engine v3.0.0-dev, Copyright (c) 1998-2015 Zend Technologies ```","title":"\u5b89\u88c5php7"},{"location":"other/%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C/","tags":"\u8fdb\u7a0b","text":"\u5e76\u53d1(Concurrently)\u548c\u5e76\u884c(Parallel)\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u6982\u5ff5\u3002\u501f\u7528Go\u521b\u59cb\u4ebaRob Pike\u7684\u8bf4\u6cd5\uff0c\u5e76\u53d1\u4e0d\u662f\u5e76\u884c\uff0c\u5e76\u53d1\u66f4\u597d\u3002 \u5e76\u53d1\u662f\u4e00\u5171\u8981\u5904\u7406(deal with)\u5f88\u591a\u4e8b\u60c5\uff0c\u5e76\u884c\u662f\u4e00\u6b21\u53ef\u4ee5\u505a(do)\u591a\u5c11\u4e8b\u60c5\u3002 \u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u534e\u7f57\u5e9a\u6ce1\u8336\uff0c\u5fc5\u987b\u6709\u70e7\u6c34\u3001\u6d17\u676f\u5b50\u3001\u62ff\u8336\u53f6\u7b49\u6b65\u9aa4\u3002\u73b0\u5728\u6211\u4eec\u60f3\u5c3d\u5feb\u505a\u5b8c\u8fd9\u4ef6\u4e8b\uff0c\u4e5f\u5c31\u662f\u201c\u4e00\u5171\u8981\u5904\u7406\u5f88\u591a\u4e8b\u60c5\u201d\uff0c\u6709\u5f88\u591a\u65b9\u6cd5\u53ef\u4ee5\u5b9e\u73b0\u5e76\u53d1\uff0c\u4f8b\u5982\u8bf7\u591a\u4e2a\u4eba\u540c\u65f6\u505a\uff0c\u8fd9\u5c31\u662f\u5e76\u884c\u3002\u5e76\u884c\u662f\u5b9e\u73b0\u5e76\u53d1\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u4f46\u4e0d\u662f\u552f\u4e00\u7684\u65b9\u5f0f\u3002\u6211\u4eec\u4e00\u4e2a\u4eba\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u5e76\u53d1\uff0c\u4f8b\u5982\u5148\u70e7\u6c34\u3001\u7136\u540e\u4e0d\u7528\u7b49\u6c34\u70e7\u5f00\u5c31\u53bb\u6d17\u676f\u5b50\uff0c\u6240\u4ee5\u901a\u8fc7\u8c03\u6574\u7a0b\u5e8f\u8fd0\u884c\u65b9\u5f0f\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u5e76\u53d1\u3002 \u5927\u795e\u8bb2\u89e3 \u5982\u679c\u8fd8\u4e0d\u7406\u89e3\uff0c\u5efa\u8bae\u770bRob Pike\u9898\u4e3aConcurrency is not Parallelism\u7684 \u6f14\u8bb2PPT \u548c \u6f14\u8bb2\u89c6\u9891 \u3002 \u6211\u628a\u6f14\u8bb2\u7684PPT\u622a\u56fe\u8d34\u51fa\u6765\u65b9\u4fbf\u5927\u5bb6\u7406\u89e3\u3002 \u603b\u7ed3 \u603b\u7ed3\u4e00\u4e0b\uff0c\u5e76\u884c\u662f\u5b9e\u73b0\u5e76\u53d1\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5728\u591a\u6838CPU\u7684\u65f6\u4ee3\uff0c\u5e76\u884c\u662f\u6211\u4eec\u8bbe\u8ba1\u9ad8\u6548\u7a0b\u5e8f\u6240\u8981\u8003\u8651\u7684\uff0c\u90a3\u4e48\u8fdb\u7a0b\u662f\u4e0d\u662f\u8d8a\u591a\u8d8a\u597d\u5462\uff1f","title":"\"\u5e76\u53d1\u4e0e\u5e76\u884c\""},{"location":"other/%E6%88%91%E7%9A%84vim%E9%85%8D%E8%89%B2/","tags":"[vim]","text":"\" Vim color file - blank \" Generated by http://bytefluent.com/vivify 2013-09-24 set background=dark if version > 580 hi clear if exists(\"syntax_on\") syntax reset endif endif set t_Co=256 let g:colors_name = \"blank\" hi IncSearch guifg=#C4BE89 guibg=#000000 guisp=#000000 gui=NONE ctermfg=186 ctermbg=NONE cterm=NONE hi WildMenu guifg=#66D9EF guibg=#000000 guisp=#000000 gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi SignColumn guifg=#A6E22E guibg=#232526 guisp=#232526 gui=NONE ctermfg=112 ctermbg=235 cterm=NONE hi SpecialComment guifg=#465457 guibg=NONE guisp=NONE gui=bold ctermfg=240 ctermbg=NONE cterm=bold hi Typedef guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi Title guifg=#ef5939 guibg=NONE guisp=NONE gui=NONE ctermfg=209 ctermbg=NONE cterm=NONE hi Folded guifg=#00CD00 guibg=NONE guisp=NONE gui=NONE ctermfg=240 ctermbg=NONE cterm=NONE hi PreCondit guifg=#A6E22E guibg=NONE guisp=NONE gui=bold ctermfg=112 ctermbg=NONE cterm=bold hi Include guifg=#A6E22E guibg=NONE guisp=NONE gui=NONE ctermfg=112 ctermbg=NONE cterm=NONE hi Float guifg=#AE81FF guibg=NONE guisp=NONE gui=NONE ctermfg=141 ctermbg=NONE cterm=NONE hi StatusLineNC guifg=#cccccc guibg=#1874CD guisp=#145b7d gui=NONE ctermfg=8 ctermbg=232 cterm=NONE \"hi CTagsMember -- no settings -- hi NonText guifg=#BCBCBC guibg=#3B3A32 guisp=#3B3A32 gui=NONE ctermfg=250 ctermbg=237 cterm=NONE \"hi CTagsGlobalConstant -- no settings -- hi DiffText guifg=NONE guibg=#4C4745 guisp=#4C4745 gui=bold,italic ctermfg=NONE ctermbg=239 cterm=bold hi ErrorMsg guifg=#F92672 guibg=#232526 guisp=#232526 gui=bold ctermfg=197 ctermbg=235 cterm=bold hi Ignore guifg=#808080 guibg=#272822 guisp=#272822 gui=NONE ctermfg=8 ctermbg=235 cterm=NONE hi Debug guifg=#BCA3A3 guibg=NONE guisp=NONE gui=bold ctermfg=138 ctermbg=NONE cterm=bold hi PMenuSbar guifg=NONE guibg=#080808 guisp=#080808 gui=NONE ctermfg=NONE ctermbg=232 cterm=NONE hi Identifier guifg=#FD971F guibg=NONE guisp=NONE gui=NONE ctermfg=208 ctermbg=NONE cterm=NONE hi SpecialChar guifg=#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold hi Conditional guifg=#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold hi StorageClass guifg=#FD971F guibg=NONE guisp=NONE gui=italic ctermfg=208 ctermbg=NONE cterm=NONE hi Todo guifg=#FFFF00 guibg=#272822 guisp=#272822 gui=bold ctermfg=15 ctermbg=235 cterm=bold hi Special guifg=#66D9EF guibg=#272822 guisp=#272822 gui=italic ctermfg=81 ctermbg=235 cterm=NONE hi LineNr guifg=#BCBCBC guibg=#3B3A32 guisp=#3B3A32 gui=NONE ctermfg=250 ctermbg=237 cterm=NONE hi StatusLine guifg=#455354 guibg=#F8F8F2 guisp=#F8F8F2 gui=NONE ctermfg=240 ctermbg=230 cterm=NONE hi Normal guifg=#F8F8F2 guibg=#272822 guisp=#272822 gui=NONE ctermfg=230 ctermbg=235 cterm=NONE hi Label guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE \"hi CTagsImport -- no settings -- hi PMenuSel guifg=NONE guibg=#808080 guisp=#808080 gui=NONE ctermfg=NONE ctermbg=8 cterm=NONE hi Search guifg=#ffffff guibg=#fcaf17 guisp=#fcaf17 gui=NONE ctermfg=15 ctermbg=240 cterm=NONE \"hi CTagsGlobalVariable -- no settings -- hi Delimiter guifg=#8F8F8F guibg=NONE guisp=NONE gui=NONE ctermfg=245 ctermbg=NONE cterm=NONE hi Statement guifg=#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold \"hi SpellRare -- no settings -- \"hi EnumerationValue -- no settings -- hi Comment guifg=#b8a969 guibg=NONE guisp=NONE gui=NONE ctermfg=143 ctermbg=NONE cterm=NONE hi Character guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE \"hi TabLineSel -- no settings -- hi Number guifg=#AE81FF guibg=NONE guisp=NONE gui=NONE ctermfg=141 ctermbg=NONE cterm=NONE hi Boolean guifg=#AE81FF guibg=NONE guisp=NONE gui=NONE ctermfg=141 ctermbg=NONE cterm=NONE hi Operator guifg=#F92672 guibg=NONE guisp=NONE gui=NONE ctermfg=197 ctermbg=NONE cterm=NONE hi CursorLine guifg=NONE guibg=#3E3D32 guisp=#3E3D32 gui=NONE ctermfg=NONE ctermbg=237 cterm=NONE \"hi Union -- no settings -- \"hi TabLineFill -- no settings -- hi Question guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi WarningMsg guifg=#FFFFFF guibg=#333333 guisp=#333333 gui=bold ctermfg=15 ctermbg=236 cterm=bold hi VisualNOS guifg=NONE guibg=#403D3D guisp=#403D3D gui=NONE ctermfg=NONE ctermbg=238 cterm=NONE hi DiffDelete guifg=#960050 guibg=#1E0010 guisp=#1E0010 gui=NONE ctermfg=89 ctermbg=53 cterm=NONE hi ModeMsg guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE hi CursorColumn guifg=NONE guibg=#3E3D32 guisp=#3E3D32 gui=NONE ctermfg=NONE ctermbg=237 cterm=NONE hi Define guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi Function guifg=#A6E22E guibg=NONE guisp=NONE gui=NONE ctermfg=112 ctermbg=NONE cterm=NONE hi FoldColumn guifg=#465457 guibg=#000000 guisp=#000000 gui=NONE ctermfg=240 ctermbg=NONE cterm=NONE hi PreProc guifg=#A6E22E guibg=NONE guisp=NONE gui=NONE ctermfg=112 ctermbg=NONE cterm=NONE \"hi EnumerationName -- no settings -- hi Visual guifg=NONE guibg=#403D3D guisp=#403D3D gui=NONE ctermfg=NONE ctermbg=238 cterm=NONE hi MoreMsg guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE \"hi SpellCap -- no settings -- hi VertSplit guifg=#CCCCCC guibg=#080808 guisp=#080808 gui=bold ctermfg=8 ctermbg=232 cterm=bold hi Exception guifg=#A6E22E guibg=NONE guisp=NONE gui=bold ctermfg=112 ctermbg=NONE cterm=bold hi Keyword guifg=#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold hi Type guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi DiffChange guifg=#89807D guibg=#4C4745 guisp=#4C4745 gui=NONE ctermfg=245 ctermbg=239 cterm=NONE hi Cursor guifg=#000000 guibg=#F8F8F0 guisp=#F8F8F0 gui=NONE ctermfg=NONE ctermbg=230 cterm=NONE \"hi SpellLocal -- no settings -- hi Error guifg=#960050 guibg=#1E0010 guisp=#1E0010 gui=NONE ctermfg=89 ctermbg=53 cterm=NONE hi PMenu guifg=#66D9EF guibg=#000000 guisp=#000000 gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi SpecialKey guifg=#66D9EF guibg=NONE guisp=NONE gui=italic ctermfg=81 ctermbg=NONE cterm=NONE hi Constant guifg=#AE81FF guibg=NONE guisp=NONE gui=bold ctermfg=141 ctermbg=NONE cterm=bold \"hi DefinedName -- no settings -- hi Tag guifg=#F92672 guibg=NONE guisp=NONE gui=italic ctermfg=197 ctermbg=NONE cterm=NONE hi String guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE hi PMenuThumb guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi MatchParen guifg=#000000 guibg=#FD971F guisp=#FD971F gui=bold ctermfg=NONE ctermbg=208 cterm=bold \"hi LocalVariable -- no settings -- hi Repeat guifg=#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold \"hi SpellBad -- no settings -- \"hi CTagsClass -- no settings -- hi Directory guifg=#A6E22E guibg=NONE guisp=NONE gui=bold ctermfg=112 ctermbg=NONE cterm=bold hi Structure guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE hi Macro guifg=#C4BE89 guibg=NONE guisp=NONE gui=italic ctermfg=186 ctermbg=NONE cterm=NONE hi Underlined guifg=#808080 guibg=NONE guisp=NONE gui=underline ctermfg=8 ctermbg=NONE cterm=underline hi DiffAdd guifg=NONE guibg=#13354A guisp=#13354A gui=NONE ctermfg=NONE ctermbg=23 cterm=NONE \"hi TabLine -- no settings -- \"hi clear -- no settings --","title":"\u6211\u7684vim\u914d\u8272"},{"location":"other/%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%E4%BA%86swap/","tags":"swap","text":"\u8fd9\u4e2a\u811a\u672c\u53ef\u4ee5\u65b9\u4fbf\u7684\u67e5\u770b\u54ea\u4e9b\u8fdb\u7a0b\u5360\u7528\u4e86swap\u3002 ############################################################################## # \u811a\u672c\u529f\u80fd \uff1a \u5217\u51fa\u6b63\u5728\u5360\u7528swap\u7684\u8fdb\u7a0b\u3002 ############################################################################### echo -e \"PID\\t\\tSwap\\t\\tProc_Name\" # \u62ff\u51fa/proc\u76ee\u5f55\u4e0b\u6240\u6709\u4ee5\u6570\u5b57\u4e3a\u540d\u7684\u76ee\u5f55\uff08\u8fdb\u7a0b\u540d\u662f\u6570\u5b57\u624d\u662f\u8fdb\u7a0b\uff0c\u5176\u4ed6\u5982sys,net\u7b49\u5b58\u653e\u7684\u662f\u5176\u4ed6\u4fe1\u606f\uff09 for pid in ` ls -l /proc | grep ^d | awk '{ print $9 }' | grep -v [ ^0-9 ] ` do # \u8ba9\u8fdb\u7a0b\u91ca\u653eswap\u7684\u65b9\u6cd5\u53ea\u6709\u4e00\u4e2a\uff1a\u5c31\u662f\u91cd\u542f\u8be5\u8fdb\u7a0b\u3002\u6216\u8005\u7b49\u5176\u81ea\u52a8\u91ca\u653e\u3002\u653e # \u5982\u679c\u8fdb\u7a0b\u4f1a\u81ea\u52a8\u91ca\u653e\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4e0d\u4f1a\u5199\u811a\u672c\u6765\u627e\u4ed6\u4e86\uff0c\u627e\u4ed6\u90fd\u662f\u56e0\u4e3a\u4ed6\u6ca1\u6709\u81ea\u52a8\u91ca\u653e\u3002 # \u6240\u4ee5\u6211\u4eec\u8981\u5217\u51fa\u5360\u7528swap\u5e76\u9700\u8981\u91cd\u542f\u7684\u8fdb\u7a0b\uff0c\u4f46\u662finit\u8fd9\u4e2a\u8fdb\u7a0b\u662f\u7cfb\u7edf\u91cc\u6240\u6709\u8fdb\u7a0b\u7684\u7956\u5148\u8fdb\u7a0b # \u91cd\u542finit\u8fdb\u7a0b\u610f\u5473\u7740\u91cd\u542f\u7cfb\u7edf\uff0c\u8fd9\u662f\u4e07\u4e07\u4e0d\u53ef\u4ee5\u7684\uff0c\u6240\u4ee5\u5c31\u4e0d\u5fc5\u68c0\u6d4b\u4ed6\u4e86\uff0c\u4ee5\u514d\u5bf9\u7cfb\u7edf\u9020\u6210\u5f71\u54cd\u3002 if [ $pid -eq 1 ] ; then continue ; fi grep -q \"Swap\" /proc/ $pid /smaps 2 >/dev/null if [ $? -eq 0 ] ; then swap = $( grep Swap /proc/ $pid /smaps \\ | gawk '{ sum+=$2;} END{ print sum }' ) proc_name = $( ps aux | grep -w \" $pid \" | grep -v grep \\ | awk '{ for(i=11;i<=NF;i++){ printf(\"%s \",$i); }}' ) if [ $swap -gt 0 ] ; then echo -e \" ${ pid } \\t ${ swap } \\t ${ proc_name } \" fi fi done | sort -k2 -n | awk -F '\\t' '{ pid[NR]=$1; size[NR]=$2; name[NR]=$3; } END{ for(id=1;id<=length(pid);id++) { if(size[id]<1024) printf(\"%-10s\\t%15sKB\\t%s\\n\",pid[id],size[id],name[id]); else if(size[id]<1048576) printf(\"%-10s\\t%15.2fMB\\t%s\\n\",pid[id],size[id]/1024,name[id]); else printf(\"%-10s\\t%15.2fGB\\t%s\\n\",pid[id],size[id]/1048576,name[id]); } }'","title":"\"\u67e5\u770b\u54ea\u4e9b\u8fdb\u7a0b\u5360\u7528\u4e86swap\""},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/","tags":"[mysql MHA]","text":"\u5b9e\u9a8c\u7cfb\u7edf\uff1aCentOS 6.7_x86_64\uff084.2.3\uff09 \u5b9e\u9a8c\u524d\u63d0\uff1a\u9632\u706b\u5899\u548cselinux\u90fd\u5173\u95ed \u5b9e\u9a8c\u8bf4\u660e\uff1a\u672c\u5b9e\u9a8c\u5171\u67093\u53f0\u4e3b\u673a\uff0c\u62d3\u6251\u56fe\u5982\u4e0b\u6240\u793a \u4e3b\u673a\u8bf4\u660e\uff1a manager: 172.16.2.99 master: 172.16.115.101 \u5907\u7528master: 172.16.115.102 \u4e5f\u53ef\u4ee5\u52a0\u522b\u7684slave\u3002 \u5b9e\u9a8c\u8f6f\u4ef6\uff1a mha4mysql-manager-0.56-0.el6.noarch.rpm mha4mysql-node-0.56-0.el6.noarch.rpm mysql(mysql-5.5.46-1.el6.remi.x86_64) 1\u3001\u5b89\u88c5\u8f6f\u4ef6 \u00b6 \u4e09\u53f0\u673a\u5668\u90fd\u9700\u8981\u5b89\u88c5mha4mysql-node, master\u548cslave\u8fd8\u9700\u8981\u5b89\u88c5mysql, manager\u53ef\u4ee5\u4e0d\u88c5mysql. \u5f53\u7136manager\u4e5f\u53ef\u4ee5\u7528slave\u673a\u5668\u6765\u505a\u3002 yum install mysql mysql-server epel-release -y rpm -Uvh mha4mysql-node-0.56-0.el6.noarch.rpm manager\u8fd8\u9700\u8981\u5b89\u88c5mha4mysql-manager. yum localinstall mha4mysql-manager-0.56-0.el6.noarch.rpm -y \u7528localinstall\u4f1a\u81ea\u52a8\u5b89\u88c5\u4f9d\u8d56\u3002 2\u3001mysql\u4e3b\u4ece\u914d\u7f6e \u00b6 master\u4e0a\u7f16\u8f91/etc/my.cnf\uff0c\u6dfb\u52a0\u914d\u7f6e \u00b6 # master config server-id = 1 log_bin = mysql-bin log-slave-updates binlog_do_db = drupal slave\u4e0a\u7f16\u8f91/etc/my.cnf,\u6dfb\u52a0\u914d\u7f6e \u00b6 # slave config server-id = 2 log_bin = mysql-bin log-slave-updates binlog_do_db = drupal \u521b\u5efa\u5177\u6709\u590d\u5236\u6743\u9650\u7684\u7528\u6237 \u00b6 GRANT ALL PRIVILEGES ON *.* TO 'replicate' @ '%' IDENTIFIED BY '123456' ; FLUSH PRIVILEGES ; \u8bbe\u7f6eslave \u00b6 mysql -uroot -p123456 mysql> change master to master_host = '172.16.115.101' ,master_port = 3306 ,master_user = 'repl' ,master_password = '123456' ,master_log_file = 'mysql-bin.000001' ,MASTER_LOG_POS = 0 ; mysql> start slave ; \u67e5\u770bmaster/slave\u914d\u7f6e \u00b6 mysql> show master status ; +------------------+----------+--------------+------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | +------------------+----------+--------------+------------------+ | mysql-bin.000001 | 867 | drupal | | +------------------+----------+--------------+------------------+ 1 row in set ( 0 .00 sec ) mysql> show slave status \\G ; *************************** 1 . row *************************** Slave_IO_State: Waiting for master to send event Master_Host: 172 .16.115.101 Master_User: repl Master_Port: 3306 Connect_Retry: 60 Master_Log_File: mysql-bin.000001 Read_Master_Log_Pos: 867 Relay_Log_File: mysqld-relay-bin.000002 Relay_Log_Pos: 1013 Relay_Master_Log_File: mysql-bin.000001 Slave_IO_Running: Yes Slave_SQL_Running: Yes Replicate_Do_DB: drupal Replicate_Ignore_DB: Replicate_Do_Table: Replicate_Ignore_Table: Replicate_Wild_Do_Table: Replicate_Wild_Ignore_Table: Last_Errno: 0 Last_Error: Skip_Counter: 0 Exec_Master_Log_Pos: 867 Relay_Log_Space: 1170 Until_Condition: None Until_Log_File: Until_Log_Pos: 0 Master_SSL_Allowed: No Master_SSL_CA_File: Master_SSL_CA_Path: Master_SSL_Cert: Master_SSL_Cipher: Master_SSL_Key: Seconds_Behind_Master: 0 Master_SSL_Verify_Server_Cert: No Last_IO_Errno: 0 Last_IO_Error: Last_SQL_Errno: 0 Last_SQL_Error: Replicate_Ignore_Server_Ids: Master_Server_Id: 1 1 row in set ( 0 .00 sec ) \u5982\u679cSlave_IO_Running\u548cSlave_SQL_Running\u90fd\u662fYES\uff0c\u8bf4\u660eslave\u670d\u52a1\u5668\u914d\u7f6eOK\u3002 3\u3001MHA\u4f5c\u7528 \u00b6 1\uff09\u4ece\u5b95\u673a\u5d29\u6e83\u7684master\u4fdd\u5b58\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff08binlog events\uff09; 2\uff09\u8bc6\u522b\u542b\u6709\u6700\u65b0\u66f4\u65b0\u7684slave\uff1b 3\uff09\u5e94\u7528\u5dee\u5f02\u7684\u4e2d\u7ee7\u65e5\u5fd7\uff08relay log\uff09\u5230\u5176\u4ed6\u7684slave\uff1b 4\uff09\u5e94\u7528\u4ecemaster\u4fdd\u5b58\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff08binlog events\uff09\uff1b 5\uff09\u63d0\u5347\u4e00\u4e2aslave\u4e3a\u65b0\u7684master\uff1b 6\uff09\u4f7f\u5176\u4ed6\u7684slave\u8fde\u63a5\u65b0\u7684master\u8fdb\u884c\u590d\u5236\uff1b MHA\u8f6f\u4ef6\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0cManager\u5de5\u5177\u5305\u548cNode\u5de5\u5177\u5305\uff0c\u5177\u4f53\u7684\u8bf4\u660e\u5982\u4e0b\u3002 Manager\u5de5\u5177\u5305\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u5de5\u5177\uff1a masterha_check_ssh \u68c0\u67e5MHA\u7684SSH\u914d\u7f6e\u72b6\u51b5 masterha_check_repl \u68c0\u67e5MySQL\u590d\u5236\u72b6\u51b5 masterha_manger \u542f\u52a8MHA masterha_check_status \u68c0\u6d4b\u5f53\u524dMHA\u8fd0\u884c\u72b6\u6001 masterha_master_monitor \u68c0\u6d4bmaster\u662f\u5426\u5b95\u673a masterha_master_switch \u63a7\u5236\u6545\u969c\u8f6c\u79fb\uff08\u81ea\u52a8\u6216\u8005\u624b\u52a8\uff09 masterha_conf_host \u6dfb\u52a0\u6216\u5220\u9664\u914d\u7f6e\u7684server\u4fe1\u606f Node\u5de5\u5177\u5305\uff08\u8fd9\u4e9b\u5de5\u5177\u901a\u5e38\u7531MHA Manager\u7684\u811a\u672c\u89e6\u53d1\uff0c\u65e0\u9700\u4eba\u4e3a\u64cd\u4f5c\uff09\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u5de5\u5177\uff1a save_binary_logs \u4fdd\u5b58\u548c\u590d\u5236master\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7 apply_diff_relay_logs \u8bc6\u522b\u5dee\u5f02\u7684\u4e2d\u7ee7\u65e5\u5fd7\u4e8b\u4ef6\u5e76\u5c06\u5176\u5dee\u5f02\u7684\u4e8b\u4ef6\u5e94\u7528\u4e8e\u5176\u4ed6\u7684slave filter_mysqlbinlog \u53bb\u9664\u4e0d\u5fc5\u8981\u7684ROLLBACK\u4e8b\u4ef6\uff08MHA\u5df2\u4e0d\u518d\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\uff09 purge_relay_logs \u6e05\u9664\u4e2d\u7ee7\u65e5\u5fd7\uff08\u4e0d\u4f1a\u963b\u585eSQL\u7ebf\u7a0b\uff09 4\u3001\u914d\u7f6eMHA \u00b6 \u521b\u5efaMHA\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u5e76\u4e14\u521b\u5efa\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff08\u5728\u8f6f\u4ef6\u5305\u89e3\u538b\u540e\u7684\u76ee\u5f55\u91cc\u9762\u6709\u6837\u4f8b\u914d\u7f6e\u6587\u4ef6\uff09 \u00b6 [ root@172.16.2.99 ~ ] # vim /etc/masterha/app1.cnf [ server default ] manager_log = /var/log/mha/app1/manager.log //\u8bbe\u7f6emanager\u7684\u65e5\u5fd7 manager_workdir = /var/log/mha/app1.log //\u8bbe\u7f6emanager\u7684\u5de5\u4f5c\u76ee\u5f55 master_binlog_dir = /var/lib/mysql //\u8bbe\u7f6emaster \u4fdd\u5b58binlog\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbfMHA\u53ef\u4ee5\u627e\u5230master\u7684\u65e5\u5fd7\uff0c\u6211\u8fd9\u91cc\u7684\u4e5f\u5c31\u662fmysql\u7684\u6570\u636e\u76ee\u5f55 user = repl //\u8bbe\u7f6e\u76d1\u63a7\u7528\u6237root password = 123456 //\u8bbe\u7f6emysql\u4e2droot\u7528\u6237\u7684\u5bc6\u7801\uff0c\u8fd9\u4e2a\u5bc6\u7801\u662f\u524d\u6587\u4e2d\u521b\u5efa\u76d1\u63a7\u7528\u6237\u7684\u90a3\u4e2a\u5bc6\u7801 ssh_user = root //\u8bbe\u7f6essh\u7684\u767b\u5f55\u7528\u6237\u540d repl_user = repl //\u8bbe\u7f6e\u590d\u5236\u73af\u5883\u4e2d\u7684\u590d\u5236\u7528\u6237\u540d repl_password = 123456 //\u8bbe\u7f6e\u590d\u5236\u7528\u6237\u7684\u5bc6\u7801 ping_interval = 10 //\u8bbe\u7f6e\u76d1\u63a7\u4e3b\u5e93\uff0c\u53d1\u9001ping\u5305\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u9ed8\u8ba4\u662f3\u79d2\uff0c\u5c1d\u8bd5\u4e09\u6b21\u6ca1\u6709\u56de\u5e94\u7684\u65f6\u5019\u81ea\u52a8\u8fdb\u884crailover shutdown_script = \"\" //\u8bbe\u7f6e\u6545\u969c\u53d1\u751f\u540e\u5173\u95ed\u6545\u969c\u4e3b\u673a\u811a\u672c\uff08\u8be5\u811a\u672c\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5173\u95ed\u4e3b\u673a\u653e\u5728\u53d1\u751f\u8111\u88c2,\u8fd9\u91cc\u6ca1\u6709\u4f7f\u7528\uff09 master_ip_online_change_script = \"\" //\u8bbe\u7f6e\u624b\u52a8\u5207\u6362\u65f6\u5019\u7684\u5207\u6362\u811a\u672c report_script = \"/usr/bin/masterha_report_script\" //\u8bbe\u7f6e\u53d1\u751f\u5207\u6362\u540e\u53d1\u9001\u7684\u62a5\u8b66\u7684\u811a\u672c master_ip_failover_script = \"/usr/bin/masterha_ip_failover\" //\u8bbe\u7f6e\u81ea\u52a8failover\u65f6\u5019\u7684\u5207\u6362\u811a\u672c [ server1 ] hostname = 172 .16.115.101 [ server2 ] hostname = 172 .16.115.102 candidate_master = 1 //\u8bbe\u7f6e\u4e3a\u5019\u9009master\uff0c\u5982\u679c\u8bbe\u7f6e\u8be5\u53c2\u6570\u4ee5\u540e\uff0c\u53d1\u751f\u4e3b\u4ece\u5207\u6362\u4ee5\u540e\u5c06\u4f1a\u5c06\u6b64\u4ece\u5e93\u63d0\u5347\u4e3a\u4e3b\u5e93\uff0c\u5373\u4f7f\u8fd9\u4e2a\u4e3b\u5e93\u4e0d\u662f\u96c6\u7fa4\u4e2d\u65f6\u95f4\u6700\u65b0\u7684slave check_repl_delay = 0 //\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5982\u679c\u4e00\u4e2aslave\u843d\u540emaster 100M\u7684relay logs\u7684\u8bdd\uff0cMHA\u5c06\u4e0d\u4f1a\u9009\u62e9\u8be5slave\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u7684master\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fd9\u4e2aslave\u7684\u6062\u590d\u9700\u8981\u82b1\u8d39\u5f88\u957f\u65f6\u95f4\uff0c\u901a\u8fc7\u8bbe\u7f6echeck_repl_delay = 0 ,MHA\u89e6\u53d1\u5207\u6362\u5728\u9009\u62e9\u4e00\u4e2a\u65b0\u7684master\u7684\u65f6\u5019\u5c06\u4f1a\u5ffd\u7565\u590d\u5236\u5ef6\u65f6\uff0c\u8fd9\u4e2a\u53c2\u6570\u5bf9\u4e8e\u8bbe\u7f6e\u4e86candidate_master = 1\u7684\u4e3b\u673a\u975e\u5e38\u6709\u7528\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5019\u9009\u4e3b\u5728\u5207\u6362\u7684\u8fc7\u7a0b\u4e2d\u4e00\u5b9a\u662f\u65b0\u7684master \u8bbe\u7f6erelay log\u7684\u6e05\u9664\u65b9\u5f0f\uff08\u5728\u6bcf\u4e2aslave\u8282\u70b9\u4e0a\uff09\uff1a \u00b6 [ root@192.168.115.102 ~ ] # mysql -e 'set global relay_log_purge=0' \u6ce8\u610f\uff1a MHA\u5728\u53d1\u751f\u5207\u6362\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4ece\u5e93\u7684\u6062\u590d\u8fc7\u7a0b\u4e2d\u4f9d\u8d56\u4e8erelay log\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6240\u4ee5\u8fd9\u91cc\u8981\u5c06relay log\u7684\u81ea\u52a8\u6e05\u9664\u8bbe\u7f6e\u4e3aOFF\uff0c\u91c7\u7528\u624b\u52a8\u6e05\u9664relay log\u7684\u65b9\u5f0f\u3002\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ece\u670d\u52a1\u5668\u4e0a\u7684\u4e2d\u7ee7\u65e5\u5fd7\u4f1a\u5728SQL\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u540e\u88ab\u81ea\u52a8\u5220\u9664\u3002\u4f46\u662f\u5728MHA\u73af\u5883\u4e2d\uff0c\u8fd9\u4e9b\u4e2d\u7ee7\u65e5\u5fd7\u5728\u6062\u590d\u5176\u4ed6\u4ece\u670d\u52a1\u5668\u65f6\u53ef\u80fd\u4f1a\u88ab\u7528\u5230\uff0c\u56e0\u6b64\u9700\u8981\u7981\u7528\u4e2d\u7ee7\u65e5\u5fd7\u7684\u81ea\u52a8\u5220\u9664\u529f\u80fd\u3002\u5b9a\u671f\u6e05\u9664\u4e2d\u7ee7\u65e5\u5fd7\u9700\u8981\u8003\u8651\u5230\u590d\u5236\u5ef6\u65f6\u7684\u95ee\u9898\u3002\u5728ext3\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0b\uff0c\u5220\u9664\u5927\u7684\u6587\u4ef6\u9700\u8981\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u590d\u5236\u5ef6\u65f6\u3002\u4e3a\u4e86\u907f\u514d\u590d\u5236\u5ef6\u65f6\uff0c\u9700\u8981\u6682\u65f6\u4e3a\u4e2d\u7ee7\u65e5\u5fd7\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u56e0\u4e3a\u5728linux\u7cfb\u7edf\u4e2d\u901a\u8fc7\u786c\u94fe\u63a5\u5220\u9664\u5927\u6587\u4ef6\u901f\u5ea6\u4f1a\u5f88\u5feb\u3002\uff08\u5728mysql\u6570\u636e\u5e93\u4e2d\uff0c\u5220\u9664\u5927\u8868\u65f6\uff0c\u901a\u5e38\u4e5f\u91c7\u7528\u5efa\u7acb\u786c\u94fe\u63a5\u7684\u65b9\u5f0f\uff09 MHA\u8282\u70b9\u4e2d\u5305\u542b\u4e86pure_relay_logs\u547d\u4ee4\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u4e3a\u4e2d\u7ee7\u65e5\u5fd7\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u6267\u884cSET GLOBAL relay_log_purge=1,\u7b49\u5f85\u51e0\u79d2\u949f\u4ee5\u4fbfSQL\u7ebf\u7a0b\u5207\u6362\u5230\u65b0\u7684\u4e2d\u7ee7\u65e5\u5fd7\uff0c\u518d\u6267\u884cSET GLOBAL relay_log_purge=0\u3002 pure_relay_logs\u811a\u672c\u53c2\u6570\u5982\u4e0b\u6240\u793a\uff1a --user mysql \u7528\u6237\u540d --password mysql \u5bc6\u7801 --port \u7aef\u53e3\u53f7 --workdir \u6307\u5b9a\u521b\u5efarelay log\u7684\u786c\u94fe\u63a5\u7684\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u662f/var/tmp\uff0c\u7531\u4e8e\u7cfb\u7edf\u4e0d\u540c\u5206\u533a\u521b\u5efa\u786c\u94fe\u63a5\u6587\u4ef6\u4f1a\u5931\u8d25\uff0c\u6545\u9700\u8981\u6267\u884c\u786c\u94fe\u63a5\u5177\u4f53\u4f4d\u7f6e\uff0c\u6210\u529f\u6267\u884c\u811a\u672c\u540e\uff0c\u786c\u94fe\u63a5\u7684\u4e2d\u7ee7\u65e5\u5fd7\u6587\u4ef6\u88ab\u5220\u9664 --disable_relay_log_purge \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679crelay_log_purge = 1 \uff0c\u811a\u672c\u4f1a\u4ec0\u4e48\u90fd\u4e0d\u6e05\u7406\uff0c\u81ea\u52a8\u9000\u51fa\uff0c\u901a\u8fc7\u8bbe\u5b9a\u8fd9\u4e2a\u53c2\u6570\uff0c\u5f53relay_log_purge = 1\u7684\u60c5\u51b5\u4e0b\u4f1a\u5c06relay_log_purge\u8bbe\u7f6e\u4e3a0\u3002\u6e05\u7406relay log\u4e4b\u540e\uff0c\u6700\u540e\u5c06\u53c2\u6570\u8bbe\u7f6e\u4e3aOFF\u3002 \u8bbe\u7f6e\u5b9a\u671f\u6e05\u7406relay\u811a\u672c\uff08\u4e24\u53f0slave\u670d\u52a1\u5668\uff09 \u00b6 [ root@192.168.115.102 ~ ] # cat purge_relay_log.sh #!/bin/bash user = root passwd = 123456 port = 3306 log_dir = '/var/log/masterha' work_dir = '/var/lib/mysql' purge = '/usr/local/bin/purge_relay_logs' if [ ! -d $log_dir ] then mkdir $log_dir -p fi $purge --user = $user --password = $passwd --disable_relay_log_purge --port = $port --workdir = $work_dir >> $log_dir /purge_relay_logs.log 2 > & 1 \u6dfb\u52a0\u5230crontab\u5b9a\u671f\u6267\u884c [ root@192.168.115.102 ~ ] # crontab -l 0 4 * * * /bin/bash /root/purge_relay_log.sh purge_relay_logs\u811a\u672c\u5220\u9664\u4e2d\u7ee7\u65e5\u5fd7\u4e0d\u4f1a\u963b\u585eSQL\u7ebf\u7a0b\u3002\u4e0b\u9762\u6211\u4eec\u624b\u52a8\u6267\u884c\u770b\u770b\u4ec0\u4e48\u60c5\u51b5\u3002 \u00b6 [ root@192.168.115.102 ~ ] # purge_relay_logs --user=root --password=123456 --port=3306 -disable_relay_log_purge --workdir=/data/ 2014 -04-20 15 :47:24: purge_relay_logs script started. Found relay_log.info: /data/mysql/relay-log.info Removing hard linked relay log files server03-relay-bin* under /data/.. done . Current relay log file: /data/mysql/server03-relay-bin.000002 Archiving unused relay log files ( up to /data/mysql/server03-relay-bin.000001 ) ... Creating hard link for /data/mysql/server03-relay-bin.000001 under /data//server03-relay-bin.000001 .. ok. Creating hard links for unused relay log files completed. Executing SET GLOBAL relay_log_purge = 1 ; FLUSH LOGS ; sleeping a few seconds so that SQL thread can delete older relay log files ( if it keeps up ) ; SET GLOBAL relay_log_purge = 0 ; .. ok. Removing hard linked relay log files server03-relay-bin* under /data/.. done . 2014 -04-20 15 :47:27: All relay log purging operations succeeded. 5\u3001SSH\u914d\u7f6e \u00b6 \u8981\u60f3MHA\u987a\u5229\u6267\u884c\u5404\u9879\u4efb\u52a1\uff0c\u8fd8\u5f97\u6253\u901a\u6bcf\u53f0\u673a\u5668\u7684SSH\u3002 [ root@172.16.2.99 app1 ] # ssh-keygen -t rsa [ root@172.16.2.99 app1 ] # ssh-copy-id -i .ssh/id_rsa.pub root@172.16.115.101 ..... \u8bb0\u4f4f\uff0c\u6bcf\u53f0\u673a\u5668\u90fd\u8981\u8ddf\u522b\u7684\u673a\u5668\u6253\u901aSSH\u3002 \u68c0\u67e5MHA Manger\u5230\u6240\u6709MHA Node\u7684SSH\u8fde\u63a5\u72b6\u6001\uff1a [ root@172.16.2.99 app1 ] # masterha_check_ssh --conf=/etc/masterha/app1.cnf Wed Dec 2 14 :42:39 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :42:39 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :42:39 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.101 ( 172 .16.115.101:22 ) to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.102 ( 172 .16.115.102:22 ) to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ info ] All SSH connection tests passed successfully. \u53ef\u4ee5\u770b\u89c1\u5404\u4e2a\u8282\u70b9ssh\u9a8c\u8bc1\u90fd\u662fok\u7684\u3002 6\u3001\u68c0\u67e5\u6574\u4e2a\u590d\u5236\u73af\u5883\u72b6\u51b5 \u00b6 \u901a\u8fc7masterha_check_repl\u811a\u672c\u67e5\u770b\u6574\u4e2a\u96c6\u7fa4\u7684\u72b6\u6001 [ root@172.16.2.99 app1 ] # masterha_check_ssh --conf=/etc/masterha/app1.cnf Wed Dec 2 14 :42:39 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :42:39 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :42:39 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.101 ( 172 .16.115.101:22 ) to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.102 ( 172 .16.115.102:22 ) to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ info ] All SSH connection tests passed successfully. [ root@utn-cz-1-1-s16h2 app1.log ] # masterha_check_repl --conf=/etc/masterha/app1.cnf Wed Dec 2 14 :43:49 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :43:49 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :43:49 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :43:49 2015 - [ info ] MHA::MasterMonitor version 0 .56. Wed Dec 2 14 :43:50 2015 - [ info ] GTID failover mode = 0 Wed Dec 2 14 :43:50 2015 - [ info ] Dead Servers: Wed Dec 2 14 :43:50 2015 - [ info ] Alive Servers: Wed Dec 2 14 :43:50 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] Alive Slaves: Wed Dec 2 14 :43:50 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Version = 5 .5.46-log ( oldest major version between slaves ) log-bin:enabled Wed Dec 2 14 :43:50 2015 - [ info ] Replicating from 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] Primary candidate for the new Master ( candidate_master is set ) Wed Dec 2 14 :43:50 2015 - [ info ] Current Alive Master: 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] Checking slave configurations.. Wed Dec 2 14 :43:50 2015 - [ info ] read_only = 1 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :43:50 2015 - [ warning ] relay_log_purge = 0 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :43:50 2015 - [ info ] Checking replication filtering settings.. Wed Dec 2 14 :43:50 2015 - [ info ] binlog_do_db = drupal, binlog_ignore_db = Wed Dec 2 14 :43:50 2015 - [ info ] Replication filtering check ok. Wed Dec 2 14 :43:50 2015 - [ info ] GTID ( with auto-pos ) is not supported Wed Dec 2 14 :43:50 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :43:51 2015 - [ info ] All SSH connection tests passed successfully. Wed Dec 2 14 :43:51 2015 - [ info ] Checking MHA Node version.. Wed Dec 2 14 :43:51 2015 - [ info ] Version check ok. Wed Dec 2 14 :43:51 2015 - [ info ] Checking SSH publickey authentication settings on the current master.. Wed Dec 2 14 :43:51 2015 - [ info ] HealthCheck: SSH to 172 .16.115.101 is reachable. Wed Dec 2 14 :43:51 2015 - [ info ] Master MHA Node version is 0 .56. Wed Dec 2 14 :43:51 2015 - [ info ] Checking recovery script configurations on 172 .16.115.101 ( 172 .16.115.101:3306 ) .. Wed Dec 2 14 :43:51 2015 - [ info ] Executing command: save_binary_logs --command = test --start_pos = 4 --binlog_dir = /var/lib/mysql --output_file = /var/tmp/save_binary_logs_test --manager_version = 0 .56 --start_file = mysql-bin.000021 Wed Dec 2 14 :43:51 2015 - [ info ] Connecting to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Creating /var/tmp if not exists.. ok. Checking output directory is accessible or not.. ok. Binlog found at /var/lib/mysql, up to mysql-bin.000021 Wed Dec 2 14 :43:52 2015 - [ info ] Binlog setting check done . Wed Dec 2 14 :43:52 2015 - [ info ] Checking SSH publickey authentication and checking recovery script configurations on all alive slave servers.. Wed Dec 2 14 :43:52 2015 - [ info ] Executing command : apply_diff_relay_logs --command = test --slave_user = 'repl' --slave_host = 172 .16.115.102 --slave_ip = 172 .16.115.102 --slave_port = 3306 --workdir = /var/tmp --target_version = 5 .5.46-log --manager_version = 0 .56 --relay_log_info = /var/lib/mysql/relay-log.info --relay_dir = /var/lib/mysql/ --slave_pass = xxx Wed Dec 2 14 :43:52 2015 - [ info ] Connecting to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Checking slave recovery environment settings.. Opening /var/lib/mysql/relay-log.info ... ok. Relay log found at /var/lib/mysql, up to mysqld-relay-bin.000022 Temporary relay log file is /var/lib/mysql/mysqld-relay-bin.000022 Testing mysql connection and privileges.. done . Testing mysqlbinlog output.. done . Cleaning up test file ( s ) .. done . Wed Dec 2 14 :43:52 2015 - [ info ] Slaves settings check done . Wed Dec 2 14 :43:52 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) ( current master ) +--172.16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :43:52 2015 - [ info ] Checking replication health on 172 .16.115.102.. Wed Dec 2 14 :43:52 2015 - [ info ] ok. Wed Dec 2 14 :43:52 2015 - [ info ] Checking master_ip_failover_script status: Wed Dec 2 14 :43:52 2015 - [ info ] /usr/bin/masterha_ip_failover --command = status --ssh_user = root --orig_master_host = 172 .16.115.101 --orig_master_ip = 172 .16.115.101 --orig_master_port = 3306 IN SCRIPT TEST ==== /sbin/ifconfig eth0:0 down == /sbin/ifconfig eth0:0 172 .16.115.200/24 === Checking the Status of the script.. OK Wed Dec 2 14 :43:52 2015 - [ info ] OK. Wed Dec 2 14 :43:52 2015 - [ warning ] shutdown_script is not defined. Wed Dec 2 14 :43:52 2015 - [ info ] Got exit code 0 ( Not master dead ) . MySQL Replication Health is OK. 7\u3001\u68c0\u67e5MHA Manager\u7684\u72b6\u6001 \u00b6 \u901a\u8fc7master_check_status\u811a\u672c\u67e5\u770bManager\u7684\u72b6\u6001\uff1a [ root@172.16.2.99 ~ ] # masterha_check_status --conf=/etc/masterha/app1.cnf app1 is stopped ( 2 :NOT_RUNNING ) . \u6ce8\u610f\uff1a\u5982\u679c\u6b63\u5e38\uff0c\u4f1a\u663e\u793a\"PING_OK\"\uff0c\u5426\u5219\u4f1a\u663e\u793a\"NOT_RUNNING\"\uff0c\u8fd9\u4ee3\u8868MHA\u76d1\u63a7\u6ca1\u6709\u5f00\u542f\u3002 8\u3001\u5f00\u542fMHA Manager\u76d1\u63a7 \u00b6 [ root@172.16.2.99 ~ ] # nohup masterha_manager --conf=/etc/masterha/app1.cnf --ignore_last_failover > /var/log/mha/app1/manager.log < /dev/null 2>&1 & [ 1 ] 7303 \u542f\u52a8\u53c2\u6570\u4ecb\u7ecd\uff1a --remove_dead_master_conf \u8be5\u53c2\u6570\u4ee3\u8868\u5f53\u53d1\u751f\u4e3b\u4ece\u5207\u6362\u540e\uff0c\u8001\u7684\u4e3b\u5e93\u7684ip\u5c06\u4f1a\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u79fb\u9664\u3002 --manger_log \u65e5\u5fd7\u5b58\u653e\u4f4d\u7f6e --ignore_last_failover \u5728\u7f3a\u7701\u60c5\u51b5\u4e0b\uff0c\u5982\u679cMHA\u68c0\u6d4b\u5230\u8fde\u7eed\u53d1\u751f\u5b95\u673a\uff0c\u4e14\u4e24\u6b21\u5b95\u673a\u95f4\u9694\u4e0d\u8db38\u5c0f\u65f6\u7684\u8bdd\uff0c\u5219\u4e0d\u4f1a\u8fdb\u884cFailover\uff0c\u4e4b\u6240\u4ee5\u8fd9\u6837\u9650\u5236\u662f\u4e3a\u4e86\u907f\u514dping-pong\u6548\u5e94\u3002\u8be5\u53c2\u6570\u4ee3\u8868\u5ffd\u7565\u4e0a\u6b21MHA\u89e6\u53d1\u5207\u6362\u4ea7\u751f\u7684\u6587\u4ef6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMHA\u53d1\u751f\u5207\u6362\u540e\u4f1a\u5728\u65e5\u5fd7\u76ee\u5f55\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u6211\u8bbe\u7f6e\u7684/data\u4ea7\u751fapp1.failover.complete\u6587\u4ef6\uff0c\u4e0b\u6b21\u518d\u6b21\u5207\u6362\u7684\u65f6\u5019\u5982\u679c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\u5b58\u5728\u8be5\u6587\u4ef6\u5c06\u4e0d\u5141\u8bb8\u89e6\u53d1\u5207\u6362\uff0c\u9664\u975e\u5728\u7b2c\u4e00\u6b21\u5207\u6362\u540e\u6536\u5230\u5220\u9664\u8be5\u6587\u4ef6\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a--ignore_last_failover\u3002 \u67e5\u770bMHA Manager\u76d1\u63a7\u662f\u5426\u6b63\u5e38\uff1a [ root@172.16.2.99 ~ ] # masterha_check_status --conf=/etc/masterha/app1.cnf app1 ( pid:20386 ) is running ( 0 :PING_OK ) , master:172.16.115.101 \u53ef\u4ee5\u770b\u89c1\u5df2\u7ecf\u5728\u76d1\u63a7\u4e86\uff0c\u800c\u4e14master\u7684\u4e3b\u673a\u4e3a172.16.115.101 9\u3001\u67e5\u770b\u542f\u52a8\u65e5\u5fd7 \u00b6 [ root@172.16.2.99 ~ ] # cat /var/log/mha/app1/manager.log Wed Dec 2 14 :46:37 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :46:37 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :46:37 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :46:37 2015 - [ info ] MHA::MasterMonitor version 0 .56. Wed Dec 2 14 :46:38 2015 - [ info ] GTID failover mode = 0 Wed Dec 2 14 :46:38 2015 - [ info ] Dead Servers: Wed Dec 2 14 :46:38 2015 - [ info ] Alive Servers: Wed Dec 2 14 :46:38 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] Alive Slaves: Wed Dec 2 14 :46:38 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Version = 5 .5.46-log ( oldest major version between slaves ) log-bin:enabled Wed Dec 2 14 :46:38 2015 - [ info ] Replicating from 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] Primary candidate for the new Master ( candidate_master is set ) Wed Dec 2 14 :46:38 2015 - [ info ] Current Alive Master: 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] Checking slave configurations.. Wed Dec 2 14 :46:38 2015 - [ info ] read_only = 1 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :46:38 2015 - [ warning ] relay_log_purge = 0 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :46:38 2015 - [ info ] Checking replication filtering settings.. Wed Dec 2 14 :46:38 2015 - [ info ] binlog_do_db = drupal, binlog_ignore_db = Wed Dec 2 14 :46:38 2015 - [ info ] Replication filtering check ok. Wed Dec 2 14 :46:38 2015 - [ info ] GTID ( with auto-pos ) is not supported Wed Dec 2 14 :46:38 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :46:39 2015 - [ info ] All SSH connection tests passed successfully. Wed Dec 2 14 :46:39 2015 - [ info ] Checking MHA Node version.. Wed Dec 2 14 :46:39 2015 - [ info ] Version check ok. Wed Dec 2 14 :46:39 2015 - [ info ] Checking SSH publickey authentication settings on the current master.. Wed Dec 2 14 :46:39 2015 - [ info ] HealthCheck: SSH to 172 .16.115.101 is reachable. Wed Dec 2 14 :46:39 2015 - [ info ] Master MHA Node version is 0 .56. Wed Dec 2 14 :46:39 2015 - [ info ] Checking recovery script configurations on 172 .16.115.101 ( 172 .16.115.101:3306 ) .. Wed Dec 2 14 :46:39 2015 - [ info ] Executing command: save_binary_logs --command = test --start_pos = 4 --binlog_dir = /var/lib/mysql --output_file = /var/tmp/save_binary_logs_test --manager_version = 0 .56 --start_file = mysql-bin.000021 Wed Dec 2 14 :46:39 2015 - [ info ] Connecting to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Creating /var/tmp if not exists.. ok. Checking output directory is accessible or not.. ok. Binlog found at /var/lib/mysql, up to mysql-bin.000021 Wed Dec 2 14 :46:39 2015 - [ info ] Binlog setting check done . Wed Dec 2 14 :46:39 2015 - [ info ] Checking SSH publickey authentication and checking recovery script configurations on all alive slave servers.. Wed Dec 2 14 :46:39 2015 - [ info ] Executing command : apply_diff_relay_logs --command = test --slave_user = 'repl' --slave_host = 172 .16.115.102 --slave_ip = 172 .16.115.102 --slave_port = 3306 --workdir = /var/tmp --target_version = 5 .5.46-log --manager_version = 0 .56 --relay_log_info = /var/lib/mysql/relay-log.info --relay_dir = /var/lib/mysql/ --slave_pass = xxx Wed Dec 2 14 :46:39 2015 - [ info ] Connecting to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Checking slave recovery environment settings.. Opening /var/lib/mysql/relay-log.info ... ok. Relay log found at /var/lib/mysql, up to mysqld-relay-bin.000022 Temporary relay log file is /var/lib/mysql/mysqld-relay-bin.000022 Testing mysql connection and privileges.. done . Testing mysqlbinlog output.. done . Cleaning up test file ( s ) .. done . Wed Dec 2 14 :46:40 2015 - [ info ] Slaves settings check done . Wed Dec 2 14 :46:40 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) ( current master ) +--172.16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :46:40 2015 - [ info ] Checking master_ip_failover_script status: Wed Dec 2 14 :46:40 2015 - [ info ] /usr/bin/masterha_ip_failover --command = status --ssh_user = root --orig_master_host = 172 .16.115.101 --orig_master_ip = 172 .16.115.101 --orig_master_port = 3306 IN SCRIPT TEST ==== /sbin/ifconfig eth0:0 down == /sbin/ifconfig eth0:0 172 .16.115.200/24 === Checking the Status of the script.. OK Wed Dec 2 14 :46:40 2015 - [ info ] OK. Wed Dec 2 14 :46:40 2015 - [ warning ] shutdown_script is not defined. Wed Dec 2 14 :46:40 2015 - [ info ] Set master ping interval 1 seconds. Wed Dec 2 14 :46:40 2015 - [ warning ] secondary_check_script is not defined. It is highly recommended setting it to check master reachability from two or more routes. Wed Dec 2 14 :46:40 2015 - [ info ] Starting ping health check on 172 .16.115.101 ( 172 .16.115.101:3306 ) .. Wed Dec 2 14 :46:40 2015 - [ info ] Ping ( SELECT ) succeeded, waiting until MySQL doesn ' t respond.. 10\u3001\u914d\u7f6eVIP \u00b6 \u6211\u4eec\u91c7\u7528\u811a\u672c\u7684\u65b9\u5f0f\u53bb\u914d\u7f6evip [ root@172.16.2.99 ~ ] # vim /usr/bin/masterha_ip_failover #!/usr/bin/env perl use strict ; use warnings FATAL = > 'all' ; use Getopt::Long ; my ( $command , $ssh_user , $orig_master_host , $orig_master_ip , $orig_master_port , $new_master_host , $new_master_ip , $new_master_port ) ; my $vip = '172.16.115.200/24' ; my $key = '0' ; my $ssh_start_vip = \"/sbin/ifconfig eth0: $key $vip \" ; my $ssh_stop_vip = \"/sbin/ifconfig eth0: $key down\" ; GetOptions ( 'command=s' = > \\$ command, 'ssh_user=s' = > \\$ ssh_user, 'orig_master_host=s' = > \\$ orig_master_host, 'orig_master_ip=s' = > \\$ orig_master_ip, 'orig_master_port=i' = > \\$ orig_master_port, 'new_master_host=s' = > \\$ new_master_host, 'new_master_ip=s' = > \\$ new_master_ip, 'new_master_port=i' = > \\$ new_master_port, ) ; exit & main () ; sub main { print \"\\n\\nIN SCRIPT TEST==== $ssh_stop_vip == $ssh_start_vip ===\\n\\n\" ; if ( $command eq \"stop\" || $command eq \"stopssh\" ) { my $exit_code = 1 ; eval { print \"Disabling the VIP on old master: $orig_master_host \\n\" ; & stop_vip () ; $exit_code = 0 ; } ; if ( $@ ) { warn \"Got Error: $@ \\n\" ; exit $exit_code ; } exit $exit_code ; } elsif ( $command eq \"start\" ) { my $exit_code = 10 ; eval { print \"Enabling the VIP - $vip on the new master - $new_master_host \\n\" ; & start_vip () ; $exit_code = 0 ; } ; if ( $@ ) { warn $@ ; exit $exit_code ; } exit $exit_code ; } elsif ( $command eq \"status\" ) { print \"Checking the Status of the script.. OK \\n\" ; exit 0 ; } else { & usage () ; exit 1 ; } } sub start_vip () { ` ssh $ssh_user \\@ $new_master_host \\\" $ssh_start_vip \\\" ` ; } sub stop_vip () { return 0 unless ( $ssh_user ) ; ` ssh $ssh_user \\@ $orig_master_host \\\" $ssh_stop_vip \\\" ` ; } sub usage { print \"Usage: master_ip_failover --command=start|stop|stopssh|status --orig_master_host=host --orig_master_ip=ip --orig_master_port=port --new_master_host=host --new_master_ip=ip --new_master_port=port\\n\" ; } 11\u3001\u90ae\u4ef6\u53d1\u9001\u811a\u672csend_report \u00b6 #!/usr/bin/perl # Copyright (C) 2011 DeNA Co.,Ltd. # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License # along with this program; if not, write to the Free Software # Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA ## Note: This is a sample script and is not complete. Modify the script based on your environment. use strict ; use warnings FATAL = > 'all' ; use Mail::Sender ; use Getopt::Long ; #new_master_host and new_slave_hosts are set only when recovering master succeeded my ( $dead_master_host , $new_master_host , $new_slave_hosts , $subject , $body ) ; my $smtp = 'smtp.163.com' ; my $mail_from = 'services@163.com' ; my $mail_user = 'services@163.com' ; my $mail_pass = '123456' ; my $mail_to =[ 'xxx@xxx.cn' ] ; GetOptions ( 'orig_master_host=s' = > \\$ dead_master_host, 'new_master_host=s' = > \\$ new_master_host, 'new_slave_hosts=s' = > \\$ new_slave_hosts, 'subject=s' = > \\$ subject, 'body=s' = > \\$ body, ) ; mailToContacts ( $smtp , $mail_from , $mail_user , $mail_pass , $mail_to , $subject , $body ) ; sub mailToContacts { my ( $smtp , $mail_from , $user , $passwd , $mail_to , $subject , $msg ) = @_ ; open my $DEBUG , \"> /tmp/monitormail.log\" or die \"Can't open the debug file: $! \\n\" ; my $sender = new Mail::Sender { ctype = > 'text/plain; charset=utf-8' , encoding = > 'utf-8' , smtp = > $smtp , from = > $mail_from , auth = > 'LOGIN' , TLS_allowed = > '0' , authid = > $user , authpwd = > $passwd , to = > $mail_to , subject = > $subject , debug = > $DEBUG } ; $sender ->MailMsg ( { msg = > $msg , debug = > $DEBUG } ) or print $Mail ::Sender::Error ; return 1 ; } # Do whatever you want here exit 0 ; 12\u3001\u6d4b\u8bd5 \u00b6 1.\u4e3b\u5e93\u65ad\u7535 2.\u4e3b\u5e93\u65ad\u7f51 3.\u4e3b\u5e93\u91cd\u542f 4.\u4e3b\u5e93\u5173\u673a \u4ee5\u4e0a\u60c5\u51b5\u90fd\u6d4b\u8bd5\u8fc7\u90fd\u80fd\u81ea\u52a8\u5207\u6362~ \u8bf7\u770b\u65e5\u5fd7\u5206\u6790\u5207\u6362\u8fc7\u7a0b 13\u3001\u4e3b\u5e93\u6a21\u62df\u6545\u969c\u540e\u7684\u6062\u590d \u00b6 [ root@172.16.2.99 app1 ] # grep -i \"All other slaves should start\" manager.log Mon Apr 21 22 :28:33 2014 - [ info ] All other slaves should start replication from here. Statement should be: CHANGE MASTER TO MASTER_HOST = '172.16.115.102' , MASTER_PORT = 3306 , MASTER_LOG_FILE = 'mysql-bin.000022' , MASTER_LOG_POS = 506716 , MASTER_USER = 'repl' , MASTER_PASSWORD = 'xxx' ; [ root@192.168.0.20 app1 ] # \u7136\u540e\u518d\u5c31\u5f97\u4e3b\u5e93\u91cc\u6267\u884c\u4e0b,\u518dstart slave ,\u7136\u540e\u5c31\u5f97\u4e3b\u5e93\u5c31\u53d8\u4e3a\u4e86\u65b0\u7684\u4e3b\u5e93\u7684\u4ece\u5e93\u4e86\u3002 \u8bb0\u5f97\u770b\u4e0bshow slave status\\G; 14\u3001\u62a5\u9519\u8bb0\u5f55\u603b\u7ed3 \u00b6 \u6458\u6284\u81eagoogle. \u62a5\u9519\u8bb0\u5f551\uff1a \u00b6 [ root@data01 ~ ] # masterha_check_repl--conf=/etc/masterha/app1.cnf Tue Apr 7 22 :31:06 2015 - [ warning ] Global configuration file/etc/masterha_default.cnf not found. Skipping. Tue Apr 7 22 :31:07 2015 - [ info ] Reading application default configuration from/etc/masterha/app1.cnf.. Tue Apr 7 22 :31:07 2015 - [ info ] Reading server configuration from/etc/masterha/app1.cnf.. Tue Apr 7 22 :31:07 2015 - [ info ] MHA::MasterMonitor version 0 .56. Tue Apr 7 22 :31:07 2015 - [ error ][ /usr/local/share/perl5/MHA/Server.pm,ln303 ] Getting relay log directory orcurrent relay logfile from replication table failed on192.168.52.130 ( 192 .168.52.130:3306 ) ! Tue Apr 7 22 :31:07 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at /usr/local/share/perl5/MHA/ServerManager.pmline 315 Tue Apr 7 22 :31:07 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Tue Apr 7 22 :31:07 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@data01 ~ ] # \u89e3\u51b3\u529e\u6cd5\uff1a\u5728192.168.52.130\u4e0a\u9762\uff0cvim /etc/my.cnf\uff0c\u5728\u91cc\u9762\u6dfb\u52a0 relay-log = /home/data/mysql/binlog/mysql-relay-bin \u7136\u540e\u91cd\u542fmysql\uff0c\u518d\u53bb\u91cd\u65b0\u8bbe\u7f6eslave\u8fde\u63a5\u3002 STOP SLAVE ; RESET SLAVE ; CHANGE MASTER TOMASTER_HOST = '192.168.52.129' ,MASTER_USER = 'repl' ,MASTER_PASSWORD = 'repl_1234' ,MASTER_LOG_FILE = 'mysql-bin.000178' ,MASTER_LOG_POS = 459 ; START SLAVE ; Ok\uff0c\u641e\u5b9a\u4e86\u3002 \u62a5\u9519\u8bb0\u5f552\uff1a \u00b6 [ root@data01 perl ] # masterha_check_repl--conf=/etc/masterha/app1.cnf Thu Apr 9 00 :54:32 2015 - [ warning ] Global configuration file/etc/masterha_default.cnf not found. Skipping. Thu Apr 9 00 :54:32 2015 - [ info ] Reading application default configuration from/etc/masterha/app1.cnf.. Thu Apr 9 00 :54:32 2015 - [ info ] Reading server configuration from/etc/masterha/app1.cnf.. Thu Apr 9 00 :54:32 2015 - [ info ] MHA::MasterMonitor version 0 .56. Thu Apr 9 00 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/Server.pm,ln306 ] Getting relay log directory orcurrent relay logfile from replication table failed on 192 .168.52.130 ( 192 .168.52.130:3306 ) ! Thu Apr 9 00 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at/usr/local/share/perl5/MHA/ServerManager.pm line 315 Thu Apr 9 00 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 00 :54:32 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@data01 perl ] # \u89e3\u51b3\u65b9\u6cd5\uff1a /etc/masterha/app1.cnf\u6587\u4ef6\u91cc\u9762\u7684\u53c2\u6570\u914d\u7f6e\uff0cuser\u548crepl_user\u90fd\u662fmysql\u8d26\u53f7\uff0c\u9700\u8981\u521b\u5efa\u597d\uff0c\u8fd9\u91cc\u662f\u53ea\u521b\u5efa\u4e86repl_user\u800c\u6ca1\u6709\u521b\u5efa\u597duser\u8d26\u53f7\uff1a user = manager password = manager_1234 repl_user = repl repl_password = repl_1234 \u5728mysql\u8282\u70b9\u4e0a\uff0c\u5efa\u7acb\u5141\u8bb8manager \u8bbf\u95ee\u6570\u636e\u5e93\u7684\u201c manager manager \u201d\u8d26\u6237\uff0c\u4e3b\u8981\u7528\u4e8eSHOW SLAVESTATUS,RESET SLAVE; \u6240\u4ee5\u9700\u8981\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a GRANT SUPER,RELOAD,REPLICATIONCLIENT,SELECT ON *.* TO manager@ '192.168.52.%' IDENTIFIED BY 'manager_1234' ; \u9519\u8bef\u8bb0\u5f553\uff1a \u00b6 [ root@oraclem1 ~ ] # masterha_check_repl--conf=/etc/masterha/app1.cnf Thu Apr 9 23 :09:05 2015 - [ warning ] Global configuration file/etc/masterha_default.cnf not found. Skipping. Thu Apr 9 23 :09:05 2015 - [ info ] Reading application default configuration from/etc/masterha/app1.cnf.. Thu Apr 9 23 :09:05 2015 - [ info ] Reading server configuration from/etc/masterha/app1.cnf.. Thu Apr 9 23 :09:05 2015 - [ info ] MHA::MasterMonitor version 0 .56. Thu Apr 9 23 :09:05 2015 - [ error ][ /usr/local/share/perl5/MHA/ServerManager.pm,ln781 ] Multi-master configuration is detected, but two or more masters areeither writable ( read-only is not set ) or dead! Check configurations fordetails. Master configurations are as below: Master 192 .168.52.130 ( 192 .168.52.130:3306 ) ,replicating from 192 .168.52.129 ( 192 .168.52.129:3306 ) Master 192 .168.52.129 ( 192 .168.52.129:3306 ) ,replicating from 192 .168.52.130 ( 192 .168.52.130:3306 ) Thu Apr 9 23 :09:05 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at/usr/local/share/perl5/MHA/MasterMonitor.pm line 326 Thu Apr 9 23 :09:05 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 23 :09:05 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@oraclem1 ~ ] # \u89e3\u51b3\u529e\u6cd5\uff1a mysql> set global read_only = 1 ; Query OK, 0 rows affected ( 0 .00 sec ) mysql> \u62a5\u9519\u8bb0\u5f554\uff1a \u00b6 Thu Apr 9 23 :54:32 2015 - [ info ] Checking SSH publickey authentication andchecking recovery script configurations on all alive slave servers.. Thu Apr 9 23 :54:32 2015 - [ info ] Executing command : apply_diff_relay_logs --command = test--slave_user = 'manager' --slave_host = 192 .168.52.130 --slave_ip = 192 .168.52.130--slave_port = 3306 --workdir = /var/tmp --target_version = 5 .6.12-log--manager_version = 0 .56 --relay_dir = /home/data/mysql/data--current_relay_log = mysqld-relay-bin.000011 --slave_pass = xxx Thu Apr 9 23 :54:32 2015 - [ info ] Connecting to root@192.168.52.130 ( 192 .168.52.130:22 ) .. Can ' t exec \"mysqlbinlog\" : No suchfile or directory at /usr/local/share/perl5/MHA/BinlogManager.pm line 106 . mysqlbinlog version command failed with rc1:0, please verify PATH, LD_LIBRARY_PATH, and client options at/usr/local/bin/apply_diff_relay_logs line 493 Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln205 ] Slaves settings check failed! Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln413 ] Slave configuration failed. Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at /usr/local/bin/masterha_check_repl line 48 Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 23 :54:32 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@oraclem1 ~ ] # \u89e3\u51b3\u529e\u6cd5\uff1a [ root@data02 ~ ] # type mysqlbinlog mysqlbinlog is/usr/local/mysql/bin/mysqlbinlog [ root@data02 ~ ] # [ root@data02 ~ ] # ln -s/usr/local/mysql/bin/mysqlbinlog /usr/bin/mysqlbinlog \u62a5\u9519\u8bb0\u5f555\uff1a \u00b6 Thu Apr 9 23 :57:24 2015 - [ info ] Connecting to root@192.168.52.130 ( 192 .168.52.130:22 ) .. Checking slave recovery environment settings.. Relay log found at /home/data/mysql/data, up to mysqld-relay-bin.000013 Temporary relay log file is /home/data/mysql/data/mysqld-relay-bin.000013 Testing mysql connection and privileges..sh: mysql: command not found mysql command failed with rc 127 :0! at/usr/local/bin/apply_diff_relay_logs line 375 main::check () called at /usr/local/bin/apply_diff_relay_logs line 497 eval { ... } called at /usr/local/bin/apply_diff_relay_logs line 475 main::main () called at /usr/local/bin/apply_diff_relay_logs line 120 Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln205 ] Slaves settings check failed! Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln413 ] Slave configuration failed. Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at /usr/local/bin/masterha_check_repl line 48 Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 23 :57:24 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! \u89e3\u51b3\u529e\u6cd5\uff1a ln -s /usr/local/mysql/bin/mysql/usr/bin/mysql \u62a5\u9519\u8bb0\u5f556\uff1a \u00b6 Fri Apr 10 00 :58:36 2015 - [ info ] Executing command : apply_diff_relay_logs--command = test --slave_user = 'manager' --slave_host = 192 .168.52.130--slave_ip = 192 .168.52.130 --slave_port = 3306 --workdir = /var/tmp--target_version = 5 .6.12-log --manager_version = 0 .56--relay_dir = /home/data/mysql/data--current_relay_log = mysqld-relay-bin.000011 --slave_pass = xxx Fri Apr 10 00 :58:36 2015 - [ info ] Connecting to root@192.168.52.130 ( 192 .168.52.130:22 ) .. Checking slave recovery environment settings.. Relay log found at /home/data/mysql/data, up to mysqld-relay-bin.000013 Temporary relay log file is/home/data/mysql/data/mysqld-relay-bin.000013 Testing mysql connection and privileges..Warning: Using a password onthe command line interface can be insecure. ERROR 1142 ( 42000 ) at line 1 : CREATEcommand denied to user 'manager' @ '192.168.52.130' for table 'apply_diff_relay_logs_test' mysql command failed with rc 1 :0! at/usr/local/bin/apply_diff_relay_logs line 375 main::check () called at /usr/local/bin/apply_diff_relay_logs line 497 eval { ... } called at /usr/local/bin/apply_diff_relay_logs line 475 main::main () called at /usr/local/bin/apply_diff_relay_logs line 120 Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln205 ] Slaves settingscheck failed! Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln413 ] Slave configurationfailed. Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln424 ] Error happened onchecking configurations. at/usr/local/bin/masterha_check_repl line 48 Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln523 ] Error happened onmonitoring servers. Fri Apr 10 00 :58:37 2015 - [ info ] Got exitcode 1 ( Not master dead ) . MySQL Replication Health is NOT OK! \u89e3\u51b3\u529e\u6cd5\uff1a \u6267\u884c\u5982\u4e0b\u6388\u6743\u8bed\u53e5sql\uff1a GRANT CREATE,INSERT,UPDATE,DELETE,DROP ON*.* TO manager@ '192.168.52.%' ; \u5176\u4ed6 \u00b6 \u53e6\u5916\uff0c\u5982\u679cnohup masterha_manager\u6267\u884c\u4e0d\u4e86\uff0c\u8bf7\u68c0\u67e5master\u548cslave\u662f\u5426\u914d\u7f6e\u6b63\u786e\u3002\u53ef\u4ee5\u901a\u8fc7 change master to master_host = '172.16.115.101' ,master_port = 3306 ,master_user = 'repl' ,master_password = '123456' ,master_log_file = 'mysql-bin.000001' ,MASTER_LOG_POS = 0 ; \u91cd\u65b0\u8bbe\u7f6eslave\u3002","title":"\"\u9ad8\u6027\u80fdmysql\u4e3b\u4ece\u67b6\u6784\u53caMHA\u9ad8\u53ef\u7528\u8d1f\u8f7d\u5747\u8861\""},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#1","text":"\u4e09\u53f0\u673a\u5668\u90fd\u9700\u8981\u5b89\u88c5mha4mysql-node, master\u548cslave\u8fd8\u9700\u8981\u5b89\u88c5mysql, manager\u53ef\u4ee5\u4e0d\u88c5mysql. \u5f53\u7136manager\u4e5f\u53ef\u4ee5\u7528slave\u673a\u5668\u6765\u505a\u3002 yum install mysql mysql-server epel-release -y rpm -Uvh mha4mysql-node-0.56-0.el6.noarch.rpm manager\u8fd8\u9700\u8981\u5b89\u88c5mha4mysql-manager. yum localinstall mha4mysql-manager-0.56-0.el6.noarch.rpm -y \u7528localinstall\u4f1a\u81ea\u52a8\u5b89\u88c5\u4f9d\u8d56\u3002","title":"1\u3001\u5b89\u88c5\u8f6f\u4ef6"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#2mysql","text":"","title":"2\u3001mysql\u4e3b\u4ece\u914d\u7f6e"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#masteretcmycnf","text":"# master config server-id = 1 log_bin = mysql-bin log-slave-updates binlog_do_db = drupal","title":"master\u4e0a\u7f16\u8f91/etc/my.cnf\uff0c\u6dfb\u52a0\u914d\u7f6e"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#slaveetcmycnf","text":"# slave config server-id = 2 log_bin = mysql-bin log-slave-updates binlog_do_db = drupal","title":"slave\u4e0a\u7f16\u8f91/etc/my.cnf,\u6dfb\u52a0\u914d\u7f6e"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_1","text":"GRANT ALL PRIVILEGES ON *.* TO 'replicate' @ '%' IDENTIFIED BY '123456' ; FLUSH PRIVILEGES ;","title":"\u521b\u5efa\u5177\u6709\u590d\u5236\u6743\u9650\u7684\u7528\u6237"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#slave","text":"mysql -uroot -p123456 mysql> change master to master_host = '172.16.115.101' ,master_port = 3306 ,master_user = 'repl' ,master_password = '123456' ,master_log_file = 'mysql-bin.000001' ,MASTER_LOG_POS = 0 ; mysql> start slave ;","title":"\u8bbe\u7f6eslave"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#masterslave","text":"mysql> show master status ; +------------------+----------+--------------+------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | +------------------+----------+--------------+------------------+ | mysql-bin.000001 | 867 | drupal | | +------------------+----------+--------------+------------------+ 1 row in set ( 0 .00 sec ) mysql> show slave status \\G ; *************************** 1 . row *************************** Slave_IO_State: Waiting for master to send event Master_Host: 172 .16.115.101 Master_User: repl Master_Port: 3306 Connect_Retry: 60 Master_Log_File: mysql-bin.000001 Read_Master_Log_Pos: 867 Relay_Log_File: mysqld-relay-bin.000002 Relay_Log_Pos: 1013 Relay_Master_Log_File: mysql-bin.000001 Slave_IO_Running: Yes Slave_SQL_Running: Yes Replicate_Do_DB: drupal Replicate_Ignore_DB: Replicate_Do_Table: Replicate_Ignore_Table: Replicate_Wild_Do_Table: Replicate_Wild_Ignore_Table: Last_Errno: 0 Last_Error: Skip_Counter: 0 Exec_Master_Log_Pos: 867 Relay_Log_Space: 1170 Until_Condition: None Until_Log_File: Until_Log_Pos: 0 Master_SSL_Allowed: No Master_SSL_CA_File: Master_SSL_CA_Path: Master_SSL_Cert: Master_SSL_Cipher: Master_SSL_Key: Seconds_Behind_Master: 0 Master_SSL_Verify_Server_Cert: No Last_IO_Errno: 0 Last_IO_Error: Last_SQL_Errno: 0 Last_SQL_Error: Replicate_Ignore_Server_Ids: Master_Server_Id: 1 1 row in set ( 0 .00 sec ) \u5982\u679cSlave_IO_Running\u548cSlave_SQL_Running\u90fd\u662fYES\uff0c\u8bf4\u660eslave\u670d\u52a1\u5668\u914d\u7f6eOK\u3002","title":"\u67e5\u770bmaster/slave\u914d\u7f6e"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#3mha","text":"1\uff09\u4ece\u5b95\u673a\u5d29\u6e83\u7684master\u4fdd\u5b58\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff08binlog events\uff09; 2\uff09\u8bc6\u522b\u542b\u6709\u6700\u65b0\u66f4\u65b0\u7684slave\uff1b 3\uff09\u5e94\u7528\u5dee\u5f02\u7684\u4e2d\u7ee7\u65e5\u5fd7\uff08relay log\uff09\u5230\u5176\u4ed6\u7684slave\uff1b 4\uff09\u5e94\u7528\u4ecemaster\u4fdd\u5b58\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff08binlog events\uff09\uff1b 5\uff09\u63d0\u5347\u4e00\u4e2aslave\u4e3a\u65b0\u7684master\uff1b 6\uff09\u4f7f\u5176\u4ed6\u7684slave\u8fde\u63a5\u65b0\u7684master\u8fdb\u884c\u590d\u5236\uff1b MHA\u8f6f\u4ef6\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0cManager\u5de5\u5177\u5305\u548cNode\u5de5\u5177\u5305\uff0c\u5177\u4f53\u7684\u8bf4\u660e\u5982\u4e0b\u3002 Manager\u5de5\u5177\u5305\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u5de5\u5177\uff1a masterha_check_ssh \u68c0\u67e5MHA\u7684SSH\u914d\u7f6e\u72b6\u51b5 masterha_check_repl \u68c0\u67e5MySQL\u590d\u5236\u72b6\u51b5 masterha_manger \u542f\u52a8MHA masterha_check_status \u68c0\u6d4b\u5f53\u524dMHA\u8fd0\u884c\u72b6\u6001 masterha_master_monitor \u68c0\u6d4bmaster\u662f\u5426\u5b95\u673a masterha_master_switch \u63a7\u5236\u6545\u969c\u8f6c\u79fb\uff08\u81ea\u52a8\u6216\u8005\u624b\u52a8\uff09 masterha_conf_host \u6dfb\u52a0\u6216\u5220\u9664\u914d\u7f6e\u7684server\u4fe1\u606f Node\u5de5\u5177\u5305\uff08\u8fd9\u4e9b\u5de5\u5177\u901a\u5e38\u7531MHA Manager\u7684\u811a\u672c\u89e6\u53d1\uff0c\u65e0\u9700\u4eba\u4e3a\u64cd\u4f5c\uff09\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u5de5\u5177\uff1a save_binary_logs \u4fdd\u5b58\u548c\u590d\u5236master\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7 apply_diff_relay_logs \u8bc6\u522b\u5dee\u5f02\u7684\u4e2d\u7ee7\u65e5\u5fd7\u4e8b\u4ef6\u5e76\u5c06\u5176\u5dee\u5f02\u7684\u4e8b\u4ef6\u5e94\u7528\u4e8e\u5176\u4ed6\u7684slave filter_mysqlbinlog \u53bb\u9664\u4e0d\u5fc5\u8981\u7684ROLLBACK\u4e8b\u4ef6\uff08MHA\u5df2\u4e0d\u518d\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\uff09 purge_relay_logs \u6e05\u9664\u4e2d\u7ee7\u65e5\u5fd7\uff08\u4e0d\u4f1a\u963b\u585eSQL\u7ebf\u7a0b\uff09","title":"3\u3001MHA\u4f5c\u7528"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#4mha","text":"","title":"4\u3001\u914d\u7f6eMHA"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#mha","text":"[ root@172.16.2.99 ~ ] # vim /etc/masterha/app1.cnf [ server default ] manager_log = /var/log/mha/app1/manager.log //\u8bbe\u7f6emanager\u7684\u65e5\u5fd7 manager_workdir = /var/log/mha/app1.log //\u8bbe\u7f6emanager\u7684\u5de5\u4f5c\u76ee\u5f55 master_binlog_dir = /var/lib/mysql //\u8bbe\u7f6emaster \u4fdd\u5b58binlog\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbfMHA\u53ef\u4ee5\u627e\u5230master\u7684\u65e5\u5fd7\uff0c\u6211\u8fd9\u91cc\u7684\u4e5f\u5c31\u662fmysql\u7684\u6570\u636e\u76ee\u5f55 user = repl //\u8bbe\u7f6e\u76d1\u63a7\u7528\u6237root password = 123456 //\u8bbe\u7f6emysql\u4e2droot\u7528\u6237\u7684\u5bc6\u7801\uff0c\u8fd9\u4e2a\u5bc6\u7801\u662f\u524d\u6587\u4e2d\u521b\u5efa\u76d1\u63a7\u7528\u6237\u7684\u90a3\u4e2a\u5bc6\u7801 ssh_user = root //\u8bbe\u7f6essh\u7684\u767b\u5f55\u7528\u6237\u540d repl_user = repl //\u8bbe\u7f6e\u590d\u5236\u73af\u5883\u4e2d\u7684\u590d\u5236\u7528\u6237\u540d repl_password = 123456 //\u8bbe\u7f6e\u590d\u5236\u7528\u6237\u7684\u5bc6\u7801 ping_interval = 10 //\u8bbe\u7f6e\u76d1\u63a7\u4e3b\u5e93\uff0c\u53d1\u9001ping\u5305\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u9ed8\u8ba4\u662f3\u79d2\uff0c\u5c1d\u8bd5\u4e09\u6b21\u6ca1\u6709\u56de\u5e94\u7684\u65f6\u5019\u81ea\u52a8\u8fdb\u884crailover shutdown_script = \"\" //\u8bbe\u7f6e\u6545\u969c\u53d1\u751f\u540e\u5173\u95ed\u6545\u969c\u4e3b\u673a\u811a\u672c\uff08\u8be5\u811a\u672c\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5173\u95ed\u4e3b\u673a\u653e\u5728\u53d1\u751f\u8111\u88c2,\u8fd9\u91cc\u6ca1\u6709\u4f7f\u7528\uff09 master_ip_online_change_script = \"\" //\u8bbe\u7f6e\u624b\u52a8\u5207\u6362\u65f6\u5019\u7684\u5207\u6362\u811a\u672c report_script = \"/usr/bin/masterha_report_script\" //\u8bbe\u7f6e\u53d1\u751f\u5207\u6362\u540e\u53d1\u9001\u7684\u62a5\u8b66\u7684\u811a\u672c master_ip_failover_script = \"/usr/bin/masterha_ip_failover\" //\u8bbe\u7f6e\u81ea\u52a8failover\u65f6\u5019\u7684\u5207\u6362\u811a\u672c [ server1 ] hostname = 172 .16.115.101 [ server2 ] hostname = 172 .16.115.102 candidate_master = 1 //\u8bbe\u7f6e\u4e3a\u5019\u9009master\uff0c\u5982\u679c\u8bbe\u7f6e\u8be5\u53c2\u6570\u4ee5\u540e\uff0c\u53d1\u751f\u4e3b\u4ece\u5207\u6362\u4ee5\u540e\u5c06\u4f1a\u5c06\u6b64\u4ece\u5e93\u63d0\u5347\u4e3a\u4e3b\u5e93\uff0c\u5373\u4f7f\u8fd9\u4e2a\u4e3b\u5e93\u4e0d\u662f\u96c6\u7fa4\u4e2d\u65f6\u95f4\u6700\u65b0\u7684slave check_repl_delay = 0 //\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5982\u679c\u4e00\u4e2aslave\u843d\u540emaster 100M\u7684relay logs\u7684\u8bdd\uff0cMHA\u5c06\u4e0d\u4f1a\u9009\u62e9\u8be5slave\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u7684master\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fd9\u4e2aslave\u7684\u6062\u590d\u9700\u8981\u82b1\u8d39\u5f88\u957f\u65f6\u95f4\uff0c\u901a\u8fc7\u8bbe\u7f6echeck_repl_delay = 0 ,MHA\u89e6\u53d1\u5207\u6362\u5728\u9009\u62e9\u4e00\u4e2a\u65b0\u7684master\u7684\u65f6\u5019\u5c06\u4f1a\u5ffd\u7565\u590d\u5236\u5ef6\u65f6\uff0c\u8fd9\u4e2a\u53c2\u6570\u5bf9\u4e8e\u8bbe\u7f6e\u4e86candidate_master = 1\u7684\u4e3b\u673a\u975e\u5e38\u6709\u7528\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5019\u9009\u4e3b\u5728\u5207\u6362\u7684\u8fc7\u7a0b\u4e2d\u4e00\u5b9a\u662f\u65b0\u7684master","title":"\u521b\u5efaMHA\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u5e76\u4e14\u521b\u5efa\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff08\u5728\u8f6f\u4ef6\u5305\u89e3\u538b\u540e\u7684\u76ee\u5f55\u91cc\u9762\u6709\u6837\u4f8b\u914d\u7f6e\u6587\u4ef6\uff09"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#relay-logslave","text":"[ root@192.168.115.102 ~ ] # mysql -e 'set global relay_log_purge=0' \u6ce8\u610f\uff1a MHA\u5728\u53d1\u751f\u5207\u6362\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4ece\u5e93\u7684\u6062\u590d\u8fc7\u7a0b\u4e2d\u4f9d\u8d56\u4e8erelay log\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6240\u4ee5\u8fd9\u91cc\u8981\u5c06relay log\u7684\u81ea\u52a8\u6e05\u9664\u8bbe\u7f6e\u4e3aOFF\uff0c\u91c7\u7528\u624b\u52a8\u6e05\u9664relay log\u7684\u65b9\u5f0f\u3002\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4ece\u670d\u52a1\u5668\u4e0a\u7684\u4e2d\u7ee7\u65e5\u5fd7\u4f1a\u5728SQL\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u540e\u88ab\u81ea\u52a8\u5220\u9664\u3002\u4f46\u662f\u5728MHA\u73af\u5883\u4e2d\uff0c\u8fd9\u4e9b\u4e2d\u7ee7\u65e5\u5fd7\u5728\u6062\u590d\u5176\u4ed6\u4ece\u670d\u52a1\u5668\u65f6\u53ef\u80fd\u4f1a\u88ab\u7528\u5230\uff0c\u56e0\u6b64\u9700\u8981\u7981\u7528\u4e2d\u7ee7\u65e5\u5fd7\u7684\u81ea\u52a8\u5220\u9664\u529f\u80fd\u3002\u5b9a\u671f\u6e05\u9664\u4e2d\u7ee7\u65e5\u5fd7\u9700\u8981\u8003\u8651\u5230\u590d\u5236\u5ef6\u65f6\u7684\u95ee\u9898\u3002\u5728ext3\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0b\uff0c\u5220\u9664\u5927\u7684\u6587\u4ef6\u9700\u8981\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u590d\u5236\u5ef6\u65f6\u3002\u4e3a\u4e86\u907f\u514d\u590d\u5236\u5ef6\u65f6\uff0c\u9700\u8981\u6682\u65f6\u4e3a\u4e2d\u7ee7\u65e5\u5fd7\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u56e0\u4e3a\u5728linux\u7cfb\u7edf\u4e2d\u901a\u8fc7\u786c\u94fe\u63a5\u5220\u9664\u5927\u6587\u4ef6\u901f\u5ea6\u4f1a\u5f88\u5feb\u3002\uff08\u5728mysql\u6570\u636e\u5e93\u4e2d\uff0c\u5220\u9664\u5927\u8868\u65f6\uff0c\u901a\u5e38\u4e5f\u91c7\u7528\u5efa\u7acb\u786c\u94fe\u63a5\u7684\u65b9\u5f0f\uff09 MHA\u8282\u70b9\u4e2d\u5305\u542b\u4e86pure_relay_logs\u547d\u4ee4\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u4e3a\u4e2d\u7ee7\u65e5\u5fd7\u521b\u5efa\u786c\u94fe\u63a5\uff0c\u6267\u884cSET GLOBAL relay_log_purge=1,\u7b49\u5f85\u51e0\u79d2\u949f\u4ee5\u4fbfSQL\u7ebf\u7a0b\u5207\u6362\u5230\u65b0\u7684\u4e2d\u7ee7\u65e5\u5fd7\uff0c\u518d\u6267\u884cSET GLOBAL relay_log_purge=0\u3002 pure_relay_logs\u811a\u672c\u53c2\u6570\u5982\u4e0b\u6240\u793a\uff1a --user mysql \u7528\u6237\u540d --password mysql \u5bc6\u7801 --port \u7aef\u53e3\u53f7 --workdir \u6307\u5b9a\u521b\u5efarelay log\u7684\u786c\u94fe\u63a5\u7684\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u662f/var/tmp\uff0c\u7531\u4e8e\u7cfb\u7edf\u4e0d\u540c\u5206\u533a\u521b\u5efa\u786c\u94fe\u63a5\u6587\u4ef6\u4f1a\u5931\u8d25\uff0c\u6545\u9700\u8981\u6267\u884c\u786c\u94fe\u63a5\u5177\u4f53\u4f4d\u7f6e\uff0c\u6210\u529f\u6267\u884c\u811a\u672c\u540e\uff0c\u786c\u94fe\u63a5\u7684\u4e2d\u7ee7\u65e5\u5fd7\u6587\u4ef6\u88ab\u5220\u9664 --disable_relay_log_purge \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679crelay_log_purge = 1 \uff0c\u811a\u672c\u4f1a\u4ec0\u4e48\u90fd\u4e0d\u6e05\u7406\uff0c\u81ea\u52a8\u9000\u51fa\uff0c\u901a\u8fc7\u8bbe\u5b9a\u8fd9\u4e2a\u53c2\u6570\uff0c\u5f53relay_log_purge = 1\u7684\u60c5\u51b5\u4e0b\u4f1a\u5c06relay_log_purge\u8bbe\u7f6e\u4e3a0\u3002\u6e05\u7406relay log\u4e4b\u540e\uff0c\u6700\u540e\u5c06\u53c2\u6570\u8bbe\u7f6e\u4e3aOFF\u3002","title":"\u8bbe\u7f6erelay log\u7684\u6e05\u9664\u65b9\u5f0f\uff08\u5728\u6bcf\u4e2aslave\u8282\u70b9\u4e0a\uff09\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#relayslave","text":"[ root@192.168.115.102 ~ ] # cat purge_relay_log.sh #!/bin/bash user = root passwd = 123456 port = 3306 log_dir = '/var/log/masterha' work_dir = '/var/lib/mysql' purge = '/usr/local/bin/purge_relay_logs' if [ ! -d $log_dir ] then mkdir $log_dir -p fi $purge --user = $user --password = $passwd --disable_relay_log_purge --port = $port --workdir = $work_dir >> $log_dir /purge_relay_logs.log 2 > & 1 \u6dfb\u52a0\u5230crontab\u5b9a\u671f\u6267\u884c [ root@192.168.115.102 ~ ] # crontab -l 0 4 * * * /bin/bash /root/purge_relay_log.sh","title":"\u8bbe\u7f6e\u5b9a\u671f\u6e05\u7406relay\u811a\u672c\uff08\u4e24\u53f0slave\u670d\u52a1\u5668\uff09"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#purge_relay_logssql","text":"[ root@192.168.115.102 ~ ] # purge_relay_logs --user=root --password=123456 --port=3306 -disable_relay_log_purge --workdir=/data/ 2014 -04-20 15 :47:24: purge_relay_logs script started. Found relay_log.info: /data/mysql/relay-log.info Removing hard linked relay log files server03-relay-bin* under /data/.. done . Current relay log file: /data/mysql/server03-relay-bin.000002 Archiving unused relay log files ( up to /data/mysql/server03-relay-bin.000001 ) ... Creating hard link for /data/mysql/server03-relay-bin.000001 under /data//server03-relay-bin.000001 .. ok. Creating hard links for unused relay log files completed. Executing SET GLOBAL relay_log_purge = 1 ; FLUSH LOGS ; sleeping a few seconds so that SQL thread can delete older relay log files ( if it keeps up ) ; SET GLOBAL relay_log_purge = 0 ; .. ok. Removing hard linked relay log files server03-relay-bin* under /data/.. done . 2014 -04-20 15 :47:27: All relay log purging operations succeeded.","title":"purge_relay_logs\u811a\u672c\u5220\u9664\u4e2d\u7ee7\u65e5\u5fd7\u4e0d\u4f1a\u963b\u585eSQL\u7ebf\u7a0b\u3002\u4e0b\u9762\u6211\u4eec\u624b\u52a8\u6267\u884c\u770b\u770b\u4ec0\u4e48\u60c5\u51b5\u3002"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#5ssh","text":"\u8981\u60f3MHA\u987a\u5229\u6267\u884c\u5404\u9879\u4efb\u52a1\uff0c\u8fd8\u5f97\u6253\u901a\u6bcf\u53f0\u673a\u5668\u7684SSH\u3002 [ root@172.16.2.99 app1 ] # ssh-keygen -t rsa [ root@172.16.2.99 app1 ] # ssh-copy-id -i .ssh/id_rsa.pub root@172.16.115.101 ..... \u8bb0\u4f4f\uff0c\u6bcf\u53f0\u673a\u5668\u90fd\u8981\u8ddf\u522b\u7684\u673a\u5668\u6253\u901aSSH\u3002 \u68c0\u67e5MHA Manger\u5230\u6240\u6709MHA Node\u7684SSH\u8fde\u63a5\u72b6\u6001\uff1a [ root@172.16.2.99 app1 ] # masterha_check_ssh --conf=/etc/masterha/app1.cnf Wed Dec 2 14 :42:39 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :42:39 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :42:39 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.101 ( 172 .16.115.101:22 ) to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.102 ( 172 .16.115.102:22 ) to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ info ] All SSH connection tests passed successfully. \u53ef\u4ee5\u770b\u89c1\u5404\u4e2a\u8282\u70b9ssh\u9a8c\u8bc1\u90fd\u662fok\u7684\u3002","title":"5\u3001SSH\u914d\u7f6e"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#6","text":"\u901a\u8fc7masterha_check_repl\u811a\u672c\u67e5\u770b\u6574\u4e2a\u96c6\u7fa4\u7684\u72b6\u6001 [ root@172.16.2.99 app1 ] # masterha_check_ssh --conf=/etc/masterha/app1.cnf Wed Dec 2 14 :42:39 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :42:39 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :42:39 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :42:39 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.101 ( 172 .16.115.101:22 ) to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ debug ] Wed Dec 2 14 :42:39 2015 - [ debug ] Connecting via SSH from root@172.16.115.102 ( 172 .16.115.102:22 ) to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Wed Dec 2 14 :42:39 2015 - [ debug ] ok. Wed Dec 2 14 :42:40 2015 - [ info ] All SSH connection tests passed successfully. [ root@utn-cz-1-1-s16h2 app1.log ] # masterha_check_repl --conf=/etc/masterha/app1.cnf Wed Dec 2 14 :43:49 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :43:49 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :43:49 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :43:49 2015 - [ info ] MHA::MasterMonitor version 0 .56. Wed Dec 2 14 :43:50 2015 - [ info ] GTID failover mode = 0 Wed Dec 2 14 :43:50 2015 - [ info ] Dead Servers: Wed Dec 2 14 :43:50 2015 - [ info ] Alive Servers: Wed Dec 2 14 :43:50 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] Alive Slaves: Wed Dec 2 14 :43:50 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Version = 5 .5.46-log ( oldest major version between slaves ) log-bin:enabled Wed Dec 2 14 :43:50 2015 - [ info ] Replicating from 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] Primary candidate for the new Master ( candidate_master is set ) Wed Dec 2 14 :43:50 2015 - [ info ] Current Alive Master: 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :43:50 2015 - [ info ] Checking slave configurations.. Wed Dec 2 14 :43:50 2015 - [ info ] read_only = 1 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :43:50 2015 - [ warning ] relay_log_purge = 0 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :43:50 2015 - [ info ] Checking replication filtering settings.. Wed Dec 2 14 :43:50 2015 - [ info ] binlog_do_db = drupal, binlog_ignore_db = Wed Dec 2 14 :43:50 2015 - [ info ] Replication filtering check ok. Wed Dec 2 14 :43:50 2015 - [ info ] GTID ( with auto-pos ) is not supported Wed Dec 2 14 :43:50 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :43:51 2015 - [ info ] All SSH connection tests passed successfully. Wed Dec 2 14 :43:51 2015 - [ info ] Checking MHA Node version.. Wed Dec 2 14 :43:51 2015 - [ info ] Version check ok. Wed Dec 2 14 :43:51 2015 - [ info ] Checking SSH publickey authentication settings on the current master.. Wed Dec 2 14 :43:51 2015 - [ info ] HealthCheck: SSH to 172 .16.115.101 is reachable. Wed Dec 2 14 :43:51 2015 - [ info ] Master MHA Node version is 0 .56. Wed Dec 2 14 :43:51 2015 - [ info ] Checking recovery script configurations on 172 .16.115.101 ( 172 .16.115.101:3306 ) .. Wed Dec 2 14 :43:51 2015 - [ info ] Executing command: save_binary_logs --command = test --start_pos = 4 --binlog_dir = /var/lib/mysql --output_file = /var/tmp/save_binary_logs_test --manager_version = 0 .56 --start_file = mysql-bin.000021 Wed Dec 2 14 :43:51 2015 - [ info ] Connecting to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Creating /var/tmp if not exists.. ok. Checking output directory is accessible or not.. ok. Binlog found at /var/lib/mysql, up to mysql-bin.000021 Wed Dec 2 14 :43:52 2015 - [ info ] Binlog setting check done . Wed Dec 2 14 :43:52 2015 - [ info ] Checking SSH publickey authentication and checking recovery script configurations on all alive slave servers.. Wed Dec 2 14 :43:52 2015 - [ info ] Executing command : apply_diff_relay_logs --command = test --slave_user = 'repl' --slave_host = 172 .16.115.102 --slave_ip = 172 .16.115.102 --slave_port = 3306 --workdir = /var/tmp --target_version = 5 .5.46-log --manager_version = 0 .56 --relay_log_info = /var/lib/mysql/relay-log.info --relay_dir = /var/lib/mysql/ --slave_pass = xxx Wed Dec 2 14 :43:52 2015 - [ info ] Connecting to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Checking slave recovery environment settings.. Opening /var/lib/mysql/relay-log.info ... ok. Relay log found at /var/lib/mysql, up to mysqld-relay-bin.000022 Temporary relay log file is /var/lib/mysql/mysqld-relay-bin.000022 Testing mysql connection and privileges.. done . Testing mysqlbinlog output.. done . Cleaning up test file ( s ) .. done . Wed Dec 2 14 :43:52 2015 - [ info ] Slaves settings check done . Wed Dec 2 14 :43:52 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) ( current master ) +--172.16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :43:52 2015 - [ info ] Checking replication health on 172 .16.115.102.. Wed Dec 2 14 :43:52 2015 - [ info ] ok. Wed Dec 2 14 :43:52 2015 - [ info ] Checking master_ip_failover_script status: Wed Dec 2 14 :43:52 2015 - [ info ] /usr/bin/masterha_ip_failover --command = status --ssh_user = root --orig_master_host = 172 .16.115.101 --orig_master_ip = 172 .16.115.101 --orig_master_port = 3306 IN SCRIPT TEST ==== /sbin/ifconfig eth0:0 down == /sbin/ifconfig eth0:0 172 .16.115.200/24 === Checking the Status of the script.. OK Wed Dec 2 14 :43:52 2015 - [ info ] OK. Wed Dec 2 14 :43:52 2015 - [ warning ] shutdown_script is not defined. Wed Dec 2 14 :43:52 2015 - [ info ] Got exit code 0 ( Not master dead ) . MySQL Replication Health is OK.","title":"6\u3001\u68c0\u67e5\u6574\u4e2a\u590d\u5236\u73af\u5883\u72b6\u51b5"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#7mha-manager","text":"\u901a\u8fc7master_check_status\u811a\u672c\u67e5\u770bManager\u7684\u72b6\u6001\uff1a [ root@172.16.2.99 ~ ] # masterha_check_status --conf=/etc/masterha/app1.cnf app1 is stopped ( 2 :NOT_RUNNING ) . \u6ce8\u610f\uff1a\u5982\u679c\u6b63\u5e38\uff0c\u4f1a\u663e\u793a\"PING_OK\"\uff0c\u5426\u5219\u4f1a\u663e\u793a\"NOT_RUNNING\"\uff0c\u8fd9\u4ee3\u8868MHA\u76d1\u63a7\u6ca1\u6709\u5f00\u542f\u3002","title":"7\u3001\u68c0\u67e5MHA Manager\u7684\u72b6\u6001"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#8mha-manager","text":"[ root@172.16.2.99 ~ ] # nohup masterha_manager --conf=/etc/masterha/app1.cnf --ignore_last_failover > /var/log/mha/app1/manager.log < /dev/null 2>&1 & [ 1 ] 7303 \u542f\u52a8\u53c2\u6570\u4ecb\u7ecd\uff1a --remove_dead_master_conf \u8be5\u53c2\u6570\u4ee3\u8868\u5f53\u53d1\u751f\u4e3b\u4ece\u5207\u6362\u540e\uff0c\u8001\u7684\u4e3b\u5e93\u7684ip\u5c06\u4f1a\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u79fb\u9664\u3002 --manger_log \u65e5\u5fd7\u5b58\u653e\u4f4d\u7f6e --ignore_last_failover \u5728\u7f3a\u7701\u60c5\u51b5\u4e0b\uff0c\u5982\u679cMHA\u68c0\u6d4b\u5230\u8fde\u7eed\u53d1\u751f\u5b95\u673a\uff0c\u4e14\u4e24\u6b21\u5b95\u673a\u95f4\u9694\u4e0d\u8db38\u5c0f\u65f6\u7684\u8bdd\uff0c\u5219\u4e0d\u4f1a\u8fdb\u884cFailover\uff0c\u4e4b\u6240\u4ee5\u8fd9\u6837\u9650\u5236\u662f\u4e3a\u4e86\u907f\u514dping-pong\u6548\u5e94\u3002\u8be5\u53c2\u6570\u4ee3\u8868\u5ffd\u7565\u4e0a\u6b21MHA\u89e6\u53d1\u5207\u6362\u4ea7\u751f\u7684\u6587\u4ef6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMHA\u53d1\u751f\u5207\u6362\u540e\u4f1a\u5728\u65e5\u5fd7\u76ee\u5f55\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u6211\u8bbe\u7f6e\u7684/data\u4ea7\u751fapp1.failover.complete\u6587\u4ef6\uff0c\u4e0b\u6b21\u518d\u6b21\u5207\u6362\u7684\u65f6\u5019\u5982\u679c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\u5b58\u5728\u8be5\u6587\u4ef6\u5c06\u4e0d\u5141\u8bb8\u89e6\u53d1\u5207\u6362\uff0c\u9664\u975e\u5728\u7b2c\u4e00\u6b21\u5207\u6362\u540e\u6536\u5230\u5220\u9664\u8be5\u6587\u4ef6\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a--ignore_last_failover\u3002 \u67e5\u770bMHA Manager\u76d1\u63a7\u662f\u5426\u6b63\u5e38\uff1a [ root@172.16.2.99 ~ ] # masterha_check_status --conf=/etc/masterha/app1.cnf app1 ( pid:20386 ) is running ( 0 :PING_OK ) , master:172.16.115.101 \u53ef\u4ee5\u770b\u89c1\u5df2\u7ecf\u5728\u76d1\u63a7\u4e86\uff0c\u800c\u4e14master\u7684\u4e3b\u673a\u4e3a172.16.115.101","title":"8\u3001\u5f00\u542fMHA Manager\u76d1\u63a7"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#9","text":"[ root@172.16.2.99 ~ ] # cat /var/log/mha/app1/manager.log Wed Dec 2 14 :46:37 2015 - [ warning ] Global configuration file /etc/masterha_default.cnf not found. Skipping. Wed Dec 2 14 :46:37 2015 - [ info ] Reading application default configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :46:37 2015 - [ info ] Reading server configuration from /etc/masterha/app1.cnf.. Wed Dec 2 14 :46:37 2015 - [ info ] MHA::MasterMonitor version 0 .56. Wed Dec 2 14 :46:38 2015 - [ info ] GTID failover mode = 0 Wed Dec 2 14 :46:38 2015 - [ info ] Dead Servers: Wed Dec 2 14 :46:38 2015 - [ info ] Alive Servers: Wed Dec 2 14 :46:38 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] Alive Slaves: Wed Dec 2 14 :46:38 2015 - [ info ] 172 .16.115.102 ( 172 .16.115.102:3306 ) Version = 5 .5.46-log ( oldest major version between slaves ) log-bin:enabled Wed Dec 2 14 :46:38 2015 - [ info ] Replicating from 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] Primary candidate for the new Master ( candidate_master is set ) Wed Dec 2 14 :46:38 2015 - [ info ] Current Alive Master: 172 .16.115.101 ( 172 .16.115.101:3306 ) Wed Dec 2 14 :46:38 2015 - [ info ] Checking slave configurations.. Wed Dec 2 14 :46:38 2015 - [ info ] read_only = 1 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :46:38 2015 - [ warning ] relay_log_purge = 0 is not set on slave 172 .16.115.102 ( 172 .16.115.102:3306 ) . Wed Dec 2 14 :46:38 2015 - [ info ] Checking replication filtering settings.. Wed Dec 2 14 :46:38 2015 - [ info ] binlog_do_db = drupal, binlog_ignore_db = Wed Dec 2 14 :46:38 2015 - [ info ] Replication filtering check ok. Wed Dec 2 14 :46:38 2015 - [ info ] GTID ( with auto-pos ) is not supported Wed Dec 2 14 :46:38 2015 - [ info ] Starting SSH connection tests.. Wed Dec 2 14 :46:39 2015 - [ info ] All SSH connection tests passed successfully. Wed Dec 2 14 :46:39 2015 - [ info ] Checking MHA Node version.. Wed Dec 2 14 :46:39 2015 - [ info ] Version check ok. Wed Dec 2 14 :46:39 2015 - [ info ] Checking SSH publickey authentication settings on the current master.. Wed Dec 2 14 :46:39 2015 - [ info ] HealthCheck: SSH to 172 .16.115.101 is reachable. Wed Dec 2 14 :46:39 2015 - [ info ] Master MHA Node version is 0 .56. Wed Dec 2 14 :46:39 2015 - [ info ] Checking recovery script configurations on 172 .16.115.101 ( 172 .16.115.101:3306 ) .. Wed Dec 2 14 :46:39 2015 - [ info ] Executing command: save_binary_logs --command = test --start_pos = 4 --binlog_dir = /var/lib/mysql --output_file = /var/tmp/save_binary_logs_test --manager_version = 0 .56 --start_file = mysql-bin.000021 Wed Dec 2 14 :46:39 2015 - [ info ] Connecting to root@172.16.115.101 ( 172 .16.115.101:22 ) .. Creating /var/tmp if not exists.. ok. Checking output directory is accessible or not.. ok. Binlog found at /var/lib/mysql, up to mysql-bin.000021 Wed Dec 2 14 :46:39 2015 - [ info ] Binlog setting check done . Wed Dec 2 14 :46:39 2015 - [ info ] Checking SSH publickey authentication and checking recovery script configurations on all alive slave servers.. Wed Dec 2 14 :46:39 2015 - [ info ] Executing command : apply_diff_relay_logs --command = test --slave_user = 'repl' --slave_host = 172 .16.115.102 --slave_ip = 172 .16.115.102 --slave_port = 3306 --workdir = /var/tmp --target_version = 5 .5.46-log --manager_version = 0 .56 --relay_log_info = /var/lib/mysql/relay-log.info --relay_dir = /var/lib/mysql/ --slave_pass = xxx Wed Dec 2 14 :46:39 2015 - [ info ] Connecting to root@172.16.115.102 ( 172 .16.115.102:22 ) .. Checking slave recovery environment settings.. Opening /var/lib/mysql/relay-log.info ... ok. Relay log found at /var/lib/mysql, up to mysqld-relay-bin.000022 Temporary relay log file is /var/lib/mysql/mysqld-relay-bin.000022 Testing mysql connection and privileges.. done . Testing mysqlbinlog output.. done . Cleaning up test file ( s ) .. done . Wed Dec 2 14 :46:40 2015 - [ info ] Slaves settings check done . Wed Dec 2 14 :46:40 2015 - [ info ] 172 .16.115.101 ( 172 .16.115.101:3306 ) ( current master ) +--172.16.115.102 ( 172 .16.115.102:3306 ) Wed Dec 2 14 :46:40 2015 - [ info ] Checking master_ip_failover_script status: Wed Dec 2 14 :46:40 2015 - [ info ] /usr/bin/masterha_ip_failover --command = status --ssh_user = root --orig_master_host = 172 .16.115.101 --orig_master_ip = 172 .16.115.101 --orig_master_port = 3306 IN SCRIPT TEST ==== /sbin/ifconfig eth0:0 down == /sbin/ifconfig eth0:0 172 .16.115.200/24 === Checking the Status of the script.. OK Wed Dec 2 14 :46:40 2015 - [ info ] OK. Wed Dec 2 14 :46:40 2015 - [ warning ] shutdown_script is not defined. Wed Dec 2 14 :46:40 2015 - [ info ] Set master ping interval 1 seconds. Wed Dec 2 14 :46:40 2015 - [ warning ] secondary_check_script is not defined. It is highly recommended setting it to check master reachability from two or more routes. Wed Dec 2 14 :46:40 2015 - [ info ] Starting ping health check on 172 .16.115.101 ( 172 .16.115.101:3306 ) .. Wed Dec 2 14 :46:40 2015 - [ info ] Ping ( SELECT ) succeeded, waiting until MySQL doesn ' t respond..","title":"9\u3001\u67e5\u770b\u542f\u52a8\u65e5\u5fd7"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#10vip","text":"\u6211\u4eec\u91c7\u7528\u811a\u672c\u7684\u65b9\u5f0f\u53bb\u914d\u7f6evip [ root@172.16.2.99 ~ ] # vim /usr/bin/masterha_ip_failover #!/usr/bin/env perl use strict ; use warnings FATAL = > 'all' ; use Getopt::Long ; my ( $command , $ssh_user , $orig_master_host , $orig_master_ip , $orig_master_port , $new_master_host , $new_master_ip , $new_master_port ) ; my $vip = '172.16.115.200/24' ; my $key = '0' ; my $ssh_start_vip = \"/sbin/ifconfig eth0: $key $vip \" ; my $ssh_stop_vip = \"/sbin/ifconfig eth0: $key down\" ; GetOptions ( 'command=s' = > \\$ command, 'ssh_user=s' = > \\$ ssh_user, 'orig_master_host=s' = > \\$ orig_master_host, 'orig_master_ip=s' = > \\$ orig_master_ip, 'orig_master_port=i' = > \\$ orig_master_port, 'new_master_host=s' = > \\$ new_master_host, 'new_master_ip=s' = > \\$ new_master_ip, 'new_master_port=i' = > \\$ new_master_port, ) ; exit & main () ; sub main { print \"\\n\\nIN SCRIPT TEST==== $ssh_stop_vip == $ssh_start_vip ===\\n\\n\" ; if ( $command eq \"stop\" || $command eq \"stopssh\" ) { my $exit_code = 1 ; eval { print \"Disabling the VIP on old master: $orig_master_host \\n\" ; & stop_vip () ; $exit_code = 0 ; } ; if ( $@ ) { warn \"Got Error: $@ \\n\" ; exit $exit_code ; } exit $exit_code ; } elsif ( $command eq \"start\" ) { my $exit_code = 10 ; eval { print \"Enabling the VIP - $vip on the new master - $new_master_host \\n\" ; & start_vip () ; $exit_code = 0 ; } ; if ( $@ ) { warn $@ ; exit $exit_code ; } exit $exit_code ; } elsif ( $command eq \"status\" ) { print \"Checking the Status of the script.. OK \\n\" ; exit 0 ; } else { & usage () ; exit 1 ; } } sub start_vip () { ` ssh $ssh_user \\@ $new_master_host \\\" $ssh_start_vip \\\" ` ; } sub stop_vip () { return 0 unless ( $ssh_user ) ; ` ssh $ssh_user \\@ $orig_master_host \\\" $ssh_stop_vip \\\" ` ; } sub usage { print \"Usage: master_ip_failover --command=start|stop|stopssh|status --orig_master_host=host --orig_master_ip=ip --orig_master_port=port --new_master_host=host --new_master_ip=ip --new_master_port=port\\n\" ; }","title":"10\u3001\u914d\u7f6eVIP"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#11send_report","text":"#!/usr/bin/perl # Copyright (C) 2011 DeNA Co.,Ltd. # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License # along with this program; if not, write to the Free Software # Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA ## Note: This is a sample script and is not complete. Modify the script based on your environment. use strict ; use warnings FATAL = > 'all' ; use Mail::Sender ; use Getopt::Long ; #new_master_host and new_slave_hosts are set only when recovering master succeeded my ( $dead_master_host , $new_master_host , $new_slave_hosts , $subject , $body ) ; my $smtp = 'smtp.163.com' ; my $mail_from = 'services@163.com' ; my $mail_user = 'services@163.com' ; my $mail_pass = '123456' ; my $mail_to =[ 'xxx@xxx.cn' ] ; GetOptions ( 'orig_master_host=s' = > \\$ dead_master_host, 'new_master_host=s' = > \\$ new_master_host, 'new_slave_hosts=s' = > \\$ new_slave_hosts, 'subject=s' = > \\$ subject, 'body=s' = > \\$ body, ) ; mailToContacts ( $smtp , $mail_from , $mail_user , $mail_pass , $mail_to , $subject , $body ) ; sub mailToContacts { my ( $smtp , $mail_from , $user , $passwd , $mail_to , $subject , $msg ) = @_ ; open my $DEBUG , \"> /tmp/monitormail.log\" or die \"Can't open the debug file: $! \\n\" ; my $sender = new Mail::Sender { ctype = > 'text/plain; charset=utf-8' , encoding = > 'utf-8' , smtp = > $smtp , from = > $mail_from , auth = > 'LOGIN' , TLS_allowed = > '0' , authid = > $user , authpwd = > $passwd , to = > $mail_to , subject = > $subject , debug = > $DEBUG } ; $sender ->MailMsg ( { msg = > $msg , debug = > $DEBUG } ) or print $Mail ::Sender::Error ; return 1 ; } # Do whatever you want here exit 0 ;","title":"11\u3001\u90ae\u4ef6\u53d1\u9001\u811a\u672csend_report"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#12","text":"1.\u4e3b\u5e93\u65ad\u7535 2.\u4e3b\u5e93\u65ad\u7f51 3.\u4e3b\u5e93\u91cd\u542f 4.\u4e3b\u5e93\u5173\u673a \u4ee5\u4e0a\u60c5\u51b5\u90fd\u6d4b\u8bd5\u8fc7\u90fd\u80fd\u81ea\u52a8\u5207\u6362~ \u8bf7\u770b\u65e5\u5fd7\u5206\u6790\u5207\u6362\u8fc7\u7a0b","title":"12\u3001\u6d4b\u8bd5"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#13","text":"[ root@172.16.2.99 app1 ] # grep -i \"All other slaves should start\" manager.log Mon Apr 21 22 :28:33 2014 - [ info ] All other slaves should start replication from here. Statement should be: CHANGE MASTER TO MASTER_HOST = '172.16.115.102' , MASTER_PORT = 3306 , MASTER_LOG_FILE = 'mysql-bin.000022' , MASTER_LOG_POS = 506716 , MASTER_USER = 'repl' , MASTER_PASSWORD = 'xxx' ; [ root@192.168.0.20 app1 ] # \u7136\u540e\u518d\u5c31\u5f97\u4e3b\u5e93\u91cc\u6267\u884c\u4e0b,\u518dstart slave ,\u7136\u540e\u5c31\u5f97\u4e3b\u5e93\u5c31\u53d8\u4e3a\u4e86\u65b0\u7684\u4e3b\u5e93\u7684\u4ece\u5e93\u4e86\u3002 \u8bb0\u5f97\u770b\u4e0bshow slave status\\G;","title":"13\u3001\u4e3b\u5e93\u6a21\u62df\u6545\u969c\u540e\u7684\u6062\u590d"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#14","text":"\u6458\u6284\u81eagoogle.","title":"14\u3001\u62a5\u9519\u8bb0\u5f55\u603b\u7ed3"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#1_1","text":"[ root@data01 ~ ] # masterha_check_repl--conf=/etc/masterha/app1.cnf Tue Apr 7 22 :31:06 2015 - [ warning ] Global configuration file/etc/masterha_default.cnf not found. Skipping. Tue Apr 7 22 :31:07 2015 - [ info ] Reading application default configuration from/etc/masterha/app1.cnf.. Tue Apr 7 22 :31:07 2015 - [ info ] Reading server configuration from/etc/masterha/app1.cnf.. Tue Apr 7 22 :31:07 2015 - [ info ] MHA::MasterMonitor version 0 .56. Tue Apr 7 22 :31:07 2015 - [ error ][ /usr/local/share/perl5/MHA/Server.pm,ln303 ] Getting relay log directory orcurrent relay logfile from replication table failed on192.168.52.130 ( 192 .168.52.130:3306 ) ! Tue Apr 7 22 :31:07 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at /usr/local/share/perl5/MHA/ServerManager.pmline 315 Tue Apr 7 22 :31:07 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Tue Apr 7 22 :31:07 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@data01 ~ ] # \u89e3\u51b3\u529e\u6cd5\uff1a\u5728192.168.52.130\u4e0a\u9762\uff0cvim /etc/my.cnf\uff0c\u5728\u91cc\u9762\u6dfb\u52a0 relay-log = /home/data/mysql/binlog/mysql-relay-bin \u7136\u540e\u91cd\u542fmysql\uff0c\u518d\u53bb\u91cd\u65b0\u8bbe\u7f6eslave\u8fde\u63a5\u3002 STOP SLAVE ; RESET SLAVE ; CHANGE MASTER TOMASTER_HOST = '192.168.52.129' ,MASTER_USER = 'repl' ,MASTER_PASSWORD = 'repl_1234' ,MASTER_LOG_FILE = 'mysql-bin.000178' ,MASTER_LOG_POS = 459 ; START SLAVE ; Ok\uff0c\u641e\u5b9a\u4e86\u3002","title":"\u62a5\u9519\u8bb0\u5f551\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#2","text":"[ root@data01 perl ] # masterha_check_repl--conf=/etc/masterha/app1.cnf Thu Apr 9 00 :54:32 2015 - [ warning ] Global configuration file/etc/masterha_default.cnf not found. Skipping. Thu Apr 9 00 :54:32 2015 - [ info ] Reading application default configuration from/etc/masterha/app1.cnf.. Thu Apr 9 00 :54:32 2015 - [ info ] Reading server configuration from/etc/masterha/app1.cnf.. Thu Apr 9 00 :54:32 2015 - [ info ] MHA::MasterMonitor version 0 .56. Thu Apr 9 00 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/Server.pm,ln306 ] Getting relay log directory orcurrent relay logfile from replication table failed on 192 .168.52.130 ( 192 .168.52.130:3306 ) ! Thu Apr 9 00 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at/usr/local/share/perl5/MHA/ServerManager.pm line 315 Thu Apr 9 00 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 00 :54:32 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@data01 perl ] # \u89e3\u51b3\u65b9\u6cd5\uff1a /etc/masterha/app1.cnf\u6587\u4ef6\u91cc\u9762\u7684\u53c2\u6570\u914d\u7f6e\uff0cuser\u548crepl_user\u90fd\u662fmysql\u8d26\u53f7\uff0c\u9700\u8981\u521b\u5efa\u597d\uff0c\u8fd9\u91cc\u662f\u53ea\u521b\u5efa\u4e86repl_user\u800c\u6ca1\u6709\u521b\u5efa\u597duser\u8d26\u53f7\uff1a user = manager password = manager_1234 repl_user = repl repl_password = repl_1234 \u5728mysql\u8282\u70b9\u4e0a\uff0c\u5efa\u7acb\u5141\u8bb8manager \u8bbf\u95ee\u6570\u636e\u5e93\u7684\u201c manager manager \u201d\u8d26\u6237\uff0c\u4e3b\u8981\u7528\u4e8eSHOW SLAVESTATUS,RESET SLAVE; \u6240\u4ee5\u9700\u8981\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a GRANT SUPER,RELOAD,REPLICATIONCLIENT,SELECT ON *.* TO manager@ '192.168.52.%' IDENTIFIED BY 'manager_1234' ;","title":"\u62a5\u9519\u8bb0\u5f552\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#3","text":"[ root@oraclem1 ~ ] # masterha_check_repl--conf=/etc/masterha/app1.cnf Thu Apr 9 23 :09:05 2015 - [ warning ] Global configuration file/etc/masterha_default.cnf not found. Skipping. Thu Apr 9 23 :09:05 2015 - [ info ] Reading application default configuration from/etc/masterha/app1.cnf.. Thu Apr 9 23 :09:05 2015 - [ info ] Reading server configuration from/etc/masterha/app1.cnf.. Thu Apr 9 23 :09:05 2015 - [ info ] MHA::MasterMonitor version 0 .56. Thu Apr 9 23 :09:05 2015 - [ error ][ /usr/local/share/perl5/MHA/ServerManager.pm,ln781 ] Multi-master configuration is detected, but two or more masters areeither writable ( read-only is not set ) or dead! Check configurations fordetails. Master configurations are as below: Master 192 .168.52.130 ( 192 .168.52.130:3306 ) ,replicating from 192 .168.52.129 ( 192 .168.52.129:3306 ) Master 192 .168.52.129 ( 192 .168.52.129:3306 ) ,replicating from 192 .168.52.130 ( 192 .168.52.130:3306 ) Thu Apr 9 23 :09:05 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at/usr/local/share/perl5/MHA/MasterMonitor.pm line 326 Thu Apr 9 23 :09:05 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 23 :09:05 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@oraclem1 ~ ] # \u89e3\u51b3\u529e\u6cd5\uff1a mysql> set global read_only = 1 ; Query OK, 0 rows affected ( 0 .00 sec ) mysql>","title":"\u9519\u8bef\u8bb0\u5f553\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#4","text":"Thu Apr 9 23 :54:32 2015 - [ info ] Checking SSH publickey authentication andchecking recovery script configurations on all alive slave servers.. Thu Apr 9 23 :54:32 2015 - [ info ] Executing command : apply_diff_relay_logs --command = test--slave_user = 'manager' --slave_host = 192 .168.52.130 --slave_ip = 192 .168.52.130--slave_port = 3306 --workdir = /var/tmp --target_version = 5 .6.12-log--manager_version = 0 .56 --relay_dir = /home/data/mysql/data--current_relay_log = mysqld-relay-bin.000011 --slave_pass = xxx Thu Apr 9 23 :54:32 2015 - [ info ] Connecting to root@192.168.52.130 ( 192 .168.52.130:22 ) .. Can ' t exec \"mysqlbinlog\" : No suchfile or directory at /usr/local/share/perl5/MHA/BinlogManager.pm line 106 . mysqlbinlog version command failed with rc1:0, please verify PATH, LD_LIBRARY_PATH, and client options at/usr/local/bin/apply_diff_relay_logs line 493 Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln205 ] Slaves settings check failed! Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln413 ] Slave configuration failed. Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at /usr/local/bin/masterha_check_repl line 48 Thu Apr 9 23 :54:32 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 23 :54:32 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! [ root@oraclem1 ~ ] # \u89e3\u51b3\u529e\u6cd5\uff1a [ root@data02 ~ ] # type mysqlbinlog mysqlbinlog is/usr/local/mysql/bin/mysqlbinlog [ root@data02 ~ ] # [ root@data02 ~ ] # ln -s/usr/local/mysql/bin/mysqlbinlog /usr/bin/mysqlbinlog","title":"\u62a5\u9519\u8bb0\u5f554\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#5","text":"Thu Apr 9 23 :57:24 2015 - [ info ] Connecting to root@192.168.52.130 ( 192 .168.52.130:22 ) .. Checking slave recovery environment settings.. Relay log found at /home/data/mysql/data, up to mysqld-relay-bin.000013 Temporary relay log file is /home/data/mysql/data/mysqld-relay-bin.000013 Testing mysql connection and privileges..sh: mysql: command not found mysql command failed with rc 127 :0! at/usr/local/bin/apply_diff_relay_logs line 375 main::check () called at /usr/local/bin/apply_diff_relay_logs line 497 eval { ... } called at /usr/local/bin/apply_diff_relay_logs line 475 main::main () called at /usr/local/bin/apply_diff_relay_logs line 120 Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln205 ] Slaves settings check failed! Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln413 ] Slave configuration failed. Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln424 ] Error happened on checking configurations. at /usr/local/bin/masterha_check_repl line 48 Thu Apr 9 23 :57:24 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm,ln523 ] Error happened on monitoring servers. Thu Apr 9 23 :57:24 2015 - [ info ] Got exit code 1 ( Not master dead ) . MySQL Replication Health is NOT OK! \u89e3\u51b3\u529e\u6cd5\uff1a ln -s /usr/local/mysql/bin/mysql/usr/bin/mysql","title":"\u62a5\u9519\u8bb0\u5f555\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#6_1","text":"Fri Apr 10 00 :58:36 2015 - [ info ] Executing command : apply_diff_relay_logs--command = test --slave_user = 'manager' --slave_host = 192 .168.52.130--slave_ip = 192 .168.52.130 --slave_port = 3306 --workdir = /var/tmp--target_version = 5 .6.12-log --manager_version = 0 .56--relay_dir = /home/data/mysql/data--current_relay_log = mysqld-relay-bin.000011 --slave_pass = xxx Fri Apr 10 00 :58:36 2015 - [ info ] Connecting to root@192.168.52.130 ( 192 .168.52.130:22 ) .. Checking slave recovery environment settings.. Relay log found at /home/data/mysql/data, up to mysqld-relay-bin.000013 Temporary relay log file is/home/data/mysql/data/mysqld-relay-bin.000013 Testing mysql connection and privileges..Warning: Using a password onthe command line interface can be insecure. ERROR 1142 ( 42000 ) at line 1 : CREATEcommand denied to user 'manager' @ '192.168.52.130' for table 'apply_diff_relay_logs_test' mysql command failed with rc 1 :0! at/usr/local/bin/apply_diff_relay_logs line 375 main::check () called at /usr/local/bin/apply_diff_relay_logs line 497 eval { ... } called at /usr/local/bin/apply_diff_relay_logs line 475 main::main () called at /usr/local/bin/apply_diff_relay_logs line 120 Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln205 ] Slaves settingscheck failed! Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln413 ] Slave configurationfailed. Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln424 ] Error happened onchecking configurations. at/usr/local/bin/masterha_check_repl line 48 Fri Apr 10 00 :58:37 2015 - [ error ][ /usr/local/share/perl5/MHA/MasterMonitor.pm, ln523 ] Error happened onmonitoring servers. Fri Apr 10 00 :58:37 2015 - [ info ] Got exitcode 1 ( Not master dead ) . MySQL Replication Health is NOT OK! \u89e3\u51b3\u529e\u6cd5\uff1a \u6267\u884c\u5982\u4e0b\u6388\u6743\u8bed\u53e5sql\uff1a GRANT CREATE,INSERT,UPDATE,DELETE,DROP ON*.* TO manager@ '192.168.52.%' ;","title":"\u62a5\u9519\u8bb0\u5f556\uff1a"},{"location":"other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_2","text":"\u53e6\u5916\uff0c\u5982\u679cnohup masterha_manager\u6267\u884c\u4e0d\u4e86\uff0c\u8bf7\u68c0\u67e5master\u548cslave\u662f\u5426\u914d\u7f6e\u6b63\u786e\u3002\u53ef\u4ee5\u901a\u8fc7 change master to master_host = '172.16.115.101' ,master_port = 3306 ,master_user = 'repl' ,master_password = '123456' ,master_log_file = 'mysql-bin.000001' ,MASTER_LOG_POS = 0 ; \u91cd\u65b0\u8bbe\u7f6eslave\u3002","title":"\u5176\u4ed6"},{"location":"project/","text":"\u8fd9\u91cc\u8bb0\u5f55\u7684\u662f\u6211\u7684\u4e00\u4e9b\u4e2a\u4eba\u9879\u76ee\uff0c\u4f1a\u9646\u7eed\u53d1\u4e0a\u6765\u3002 \u00b6 \u4e00\u3001\u4e00\u4e2a\u7b80\u5355\u7684PHP\u6846\u67b6SmartyPHP \u00b6 \u9879\u76ee\u5730\u5740 \u00b6 https://github.com/aboutblankchina/SmartyPHP SmartyPHP\u662f\u4e00\u4e2a\u7b80\u5355\u9ad8\u6548\u7684 PHP \u6846\u67b6\u3002\u5e76\u4e14\u6781\u5176\u7b80\u5355\uff0c\u6ca1\u6709\u4efb\u4f55\u591a\u4f59\u7684\u4ee3\u7801\u3002 \u8be5\u6846\u67b6\u9075\u5faa MVC \u6a21\u5f0f\uff0cMVC \u5404\u4e2a\u90e8\u5206\u53ef\u4ee5\u4ece\u6e05\u6670\u7684\u76ee\u5f55\u7ed3\u6784\u4e2d\u8fa8\u522b\u51fa\u6765\u3002\u5373\u4f7f\u6ca1\u7528\u8fc7\u5176\u5b83\u6846\u67b6\u4e5f\u4f1a\u5f88\u5feb\u4e0a\u624b\uff0c\u56e0\u4e3a\u6b64\u6846\u67b6\u8bbe\u8ba1\u4e4b\u521d\u5c31\u662f\u56e0\u4e3a\u5176\u4ed6\u6846\u67b6\u7ed9\u7684\u592a\u591a\uff0c\u5b9a\u4e49\u4e86\u592a\u591a\u7684\u51fd\u6570\uff0c\u6240\u4ee5\u8be5\u6846\u67b6\u5c3d\u53ef\u80fd\u7684\u964d\u4f4e\u4e86\u5b66\u4e60\u6210\u672c\u3002 SmartyPHP \u6709\u4ee5\u4e0b\u7279\u70b9\uff1a \u5c0f\u5de7\u7b80\u5355 \u5355\u5165\u53e3 \u6570\u636e\u5e93\u76ee\u524d\u53ea\u652f\u6301mysql \u540e\u7eed\u5f00\u53d1\u4f1a\u589e\u52a0cache\u7b49\u529f\u80fd\u3002 \u4e8c\u3001oracle for drupal8 \u00b6 \u9879\u76ee\u5730\u5740 \u00b6 https://github.com/aboutblankchina/oracle_for_drupal8 \u4e09\u3001\u53bb\u9664\u4f18\u9177\u5e7f\u544achrome\u63d2\u4ef6 \u00b6 \u9879\u76ee\u5730\u5740 \u00b6 https://github.com/aboutblankchina/youku_block_for_chrome","title":"project"},{"location":"project/#_1","text":"","title":"\u8fd9\u91cc\u8bb0\u5f55\u7684\u662f\u6211\u7684\u4e00\u4e9b\u4e2a\u4eba\u9879\u76ee\uff0c\u4f1a\u9646\u7eed\u53d1\u4e0a\u6765\u3002"},{"location":"project/#phpsmartyphp","text":"","title":"\u4e00\u3001\u4e00\u4e2a\u7b80\u5355\u7684PHP\u6846\u67b6SmartyPHP"},{"location":"project/#_2","text":"https://github.com/aboutblankchina/SmartyPHP SmartyPHP\u662f\u4e00\u4e2a\u7b80\u5355\u9ad8\u6548\u7684 PHP \u6846\u67b6\u3002\u5e76\u4e14\u6781\u5176\u7b80\u5355\uff0c\u6ca1\u6709\u4efb\u4f55\u591a\u4f59\u7684\u4ee3\u7801\u3002 \u8be5\u6846\u67b6\u9075\u5faa MVC \u6a21\u5f0f\uff0cMVC \u5404\u4e2a\u90e8\u5206\u53ef\u4ee5\u4ece\u6e05\u6670\u7684\u76ee\u5f55\u7ed3\u6784\u4e2d\u8fa8\u522b\u51fa\u6765\u3002\u5373\u4f7f\u6ca1\u7528\u8fc7\u5176\u5b83\u6846\u67b6\u4e5f\u4f1a\u5f88\u5feb\u4e0a\u624b\uff0c\u56e0\u4e3a\u6b64\u6846\u67b6\u8bbe\u8ba1\u4e4b\u521d\u5c31\u662f\u56e0\u4e3a\u5176\u4ed6\u6846\u67b6\u7ed9\u7684\u592a\u591a\uff0c\u5b9a\u4e49\u4e86\u592a\u591a\u7684\u51fd\u6570\uff0c\u6240\u4ee5\u8be5\u6846\u67b6\u5c3d\u53ef\u80fd\u7684\u964d\u4f4e\u4e86\u5b66\u4e60\u6210\u672c\u3002 SmartyPHP \u6709\u4ee5\u4e0b\u7279\u70b9\uff1a \u5c0f\u5de7\u7b80\u5355 \u5355\u5165\u53e3 \u6570\u636e\u5e93\u76ee\u524d\u53ea\u652f\u6301mysql \u540e\u7eed\u5f00\u53d1\u4f1a\u589e\u52a0cache\u7b49\u529f\u80fd\u3002","title":"\u9879\u76ee\u5730\u5740"},{"location":"project/#oracle-for-drupal8","text":"","title":"\u4e8c\u3001oracle for drupal8"},{"location":"project/#_3","text":"https://github.com/aboutblankchina/oracle_for_drupal8","title":"\u9879\u76ee\u5730\u5740"},{"location":"project/#chrome","text":"","title":"\u4e09\u3001\u53bb\u9664\u4f18\u9177\u5e7f\u544achrome\u63d2\u4ef6"},{"location":"project/#_4","text":"https://github.com/aboutblankchina/youku_block_for_chrome","title":"\u9879\u76ee\u5730\u5740"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/","tags":"[Vue]","text":"1\u3001\u6982\u8ff0 \u00b6 Vue\u8def\u7531\uff08vue-router\uff09\u662fVue\u7528\u6765\u521b\u5efa\u5355\u9875\u5e94\u7528\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u4f7f\u7528vue-router\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u521b\u5efa\u65e0\u5237\u65b0\u5207\u6362\u9875\u9762\u7684\u5e94\u7528\u3002vue-router\u57fa\u4e8evue\u7684\u7ec4\u4ef6\u7cfb\u7edf\uff08\u4e0d\u719f\u6089\u7ec4\u4ef6\u8bf7\u5148\u5b66\u4e60Vue\u7ec4\u4ef6\uff09\uff0c\u8981\u4f7f\u7528vue-router\u53ea\u9700\u8981\u5c06\u8def\u5f84\u548c\u7ec4\u4ef6\u5efa\u7acb\u5bf9\u5e94\u5173\u7cfb\uff0c\u8fd9\u6837\u8def\u7531\u7cfb\u7edf\u5c31\u77e5\u9053\u54ea\u4e2a\u8def\u5f84\u9700\u8981\u6e32\u67d3\u54ea\u4e2a\u7ec4\u4ef6\u3002 2\u3001\u5f00\u59cb \u00b6 \u5728\u5f00\u59cb\u5199\u7b2c\u4e00\u4e2a\u8def\u7531\u793a\u4f8b\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u4e86\u89e3\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u3002 \uff081\uff09\u8def\u7531 \u8def\u7531\u5373url\u8def\u5f84\u548c\u7ec4\u4ef6\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002 \uff082\uff09router-link\u7ec4\u4ef6 router-link\u7ec4\u4ef6\u5373\u9875\u9762\u4e0a\u8fde\u63a5\u5230\u67d0\u4e2a\u8def\u7531\u7684\u8d85\u94fe\u63a5\uff0c\u6700\u7ec8\u6e32\u67d3\u540e\u4f1a\u53d8\u6210a\u6807\u7b7e\u3002\u6bd4\u5982\u6211\u9700\u8981\u5728\u9875\u9762\u4e0a\u8bbe\u7f6e\u8fde\u63a5\u5230/profile/user\u7684\u8d85\u94fe\u63a5\uff0c\u5219\u53ea\u8981\u5728\u9875\u9762\u653e\u4e0a<router-link to=\"/profile/user\">\u7528\u6237\u5217\u8868</router-link>\u5c31\u884c\u4e86\u3002 \uff083\uff09router-view\u7ec4\u4ef6 router-view\u7ec4\u4ef6\u662f\u8def\u7531\u7ec4\u4ef6\u6e32\u67d3\u7684\u5bb9\u5668\uff0c\u4e00\u65e6\u8def\u7531\u5339\u914d\u5230\u4e86\uff0cvue\u5c31\u4f1a\u5c06\u8def\u7531\u5bf9\u5e94\u7684\u7ec4\u4ef6\u6e32\u67d3\u5230router-view\u6807\u7b7e\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u6bd4\u5982\u70b9\u51fb\u4e0a\u4f8b\u4e2d\u7684profile/user\u8d85\u94fe\u63a5\uff0cvue\u9996\u5148\u67e5\u627eprofile/user\u5bf9\u5e94\u7684\u8def\u7531\u662f\u4ec0\u4e48\uff0c\u67e5\u627e\u5230\u540e\u518d\u627e\u51fa\u8def\u7531\u5bf9\u5e94\u7684\u7ec4\u4ef6\uff0c\u7136\u540e\u5c06\u7ec4\u4ef6\u6e32\u67d3\u5230router-view\u6807\u7b7e\u3002 \u4e86\u89e3\u4e0a\u8ff0\u6982\u5ff5\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u5199\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u8def\u7531\u793a\u4f8b\uff0c\u6211\u4eec\u9996\u5148\u521b\u5efaindex.html,\u4ee3\u7801\u5982\u4e0b\uff1a <div id=\"app\"> <h1>Hello App!</h1> <p> <!-- \u4f7f\u7528 router-link \u7ec4\u4ef6\u6765\u5bfc\u822a. --> <!-- \u901a\u8fc7\u4f20\u5165 `to` \u5c5e\u6027\u6307\u5b9a\u94fe\u63a5. --> <!-- <router-link> \u9ed8\u8ba4\u4f1a\u88ab\u6e32\u67d3\u6210\u4e00\u4e2a `<a>` \u6807\u7b7e --> <router-link to=\"/profile/user\">\u7528\u6237\u5217\u8868</router-link> </p> <!-- \u8def\u7531\u51fa\u53e3 --> <!-- \u8def\u7531\u5339\u914d\u5230\u7684\u7ec4\u4ef6\u5c06\u6e32\u67d3\u5728\u8fd9\u91cc --> <router-view></router-view> </div> <script src=\"https://unpkg.com/vue/dist/vue.js\"></script> <!-- \u6ce8\u610f\uff0c\u8fd9\u91cc\u5f15\u5165vue-router.js\u5bf9\u4e8escript\u65b9\u5f0f\u5f15\u5165\u6587\u4ef6\u7684\u65b9\u5f0f\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684.\u6211\u4eec\u4ee5\u540e\u518d\u8ba8\u8bba\u4f7f\u7528ES6\u6a21\u5757\u5f15\u5165\u7684\u65b9\u5f0f --> <script src=\"https://unpkg.com/vue-router/dist/vue-router.js\"></script> <!-- \u5e94\u7528\u5165\u53e3\u6587\u4ef6 --> <script src=\"/js/app.js\"></script> \u63a5\u7740\u6211\u4eec\u7ee7\u7eed\u521b\u5efaapp.js\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a // 1. \u5b9a\u4e49\uff08\u8def\u7531\uff09\u7ec4\u4ef6\u3002 // \u5728\u73b0\u5b9e\u7684\u5f00\u53d1\u4e2d\uff0c\u4e00\u822c\u5c06\u7ec4\u4ef6\u653e\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u4ece\u5176\u4ed6\u6587\u4ef6 import \u8fdb\u6765 // \u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u6211\u4eec\u8fd9\u91cc\u5148\u4f7f\u7528\u5b57\u7b26\u4e32\u6a21\u677f\u7ec4\u4ef6\uff0c\u4ee5\u540e\u518d\u8ba8\u8bba\u5355\u6587\u4ef6\u7ec4\u4ef6\uff08.vue\u6587\u4ef6\uff09 const User = { template: '<div>\u8fd9\u91cc\u662f\u7528\u6237\u5217\u8868</div>' } // 2. \u5b9a\u4e49\u8def\u7531 // \u6bcf\u4e2a\u8def\u7531\u5e94\u8be5\u6620\u5c04\u4e00\u4e2a\u7ec4\u4ef6\u3002 \u5176\u4e2d\"component\" \u53ef\u4ee5\u662f // \u901a\u8fc7 Vue.extend() \u521b\u5efa\u7684\u7ec4\u4ef6\u6784\u9020\u5668\uff0c // \u6216\u8005\uff0c\u53ea\u662f\u4e00\u4e2a\u7ec4\u4ef6\u914d\u7f6e\u5bf9\u8c61\u3002 const routes = [ { path: '/profile/user', component: User } ] // 3. \u521b\u5efa router \u5b9e\u4f8b\uff0c\u7136\u540e\u4f20 `routes` \u914d\u7f6e // \u4f60\u8fd8\u53ef\u4ee5\u4f20\u522b\u7684\u914d\u7f6e\u53c2\u6570, \u4e0d\u8fc7\u5148\u8fd9\u4e48\u7b80\u5355\u7740\u5427\u3002 const router = new VueRouter({ routes // ES6\uff08\u7f29\u5199\uff09\u76f8\u5f53\u4e8e routes: routes }) // 4. \u521b\u5efa\u548c\u6302\u8f7d\u6839\u5b9e\u4f8b\u3002 // \u8bb0\u5f97\u8981\u901a\u8fc7 router \u914d\u7f6e\u53c2\u6570\u6ce8\u5165\u8def\u7531\uff0c // \u4ece\u800c\u8ba9\u6574\u4e2a\u5e94\u7528\u90fd\u6709\u8def\u7531\u529f\u80fd const app = new Vue({ router }).$mount('#app') // \u73b0\u5728\uff0c\u5e94\u7528\u5df2\u7ecf\u542f\u52a8\u4e86\uff01 \u81f3\u6b64\uff0c\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u8def\u7531\u5e94\u7528\u5c31\u5b8c\u6210\u4e86\uff0c\u90e8\u7f72\u5230\u670d\u52a1\u5668\u540e\uff0c\u6253\u5f00http://localhost,\u5219\u53ef\u4ee5\u770b\u5230\u754c\u9762\u6709\u4e00\u4e2a\u201c\u7528\u6237\u8be6\u60c5\u201d\u8d85\u94fe\u63a5\uff0c\u70b9\u51fb\u8d85\u94fe\u63a5\uff0c\u754c\u9762\u4f1a\u663e\u793a\u201c\u8fd9\u91cc\u662f\u7528\u6237\u5217\u8868\u201d\uff0c\u540c\u65f6\u754c\u9762\u5e76\u6ca1\u6709\u5237\u65b0\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u5728\u4e00\u4e2a\u754c\u9762\u5185\u5b8c\u6210\uff0c\u6240\u4ee5\u8fd9\u4e5f\u53eb\u5355\u9875\u5e94\u7528\uff0c\u4e0e\u4ee5\u524d\u90a3\u4e9b\u70b9\u51fb\u8d85\u94fe\u63a5\u5c31\u8981\u5237\u65b0\u9875\u9762\u7684\u5e94\u7528\u76f8\u6bd4\u662f\u4e0d\u662f\u7528\u6237\u4f53\u9a8c\u66f4\u9ad8\uff1f \u52a8\u6001\u8def\u7531 \u00b6 \u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7684url\u91cc\u9762\u9700\u8981\u5e26\u53c2\u6570\uff0c\u6bd4\u5982\u4e0a\u4f8b\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u67e5\u770b\u4e0d\u540c\u7528\u6237\u7684\u8be6\u60c5\uff0c\u90a3\u4e48url\u5e94\u8be5\u662f/profile/user/1\u8fd9\u6837\uff0c\u91cc\u9762\u7684\u201c1\u201d\u5373\u7528\u6237ID\uff0c\u53ef\u4ee5\u52a8\u6001\u53d8\u5316\uff0c\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u6211\u4eec\u7684\u8def\u7531\u5b9a\u4e49\u505a\u4e00\u4e9b\u5fae\u5c0f\u53d8\u52a8\u3002 const routes = [ { path: '/profile/user/:id', component: User } ] const router = new VueRouter({ routes // ES6\uff08\u7f29\u5199\uff09\u76f8\u5f53\u4e8e routes: routes }) \u53ef\u4ee5\u770b\u5230\u8def\u7531\u7684\u5b9a\u4e49\u552f\u4e00\u4e0d\u540c\u7684\u5730\u65b9\u5c31\u662f\u5728url\u4e0a\u52a0\u4e86\u201c:id\u201d\u5360\u4f4d\u7b26\uff0c\u90a3\u4e48\u50cf\u201c/profile/user/1\u201d\u3001\u201c/profile/user/2\u201d\u8fd9\u6837\u7684url\u90fd\u4f1a\u5339\u914d\u5230\u8fd9\u4e2a\u8def\u7531\u3002 \u4e00\u4e2a\u300e\u8def\u5f84\u53c2\u6570\u300f\u4f7f\u7528\u5192\u53f7 : \u6807\u8bb0\u3002\u5f53\u5339\u914d\u5230\u4e00\u4e2a\u8def\u7531\u65f6\uff0c\u53c2\u6570\u503c\u4f1a\u88ab\u8bbe\u7f6e\u5230 this.$route.params\uff0c\u53ef\u4ee5\u5728\u6bcf\u4e2a\u7ec4\u4ef6\u5185\u4f7f\u7528\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u65b0 User \u7684\u6a21\u677f\uff0c\u8f93\u51fa\u5f53\u524d\u7528\u6237\u7684 ID\uff1a const User = { template: '<div>\u8fd9\u91cc\u662f\u7528\u6237# {{ $route.params.id }}\u8be6\u60c5\u9875</div>' } \u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u8def\u7531\u4e2d\u8bbe\u7f6e\u591a\u6bb5\u300e\u8def\u5f84\u53c2\u6570\u300f\uff0c\u5bf9\u5e94\u7684\u503c\u90fd\u4f1a\u8bbe\u7f6e\u5230 route.params \u4e2d\u3002\u4f8b\u5982\uff1aprofile/user/:id/post/:pid\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 route.params \u4e2d\u3002\u4f8b\u5982\uff1aprofile/user/:id/post/:pid\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 route.params.id\u548c route.params.pid\u6765\u5f15\u7528\u8def\u7531\u53c2\u6570\u3002\u5982\u679curl\u5e26\u6709\u67e5\u8be2\u53c2\u6570\uff0c\u5219\u53c2\u6570\u4f1a\u88ab\u8bbe\u7f6e\u5230 route.params.pid\u6765\u5f15\u7528\u8def\u7531\u53c2\u6570\u3002\u5982\u679curl\u5e26\u6709\u67e5\u8be2\u53c2\u6570\uff0c\u5219\u53c2\u6570\u4f1a\u88ab\u8bbe\u7f6e\u5230 route.query\u5bf9\u8c61\u3002 \u5d4c\u5957\u8def\u7531 \u00b6 \u5728\u5b9e\u9645\u7684\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u78b0\u5230\u67d0\u4e2a\u9875\u9762\u4e0b\u9762\u8fd8\u6709\u5b50\u9875\u9762\u7684\u60c5\u51b5\uff0c\u6bd4\u5982\u7528\u6237\u5217\u8868\u9875\u9762\u91cc\u9762\u70b9\u51fb\u67d0\u4e2a\u7528\u6237\uff0c\u663e\u793a\u7528\u6237\u8be6\u60c5\uff0c\u6211\u4eec\u5b9a\u4e49/profile/user\u4e3a\u7528\u6237\u5217\u8868url\uff0c/profile/user/:id\u4e3a\u7528\u6237\u8be6\u60c5url\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2aURL\u5c31\u662f\u7236\u5b50\u5173\u7cfb\uff0c\u5373\u5d4c\u5957\u5173\u7cfb\uff0c\u8fd9\u6837\u7684URL\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u5b9a\u4e49\u5462\uff1f const routes = [ { path: '/profile/user', component: User, children: [ { path: ':id', component: UserProfile } ] } ] \u4f60\u4f1a\u53d1\u73b0\uff0cchildren \u914d\u7f6e\u5c31\u662f\u50cf routes \u914d\u7f6e\u4e00\u6837\u7684\u8def\u7531\u914d\u7f6e\u6570\u7ec4\uff0c\u6240\u4ee5\u5462\uff0c\u4f60\u53ef\u4ee5\u5d4c\u5957\u591a\u5c42\u8def\u7531\u3002 \u4e0a\u9762\u53ea\u662f\u5b9a\u4e49\u4e86\u8def\u7531\u7684\u7ed3\u6784\uff0c\u5982\u679c\u8981\u5728\u7236\u9875\u9762\u91cc\u9762\u663e\u793a\u5b50\u9875\u9762\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u7236\u9875\u9762\u7684\u6a21\u677f\u6211\u4eec\u8be5\u5982\u4f55\u5b9a\u4e49\uff1f\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u8bf4\u8fc7\uff0c\u8981\u8ba9\u8def\u7531\u7684\u7ec4\u4ef6\u80fd\u5728\u9875\u9762\u4e2d\u6e32\u67d3\uff0c\u5fc5\u987b\u5728\u9875\u9762\u4e2d\u653erouter-view\u7ec4\u4ef6\uff0c\u90a3\u4e48\u7236\u9875\u9762\u7684\u6a21\u677f\u7684\u5b9a\u4e49\u53ef\u4ee5\u8fd9\u6837\uff1a const User = { template: ` <div class=\"user\"> <h2>\u8fd9\u662f\u7528\u6237\u5217\u8868\u9875\u9762</h2> <router-link to=\"/profile/user/1\">root</router-link> <router-link to=\"/profile/user/2\">test</router-link> <router-view></router-view> </div> ` } \u7f16\u7a0b\u5f0f\u7684\u5bfc\u822a \u00b6 \u9664\u4e86\u4f7f\u7528 \u521b\u5efa a \u6807\u7b7e\u6765\u5b9a\u4e49\u5bfc\u822a\u94fe\u63a5\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u501f\u52a9 router \u7684\u5b9e\u4f8b\u65b9\u6cd5\uff0c\u901a\u8fc7\u7f16\u5199\u4ee3\u7801\u6765\u5b9e\u73b0\u3002 router.push(location) \u00b6 \u60f3\u8981\u5bfc\u822a\u5230\u4e0d\u540c\u7684 URL\uff0c\u5219\u4f7f\u7528 router.push \u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u5411 history \u6808\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u8bb0\u5f55\uff0c\u6240\u4ee5\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u6d4f\u89c8\u5668\u540e\u9000\u6309\u94ae\u65f6\uff0c\u5219\u56de\u5230\u4e4b\u524d\u7684 URL\u3002 \u5f53\u4f60\u70b9\u51fb \u65f6\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u5728\u5185\u90e8\u8c03\u7528\uff0c\u6240\u4ee5\u8bf4\uff0c\u70b9\u51fb \u7b49\u540c\u4e8e\u8c03\u7528 router.push(...)\u3002\u8be5\u65b9\u6cd5\u7684\u53c2\u6570\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u8def\u5f84\uff0c\u6216\u8005\u4e00\u4e2a\u63cf\u8ff0\u5730\u5740\u7684\u5bf9\u8c61\u3002\u4f8b\u5982\uff1a // \u5b57\u7b26\u4e32 router.push('home') // \u5bf9\u8c61 router.push({ path: 'home' }) // \u547d\u540d\u7684\u8def\u7531 router.push({ name: 'user', params: { userId: 123 }}) // \u5e26\u67e5\u8be2\u53c2\u6570\uff0c\u53d8\u6210 /register?plan=private router.push({ path: 'register', query: { plan: 'private' }}) router.replace(location) \u00b6 \u8ddf router.push \u5f88\u50cf\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5c31\u662f\uff0c\u5b83\u4e0d\u4f1a\u5411 history \u6dfb\u52a0\u65b0\u8bb0\u5f55\uff0c\u800c\u662f\u8ddf\u5b83\u7684\u65b9\u6cd5\u540d\u4e00\u6837 \u2014\u2014 \u66ff\u6362\u6389\u5f53\u524d\u7684 history \u8bb0\u5f55\u3002 router.go(n) \u00b6 \u8fd9\u4e2a\u65b9\u6cd5\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u6574\u6570\uff0c\u610f\u601d\u662f\u5728 history \u8bb0\u5f55\u4e2d\u5411\u524d\u6216\u8005\u540e\u9000\u591a\u5c11\u6b65\uff0c\u7c7b\u4f3c window.history.go(n)\u3002 // \u5728\u6d4f\u89c8\u5668\u8bb0\u5f55\u4e2d\u524d\u8fdb\u4e00\u6b65\uff0c\u7b49\u540c\u4e8e history.forward() router.go(1) // \u540e\u9000\u4e00\u6b65\u8bb0\u5f55\uff0c\u7b49\u540c\u4e8e history.back() router.go(-1) // \u524d\u8fdb 3 \u6b65\u8bb0\u5f55 router.go(3) // \u5982\u679c history \u8bb0\u5f55\u4e0d\u591f\u7528\uff0c\u90a3\u5c31\u9ed8\u9ed8\u5730\u5931\u8d25\u5457 router.go(-100) router.go(100) \u547d\u540d\u8def\u7531 \u00b6 \u5230\u6b64\u4e3a\u6b62\uff0c\u6211\u4eec\u4f8b\u5b50\u4e2d\u5b9a\u4e49\u7684\u8def\u7531\u90fd\u53ea\u6709path\u548ccomponent\u4e24\u4e2a\u5c5e\u6027\uff0c\u6709\u65f6\u5019\uff0c\u901a\u8fc7\u4e00\u4e2a\u540d\u79f0\u6765\u6807\u8bc6\u4e00\u4e2a\u8def\u7531\u663e\u5f97\u66f4\u65b9\u4fbf\u4e00\u4e9b\uff0c\u7279\u522b\u662f\u5728\u94fe\u63a5\u4e00\u4e2a\u8def\u7531\uff0c\u6216\u8005\u662f\u6267\u884c\u4e00\u4e9b\u8df3\u8f6c\u7684\u65f6\u5019\u3002\u4f60\u53ef\u4ee5\u5728\u521b\u5efa Router \u5b9e\u4f8b\u7684\u65f6\u5019\uff0c\u5728 routes \u914d\u7f6e\u4e2d\u7ed9\u67d0\u4e2a\u8def\u7531\u8bbe\u7f6e\u540d\u79f0\u3002 const router = new VueRouter({ routes: [ { path: '/profile/user/:id', name: 'user', component: User } ] }) \u8981\u94fe\u63a5\u5230\u4e00\u4e2a\u547d\u540d\u8def\u7531\uff0c\u53ef\u4ee5\u7ed9 router-link \u7684 to \u5c5e\u6027\u4f20\u4e00\u4e2a\u5bf9\u8c61\uff1a <router-link :to=\"{ name: 'user', params: { id: 123 }}\">User</router-link> \u547d\u540d\u89c6\u56fe \u00b6 \u6211\u4eec\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u7684\u6a21\u677f\u91cc\u9762\u90fd\u53ea\u6709\u4e00\u4e2arouter-view\u7ec4\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u8def\u7531\u53ea\u80fd\u6e32\u67d3\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u4f46\u662f\u6709\u65f6\u5019\u60f3\u540c\u65f6\uff08\u540c\u7ea7\uff09\u5c55\u793a\u591a\u4e2a\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u5d4c\u5957\u5c55\u793a\uff0c\u4f8b\u5982\u521b\u5efa\u4e00\u4e2a\u5e03\u5c40\uff0c\u6709 sidebar\uff08\u4fa7\u5bfc\u822a\uff09 \u548c main\uff08\u4e3b\u5185\u5bb9\uff09 \u4e24\u4e2a\u89c6\u56fe\uff0c\u8fd9\u4e2a\u65f6\u5019\u547d\u540d\u89c6\u56fe\u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\u3002\u4f60\u53ef\u4ee5\u5728\u754c\u9762\u4e2d\u62e5\u6709\u591a\u4e2a\u5355\u72ec\u547d\u540d\u7684\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u53ea\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u51fa\u53e3\u3002\u5982\u679c router-view \u6ca1\u6709\u8bbe\u7f6e\u540d\u5b57\uff0c\u90a3\u4e48\u9ed8\u8ba4\u4e3a default\u3002 <router-view class=\"view one\"></router-view> <router-view class=\"view two\" name=\"a\"></router-view> <router-view class=\"view three\" name=\"b\"></router-view> \u4e00\u4e2a\u89c6\u56fe\u4f7f\u7528\u4e00\u4e2a\u7ec4\u4ef6\u6e32\u67d3\uff0c\u56e0\u6b64\u5bf9\u4e8e\u540c\u4e2a\u8def\u7531\uff0c\u591a\u4e2a\u89c6\u56fe\u5c31\u9700\u8981\u591a\u4e2a\u7ec4\u4ef6\u3002\u786e\u4fdd\u6b63\u786e\u4f7f\u7528 components \u914d\u7f6e\uff08\u5e26\u4e0a s\uff09\uff1a const router = new VueRouter({ routes: [ path: '/', components: { default: Foo, a: Bar, b: Baz } } ] }) \u91cd\u5b9a\u5411 \u548c \u522b\u540d \u00b6 \u91cd\u5b9a\u5411 \u00b6 \u91cd\u5b9a\u5411\u4e5f\u662f\u901a\u8fc7 routes \u914d\u7f6e\u6765\u5b8c\u6210\uff0c\u4e0b\u9762\u4f8b\u5b50\u662f\u4ece /a \u91cd\u5b9a\u5411\u5230 /b\uff1a const router = new VueRouter({ routes: [ { path: '/a', redirect: '/b' } ] }) \u91cd\u5b9a\u5411\u7684\u76ee\u6807\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u547d\u540d\u7684\u8def\u7531\uff1a const router = new VueRouter({ routes: [ { path: '/a', redirect: { name: 'foo' }} ] }) \u751a\u81f3\u662f\u4e00\u4e2a\u65b9\u6cd5\uff0c\u52a8\u6001\u8fd4\u56de\u91cd\u5b9a\u5411\u76ee\u6807\uff1a const router = new VueRouter({ routes: [ { path: '/a', redirect: to => { // \u65b9\u6cd5\u63a5\u6536 \u76ee\u6807\u8def\u7531 \u4f5c\u4e3a\u53c2\u6570 // return \u91cd\u5b9a\u5411\u7684 \u5b57\u7b26\u4e32\u8def\u5f84/\u8def\u5f84\u5bf9\u8c61 }} ] }) \u522b\u540d \u00b6 \u300e\u91cd\u5b9a\u5411\u300f\u7684\u610f\u601d\u662f\uff0c\u5f53\u7528\u6237\u8bbf\u95ee /a\u65f6\uff0cURL \u5c06\u4f1a\u88ab\u66ff\u6362\u6210 /b\uff0c\u7136\u540e\u5339\u914d\u8def\u7531\u4e3a /b\uff0c\u90a3\u4e48\u300e\u522b\u540d\u300f\u53c8\u662f\u4ec0\u4e48\u5462\uff1f /a \u7684\u522b\u540d\u662f /b\uff0c\u610f\u5473\u7740\uff0c\u5f53\u7528\u6237\u8bbf\u95ee /b \u65f6\uff0cURL \u4f1a\u4fdd\u6301\u4e3a /b\uff0c\u4f46\u662f\u8def\u7531\u5339\u914d\u5219\u4e3a /a\uff0c\u5c31\u50cf\u7528\u6237\u8bbf\u95ee /a \u4e00\u6837\u3002 \u4e0a\u9762\u5bf9\u5e94\u7684\u8def\u7531\u914d\u7f6e\u4e3a\uff1a const router = new VueRouter({ routes: [ { path: '/a', component: A, alias: '/b' } ] })","title":"\"Vue\u8def\u7531\u5165\u95e8\""},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#1","text":"Vue\u8def\u7531\uff08vue-router\uff09\u662fVue\u7528\u6765\u521b\u5efa\u5355\u9875\u5e94\u7528\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u4f7f\u7528vue-router\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u521b\u5efa\u65e0\u5237\u65b0\u5207\u6362\u9875\u9762\u7684\u5e94\u7528\u3002vue-router\u57fa\u4e8evue\u7684\u7ec4\u4ef6\u7cfb\u7edf\uff08\u4e0d\u719f\u6089\u7ec4\u4ef6\u8bf7\u5148\u5b66\u4e60Vue\u7ec4\u4ef6\uff09\uff0c\u8981\u4f7f\u7528vue-router\u53ea\u9700\u8981\u5c06\u8def\u5f84\u548c\u7ec4\u4ef6\u5efa\u7acb\u5bf9\u5e94\u5173\u7cfb\uff0c\u8fd9\u6837\u8def\u7531\u7cfb\u7edf\u5c31\u77e5\u9053\u54ea\u4e2a\u8def\u5f84\u9700\u8981\u6e32\u67d3\u54ea\u4e2a\u7ec4\u4ef6\u3002","title":"1\u3001\u6982\u8ff0"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#2","text":"\u5728\u5f00\u59cb\u5199\u7b2c\u4e00\u4e2a\u8def\u7531\u793a\u4f8b\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u4e86\u89e3\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u3002 \uff081\uff09\u8def\u7531 \u8def\u7531\u5373url\u8def\u5f84\u548c\u7ec4\u4ef6\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002 \uff082\uff09router-link\u7ec4\u4ef6 router-link\u7ec4\u4ef6\u5373\u9875\u9762\u4e0a\u8fde\u63a5\u5230\u67d0\u4e2a\u8def\u7531\u7684\u8d85\u94fe\u63a5\uff0c\u6700\u7ec8\u6e32\u67d3\u540e\u4f1a\u53d8\u6210a\u6807\u7b7e\u3002\u6bd4\u5982\u6211\u9700\u8981\u5728\u9875\u9762\u4e0a\u8bbe\u7f6e\u8fde\u63a5\u5230/profile/user\u7684\u8d85\u94fe\u63a5\uff0c\u5219\u53ea\u8981\u5728\u9875\u9762\u653e\u4e0a<router-link to=\"/profile/user\">\u7528\u6237\u5217\u8868</router-link>\u5c31\u884c\u4e86\u3002 \uff083\uff09router-view\u7ec4\u4ef6 router-view\u7ec4\u4ef6\u662f\u8def\u7531\u7ec4\u4ef6\u6e32\u67d3\u7684\u5bb9\u5668\uff0c\u4e00\u65e6\u8def\u7531\u5339\u914d\u5230\u4e86\uff0cvue\u5c31\u4f1a\u5c06\u8def\u7531\u5bf9\u5e94\u7684\u7ec4\u4ef6\u6e32\u67d3\u5230router-view\u6807\u7b7e\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u6bd4\u5982\u70b9\u51fb\u4e0a\u4f8b\u4e2d\u7684profile/user\u8d85\u94fe\u63a5\uff0cvue\u9996\u5148\u67e5\u627eprofile/user\u5bf9\u5e94\u7684\u8def\u7531\u662f\u4ec0\u4e48\uff0c\u67e5\u627e\u5230\u540e\u518d\u627e\u51fa\u8def\u7531\u5bf9\u5e94\u7684\u7ec4\u4ef6\uff0c\u7136\u540e\u5c06\u7ec4\u4ef6\u6e32\u67d3\u5230router-view\u6807\u7b7e\u3002 \u4e86\u89e3\u4e0a\u8ff0\u6982\u5ff5\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u5199\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u8def\u7531\u793a\u4f8b\uff0c\u6211\u4eec\u9996\u5148\u521b\u5efaindex.html,\u4ee3\u7801\u5982\u4e0b\uff1a <div id=\"app\"> <h1>Hello App!</h1> <p> <!-- \u4f7f\u7528 router-link \u7ec4\u4ef6\u6765\u5bfc\u822a. --> <!-- \u901a\u8fc7\u4f20\u5165 `to` \u5c5e\u6027\u6307\u5b9a\u94fe\u63a5. --> <!-- <router-link> \u9ed8\u8ba4\u4f1a\u88ab\u6e32\u67d3\u6210\u4e00\u4e2a `<a>` \u6807\u7b7e --> <router-link to=\"/profile/user\">\u7528\u6237\u5217\u8868</router-link> </p> <!-- \u8def\u7531\u51fa\u53e3 --> <!-- \u8def\u7531\u5339\u914d\u5230\u7684\u7ec4\u4ef6\u5c06\u6e32\u67d3\u5728\u8fd9\u91cc --> <router-view></router-view> </div> <script src=\"https://unpkg.com/vue/dist/vue.js\"></script> <!-- \u6ce8\u610f\uff0c\u8fd9\u91cc\u5f15\u5165vue-router.js\u5bf9\u4e8escript\u65b9\u5f0f\u5f15\u5165\u6587\u4ef6\u7684\u65b9\u5f0f\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684.\u6211\u4eec\u4ee5\u540e\u518d\u8ba8\u8bba\u4f7f\u7528ES6\u6a21\u5757\u5f15\u5165\u7684\u65b9\u5f0f --> <script src=\"https://unpkg.com/vue-router/dist/vue-router.js\"></script> <!-- \u5e94\u7528\u5165\u53e3\u6587\u4ef6 --> <script src=\"/js/app.js\"></script> \u63a5\u7740\u6211\u4eec\u7ee7\u7eed\u521b\u5efaapp.js\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a // 1. \u5b9a\u4e49\uff08\u8def\u7531\uff09\u7ec4\u4ef6\u3002 // \u5728\u73b0\u5b9e\u7684\u5f00\u53d1\u4e2d\uff0c\u4e00\u822c\u5c06\u7ec4\u4ef6\u653e\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u4ece\u5176\u4ed6\u6587\u4ef6 import \u8fdb\u6765 // \u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u6211\u4eec\u8fd9\u91cc\u5148\u4f7f\u7528\u5b57\u7b26\u4e32\u6a21\u677f\u7ec4\u4ef6\uff0c\u4ee5\u540e\u518d\u8ba8\u8bba\u5355\u6587\u4ef6\u7ec4\u4ef6\uff08.vue\u6587\u4ef6\uff09 const User = { template: '<div>\u8fd9\u91cc\u662f\u7528\u6237\u5217\u8868</div>' } // 2. \u5b9a\u4e49\u8def\u7531 // \u6bcf\u4e2a\u8def\u7531\u5e94\u8be5\u6620\u5c04\u4e00\u4e2a\u7ec4\u4ef6\u3002 \u5176\u4e2d\"component\" \u53ef\u4ee5\u662f // \u901a\u8fc7 Vue.extend() \u521b\u5efa\u7684\u7ec4\u4ef6\u6784\u9020\u5668\uff0c // \u6216\u8005\uff0c\u53ea\u662f\u4e00\u4e2a\u7ec4\u4ef6\u914d\u7f6e\u5bf9\u8c61\u3002 const routes = [ { path: '/profile/user', component: User } ] // 3. \u521b\u5efa router \u5b9e\u4f8b\uff0c\u7136\u540e\u4f20 `routes` \u914d\u7f6e // \u4f60\u8fd8\u53ef\u4ee5\u4f20\u522b\u7684\u914d\u7f6e\u53c2\u6570, \u4e0d\u8fc7\u5148\u8fd9\u4e48\u7b80\u5355\u7740\u5427\u3002 const router = new VueRouter({ routes // ES6\uff08\u7f29\u5199\uff09\u76f8\u5f53\u4e8e routes: routes }) // 4. \u521b\u5efa\u548c\u6302\u8f7d\u6839\u5b9e\u4f8b\u3002 // \u8bb0\u5f97\u8981\u901a\u8fc7 router \u914d\u7f6e\u53c2\u6570\u6ce8\u5165\u8def\u7531\uff0c // \u4ece\u800c\u8ba9\u6574\u4e2a\u5e94\u7528\u90fd\u6709\u8def\u7531\u529f\u80fd const app = new Vue({ router }).$mount('#app') // \u73b0\u5728\uff0c\u5e94\u7528\u5df2\u7ecf\u542f\u52a8\u4e86\uff01 \u81f3\u6b64\uff0c\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u8def\u7531\u5e94\u7528\u5c31\u5b8c\u6210\u4e86\uff0c\u90e8\u7f72\u5230\u670d\u52a1\u5668\u540e\uff0c\u6253\u5f00http://localhost,\u5219\u53ef\u4ee5\u770b\u5230\u754c\u9762\u6709\u4e00\u4e2a\u201c\u7528\u6237\u8be6\u60c5\u201d\u8d85\u94fe\u63a5\uff0c\u70b9\u51fb\u8d85\u94fe\u63a5\uff0c\u754c\u9762\u4f1a\u663e\u793a\u201c\u8fd9\u91cc\u662f\u7528\u6237\u5217\u8868\u201d\uff0c\u540c\u65f6\u754c\u9762\u5e76\u6ca1\u6709\u5237\u65b0\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u5728\u4e00\u4e2a\u754c\u9762\u5185\u5b8c\u6210\uff0c\u6240\u4ee5\u8fd9\u4e5f\u53eb\u5355\u9875\u5e94\u7528\uff0c\u4e0e\u4ee5\u524d\u90a3\u4e9b\u70b9\u51fb\u8d85\u94fe\u63a5\u5c31\u8981\u5237\u65b0\u9875\u9762\u7684\u5e94\u7528\u76f8\u6bd4\u662f\u4e0d\u662f\u7528\u6237\u4f53\u9a8c\u66f4\u9ad8\uff1f","title":"2\u3001\u5f00\u59cb"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_1","text":"\u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7684url\u91cc\u9762\u9700\u8981\u5e26\u53c2\u6570\uff0c\u6bd4\u5982\u4e0a\u4f8b\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u67e5\u770b\u4e0d\u540c\u7528\u6237\u7684\u8be6\u60c5\uff0c\u90a3\u4e48url\u5e94\u8be5\u662f/profile/user/1\u8fd9\u6837\uff0c\u91cc\u9762\u7684\u201c1\u201d\u5373\u7528\u6237ID\uff0c\u53ef\u4ee5\u52a8\u6001\u53d8\u5316\uff0c\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u6211\u4eec\u7684\u8def\u7531\u5b9a\u4e49\u505a\u4e00\u4e9b\u5fae\u5c0f\u53d8\u52a8\u3002 const routes = [ { path: '/profile/user/:id', component: User } ] const router = new VueRouter({ routes // ES6\uff08\u7f29\u5199\uff09\u76f8\u5f53\u4e8e routes: routes }) \u53ef\u4ee5\u770b\u5230\u8def\u7531\u7684\u5b9a\u4e49\u552f\u4e00\u4e0d\u540c\u7684\u5730\u65b9\u5c31\u662f\u5728url\u4e0a\u52a0\u4e86\u201c:id\u201d\u5360\u4f4d\u7b26\uff0c\u90a3\u4e48\u50cf\u201c/profile/user/1\u201d\u3001\u201c/profile/user/2\u201d\u8fd9\u6837\u7684url\u90fd\u4f1a\u5339\u914d\u5230\u8fd9\u4e2a\u8def\u7531\u3002 \u4e00\u4e2a\u300e\u8def\u5f84\u53c2\u6570\u300f\u4f7f\u7528\u5192\u53f7 : \u6807\u8bb0\u3002\u5f53\u5339\u914d\u5230\u4e00\u4e2a\u8def\u7531\u65f6\uff0c\u53c2\u6570\u503c\u4f1a\u88ab\u8bbe\u7f6e\u5230 this.$route.params\uff0c\u53ef\u4ee5\u5728\u6bcf\u4e2a\u7ec4\u4ef6\u5185\u4f7f\u7528\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u65b0 User \u7684\u6a21\u677f\uff0c\u8f93\u51fa\u5f53\u524d\u7528\u6237\u7684 ID\uff1a const User = { template: '<div>\u8fd9\u91cc\u662f\u7528\u6237# {{ $route.params.id }}\u8be6\u60c5\u9875</div>' } \u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u8def\u7531\u4e2d\u8bbe\u7f6e\u591a\u6bb5\u300e\u8def\u5f84\u53c2\u6570\u300f\uff0c\u5bf9\u5e94\u7684\u503c\u90fd\u4f1a\u8bbe\u7f6e\u5230 route.params \u4e2d\u3002\u4f8b\u5982\uff1aprofile/user/:id/post/:pid\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 route.params \u4e2d\u3002\u4f8b\u5982\uff1aprofile/user/:id/post/:pid\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 route.params.id\u548c route.params.pid\u6765\u5f15\u7528\u8def\u7531\u53c2\u6570\u3002\u5982\u679curl\u5e26\u6709\u67e5\u8be2\u53c2\u6570\uff0c\u5219\u53c2\u6570\u4f1a\u88ab\u8bbe\u7f6e\u5230 route.params.pid\u6765\u5f15\u7528\u8def\u7531\u53c2\u6570\u3002\u5982\u679curl\u5e26\u6709\u67e5\u8be2\u53c2\u6570\uff0c\u5219\u53c2\u6570\u4f1a\u88ab\u8bbe\u7f6e\u5230 route.query\u5bf9\u8c61\u3002","title":"\u52a8\u6001\u8def\u7531"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_2","text":"\u5728\u5b9e\u9645\u7684\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u78b0\u5230\u67d0\u4e2a\u9875\u9762\u4e0b\u9762\u8fd8\u6709\u5b50\u9875\u9762\u7684\u60c5\u51b5\uff0c\u6bd4\u5982\u7528\u6237\u5217\u8868\u9875\u9762\u91cc\u9762\u70b9\u51fb\u67d0\u4e2a\u7528\u6237\uff0c\u663e\u793a\u7528\u6237\u8be6\u60c5\uff0c\u6211\u4eec\u5b9a\u4e49/profile/user\u4e3a\u7528\u6237\u5217\u8868url\uff0c/profile/user/:id\u4e3a\u7528\u6237\u8be6\u60c5url\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2aURL\u5c31\u662f\u7236\u5b50\u5173\u7cfb\uff0c\u5373\u5d4c\u5957\u5173\u7cfb\uff0c\u8fd9\u6837\u7684URL\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u5b9a\u4e49\u5462\uff1f const routes = [ { path: '/profile/user', component: User, children: [ { path: ':id', component: UserProfile } ] } ] \u4f60\u4f1a\u53d1\u73b0\uff0cchildren \u914d\u7f6e\u5c31\u662f\u50cf routes \u914d\u7f6e\u4e00\u6837\u7684\u8def\u7531\u914d\u7f6e\u6570\u7ec4\uff0c\u6240\u4ee5\u5462\uff0c\u4f60\u53ef\u4ee5\u5d4c\u5957\u591a\u5c42\u8def\u7531\u3002 \u4e0a\u9762\u53ea\u662f\u5b9a\u4e49\u4e86\u8def\u7531\u7684\u7ed3\u6784\uff0c\u5982\u679c\u8981\u5728\u7236\u9875\u9762\u91cc\u9762\u663e\u793a\u5b50\u9875\u9762\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u7236\u9875\u9762\u7684\u6a21\u677f\u6211\u4eec\u8be5\u5982\u4f55\u5b9a\u4e49\uff1f\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u8bf4\u8fc7\uff0c\u8981\u8ba9\u8def\u7531\u7684\u7ec4\u4ef6\u80fd\u5728\u9875\u9762\u4e2d\u6e32\u67d3\uff0c\u5fc5\u987b\u5728\u9875\u9762\u4e2d\u653erouter-view\u7ec4\u4ef6\uff0c\u90a3\u4e48\u7236\u9875\u9762\u7684\u6a21\u677f\u7684\u5b9a\u4e49\u53ef\u4ee5\u8fd9\u6837\uff1a const User = { template: ` <div class=\"user\"> <h2>\u8fd9\u662f\u7528\u6237\u5217\u8868\u9875\u9762</h2> <router-link to=\"/profile/user/1\">root</router-link> <router-link to=\"/profile/user/2\">test</router-link> <router-view></router-view> </div> ` }","title":"\u5d4c\u5957\u8def\u7531"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_3","text":"\u9664\u4e86\u4f7f\u7528 \u521b\u5efa a \u6807\u7b7e\u6765\u5b9a\u4e49\u5bfc\u822a\u94fe\u63a5\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u501f\u52a9 router \u7684\u5b9e\u4f8b\u65b9\u6cd5\uff0c\u901a\u8fc7\u7f16\u5199\u4ee3\u7801\u6765\u5b9e\u73b0\u3002","title":"\u7f16\u7a0b\u5f0f\u7684\u5bfc\u822a"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#routerpushlocation","text":"\u60f3\u8981\u5bfc\u822a\u5230\u4e0d\u540c\u7684 URL\uff0c\u5219\u4f7f\u7528 router.push \u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u5411 history \u6808\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u8bb0\u5f55\uff0c\u6240\u4ee5\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u6d4f\u89c8\u5668\u540e\u9000\u6309\u94ae\u65f6\uff0c\u5219\u56de\u5230\u4e4b\u524d\u7684 URL\u3002 \u5f53\u4f60\u70b9\u51fb \u65f6\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u5728\u5185\u90e8\u8c03\u7528\uff0c\u6240\u4ee5\u8bf4\uff0c\u70b9\u51fb \u7b49\u540c\u4e8e\u8c03\u7528 router.push(...)\u3002\u8be5\u65b9\u6cd5\u7684\u53c2\u6570\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u8def\u5f84\uff0c\u6216\u8005\u4e00\u4e2a\u63cf\u8ff0\u5730\u5740\u7684\u5bf9\u8c61\u3002\u4f8b\u5982\uff1a // \u5b57\u7b26\u4e32 router.push('home') // \u5bf9\u8c61 router.push({ path: 'home' }) // \u547d\u540d\u7684\u8def\u7531 router.push({ name: 'user', params: { userId: 123 }}) // \u5e26\u67e5\u8be2\u53c2\u6570\uff0c\u53d8\u6210 /register?plan=private router.push({ path: 'register', query: { plan: 'private' }})","title":"router.push(location)"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#routerreplacelocation","text":"\u8ddf router.push \u5f88\u50cf\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5c31\u662f\uff0c\u5b83\u4e0d\u4f1a\u5411 history \u6dfb\u52a0\u65b0\u8bb0\u5f55\uff0c\u800c\u662f\u8ddf\u5b83\u7684\u65b9\u6cd5\u540d\u4e00\u6837 \u2014\u2014 \u66ff\u6362\u6389\u5f53\u524d\u7684 history \u8bb0\u5f55\u3002","title":"router.replace(location)"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#routergon","text":"\u8fd9\u4e2a\u65b9\u6cd5\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u6574\u6570\uff0c\u610f\u601d\u662f\u5728 history \u8bb0\u5f55\u4e2d\u5411\u524d\u6216\u8005\u540e\u9000\u591a\u5c11\u6b65\uff0c\u7c7b\u4f3c window.history.go(n)\u3002 // \u5728\u6d4f\u89c8\u5668\u8bb0\u5f55\u4e2d\u524d\u8fdb\u4e00\u6b65\uff0c\u7b49\u540c\u4e8e history.forward() router.go(1) // \u540e\u9000\u4e00\u6b65\u8bb0\u5f55\uff0c\u7b49\u540c\u4e8e history.back() router.go(-1) // \u524d\u8fdb 3 \u6b65\u8bb0\u5f55 router.go(3) // \u5982\u679c history \u8bb0\u5f55\u4e0d\u591f\u7528\uff0c\u90a3\u5c31\u9ed8\u9ed8\u5730\u5931\u8d25\u5457 router.go(-100) router.go(100)","title":"router.go(n)"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_4","text":"\u5230\u6b64\u4e3a\u6b62\uff0c\u6211\u4eec\u4f8b\u5b50\u4e2d\u5b9a\u4e49\u7684\u8def\u7531\u90fd\u53ea\u6709path\u548ccomponent\u4e24\u4e2a\u5c5e\u6027\uff0c\u6709\u65f6\u5019\uff0c\u901a\u8fc7\u4e00\u4e2a\u540d\u79f0\u6765\u6807\u8bc6\u4e00\u4e2a\u8def\u7531\u663e\u5f97\u66f4\u65b9\u4fbf\u4e00\u4e9b\uff0c\u7279\u522b\u662f\u5728\u94fe\u63a5\u4e00\u4e2a\u8def\u7531\uff0c\u6216\u8005\u662f\u6267\u884c\u4e00\u4e9b\u8df3\u8f6c\u7684\u65f6\u5019\u3002\u4f60\u53ef\u4ee5\u5728\u521b\u5efa Router \u5b9e\u4f8b\u7684\u65f6\u5019\uff0c\u5728 routes \u914d\u7f6e\u4e2d\u7ed9\u67d0\u4e2a\u8def\u7531\u8bbe\u7f6e\u540d\u79f0\u3002 const router = new VueRouter({ routes: [ { path: '/profile/user/:id', name: 'user', component: User } ] }) \u8981\u94fe\u63a5\u5230\u4e00\u4e2a\u547d\u540d\u8def\u7531\uff0c\u53ef\u4ee5\u7ed9 router-link \u7684 to \u5c5e\u6027\u4f20\u4e00\u4e2a\u5bf9\u8c61\uff1a <router-link :to=\"{ name: 'user', params: { id: 123 }}\">User</router-link>","title":"\u547d\u540d\u8def\u7531"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_5","text":"\u6211\u4eec\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u7684\u6a21\u677f\u91cc\u9762\u90fd\u53ea\u6709\u4e00\u4e2arouter-view\u7ec4\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u8def\u7531\u53ea\u80fd\u6e32\u67d3\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u4f46\u662f\u6709\u65f6\u5019\u60f3\u540c\u65f6\uff08\u540c\u7ea7\uff09\u5c55\u793a\u591a\u4e2a\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u5d4c\u5957\u5c55\u793a\uff0c\u4f8b\u5982\u521b\u5efa\u4e00\u4e2a\u5e03\u5c40\uff0c\u6709 sidebar\uff08\u4fa7\u5bfc\u822a\uff09 \u548c main\uff08\u4e3b\u5185\u5bb9\uff09 \u4e24\u4e2a\u89c6\u56fe\uff0c\u8fd9\u4e2a\u65f6\u5019\u547d\u540d\u89c6\u56fe\u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\u3002\u4f60\u53ef\u4ee5\u5728\u754c\u9762\u4e2d\u62e5\u6709\u591a\u4e2a\u5355\u72ec\u547d\u540d\u7684\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u53ea\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u51fa\u53e3\u3002\u5982\u679c router-view \u6ca1\u6709\u8bbe\u7f6e\u540d\u5b57\uff0c\u90a3\u4e48\u9ed8\u8ba4\u4e3a default\u3002 <router-view class=\"view one\"></router-view> <router-view class=\"view two\" name=\"a\"></router-view> <router-view class=\"view three\" name=\"b\"></router-view> \u4e00\u4e2a\u89c6\u56fe\u4f7f\u7528\u4e00\u4e2a\u7ec4\u4ef6\u6e32\u67d3\uff0c\u56e0\u6b64\u5bf9\u4e8e\u540c\u4e2a\u8def\u7531\uff0c\u591a\u4e2a\u89c6\u56fe\u5c31\u9700\u8981\u591a\u4e2a\u7ec4\u4ef6\u3002\u786e\u4fdd\u6b63\u786e\u4f7f\u7528 components \u914d\u7f6e\uff08\u5e26\u4e0a s\uff09\uff1a const router = new VueRouter({ routes: [ path: '/', components: { default: Foo, a: Bar, b: Baz } } ] })","title":"\u547d\u540d\u89c6\u56fe"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_6","text":"","title":"\u91cd\u5b9a\u5411 \u548c \u522b\u540d"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_7","text":"\u91cd\u5b9a\u5411\u4e5f\u662f\u901a\u8fc7 routes \u914d\u7f6e\u6765\u5b8c\u6210\uff0c\u4e0b\u9762\u4f8b\u5b50\u662f\u4ece /a \u91cd\u5b9a\u5411\u5230 /b\uff1a const router = new VueRouter({ routes: [ { path: '/a', redirect: '/b' } ] }) \u91cd\u5b9a\u5411\u7684\u76ee\u6807\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u547d\u540d\u7684\u8def\u7531\uff1a const router = new VueRouter({ routes: [ { path: '/a', redirect: { name: 'foo' }} ] }) \u751a\u81f3\u662f\u4e00\u4e2a\u65b9\u6cd5\uff0c\u52a8\u6001\u8fd4\u56de\u91cd\u5b9a\u5411\u76ee\u6807\uff1a const router = new VueRouter({ routes: [ { path: '/a', redirect: to => { // \u65b9\u6cd5\u63a5\u6536 \u76ee\u6807\u8def\u7531 \u4f5c\u4e3a\u53c2\u6570 // return \u91cd\u5b9a\u5411\u7684 \u5b57\u7b26\u4e32\u8def\u5f84/\u8def\u5f84\u5bf9\u8c61 }} ] })","title":"\u91cd\u5b9a\u5411"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#_8","text":"\u300e\u91cd\u5b9a\u5411\u300f\u7684\u610f\u601d\u662f\uff0c\u5f53\u7528\u6237\u8bbf\u95ee /a\u65f6\uff0cURL \u5c06\u4f1a\u88ab\u66ff\u6362\u6210 /b\uff0c\u7136\u540e\u5339\u914d\u8def\u7531\u4e3a /b\uff0c\u90a3\u4e48\u300e\u522b\u540d\u300f\u53c8\u662f\u4ec0\u4e48\u5462\uff1f /a \u7684\u522b\u540d\u662f /b\uff0c\u610f\u5473\u7740\uff0c\u5f53\u7528\u6237\u8bbf\u95ee /b \u65f6\uff0cURL \u4f1a\u4fdd\u6301\u4e3a /b\uff0c\u4f46\u662f\u8def\u7531\u5339\u914d\u5219\u4e3a /a\uff0c\u5c31\u50cf\u7528\u6237\u8bbf\u95ee /a \u4e00\u6837\u3002 \u4e0a\u9762\u5bf9\u5e94\u7684\u8def\u7531\u914d\u7f6e\u4e3a\uff1a const router = new VueRouter({ routes: [ { path: '/a', component: A, alias: '/b' } ] })","title":"\u522b\u540d"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/","tags":"[Vue]","text":"\u5bfc\u822a\u94a9\u5b50 \u00b6 \u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u6709\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u5f53\u9875\u9762\u5207\u6362\u65f6\uff0c\u9700\u8981\u505a\u4e00\u4e9b\u64cd\u4f5c\u6765\u66f4\u6539\u67d0\u4e9b\u4fe1\u606f\uff0c\u8fd9\u5c31\u9700\u8981\u62e6\u622a\u8def\u7531\u5207\u6362\u3002vue-router \u63d0\u4f9b\u4e86\u5bfc\u822a\u94a9\u5b50\u6765\u62e6\u622a\u5bfc\u822a\uff0c\u8ba9\u5b83\u5b8c\u6210\u8df3\u8f6c\u6216\u53d6\u6d88\u3002\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5728\u8def\u7531\u5bfc\u822a\u53d1\u751f\u65f6\u6267\u884c\u94a9\u5b50\uff1a\u5168\u5c40\u7684, \u5355\u4e2a\u8def\u7531\u72ec\u4eab\u7684, \u6216\u8005\u7ec4\u4ef6\u7ea7\u7684\u3002 \u5168\u5c40\u94a9\u5b50 \u00b6 \u4f60\u53ef\u4ee5\u4f7f\u7528 router.beforeEach \u6ce8\u518c\u4e00\u4e2a\u5168\u5c40\u7684 before \u94a9\u5b50\uff1a const router = new VueRouter({ ... }) router.beforeEach((to, from, next) => { // ... }) \u5f53\u4e00\u4e2a\u5bfc\u822a\u89e6\u53d1\u65f6\uff0c\u5168\u5c40\u7684 before \u94a9\u5b50\u6309\u7167\u521b\u5efa\u987a\u5e8f\u8c03\u7528\u3002\u94a9\u5b50\u662f\u5f02\u6b65\u89e3\u6790\u6267\u884c\uff0c\u6b64\u65f6\u5bfc\u822a\u5728\u6240\u6709\u94a9\u5b50 resolve \u5b8c\u4e4b\u524d\u4e00\u76f4\u5904\u4e8e \u7b49\u5f85\u4e2d\u3002 \u6bcf\u4e2a\u94a9\u5b50\u65b9\u6cd5\u63a5\u6536\u4e09\u4e2a\u53c2\u6570\uff1a to: Route: \u5373\u5c06\u8981\u8fdb\u5165\u7684\u76ee\u6807 \u8def\u7531\u5bf9\u8c61 from: Route: \u5f53\u524d\u5bfc\u822a\u6b63\u8981\u79bb\u5f00\u7684\u8def\u7531 next: Function: \u4e00\u5b9a\u8981\u8c03\u7528\u8be5\u65b9\u6cd5\u6765 resolve \u8fd9\u4e2a\u94a9\u5b50\u3002\u6267\u884c\u6548\u679c\u4f9d\u8d56 next \u65b9\u6cd5\u7684\u8c03\u7528\u53c2\u6570\u3002 next(): \u8fdb\u884c\u7ba1\u9053\u4e2d\u7684\u4e0b\u4e00\u4e2a\u94a9\u5b50\u3002\u5982\u679c\u5168\u90e8\u94a9\u5b50\u6267\u884c\u5b8c\u4e86\uff0c\u5219\u5bfc\u822a\u7684\u72b6\u6001\u5c31\u662f confirmed \uff08\u786e\u8ba4\u7684\uff09\u3002 next(false): \u4e2d\u65ad\u5f53\u524d\u7684\u5bfc\u822a\u3002\u5982\u679c\u6d4f\u89c8\u5668\u7684 URL \u6539\u53d8\u4e86\uff08\u53ef\u80fd\u662f\u7528\u6237\u624b\u52a8\u6216\u8005\u6d4f\u89c8\u5668\u540e\u9000\u6309\u94ae\uff09\uff0c\u90a3\u4e48 URL \u5730\u5740\u4f1a\u91cd\u7f6e\u5230 from \u8def\u7531\u5bf9\u5e94\u7684\u5730\u5740\u3002 next('/') \u6216\u8005 next({ path: '/' }): \u8df3\u8f6c\u5230\u4e00\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u3002\u5f53\u524d\u7684\u5bfc\u822a\u88ab\u4e2d\u65ad\uff0c\u7136\u540e\u8fdb\u884c\u4e00\u4e2a\u65b0\u7684\u5bfc\u822a\u3002 \u786e\u4fdd\u8981\u8c03\u7528 next \u65b9\u6cd5\uff0c\u5426\u5219\u94a9\u5b50\u5c31\u4e0d\u4f1a\u88ab resolved\u3002 \u540c\u6837\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2a\u5168\u5c40\u7684 after \u94a9\u5b50\uff0c\u4e0d\u8fc7\u5b83\u4e0d\u50cf before \u94a9\u5b50\u90a3\u6837\uff0cafter \u94a9\u5b50\u6ca1\u6709 next \u65b9\u6cd5\uff0c\u4e0d\u80fd\u6539\u53d8\u5bfc\u822a\uff1a router.afterEach(route => { // ... }) \u67d0\u4e2a\u8def\u7531\u72ec\u4eab\u7684\u94a9\u5b50 \u00b6 \u4f60\u53ef\u4ee5\u5728\u8def\u7531\u914d\u7f6e\u4e0a\u76f4\u63a5\u5b9a\u4e49 beforeEnter \u94a9\u5b50\uff1a const router = new VueRouter({ routes: [ { path: '/foo', component: Foo, beforeEnter: (to, from, next) => { // ... } } ] }) \u8fd9\u4e9b\u94a9\u5b50\u4e0e\u5168\u5c40 before \u94a9\u5b50\u7684\u65b9\u6cd5\u53c2\u6570\u662f\u4e00\u6837\u7684\u3002 \u7ec4\u4ef6\u5185\u7684\u94a9\u5b50 \u00b6 \u6700\u540e\uff0c\u4f60\u53ef\u4ee5\u5728\u8def\u7531\u7ec4\u4ef6\u5185\u76f4\u63a5\u5b9a\u4e49\u4ee5\u4e0b\u8def\u7531\u5bfc\u822a\u94a9\u5b50\uff1a beforeRouteEnter beforeRouteUpdate (2.2 \u65b0\u589e) beforeRouteLeave const Foo = { template: `...`, beforeRouteEnter (to, from, next) { // \u5728\u6e32\u67d3\u8be5\u7ec4\u4ef6\u7684\u5bf9\u5e94\u8def\u7531\u88ab confirm \u524d\u8c03\u7528 // \u4e0d\uff01\u80fd\uff01\u83b7\u53d6\u7ec4\u4ef6\u5b9e\u4f8b `this` // \u56e0\u4e3a\u5f53\u94a9\u5b50\u6267\u884c\u524d\uff0c\u7ec4\u4ef6\u5b9e\u4f8b\u8fd8\u6ca1\u88ab\u521b\u5efa }, beforeRouteUpdate (to, from, next) { // \u5728\u5f53\u524d\u8def\u7531\u6539\u53d8\uff0c\u4f46\u662f\u6539\u7ec4\u4ef6\u88ab\u590d\u7528\u65f6\u8c03\u7528 // \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5e26\u6709\u52a8\u6001\u53c2\u6570\u7684\u8def\u5f84 /foo/:id\uff0c\u5728 /foo/1 \u548c /foo/2 \u4e4b\u95f4\u8df3\u8f6c\u7684\u65f6\u5019\uff0c // \u7531\u4e8e\u4f1a\u6e32\u67d3\u540c\u6837\u7684 Foo \u7ec4\u4ef6\uff0c\u56e0\u6b64\u7ec4\u4ef6\u5b9e\u4f8b\u4f1a\u88ab\u590d\u7528\u3002\u800c\u8fd9\u4e2a\u94a9\u5b50\u5c31\u4f1a\u5728\u8fd9\u4e2a\u60c5\u51b5\u4e0b\u88ab\u8c03\u7528\u3002 // \u53ef\u4ee5\u8bbf\u95ee\u7ec4\u4ef6\u5b9e\u4f8b `this` }, beforeRouteLeave (to, from, next) { // \u5bfc\u822a\u79bb\u5f00\u8be5\u7ec4\u4ef6\u7684\u5bf9\u5e94\u8def\u7531\u65f6\u8c03\u7528 // \u53ef\u4ee5\u8bbf\u95ee\u7ec4\u4ef6\u5b9e\u4f8b `this` } } \u4ecb\u7ecd\u5b8c\u4e0a\u8ff0\u4e09\u79cd\u4e0d\u540c\u4f5c\u7528\u57df\u7684\u5bfc\u822a\u94a9\u5b50\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u66f4\u5b9e\u9645\u7684\u4f8b\u5b50\u3002\u4f7f\u7528vue-router\u4e4b\u540e\uff0c\u9875\u9762\u7684\u5207\u6362\u65f6\u65e0\u5237\u65b0\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u548c\u670d\u52a1\u7aef\u6ca1\u6709\u4ea4\u4e92\uff0c\u8fd9\u6837\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u67d0\u4e2a\u9875\u9762\u8fd9\u4e2a\u7528\u6237\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\uff0c\u8fd9\u4e2a\u5982\u4f55\u6765\u63a7\u5236\uff1f\u6709\u4e86\u5bfc\u822a\u94a9\u5b50\uff0c\u8fd9\u4e2a\u81ea\u7136\u5c31\u53ef\u4ee5\u653e\u5230\u5bfc\u822a\u94a9\u5b50\u6765\u6267\u884c\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a // \u6743\u9650\u6570\u7ec4 const permissions = { 'user': 1, // \u5176\u4e2duser\u8868\u793a\u8def\u7531\u540d\u79f0 1\u8868\u793a\u6709\u6743\u9650\u8bbf\u95ee 0 \u8868\u793a\u65e0\u6743\u9650\u8bbf\u95ee 'userProfile': 0 } router.beforeEach((to, from, next) => { let name = to.name; if (name) { if (permissions[name]) { next(); } else { alert(\u65e0\u6743\u9650\u8bbf\u95ee); next(false); } } else { next(); } }) \u8def\u7531\u5143\u4fe1\u606f \u00b6 \u8def\u7531\u5b9a\u4e49\u7684\u65f6\u5019\uff0c\u9664\u4e86path\u3001name\u3001component(s)\u5c5e\u6027\u5916\uff0c\u8fd8\u53ef\u4ee5\u6709meta\u5c5e\u6027\uff0c\u8fd9\u4e2a\u5c5e\u6027\u7528\u6765\u4e3a\u8def\u7531\u5b9a\u4e49\u4e00\u4e9b\u6269\u5c55\u7684\u5c5e\u6027\uff0c\u6bd4\u5982\u6bcf\u4e2a\u9875\u9762\u90fd\u6709title\u7b49\u3002vue-router\u4e0d\u4f1a\u81ea\u52a8\u5904\u7406meta\u91cc\u9762\u7684\u5c5e\u6027\uff0c\u9700\u8981\u6211\u4eec\u5728\u5bfc\u822a\u94a9\u5b50\u91cc\u9762\u53bb\u5904\u7406\u8fd9\u4e9b\u5143\u4fe1\u606f\uff0c\u6211\u4eec\u5c31\u4ee5\u9875\u9762title\u4e3a\u4f8b\uff1a const routes = [ { path: '/profile/user', name: 'user', component: User, meta: { title: '\u7528\u6237\u5217\u8868' }, children: [ { path: ':id', component: UserProfile, meta: { title: '\u7528\u6237\u8be6\u60c5' } } ] } ] router.beforeEach((to, from, next) => { document.title = to.meta ? to.meta.title : ''; }) \u8fc7\u6e21\u52a8\u6548 \u00b6 \u8fc7\u6e21\u6548\u679c\u7684\u57fa\u7840\u77e5\u8bc6\u5df2\u7ecf\u5728vue\u57fa\u7840\u4e2d\u8bb2\u8fc7\uff0c\u5982\u679c\u4e0d\u6e05\u695a\u8fc7\u5ea6\u6548\u679c\uff0c\u8bf7\u5148\u5b66\u4e60\u8fc7\u6e21\u6548\u679c\u3002 \u662f\u57fa\u672c\u7684\u52a8\u6001\u7ec4\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528 \u7ec4\u4ef6\u7ed9\u5b83\u6dfb\u52a0\u4e00\u4e9b\u8fc7\u6e21\u6548\u679c\uff1a <transition> <router-view></router-view> </transition> \u4e0a\u9762\u7684\u7528\u6cd5\u4f1a\u7ed9\u6240\u6709\u8def\u7531\u8bbe\u7f6e\u4e00\u6837\u7684\u8fc7\u6e21\u6548\u679c\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u6bcf\u4e2a\u8def\u7531\u7ec4\u4ef6\u6709\u5404\u81ea\u7684\u8fc7\u6e21\u6548\u679c\uff0c\u53ef\u4ee5\u5728\u5404\u8def\u7531\u7ec4\u4ef6\u5185\u4f7f\u7528 \u5e76\u8bbe\u7f6e\u4e0d\u540c\u7684 name\u3002 const User = { template: ` <transition name=\"slide\"> <div> <div>\u8fd9\u91cc\u662f\u7528\u6237\u5217\u8868</div> <ul> <li><router-link to=\"/profile/user/1\">root</router-link></li> <li><router-link to=\"/profile/user/2\">test</router-link></li> </ul> <router-view></router-view> </div> </transition> ` } // \u7528\u6237\u8be6\u60c5\u7ec4\u4ef6 const UserProfile = { template: '<transition name=\"fade\"><div>\u7528\u6237# {{ $route.params.id }}\u8be6\u60c5\u9875</div></transition>' } \u6eda\u52a8\u884c\u4e3a \u00b6 \u7531\u4e8evue-router\u662f\u5355\u9875\u65e0\u5237\u65b0\u5e94\u7528\uff0c\u6240\u4ee5\u5047\u8bbe\u6709\u4e00\u4e2a\u9875\u9762\u5185\u5bb9\u5f88\u591a\uff0c\u6709\u5782\u76f4\u6eda\u52a8\u6761\uff0c\u5982\u679c\u628a\u9875\u9762\u6eda\u52a8\u5230\u6700\u5e95\u90e8\uff0c\u7136\u540e\u518d\u5207\u6362\u8def\u7531\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u65b0\u7684\u9875\u9762\u4e5f\u5728\u6700\u5e95\u90e8\uff0c\u5982\u679c\u60f3\u8981\u9875\u9762\u6eda\u5230\u9876\u90e8\uff0cvue-router \u80fd\u505a\u5230\uff0c\u800c\u4e14\u66f4\u597d\uff0c\u5b83\u8ba9\u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49\u8def\u7531\u5207\u6362\u65f6\u9875\u9762\u5982\u4f55\u6eda\u52a8\u3002 \u6ce8\u610f: \u8fd9\u4e2a\u529f\u80fd\u53ea\u5728 HTML5 history \u6a21\u5f0f\u4e0b\u53ef\u7528\u3002 \u5f53\u521b\u5efa\u4e00\u4e2a Router \u5b9e\u4f8b\uff0c\u4f60\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a scrollBehavior \u65b9\u6cd5\uff1a const router = new VueRouter({ routes: [...], scrollBehavior (to, from, savedPosition) { // return \u671f\u671b\u6eda\u52a8\u5230\u54ea\u4e2a\u7684\u4f4d\u7f6e } }) scrollBehavior \u65b9\u6cd5\u63a5\u6536 to \u548c from \u8def\u7531\u5bf9\u8c61\u3002\u7b2c\u4e09\u4e2a\u53c2\u6570 savedPosition \u5f53\u4e14\u4ec5\u5f53 popstate \u5bfc\u822a (\u901a\u8fc7\u6d4f\u89c8\u5668\u7684 \u524d\u8fdb/\u540e\u9000 \u6309\u94ae\u89e6\u53d1) \u65f6\u624d\u53ef\u7528\u3002 \u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u6eda\u52a8\u4f4d\u7f6e\u7684\u5bf9\u8c61\u4fe1\u606f\uff0c\u957f\u8fd9\u6837\uff1a { x: number, y: number } { selector: string } \u5982\u679c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u5047\u7684\u503c\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u7a7a\u5bf9\u8c61\uff0c\u90a3\u4e48\u4e0d\u4f1a\u53d1\u751f\u6eda\u52a8\u3002 \u4e3e\u4f8b\uff1a scrollBehavior (to, from, savedPosition) { return { x: 0, y: 0 } } \u4e0a\u4f8b\u5bf9\u4e8e\u6240\u6709\u8def\u7531\u5bfc\u822a\uff0c\u7b80\u5355\u5730\u8ba9\u9875\u9762\u6eda\u52a8\u5230\u9876\u90e8\u3002 \u8fd4\u56de savedPosition\uff0c\u5728\u6309\u4e0b \u540e\u9000/\u524d\u8fdb \u6309\u94ae\u65f6\uff0c\u5c31\u4f1a\u50cf\u6d4f\u89c8\u5668\u7684\u539f\u751f\u8868\u73b0\u90a3\u6837\uff1a scrollBehavior (to, from, savedPosition) { if (savedPosition) { return savedPosition } else { return { x: 0, y: 0 } } } \u4e0a\u4f8b\u8868\u793a\u5982\u679c\u662f\u6309\u4e86\u6d4f\u89c8\u5668\u7684\u524d\u8fdb\u3001\u540e\u9000\u6309\u94ae\uff0c\u5219\u9875\u9762\u6eda\u52a8\u5230\u5386\u53f2\u9875\u9762\u539f\u6765\u7684\u4f4d\u7f6e\uff0c\u5426\u5219\u6eda\u52a8\u5230\u9875\u9762\u9876\u90e8\u3002","title":"\"Vue\u8def\u7531\u8fdb\u9636\""},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_1","text":"\u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u6709\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u5f53\u9875\u9762\u5207\u6362\u65f6\uff0c\u9700\u8981\u505a\u4e00\u4e9b\u64cd\u4f5c\u6765\u66f4\u6539\u67d0\u4e9b\u4fe1\u606f\uff0c\u8fd9\u5c31\u9700\u8981\u62e6\u622a\u8def\u7531\u5207\u6362\u3002vue-router \u63d0\u4f9b\u4e86\u5bfc\u822a\u94a9\u5b50\u6765\u62e6\u622a\u5bfc\u822a\uff0c\u8ba9\u5b83\u5b8c\u6210\u8df3\u8f6c\u6216\u53d6\u6d88\u3002\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5728\u8def\u7531\u5bfc\u822a\u53d1\u751f\u65f6\u6267\u884c\u94a9\u5b50\uff1a\u5168\u5c40\u7684, \u5355\u4e2a\u8def\u7531\u72ec\u4eab\u7684, \u6216\u8005\u7ec4\u4ef6\u7ea7\u7684\u3002","title":"\u5bfc\u822a\u94a9\u5b50"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_2","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528 router.beforeEach \u6ce8\u518c\u4e00\u4e2a\u5168\u5c40\u7684 before \u94a9\u5b50\uff1a const router = new VueRouter({ ... }) router.beforeEach((to, from, next) => { // ... }) \u5f53\u4e00\u4e2a\u5bfc\u822a\u89e6\u53d1\u65f6\uff0c\u5168\u5c40\u7684 before \u94a9\u5b50\u6309\u7167\u521b\u5efa\u987a\u5e8f\u8c03\u7528\u3002\u94a9\u5b50\u662f\u5f02\u6b65\u89e3\u6790\u6267\u884c\uff0c\u6b64\u65f6\u5bfc\u822a\u5728\u6240\u6709\u94a9\u5b50 resolve \u5b8c\u4e4b\u524d\u4e00\u76f4\u5904\u4e8e \u7b49\u5f85\u4e2d\u3002 \u6bcf\u4e2a\u94a9\u5b50\u65b9\u6cd5\u63a5\u6536\u4e09\u4e2a\u53c2\u6570\uff1a to: Route: \u5373\u5c06\u8981\u8fdb\u5165\u7684\u76ee\u6807 \u8def\u7531\u5bf9\u8c61 from: Route: \u5f53\u524d\u5bfc\u822a\u6b63\u8981\u79bb\u5f00\u7684\u8def\u7531 next: Function: \u4e00\u5b9a\u8981\u8c03\u7528\u8be5\u65b9\u6cd5\u6765 resolve \u8fd9\u4e2a\u94a9\u5b50\u3002\u6267\u884c\u6548\u679c\u4f9d\u8d56 next \u65b9\u6cd5\u7684\u8c03\u7528\u53c2\u6570\u3002 next(): \u8fdb\u884c\u7ba1\u9053\u4e2d\u7684\u4e0b\u4e00\u4e2a\u94a9\u5b50\u3002\u5982\u679c\u5168\u90e8\u94a9\u5b50\u6267\u884c\u5b8c\u4e86\uff0c\u5219\u5bfc\u822a\u7684\u72b6\u6001\u5c31\u662f confirmed \uff08\u786e\u8ba4\u7684\uff09\u3002 next(false): \u4e2d\u65ad\u5f53\u524d\u7684\u5bfc\u822a\u3002\u5982\u679c\u6d4f\u89c8\u5668\u7684 URL \u6539\u53d8\u4e86\uff08\u53ef\u80fd\u662f\u7528\u6237\u624b\u52a8\u6216\u8005\u6d4f\u89c8\u5668\u540e\u9000\u6309\u94ae\uff09\uff0c\u90a3\u4e48 URL \u5730\u5740\u4f1a\u91cd\u7f6e\u5230 from \u8def\u7531\u5bf9\u5e94\u7684\u5730\u5740\u3002 next('/') \u6216\u8005 next({ path: '/' }): \u8df3\u8f6c\u5230\u4e00\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u3002\u5f53\u524d\u7684\u5bfc\u822a\u88ab\u4e2d\u65ad\uff0c\u7136\u540e\u8fdb\u884c\u4e00\u4e2a\u65b0\u7684\u5bfc\u822a\u3002 \u786e\u4fdd\u8981\u8c03\u7528 next \u65b9\u6cd5\uff0c\u5426\u5219\u94a9\u5b50\u5c31\u4e0d\u4f1a\u88ab resolved\u3002 \u540c\u6837\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2a\u5168\u5c40\u7684 after \u94a9\u5b50\uff0c\u4e0d\u8fc7\u5b83\u4e0d\u50cf before \u94a9\u5b50\u90a3\u6837\uff0cafter \u94a9\u5b50\u6ca1\u6709 next \u65b9\u6cd5\uff0c\u4e0d\u80fd\u6539\u53d8\u5bfc\u822a\uff1a router.afterEach(route => { // ... })","title":"\u5168\u5c40\u94a9\u5b50"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_3","text":"\u4f60\u53ef\u4ee5\u5728\u8def\u7531\u914d\u7f6e\u4e0a\u76f4\u63a5\u5b9a\u4e49 beforeEnter \u94a9\u5b50\uff1a const router = new VueRouter({ routes: [ { path: '/foo', component: Foo, beforeEnter: (to, from, next) => { // ... } } ] }) \u8fd9\u4e9b\u94a9\u5b50\u4e0e\u5168\u5c40 before \u94a9\u5b50\u7684\u65b9\u6cd5\u53c2\u6570\u662f\u4e00\u6837\u7684\u3002","title":"\u67d0\u4e2a\u8def\u7531\u72ec\u4eab\u7684\u94a9\u5b50"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_4","text":"\u6700\u540e\uff0c\u4f60\u53ef\u4ee5\u5728\u8def\u7531\u7ec4\u4ef6\u5185\u76f4\u63a5\u5b9a\u4e49\u4ee5\u4e0b\u8def\u7531\u5bfc\u822a\u94a9\u5b50\uff1a beforeRouteEnter beforeRouteUpdate (2.2 \u65b0\u589e) beforeRouteLeave const Foo = { template: `...`, beforeRouteEnter (to, from, next) { // \u5728\u6e32\u67d3\u8be5\u7ec4\u4ef6\u7684\u5bf9\u5e94\u8def\u7531\u88ab confirm \u524d\u8c03\u7528 // \u4e0d\uff01\u80fd\uff01\u83b7\u53d6\u7ec4\u4ef6\u5b9e\u4f8b `this` // \u56e0\u4e3a\u5f53\u94a9\u5b50\u6267\u884c\u524d\uff0c\u7ec4\u4ef6\u5b9e\u4f8b\u8fd8\u6ca1\u88ab\u521b\u5efa }, beforeRouteUpdate (to, from, next) { // \u5728\u5f53\u524d\u8def\u7531\u6539\u53d8\uff0c\u4f46\u662f\u6539\u7ec4\u4ef6\u88ab\u590d\u7528\u65f6\u8c03\u7528 // \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5e26\u6709\u52a8\u6001\u53c2\u6570\u7684\u8def\u5f84 /foo/:id\uff0c\u5728 /foo/1 \u548c /foo/2 \u4e4b\u95f4\u8df3\u8f6c\u7684\u65f6\u5019\uff0c // \u7531\u4e8e\u4f1a\u6e32\u67d3\u540c\u6837\u7684 Foo \u7ec4\u4ef6\uff0c\u56e0\u6b64\u7ec4\u4ef6\u5b9e\u4f8b\u4f1a\u88ab\u590d\u7528\u3002\u800c\u8fd9\u4e2a\u94a9\u5b50\u5c31\u4f1a\u5728\u8fd9\u4e2a\u60c5\u51b5\u4e0b\u88ab\u8c03\u7528\u3002 // \u53ef\u4ee5\u8bbf\u95ee\u7ec4\u4ef6\u5b9e\u4f8b `this` }, beforeRouteLeave (to, from, next) { // \u5bfc\u822a\u79bb\u5f00\u8be5\u7ec4\u4ef6\u7684\u5bf9\u5e94\u8def\u7531\u65f6\u8c03\u7528 // \u53ef\u4ee5\u8bbf\u95ee\u7ec4\u4ef6\u5b9e\u4f8b `this` } } \u4ecb\u7ecd\u5b8c\u4e0a\u8ff0\u4e09\u79cd\u4e0d\u540c\u4f5c\u7528\u57df\u7684\u5bfc\u822a\u94a9\u5b50\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u66f4\u5b9e\u9645\u7684\u4f8b\u5b50\u3002\u4f7f\u7528vue-router\u4e4b\u540e\uff0c\u9875\u9762\u7684\u5207\u6362\u65f6\u65e0\u5237\u65b0\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u548c\u670d\u52a1\u7aef\u6ca1\u6709\u4ea4\u4e92\uff0c\u8fd9\u6837\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u67d0\u4e2a\u9875\u9762\u8fd9\u4e2a\u7528\u6237\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\uff0c\u8fd9\u4e2a\u5982\u4f55\u6765\u63a7\u5236\uff1f\u6709\u4e86\u5bfc\u822a\u94a9\u5b50\uff0c\u8fd9\u4e2a\u81ea\u7136\u5c31\u53ef\u4ee5\u653e\u5230\u5bfc\u822a\u94a9\u5b50\u6765\u6267\u884c\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a // \u6743\u9650\u6570\u7ec4 const permissions = { 'user': 1, // \u5176\u4e2duser\u8868\u793a\u8def\u7531\u540d\u79f0 1\u8868\u793a\u6709\u6743\u9650\u8bbf\u95ee 0 \u8868\u793a\u65e0\u6743\u9650\u8bbf\u95ee 'userProfile': 0 } router.beforeEach((to, from, next) => { let name = to.name; if (name) { if (permissions[name]) { next(); } else { alert(\u65e0\u6743\u9650\u8bbf\u95ee); next(false); } } else { next(); } })","title":"\u7ec4\u4ef6\u5185\u7684\u94a9\u5b50"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_5","text":"\u8def\u7531\u5b9a\u4e49\u7684\u65f6\u5019\uff0c\u9664\u4e86path\u3001name\u3001component(s)\u5c5e\u6027\u5916\uff0c\u8fd8\u53ef\u4ee5\u6709meta\u5c5e\u6027\uff0c\u8fd9\u4e2a\u5c5e\u6027\u7528\u6765\u4e3a\u8def\u7531\u5b9a\u4e49\u4e00\u4e9b\u6269\u5c55\u7684\u5c5e\u6027\uff0c\u6bd4\u5982\u6bcf\u4e2a\u9875\u9762\u90fd\u6709title\u7b49\u3002vue-router\u4e0d\u4f1a\u81ea\u52a8\u5904\u7406meta\u91cc\u9762\u7684\u5c5e\u6027\uff0c\u9700\u8981\u6211\u4eec\u5728\u5bfc\u822a\u94a9\u5b50\u91cc\u9762\u53bb\u5904\u7406\u8fd9\u4e9b\u5143\u4fe1\u606f\uff0c\u6211\u4eec\u5c31\u4ee5\u9875\u9762title\u4e3a\u4f8b\uff1a const routes = [ { path: '/profile/user', name: 'user', component: User, meta: { title: '\u7528\u6237\u5217\u8868' }, children: [ { path: ':id', component: UserProfile, meta: { title: '\u7528\u6237\u8be6\u60c5' } } ] } ] router.beforeEach((to, from, next) => { document.title = to.meta ? to.meta.title : ''; })","title":"\u8def\u7531\u5143\u4fe1\u606f"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_6","text":"\u8fc7\u6e21\u6548\u679c\u7684\u57fa\u7840\u77e5\u8bc6\u5df2\u7ecf\u5728vue\u57fa\u7840\u4e2d\u8bb2\u8fc7\uff0c\u5982\u679c\u4e0d\u6e05\u695a\u8fc7\u5ea6\u6548\u679c\uff0c\u8bf7\u5148\u5b66\u4e60\u8fc7\u6e21\u6548\u679c\u3002 \u662f\u57fa\u672c\u7684\u52a8\u6001\u7ec4\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528 \u7ec4\u4ef6\u7ed9\u5b83\u6dfb\u52a0\u4e00\u4e9b\u8fc7\u6e21\u6548\u679c\uff1a <transition> <router-view></router-view> </transition> \u4e0a\u9762\u7684\u7528\u6cd5\u4f1a\u7ed9\u6240\u6709\u8def\u7531\u8bbe\u7f6e\u4e00\u6837\u7684\u8fc7\u6e21\u6548\u679c\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u6bcf\u4e2a\u8def\u7531\u7ec4\u4ef6\u6709\u5404\u81ea\u7684\u8fc7\u6e21\u6548\u679c\uff0c\u53ef\u4ee5\u5728\u5404\u8def\u7531\u7ec4\u4ef6\u5185\u4f7f\u7528 \u5e76\u8bbe\u7f6e\u4e0d\u540c\u7684 name\u3002 const User = { template: ` <transition name=\"slide\"> <div> <div>\u8fd9\u91cc\u662f\u7528\u6237\u5217\u8868</div> <ul> <li><router-link to=\"/profile/user/1\">root</router-link></li> <li><router-link to=\"/profile/user/2\">test</router-link></li> </ul> <router-view></router-view> </div> </transition> ` } // \u7528\u6237\u8be6\u60c5\u7ec4\u4ef6 const UserProfile = { template: '<transition name=\"fade\"><div>\u7528\u6237# {{ $route.params.id }}\u8be6\u60c5\u9875</div></transition>' }","title":"\u8fc7\u6e21\u52a8\u6548"},{"location":"vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#_7","text":"\u7531\u4e8evue-router\u662f\u5355\u9875\u65e0\u5237\u65b0\u5e94\u7528\uff0c\u6240\u4ee5\u5047\u8bbe\u6709\u4e00\u4e2a\u9875\u9762\u5185\u5bb9\u5f88\u591a\uff0c\u6709\u5782\u76f4\u6eda\u52a8\u6761\uff0c\u5982\u679c\u628a\u9875\u9762\u6eda\u52a8\u5230\u6700\u5e95\u90e8\uff0c\u7136\u540e\u518d\u5207\u6362\u8def\u7531\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u65b0\u7684\u9875\u9762\u4e5f\u5728\u6700\u5e95\u90e8\uff0c\u5982\u679c\u60f3\u8981\u9875\u9762\u6eda\u5230\u9876\u90e8\uff0cvue-router \u80fd\u505a\u5230\uff0c\u800c\u4e14\u66f4\u597d\uff0c\u5b83\u8ba9\u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49\u8def\u7531\u5207\u6362\u65f6\u9875\u9762\u5982\u4f55\u6eda\u52a8\u3002 \u6ce8\u610f: \u8fd9\u4e2a\u529f\u80fd\u53ea\u5728 HTML5 history \u6a21\u5f0f\u4e0b\u53ef\u7528\u3002 \u5f53\u521b\u5efa\u4e00\u4e2a Router \u5b9e\u4f8b\uff0c\u4f60\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a scrollBehavior \u65b9\u6cd5\uff1a const router = new VueRouter({ routes: [...], scrollBehavior (to, from, savedPosition) { // return \u671f\u671b\u6eda\u52a8\u5230\u54ea\u4e2a\u7684\u4f4d\u7f6e } }) scrollBehavior \u65b9\u6cd5\u63a5\u6536 to \u548c from \u8def\u7531\u5bf9\u8c61\u3002\u7b2c\u4e09\u4e2a\u53c2\u6570 savedPosition \u5f53\u4e14\u4ec5\u5f53 popstate \u5bfc\u822a (\u901a\u8fc7\u6d4f\u89c8\u5668\u7684 \u524d\u8fdb/\u540e\u9000 \u6309\u94ae\u89e6\u53d1) \u65f6\u624d\u53ef\u7528\u3002 \u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u6eda\u52a8\u4f4d\u7f6e\u7684\u5bf9\u8c61\u4fe1\u606f\uff0c\u957f\u8fd9\u6837\uff1a { x: number, y: number } { selector: string } \u5982\u679c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u5047\u7684\u503c\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u7a7a\u5bf9\u8c61\uff0c\u90a3\u4e48\u4e0d\u4f1a\u53d1\u751f\u6eda\u52a8\u3002 \u4e3e\u4f8b\uff1a scrollBehavior (to, from, savedPosition) { return { x: 0, y: 0 } } \u4e0a\u4f8b\u5bf9\u4e8e\u6240\u6709\u8def\u7531\u5bfc\u822a\uff0c\u7b80\u5355\u5730\u8ba9\u9875\u9762\u6eda\u52a8\u5230\u9876\u90e8\u3002 \u8fd4\u56de savedPosition\uff0c\u5728\u6309\u4e0b \u540e\u9000/\u524d\u8fdb \u6309\u94ae\u65f6\uff0c\u5c31\u4f1a\u50cf\u6d4f\u89c8\u5668\u7684\u539f\u751f\u8868\u73b0\u90a3\u6837\uff1a scrollBehavior (to, from, savedPosition) { if (savedPosition) { return savedPosition } else { return { x: 0, y: 0 } } } \u4e0a\u4f8b\u8868\u793a\u5982\u679c\u662f\u6309\u4e86\u6d4f\u89c8\u5668\u7684\u524d\u8fdb\u3001\u540e\u9000\u6309\u94ae\uff0c\u5219\u9875\u9762\u6eda\u52a8\u5230\u5386\u53f2\u9875\u9762\u539f\u6765\u7684\u4f4d\u7f6e\uff0c\u5426\u5219\u6eda\u52a8\u5230\u9875\u9762\u9876\u90e8\u3002","title":"\u6eda\u52a8\u884c\u4e3a"},{"location":"vue/vue%E5%9C%A8drupal%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/","tags":["drupal","vue"],"text":"vue \u7684\u6a21\u5757\u5316\u5f00\u53d1\uff0c\u57fa\u4e8e webpack \uff0c gulp \u7531\u4e8e vue \u7ec4\u4ef6\u7cfb\u7edf\uff0c drupal \u4e2d\u7684 vue \u53ef\u4ee5\u76f4\u63a5\u5728\u4e3b\u9898\u4e2d\u5199\u7ec4\u4ef6 OK\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u4e3b\u9898\uff0c lancer \u672c\u5730\u5148\u5b89\u88c5node \u7136\u540e\u5728 lancer \u76ee\u5f55\u4e0b\u5148\u653e\u4e2a package.json \u6587\u4ef6 { \"name\" : \"voss\" , \"version\" : \"0.0.1\" , \"description\" : \"webapp with Vue.js for voss.\" , \"author\" : \"panjun.liu <panjun.liu@verycloud.cn>\" , \"private\" : true , \"scripts\" : { \"dev\" : \"node build/dev-server.js\" , \"build\" : \"node build/build.js\" , \"unit\" : \"karma start test/unit/karma.conf.js --single-run\" , \"test\" : \"npm run unit\" , \"lint\" : \"eslint --ext .js,.vue src test/unit/specs test/e2e/specs\" }, \"dependencies\" : { \"vue\" : \"^2.0.3\" , \"babel-runtime\" : \"^6.11.6\" }, \"devDependencies\" : { \"babel-core\" : \"^6.16.0\" , \"babel-loader\" : \"^6.2.5\" , \"babel-plugin-transform-runtime\" : \"^6.15.0\" , \"babel-preset-es2015\" : \"^6.16.0\" , \"babel-preset-stage-2\" : \"^6.16.0\" , \"bulma\" : \"0.2.1\" , \"chai\" : \"^3.5.0\" , \"chart.js\" : \"^2.3.0\" , \"connect-history-api-fallback\" : \"^1.3.0\" , \"css-loader\" : \"^0.25.0\" , \"element-ui\" : \"^1.0.2\" , \"eslint\" : \"^3.7.0\" , \"eslint-config-standard\" : \"^6.2.0\" , \"eslint-friendly-formatter\" : \"^2.0.6\" , \"eslint-loader\" : \"^1.5.0\" , \"eslint-plugin-html\" : \"^1.5.3\" , \"eslint-plugin-promise\" : \"^2.0.1\" , \"eslint-plugin-standard\" : \"^2.0.1\" , \"eventsource-polyfill\" : \"^0.9.6\" , \"express\" : \"^4.14.0\" , \"extract-text-webpack-plugin\" : \"^1.0.1\" , \"fastclick\" : \"^1.0.6\" , \"file-loader\" : \"^0.9.0\" , \"function-bind\" : \"^1.1.0\" , \"html-webpack-plugin\" : \"^2.22.0\" , \"http-proxy-middleware\" : \"^0.17.2\" , \"inject-loader\" : \"^2.0.1\" , \"isparta-loader\" : \"^2.0.0\" , \"json-loader\" : \"^0.5.4\" , \"karma\" : \"^1.3.0\" , \"karma-coverage\" : \"^1.1.1\" , \"karma-mocha\" : \"^1.2.0\" , \"karma-phantomjs-launcher\" : \"^1.0.2\" , \"karma-sinon-chai\" : \"^1.2.3\" , \"karma-sourcemap-loader\" : \"^0.3.7\" , \"karma-spec-reporter\" : \"0.0.26\" , \"karma-webpack\" : \"^1.8.0\" , \"less\" : \"^2.7.1\" , \"less-loader\" : \"^2.2.3\" , \"lolex\" : \"^1.5.1\" , \"mocha\" : \"^3.1.0\" , \"moment\" : \"^2.14.1\" , \"ora\" : \"^0.3.0\" , \"phantomjs-prebuilt\" : \"^2.1.12\" , \"shelljs\" : \"^0.7.4\" , \"sinon\" : \"^1.17.6\" , \"sinon-chai\" : \"^2.8.0\" , \"swiper\" : \"^3.3.1\" , \"url-loader\" : \"^0.5.7\" , \"vue-hot-reload-api\" : \"^2.0.6\" , \"vue-html-loader\" : \"^1.2.3\" , \"vue-loader\" : \"^9.7.0\" , \"vue-resource\" : \"^1.0.3\" , \"vue-router\" : \"^2.0.1\" , \"vue-style-loader\" : \"^1.0.0\" , \"vuex\" : \"^2.0.0\" , \"webpack\" : \"^1.13.2\" , \"webpack-dev-middleware\" : \"^1.8.4\" , \"webpack-hot-middleware\" : \"^2.13.0\" , \"webpack-merge\" : \"^0.14.1\" } } \u8fd0\u884c npm install \u5f00\u59cb\u521d\u59cb\u5316\u73af\u5883 \u4e4b\u540e npm install gulp gulp-util gulp-less gulp-concat gulp-open gulp-uglify gulp-cssmin gulp-md5-plus gulp-file-include gulp-clean gulp-css-spriter gulp-css-base64 webpack gulp-connect --save-dev \u5b89\u88c5 gulp \u73af\u5883 \u521d\u59cb\u5316 gulpfile.js var gulp = require ( 'gulp' ), os = require ( 'os' ), gutil = require ( 'gulp-util' ), less = require ( 'gulp-less' ), concat = require ( 'gulp-concat' ), gulpOpen = require ( 'gulp-open' ), uglify = require ( 'gulp-uglify' ), cssmin = require ( 'gulp-cssmin' ), md5 = require ( 'gulp-md5-plus' ), fileinclude = require ( 'gulp-file-include' ), clean = require ( 'gulp-clean' ), spriter = require ( 'gulp-css-spriter' ), base64 = require ( 'gulp-css-base64' ), webpack = require ( 'webpack' ), webpackConfig = require ( './build/webpack.prod.conf.js' ), connect = require ( 'gulp-connect' ); var host = { path : 'dist/' , port : 3000 , html : 'index.html' }; //mac chrome: \"Google chrome\", var browser = os . platform () === 'linux' ? 'Google chrome' : ( os . platform () === 'darwin' ? 'Google chrome' : ( os . platform () === 'win32' ? 'chrome' : 'firefox' )); var pkg = require ( './package.json' ); //\u5c06\u56fe\u7247\u62f7\u8d1d\u5230\u76ee\u6807\u76ee\u5f55 gulp . task ( 'copy:images' , function ( done ) { gulp . src ([ 'src/images/**/*' ]). pipe ( gulp . dest ( 'dist/images' )). on ( 'end' , done ); }); //\u538b\u7f29\u5408\u5e76css, css\u4e2d\u65e2\u6709\u81ea\u5df1\u5199\u7684.less, \u4e5f\u6709\u5f15\u5165\u7b2c\u4e09\u65b9\u5e93\u7684.css gulp . task ( 'lessmin' , function ( done ) { gulp . src ([ 'src/css/main.less' , 'src/css/*.css' ]) . pipe ( less ()) //\u8fd9\u91cc\u53ef\u4ee5\u52a0css sprite \u8ba9\u6bcf\u4e00\u4e2acss\u5408\u5e76\u4e3a\u4e00\u4e2a\u96ea\u78a7\u56fe //.pipe(spriter({})) . pipe ( concat ( 'style.min.css' )) . pipe ( gulp . dest ( 'dist/css/' )) . on ( 'end' , done ); }); //\u5c06js\u52a0\u4e0a10\u4f4dmd5,\u5e76\u4fee\u6539html\u4e2d\u7684\u5f15\u7528\u8def\u5f84\uff0c\u8be5\u52a8\u4f5c\u4f9d\u8d56build-js gulp . task ( 'md5:js' , [ 'build-js' ], function ( done ) { gulp . src ( 'dist/js/*.js' ) . pipe ( md5 ( 10 , 'dist/app/*.html' )) . pipe ( gulp . dest ( 'dist/js' )) . on ( 'end' , done ); }); //\u5c06css\u52a0\u4e0a10\u4f4dmd5\uff0c\u5e76\u4fee\u6539html\u4e2d\u7684\u5f15\u7528\u8def\u5f84\uff0c\u8be5\u52a8\u4f5c\u4f9d\u8d56sprite gulp . task ( 'md5:css' , [ 'sprite' ], function ( done ) { gulp . src ( 'dist/css/*.css' ) . pipe ( md5 ( 10 , 'dist/app/*.html' )) . pipe ( gulp . dest ( 'dist/css' )) . on ( 'end' , done ); }); //\u7528\u4e8e\u5728html\u6587\u4ef6\u4e2d\u76f4\u63a5include\u6587\u4ef6 gulp . task ( 'fileinclude' , function ( done ) { gulp . src ([ 'src/app/*.html' ]) . pipe ( fileinclude ({ prefix : '@@' , basepath : '@file' })) . pipe ( gulp . dest ( 'dist/app' )) . on ( 'end' , done ); // .pipe(connect.reload()) }); //\u96ea\u78a7\u56fe\u64cd\u4f5c\uff0c\u5e94\u8be5\u5148\u62f7\u8d1d\u56fe\u7247\u5e76\u538b\u7f29\u5408\u5e76css gulp . task ( 'sprite' , [ 'copy:images' , 'lessmin' ], function ( done ) { var timestamp = + new Date (); gulp . src ( 'dist/css/style.min.css' ) . pipe ( spriter ({ spriteSheet : 'dist/images/spritesheet' + timestamp + '.png' , pathToSpriteSheetFromCSS : '../images/spritesheet' + timestamp + '.png' , spritesmithOptions : { padding : 10 } })) . pipe ( base64 ()) . pipe ( cssmin ()) . pipe ( gulp . dest ( 'dist/css' )) . on ( 'end' , done ); }); gulp . task ( 'clean' , function ( done ) { gulp . src ([ 'dist' ]) . pipe ( clean ()) . on ( 'end' , done ); }); gulp . task ( 'watch' , function ( done ) { gulp . watch ([ '/var/www/html/voss/**/*.vue' , '/var/www/html/voss/**/*.js' , '/var/www/html/voss/**/*.less' ], [ 'lessmin' , 'build-js' , 'fileinclude' ]) . on ( 'end' , done ); }); gulp . task ( 'connect' , function () { console . log ( 'connect------------' ); connect . server ({ root : host . path , port : host . port , livereload : true }); }); gulp . task ( 'open' , function ( done ) { gulp . src ( '' ) . pipe ( gulpOpen ({ app : browser , uri : 'http://localhost:3000/app' })) . on ( 'end' , done ); }); var myDevConfig = Object . create ( webpackConfig ); var devCompiler = webpack ( myDevConfig ); //\u5f15\u7528webpack\u5bf9js\u8fdb\u884c\u64cd\u4f5c gulp . task ( \"build-js\" , [ 'fileinclude' ], function ( callback ) { devCompiler . run ( function ( err , stats ) { if ( err ) throw new gutil . PluginError ( \"webpack:build-js\" , err ); gutil . log ( \"[webpack:build-js]\" , stats . toString ({ colors : true })); callback (); }); }); //\u53d1\u5e03 gulp . task ( 'default' , [ 'connect' , 'fileinclude' , 'md5:css' , 'md5:js' , 'open' ]); //\u5f00\u53d1 gulp . task ( 'dev' , [ 'connect' , 'copy:images' , 'fileinclude' , 'lessmin' , 'build-js' , 'watch' , 'open' ]); \u547d\u4ee4\u884c\u4e0b gulp \u56de\u8f66\uff0c\u542f\u52a8\u76d1\u63a7\u4efb\u52a1 OK\uff0c\u73b0\u5728\u53ef\u4ee5\u5f00\u59cb vue \u7684\u5f00\u53d1\u4e86 \u4e3b\u9898\u4e0b\u65b0\u5efa\u4e2a\u76ee\u5f55 src \u7528\u4e8e\u5b58\u653e vue \u7684\u7ec4\u4ef6\uff0c\u4ee5\u53ca\u542f\u52a8 js \u6587\u4ef6 main.js import Vue from 'vue' import Router from 'vue-router' import Resource from 'vue-resource' // Contrib. import ElementUI from 'element-ui' import 'element-ui/lib/theme-default/index.css' // Voss. import App from './App' import Notfound from './pages/base/404' import Organization from './pages/base/Organization' import Region from './pages/base/Region' import Position from './pages/base/Position' import Education from './pages/base/Education' import CompanyAuthority from './pages/base/CompanyAuthority' import CompanyAuthorityConfig from './pages/base/CompanyAuthorityConfig' import Memory from './pages/base/Memory' import Variables from './pages/base/Variables' // vuex store import store from './store' Vue . use ( Router ) Vue . use ( Resource ) Vue . use ( ElementUI ) // \u5168\u5c40\u95ed\u5305\uff0c\u516c\u7528\u51fd\u6570\u5e93\uff0c\u4e5f\u53ef\u4ee5\u653e\u7f6e\u5230vuex2.0\u4e2d global . $fn = { // \u83b7\u53d6url\u4e2d\u7684\u53c2\u6570\uff0c\u5141\u8bb8\u9ed8\u8ba4\u503c\u7684\u8bbe\u5b9a getparam ( name , defaultValue ) { let reg = new RegExp ( '(^|&)' + name + '=([^&]*)(&|$)' ) let r = window . location . search . substr ( 1 ). match ( reg ) return ( ! r ) ? (( ! defaultValue ) ? '' : defaultValue ) : unescape ( r [ 2 ]) }, init () { // \u767b\u5f55\u6216\u6ce8\u9500\u540e\u9700\u8981\u6e05\u7a7acache // store.commit('isAuth', false) // this.csrf.requestToken() }, // \u968f\u673a\u5b57\u7b26\u4e32 getCode ( n ) { let chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ' let res = '' for ( let i = 0 ; i < n ; i ++ ) { res += chars [ Math . floor ( Math . random () * chars . length )] } return res }, // cache \u673a\u5236 cache : [], // \u9ed8\u8ba4300\u79d2\u6570\u636e\u7f13\u5b58\u65f6\u95f4 exp : 300 , getCache ( url ) { let json = this . cache [ url ] return ( json && ( json . exp >= this . timestamp ())) ? json . data : null }, setCache ( url , data , exp ) { // \u9ed8\u8ba4300\u79d2,{data,exp} this . cache [ url ] = { data : data , exp : this . timestamp () + (( ! exp ) ? this . exp : exp )} // console.log(this.cache) }, httprl ( method , url , sendData ) { var options = { headers : { 'Content-Type' : 'application/json;charset=utf-8' , 'Accept' : 'application/json' } } // handel get method. if ( method === 'GET' || method === 'get' ) { options . params = sendData let promise = new Promise ( function ( resolve , reject ) { Vue . http . get ( url , options ). then (( result ) => { var data = result . data resolve ( data ) }, ( error ) => { reject ( error ) }) }) return promise } else { // handle post put delete method. if ( this . csrf . isExpired ()) { let promise = new Promise ( function ( resolve , reject ) { global . $fn . csrf . requestToken (). then ( function ( token ) { options . headers [ 'X-CSRF-Token' ] = token switch ( method ) { case 'post' : case 'POST' : Vue . http . post ( url , sendData , options ). then (( result ) => { resolve ( result . data ) }, ( error ) => { reject ( error ) }) break case 'put' : case 'PUT' : Vue . http . put ( url , sendData , options ). then (( result ) => { resolve ( result . data ) }, ( error ) => { reject ( error ) }) break case 'del' : case 'DEL' : Vue . http . delete ( url , sendData , options ). then (( result ) => { resolve ( result . data ) }, ( error ) => { reject ( error ) }) break } }) }) return promise } else { options . headers [ 'X-CSRF-Token' ] = this . csrf . getToken () let promise = new Promise ( function ( resolve , reject ) { switch ( method ) { case 'post' : case 'POST' : Vue . http . post ( url , sendData , options ). then (( result ) => { resolve ( result . data ) }, ( error ) => { reject ( error ) }) break case 'put' : case 'PUT' : Vue . http . put ( url , sendData , options ). then (( result ) => { resolve ( result . data ) }, ( error ) => { reject ( error ) }) break case 'del' : case 'DEL' : Vue . http . delete ( url , sendData , options ). then (( result ) => { resolve ( result . data ) }, ( error ) => { reject ( error ) }) break } }) return promise } } }, csrf : { getToken : function () { return store . state . csrf . token }, getExpire : function () { return store . state . csrf . expire }, nowTime : function () { let date = new Date () return date . getTime () }, isExpired : function () { let csrfToken = global . $fn . csrf . getToken () let tokenExpire = global . $fn . csrf . getExpire () let nowTime = global . $fn . csrf . nowTime () return ( csrfToken === undefined || ! csrfToken . length || ( nowTime >= tokenExpire )) }, requestToken : function () { let promise = new Promise ( function ( resolve , reject ) { Vue . http . get ( 'rest/session/token' ). then ( function ( result ) { store . state . csrf . token = result . data store . state . csrf . expire = global . $fn . csrf . nowTime () + store . state . csrf_token_expire * 1000 resolve ( result . data ) }, function ( error ) { console . error ( 'Error! Fail to get csrf token!' ) console . error ( error ) reject ( error ) }) }) return promise } }, toast ( mode , title ) { store . commit ( 'toast' , { id : new Date (). getTime (), title : ( title && title . length ) > 0 ? title : '\u64cd\u4f5c\u5b8c\u6210' , mode : mode }) }, // \u65f6\u95f4\u6233 timestamp () { return Math . floor ( new Date (). getTime () / 1000 ) } } /* global.$fn.httprl('POST', 'api/login', { username: 'agent', password: '123.com' }).then( (result) => { console.log(result) }) */ const routes = [ { path : '/base/organization' , component : Organization , meta : { title : '\u7ec4\u7ec7\u67b6\u6784' } }, { path : '/base/organization/department' , component : Organization , meta : { title : '\u90e8\u95e8' } }, { path : '/404' , component : Notfound }, { path : '*' , redirect : '/404' } ] const router = new Router ({ base : '/profile/' , mode : 'history' , linkActiveClass : 'is-active' , // router-link active\u6837\u5f0f /* \u7531\u4e8e\u672c\u9879\u76ee\u91c7\u7528\u5185\u6eda\u52a8\u5e03\u5c40\uff0c\u6b64\u5904\u4ee3\u7801\u65e0\u6548\uff0c\u9700\u8981\u81ea\u884chack vue-router\u83b7\u5f97\u6b64\u80fd\u529b saveScrollPosition: true, scrollBehavior (to, from, savedPosition) { }, */ routes // short for routes: routes }) router . beforeEach (( to , from , next ) => { // if (store.getters.getIsAuth || !to.meta.auth) { // next() // } else { // \u5224\u65ad\u662f\u5426\u767b\u5f55\uff0c\uff08\u53ef\u4ee5\u901a\u8fc7\u63a5\u53e3\uff0cVuex\u72b6\u6001 token\uff09 // \u6ca1\u6709\u767b\u5f55\u8d70\u4e0b\u9762\u903b\u8f91 document . title = to . meta . title + ' ' + '| \u540e\u53f0\u7ba1\u7406' if ( global . $fn . csrf . isExpired ()) { global . $fn . csrf . requestToken () } next () // } }) new Vue ({ router , render : h => h ( App ) }). $mount ( '#app' ) src \u76ee\u5f55\u4e0b\u65b0\u5efa\u4e2a\u6587\u4ef6 App.vue \uff0c\u4f5c\u4e3a\u5e94\u7528\u7684\u4e3b\u6587\u4ef6 < template > < section id = \"app-container\" > < xheader ></ xheader > < sidebar ></ sidebar > < div id = \"main-content\" > < router-view keep-alive ></ router-view > </ div > < transition name = \"fade\" > < modal v-show = \"isModal\" @ closemodal = \"closeModal()\" :mode = \"modalinfo.mode\" :title = \"modalinfo.title\" \" :content = \"modalinfo.content\" :width = \"modalinfo.width\" :ok = \"modalinfo.ok\" \" :cancel = \"modalinfo.cancel\" ></ modal > </ transition > </ div > </ template > < script > // vuex\u5168\u5c40\u6570\u636e import store from './store' import Xheader from './components/header' import Sidebar from './components/sidebar' import { Modal } from './components/modal' export default { store : store , components : { Modal , Xheader , Sidebar }, data () { return { modalinfo : { mode : 'alert' , title : '' , content : '' , callback : null } // data } }, computed : { isModal () { return this . $store . getters . getModal } /* isAuth () { return this.$store.getters.getIsAuth }, toastArray () { return this.$store.getters.getToast }, preloaderShow () { return this.$store.getters.getPreloader } */ }, methods : { showModal ( mode , title , content , width , ok , cancel ) { this . $set ( this . modalinfo , 'mode' , mode ) this . $set ( this . modalinfo , 'title' , title ) this . $set ( this . modalinfo , 'content' , content ) this . $set ( this . modalinfo , 'width' , width ) this . $set ( this . modalinfo , 'ok' , ok ) this . $set ( this . modalinfo , 'cancel' , cancel ) store . commit ( 'modal' , true ) }, closeModal () { store . commit ( 'modal' , false ) } }, mounted () { // let ico = require('./assets/images/vueico.png') // let icon = require('./assets/images/vuelogo.png') // document.getElementById('linkIcon').href = ico // document.getElementById('linkAppIcon').href = icon window . applicationCache . addEventListener ( 'updateready' , ( e ) => { if ( window . applicationCache . status === window . applicationCache . UPDATEREADY ) { console . log ( 'system update' ) window . location . reload () } }, false ) } } </ script > < style lang = \"less\" > @ import './lancer.less' ; </ style > \u54e6\uff0c\u5bf9\u4e86\uff0c\u8fd8\u6709\u5bf9\u5e94\u7684 css \u6587\u4ef6\uff0c\u5f53\u7136\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u7528 less \u6587\u4ef6\uff0cgulp\u76d1\u63a7\u4efb\u52a1\u4f1a\u81ea\u52a8\u7f16\u8bd1\u6210css\u6587\u4ef6 \u8fd9\u91cc\u6211\u4eec\u76f4\u63a5 import \u5f15\u5165 less \u6587\u4ef6\uff0c\u57fa\u4e8e\u76f8\u5bf9\u8def\u5f84","title":"vue\u5728drupal\u4e2d\u7684\u6a21\u5757\u5316\u5f00\u53d1"}]}