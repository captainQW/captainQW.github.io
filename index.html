<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"verynil.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录生活，分享知识，传播乐趣">
<meta property="og:type" content="website">
<meta property="og:title" content="Lau&#39;s Blog">
<meta property="og:url" content="https://verynil.com/index.html">
<meta property="og:site_name" content="Lau&#39;s Blog">
<meta property="og:description" content="记录生活，分享知识，传播乐趣">
<meta property="og:locale">
<meta property="article:author" content="www.verynil.com">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://verynil.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Lau's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Lau's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录生活，分享知识，传播乐趣</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">65</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">15</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">81</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2021/04/28/kubernetes%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/28/kubernetes%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/" class="post-title-link" itemprop="url">kubernetes安装部署实战</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-28 13:50:55" itemprop="dateCreated datePublished" datetime="2021-04-28T13:50:55+08:00">2021-04-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-28 10:04:53" itemprop="dateModified" datetime="2022-03-28T10:04:53+08:00">2022-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/k8s/" itemprop="url" rel="index"><span itemprop="name">k8s</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1、安装kubsphere<br>2、安装监控prometheus<br>3、安装日志elk<br>4、CI gitlab+jenkins 镜像push到harbo<br>5、CD  安装spinaker 自动部署到k8s集群</p>
<p>先搞CI</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/04/28/kubernetes%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2017/02/28/Drupal8%E5%AE%9E%E4%BD%93-entity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/28/Drupal8%E5%AE%9E%E4%BD%93-entity/" class="post-title-link" itemprop="url">Drupal8实体(entity)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2017-02-28 20:36:33 / Modified: 20:39:22" itemprop="dateCreated datePublished" datetime="2017-02-28T20:36:33+08:00">2017-02-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal 的 Entity 是一个很重要的概念，暂时把 Entity 翻译成“实体”吧。正确的理解 Entity，有助于理解 Drupal 信息管理结构，对于使用 Drupal 会有很大的帮助，下面将对这个 Entity 做一个通俗的解释。</p>
<h2 id="先简单介绍一下-Entity："><a href="#先简单介绍一下-Entity：" class="headerlink" title="先简单介绍一下 Entity："></a>先简单介绍一下 Entity：</h2><p>什么是 Entity？Entity 包括 Nodes（节点）, Users（用户）, Taxonomy Terms（术语）, Comments（评论），它们都是实体，只是命名和用途不一样而已。下面翻译一下 Drupal 官网找到的几行定义文字：<br>An entity type is a base class<br>一个实体类型是基础类别<br>A bundle is an extended class<br>一个集合是扩展类别<br>A field is a class member, property, variable or field instance (depending on your naming preference)<br>一个字段是一个类别的成员、属性、元素、或者字段实例（取决于你的命名喜好）<br>An entity is an object or instance of a base or extended class<br>一个实体是一个物体，或者是基础类别的实例，或者是扩展类别的实例<br>更多的就不翻译了，免得看得一头雾水。如果你能理解，下面的内容也不用看了。</p>
<h2 id="关于-Entity-的通俗解释："><a href="#关于-Entity-的通俗解释：" class="headerlink" title="关于 Entity 的通俗解释："></a>关于 Entity 的通俗解释：</h2><p>这是根据我对 Entity 的理解来解释的，我觉得我对 Entity 理解得差不多了，不至于对大家造成多大的误导。<br>好了，让我们来打个比方，请充分发挥你的联想能力：<br>把 Entity Type（实体类型） 看做事物——事物有很多种，包括生物、非生物等，比如竹子、蝴蝶、雨花石、空气等。<br>把 Bundle（集合） 看成某一类具体的事物，比如竹类——竹子其实也分很多种，比如水竹、毛竹、紫竹、苦竹等<br>把 Entity（实体）看成某一种具体的事物，比如毛竹——毛竹其实其实是由很多部分组成的，比如主干、竹枝、竹叶、根须等<br>把 Field（字段）看成组成某一具体事物的一部分，比如竹叶<br>这样也许比较好理解吧。你也可以把 Bundle 看成蝴蝶这个大类，Entity 相当于大鸟翼蝶什么的，字段相当于翅膀、触须什么的。以此类推。</p>
<h2 id="Content-Type（内容类型）："><a href="#Content-Type（内容类型）：" class="headerlink" title="Content Type（内容类型）："></a>Content Type（内容类型）：</h2><p>在括号内加解释太乱了，分两行吧，一行翻译成中文，一行不翻译。我个人觉得不翻译的话好理解一点，但是对英语不熟悉的网友看英语可能不好理解。<br>翻译的：内容类型其实就是节点这种实体的集合，默认包括标题、内容两个字段。评论也是一个实体，它和节点这种实体是关联的关系。<br>不翻译：Content Type 其实就是 node 这种 Entity 的 Bundle，默认包括 Title、Body 两个 Filed。</p>
<h2 id="应用："><a href="#应用：" class="headerlink" title="应用："></a>应用：</h2><p>理解了 Entity（实体）之后，自然就是应用了。可以用 Entity Construction Kit (ECK)  这个模块创建新的Entity（实体），或者简单的，就添加新的 Content Type（内容类型）吧。<br>内容所指的其实不仅仅是文章，图片、音乐、电影、文件、书籍、应用等等都是内容。你想做什么站点就怎么去定义它，它有什么属性就添加几个字段。<br>把内容理解成某些东西就对了，只要它是信息数据都能用 Drupal 来管理。怎么样？知道 Drupal 可以做很多种网站了吧？其实前面说的主要还是资讯类的网站，更多类型的网站该怎么做，就要发挥你的思维力了。思路决定出路，见识改变思维。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/02/28/Drupal8%E5%AE%9E%E4%BD%93-entity/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2017/02/18/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/18/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" class="post-title-link" itemprop="url">MySQL互联网业务数据库设计规范</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2017-02-18 12:56:18 / Modified: 14:57:52" itemprop="dateCreated datePublished" datetime="2017-02-18T12:56:18+08:00">2017-02-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>适用场景：并发量大、数据量大的互联网业务</p>
<h2 id="一、基础规范"><a href="#一、基础规范" class="headerlink" title="一、基础规范"></a>一、基础规范</h2><p>（1）必须使用InnoDB存储引擎<br>解读：支持事务、行级锁、并发性能更好、CPU及内存缓存页优化使得资源利用率更高</p>
<p>（2）必须使用UTF8字符集<br>解读：万国码，无需转码，无乱码风险<br>字符集推荐使用utf8mb4字符集,utf8mb4是utf8的超集，emoji表情以及部分不常见汉字在utf8下会表现为乱码，故需要升级至utf8mb4。</p>
<p>（3）数据表、数据字段必须加入中文注释<br>解读：N年后谁tm知道这个r1,r2,r3字段是干嘛的</p>
<p>（4）禁止使用存储过程、视图、触发器、Event<br>解读：高并发大数据的互联网业务，架构设计思路是“解放数据库CPU，将计算转移到服务层”，并发量大的情况下，这些功能很可能将数据库拖死，业务逻辑放到服务层具备更好的扩展性，能够轻易实现“增机器就加性能”。数据库擅长存储与索引，CPU计算还是上移吧</p>
<p>（5）禁止存储大文件或者大照片<br>解读：为何要让数据库做它不擅长的事情？大文件和照片存储在文件系统，数据库里存URI多好</p>
<h2 id="二、命名规范"><a href="#二、命名规范" class="headerlink" title="二、命名规范"></a>二、命名规范</h2><p>（6）只允许使用内网域名，而不是ip连接数据库<br> 解读：不只是数据库，缓存（memcache、redis）的连接，服务（service）的连接都必须使用内网域名，机器迁移/平滑升级/运维管理…太多太多的好处。</p>
<p>（7）线上环境、开发环境、测试环境数据库内网域名遵循命名规范<br>业务名称：xxx<br>线上环境：xxx.db<br>开发环境：xxx.rdb<br>测试环境：xxx.tdb<br>从库在名称后加-s标识，备库在名称后加-ss标识<br>线上从库：xxx-s.db<br>线上备库：xxx-sss.db</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/02/18/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2017/01/27/vue%E5%9C%A8drupal%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/01/27/vue%E5%9C%A8drupal%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/" class="post-title-link" itemprop="url">vue在drupal中的模块化开发</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-01-27 22:44:41" itemprop="dateCreated datePublished" datetime="2017-01-27T22:44:41+08:00">2017-01-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-18 15:07:01" itemprop="dateModified" datetime="2017-02-18T15:07:01+08:00">2017-02-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/drupal/" itemprop="url" rel="index"><span itemprop="name">drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><code>vue</code>的模块化开发，基于<code>webpack</code>，<code>gulp</code></p>
<p>由于<code>vue</code>组件系统，<code>drupal</code>中的<code>vue</code>可以直接在主题中写组件</p>
<p>OK，初始化一个主题，<code>lancer</code></p>
<p>本地先安装node</p>
<p>然后在<code>lancer</code>目录下先放个<code>package.json</code>文件</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;voss&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.0.1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;webapp with Vue.js for voss.&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;panjun.liu &lt;panjun.liu@verycloud.cn&gt;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;dev&quot;</span>: <span class="string">&quot;node build/dev-server.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;node build/build.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;unit&quot;</span>: <span class="string">&quot;karma start test/unit/karma.conf.js --single-run&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;npm run unit&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lint&quot;</span>: <span class="string">&quot;eslint --ext .js,.vue src test/unit/specs test/e2e/specs&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;vue&quot;</span>: <span class="string">&quot;^2.0.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-runtime&quot;</span>: <span class="string">&quot;^6.11.6&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;babel-core&quot;</span>: <span class="string">&quot;^6.16.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-loader&quot;</span>: <span class="string">&quot;^6.2.5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-plugin-transform-runtime&quot;</span>: <span class="string">&quot;^6.15.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-preset-es2015&quot;</span>: <span class="string">&quot;^6.16.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;babel-preset-stage-2&quot;</span>: <span class="string">&quot;^6.16.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;bulma&quot;</span>: <span class="string">&quot;0.2.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;chai&quot;</span>: <span class="string">&quot;^3.5.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;chart.js&quot;</span>: <span class="string">&quot;^2.3.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;connect-history-api-fallback&quot;</span>: <span class="string">&quot;^1.3.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;css-loader&quot;</span>: <span class="string">&quot;^0.25.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;element-ui&quot;</span>: <span class="string">&quot;^1.0.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint&quot;</span>: <span class="string">&quot;^3.7.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint-config-standard&quot;</span>: <span class="string">&quot;^6.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint-friendly-formatter&quot;</span>: <span class="string">&quot;^2.0.6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint-loader&quot;</span>: <span class="string">&quot;^1.5.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint-plugin-html&quot;</span>: <span class="string">&quot;^1.5.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint-plugin-promise&quot;</span>: <span class="string">&quot;^2.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eslint-plugin-standard&quot;</span>: <span class="string">&quot;^2.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;eventsource-polyfill&quot;</span>: <span class="string">&quot;^0.9.6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;^4.14.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;extract-text-webpack-plugin&quot;</span>: <span class="string">&quot;^1.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;fastclick&quot;</span>: <span class="string">&quot;^1.0.6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;file-loader&quot;</span>: <span class="string">&quot;^0.9.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;function-bind&quot;</span>: <span class="string">&quot;^1.1.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;html-webpack-plugin&quot;</span>: <span class="string">&quot;^2.22.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;http-proxy-middleware&quot;</span>: <span class="string">&quot;^0.17.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;inject-loader&quot;</span>: <span class="string">&quot;^2.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;isparta-loader&quot;</span>: <span class="string">&quot;^2.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;json-loader&quot;</span>: <span class="string">&quot;^0.5.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma&quot;</span>: <span class="string">&quot;^1.3.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-coverage&quot;</span>: <span class="string">&quot;^1.1.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-mocha&quot;</span>: <span class="string">&quot;^1.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-phantomjs-launcher&quot;</span>: <span class="string">&quot;^1.0.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-sinon-chai&quot;</span>: <span class="string">&quot;^1.2.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-sourcemap-loader&quot;</span>: <span class="string">&quot;^0.3.7&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-spec-reporter&quot;</span>: <span class="string">&quot;0.0.26&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;karma-webpack&quot;</span>: <span class="string">&quot;^1.8.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;less&quot;</span>: <span class="string">&quot;^2.7.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;less-loader&quot;</span>: <span class="string">&quot;^2.2.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lolex&quot;</span>: <span class="string">&quot;^1.5.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;mocha&quot;</span>: <span class="string">&quot;^3.1.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;moment&quot;</span>: <span class="string">&quot;^2.14.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;ora&quot;</span>: <span class="string">&quot;^0.3.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;phantomjs-prebuilt&quot;</span>: <span class="string">&quot;^2.1.12&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;shelljs&quot;</span>: <span class="string">&quot;^0.7.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sinon&quot;</span>: <span class="string">&quot;^1.17.6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sinon-chai&quot;</span>: <span class="string">&quot;^2.8.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;swiper&quot;</span>: <span class="string">&quot;^3.3.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;url-loader&quot;</span>: <span class="string">&quot;^0.5.7&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-hot-reload-api&quot;</span>: <span class="string">&quot;^2.0.6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-html-loader&quot;</span>: <span class="string">&quot;^1.2.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-loader&quot;</span>: <span class="string">&quot;^9.7.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-resource&quot;</span>: <span class="string">&quot;^1.0.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-router&quot;</span>: <span class="string">&quot;^2.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-style-loader&quot;</span>: <span class="string">&quot;^1.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vuex&quot;</span>: <span class="string">&quot;^2.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack&quot;</span>: <span class="string">&quot;^1.13.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack-dev-middleware&quot;</span>: <span class="string">&quot;^1.8.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack-hot-middleware&quot;</span>: <span class="string">&quot;^2.13.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack-merge&quot;</span>: <span class="string">&quot;^0.14.1&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行<code>npm install</code>开始初始化环境</p>
<p>之后<code>npm install gulp gulp-util gulp-less gulp-concat gulp-open gulp-uglify gulp-cssmin gulp-md5-plus gulp-file-include gulp-clean gulp-css-spriter gulp-css-base64 webpack gulp-connect --save-dev</code>安装<code>gulp</code>环境</p>
<p>初始化<code>gulpfile.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>),</span><br><span class="line">  os = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>),</span><br><span class="line">  gutil = <span class="built_in">require</span>(<span class="string">&#x27;gulp-util&#x27;</span>),</span><br><span class="line">  less = <span class="built_in">require</span>(<span class="string">&#x27;gulp-less&#x27;</span>),</span><br><span class="line">  concat = <span class="built_in">require</span>(<span class="string">&#x27;gulp-concat&#x27;</span>),</span><br><span class="line">  gulpOpen = <span class="built_in">require</span>(<span class="string">&#x27;gulp-open&#x27;</span>),</span><br><span class="line">  uglify = <span class="built_in">require</span>(<span class="string">&#x27;gulp-uglify&#x27;</span>),</span><br><span class="line">  cssmin = <span class="built_in">require</span>(<span class="string">&#x27;gulp-cssmin&#x27;</span>),</span><br><span class="line">  md5 = <span class="built_in">require</span>(<span class="string">&#x27;gulp-md5-plus&#x27;</span>),</span><br><span class="line">  fileinclude = <span class="built_in">require</span>(<span class="string">&#x27;gulp-file-include&#x27;</span>),</span><br><span class="line">  clean = <span class="built_in">require</span>(<span class="string">&#x27;gulp-clean&#x27;</span>),</span><br><span class="line">  spriter = <span class="built_in">require</span>(<span class="string">&#x27;gulp-css-spriter&#x27;</span>),</span><br><span class="line">  base64 = <span class="built_in">require</span>(<span class="string">&#x27;gulp-css-base64&#x27;</span>),</span><br><span class="line">  webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>),</span><br><span class="line">  webpackConfig = <span class="built_in">require</span>(<span class="string">&#x27;./build/webpack.prod.conf.js&#x27;</span>),</span><br><span class="line">  connect = <span class="built_in">require</span>(<span class="string">&#x27;gulp-connect&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> host = &#123;</span><br><span class="line">  path: <span class="string">&#x27;dist/&#x27;</span>,</span><br><span class="line">  port: <span class="number">3000</span>,</span><br><span class="line">  html: <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mac chrome: &quot;Google chrome&quot;, </span></span><br><span class="line"><span class="keyword">var</span> browser = os.platform() === <span class="string">&#x27;linux&#x27;</span> ? <span class="string">&#x27;Google chrome&#x27;</span> : (</span><br><span class="line">  os.platform() === <span class="string">&#x27;darwin&#x27;</span> ? <span class="string">&#x27;Google chrome&#x27;</span> : (</span><br><span class="line">    os.platform() === <span class="string">&#x27;win32&#x27;</span> ? <span class="string">&#x27;chrome&#x27;</span> : <span class="string">&#x27;firefox&#x27;</span>));</span><br><span class="line"><span class="keyword">var</span> pkg = <span class="built_in">require</span>(<span class="string">&#x27;./package.json&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将图片拷贝到目标目录</span></span><br><span class="line">gulp.task(<span class="string">&#x27;copy:images&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src([<span class="string">&#x27;src/images/**/*&#x27;</span>]).pipe(gulp.dest(<span class="string">&#x27;dist/images&#x27;</span>)).on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//压缩合并css, css中既有自己写的.less, 也有引入第三方库的.css</span></span><br><span class="line">gulp.task(<span class="string">&#x27;lessmin&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src([<span class="string">&#x27;src/css/main.less&#x27;</span>, <span class="string">&#x27;src/css/*.css&#x27;</span>])</span><br><span class="line">    .pipe(less())</span><br><span class="line">    <span class="comment">//这里可以加css sprite 让每一个css合并为一个雪碧图</span></span><br><span class="line">    <span class="comment">//.pipe(spriter(&#123;&#125;))</span></span><br><span class="line">    .pipe(concat(<span class="string">&#x27;style.min.css&#x27;</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">&#x27;dist/css/&#x27;</span>))</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将js加上10位md5,并修改html中的引用路径，该动作依赖build-js</span></span><br><span class="line">gulp.task(<span class="string">&#x27;md5:js&#x27;</span>, [<span class="string">&#x27;build-js&#x27;</span>], <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">&#x27;dist/js/*.js&#x27;</span>)</span><br><span class="line">    .pipe(md5(<span class="number">10</span>, <span class="string">&#x27;dist/app/*.html&#x27;</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">&#x27;dist/js&#x27;</span>))</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将css加上10位md5，并修改html中的引用路径，该动作依赖sprite</span></span><br><span class="line">gulp.task(<span class="string">&#x27;md5:css&#x27;</span>, [<span class="string">&#x27;sprite&#x27;</span>], <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">&#x27;dist/css/*.css&#x27;</span>)</span><br><span class="line">    .pipe(md5(<span class="number">10</span>, <span class="string">&#x27;dist/app/*.html&#x27;</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">&#x27;dist/css&#x27;</span>))</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//用于在html文件中直接include文件</span></span><br><span class="line">gulp.task(<span class="string">&#x27;fileinclude&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src([<span class="string">&#x27;src/app/*.html&#x27;</span>])</span><br><span class="line">    .pipe(fileinclude(&#123;</span><br><span class="line">      prefix: <span class="string">&#x27;@@&#x27;</span>,</span><br><span class="line">      basepath: <span class="string">&#x27;@file&#x27;</span></span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">&#x27;dist/app&#x27;</span>))</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">  <span class="comment">// .pipe(connect.reload())</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//雪碧图操作，应该先拷贝图片并压缩合并css</span></span><br><span class="line">gulp.task(<span class="string">&#x27;sprite&#x27;</span>, [<span class="string">&#x27;copy:images&#x27;</span>, <span class="string">&#x27;lessmin&#x27;</span>], <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> timestamp = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  gulp.src(<span class="string">&#x27;dist/css/style.min.css&#x27;</span>)</span><br><span class="line">    .pipe(spriter(&#123;</span><br><span class="line">      spriteSheet: <span class="string">&#x27;dist/images/spritesheet&#x27;</span> + timestamp + <span class="string">&#x27;.png&#x27;</span>,</span><br><span class="line">      pathToSpriteSheetFromCSS: <span class="string">&#x27;../images/spritesheet&#x27;</span> + timestamp + <span class="string">&#x27;.png&#x27;</span>,</span><br><span class="line">      spritesmithOptions: &#123;</span><br><span class="line">        padding: <span class="number">10</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(base64())</span><br><span class="line">    .pipe(cssmin())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">&#x27;dist/css&#x27;</span>))</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">&#x27;clean&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src([<span class="string">&#x27;dist&#x27;</span>])</span><br><span class="line">    .pipe(clean())</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">&#x27;watch&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.watch([<span class="string">&#x27;/var/www/html/voss/**/*.vue&#x27;</span>, <span class="string">&#x27;/var/www/html/voss/**/*.js&#x27;</span>, <span class="string">&#x27;/var/www/html/voss/**/*.less&#x27;</span>], [<span class="string">&#x27;lessmin&#x27;</span>, <span class="string">&#x27;build-js&#x27;</span>, <span class="string">&#x27;fileinclude&#x27;</span>])</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">&#x27;connect&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;connect------------&#x27;</span>);</span><br><span class="line">  connect.server(&#123;</span><br><span class="line">    root: host.path,</span><br><span class="line">    port: host.port,</span><br><span class="line">    livereload: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">&#x27;open&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    .pipe(gulpOpen(&#123;</span><br><span class="line">      app: browser,</span><br><span class="line">      uri: <span class="string">&#x27;http://localhost:3000/app&#x27;</span></span><br><span class="line">    &#125;))</span><br><span class="line">    .on(<span class="string">&#x27;end&#x27;</span>, done);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myDevConfig = <span class="built_in">Object</span>.create(webpackConfig);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> devCompiler = webpack(myDevConfig);</span><br><span class="line"></span><br><span class="line"><span class="comment">//引用webpack对js进行操作</span></span><br><span class="line">gulp.task(<span class="string">&quot;build-js&quot;</span>, [<span class="string">&#x27;fileinclude&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  devCompiler.run(<span class="function"><span class="keyword">function</span>(<span class="params">err, stats</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err) <span class="keyword">throw</span> <span class="keyword">new</span> gutil.PluginError(<span class="string">&quot;webpack:build-js&quot;</span>, err);</span><br><span class="line">    gutil.log(<span class="string">&quot;[webpack:build-js]&quot;</span>, stats.toString(&#123;</span><br><span class="line">      colors: <span class="literal">true</span></span><br><span class="line">    &#125;));</span><br><span class="line">    callback();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//发布</span></span><br><span class="line">gulp.task(<span class="string">&#x27;default&#x27;</span>, [<span class="string">&#x27;connect&#x27;</span>, <span class="string">&#x27;fileinclude&#x27;</span>, <span class="string">&#x27;md5:css&#x27;</span>, <span class="string">&#x27;md5:js&#x27;</span>, <span class="string">&#x27;open&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//开发</span></span><br><span class="line">gulp.task(<span class="string">&#x27;dev&#x27;</span>, [<span class="string">&#x27;connect&#x27;</span>, <span class="string">&#x27;copy:images&#x27;</span>, <span class="string">&#x27;fileinclude&#x27;</span>, <span class="string">&#x27;lessmin&#x27;</span>, <span class="string">&#x27;build-js&#x27;</span>, <span class="string">&#x27;watch&#x27;</span>, <span class="string">&#x27;open&#x27;</span>]);</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/01/27/vue%E5%9C%A8drupal%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2017/01/15/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/01/15/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/" class="post-title-link" itemprop="url">Vue路由进阶</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-01-15 10:46:27" itemprop="dateCreated datePublished" datetime="2017-01-15T10:46:27+08:00">2017-01-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-18 15:06:51" itemprop="dateModified" datetime="2017-02-18T15:06:51+08:00">2017-02-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="导航钩子"><a href="#导航钩子" class="headerlink" title="导航钩子"></a>导航钩子</h3><p>有的时候，我们可能有这样的需求，当页面切换时，需要做一些操作来更改某些信息，这就需要拦截路由切换。vue-router 提供了导航钩子来拦截导航，让它完成跳转或取消。有多种方式可以在路由导航发生时执行钩子：全局的, 单个路由独享的, 或者组件级的。</p>
<h4 id="全局钩子"><a href="#全局钩子" class="headerlink" title="全局钩子"></a>全局钩子</h4><p>你可以使用 router.beforeEach 注册一个全局的 before 钩子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const router &#x3D; new VueRouter(&#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach((to, from, next) &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>当一个导航触发时，全局的 before 钩子按照创建顺序调用。钩子是异步解析执行，此时导航在所有钩子 resolve 完之前一直处于 等待中。<br>每个钩子方法接收三个参数：<br>to: Route: 即将要进入的目标 路由对象</p>
<p>from: Route: 当前导航正要离开的路由</p>
<p>next: Function: 一定要调用该方法来 resolve 这个钩子。执行效果依赖 next 方法的调用参数。</p>
<p>next(): 进行管道中的下一个钩子。如果全部钩子执行完了，则导航的状态就是 confirmed （确认的）。</p>
<p>next(false): 中断当前的导航。如果浏览器的 URL 改变了（可能是用户手动或者浏览器后退按钮），那么 URL 地址会重置到 from 路由对应的地址。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/01/15/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2017/01/12/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/01/12/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">Vue路由入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-01-12 10:46:27" itemprop="dateCreated datePublished" datetime="2017-01-12T10:46:27+08:00">2017-01-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-18 15:06:44" itemprop="dateModified" datetime="2017-02-18T15:06:44+08:00">2017-02-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h3><p>Vue路由（vue-router）是Vue用来创建单页应用的第三方库，使用vue-router可以很方便的创建无刷新切换页面的应用。vue-router基于vue的组件系统（不熟悉组件请先学习Vue组件），要使用vue-router只需要将路径和组件建立对应关系，这样路由系统就知道哪个路径需要渲染哪个组件。</p>
<h3 id="2、开始"><a href="#2、开始" class="headerlink" title="2、开始"></a>2、开始</h3><p>在开始写第一个路由示例之前，我们先来了解一些基本概念。<br>（1）路由<br>路由即url路径和组件之间的对应关系。<br>（2）router-link组件<br> router-link组件即页面上连接到某个路由的超链接，最终渲染后会变成a标签。比如我需要在页面上设置连接到/profile/user的超链接，则只要在页面放上&lt;router-link to=”/profile/user”&gt;用户列表&lt;/router-link&gt;就行了。<br> （3）router-view组件<br> router-view组件是路由组件渲染的容器，一旦路由匹配到了，vue就会将路由对应的组件渲染到router-view标签所在的位置。比如点击上例中的profile/user超链接，vue首先查找profile/user对应的路由是什么，查找到后再找出路由对应的组件，然后将组件渲染到router-view标签。</p>
<p>了解上述概念之后，我们可以开始写我们的第一个路由示例，我们首先创建index.html,代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">  &lt;h1&gt;Hello App!&lt;&#x2F;h1&gt;</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">    &lt;!-- 使用 router-link 组件来导航. --&gt;</span><br><span class="line">    &lt;!-- 通过传入 &#96;to&#96; 属性指定链接. --&gt;</span><br><span class="line">    &lt;!-- &lt;router-link&gt; 默认会被渲染成一个 &#96;&lt;a&gt;&#96; 标签 --&gt;</span><br><span class="line">    &lt;router-link to&#x3D;&quot;&#x2F;profile&#x2F;user&quot;&gt;用户列表&lt;&#x2F;router-link&gt;</span><br><span class="line">  &lt;&#x2F;p&gt;</span><br><span class="line">  &lt;!-- 路由出口 --&gt;</span><br><span class="line">  &lt;!-- 路由匹配到的组件将渲染在这里 --&gt;</span><br><span class="line">  &lt;router-view&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;!-- 注意，这里引入vue-router.js对于script方式引入文件的方式是必不可少的.我们以后再讨论使用ES6模块引入的方式 --&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;vue-router&#x2F;dist&#x2F;vue-router.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;!-- 应用入口文件 --&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;&#x2F;js&#x2F;app.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>接着我们继续创建app.js，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 1. 定义（路由）组件。</span><br><span class="line">&#x2F;&#x2F; 在现实的开发中，一般将组件放在单独的文件中，然后从其他文件 import 进来</span><br><span class="line">&#x2F;&#x2F; 为了简单起见，我们这里先使用字符串模板组件，以后再讨论单文件组件（.vue文件）</span><br><span class="line">const User &#x3D; &#123;</span><br><span class="line">  template: &#39;&lt;div&gt;这里是用户列表&lt;&#x2F;div&gt;&#39; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 2. 定义路由</span><br><span class="line">&#x2F;&#x2F; 每个路由应该映射一个组件。 其中&quot;component&quot; 可以是</span><br><span class="line">&#x2F;&#x2F; 通过 Vue.extend() 创建的组件构造器，</span><br><span class="line">&#x2F;&#x2F; 或者，只是一个组件配置对象。</span><br><span class="line">const routes &#x3D; [</span><br><span class="line">  &#123; </span><br><span class="line">    path: &#39;&#x2F;profile&#x2F;user&#39;, </span><br><span class="line">    component: User </span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 3. 创建 router 实例，然后传 &#96;routes&#96; 配置</span><br><span class="line">&#x2F;&#x2F; 你还可以传别的配置参数, 不过先这么简单着吧。</span><br><span class="line">const router &#x3D; new VueRouter(&#123;</span><br><span class="line">  routes &#x2F;&#x2F; ES6（缩写）相当于 routes: routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 4. 创建和挂载根实例。</span><br><span class="line">&#x2F;&#x2F; 记得要通过 router 配置参数注入路由，</span><br><span class="line">&#x2F;&#x2F; 从而让整个应用都有路由功能</span><br><span class="line">const app &#x3D; new Vue(&#123;</span><br><span class="line">  router</span><br><span class="line">&#125;).$mount(&#39;#app&#39;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 现在，应用已经启动了！</span><br></pre></td></tr></table></figure>

<p>至此，一个最简单的路由应用就完成了，部署到服务器后，打开<a href="http://localhost,则可以看到界面有一个“用户详情”超链接，点击超链接，界面会显示“这里是用户列表”，同时界面并没有刷新，所有的操作都在一个界面内完成，所以这也叫单页应用，与以前那些点击超链接就要刷新页面的应用相比是不是用户体验更高？">http://localhost,则可以看到界面有一个“用户详情”超链接，点击超链接，界面会显示“这里是用户列表”，同时界面并没有刷新，所有的操作都在一个界面内完成，所以这也叫单页应用，与以前那些点击超链接就要刷新页面的应用相比是不是用户体验更高？</a></p>
<h3 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/01/12/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/12/21/git%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/21/git%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/" class="post-title-link" itemprop="url">git自动化部属</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-12-21 07:47:36 / Modified: 11:38:13" itemprop="dateCreated datePublished" datetime="2016-12-21T07:47:36+08:00">2016-12-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>gitlab和github都支持通过webhook自动部署，本文使用gitlab+webhook的方式实现自动化部署项目。</p>
<p>1、填写回调URL<br>随便在gitlab上找一个项目，填写回调URL，如果有Push请求，gitlab会自动回调你填写的这个地址。<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20161221/2016122175313_33517.png" alt="回调地址"></p>
<p>2、开发服务器配置<br>一般php是通过php-fpm来运行，而php-fpm一般由apache用户来运行。确保clone下来的仓库权限比如为apache.<br>可通过如下命令进行修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chown apache:apache you_project * -R</span></span><br></pre></td></tr></table></figure>

<p>创建apache用户的.ssh文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u apache ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>

<p>3、测试<br>在本地commit一个提交.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git ci -am &#x27;test webhook&#x27;</span></span><br><span class="line"><span class="comment"># git push origin dev</span></span><br></pre></td></tr></table></figure>

<p>在开发服务器上查看日志</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tail -f /var/log/php-fpm/www-error.log</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/12/21/git%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/12/20/Mariadb-ColumnStore%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/20/Mariadb-ColumnStore%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">Mariadb ColumnStore数据库测试</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-12-20 15:06:53 / Modified: 15:41:11" itemprop="dateCreated datePublished" datetime="2016-12-20T15:06:53+08:00">2016-12-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>顾名思义，就是Mariadb为了大数据而开发的列式数据库。后来发现，这货就是InfiniDB的翻版，InfiniDB被MariaDB收购了以后重新开发的新版本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show engines;</span><br><span class="line">+--------------------+---------+--------------------------------------------------------------------------------------------------+--------------+------+------------+</span><br><span class="line">| Engine             | Support | Comment                                                                                          | Transactions | XA   | Savepoints |</span><br><span class="line">+--------------------+---------+--------------------------------------------------------------------------------------------------+--------------+------+------------+</span><br><span class="line">| Columnstore        | YES     | Columnstore storage engine                                                                       | YES          | NO   | NO         |</span><br><span class="line">| MRG_MyISAM         | YES     | Collection of identical MyISAM tables                                                            | NO           | NO   | NO         |</span><br><span class="line">| CSV                | YES     | CSV storage engine                                                                               | NO           | NO   | NO         |</span><br><span class="line">| MyISAM             | YES     | MyISAM storage engine                                                                            | NO           | NO   | NO         |</span><br><span class="line">| MEMORY             | YES     | Hash based, stored <span class="keyword">in</span> memory, useful <span class="keyword">for</span> temporary tables                                        | NO           | NO   | NO         |</span><br><span class="line">| InfiniDB           | YES     | Columnstore storage engine (deprecated: use columnstore)                                         | YES          | NO   | NO         |</span><br><span class="line">| InnoDB             | DEFAULT | Percona-XtraDB, Supports transactions, row-level locking, foreign keys and encryption <span class="keyword">for</span> tables | YES          | YES  | YES        |</span><br><span class="line">| SEQUENCE           | YES     | Generated tables filled with sequential values                                                   | YES          | NO   | YES        |</span><br><span class="line">| Aria               | YES     | Crash-safe tables with MyISAM heritage                                                           | NO           | NO   | NO         |</span><br><span class="line">| PERFORMANCE_SCHEMA | YES     | Performance Schema                                                                               | NO           | NO   | NO         |</span><br><span class="line">+--------------------+---------+--------------------------------------------------------------------------------------------------+--------------+------+------------+</span><br><span class="line">10 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>还能看到InfiniDB引擎的影子。</p>
<p>测试环境：<br>centos 6.6 8核8G<br>ssd 100G<br>mariadb columnstore 1.0.6 GA</p>
<p>1、安装</p>
<p>安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum -y install expect perl perl-DBI openssl zlib perl-DBD-MySQL cmake</span></span><br></pre></td></tr></table></figure>

<p>必须要boost1.50以上版本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget https://static.verycloud.cn/rpm/boost_1_55_0.tgz</span></span><br><span class="line"><span class="comment"># wget https://static.verycloud.cn/rpm/mariadb-columnstore-1.0.6-1-centos6.x86_64.rpm.tar.gz</span></span><br></pre></td></tr></table></figure>

<p>安装boost.</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/12/20/Mariadb-ColumnStore%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B5%8B%E8%AF%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/12/06/%E4%BD%BF%E7%94%A8safari%E5%AF%B9webview%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/06/%E4%BD%BF%E7%94%A8safari%E5%AF%B9webview%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95/" class="post-title-link" itemprop="url">使用safari对webview进行调试</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-12-06 13:01:47 / Modified: 13:10:44" itemprop="dateCreated datePublished" datetime="2016-12-06T13:01:47+08:00">2016-12-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在web开发的过程中，抓包、调试页面样式、查看请求头是很常用的技巧。其实在iOS开发中，这些技巧也能用（无论是模拟器还是真机），不过我们需要用到mac自带的浏览器Safari。所以，本文将讲解如何使用Safari对iOS程序中的webview进行调试。</p>
<p>环境信息：<br>Mac OS X 10.10.1<br>Xcode 6.1.1<br>iOS 8.1</p>
<p>1、打开模拟器（真机）的开发者模式</p>
<p>【设置】-&gt;【Safari】-&gt;【高级】-&gt;【Web检查器】打开</p>
<p><img src="https://static.verycloud.cn/sites/default/files/images/ios-user-safari-debug-webview-4.png" alt="打开iphone设备中的web检查器"><br>打开iphone设备中的web检查器</p>
<p>2、打开Mac上Safari的开发者模式</p>
<p>【Safari】-&gt;【偏好设置】-&gt;【高级】-&gt;【在菜单栏中显示“开发”菜单】勾选</p>
<p><img src="https://static.verycloud.cn/sites/default/files/images/ios-user-safari-debug-webview-2.png" alt="打开Safari中的开发者模式"><br>打开Safari中的开发者模式</p>
<p>3、写一个webview并加载一个网页</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#import &quot;ViewController.h&quot;</span></span><br><span class="line">@interfaceViewController ()</span><br><span class="line"></span><br><span class="line">@property (strong, nonatomic) UIWebView *webView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line"> - (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [superviewDidLoad];</span><br><span class="line">    // Do any additional setup after loading the view, typically from a nib.</span><br><span class="line">    </span><br><span class="line">    _webView = [[UIWebViewalloc] initWithFrame:self.view.bounds];</span><br><span class="line">    [_webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@<span class="string">&quot;http://www.baidu.com&quot;</span>]]];</span><br><span class="line">    [self.view addSubview:_webView];</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/12/06/%E4%BD%BF%E7%94%A8safari%E5%AF%B9webview%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/11/27/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/27/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/" class="post-title-link" itemprop="url">drupal8中使用vue</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-11-27 21:52:07" itemprop="dateCreated datePublished" datetime="2016-11-27T21:52:07+08:00">2016-11-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-11-28 08:59:26" itemprop="dateModified" datetime="2016-11-28T08:59:26+08:00">2016-11-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/drupal/" itemprop="url" rel="index"><span itemprop="name">drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、什么是vue"><a href="#一、什么是vue" class="headerlink" title="一、什么是vue"></a>一、什么是vue</h2><p><a target="_blank" rel="noopener" href="https://cn.vuejs.org/">点击这里</a>跳转vue官网</p>
<p>Vue.js（读音 /vjuː/, 类似于 view） 是一套构建用户界面的 渐进式框架。与其他重量级框架不同的是，Vue 采用自底向上增量开发的设计。</p>
<p>Vue 的核心库只关注视图层，并且非常容易学习，非常容易与其它库或已有项目整合。</p>
<h2 id="二、drupal融合vue"><a href="#二、drupal融合vue" class="headerlink" title="二、drupal融合vue"></a>二、drupal融合vue</h2><p>OK，新建一个模块，<code>cloud_system</code>，初始化一个<code>vue</code>在<code>drupal</code>中的根模版，如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;main-content&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样，所有的路由都输出这个模版，之后前端路由解析填充<code>router-view</code></p>
<h2 id="三、vue的模块化开发"><a href="#三、vue的模块化开发" class="headerlink" title="三、vue的模块化开发"></a>三、vue的模块化开发</h2><p>详见<strong>vue在drupal中的模块化开发</strong></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/11/27/drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/10/31/Drupal8-Configuration-Schema/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/10/31/Drupal8-Configuration-Schema/" class="post-title-link" itemprop="url">drupal8 configuration schema</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-10-31 16:39:15" itemprop="dateCreated datePublished" datetime="2016-10-31T16:39:15+08:00">2016-10-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-11-01 13:08:47" itemprop="dateModified" datetime="2016-11-01T13:08:47+08:00">2016-11-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal 8中configuration schema是用来描述配置文件的结构的. 它应用于:<br>定型配置以确保数据一致性<br>(see StorableConfigBase::castValue())</p>
<p>自动持久化实体属性的配置<br> (see ConfigEntityBase::toArray())</p>
<p>自动生成用户界面的翻译配置<br> (see the core module)</p>
<p>1、一个简单的示例<br>如下:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">config/install/my_module.settings.yml</span><br><span class="line">type: warning</span><br><span class="line">message: <span class="string">&#x27;Hello!&#x27;</span></span><br><span class="line">langcode: en</span><br><span class="line"></span><br><span class="line">config/schema/my_module.schema.yml</span><br><span class="line">my_module.settings:</span><br><span class="line">  type: config_object</span><br><span class="line">  mapping:</span><br><span class="line">    type:</span><br><span class="line">	  type: <span class="keyword">string</span></span><br><span class="line">	  label: <span class="string">&#x27;Message type&#x27;</span></span><br><span class="line">	message:</span><br><span class="line">	  type: label</span><br><span class="line">	  label: <span class="string">&#x27;Message text&#x27;</span></span><br><span class="line">	langcode:</span><br><span class="line">	  type: <span class="keyword">string</span></span><br><span class="line">	  label: <span class="string">&#x27;Language code&#x27;</span></span><br></pre></td></tr></table></figure>

<p>需要说明的是，my_module.schema.yml我们可以认为是一个自定义的数据结构体，而my_module.settings.yml则是给这个自定义的数据结构体定义了默认值，<br>在my_module.schema.yml中我们可以看到这个数据结构体中定义了一个mapping结构体(可以简单的认为是一个数组类型)，这个数组有三个key，分别是type、message、langcode，<br>前面说了my_module.settings.yml是给my_module.schema.yml这个数据结构体定义了默认值，我们可以看到在my_module.settings.yml中type的默认值是warning,message的默认值<br>是’Hello!’,langcode的默认值是en,值的注意的一点是，一个schema.yml文件可以定义多个数据结构体，但是每一个的数据结构体的root元素必须与settings.yml文件的文件名一致，<br>比如上面的两个文件settings.yml文件的文件名是my_module.settings.yml，my_module.schema.yml的root元素的名称就是my_module.settings。</p>
<p>2、schema中常用的数据类型<br>基本类型：<br>boolean，<br>integer，<br>float，<br>string，<br>uri，<br>email</p>
<p>列表类型：<br>mapping(知道key是什么)，<br>sequence(不知道key的具体值)</p>
<p>常见的子类型：<br>label: 短标签<br>text: 长文本<br>config_object: object根元素类型<br>config_entity: entity根元素类型</p>
<p>子类型化<br>所有configuration schema的子类型都是从现有的类型演化而来.<br>早些时候的简单示例子类型config_object (mapping的一个子类型) 可以进一步自定义key。<br>configuration schema根节点的数据类型一般都是config_object或者config_entity。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/10/31/Drupal8-Configuration-Schema/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/10/24/windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/10/24/windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/" class="post-title-link" itemprop="url">windows下安装配置drupalconsole</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-10-24 17:38:17" itemprop="dateCreated datePublished" datetime="2016-10-24T17:38:17+08:00">2016-10-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-10-25 09:38:59" itemprop="dateModified" datetime="2016-10-25T09:38:59+08:00">2016-10-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/drupal/" itemprop="url" rel="index"><span itemprop="name">drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="drupalconsole是啥"><a href="#drupalconsole是啥" class="headerlink" title="drupalconsole是啥"></a>drupalconsole是啥</h3><blockquote>
<p>The new CLI for Drupal. A tool to generate boilerplate code, interact with and debug Drupal.</p>
</blockquote>
<p>以上是官网的简介，总而言之是为drupal8而生的一个命令行工具</p>
<p><a target="_blank" rel="noopener" href="https://drupalconsole.com/">这里是官网</a></p>
<h3 id="drupalconsole在windows下的安装"><a href="#drupalconsole在windows下的安装" class="headerlink" title="drupalconsole在windows下的安装"></a>drupalconsole在windows下的安装</h3><p>本篇仅介绍在windows下的安装配置，linux请参见官网</p>
<p>1、下载<code>drupalconsole</code></p>
<p><a target="_blank" rel="noopener" href="https://drupalconsole.com/installer">点击这里</a>下载<code>drupalconsole</code>，更名<code>drupal</code></p>
<p>2、找个目录给他安顿</p>
<p>例如：<code>D:\system\drupalconsole</code>，如下图所示：</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/10/24/windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/10/07/web%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/10/07/web%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" class="post-title-link" itemprop="url">web开发规范</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-10-07 21:55:39" itemprop="dateCreated datePublished" datetime="2016-10-07T21:55:39+08:00">2016-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-10-08 09:22:53" itemprop="dateModified" datetime="2016-10-08T09:22:53+08:00">2016-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="文件编码"><a href="#文件编码" class="headerlink" title="文件编码"></a>文件编码</h2><p>前端开发涉及的所文件统一使用<code>utf-8</code>编码</p>
<h2 id="文件命名规则"><a href="#文件命名规则" class="headerlink" title="文件命名规则"></a>文件命名规则</h2><p>全部小写方式，以下划线分隔</p>
<p>例：my_project</p>
<blockquote>
<p>特例：drupal中的模版文件</p>
</blockquote>
<h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul>
<li>缩进使用2个空格；</li>
<li>嵌套的节点应该缩进；</li>
<li>在属性上，使用双引号，不要使用单引号；</li>
<li>属性名全小写，用中划线做分隔符；</li>
<li>不要在自动闭合标签结尾处使用斜线（<a target="_blank" rel="noopener" href="http://dev.w3.org/html5/spec-author-view/syntax.html#syntax-start-tag">HTML5 规范</a> 指出他们是可选的）；</li>
<li>不要忽略可选的关闭标签，例：<code>&lt;/li&gt;</code> 和 <code>&lt;/body&gt;</code>。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Page title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/company_logo.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Company&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;hello-world&quot;</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/10/07/web%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/08/22/infinidb%E4%B8%8Eclickhouse%E5%AF%B9%E6%AF%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/08/22/infinidb%E4%B8%8Eclickhouse%E5%AF%B9%E6%AF%94/" class="post-title-link" itemprop="url">infiniDB与clickhouse对比</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-08-22 13:55:37" itemprop="dateCreated datePublished" datetime="2016-08-22T13:55:37+08:00">2016-08-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-08-23 13:27:40" itemprop="dateModified" datetime="2016-08-23T13:27:40+08:00">2016-08-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>机器配置：</p>
<p>测试机：    dell R510<br>cpu：     xeon E5620<em>2<br>RAID卡：    H700<br>系统    ：ubuntu 14.04<br>内核：    Linux ubuntu 4.2.0-27-generic<br>raid级别：    raid0<br>文件系统：    ext4<br>硬盘：     SSD 240G</em>2<br>IP：    192.168.112.73</p>
<p>一、安装<br>1、infiniDB的安装见 <a target="_blank" rel="noopener" href="http://verynull.com/2015/06/24/infiniDB%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">http://verynull.com/2015/06/24/infiniDB安装配置/</a></p>
<p>2、clickhouse安装<br>只支持ubutu14.04,16.04，12.04，但是我在16.04上没有安装起来。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv E0C56BD4<span class="comment"># optional</span></span><br><span class="line"></span><br><span class="line">sudo mkdir -p /etc/apt/sources.list.d</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb http://repo.yandex.ru/clickhouse/trusty stable main&quot;</span> |</span><br><span class="line">sudo tee /etc/apt/sources.list.d/clickhouse.list</span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install clickhouse-server-common clickhouse-client</span><br><span class="line"></span><br><span class="line">sudo service clickhouse-server start</span><br><span class="line">clickhouse-client</span><br></pre></td></tr></table></figure>

<p>3、就安装过程而言，clickhouse方便很多，infiniDB要编译老半天。</p>
<p>二、性能测试</p>
<p>1、创建表</p>
<p>infiniDB:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `billing` (</span><br><span class="line">`did` int(11) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`hit` bigint(20) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`reqs` bigint(20) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`rx` bigint(20) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`tx` bigint(20) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`logtime` bigint(20) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`tpr` bigint(20) NOT NULL DEFAULT <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;&#x27;</span></span><br><span class="line">) ENGINE=infiniDB DEFAULT CHARSET=latin1</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/08/22/infinidb%E4%B8%8Eclickhouse%E5%AF%B9%E6%AF%94/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/07/20/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/20/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/" class="post-title-link" itemprop="url">Drupal8数据库(database)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-07-20 22:20:15 / Modified: 22:50:43" itemprop="dateCreated datePublished" datetime="2016-07-20T22:20:15+08:00">2016-07-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal8的数据库操作函数跟Drupal7没什么变化，但是，在Drupal9(还没开始开发，但是代码注释中已经有)中会把一些函数移除，比如db_add, db_insert, db_query等，见 <a target="_blank" rel="noopener" href="https://api.drupal.org/api/drupal/core%21includes%21database.inc/8" title="D8 database">Drupal8 database</a>。</p>
<p>##Select</p>
<p>###Get single value:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = \Drupal::database()-&gt;select(<span class="string">&#x27;node_field_data&#x27;</span>, <span class="string">&#x27;nfd&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;addField(<span class="string">&#x27;nfd&#x27;</span>, <span class="string">&#x27;nid&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;condition(<span class="string">&#x27;nfd.title&#x27;</span>, <span class="string">&#x27;Potato&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;range(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$nid</span> = <span class="variable">$query</span>-&gt;execute()-&gt;fetchField();</span><br></pre></td></tr></table></figure>

<p>###Get single row:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = \Drupal::database()-&gt;select(<span class="string">&#x27;node_field_data&#x27;</span>, <span class="string">&#x27;nfd&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;fields(<span class="string">&#x27;nfd&#x27;</span>, [<span class="string">&#x27;nid&#x27;</span>, <span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line"><span class="variable">$query</span>-&gt;condition(<span class="string">&#x27;nfd.type&#x27;</span>, <span class="string">&#x27;vegetable&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;range(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$vegetable</span> = <span class="variable">$query</span>-&gt;execute()-&gt;fetchAssoc();</span><br></pre></td></tr></table></figure>

<p>###Using db like:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = \Drupal::database()-&gt;select(<span class="string">&#x27;node_field_data&#x27;</span>, <span class="string">&#x27;nfd&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;fields(<span class="string">&#x27;nfd&#x27;</span>, [<span class="string">&#x27;nid&#x27;</span>, <span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line"><span class="variable">$query</span>-&gt;condition(<span class="string">&#x27;nfd.type&#x27;</span>, <span class="string">&#x27;vegetable&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;condition(<span class="string">&#x27;nfd.title&#x27;</span>, <span class="variable">$query</span>-&gt;escapeLike(<span class="string">&#x27;ca&#x27;</span>) . <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;LIKE&#x27;</span>);</span><br><span class="line"><span class="variable">$vegetable</span> = <span class="variable">$query</span>-&gt;execute()-&gt;fetchAllKeyed();</span><br></pre></td></tr></table></figure>

<p>###Get several rows with JOIN:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = \Drupal::database()-&gt;select(<span class="string">&#x27;node_field_data&#x27;</span>, <span class="string">&#x27;nfd&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;fields(<span class="string">&#x27;nfd&#x27;</span>, [<span class="string">&#x27;nid&#x27;</span>, <span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line"><span class="variable">$query</span>-&gt;addField(<span class="string">&#x27;ufd&#x27;</span>, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;join(<span class="string">&#x27;users_field_data&#x27;</span>, <span class="string">&#x27;ufd&#x27;</span>, <span class="string">&#x27;ufd.uid = nfd.uid&#x27;</span>);</span><br><span class="line"><span class="variable">$query</span>-&gt;condition(<span class="string">&#x27;nfd.type&#x27;</span>, <span class="string">&#x27;vegetable&#x27;</span>);</span><br><span class="line"><span class="variable">$vegetable</span> = <span class="variable">$query</span>-&gt;execute()-&gt;fetchAllAssoc(<span class="string">&#x27;nid&#x27;</span>);</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/07/20/Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/06/29/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/06/29/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" class="post-title-link" itemprop="url">MySQL数据库设计规范</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-06-29 15:51:09" itemprop="dateCreated datePublished" datetime="2016-06-29T15:51:09+08:00">2016-06-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-18 14:44:56" itemprop="dateModified" datetime="2017-02-18T14:44:56+08:00">2017-02-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#一、命名规范</p>
<p>###[数据库环境介绍]</p>
<p>通常来讲，各个互联网公司的数据库分为5个数据库环境：</p>
<ol>
<li>dev : 开发环境, 开发可读写,可修改表结构; 常用的163的数据库表; 开发人员可以修改表结构, 可以随意修改其中的数据; 但是需要保证不影响其他开发同事; </li>
<li>qa : 测试环境, 开发可读写, 开发人员可以通过工具修改表结构; </li>
<li>sim: 模拟环境, 开发可读写, 通过web平台;发起上线请求时，会先在这个环境上进行预执行， 这个环境也可供部署上线演练或压力测试使用 可以读写;</li>
<li>real: 生产数据库从库（准实时同步）,只读环境,不允许修改数据,不允许修改表结构; 供线上问题查找,数据查询等使用;</li>
<li>online: 线上环境;开发人员不允许直接在线上环境进行数据库操作,如果需要操作必须找DBA进行操作并进行相应记录;</li>
</ol>
<p>这些环境的机器，一定要做到权限划分明确，读写帐号分离，并且有辨识度，能区分具体业务。例如用户名w_wap, r_wap 能看出来，读写帐号是wap应用的。</p>
<p>###[数据库命名规范]</p>
<ol>
<li>尽量简洁明义，能够一眼看出来这个数据库是用来做什么的；</li>
<li>使用名词作为数据库名称，并且只用英文，不用中文拼音；</li>
<li>使用英文字母，全部小写，控制在3-7个字母以内；</li>
<li>如果有多个单词，则使用下划线隔开，不建义驼峰命名；<br>例如，每个公司都有crm业务，那就叫做xx_crm, 字符集统一utf8。字符集踩过的坑很多，为了通用性统一utf8。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database xx_crm default character <span class="built_in">set</span>=utf8;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>###[表命名规范]</p>
<ol>
<li>具备统一前缀，对相关功能的表应当使用相同前缀，如acl_xxx，house_xxx,ppc_xxx；其中前缀通常为这个表的模块或依赖主实体对象的名字，通常来讲表名为：业务_动作_类型，或是业务_类型；</li>
<li>表名使用英文小写单词，如果有多个单词则使用下划线隔开；</li>
<li>表名简介，使用常见单词，避免使用长单词和生僻词；</li>
<li>表引擎取决于实际应用场景及当前数据库中的已经存在的存储引擎；日志及报表类表建议用myisam，与交易，审核，金额相关的表建议用innodb引擎。总体来讲数据库默认innodb；</li>
<li>数据表必须有主键，且建议均使用auto_increment的id作为主键（与业务无关）,和业务相关的要做为唯一索引；</li>
<li>默认使用utf8字符集（由于数据库定义使用了默认，数据表可以不再定义，但为保险起见，建议都写上）；</li>
<li>所有的表都必须有备注，写明白这个表中存放的数据内容；</li>
<li>预估表数据量，如果数据量较大（超过500w）则需要考虑分表策略。可以等量均衡分表或根据业务规则分表均可。要分表的数据表必须与DBA商量分表策略；</li>
<li>职责相近的表，命名规则应该相同；如合同申请，账户信息，交友相关等；<br>举个例子，一张在线冲值记录表：user_bank_deposit 这个就非常符合标准，如果叫做userBankDeposit或是user_chongzhi，就非常不友好。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `house_refresh_log` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT <span class="string">&#x27;自增ID&#x27;</span>,</span><br><span class="line">  `fangid` int(11) NOT NULL COMMENT <span class="string">&#x27;房贴子ID&#x27;</span>,</span><br><span class="line">  `refresh_time` int(11) NOT NULL COMMENT <span class="string">&#x27;刷新时间&#x27;</span>,</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  UNIQUE KEY `fangid` (`fangid`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT=<span class="string">&#x27;房刷新记录表&#x27;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/06/29/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/06/27/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/06/27/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/" class="post-title-link" itemprop="url">MacOS 查看网络端口情况</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-06-27 15:17:17 / Modified: 15:25:08" itemprop="dateCreated datePublished" datetime="2016-06-27T15:17:17+08:00">2016-06-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MacOS/" itemprop="url" rel="index"><span itemprop="name">MacOS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>###查看端口是否打开</p>
<p>####使用 netstat 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a. `netstat -nat | grep &lt;端口号&gt;`  , 如命令 `netstat -nat | grep 3306`</span><br><span class="line">b. `netstat -nat |grep LISTEN`</span><br></pre></td></tr></table></figure>

<p>####使用 lsof 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yongfu-pro at yongfu-pro.local in ~ [22:39:32]</span></span><br><span class="line">$ lsof -n -P -i TCP -s TCP:LISTEN</span><br><span class="line">COMMAND PID       USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME</span><br><span class="line">php-fpm 387 yongfu-pro    6u  IPv4 0x6d7f5d3c3a615679      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">Dropbox 413 yongfu-pro   26u  IPv4 0x6d7f5d3c445e2c09      0t0  TCP *:17500 (LISTEN)</span><br><span class="line">php-fpm 418 yongfu-pro    0u  IPv4 0x6d7f5d3c3a615679      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm 419 yongfu-pro    0u  IPv4 0x6d7f5d3c3a615679      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">php-fpm 420 yongfu-pro    0u  IPv4 0x6d7f5d3c3a615679      0t0  TCP 127.0.0.1:9000 (LISTEN)</span><br><span class="line">stunnel 586 yongfu-pro    9u  IPv4 0x6d7f5d3c439ff679      0t0  TCP 127.0.0.1:1997 (LISTEN)</span><br><span class="line"></span><br><span class="line">lsof命令可以列出当前的所有网络情况， 此命令的解释如下：</span><br><span class="line">-n 表示主机以ip地址显示</span><br><span class="line">-P 表示端口以数字形式显示，默认为端口名称</span><br><span class="line">-i 意义较多，具体 man lsof, 主要是用来过滤lsof的输出结果</span><br><span class="line">-s 和 -i 配合使用，用于过滤输出</span><br></pre></td></tr></table></figure>

<p>####使用telnet 命令</p>
<p>检查本机的3306端口是否打开， 如下<br>telnet 127.0.0.1 3306<br>若该端口没有打开，则会自动退出，并显示如下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Trying 127.0.0.1...</span><br><span class="line">telnet: connect to address 127.0.0.1: Connection refused</span><br><span class="line">telnet: Unable to connect to remote host</span><br></pre></td></tr></table></figure>
<p>若该端口为已打开的状态，则会一直保持连接。</p>
<p>####使用 nc 命令</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/06/27/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/06/06/Drupal8-angularJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/06/06/Drupal8-angularJS/" class="post-title-link" itemprop="url">Drupal8中使用AngularJS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-06-06 11:51:00" itemprop="dateCreated datePublished" datetime="2016-06-06T11:51:00+08:00">2016-06-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-06-07 09:27:20" itemprop="dateModified" datetime="2016-06-07T09:27:20+08:00">2016-06-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Drupal8中使用AngularJS"><a href="#Drupal8中使用AngularJS" class="headerlink" title="Drupal8中使用AngularJS"></a>Drupal8中使用AngularJS</h2><p>首先我们需要一个基础模块引入并启动<code>angular</code></p>
<p>OK，先创建一个模块，我们起名叫<code>cloud_angular</code></p>
<p>在<code>cloud_angular</code>中，我们新建目录<code>libs</code>，里面存放所有与<code>angular</code>相关的库文件，<code>js</code>目录，里面存放angular的启动js：<code>app.js</code></p>
<p>接着，定义angular的library，就像这样：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cloud_angular.angular:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="string">VERSION</span></span><br><span class="line">  <span class="attr">css:</span></span><br><span class="line">    <span class="attr">angular:</span></span><br><span class="line">      <span class="attr">libs/angular-loading-bar/build/loading-bar.css:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">js:</span></span><br><span class="line">    <span class="attr">libs/angular/angular.js:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">libs/angular-animate/angular-animate.js:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">libs/angular-ui-router/release/angular-ui-router.js:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">libs/oclazyload/dist/ocLazyLoad.js:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">libs/angular-loading-bar/build/loading-bar.js:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">js/app.js:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">dependencies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">core/drupalSettings</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">core/drupal</span></span><br></pre></td></tr></table></figure>

<p>保存为<code>cloud_angular.libraries.yml</code>文件</p>
<p>最后，打开<code>cloud_angular.module</code>，实现<code>page</code>的<code>hook</code>，引入上面定义的库，就像下面这样：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_preprocess_page().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloud_angular_preprocess_page</span>(<span class="params">&amp;<span class="variable">$variables</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$variables</span>[<span class="string">&#x27;#attached&#x27;</span>][<span class="string">&#x27;library&#x27;</span>][] = <span class="string">&#x27;cloud_angular/cloud_angular.angular&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样我们在启用<code>cloud_angular</code>模块的时候，就全局加载了<code>angular</code></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/06/06/Drupal8-angularJS/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/06/03/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/06/03/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">Drupal8功能测试</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-06-03 10:52:56 / Modified: 11:51:54" itemprop="dateCreated datePublished" datetime="2016-06-03T10:52:56+08:00">2016-06-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal8的功能测试必须要有一个正在运行的站点，并且安装了simpleTest核心模块。<br>本文的测试用例实现的功能为：<br>向user实体增加一个字段，然后检查用户里是否存在这个字段。</p>
<p>##一、PHPUnit和SimpleTest功能测试(BrowserTestBase / WebTestBase)<br>以后的功能测试都是使用phpUnit和BrowserTestBase，Drupal8中很多模块还在用WebTestBase.</p>
<p>BrowserTestBase的主要限制是不能使用JavaScript和AJAX。<br>如果需要测试它们，建议先用WebTestBase。</p>
<p>###1、定义字段</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config/install/field.field.user.user.test_status.yml</span><br></pre></td></tr></table></figure>

<p>编辑文件内容为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">langcode: en</span><br><span class="line">status: <span class="literal">true</span></span><br><span class="line">dependencies:</span><br><span class="line">  config:</span><br><span class="line">    - field.storage.user.test_status</span><br><span class="line">id: user.user.test_status</span><br><span class="line">field_name: test_status</span><br><span class="line">entity_type: user</span><br><span class="line">bundle: user</span><br><span class="line">label: test_status</span><br><span class="line">description: <span class="string">&#x27;&#x27;</span></span><br><span class="line">required: <span class="literal">false</span></span><br><span class="line">translatable: <span class="literal">false</span></span><br><span class="line">default_value:</span><br><span class="line">  -</span><br><span class="line">    value: <span class="number">0</span></span><br><span class="line">default_value_callback: <span class="string">&#x27;&#x27;</span></span><br><span class="line">settings:</span><br><span class="line">  on_label: <span class="string">&#x27;On&#x27;</span></span><br><span class="line">  off_label: <span class="string">&#x27;Off&#x27;</span></span><br><span class="line">field_type: <span class="keyword">boolean</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config/install/field.storage.user.test_status.yml</span><br></pre></td></tr></table></figure>
<p>编辑内容为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">langcode: en</span><br><span class="line">status: <span class="literal">true</span></span><br><span class="line">dependencies:</span><br><span class="line">  module:</span><br><span class="line">    - user</span><br><span class="line">id: user.test_status</span><br><span class="line">field_name: test_status</span><br><span class="line">entity_type: user</span><br><span class="line">type: <span class="keyword">boolean</span></span><br><span class="line">settings: &#123;  &#125;</span><br><span class="line">module: test_example</span><br><span class="line">locked: <span class="literal">false</span></span><br><span class="line">cardinality: <span class="number">1</span></span><br><span class="line">translatable: <span class="literal">true</span></span><br><span class="line">indexes: &#123;  &#125;</span><br><span class="line">persist_with_no_fields: <span class="literal">false</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/06/03/Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/06/02/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/06/02/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">Drupal8单元测试</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-06-02 16:01:57" itemprop="dateCreated datePublished" datetime="2016-06-02T16:01:57+08:00">2016-06-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-06-03 10:53:02" itemprop="dateModified" datetime="2016-06-03T10:53:02+08:00">2016-06-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>单元测试在编程中是非常重要的，而我更倾向于去对那些有意义的错误做测试。<br>在Drupal8中，可以借助phpstorm来帮助进行单元测试。</p>
<p>##一、phpstorm配置</p>
<p>###1）、针对项目进行设置：</p>
<blockquote>
<p>1、选中 PhpStorm &gt; Preferences &gt; Languages &amp; Frameworks &gt; PHP &gt; PHPUnit &gt; Local<br>Window 操作系统是：File &gt; Settings …<br>2、选择 PHPUnit Library &gt; Use custom autoloader<br>3、导航到 /vendor/autoload.php<br>4、选择 Test Runner &gt; Default configuration file<br>5、导航到 /core/phpunit.xml.dist<br>6、点击 Save</p>
</blockquote>
<p>在右上方看到 For current project。接下来完成下面的步骤：</p>
<blockquote>
<p>1、运行： Run &gt; Edit Configurations<br>2、点击 + 图标，选择 PHPUnit<br>3、提供一个名称，例如 Drupal 8: All Tests<br>4、在配置文件内选择 Test Runner &gt; Defined<br>5、保存</p>
</blockquote>
<p>在右上角，选择你的运行配置，按下绿色箭头。也可以操作 Run &gt; Run Drupal 8: All Tests 。</p>
<p>说明：</p>
<blockquote>
<p>如果提示“Interpreter is not specified or invalid”，<br>要去 PhpStorm &gt; Preferences &gt; Languages &amp; Frameworks &gt; PHP 设置下 PHP 解释器。</p>
</blockquote>
<p>当你运行测试时，你会在 PhpStorm 内看到一个新窗口，列出了测试结果。默认情况，通过的测试不会显示出来。你可以操作窗口左上角的 Hide passed 图标显示通过的测试。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/06/02/Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/05/24/Drupal-code-review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/05/24/Drupal-code-review/" class="post-title-link" itemprop="url">Drupal code review</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-05-24 11:34:10 / Modified: 14:17:01" itemprop="dateCreated datePublished" datetime="2016-05-24T11:34:10+08:00">2016-05-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如何你的模块已经在线上，比如github或者Drupal的git仓库，可以使用在线的<a target="_blank" rel="noopener" href="http://pareview.sh/">pareview.sh</a>工具。</p>
<p>###1、安装composer</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -sS https://getcomposer.org/installer | php</span><br><span class="line">$ mv composer.phar /usr/<span class="built_in">local</span>/bin/composer</span><br></pre></td></tr></table></figure>

<p>###2、安装Coder (reference: <a target="_blank" rel="noopener" href="https://www.drupal.org/node/1419988#coder-composer">https://www.drupal.org/node/1419988#coder-composer</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ composer global require drupal/coder</span><br><span class="line">$ sudo ln -s ~/.composer/vendor/bin/phpcs /usr/<span class="built_in">local</span>/bin</span><br><span class="line">$ sudo ln -s ~/.composer/vendor/bin/phpcbf /usr/<span class="built_in">local</span>/bin</span><br><span class="line">$ phpcs --config-set installed_paths ~/.composer/vendor/drupal/coder/coder_sniffer</span><br></pre></td></tr></table></figure>

<p>###3、安装codespell (reference: <a target="_blank" rel="noopener" href="https://github.com/lucasdemarchi/codespell">https://github.com/lucasdemarchi/codespell</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get help2man -y</span><br><span class="line">$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/lucasdemarchi/codespell.git</span><br><span class="line">$ <span class="built_in">cd</span> codespell &amp;&amp; sudo make install</span><br><span class="line">$ sudo cp codespell /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure>

<p>注：MAC下安装codespell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure>

<p>###4、安装DrupalSecure (reference: <a target="_blank" rel="noopener" href="https://www.drupal.org/sandbox/coltrane/1921926">https://www.drupal.org/sandbox/coltrane/1921926</a>)</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/05/24/Drupal-code-review/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/05/24/Drupal8-css-guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/05/24/Drupal8-css-guide/" class="post-title-link" itemprop="url">drupal8-css-guide</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-05-24 10:14:35" itemprop="dateCreated datePublished" datetime="2016-05-24T10:14:35+08:00">2016-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-05-25 11:39:04" itemprop="dateModified" datetime="2016-05-25T11:39:04+08:00">2016-05-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CSS格式"><a href="#CSS格式" class="headerlink" title="CSS格式"></a>CSS格式</h1><h2 id="空白"><a href="#空白" class="headerlink" title="空白"></a>空白</h2><blockquote>
<p>缩进</p>
</blockquote>
<p>不要使用tab键进行缩进，采用2个空格进行缩进。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> print &#123;</span><br><span class="line">  <span class="comment">/* This line is indented with 2 spaces, 2 spaces x 1 level of indentation. */</span></span><br><span class="line">  <span class="selector-class">.example</span> &#123;</span><br><span class="line">    <span class="comment">/* This line is indented with 4 spaces, 2 spaces x 2 levels of indentation. */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>空白行</p>
</blockquote>
<ul>
<li>通常，规则块之间不需要空白行作为分隔</li>
<li>如果规则块之前有单行或者块级注释，那么需要在注释之前空白行</li>
<li>如果两个规则块之间没有空白行，那么必然具有逻辑关系。如果没有的话，需要添加空白行。</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* A comment describing the ruleset. */</span></span><br><span class="line"><span class="selector-class">.selector-1</span>,</span><br><span class="line"><span class="selector-class">.selector-2</span>,</span><br><span class="line"><span class="selector-class">.selector-3</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">     -moz-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">          <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: Times, <span class="string">&quot;Times New Roman&quot;</span>, sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">#fff</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A longer comment describing this ruleset. Note</span></span><br><span class="line"><span class="comment"> * the blank line before the docblock.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.selector-4</span>,</span><br><span class="line"><span class="selector-class">.selector-5</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: lime;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* This logical grouping of rulesets has no interleaving blank lines. */</span></span><br><span class="line"><span class="selector-class">.profile</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">16px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1rem</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.profile__picture</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right; <span class="comment">/* LTR */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>行尾</p>
</blockquote>
<p>行尾绝不能有任何空白(空白或者tab)。所有的文件应该以单个空白行结尾。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/05/24/Drupal8-css-guide/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/05/21/PHP-Trait%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E7%9A%84%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/05/21/PHP-Trait%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E7%9A%84%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">PHP Trait多重继承的实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-05-21 14:13:20 / Modified: 14:19:01" itemprop="dateCreated datePublished" datetime="2016-05-21T14:13:20+08:00">2016-05-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>官方地址：<br><a target="_blank" rel="noopener" href="http://php.net/manual/en/language.oop5.traits.php">http://php.net/manual/en/language.oop5.traits.php</a></p>
<p>自 PHP 5.4.0 起，PHP 实现了代码复用的一个方法，称为 traits。</p>
<p>Traits 是一种为类似 PHP 的单继承语言而准备的代码复用机制。Trait 为了减少单继承语言的限制，使开发人员能够自由地在不同层次结构内独立的类中复用方法集。Traits 和类组合的语义是定义了一种方式来减少复杂性，避免传统多继承和混入类（Mixin）相关的典型问题。</p>
<p>Trait 和一个类相似，但仅仅旨在用细粒度和一致的方式来组合功能。Trait 不能通过它自身来实例化。它为传统继承增加了水平特性的组合；也就是说，应用类的成员不需要继承。</p>
<p>在我理解说白了就是在继承类链中隔离了子类继承父类的某些特性（就是子类“要用父类的特性的时候”，如果trait有，就优先调用trait的方法、属性等）。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">MyTrait</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var</span> = <span class="string">&quot;MyTrait_var&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var1</span> = <span class="string">&quot;MyTrait_var&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;var.PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;a&quot;</span>.PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">MyInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAbstract</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var2</span> = <span class="string">&quot;MyAbstract_var&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">use</span> <span class="title">MyTrait</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;b&quot;</span>.PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">MyAbstract</span> <span class="keyword">implements</span> <span class="title">MyInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var3</span> = <span class="string">&quot;MyClass_var&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//也可以在这里引用，不区分继承关系</span></span><br><span class="line">    <span class="comment">//use MyTrait;</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;c&quot;</span>.PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> MyClass();</span><br><span class="line"><span class="variable">$class</span>-&gt;a();</span><br><span class="line"><span class="variable">$class</span>-&gt;b();</span><br><span class="line"><span class="variable">$class</span>-&gt;c();</span><br></pre></td></tr></table></figure>

<p>输出结果<br>MyTrait_var<br>a<br>b<br>c</p>
<p>总结：</p>
<p>从本质上说，trait和include文件的概念差不多<br>trait可以更加方便的实现代码复用，因为我们用继承关系实现的无法在父类中访问子类的private属性与方法，而trait就和把代码直接写在对象里效果一样。<br>使用trait时候应该坚决避免命名冲突，尤其是同时使用多个trait时。<br>如果产生了命名冲突，如果两者的可见性、初始值、static与否完全相同，则trait中的会覆盖掉对象中的，并抛出E_STRICT错误，否则会抛出E_COMPILE_ERROR错误，终止编译。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/05/21/PHP-Trait%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E7%9A%84%E5%AE%9E%E7%8E%B0/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/04/25/MySQL-5-7-x-%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/04/25/MySQL-5-7-x-%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">mysql-5.7.x安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-04-25 13:23:29 / Modified: 14:47:49" itemprop="dateCreated datePublished" datetime="2016-04-25T13:23:29+08:00">2016-04-25</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>###1、添加yum源</p>
<h4 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On RHEL/CentOS 7 ---------------</span><br><span class="line"><span class="comment"># wget http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On RHEL/CentOS 6 ---------------</span><br><span class="line"><span class="comment"># wget http://dev.mysql.com/get/mysql57-community-release-el6-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On RHEL/CentOS 5 ---------------</span><br><span class="line"><span class="comment"># wget http://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On Fedora 23 ---------------</span><br><span class="line"><span class="comment"># wget http://dev.mysql.com/get/mysql57-community-release-fc23-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On Fedora 22 ---------------</span><br><span class="line"><span class="comment"># wget http://dev.mysql.com/get/mysql57-community-release-fc22-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On Fedora 21 ---------------</span><br><span class="line"><span class="comment"># wget http://dev.mysql.com/get/mysql57-community-release-fc21-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>

<p>####安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--------------- On RHEL/CentOS 7 ---------------</span><br><span class="line"><span class="comment"># yum localinstall mysql57-community-release-el7-7.noarch.rpm</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/04/25/MySQL-5-7-x-%E5%AE%89%E8%A3%85/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/02/26/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/02/26/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" class="post-title-link" itemprop="url">Haproxy web负载均衡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-02-26 10:02:54 / Modified: 10:20:30" itemprop="dateCreated datePublished" datetime="2016-02-26T10:02:54+08:00">2016-02-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install haproxy</span><br></pre></td></tr></table></figure>

<p>修改日志</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/rsyslog.conf</span><br></pre></td></tr></table></figure>

<p>这一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#*.info;mail.none;authpriv.none;cron.none                /var/log/messages</span></span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*.info;mail.none;authpriv.none;cron.none;local2.none                /var/<span class="built_in">log</span>/messages</span><br></pre></td></tr></table></figure>

<p>再增加一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># haproxy</span></span><br><span class="line">local2.*                                                /var/<span class="built_in">log</span>/haproxy.log</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/02/26/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/01/29/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/01/29/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/" class="post-title-link" itemprop="url">tpcc测试mysql性能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-01-29 17:05:25 / Modified: 17:14:59" itemprop="dateCreated datePublished" datetime="2016-01-29T17:05:25+08:00">2016-01-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>TPC-C是专门针对联机交易处理系统（OLTP系统）的规范，一般情况下我们也把这类系统称为业务处理系统。<br>tpcc-mysql是percona基于TPC-C(下面简写成TPCC)衍生出来的产品，专用于MySQL基准测试。其源码放在launchpad上，用bazaar管理，项目地址：<a target="_blank" rel="noopener" href="https://code.launchpad.net/~percona-dev/perconatools/tpcc-mysql%E3%80%82">https://code.launchpad.net/~percona-dev/perconatools/tpcc-mysql。</a></p>
<p>也可以用叶金荣的版本，<a target="_blank" rel="noopener" href="https://github.com/yejr/tpcc-mysql-autoinc-pk%E3%80%82">https://github.com/yejr/tpcc-mysql-autoinc-pk。</a></p>
<p>tpcc-mysql的业务逻辑及其相关的几个表作用如下：</p>
<p>New-Order：新订单，一次完整的订单事务，几乎涉及到全部表<br>Payment：支付，主要对应 orders、history 表<br>Order-Status：订单状态，主要对应 orders、order_line 表<br>Delivery：发货，主要对应 order_line 表<br>Stock-Level：库存，主要对应 stock 表</p>
<p>其他相关表：<br>客户：主要对应 customer 表<br>地区：主要对应 district 表<br>商品：主要对应 item 表<br>仓库：主要对应 warehouse 表</p>
<p>###一、编译安装<br>编译非常简单，只需要一个 make 即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp/tpcc-mysql/src</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p>如果 make 没有报错，就会在 /tmp/tpcc-mysql 下生成 tpcc 二进制命令行工具 tpcc_load、 tpcc_start</p>
<p>###二、TPCC测试前准备<br>初始化测试库环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp/tpcc-mysql</span><br><span class="line">mysqladmin create tpcc</span><br><span class="line">mysql -uroot -proot tpcc &lt; create_table.sql</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/01/29/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2016/01/29/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/01/29/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/" class="post-title-link" itemprop="url">sysbench测试mysql性能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2016-01-29 16:15:54 / Modified: 17:17:17" itemprop="dateCreated datePublished" datetime="2016-01-29T16:15:54+08:00">2016-01-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>sysbench是一个模块化的、跨平台、多线程基准测试工具，主要用于评估测试各种不同系统参数下的数据库负载情况。关于这个项目的详细介绍请看：<a target="_blank" rel="noopener" href="https://launchpad.net/sysbench%E3%80%82">https://launchpad.net/sysbench。</a><br>它主要包括以下几种方式的测试：<br>1、cpu性能<br>2、磁盘io性能<br>3、调度程序性能<br>4、内存分配及传输速度<br>5、POSIX线程性能<br>6、数据库性能(OLTP基准测试)<br>目前sysbench主要支持 MySQL,pgsql,oracle 这3种数据库。</p>
<p>###一、安装</p>
<p>环境：</p>
<p>centos 6.7<br>mysql  5.7.10</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install automake gcc gcc-c++ libtool mysql-devel</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/akopytov/sysbench.git</span><br><span class="line"></span><br><span class="line">./autogen.sh</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<p>如果想要让 sysbench 支持 pgsql/oracle 的话，就需要在编译的时候加上参数<br>–with-pgsql<br>或者<br>–with-oracle<br>这2个参数默认是关闭的，只有 MySQL 是默认支持的。</p>
<p>###二、测试</p>
<p>#####1、cpu性能测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysbench --<span class="built_in">test</span>=cpu --cpu-max-prime=20000 run</span><br></pre></td></tr></table></figure>

<p>cpu测试主要是进行素数的加法运算，在上面的例子中，指定了最大的素数为 20000，自己可以根据机器cpu的性能来适当调整数值。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/01/29/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/26/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/26/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/" class="post-title-link" itemprop="url">Drupal8相对Drupal7的变化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-26 10:49:45" itemprop="dateCreated datePublished" datetime="2015-12-26T10:49:45+08:00">2015-12-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-01-18 10:11:31" itemprop="dateModified" datetime="2016-01-18T10:11:31+08:00">2016-01-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h3><p>Drupal 8已经正式发布，与Drupal 7相比，Drupal 8在实现机制上发生了根本性的改变。最本质的改变，应该就是从主要以面向过程的编码方式转为了主要以面向对象的编码方式。虽然Drupal 8仍然保留了部分面向过程的文件，比如.module文件，但是可以预见，在Drupal 9中，这些面向过程的代码将被全部移除，所以在使用Drupal 8做开发的时候，应该尽量避免引用面向过程的代码，以免从Drupal 8升级到Drupal 9的过程中增加不必要的麻烦。</p>
<p>本文将从模块开发的角度（而非其他角度，比如网站编辑、性能优劣等）讨论Drupal 8 与Drupal 7的不同之处，通过对Drupal 8的研究，我将Drupal 8模块开发与Drupal 7的不同点概括为以下几点：</p>
<ol>
<li>目录结构；</li>
<li>配置文件；</li>
<li>路由方式；</li>
<li>主题；</li>
<li>表单；</li>
<li>钩子机制在Drupal 8中的变化及实现；</li>
<li>Drupal 8中的新增机制。</li>
</ol>
<p>下面将详细论述这些不同点。</p>
<h3 id="2、目录结构"><a href="#2、目录结构" class="headerlink" title="2、目录结构"></a>2、目录结构</h3><p>Drupal 7的目录结构为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">|-includes</span><br><span class="line">|-misc</span><br><span class="line">|-modules</span><br><span class="line">|-scripts</span><br><span class="line">|-sites</span><br><span class="line">|  |-all</span><br><span class="line">|  |  |-modules</span><br><span class="line">|  |  |-themes</span><br><span class="line">|  |-default</span><br><span class="line">|-themes</span><br></pre></td></tr></table></figure>

<p>Drupal 8的目录结构为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">|-core</span><br><span class="line">|  |-assets</span><br><span class="line">|  |-config</span><br><span class="line">|  |-includes</span><br><span class="line">|  |-lib</span><br><span class="line">|  |-misc</span><br><span class="line">|  |-modules</span><br><span class="line">|  |-profiles</span><br><span class="line">|  |-scripts</span><br><span class="line">|  |-themes</span><br><span class="line">|-modules</span><br><span class="line">|-sites</span><br><span class="line">|  |-default</span><br><span class="line">|-themes</span><br><span class="line">|-vendor</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/26/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/23/Drupal8-Cron-Queue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/23/Drupal8-Cron-Queue/" class="post-title-link" itemprop="url">Drupal8 Cron Queue</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-23 17:26:43" itemprop="dateCreated datePublished" datetime="2015-12-23T17:26:43+08:00">2015-12-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-25 16:57:10" itemprop="dateModified" datetime="2015-12-25T16:57:10+08:00">2015-12-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal中的Queue(队列)用于处理比较耗时的任务，一般是通过系统的Cron来触发。</p>
<p>本文github：<a target="_blank" rel="noopener" href="https://github.com/RamboLau/drupal8-demos/tree/master/queue_example">https://github.com/RamboLau/drupal8-demos/tree/master/queue_example</a></p>
<p>###一、Drupal7 Queue</p>
<p>Drupal7一般是通过hook_cron_queue_info()这个钩子来实现，如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_cron().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">queue_example_cron</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$queue</span> = DrupalQueue::get(<span class="string">&#x27;example_queue&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">foreach</span>(example_data() <span class="keyword">as</span> <span class="variable">$item</span>) &#123;</span><br><span class="line">    <span class="variable">$queue</span>-&gt;createItem(<span class="variable">$item</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_cron_queue_info().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">queue_example_cron_queue_info</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$queues</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">  <span class="variable">$queues</span>[<span class="string">&#x27;example_queue&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;worker callback&#x27;</span> =&gt; <span class="string">&#x27;example_queue_worker&#x27;</span>, <span class="comment">// queue调用的函数</span></span><br><span class="line">    <span class="string">&#x27;time&#x27;</span> =&gt; <span class="number">60</span>, <span class="comment">//每次运行时，可供消耗的最长时间，单位是秒</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$queues</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>###二、Drupal8 Queue</p>
<p>Drupal8的Queue(队列)是通过QueueWorker这个插件来实现的。</p>
<p>####1、src/Plugin/QueueWorker/ExampleQueue.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@file</span></span></span><br><span class="line"><span class="comment"> * Contains Drupal\queue_example\Plugin\QueueWorker\ExampleQueue</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Drupal</span>\<span class="title">queue_example</span>\<span class="title">Plugin</span>\<span class="title">QueueWorker</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Queue</span>\<span class="title">QueueWorkerBase</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@QueueWorker</span>(</span></span><br><span class="line"><span class="comment"> *   id = &quot;example_queue&quot;,</span></span><br><span class="line"><span class="comment"> *   title = <span class="doctag">@Translation</span>(&quot;example queue&quot;),</span></span><br><span class="line"><span class="comment"> *   cron = &#123;&quot;time&quot; = 10&#125;</span></span><br><span class="line"><span class="comment"> * )</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleQueue</span> <span class="keyword">extends</span> <span class="title">QueueWorkerBase</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * &#123;<span class="doctag">@inheritdoc</span>&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">processItem</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Process data here.</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="built_in">Exception</span>(<span class="string">&#x27;Process data &#x27;</span> . json_encode(<span class="variable">$data</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>####2、queue_example.module</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/23/Drupal8-Cron-Queue/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/23/Drupal8-routing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/23/Drupal8-routing/" class="post-title-link" itemprop="url">Drupal8 Routing</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-23 16:01:09" itemprop="dateCreated datePublished" datetime="2015-12-23T16:01:09+08:00">2015-12-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-24 15:44:45" itemprop="dateModified" datetime="2015-12-24T15:44:45+08:00">2015-12-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal8的路由控制系统跟Drupal7完全不同，在drupal7中，路由一般是定义在module文件的hook_menu中，如链接、访问控制、回调方法等。而drupal8由于包含了Symfony2的路由组件（Symfony2 Routing component），一般定义在{module_name}.routing.yml中。</p>
<p>本文介绍如何创建一个路由控制器，并如何使用依赖注入(DI)。</p>
<p>下面这张图非常明了的说明了他们之间的关系。</p>
<p><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151223/20151223201522_69597.png" alt="D8-routing"></p>
<p>本文github： <a target="_blank" rel="noopener" href="https://github.com/RamboLau/drupal8-demos/tree/master/routing_example">https://github.com/RamboLau/drupal8-demos/tree/master/routing_example</a></p>
<p>###一、静态路由(Static Routes)</p>
<p>####1、Drupal7路由</p>
<p>在Drupal7中，通过hook_menu来管理路由，但是这就导致代码的耦合性太高，如果要提供丰富的返回格式，如JSON, XML or HTML，就无能为力了！</p>
<p>如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_menu()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">routing_example_menu</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$items</span>[<span class="string">&#x27;hello&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;title&#x27;</span> =&gt; <span class="string">&#x27;Hello World&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;description&#x27;</span> =&gt; <span class="string">&quot;hello world page&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;route_name&#x27;</span> =&gt; <span class="string">&#x27;helloWorldPage&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;type&#x27;</span> =&gt; MENU_LOCAL_TASK,</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$items</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_permission().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">routing_example_permission</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;access hello world&#x27;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&#x27;title&#x27;</span> =&gt; t(<span class="string">&#x27;Access hello world page&#x27;</span>),</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/23/Drupal8-routing/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/23/Drupal8-Controller/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/23/Drupal8-Controller/" class="post-title-link" itemprop="url">Drupal8 Controller</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-12-23 10:42:39 / Modified: 17:36:59" itemprop="dateCreated datePublished" datetime="2015-12-23T10:42:39+08:00">2015-12-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>学习了这么多的章节了，对Drupal8应该不陌生了吧！</p>
<p>Controller类主要用于处理相关的HTTP请求逻辑，一般在routing.yml中会指定调用哪个Controller，通常情况下，在：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;module_name&#125;/src/Controller/ExampleController.php</span><br></pre></td></tr></table></figure>

<p>本文github： <a target="_blank" rel="noopener" href="https://github.com/RamboLau/drupal8-demos/tree/master/controller_example">https://github.com/RamboLau/drupal8-demos/tree/master/controller_example</a></p>
<p>###一、创建模块</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir controller_example</span><br><span class="line"></span><br><span class="line">touch controller_example.info.yml</span><br></pre></td></tr></table></figure>

<p>编辑内容为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name: controller_example</span><br><span class="line"><span class="built_in">type</span>: module</span><br><span class="line">description: Provides controller example.</span><br><span class="line">core: 8.x</span><br><span class="line">package: Other</span><br></pre></td></tr></table></figure>

<p>###二、controller_example.routing.yml</p>
<p>编辑内容为：</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/23/Drupal8-Controller/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/22/Drupal8-Content-Entity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/22/Drupal8-Content-Entity/" class="post-title-link" itemprop="url">Drupal8 Content Entity</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-22 17:43:49" itemprop="dateCreated datePublished" datetime="2015-12-22T17:43:49+08:00">2015-12-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-28 20:37:15" itemprop="dateModified" datetime="2017-02-28T20:37:15+08:00">2017-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这篇文章是<a target="_blank" rel="noopener" href="http://verynull.com/2015/12/21/Drupal8-configuration-Entity/">Drupal8-configuration-Entity</a>的姊妹篇。主要介绍如何创建内容实体，并在界面上管理。</p>
<p>content entity最大的优势在于可自定义字段。</p>
<p>本文github：<a target="_blank" rel="noopener" href="https://github.com/RamboLau/drupal8-demos/tree/master/content_entity_example">https://github.com/RamboLau/drupal8-demos/tree/master/content_entity_example</a></p>
<p>###一、创建模块</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir content_entity_example</span><br><span class="line"></span><br><span class="line">touch content_entity_example.info.yml</span><br></pre></td></tr></table></figure>

<p>编辑内容为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name: content_entity_example</span><br><span class="line"><span class="built_in">type</span>: module</span><br><span class="line">description: Provides ContentEntityExampleOnlineMessage entity.</span><br><span class="line">core: 8.x</span><br><span class="line">package: Other</span><br></pre></td></tr></table></figure>

<p>###二、content_entity_example.routing.yml</p>
<p>编辑内容为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># OnlineMessage routing definition</span></span><br><span class="line">entity.online_message.canonical:</span><br><span class="line">  path: <span class="string">&#x27;/admin/structure/online_message/&#123;online_message&#125;&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">    _entity_view: <span class="string">&#x27;online_message&#x27;</span></span><br><span class="line">    _title: <span class="string">&#x27;Online message&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _entity_access: <span class="string">&#x27;online_message.view&#x27;</span></span><br><span class="line">  options:</span><br><span class="line">    _admin_route: TRUE</span><br><span class="line"></span><br><span class="line">entity.online_message.collection:</span><br><span class="line">  path: <span class="string">&#x27;/admin/structure/online_message&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">    _entity_list: <span class="string">&#x27;online_message&#x27;</span></span><br><span class="line">    _title: <span class="string">&#x27;Online message list&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _permission: <span class="string">&#x27;view online message entities&#x27;</span></span><br><span class="line">  options:</span><br><span class="line">    _admin_route: TRUE</span><br><span class="line"></span><br><span class="line">entity.online_message.add_form:</span><br><span class="line">  path: <span class="string">&#x27;/admin/structure/online_message/add&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">    _entity_form: online_message.add</span><br><span class="line">    _title: <span class="string">&#x27;Add Online message&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _permission: <span class="string">&#x27;add online message entities&#x27;</span></span><br><span class="line">  options:</span><br><span class="line">    _admin_route: TRUE</span><br><span class="line"></span><br><span class="line">entity.online_message.edit_form:</span><br><span class="line">  path: <span class="string">&#x27;/admin/structure/online_message/&#123;online_message&#125;/edit&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">    _entity_form: online_message.edit</span><br><span class="line">    _title: <span class="string">&#x27;Edit Online message&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _permission: <span class="string">&#x27;edit online message entities&#x27;</span></span><br><span class="line">  options:</span><br><span class="line">    _admin_route: TRUE</span><br><span class="line"></span><br><span class="line">entity.online_message.delete_form:</span><br><span class="line">  path: <span class="string">&#x27;/admin/structure/online_message/&#123;online_message&#125;/delete&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">    _entity_form: online_message.delete</span><br><span class="line">    _title: <span class="string">&#x27;Delete Online message&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _permission: <span class="string">&#x27;delete online message entities&#x27;</span></span><br><span class="line">  options:</span><br><span class="line">    _admin_route: TRUE</span><br><span class="line"></span><br><span class="line">online_message.settings:</span><br><span class="line">  path: <span class="string">&#x27;/admin/structure/online_message/settings&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">   _form: <span class="string">&#x27;\Drupal\content_entity_example\Form\OnlineMessageSettingsForm&#x27;</span></span><br><span class="line">   _title: <span class="string">&#x27;Online message settings&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _permission: <span class="string">&#x27;administer online message entities&#x27;</span></span><br><span class="line">  options:</span><br><span class="line">    _admin_route: TRUE</span><br><span class="line"></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/22/Drupal8-Content-Entity/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/21/Drupal8-configuration-Entity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/21/Drupal8-configuration-Entity/" class="post-title-link" itemprop="url">Drupal8 Configuration Entity</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-21 10:39:45" itemprop="dateCreated datePublished" datetime="2015-12-21T10:39:45+08:00">2015-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-28 20:37:03" itemprop="dateModified" datetime="2017-02-28T20:37:03+08:00">2017-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Drupal8的实体由2部分组成，配置实体(configuration entities)和内容实体(content entities)。如图：<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151222/20151222113456_92999.png" alt="Entity"></p>
<p>本节源代码见 <a target="_blank" rel="noopener" href="https://github.com/RamboLau/drupal8-demos/tree/master/config_entities_example">https://github.com/RamboLau/drupal8-demos/tree/master/config_entities_example</a></p>
<p>内容实体见：<a target="_blank" rel="noopener" href="http://verynull.com/2015/12/22/drupal8-content-entity/">http://verynull.com/2015/12/22/drupal8-content-entity/</a></p>
<p>###一、配置实体接口(configuration entity interface)</p>
<p>在src目录下touch DemoInterface.php，DemoInterface继承并实现<a target="_blank" rel="noopener" href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Config%21Entity%21ConfigEntityInterface.php/interface/ConfigEntityInterface/8">ConfigEntityInterface</a>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@file</span></span></span><br><span class="line"><span class="comment"> * Contains \Drupal\demo\DemoInterface.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Drupal</span>\<span class="title">demo</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Config</span>\<span class="title">Entity</span>\<span class="title">ConfigEntityInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Provides an interface defining a demo entity type.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">DemoInterface</span> <span class="keyword">extends</span> <span class="title">ConfigEntityInterface</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Add get/set methods for your configuration properties here.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>###二、配置实体类(configuration entity class)<br>在src目录下创建Entity目录，并touch src/Entity/Demo.php，在这个文件中我们将实现DemoEntity。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@file</span></span></span><br><span class="line"><span class="comment"> * Contains \Drupal\demo\Entity\Demo.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Drupal</span>\<span class="title">demo</span>\<span class="title">Entity</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Config</span>\<span class="title">Entity</span>\<span class="title">ConfigEntityBase</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">demo</span>\<span class="title">DemoInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Defines the Demo entity.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ConfigEntityType</span>(</span></span><br><span class="line"><span class="comment"> *   id = &quot;demo&quot;,</span></span><br><span class="line"><span class="comment"> *   label = <span class="doctag">@Translation</span>(&quot;Demo&quot;),</span></span><br><span class="line"><span class="comment"> *   fieldable = FALSE,</span></span><br><span class="line"><span class="comment"> *   handlers = &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;list_builder&quot; = &quot;Drupal\demo\DemoListBuilder&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;form&quot; = &#123;</span></span><br><span class="line"><span class="comment"> *       &quot;add&quot; = &quot;Drupal\demo\Form\DemoForm&quot;,</span></span><br><span class="line"><span class="comment"> *       &quot;edit&quot; = &quot;Drupal\demo\Form\DemoForm&quot;,</span></span><br><span class="line"><span class="comment"> *       &quot;delete&quot; = &quot;Drupal\demo\Form\DemoDeleteForm&quot;</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;,</span></span><br><span class="line"><span class="comment"> *   config_prefix = &quot;demo&quot;,</span></span><br><span class="line"><span class="comment"> *   admin_permission = &quot;administer site configuration&quot;,</span></span><br><span class="line"><span class="comment"> *   entity_keys = &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;id&quot; = &quot;id&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;label&quot; = &quot;name&quot;</span></span><br><span class="line"><span class="comment"> *   &#125;,</span></span><br><span class="line"><span class="comment"> *   links = &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;edit-form&quot; = &quot;/admin/structure/demos/&#123;demo&#125;&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;delete-form&quot; = &quot;/admin/structure/demos/&#123;demo&#125;/delete&quot;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * )</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">ConfigEntityBase</span> <span class="keyword">implements</span> <span class="title">DemoInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * The ID of the demo.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * The demo name.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * The demo sex.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$sex</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面定义Entity的方式熟悉吧！对，就是注解annotation。</p>
<p>@ConfigEntityType告诉Drupal这是一个配置实体。参数如下：<br>1、lable：翻译系统的标签<br>2、fieldable: 附加字段，配置实体一般为FALSE，内容实体一般为TRUE<br>3、handlers：管理该实体所需要的类<br>4、list_builder：提供该实体的管理界面接口<br>5、config_prefix：配置的前缀，一般用于schema<br>6、admin_permission：管理员权限<br>7、entity_keys：主要实体属性的集合<br>8、links：编辑和删除的路径，在demo.routing.yml中定义</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/21/Drupal8-configuration-Entity/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/15/Drupal8-Service-DependencyInjection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/15/Drupal8-Service-DependencyInjection/" class="post-title-link" itemprop="url">Drupal8-Service-DependencyInjection</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-15 16:53:05" itemprop="dateCreated datePublished" datetime="2015-12-15T16:53:05+08:00">2015-12-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-25 12:15:11" itemprop="dateModified" datetime="2015-12-25T12:15:11+08:00">2015-12-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>先来认识几个名词：</p>
<p>1、Service</p>
<p>Drupal8的service帮助代码去耦合，提高重复利用。比如操作数据库，发送mail等。一般来说，service是一个PHP类，包含了一些全局的方法。</p>
<p>2、Service Container</p>
<p>Service Container用来管理service。service的类会被注册在container中，来控制访问权限。在自定义模块中，可以用module_name.services.yml来实例化services，进而保存进container对象中。</p>
<p>3、Dependency Injection</p>
<p>如果要传递对象给另一个对象，一般用Dependency Injection来去耦。简单点说，一个service只处理一件事情，如果它要调用另外一个service，那么后面的这个service可以注入到前面的service中。</p>
<p>下文我们以service表示Service，container表示Service Container，DI表示Dependency Injection。</p>
<p>###一、core services</p>
<p>Drupal8的核心servive都在<a target="_blank" rel="noopener" href="https://api.drupal.org/api/drupal/core%21core.services.yml/8">core.services.yml</a>中。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/15/Drupal8-Service-DependencyInjection/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/14/Drupal8-Javascript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/14/Drupal8-Javascript/" class="post-title-link" itemprop="url">drupal8 javascript</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-12-14 22:00:02 / Modified: 22:09:45" itemprop="dateCreated datePublished" datetime="2015-12-14T22:00:02+08:00">2015-12-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="JavaScript-编码规范建议"><a href="#JavaScript-编码规范建议" class="headerlink" title="JavaScript 编码规范建议"></a>JavaScript 编码规范建议</h2><p>本文就 JavaScript 编码过程中涉及的排版、命名、声明、作用域、及一些特殊符号的使用等方面，根据个人在学习工作中的总结，给出自己的一些建议，并分析其中缘由，以供参考。</p>
<h3 id="JavaScript-文件引用"><a href="#JavaScript-文件引用" class="headerlink" title="JavaScript 文件引用"></a>JavaScript 文件引用</h3><p>JavaScript 程序应该尽量放在 .js 的文件中，需要调用的时候在 HTML 中以<code>&lt;script src=&quot;filename.js&quot;&gt;</code>的形式包含进来。JavaScript 代码若不是该 HTML 文件所专用的，则应尽量避免在 HTML 文件中直接编写 JavaScript 代码。因为这样会大大增加 HTML 文件的大小，无益于代码的压缩和缓存的使用。<br>另外，<code>&lt;script src=&quot;filename.js&quot;&gt;</code>标签应尽量放在文件的后面。这样会降低因加载 JavaScript 代码而影响页面中其它组件的加载时间。</p>
<h3 id="代码排版"><a href="#代码排版" class="headerlink" title="代码排版"></a>代码排版</h3><h4 id="行长度"><a href="#行长度" class="headerlink" title="行长度"></a>行长度</h4><p><strong>每行代码应小于 80 个字符</strong>。如果代码较长，应尽量选择换行，下一行代码应缩进8 个空格。这样可以使代码排版整齐，减轻阅读代码的疲劳感。</p>
<h4 id="行结束"><a href="#行结束" class="headerlink" title="行结束"></a>行结束</h4><p><strong>JavaScript 语句应该以分号结束</strong>。但大多数浏览器允许不写分号，只要在本应是分号的地方有一个换行符就行。但是如果代码行较长需要换行的时候，有哪些注意事项呢？换行应选择在操作符和标点符号之后，最好是在逗号’,’之后，而不要在变量名、字符串、数字、或’)’ ‘]’ ‘++’ ‘–’等符号之后换行。<br>这样可以有效的防止拷贝、粘贴而引起的错误，并可有效地增强代码的可阅读性。</p>
<h4 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h4>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/14/Drupal8-Javascript/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/12/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/12/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/" class="post-title-link" itemprop="url">Drupal8注解(Annotations)语法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-12 10:35:46" itemprop="dateCreated datePublished" datetime="2015-12-12T10:35:46+08:00">2015-12-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:37:55" itemprop="dateModified" datetime="2015-12-23T17:37:55+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>写过java代码的同学，相信大家对注解都不陌生。有些PHP框架也是支持注解的，如Symfony2使用注解定义路由规则，Doctrine使用注解来添加ORM元数据。PHP注解RFC见<a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/annotations" title="rfc">rfc-annotations</a>。</p>
<p>Drupal8的注解依照<a target="_blank" rel="noopener" href="http://docs.doctrine-project.org/projects/doctrine-common/en/latest/reference/annotations.html">Doctrine</a>的规范。</p>
<p>本文主要对Drupal8中所用到的注解做分析，欢迎拍砖交流！</p>
<p>###一、注解的争议<br>目前对注解的争议主要有这么几点。<br>####1、如何区分注解和注释？<br>####2、为什么要把业务逻辑放在注释中？难道他们不是一个核心语言语义的一部分？<br>####3、注解和注释代码容易混淆，如果开发人员忘记定义了注解，程序并不会报错，但是可能不会像预期的工作。<br>####4、注解不好测试、调试。</p>
<p>###二、注解的优势<br>####1、不用写很多代码就可以实现注入。如：</p>
<p>我们要把weapon对象注入到soldier实例中。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Weapon</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">shoot</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;... shooting ...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Soldier</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$weapon</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setWeapon</span>(<span class="params"><span class="variable">$weapon</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;weapon = <span class="variable">$weapon</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fight</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;weapon-&gt;shoot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要实现这个功能，要这样写代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$weapon</span> = <span class="keyword">new</span> Weapon();</span><br><span class="line"></span><br><span class="line"><span class="variable">$soldier</span> = <span class="keyword">new</span> Soldier();</span><br><span class="line"><span class="variable">$soldier</span>-&gt;setWeapon(<span class="variable">$weapon</span>); </span><br><span class="line"><span class="variable">$soldier</span>-&gt;fight();</span><br></pre></td></tr></table></figure>

<p>如果我们用注解，就变得简单多了：</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/12/Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/12/11/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/11/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/" class="post-title-link" itemprop="url">Drupal8命名空间(Namespace)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-11 16:05:20" itemprop="dateCreated datePublished" datetime="2015-12-11T16:05:20+08:00">2015-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:36:40" itemprop="dateModified" datetime="2015-12-23T17:36:40+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>命名空间是php5.3引进的概念，这边文章主要介绍在Drupal中如何使用命名空间，如果你对命名空间还不熟悉，请移步到<a target="_blank" rel="noopener" href="http://php.net/manual/zh/language.namespaces.php" title="PHP:命名空间">这里</a>学习，这篇文章<a target="_blank" rel="noopener" href="http://www.sitepoint.com/php-53-namespaces-basics/" title="php53:namespace">article introducing namespaces</a>也讲的不错。</p>
<p>在Drupal中，并不是每一个文件都需要指定命名空间。Drupal8之前为了跟php5.2保持兼容，从未用过命名空间。Drupal8限定了php版本必须是5.5以上，So，让我们尽情的享受OOP的乐趣吧！</p>
<p>###用”use”导入类</p>
<blockquote>
<p>在访问系统内部或包含在命名空间中的类名称时，可以不使用完全限定名称。命名空间和use关键字的声明必须放在文件的开头，并且以反斜杠\做为分隔符。如</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Drupal</span>\<span class="title">mymodule</span>\<span class="title">Tests</span>\<span class="title">Foo</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">simpletest</span>\<span class="title">WebTestBase</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Tests that the foo bars.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BarTest</span> <span class="keyword">extends</span> <span class="title">WebTestBase</span> </span>&#123;</span><br><span class="line">	<span class="comment">// WebTestBase前不需要加\</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在访问系统内部或不包含在命名空间中的类名称时，必须使用完全限定名称。如</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> \<span class="built_in">Exception</span>();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在一个没有声明命名空间的文件里，就算它是全局命名空间，如果要使用其他非全局命名空间的类，必须使用”use”关键字，并且需要声明在文件的开头哦！</p>
</blockquote>
<blockquote>
<p>当用”use”导入类时，不要在开头加\。大PHP官方也是这么推荐的，见<a target="_blank" rel="noopener" href="http://www.php.net/manual/en/language.namespaces.importing.php">PHP documentation</a></p>
</blockquote>
<blockquote>
<p>当在字符串中指定类名时，必须使用带命名空间的全类名，并且不能以\开头。</p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/12/11/Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/28/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/28/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" class="post-title-link" itemprop="url">高性能mysql主从架构及MHA高可用负载均衡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-28 14:35:42" itemprop="dateCreated datePublished" datetime="2015-11-28T14:35:42+08:00">2015-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-02 17:20:35" itemprop="dateModified" datetime="2015-12-02T17:20:35+08:00">2015-12-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>实验系统：CentOS 6.7_x86_64（4.2.3）</p>
<p>实验前提：防火墙和selinux都关闭</p>
<p>实验说明：本实验共有3台主机，拓扑图如下所示</p>
<p><img src="http://images.cnitblog.com/i/609710/201404/192216579327066.png" alt="拓扑图"></p>
<p>主机说明：<br>manager: 172.16.2.99<br>master: 172.16.115.101<br>备用master: 172.16.115.102<br>也可以加别的slave。</p>
<p>实验软件：</p>
<p>mha4mysql-manager-0.56-0.el6.noarch.rpm</p>
<p>mha4mysql-node-0.56-0.el6.noarch.rpm</p>
<p>mysql(mysql-5.5.46-1.el6.remi.x86_64)</p>
<p>###1、安装软件<br>三台机器都需要安装mha4mysql-node, master和slave还需要安装mysql, manager可以不装mysql. 当然manager也可以用slave机器来做。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/28/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/27/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/27/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/" class="post-title-link" itemprop="url">使用gdb调试php-fpm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-11-27 16:17:10 / Modified: 16:38:15" itemprop="dateCreated datePublished" datetime="2015-11-27T16:17:10+08:00">2015-11-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有很多php开发人员经常问我，如果执行php代码的时候出现严重错误的时候，如何快速定位问题。我一般推荐他们用gdb去调试。</p>
<p>下面用php-fpm的一个段错误来举例说明，如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WARNING: [pool www] child 15109 exited on signal 11 (SIGSEGV) after 654.485221 seconds from start</span><br></pre></td></tr></table></figure>

<p>###1、安装gdb</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gdb php-dbg</span><br></pre></td></tr></table></figure>

<p>有的时候可能需要安装debuginfo相关的库，如:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debuginfo-install php-fpm</span><br></pre></td></tr></table></figure>

<p>###2、设置coredump</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;/tmp/core-%e.%p&#x27;</span> &gt; /proc/sys/kernel/core_pattern</span><br><span class="line"><span class="built_in">echo</span> 0 &gt; /proc/sys/kernel/core_uses_pid</span><br><span class="line"><span class="built_in">ulimit</span> -c unlimited</span><br></pre></td></tr></table></figure>

<p>当然,coredump的文件格式可以设置为其他的，这里是详细的设置项说明</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/27/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/21/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/21/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/" class="post-title-link" itemprop="url">centos6.6安装Percona Tokudb</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-21 20:17:57" itemprop="dateCreated datePublished" datetime="2015-11-21T20:17:57+08:00">2015-11-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-11-19 21:03:59" itemprop="dateModified" datetime="2015-11-19T21:03:59+08:00">2015-11-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在percona官网<a target="_blank" rel="noopener" href="https://www.percona.com/">https://www.percona.com/</a><br>下载带有Tokudb的二进制包，也可以选择源码编译。tokudb有单独的包.<br>我这里下载的是最新的包，5.6.25-73<br>Percona-Server-5.6.25-rel73.1-Linux.x86_64.ssl101.tar.gz<br>Percona-Server-5.6.25-rel73.1-TokuDB.Linux.x86_64.ssl101.tar.gz</p>
<p>###前期账号创建</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; groupadd mysql</span><br><span class="line">shell&gt; useradd -g mysql mysql</span><br></pre></td></tr></table></figure>

<p>###解压软件包</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; cd /usr/local</span><br><span class="line">shell&gt; tar -zxvf Percona-Server-<span class="number">5.6</span>.<span class="number">25</span>-rel73.<span class="number">1</span>-Linux.x86_64.ssl101.tar.gz</span><br><span class="line">shell&gt; tar -zxvf Percona-Server-<span class="number">5.6</span>.<span class="number">25</span>-rel73.<span class="number">1</span>-TokuDB.Linux.x86_64.ssl101.tar.gz</span><br><span class="line">shell&gt; ln -s Percona-Server-<span class="number">5.6</span>.<span class="number">25</span>-rel73.<span class="number">1</span>-Linux.x86_64.ssl101 mysql</span><br></pre></td></tr></table></figure>

<p>###设置权限</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; cd mysql</span><br><span class="line">shell&gt; chown -R mysql .</span><br><span class="line">shell&gt; chgrp -R mysql .</span><br></pre></td></tr></table></figure>

<p>###创建配置文件/etc/my.cnf<br>创建存放数据源的目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Shell&gt; mkdir -p /<span class="keyword">var</span>/lib/mysql</span><br><span class="line">Shell&gt; mkdir -p /data/mysqldata /data/mysqllog</span><br><span class="line">Shell&gt; chown -R mysql:mysql /<span class="keyword">var</span>/lib/mysql /data/mysqldata /data/mysqllog</span><br></pre></td></tr></table></figure>

<p>在附件中给出，请参考附配置文件内容</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/21/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/20/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/20/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/" class="post-title-link" itemprop="url">centos6.6安装mariadb10 Tokudb</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-20 20:17:18" itemprop="dateCreated datePublished" datetime="2015-11-20T20:17:18+08:00">2015-11-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-11-19 20:57:40" itemprop="dateModified" datetime="2015-11-19T20:57:40+08:00">2015-11-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ps: 如果想在mariadb10上使用tokudb就只能自己编译了。。。。</p>
<p>###一、环境准备：<br>tokudb的编译需要cmake 2.8.9+ 和 gcc 4.7+</p>
<p>本文选用cmake 2.8.9 和 gcc4.8.1。<br>这2个软件都只能使用源码编译安装。</p>
<p>cmake的很简单，直接下载<br>wget <a target="_blank" rel="noopener" href="http://www.cmake.org/files/v2.8/cmake-2.8.9.tar.gz">http://www.cmake.org/files/v2.8/cmake-2.8.9.tar.gz</a><br>然后解压进行编译</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make &amp; make install</span><br></pre></td></tr></table></figure>

<p>###二、安装gcc 4.8.1<br>####1、下载gcc 4.8.1源码包：<br><a target="_blank" rel="noopener" href="http://ftp.tsukuba.wide.ad.jp/software/gcc/releases/gcc-4.8.1/gcc-4.8.1.tar.bz2">http://ftp.tsukuba.wide.ad.jp/software/gcc/releases/gcc-4.8.1/gcc-4.8.1.tar.bz2</a><br>我是虚拟机里面装的Linux，我嫌wget太慢，所以自己在Windows上用迅雷下好，然后共享到Linux中。</p>
<p>####2、解压：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -jxvf gcc-4.8.1.tar.bz2</span><br></pre></td></tr></table></figure>

<p>####3、下载编译所需的依赖包：<br>这个步骤有两种方式完成：<br>a) 如果Linux有网络连接，直接这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> gcc-4.8.1</span><br><span class="line">./contrib/download_prerequisites</span><br><span class="line"><span class="built_in">cd</span> ..</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/20/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/19/Drupal8%E4%B8%BB%E9%A2%98-theme/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/19/Drupal8%E4%B8%BB%E9%A2%98-theme/" class="post-title-link" itemprop="url">Drupal8主题(theme)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-19 16:35:16" itemprop="dateCreated datePublished" datetime="2015-11-19T16:35:16+08:00">2015-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:37:32" itemprop="dateModified" datetime="2015-12-23T17:37:32+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Drupal8中的Twig"><a href="#Drupal8中的Twig" class="headerlink" title="Drupal8中的Twig"></a>Drupal8中的Twig</h2><p>Drupal8中Twig替换了PHPTemplate作为默认的模板引擎，导致的结果之一就是模版的后缀由原来的.tpl.php变成了.html.twig</p>
<h3 id="搜索Twig模版中的变量"><a href="#搜索Twig模版中的变量" class="headerlink" title="搜索Twig模版中的变量"></a>搜索Twig模版中的变量</h3><p>在使用Twig模版的时候，大部分的变量都已注释的形式写在了模版中。然后，当我们新增了变量，我们就需要一个可以搜索到当前模版所有变量的方法。Twig提供了<code>dump</code>函数。</p>
<p><code>dump</code>函数并不会打印所有的输出，除非开启了debug。</p>
<p><code>dump</code>函数用于打印单个变量的信息或者模版中的所有变量。</p>
<h4 id="单个变量"><a href="#单个变量" class="headerlink" title="单个变量"></a>单个变量</h4><p>如果你的模版中有一个title变量，下面在你的模版中dump出这个变量的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; dump(title) &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="模版中的所有变量"><a href="#模版中的所有变量" class="headerlink" title="模版中的所有变量"></a>模版中的所有变量</h4>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/19/Drupal8%E4%B8%BB%E9%A2%98-theme/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/18/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/18/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/" class="post-title-link" itemprop="url">Drupal8模板引擎-twig</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-18 16:35:16" itemprop="dateCreated datePublished" datetime="2015-11-18T16:35:16+08:00">2015-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:36:27" itemprop="dateModified" datetime="2015-12-23T17:36:27+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h2><p>Twig是一个高效、安全并可扩展的PHP模板引擎。</p>
<p>如果你具有Smarty, Django或者Jinja这养的基于文本的模板语言的经验，那么你对Twig会感觉一见如故。在遵循PHP理念的基础之上，提供了具备强大功能的模板环境，不论是对开发者还是设计者来说，这一引擎都具有良好的可用性。</p>
<p>关键特性：</p>
<ul>
<li>快速：Twig把模板编译成为优化后的PHP代码。相对普通PHP代码来说，其额外开销非常轻微。</li>
<li>安全：Twig会使用一个沙箱模式来运行不信任的模板代码。这使得Twig可以在用户可以修改模板设计的应用中工作良好。</li>
<li>弹性：Twig试用了弹性的词法和语法分析器。开发者可以定义自己的标记和过滤，并创建自己的DSL。</li>
</ul>
<h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>Twig需要的最小运行环境为PHP <strong>5.2.4</strong></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>推荐使用Composer安装Twig：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require <span class="string">&quot;twig/twig:~1.0&quot;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/18/Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/17/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/17/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">CentOS6.4安装oracle 10g教程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-17 13:55:47" itemprop="dateCreated datePublished" datetime="2015-11-17T13:55:47+08:00">2015-11-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-11-18 22:15:23" itemprop="dateModified" datetime="2015-11-18T22:15:23+08:00">2015-11-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>##一、硬件要求<br>1、内存 &amp; swap<br>Minimum: 1 GB of RAM<br>Recommended: 2 GB of RAM or more<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151118/20151118211127_56147.png" alt="硬件要求"></p>
<p>检查内存情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep MemTotal /proc/meminfo</span><br><span class="line">grep SwapTotal /proc/meminfo</span><br></pre></td></tr></table></figure>

<p>2、硬盘<br>由于CentOS安装后差不多有4~5G，再加上Oracle等等的安装，所以请准备至少10G的硬盘空间。<br>检查磁盘情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -h</span><br></pre></td></tr></table></figure>
<p><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151118/20151118211509_28032.jpg" alt="df-h"></p>
<p>##二、软件<br>系统平台：CentOS 6.3(x86_64)<br>CentOS-6.3-x86_64-bin-DVD1.iso<br>Oracle版本：Oracle 10g R2<br>10201_database_linux_x86_64.cpio</p>
<p>##三、系统安装注意<br>系统安装时一定要安装桌面模式，否则无法安装oracle，另外请勿开启SELinux，oracle官方不建议使用SELinux，CentOS 的防火墙也请暂时关闭，减少安装时的困扰。为防止Oracle安装过程中出现乱码，建议使用英文作为系统语言，进行Oracle的安装工作。<br>本文中所描述的系统命令，未经特殊标示，均为“#”代表root权限，“$”代表oracle权限。</p>
<p>##四、安装Oracle前的系统准备工作<br>首先，请先以root账号登入作一些前置设定作业。<br>1、关闭防火墙、禁用SELinux<br>setup<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151118/20151118211724_11378.jpg" alt="setup"></p>
<p>vi /etc/selinux/config<br>修改SELINUX=disabled，然后重启。<br>如果不想重启系统，使用命令setenforce 0<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151118/20151118211852_74451.jpg" alt="setenforce"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/17/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/16/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/16/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/" class="post-title-link" itemprop="url">Drupal8面向对象(OOP)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-16 15:16:30" itemprop="dateCreated datePublished" datetime="2015-11-16T15:16:30+08:00">2015-11-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:38:06" itemprop="dateModified" datetime="2015-12-23T17:38:06+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这是学习Drupal8的系列的开篇文章，在这里我们将介绍和探讨Drupal OOP。<br>OOP的最大优势就是解耦，Drupal8中使用大量的OOP(interface, class, etc…)，这里仅对Drupal中常见的一些概念做一下介绍。</p>
<p>###一、数据类型<br>什么是对象？我们先来看字符串，一个字符串就是一个数据类型，可以改变或获取字符串的一些信息，如要获取长度，我们一般是用strlen()函数。<br>但是对于其他的数据类型，如整形(int)等，这种方式就不适用。</p>
<p>而OOP的优势在于，它允许你自定义数据类型。这些数据类型也称之为”类”，在类中包含一些内部结构，如:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="comment">// 下面是人的成员属性</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$name</span>; <span class="comment">// 人的名子</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$sex</span>; <span class="comment">// 人的性别</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$age</span>; <span class="comment">// 人的年龄</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 构造函数</span></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$sex</span>, <span class="variable">$age</span></span>) </span>&#123;</span><br><span class="line">  	<span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">  	<span class="keyword">$this</span>-&gt;sex = <span class="variable">$sex</span>;</span><br><span class="line">  	<span class="keyword">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPerson</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name . <span class="string">&#x27;，性别：&#x27;</span> . <span class="keyword">$this</span>-&gt;sex . <span class="string">&#x27;，年龄：&#x27;</span> . <span class="keyword">$this</span>-&gt;age;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码定义了一个名叫Person的类，包含三个属性$name, $sex, $age，也包含2个方法。实例化如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span> = <span class="string">&#x27;王鹏&#x27;</span>;</span><br><span class="line"><span class="variable">$sex</span> = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="variable">$age</span> = <span class="number">30</span>;</span><br><span class="line"><span class="variable">$myperson</span> = <span class="keyword">new</span> Person(<span class="variable">$name</span>, <span class="variable">$sex</span>, <span class="variable">$age</span>);</span><br></pre></td></tr></table></figure>
<p>$myperson现在就是一个对象实例。对于Drupal来说，类和对象的关系就类似内容类型和内容之间的关系。</p>
<p>###二、类的结构(class)<br>类的概念：类是具有相同属性和服务的一组对象的集合。它为属于该类的所有对象提供了统一的抽象描述，其内部包括属性和服务两个主要部分。在面向对象的编程语言中，类是一个独立的程序单位，它应该有一个类名并包括属性说明和服务说明两个主要部分。</p>
<p>这段文字是摘抄自google，比较晦涩难懂。<br>简单说，方法是可以在对象上执行的操作。比如在Person类，我们有一个方法叫getPerson()，我们可以通过引用对象调用TA。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$person</span> = <span class="variable">$myperson</span>-&gt;getPerson();</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/16/Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/12/Drupal8-form/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/12/Drupal8-form/" class="post-title-link" itemprop="url">drupal8表单(form)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-12 17:15:23" itemprop="dateCreated datePublished" datetime="2015-11-12T17:15:23+08:00">2015-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:37:08" itemprop="dateModified" datetime="2015-12-23T17:37:08+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这里简单做下Entity Form的实现，包括调用模板输出form.<br>详情请访问俺的github，链接地址： <a target="_blank" rel="noopener" href="https://github.com/aboutblankchina/drupal8_test">https://github.com/aboutblankchina/drupal8_test</a></p>
<p>1、首先创建相关文件<br>[$install_path]/modules/hello_world/lib/Drupal/hello_world/Entity/Hello.php<br>注：该文件定义实例（Entity）</p>
<p>如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@file</span></span></span><br><span class="line"><span class="comment"> * Definition of Drupal\hello_world\Entity\Hello.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Drupal</span>\<span class="title">hello_world</span>\<span class="title">Entity</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Entity</span>\<span class="title">ContentEntityBase</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Entity</span>\<span class="title">EntityStorageControllerInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Field</span>\<span class="title">FieldDefinition</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Language</span>\<span class="title">Language</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Session</span>\<span class="title">AccountInterface</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Defines the hello entity class.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@EntityType</span>(</span></span><br><span class="line"><span class="comment"> *   id = &quot;hello&quot;,</span></span><br><span class="line"><span class="comment"> *   label = <span class="doctag">@Translation</span>(&quot;Hello&quot;),</span></span><br><span class="line"><span class="comment"> *   controllers = &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;storage&quot; = &quot;Drupal\Core\Entity\FieldableDatabaseStorageController&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;view_builder&quot; = &quot;Drupal\Core\Entity\EntityViewBuilder&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;form&quot; = &#123;</span></span><br><span class="line"><span class="comment"> *       &quot;default&quot; = &quot;Drupal\hello_world\HelloWorldFormController&quot;,</span></span><br><span class="line"><span class="comment"> *     &#125;,</span></span><br><span class="line"><span class="comment"> *   &#125;,</span></span><br><span class="line"><span class="comment"> *   base_table = &quot;node&quot;,</span></span><br><span class="line"><span class="comment"> *   entity_keys = &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;id&quot; = &quot;nid&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;label&quot; = &quot;title&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;uuid&quot; = &quot;uuid&quot;</span></span><br><span class="line"><span class="comment"> *   &#125;,</span></span><br><span class="line"><span class="comment"> *   links = &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;edit-form&quot; = &quot;hello.edit&quot;,</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * )</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">ContentEntityBase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要说明的是，上面的一部分注释(Annotation)是必须使用的，这是symfony的标准。<br>Symfony2框架中大量使用了Annotation：从缓存的定义到路由的配置，甚至到表结构的定义，处处都使用了Annotation功能。你甚至可以根据规范编写自己的Annotation。所以在使用Symfony2开发程序时，复杂的逻辑会变成一行行清晰的注释，程序的流程控制将变得非常简单。<br>详细见 <a target="_blank" rel="noopener" href="https://api.drupal.org/api/drupal/core!modules!system!system.api.php/group/annotation/8">https://api.drupal.org/api/drupal/core!modules!system!system.api.php/group/annotation/8</a> 。</p>
<p>2、在hello_world.routing.yml中增加一行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hello.edit:</span><br><span class="line">  path: <span class="string">&#x27;/hello/edit&#x27;</span></span><br><span class="line">  defaults:</span><br><span class="line">    _entity_form: <span class="string">&#x27;hello.default&#x27;</span></span><br><span class="line">  requirements:</span><br><span class="line">    _permission: <span class="string">&#x27;access hello world&#x27;</span></span><br></pre></td></tr></table></figure>

<p>3、创建文件 lib/Drupal/hello_world/HelloWorldFormController.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@file</span></span></span><br><span class="line"><span class="comment"> * Definition of Drupal\hello_world\HelloWorldFormController.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Drupal</span>\<span class="title">hello_world</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Component</span>\<span class="title">Utility</span>\<span class="title">NestedArray</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Datetime</span>\<span class="title">DrupalDateTime</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Entity</span>\<span class="title">ContentEntityFormController</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Core</span>\<span class="title">Language</span>\<span class="title">Language</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Drupal</span>\<span class="title">Component</span>\<span class="title">Utility</span>\<span class="title">String</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Form controller for the node edit forms.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorldFormController</span> <span class="keyword">extends</span> <span class="title">ContentEntityFormController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">form</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$form</span>, <span class="keyword">array</span> &amp;<span class="variable">$form_state</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$form</span> = <span class="built_in">parent</span>::form(<span class="variable">$form</span>, <span class="variable">$form_state</span>); <span class="variable">$entity</span> = <span class="keyword">$this</span>-&gt;entity;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$form</span>[<span class="string">&#x27;#title&#x27;</span>] = <span class="string">&#x27;这里写入网页标题&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$form</span>[<span class="string">&#x27;title&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&#x27;#type&#x27;</span> =&gt; <span class="string">&#x27;textfield&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;#title&#x27;</span> =&gt; t(<span class="string">&#x27;Title&#x27;</span>),</span><br><span class="line">      <span class="string">&#x27;#default_value&#x27;</span> =&gt; <span class="variable">$entity</span>-&gt;title-&gt;value,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果要用模板输出。则这样调用</span></span><br><span class="line">    <span class="variable">$form</span>[<span class="string">&#x27;#theme&#x27;</span>] = <span class="string">&#x27;hello_world_form&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$form</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$form</span>, <span class="keyword">array</span> &amp;<span class="variable">$form_state</span></span>) </span>&#123; </span><br><span class="line">    <span class="variable">$entity</span> = <span class="keyword">$this</span>-&gt;entity;</span><br><span class="line">    <span class="variable">$entity</span>-&gt;save();</span><br><span class="line">    drupal_set_message(<span class="string">&quot;hello saved&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">delete</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$form</span>, <span class="keyword">array</span> &amp;<span class="variable">$form_state</span></span>) </span>&#123; </span><br><span class="line">    <span class="variable">$entity</span> = <span class="keyword">$this</span>-&gt;entity;</span><br><span class="line">    <span class="variable">$entity</span>-&gt;delete();</span><br><span class="line">    drupal_set_message(<span class="string">&quot;hello has been deleted.&quot;</span>); </span><br><span class="line">    <span class="variable">$form_sate</span>[<span class="string">&#x27;redirect_route&#x27;</span>][<span class="string">&#x27;route_name&#x27;</span>] = <span class="string">&#x27;&lt;front&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4、如果要使用模板输出，则要定义hook_theme</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/12/Drupal8-form/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/12/Drupal8%E6%A8%A1%E5%9D%97-module-%E5%BC%80%E5%8F%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/12/Drupal8%E6%A8%A1%E5%9D%97-module-%E5%BC%80%E5%8F%91/" class="post-title-link" itemprop="url">Drupal8模块(module)开发</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-12 17:07:28" itemprop="dateCreated datePublished" datetime="2015-11-12T17:07:28+08:00">2015-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-23 17:37:50" itemprop="dateModified" datetime="2015-12-23T17:37:50+08:00">2015-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/12/Drupal8%E5%92%8Csymfony2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/12/Drupal8%E5%92%8Csymfony2/" class="post-title-link" itemprop="url">Drupal8和symfony2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-11-12 10:46:27 / Modified: 10:51:22" itemprop="dateCreated datePublished" datetime="2015-11-12T10:46:27+08:00">2015-11-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/12/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/12/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/" class="post-title-link" itemprop="url">从简单的列表页浅谈Vue组件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-12 10:46:27" itemprop="dateCreated datePublished" datetime="2015-11-12T10:46:27+08:00">2015-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-02-16 09:16:11" itemprop="dateModified" datetime="2017-02-16T09:16:11+08:00">2017-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>##组件</p>
<p>什么是组件？</p>
<p>组件（Component）是 Vue.js 最强大的功能之一。组件可以扩展 HTML 元素，封装可重用的代码。在较高层面上，组件是自定义元素， Vue.js 的编译器为它添加特殊功能。在有些情况下，组件也可以是原生 HTML 元素的形式，以 js 特性扩展。</p>
<p>##例子</p>
<p><img src="screen.png"></p>
<p>举个小例子：豆瓣电影排行榜</p>
<p>此例子包含文章列表，分页，这里把列表和分页分别当作单独的组件，加上父页面组件一共是3个</p>
<p>父组件：<code>app.vue</code></p>
<p>子组件：<code>list.vue</code> <code>pagination.vue</code></p>
<p>接口用的是豆瓣的jsonp，<code>https://api.douban.com/v2/movie/top250</code></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/12/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/08/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/08/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">MariaDB和Percona的引擎tokudb性能对比测试</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-11-08 20:30:12 / Modified: 20:41:30" itemprop="dateCreated datePublished" datetime="2015-11-08T20:30:12+08:00">2015-11-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>MariaDB和Mysql对比（配置4核4G）:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the MySQL monitor.  Commands end with ; <span class="keyword">or</span> \g.</span><br><span class="line">Your MySQL connection id is <span class="number">2</span></span><br><span class="line">Server version: <span class="number">5.6</span>.<span class="number">25</span>-<span class="number">73.1</span> Percona Server (GPL), Release <span class="number">73.1</span>, Revision <span class="number">07</span>b797f</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the MariaDB monitor.  Commands end with ; <span class="keyword">or</span> \g.</span><br><span class="line">Your MariaDB connection id is <span class="number">4</span></span><br><span class="line">Server version: <span class="number">10.0</span>.<span class="number">14</span>-MariaDB MariaDB Server</span><br></pre></td></tr></table></figure>

<p>###1、MariaDB导入数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [billing]&gt; load data infile <span class="string">&#x27;/home/user_logs.txt&#x27;</span> into table cloud_innodb FIELDS TERMINATED BY <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">641098</span> rows affected, <span class="number">65535</span> warnings (<span class="number">1</span> min <span class="number">18.02</span> sec)</span><br><span class="line">Records: <span class="number">641098</span>  Deleted: <span class="number">0</span>  Skipped: <span class="number">0</span>  Warnings: <span class="number">641098</span></span><br><span class="line"></span><br><span class="line">MariaDB [billing]&gt; load data infile <span class="string">&#x27;/home/user_logs.txt&#x27;</span> into table cloud_tokudb FIELDS TERMINATED BY <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">641098</span> rows affected, <span class="number">65535</span> warnings (<span class="number">36.83</span> sec)                                 </span><br><span class="line">Records: <span class="number">641098</span>  Deleted: <span class="number">0</span>  Skipped: <span class="number">0</span>  Warnings: <span class="number">641098</span></span><br></pre></td></tr></table></figure>

<p>Mysql导入数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; load data infile <span class="string">&#x27;/home/user_logs.txt&#x27;</span> into table cloud_innodb FIELDS TERMINATED BY <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">641098</span> rows affected, <span class="number">65535</span> warnings (<span class="number">1</span> min <span class="number">10.75</span> sec)</span><br><span class="line">Records: <span class="number">641098</span>  Deleted: <span class="number">0</span>  Skipped: <span class="number">0</span>  Warnings: <span class="number">641098</span></span><br><span class="line"></span><br><span class="line">mysql&gt; load data infile <span class="string">&#x27;/home/user_logs.txt&#x27;</span> into table cloud_tokudb FIELDS TERMINATED BY <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">641098</span> rows affected, <span class="number">65535</span> warnings (<span class="number">33.35</span> sec)</span><br><span class="line">Records: <span class="number">641098</span>  Deleted: <span class="number">0</span>  Skipped: <span class="number">0</span>  Warnings: <span class="number">641098</span></span><br></pre></td></tr></table></figure>

<p>总结：<br>1）、MariaDB导入数据比Mysql要慢一点<br>2）、TokuDB导入数据比InnoDB速度快一倍<br>3）、TokuDB采用多CPU并发导入</p>
<p>###2、MariaDB存储空间</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost billing]<span class="comment"># ll -h</span></span><br><span class="line">-rw-rw----. <span class="number">1</span> mysql mysql <span class="number">1.5</span>K Nov  <span class="number">4</span> <span class="number">14</span>:<span class="number">16</span> cloud_innodb.frm</span><br><span class="line">-rw-rw----. <span class="number">1</span> mysql mysql <span class="number">568</span>M Nov  <span class="number">4</span> <span class="number">14</span>:<span class="number">40</span> cloud_innodb.ibd</span><br><span class="line"></span><br><span class="line">[root@localhost mysqldata]<span class="comment"># ll -h</span></span><br><span class="line">-rw-rw----. <span class="number">1</span> mysql mysql  <span class="number">26</span>M Nov  <span class="number">4</span> <span class="number">14</span>:<span class="number">31</span> _billing_cloud_tokudb_main_172d_1_1b_B_0.tokudb</span><br><span class="line">-rw-rw----. <span class="number">1</span> mysql mysql  <span class="number">64</span>K Nov  <span class="number">4</span> <span class="number">14</span>:<span class="number">31</span> _billing_cloud_tokudb_status_1729_1_1b.tokudb</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/08/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/02/understanding-drupal8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/02/understanding-drupal8/" class="post-title-link" itemprop="url">understanding drupal8-drupal8初窥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-02 15:42:26" itemprop="dateCreated datePublished" datetime="2015-11-02T15:42:26+08:00">2015-11-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-11-05 09:52:15" itemprop="dateModified" datetime="2015-11-05T09:52:15+08:00">2015-11-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如何学习drupal8？国内文档寥寥可数，后发现老外的一篇文章，可做入门，遂翻译如下。原创内容，转载请注明出处！</p>
<p>##一、结构<br>Drupal 8来了。这是一个革命！和Drupal6到Drupal7的演化不同，这是一个完全不同的架构和编码方式。我确信这些变化对专业化和现代化CMS是必不可少的。我相信转向面向对象将会吸引开发者，并将提升软件的整体质量。我感谢Drupal内核开发者的勇气以及为此所做的工作。<br>然而，对于现有（包括新的）Web开发者，学习drupal将是一个巨大的挑战。通过阅读这篇文章，您将更具优势。在你深入Drupal 8模块开发前，这篇文章会给你带去些许启示。在我写下这篇文章之前，我花了数天，通过一步步的调试、阅读代码和在线文章，深入地学习了symfony2 和 Drupal8。我是一个经验丰富的Drupal7开发者，但是对symfony一无所知，并且至今没有对Druapl8内核有所贡献。我相信，通过分享我所学到的，也能助你提升对它的理解。<br>在接下来的四周里，这篇文章将发布成四部分。在这第一部分，我们将一瞥Drupal 8 框架的总体架构，特别是与symfony2 组件的联系。我们将看到哪些symfony2 组件在Drupal中用到了以及如何使用。在下一个部分，我们将详细学习非常重要的类容器。在第三部分，我们将详细学习Drupal 8 的引导和路由。你将学到如何处理一个请求。在第四也是最后一部分，将会介绍drupal 8的其它一些令人兴奋的、全新的特性。<br>###1、Symfony2<br>Symfony框架被设计用来使开发者能够构建自定义的Web应用。Symfony不是一个CMS，因为它不能用来管理一个站点。相反，要构建应用，必须要写代码。为此，symfony提供了一些方法使开发更具效率。理论上，CMS可以基于Symfony开发，但事实上，Symfony的默认方式对Drupal来说并不灵活。</p>
<p>因此，Drupal 8只采用了Symfony的非常优秀的内核层，并且扩展它以支持Drupal模块。这促生了一个非常平衡的系统，它采用Symfony部分优秀的内核（而且未经修改），但是可以基于一个非常灵活的CMS层扩展它。<br>###2、组件<br>Symfony框架由数个组件构成。有些对系统是至关重要的，例如能理解HTTP协议并且为其他组件提供良好request和response对象的Http Foundation组件。其他的仅是辅助组件，例如校验数据的Validator组件（检测是否是合法的电子邮件地址/URL/数字/等等？）。系统的核心是Kernel组件。这个内核总的来说就是一个主类，它管理环境（类和程序集）并负责处理http请求。开发者可以通过扩展内核来扩展系统，例如AppKernal就是扩展了Kernal，并且在里面添加了自己的程序集。这些程序集可以构建一系列连贯的功能集合，非常类似于Drupal的模块。<br>Drupal只使用了Symfony的一部分组件，如下图所示：<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151104/2015110494853_67351.png" alt="组件"></p>
<p>###3、Drupal 8如何扩展Symfony<br>Drupal不扩展内核，而Symfony应用会。通过实现内核接口，Drupal提供了相似的功能类型。这是因为Drupal不共享Symfony的程序集方法。程序集提供了极好的方式来构建自定义的web应用，但是不适合构建需要灵活性和扩展性的CMS。DrupalKernal加载环境（可用的类和模块）的方式与Kernal稍微不同，但是和Symfony Kernal一样，都是把将http请求委托给HttpKernel。<br>与此同时，Drupal 8引入了自己的（第三方）组件和核心代码，示意概览如下图所示：<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151104/2015110494817_42194.png" alt="Drupal 8如何扩展Symfony"></p>
<p>###4、结论<br>这里总结了“开始学习Drupal 8”这篇文章。下周我们将开始学习类容器，可以理解成Drupal系统的骨架。在理解任何其他组件前你必须先了解它。</p>
<p>##二、服务容器<br>这是“理解Drupal 8”的第二部分。在第一部分，我们已经学习了Drupal 8的总体架构以及它与Symfony的关联。Symfony（和Drupal 8）包含着许多组件。在这篇文章中，你将会学习到什么是服务容器，以及在Drupal 8中怎么使用它。很重要的一点就是，在学习路由之前我们得先理解服务容器。</p>
<p>Symfony采用了服务器容器，它可以高效地管理应用中的services。这个概念也就是所谓的Dependency Injection。</p>
<p>服务容器是一个在处理请求之前由Kernal创建并包含的全局对象。它能被用来获取服务，动态加载服务。服务是用于完成特定任务的全局对象，例如邮件服务或数据库连接。一个服务对应着一个确切的类。服务容器非常重要，因为它包含可用服务，知道它们的联系和配置信息，甚至构造它们。</p>
<p>###1、依赖和参数<br>一个服务可能依赖于其他服务。Symfony文档举了个通讯管理服务依赖邮件服务来发送邮件的例子。服务容也管理着这些依赖。当创建一个服务时，它的依赖会通过类构造器中的参数进行传递。接口用来定义依赖服务要提供哪些方法，这样实现的这个服务才能在必要时与另一个服务进行交换。</p>
<p>###2、配置<br>服务容器中的服务可以通过多种方式进行配置：代码（所谓的扩展），XML，YAML，等等。Symfony混合着使用这些方式，但是把大多数核心服务配置留给了程序集代码。Drupal的服务配置则不同，大部分基于yaml文件。Drupal使用services.core.yml来关联所有与内核相关的配置。这个配置可以被模块和ServiceProvider类扩展。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/02/understanding-drupal8/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/02/Converting-7-x-modules-to-8-x/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/02/Converting-7-x-modules-to-8-x/" class="post-title-link" itemprop="url">Converting 7.x modules to 8.x</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-11-02 14:10:20 / Modified: 14:58:29" itemprop="dateCreated datePublished" datetime="2015-11-02T14:10:20+08:00">2015-11-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本节主要介绍如何把drupal7的模块转化为drupal8。参考资料<a target="_blank" rel="noopener" href="https://www.drupal.org/update/modules/7/8">https://www.drupal.org/update/modules/7/8</a></p>
<p>先介绍一个模块drupalmoduleupgrader，他会分析drupal7的模块，并提供升级的指导说明，另外还可以直接升级为drupal8。安装方式也比较简单，如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">drush dl drupalmoduleupgrader</span><br><span class="line"><span class="built_in">cd</span> modules/drupalmoduleupgrader</span><br><span class="line">composer install               <span class="comment">#安装依赖</span></span><br><span class="line">drush en drupalmoduleupgrader  <span class="comment">#启用此模块</span></span><br></pre></td></tr></table></figure>

<p>###如何分析？<br>cp一个drupal7的模块到drupal8的modules目录下，执行以下命令分析:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush dmu-analyze hello_world</span><br></pre></td></tr></table></figure>
<p>会释出一个upgrade-info.html的文件，非常详细的标明哪些API需要修改。</p>
<p><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151102/20151102143425_76787.png" alt="upgrade-info.html"></p>
<p>###如何升级？<br>执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush dmu-upgrade hello_world</span><br></pre></td></tr></table></figure>
<p>会自动释出一个drupal8的版本。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/02/Converting-7-x-modules-to-8-x/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/11/02/Drupal8-drush/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/02/Drupal8-drush/" class="post-title-link" itemprop="url">drush for drupal8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-11-02 13:54:20" itemprop="dateCreated datePublished" datetime="2015-11-02T13:54:20+08:00">2015-11-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-05-23 17:00:34" itemprop="dateModified" datetime="2016-05-23T17:00:34+08:00">2016-05-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal8/" itemprop="url" rel="index"><span itemprop="name">Drupal8</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>文档见<a target="_blank" rel="noopener" href="http://docs.drush.org/en/master/install/%EF%BC%8C%E8%BF%99%E9%87%8C%E8%AE%B0%E5%BD%95%E4%B8%8B%E7%AC%94%E8%80%85%E7%9A%84%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E3%80%82">http://docs.drush.org/en/master/install/，这里记录下笔者的安装流程。</a></p>
<p>##1、安装composer</p>
<p>作为最知名的php第三方库安装工具，drush也支持使用这种方式安装。<br>composer的安装比较简单。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sS https://getcomposer.org/installer | sudo php -- --install-dir=/usr/bin --filename=composer</span><br></pre></td></tr></table></figure>

<p>vim ~/.bashrc 并添加一条 export PATH=”$HOME/.composer/vendor/bin:$PATH”。</p>
<p>##2、安装drush</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create and/or navigate to a path for the single Composer Drush install.</span></span><br><span class="line">mkdir --parents /opt/drush-8.x</span><br><span class="line"><span class="built_in">cd</span> /opt/drush-8.x</span><br><span class="line"><span class="comment"># Initialise a new Composer project that requires Drush.</span></span><br><span class="line">composer init --require=drush/drush:8.* -n</span><br><span class="line"><span class="comment"># Configure the path Composer should use for the Drush vendor binaries.</span></span><br><span class="line">composer config bin-dir /usr/<span class="built_in">local</span>/bin</span><br><span class="line"><span class="comment"># Install Drush. </span></span><br><span class="line">composer install</span><br></pre></td></tr></table></figure>

<p>安装完，如果有Unable to load autoload.php…的错误，编辑</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/<span class="built_in">local</span>/drush/drush/drush/includes/preflight.inc</span><br></pre></td></tr></table></figure>

<p>查找$global_vendor_path，修改为</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/11/02/Drupal8-drush/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/10/15/%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/10/15/%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C/" class="post-title-link" itemprop="url">并发与并行</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-10-15 11:16:05 / Modified: 13:27:57" itemprop="dateCreated datePublished" datetime="2015-10-15T11:16:05+08:00">2015-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>并发(Concurrently)和并行(Parallel)是两个不同的概念。借用Go创始人Rob Pike的说法，并发不是并行，并发更好。</p>
<blockquote>
<p>并发是一共要处理(deal with)很多事情，并行是一次可以做(do)多少事情。</p>
</blockquote>
<p>举个简单的例子，华罗庚泡茶，必须有烧水、洗杯子、拿茶叶等步骤。现在我们想尽快做完这件事，也就是“一共要处理很多事情”，有很多方法可以实现并发，例如请多个人同时做，这就是并行。并行是实现并发的一种方式，但不是唯一的方式。我们一个人也可以实现并发，例如先烧水、然后不用等水烧开就去洗杯子，所以通过调整程序运行方式也可以实现并发。</p>
<p>大神讲解</p>
<p>如果还不理解，建议看Rob Pike题为Concurrency is not Parallelism的<a target="_blank" rel="noopener" href="http://concur.rspace.googlecode.com/hg/talk/concur.html">演讲PPT</a>和<a target="_blank" rel="noopener" href="http://blog.golang.org/concurrency-is-not-parallelism">演讲视频</a>。</p>
<p>我把演讲的PPT截图贴出来方便大家理解。</p>
<p><img src="https://static.verycloud.cn/sites/default/files/pic/image/20151015/20151015132329_33012.png"></p>
<p>总结</p>
<p>总结一下，并行是实现并发的一种方式，在多核CPU的时代，并行是我们设计高效程序所要考虑的，那么进程是不是越多越好呢？</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/10/15/%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/09/24/%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%E4%BA%86swap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/24/%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%E4%BA%86swap/" class="post-title-link" itemprop="url">查看哪些进程占用了swap</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-09-24 10:22:51 / Modified: 10:25:01" itemprop="dateCreated datePublished" datetime="2015-09-24T10:22:51+08:00">2015-09-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这个脚本可以方便的查看哪些进程占用了swap。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##############################################################################</span></span><br><span class="line"><span class="comment"># 脚本功能 ： 列出正在占用swap的进程。</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line">  </span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;PID\t\tSwap\t\tProc_Name&quot;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 拿出/proc目录下所有以数字为名的目录（进程名是数字才是进程，其他如sys,net等存放的是其他信息）</span></span><br><span class="line"><span class="keyword">for</span> pid <span class="keyword">in</span> `ls -l /proc | grep ^d | awk <span class="string">&#x27;&#123; print $9 &#125;&#x27;</span>| grep -v [^0-9]`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># 让进程释放swap的方法只有一个：就是重启该进程。或者等其自动释放。放</span></span><br><span class="line">    <span class="comment"># 如果进程会自动释放，那么我们就不会写脚本来找他了，找他都是因为他没有自动释放。</span></span><br><span class="line">    <span class="comment"># 所以我们要列出占用swap并需要重启的进程，但是init这个进程是系统里所有进程的祖先进程</span></span><br><span class="line">    <span class="comment"># 重启init进程意味着重启系统，这是万万不可以的，所以就不必检测他了，以免对系统造成影响。</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$pid</span> -eq 1 ];<span class="keyword">then</span> <span class="built_in">continue</span>;<span class="keyword">fi</span></span><br><span class="line">    grep -q <span class="string">&quot;Swap&quot;</span> /proc/<span class="variable">$pid</span>/smaps 2&gt;/dev/null</span><br><span class="line">    <span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">        swap=$(grep Swap /proc/<span class="variable">$pid</span>/smaps \</span><br><span class="line">            | gawk <span class="string">&#x27;&#123; sum+=$2;&#125; END&#123; print sum &#125;&#x27;</span>)</span><br><span class="line">        proc_name=$(ps aux | grep -w <span class="string">&quot;<span class="variable">$pid</span>&quot;</span> | grep -v grep \</span><br><span class="line">            | awk <span class="string">&#x27;&#123; for(i=11;i&lt;=NF;i++)&#123; printf(&quot;%s &quot;,$i); &#125;&#125;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> [ <span class="variable">$swap</span> -gt 0 ];<span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;pid&#125;</span>\t<span class="variable">$&#123;swap&#125;</span>\t<span class="variable">$&#123;proc_name&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">fi</span> </span><br><span class="line">    <span class="keyword">fi</span> </span><br><span class="line"><span class="keyword">done</span> | sort -k2 -n | awk -F<span class="string">&#x27;\t&#x27;</span> <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    pid[NR]=$1;</span></span><br><span class="line"><span class="string">    size[NR]=$2;</span></span><br><span class="line"><span class="string">    name[NR]=$3;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">END&#123;</span></span><br><span class="line"><span class="string">    for(id=1;id&lt;=length(pid);id++)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        if(size[id]&lt;1024)</span></span><br><span class="line"><span class="string">            printf(&quot;%-10s\t%15sKB\t%s\n&quot;,pid[id],size[id],name[id]);</span></span><br><span class="line"><span class="string">        else if(size[id]&lt;1048576)</span></span><br><span class="line"><span class="string">            printf(&quot;%-10s\t%15.2fMB\t%s\n&quot;,pid[id],size[id]/1024,name[id]);</span></span><br><span class="line"><span class="string">        else</span></span><br><span class="line"><span class="string">            printf(&quot;%-10s\t%15.2fGB\t%s\n&quot;,pid[id],size[id]/1048576,name[id]);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/09/24/%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%E4%BA%86swap/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/08/17/Drupal7-WEB%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/08/17/Drupal7-WEB%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="post-title-link" itemprop="url">drupal7 WEB性能优化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-08-17 11:11:30 / Modified: 11:29:41" itemprop="dateCreated datePublished" datetime="2015-08-17T11:11:30+08:00">2015-08-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>一、DNS prefetch</li>
</ul>
<p>DNS 作为互联网的基础协议，其解析的速度似乎容易被网站优化人员忽视。现在浏览器厂商已经有在针对 DNS 进行优化，典型的一次 DNS 解析耗费 20-120 毫秒，减少 DNS 解析数是个优化的方式，而能够缩减 DNS 解析的时间也是有经济效益的事情。这就是浏览器厂商重视 DNS Prefetching 的主要原因。DNS Prefetching 对于性能的收益可以简单的用”DNS 同步请求到异步”来解释，也就是具有此属性的域名不需要用户点击链接就在后台解析，而域名解析和内容载入是串行的网络操作，所以这个方式能减少用户的等待时间，提升用户体验。</p>
<p>Google Chrome 内置就有 DNS Prefetching 技术 ，而 Firefox 3.5 也引入了这一 新特性。至于 IE，貌似还未支持。</p>
<p>Drupal如何起dns prefetch呢? 先上一段代码.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * hook_html_head_alter()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">themename_html_head_alter</span>(<span class="params">&amp;<span class="variable">$header</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Enable prefetching.</span></span><br><span class="line">  <span class="variable">$header</span>[<span class="string">&#x27;dns_prefetch_control&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;#type&#x27;</span> =&gt; <span class="string">&#x27;html_tag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#tag&#x27;</span> =&gt; <span class="string">&#x27;meta&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;#attributes&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;http-equiv&#x27;</span> =&gt; <span class="string">&#x27;x-dns-prefetch-control&#x27;</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;on&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;#weight&#x27;</span> =&gt; -<span class="number">10001</span>,</span><br><span class="line">  );  </span><br><span class="line">  </span><br><span class="line">  <span class="variable">$dns_prefetch_domains</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;www.google.cn&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;www.baidu.com&#x27;</span>,</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="variable">$dns_prefetch_domains</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$header</span>[<span class="string">&#x27;dns_prefetch_control_&#x27;</span> . <span class="variable">$key</span>] = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&#x27;#type&#x27;</span> =&gt; <span class="string">&#x27;html_tag&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;#tag&#x27;</span> =&gt; <span class="string">&#x27;link&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;#attributes&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;rel&#x27;</span> =&gt; <span class="string">&#x27;dns-prefetch&#x27;</span>, <span class="string">&#x27;href&#x27;</span> =&gt; <span class="string">&#x27;//&#x27;</span> . drupal_strip_dangerous_protocols(trim(<span class="variable">$value</span>))),</span><br><span class="line">    );     </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打开浏览器，就可以看到如下的输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta content=<span class="string">&quot;on&quot;</span> http-equiv=<span class="string">&quot;x-dns-prefetch-control&quot;</span>&gt;</span><br><span class="line">&lt;link href=<span class="string">&quot;//www.google.cn&quot;</span> rel=<span class="string">&quot;dns-prefetch&quot;</span>&gt;</span><br><span class="line">&lt;link href=<span class="string">&quot;//www.baidu.com&quot;</span> rel=<span class="string">&quot;dns-prefetch&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>二、启用压缩<br>压缩的目的是让传输的数据变得更小。我们的线上代码（JS、CSS 和 HTML）都会做压缩，图片也会做压缩（PNGOUT、Pngcrush、JpegOptim、Gifsicle 等）。对于文本文件，在服务端发送响应之前进行 GZip 压缩也很重要，通常压缩后的文本大小会减小到原来的 1/4 - 1/3。对代码进行内容压缩已经有成熟的工具和标准流程了，而服务端的 GZip 更是标配，所以「压缩」是一项收益投入比很高的优化手段。</li>
</ul>
<ul>
<li><p>三、使用 HTTP 缓存<br>任何一个 WEB 项目，要提高性能，各个环节的缓存必不可少。利用好 HTTP 协议的缓存机制，可以大幅减少传输数据，减少请求，这又是一项收益投入比超高的优化手段。这里把之前我写的 HTTP/1.1 缓存机制介绍翻出来：<br>首先，服务端可以通过响应头里的 Last-Modified（最后修改时间） 或者 ETag（内容特征） 标记实体。浏览器会存下这些标记，并在下次请求时带上 If-Modified-Since: 上次 Last-Modified 的内容 或 If-None-Match: 上次 ETag 的内容，询问服务端资源是否过期。如果服务端发现并没有过期，直接返回一个状态码为 304、正文为空的响应，告知浏览器使用本地缓存；如果资源有更新，服务端返回状态码 200、新的 Last-Modified、Etag 和正文。这个过程被称之为 HTTP 的协商缓存，通常也叫做弱缓存。<br>可以看到协商缓存并不会节省连接数，但是在缓存生效时，会大幅减小传输内容（304 响应没有正文，一般只有几百字节）。另外为什么有两个响应头都可以用来实现协商缓存呢？这是因为一开始用的 Last-Modified 有两个问题：1）只能精确到秒，1 秒内的多次变化反映不出来；2）时间采用绝对值，如果服务端 / 客户端时间不对都可能导致缓存失效。HTTP/1.1 并没有规定 ETag 的生成规则，而一般实现者都是对资源内容做摘要，能解决前面两个问题。<br>另外一种缓存机制是服务端通过响应头告诉浏览器，在什么时间之前（Expires）或在多长时间之内（Cache-Control: Max-age=xxx），不要再请求服务器了。这个机制我们通常称之为 HTTP 的强缓存。<br>一旦资源命中强缓存规则后，再次访问完全没有 HTTP 请求（Chrome 开发者工具的 Network 面板依然会显示请求，但是会注明 from cache；Firefox 的 firebug 也类似，会注明 BFCache），这会大幅提升性能。所以我们一般会对 CSS、JS、图片等资源使用强缓存，而入口文件（HTML）一般使用协商缓存或不缓存，这样可以通过修改入口文件中对强缓存资源的引入 URL 来达到即时更新的目的。<br>这里也解释下为什么有了 Expire，还要有 Cache-Control。也有两个原因：1）Cache-Control 功能更强大，对缓存的控制能力更强；2）Cache-Control 采用的 max-age 是相对时间，不受服务端 / 客户端时间不对的影响。<br>另外关于浏览器的刷新（F5 / cmd + r）和强刷（Ctrl + F5 / shift + cmd +r）：普通刷新会使用协商缓存，忽略强缓存；强刷会忽略浏览器所有缓存（并且请求头会携带 Cache-Control:no-cache 和 Pragma:no-cache，用来通知所有中间节点忽略缓存）。只有从地址栏或收藏夹输入网址、点击链接等情况下，浏览器才会使用强缓存。</p>
</li>
<li><p>四、使用HTTP2<br>1、HTTP/2 的 Server Push 机制，可以让重要的 JS、CSS 等资源尽快加载，从而不再需要 HTTP/1 中「将重要资源内联在页面头部」的优化方案了。</p>
<p>2、HTTP/2 支持了多路复用，HTTP 连接变得十分廉价，之前为了节省连接数所采用的类似于「资源合并、资源内联」等优化手段不再需要了。多路复用可以在一个 TCP 连接上建立大量 HTTP 连接，也就不存在 HTTP 连接数限制了，HTTP/1 中常见的「静态域名」优化策略不但用不上了，还会带来负面影响，需要去掉。另外，HTTP/2 的头部压缩功能也能大幅减少 HTTP 协议头部带来的开销。</p>
</li>
<li><p>五、使用CDN<br>  国内比较好的CDN服务商如VeryCloud等。</p>
</li>
</ul>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/08/17/Drupal7-WEB%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/07/31/SQLite-database-disk-image-is-malformed-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/07/31/SQLite-database-disk-image-is-malformed-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">Drupal SQLite: database disk image is malformed 解决方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-07-31 13:22:07 / Modified: 14:14:39" itemprop="dateCreated datePublished" datetime="2015-07-31T13:22:07+08:00">2015-07-31</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我碰到的这种情况，并不是网上说的磁盘坏了。而是由于频繁读写，并且有BLOB大数据频繁读写。</p>
<p>解决办法就是通过导出导入方式对损坏的库文件作恢复。</p>
<p>首先导出数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 my.sqlite3</span><br><span class="line">sqlite&gt;.output tmp.sql</span><br><span class="line">sqlite&gt;.dump</span><br><span class="line">sqlite&gt;.quit</span><br></pre></td></tr></table></figure>

<p>再导入到一个新库中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 new.sqlite3</span><br><span class="line">sqlite&gt;.<span class="built_in">read</span> tmp.sql</span><br><span class="line">sqlite&gt;.quit</span><br></pre></td></tr></table></figure>

<p>覆盖new.sqlite文件到sites/default/files/.ht.sqlite即可。</p>
<p>另外，如果只是临时数据，可以放到/dev/shm，就是内存数据库啦。。。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/07/31/SQLite-database-disk-image-is-malformed-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/07/14/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/07/14/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/" class="post-title-link" itemprop="url">sublime text创建快捷注释信息</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-07-14 10:18:10 / Modified: 10:26:32" itemprop="dateCreated datePublished" datetime="2015-07-14T10:18:10+08:00">2015-07-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>该方式适用于sublime text2和3。</li>
</ul>
<h2 id="创建代码片段"><a href="#创建代码片段" class="headerlink" title="创建代码片段"></a>创建代码片段</h2><p>点击菜单栏里的 Tools 菜单，然后点击 New Snippet，之后会在新的 tab 页创建一个代码片段模板，编辑代码如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;snippet&gt;</span><br><span class="line">	&lt;content&gt;&lt;![CDATA[</span><br><span class="line">/**</span><br><span class="line"> * 定义函数</span><br><span class="line"> *</span><br><span class="line"> * 函数功能描述</span><br><span class="line"> * </span><br><span class="line"> * @author panjun.liu &lt;lpj163@gmail.com&gt;</span><br><span class="line"> *</span><br><span class="line"> * @param int <span class="variable">$param1</span>      参数释义</span><br><span class="line"> * @param string <span class="variable">$param2</span>   参数释义</span><br><span class="line"> *</span><br><span class="line"> * @<span class="built_in">return</span> <span class="built_in">integer</span>|string|array</span><br><span class="line">*/</span><br><span class="line">]]&gt;&lt;/content&gt;</span><br><span class="line">	&lt;!-- Optional: Set a tabTrigger to define how to trigger the snippet --&gt;</span><br><span class="line"> 	&lt;tabTrigger&gt;phpdoc&lt;/tabTrigger&gt;</span><br><span class="line">	&lt;!-- Optional: Set a scope to <span class="built_in">limit</span> <span class="built_in">where</span> the snippet will trigger --&gt;</span><br><span class="line">	&lt;!-- &lt;scope&gt;source.python&lt;/scope&gt; --&gt;</span><br><span class="line">&lt;/snippet&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：<br>tabTrigger 此节是可选的配置，默认是被注释掉的。默认 hello 的意思是：如果你在某个文档里输入了单词 hello ，然后按下 Tab 键，接着 hello 就会被替换为1中定义的代码片段。再次按下Tab键，接着snippet会被替换为2中定义的代码片段。</p>
</blockquote>
<p>保存到当前用户主目录下的\Sublime Text 3\Packages\User目录中，命名为phpdoc.sublime-snippet(注意：后缀必须为.sublime-snippet)。</p>
<h2 id="绑定快捷键"><a href="#绑定快捷键" class="headerlink" title="绑定快捷键"></a>绑定快捷键</h2><p>可以将上述的操作绑定到一个快捷键，在不键入任何文本的情况下，直接按快捷键插入代码片段。</p>
<p>点击菜单栏的 Preferences 的子菜单 Key Binding – User，在打开的文件的方括号内部粘贴如下配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">	&#123; <span class="string">&quot;keys&quot;</span>: [<span class="string">&quot;phpdoc&quot;</span>], <span class="string">&quot;command&quot;</span>: <span class="string">&quot;insert_snippet&quot;</span>, <span class="string">&quot;args&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Packages/User/phpdoc.sublime-snippet&quot;</span>&#125; &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/07/14/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/07/04/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/07/04/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/" class="post-title-link" itemprop="url">rsync主备代码同步</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-07-04 10:00:54" itemprop="dateCreated datePublished" datetime="2015-07-04T10:00:54+08:00">2015-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-07-21 14:26:53" itemprop="dateModified" datetime="2015-07-21T14:26:53+08:00">2015-07-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>同步服务器192.168.1.100<br>接收服务器192.168.1.200<br>即把192.168.1.100的代码备份到192.168.1.200。</p>
<h1 id="192-168-1-100上的配置如下："><a href="#192-168-1-100上的配置如下：" class="headerlink" title="192.168.1.100上的配置如下："></a>192.168.1.100上的配置如下：</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install rsync inotify-tools</span><br><span class="line"></span><br><span class="line">crontab -e</span><br><span class="line">*/59 * * * * /bin/sh /usr/<span class="built_in">local</span>/scripts/rsync.sh &gt;&gt; /var/<span class="built_in">log</span>/rsync.log</span><br><span class="line">即每小时的第59分钟同步代码</span><br></pre></td></tr></table></figure>

<h1 id="usr-local-scripts-rsync-sh脚本内容如下"><a href="#usr-local-scripts-rsync-sh脚本内容如下" class="headerlink" title="/usr/local/scripts/rsync.sh脚本内容如下"></a>/usr/local/scripts/rsync.sh脚本内容如下</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh </span></span><br><span class="line">SRC=/var/www/html/ <span class="comment">#记得在最后面加/不然RYNC会自动增加一层目录 </span></span><br><span class="line">DES=rsync_data <span class="comment">#192.168.1.200认证的模块名，后面会说明</span></span><br><span class="line">IP=192.168.1.200</span><br><span class="line">USER=backup </span><br><span class="line">INWT=/usr/bin/inotifywait </span><br><span class="line">RSYNC=/usr/bin/rsync </span><br><span class="line"><span class="variable">$RSYNC</span> -auzviL --delete --progress --password-file=/root/rsync.pwd <span class="variable">$SRC</span> <span class="variable">$USER</span>@<span class="variable">$IP</span>::<span class="variable">$DES</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>rsync 选项说明<br> -a 称为归档模式，执行以下操作<br>递归模式<br>保留符号链接<br>保留权限<br>保留时间标记<br>保留用户名及组名<br>-z 开启压缩<br>-v 详情输出<br>-u 选项可以排除被修改过的目的文件<br>-L 把软连接文件夹同步过来<br>查看每个文件的传输进程,用 –-progress 参数<br>删除在目的文件夹中创建的文件,用 –-delete 参数</p>
</blockquote>
<h1 id="192-168-1-200上的配置如下："><a href="#192-168-1-200上的配置如下：" class="headerlink" title="192.168.1.200上的配置如下："></a>192.168.1.200上的配置如下：</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">yum install rsync</span><br><span class="line"></span><br><span class="line">vim /etc/rsyncd.conf</span><br><span class="line">uid=root </span><br><span class="line">gid=root </span><br><span class="line">max connections=36000 </span><br><span class="line">use chroot=no </span><br><span class="line"><span class="built_in">log</span> file=/var/<span class="built_in">log</span>/rsyncd.log </span><br><span class="line">pid file=/var/run/rsyncd.pid </span><br><span class="line">lock file=/var/run/rsyncd.lock </span><br><span class="line">[rsync_data] </span><br><span class="line">path=/data/192.168.1.100/ <span class="comment">#192.168.1.100是一个必须存在的目录</span></span><br><span class="line">comment = 192.168.1.100</span><br><span class="line">ignore errors = yes</span><br><span class="line"><span class="built_in">read</span> only = no </span><br><span class="line">hosts allow = 192.168.1.100</span><br></pre></td></tr></table></figure>

<p>rsync启动脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/sh</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chkconfig:   2345 50 50</span></span><br><span class="line"><span class="comment"># description: The rsync daemon</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># source function library</span></span><br><span class="line"> . /etc/rc.d/init.d/<span class="built_in">functions</span></span><br><span class="line"></span><br><span class="line">PROG=<span class="string">&#x27;/usr/bin/rsync&#x27;</span></span><br><span class="line">BASE=<span class="variable">$&#123;0##*/&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Adapt the --config parameter to point to your rsync daemon configuration</span></span><br><span class="line"><span class="comment"># The config file must contain following line:</span></span><br><span class="line"><span class="comment">#  pid file = /var/run/&lt;filename&gt;.pid</span></span><br><span class="line"><span class="comment"># Where &lt;filename&gt; is the filename of the init script (= this file)</span></span><br><span class="line">OPTIONS=<span class="string">&quot;--daemon --config=/etc/rsyncd.conf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">  start)</span><br><span class="line">    <span class="built_in">echo</span> -n $<span class="string">&quot;Starting <span class="variable">$BASE</span>: &quot;</span></span><br><span class="line">    daemon --check <span class="variable">$BASE</span> <span class="variable">$PROG</span> <span class="variable">$OPTIONS</span></span><br><span class="line">    RETVAL=$?</span><br><span class="line">    [ <span class="variable">$RETVAL</span> -eq 0 ] &amp;&amp; touch /var/lock/subsys/<span class="variable">$BASE</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    ;;</span><br><span class="line">  stop)</span><br><span class="line">    <span class="built_in">echo</span> -n $<span class="string">&quot;Shutting down <span class="variable">$BASE</span>: &quot;</span></span><br><span class="line">    killproc <span class="variable">$BASE</span></span><br><span class="line">    RETVAL=$?</span><br><span class="line">    [ <span class="variable">$RETVAL</span> -eq 0 ] &amp;&amp; rm -f /var/lock/subsys/<span class="variable">$BASE</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    ;;</span><br><span class="line">  restart|force-reload)</span><br><span class="line">    <span class="variable">$0</span> stop</span><br><span class="line">    sleep 1</span><br><span class="line">    <span class="variable">$0</span> start</span><br><span class="line">    ;;</span><br><span class="line">  *)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> &#123;start|stop|restart|force-reload&#125;&quot;</span> &gt;&amp;2</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/07/04/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/06/24/infiniDB%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/06/24/infiniDB%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">infiniDB安装配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-06-24 13:48:03" itemprop="dateCreated datePublished" datetime="2015-06-24T13:48:03+08:00">2015-06-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-08-23 07:11:06" itemprop="dateModified" datetime="2016-08-23T07:11:06+08:00">2016-08-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>infiniDB是为大数据而生的列式数据库，适合做统计分析，如SUM,AVG,MAX,MIN等。笔者没有研究过infoBright，貌似需要收费，并且社区版本不支持DML。</p>
<p>总结了一些infiniDB的特点:<br>1、所有字段的默认值都为NULL，不需要设置其他值。<br>2、不需要创建索引，不需要优化表<br>3、多线程设计，查询时完美利用多CPU<br>4、高并发:理论上无并发的限制,只受制于服务器的容量<br>5、DML(可以视为是SQL的子集)支持 : 语句insert, update, delete<br>6、数据存储方面主要是按列拆，按行(范围)拆，核心算法是hash join，跟oracle很类似。<br>    具体有以下几方面：<br>    1）、Block : 8k的数据块,有Logical Block ID,大小不能定制,但预读的数目可以定制<br>    2）、Extent : 一个逻辑空间尺寸,存在于一个或多个的称为segment文件的物理文件中. extent大小受1)默认的行数2)一个列的数据类型, 如默认行数是8M,对一字节数据类型来说,Extent大小就是8M; 对于8字节数据类型来说,就是64M;对于可变长数据类型来说也是64M.当一个Extent满了,一个新的Extent就会被创建出来.<br>    3）、Segment File : 当一个Segment文件达到它的Extent包含的最大数目,一个新的Segment文件就会被创建出来<br>    4）、Partition : 与row-based DB不同之处在于它是一个逻辑上的对象.由一个或多个Segment文件组成. 一个列的partition数目是不限的.</p>
<p><img src="https://static.verycloud.cn/sites/default/files/pic/image/20150624/20150624140759_49711.png" alt="数据存储示例图"></p>
<blockquote>
<p>安装过程：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1、访问https://github.com/infinidb/infinidb/blob/4.6.2-1/INSTALL，按照帮助文档进行安装，笔者安装的版本是4.6.2</span><br><span class="line"></span><br><span class="line">或者：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">git <span class="built_in">clone</span> http://github.com/infinidb/mysql</span><br><span class="line">git <span class="built_in">clone</span> http://github.com/infinidb/infinidb</span><br><span class="line">-- or --</span><br><span class="line">tar -zxf &lt;srcfile&gt;</span><br><span class="line"><span class="built_in">cd</span> mysql</span><br><span class="line">./configure --prefix=/data/mysql/</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="built_in">cd</span> ../infinidb</span><br><span class="line">./configure --prefix=/data/</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">注意：root下的文件夹名称必须为infinidb和mysql，否则编译的时候会报错。</span><br><span class="line"></span><br><span class="line">2、安装完以后执行/usr/<span class="built_in">local</span>/Calpont/bin/postConfigure进行配置，按默认就行</span><br><span class="line">3、设置一些别名， . /usr/<span class="built_in">local</span>/Calpont/bin/calpontAlias</span><br><span class="line">4、直接访问idbmysql进入管理。</span><br></pre></td></tr></table></figure>
<p><img src="https://static.verycloud.cn/sites/default/files/pic/image/20150624/20150624141731_29245.jpg" alt="idbmysql"></p>
<blockquote>
<p>测试</p>
</blockquote>
<p>10亿条数据count:<br><img src="https://static.verycloud.cn/sites/default/files/pic/image/20150624/20150624141741_84796.jpg" alt="10亿条数据count速度"></p>
<p>性能杠杠滴！</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/06/24/infiniDB%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/05/07/%E5%86%99%E4%B8%AA%E8%84%9A%E6%9C%AC%E5%8E%8B%E7%BC%A9JS-CSS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/05/07/%E5%86%99%E4%B8%AA%E8%84%9A%E6%9C%AC%E5%8E%8B%E7%BC%A9JS-CSS/" class="post-title-link" itemprop="url">写个脚本压缩JS,CSS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-05-07 15:00:13" itemprop="dateCreated datePublished" datetime="2015-05-07T15:00:13+08:00">2015-05-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:40:00" itemprop="dateModified" datetime="2015-06-24T13:40:00+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/shell/" itemprop="url" rel="index"><span itemprop="name">shell</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1、下载最新版的yuicompressor.jar</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/yui/yuicompressor/releases</span></span><br></pre></td></tr></table></figure>

<p>2、遍历目录，压缩JS、CSS</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i in `find path -name <span class="string">&quot;*.css&quot;</span>`;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;compress <span class="subst">$i</span>&quot;</span></span><br><span class="line">    java -jar yuicompressor-<span class="number">2.4</span>.<span class="number">8</span>.jar --charset=utf8 -o <span class="variable">$i</span> <span class="variable">$i</span> --nomunge</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/05/07/%E5%86%99%E4%B8%AA%E8%84%9A%E6%9C%AC%E5%8E%8B%E7%BC%A9JS-CSS/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/04/19/php-extension%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/04/19/php-extension%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">PHP Extension开发基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-04-19 18:02:25" itemprop="dateCreated datePublished" datetime="2015-04-19T18:02:25+08:00">2015-04-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-07 08:45:55" itemprop="dateModified" datetime="2015-06-07T08:45:55+08:00">2015-06-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>见：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://blog.codinglabs.org/articles/php-extension-dev-guide.html">http://blog.codinglabs.org/articles/php-extension-dev-guide.html</a></p>
</blockquote>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/04/19/php-extension%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/03/26/yum-errno-14-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/03/26/yum-errno-14-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">yum Errno 14 解决方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2015-03-26 10:51:49 / Modified: 10:54:39" itemprop="dateCreated datePublished" datetime="2015-03-26T10:51:49+08:00">2015-03-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天在安装supervisor的时候，报如下错误</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@admin yum.repos.d]<span class="comment"># yum repolist</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Determining fastest mirrors  </span><br><span class="line">http:<span class="comment">//balabala/repodata/repomd.xml: [Errno 14] problem making ssl connection</span></span><br><span class="line">Trying other mirror.</span><br><span class="line">http:<span class="comment">//balabala/repodata/repomd.xml: [Errno 14] problem making ssl connection</span></span><br><span class="line">Trying other mirror.</span><br></pre></td></tr></table></figure>

<p>排查应该是ssl证书问题有关，网上查了资料发现需要安装 ca-certificates 才行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install ca-certificates -y</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/03/26/yum-errno-14-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/03/21/Drupal7%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/03/21/Drupal7%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">drupal7生产环境的一些配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-03-21 15:09:59" itemprop="dateCreated datePublished" datetime="2015-03-21T15:09:59+08:00">2015-03-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:41:19" itemprop="dateModified" datetime="2015-06-24T13:41:19+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>由于经常需要配置，这里主要是做一个梳理和整理，免得以后忘记</p>
<p>1、缓存设置，见文章</p>
<pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//176code.com/tags/apc/</span></span><br></pre></td></tr></table></figure>
</code></pre>
<p>2、如果站点启用了https，必须在settings.php里做如下设置，不然会导致session问题</p>
<pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$conf</span>[<span class="string">&#x27;https&#x27;</span>] = <span class="literal">TRUE</span>;</span><br></pre></td></tr></table></figure>
</code></pre>
<p>3、如果需要去除所有的报错，则在settings.php里做如下设置 </p>
<pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$conf</span>[<span class="string">&#x27;error_level&#x27;</span>] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
</code></pre>
<p>4、php.ini设置 date.timezone = Asia/Chongqing</p>
<p>5、解决跨域问题,在.htaccess里添加如下代码<br>    </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header set Access-Control-Allow-Origin <span class="string">&quot;*&quot;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/03/21/Drupal7%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/03/20/%E5%AE%89%E8%A3%85php7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/03/20/%E5%AE%89%E8%A3%85php7/" class="post-title-link" itemprop="url">安装php7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-03-20 20:23:11" itemprop="dateCreated datePublished" datetime="2015-03-20T20:23:11+08:00">2015-03-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-07-20 10:55:31" itemprop="dateModified" datetime="2015-07-20T10:55:31+08:00">2015-07-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index"><span itemprop="name">php</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>推荐用阿里云主机，访问国外飞速。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://git.php.net/repository/php-src.git</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gcc gcc-c++  make zlib zlib-devel pcre pcre-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel openssl openssl-devel openldap openldap-devel nss_ldap openldap-clients openldap-servers curl-devel libXpm-devel libc-client-devel re2c bison bison-devel libmcrypt libmcrypt-devel libcurl libcurl-devel </span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./buildconf</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/php7 --with-config-file-path=/usr/<span class="built_in">local</span>/php7/etc --with-mcrypt=/usr/include --with-mysql-sock=/var/lib/mysql/mysql.sock --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --with-gd --with-iconv --with-zlib --enable-xml --enable-mysqlnd --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-fpm --enable-mbstring --enable-ftp --enable-gd-native-ttf --with-openssl --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --without-pear --with-gettext --enable-session --with-curl --with-jpeg-dir --with-freetype-dir --enable-opcache --enable-debug</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<blockquote>
<p>软连接 ln -s /usr/local/php7/bin/php /usr/bin/php</p>
</blockquote>
<blockquote>
<p>在安装目录下有两个php的配置项，php.ini-development和php.ini-production,一个是开发环境用的，一个线上环境用的，改名php.ini并移到/usr/local/php/etc目录。</p>
</blockquote>
<blockquote>
<p>php -v</p>
</blockquote>
<pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">PHP <span class="number">7.0</span>.<span class="number">0</span>-dev (cli) (built: Mar <span class="number">20</span> <span class="number">2015</span> <span class="number">20</span>:<span class="number">04</span>:<span class="number">04</span>) </span><br><span class="line">Copyright (c) <span class="number">1997</span>-<span class="number">2015</span> The PHP Group</span><br><span class="line">Zend Engine v3.<span class="number">0.0</span>-dev, Copyright (c) <span class="number">1998</span>-<span class="number">2015</span> Zend Technologies</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/03/20/%E5%AE%89%E8%A3%85php7/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/02/03/%E4%B8%80%E4%BA%9B%E6%BA%90%EF%BC%9Aepel,rpmforge,remi%E6%BA%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/02/03/%E4%B8%80%E4%BA%9B%E6%BA%90%EF%BC%9Aepel,rpmforge,remi%E6%BA%90/" class="post-title-link" itemprop="url">一些源：epel,RPMForge,Remi源</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-02-03 09:31:50" itemprop="dateCreated datePublished" datetime="2015-02-03T09:31:50+08:00">2015-02-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-07-15 14:13:26" itemprop="dateModified" datetime="2016-07-15T14:13:26+08:00">2016-07-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>为了保证官方源的顺序要高于第三方源的顺序:<br>yum install yum-priorities</p>
<p>加载epel源<br>CentOS and Red Hat Enterprise Linux 6.x</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm </span><br></pre></td></tr></table></figure>

<p>CentOS and Red Hat Enterprise Linux 7.x</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>加载RPMForge源<br>rpm -Uvh <a target="_blank" rel="noopener" href="http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm">http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm</a></p>
<p>加载Remi源<br>CentOS and Red Hat Enterprise Linux 6.x</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</span><br></pre></td></tr></table></figure>

<p>CentOS and Red Hat Enterprise Linux 7.x</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/02/03/%E4%B8%80%E4%BA%9B%E6%BA%90%EF%BC%9Aepel,rpmforge,remi%E6%BA%90/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2015/01/16/Drupal%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/01/16/Drupal%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/" class="post-title-link" itemprop="url">drupal动静分离</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-01-16 14:46:05" itemprop="dateCreated datePublished" datetime="2015-01-16T14:46:05+08:00">2015-01-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:35:29" itemprop="dateModified" datetime="2015-06-24T13:35:29+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_file_url_alter().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">modulename_file_url_alter</span>(<span class="params">&amp;<span class="variable">$uri</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$resource_server</span> = variable_get(<span class="string">&#x27;static_server&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">    <span class="variable">$resource_extensions</span> = <span class="keyword">array</span>(<span class="string">&#x27;css&#x27;</span>, <span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>);</span><br><span class="line">    <span class="comment">// Most CDNs don&#x27;t support private file transfers without a lot of hassle,</span></span><br><span class="line">    <span class="comment">// so don&#x27;t support this in the common case.</span></span><br><span class="line">    <span class="variable">$schemes</span> = <span class="keyword">array</span>(<span class="string">&#x27;public&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$scheme</span> = file_uri_scheme(<span class="variable">$uri</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Only serve shipped files and public created files from the static_server.</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$scheme</span> || in_array(<span class="variable">$scheme</span>, <span class="variable">$schemes</span>)) &#123;</span><br><span class="line">      <span class="comment">// Shipped files.</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable">$scheme</span>) &#123;</span><br><span class="line">        <span class="variable">$path</span> = <span class="variable">$uri</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// Public created files.</span></span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$wrapper</span> = file_stream_wrapper_get_instance_by_scheme(<span class="variable">$scheme</span>);</span><br><span class="line">        <span class="variable">$path</span> = <span class="variable">$wrapper</span>-&gt;getDirectoryPath() . <span class="string">&#x27;/&#x27;</span> . file_uri_target(<span class="variable">$uri</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Clean up Windows paths.</span></span><br><span class="line">      <span class="variable">$path</span> = str_replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Serve files with one of the resource extensions from resource_server </span></span><br><span class="line">      <span class="variable">$pathinfo</span> = pathinfo(<span class="variable">$path</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$pathinfo</span>[<span class="string">&#x27;extension&#x27;</span>]) &amp;&amp; in_array(<span class="variable">$pathinfo</span>[<span class="string">&#x27;extension&#x27;</span>], <span class="variable">$resource_extensions</span>)) &#123;</span><br><span class="line">        <span class="variable">$uri</span> = <span class="variable">$resource_server</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$path</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/01/16/Drupal%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/05/05/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E5%90%84%E7%A7%8Die%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/05/05/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E5%90%84%E7%A7%8Die%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">一行代码解决各种IE兼容问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2014-05-05 17:45:14" itemprop="dateCreated datePublished" datetime="2014-05-05T17:45:14+08:00">2014-05-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:39:32" itemprop="dateModified" datetime="2015-06-24T13:39:32+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/css/" itemprop="url" rel="index"><span itemprop="name">css</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>查看baidu.com的源代码，发现有一行</p>
<meta content="IE=Edge" http-equiv="X-UA-Compatible">

<p>Edge 模式通知IE以最高级别的可用模式显示内容。即如果你有IE9的话说明你有IE789，那么就调用高版本的那个也就是IE9。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/05/05/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E5%90%84%E7%A7%8Die%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/05/04/;function($,undefined)-%E5%89%8D%E9%9D%A2%E7%9A%84%E5%88%86%E5%8F%B7%E9%87%8A%E7%96%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/05/04/;function($,undefined)-%E5%89%8D%E9%9D%A2%E7%9A%84%E5%88%86%E5%8F%B7%E9%87%8A%E7%96%91/" class="post-title-link" itemprop="url">;function($,undefined) 前面的分号释疑</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2014-05-04 14:43:05 / Modified: 14:47:50" itemprop="dateCreated datePublished" datetime="2014-05-04T14:43:05+08:00">2014-05-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Javascript/" itemprop="url" rel="index"><span itemprop="name">Javascript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>;(function($){$.extend($.fn…</p>
<p>一般在一些 JQuery 函数前面有分号,在前面加分号可以有多种用途:</p>
<p>1、防止多文件集成成一个文件后，高压缩出现语法错误。</p>
<p>2、这是一个匿名函数，一般js库都采用这种自执行的匿名函数来保护内部变量 (function(){})()。</p>
<p>3、因为undefined是window的属性，声明为局部变量之后，在函数中如果再有变量与undefined作比较的话，程序就可以不用搜索undefined到window，可以提高程序性能。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/05/04/;function($,undefined)-%E5%89%8D%E9%9D%A2%E7%9A%84%E5%88%86%E5%8F%B7%E9%87%8A%E7%96%91/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/04/16/Drupal%E7%9A%84gitignore%E6%96%87%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/04/16/Drupal%E7%9A%84gitignore%E6%96%87%E4%BB%B6/" class="post-title-link" itemprop="url">drupal的.gitignore文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2014-04-16 15:41:19" itemprop="dateCreated datePublished" datetime="2014-04-16T15:41:19+08:00">2014-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:40:26" itemprop="dateModified" datetime="2015-06-24T13:40:26+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ignore configuration files that may contain sensitive information.</span></span><br><span class="line"><span class="comment">#sites/*/*settings*.php</span></span><br><span class="line">settings.php</span><br><span class="line"><span class="keyword">default</span>.settings.php</span><br><span class="line"></span><br><span class="line">*~</span><br><span class="line">*.*~</span><br><span class="line">*.lock</span><br><span class="line">*.DS_Store</span><br><span class="line">*.swp</span><br><span class="line">*.out</span><br><span class="line">*.swo</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ignore paths that contain generated content.</span></span><br><span class="line">cache/</span><br><span class="line">files/</span><br><span class="line">sites<span class="comment">/*/files</span></span><br><span class="line"><span class="comment">sites/*/</span><span class="keyword">private</span></span><br><span class="line">files/.htaccess</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ignore default text files</span></span><br><span class="line">.htaccess</span><br><span class="line">robots.txt</span><br><span class="line">/CHANGELOG.txt</span><br><span class="line">/COPYRIGHT.txt</span><br><span class="line">/INSTALL*.txt</span><br><span class="line">/LICENSE.txt</span><br><span class="line">/MAINTAINERS.txt</span><br><span class="line">/UPGRADE.txt</span><br><span class="line">/README.txt</span><br><span class="line">sites/all/README.txt</span><br><span class="line">sites/all/modules/README.txt</span><br><span class="line">sites/all/themes/README.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ignore everything but the &quot;sites&quot; folder ( for non core developer )</span></span><br><span class="line">web.config</span><br><span class="line">authorize.php</span><br><span class="line">cron.php</span><br><span class="line">index.php</span><br><span class="line">install.php</span><br><span class="line">update.php</span><br><span class="line">xmlrpc.php</span><br><span class="line">/includes</span><br><span class="line">/misc</span><br><span class="line">/modules</span><br><span class="line">/profiles</span><br><span class="line">/scripts</span><br><span class="line">/themes</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>把该文件放在/root/目录下。执行以下命令设置到全局选项里。<br>git config –global core.excludesfile /root/.gitignore</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/04/16/Drupal%E7%9A%84gitignore%E6%96%87%E4%BB%B6/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/04/04/hook_form%E4%B8%AD%E4%BD%BF%E7%94%A8drupalattachbehaviors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/04/04/hook_form%E4%B8%AD%E4%BD%BF%E7%94%A8drupalattachbehaviors/" class="post-title-link" itemprop="url">hook_form中使用Drupal.attachBehaviors</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2014-04-04 09:46:23" itemprop="dateCreated datePublished" datetime="2014-04-04T09:46:23+08:00">2014-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:42:54" itemprop="dateModified" datetime="2015-06-24T13:42:54+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如果form中有ajax事件，可能需要重新绑定事件，可以这样解决，代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements hook_form_alter().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xxx_form_alter</span>(<span class="params">&amp;<span class="variable">$commands</span>, &amp;<span class="variable">$form</span>, <span class="variable">$form_state</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//用于Drupal.attachBehaviors(document)</span></span><br><span class="line">  <span class="variable">$commands</span>[] =  ajax_command_invoke(<span class="literal">NULL</span>, <span class="string">&#x27;xxx_form_alter_attach_behaviors&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">Drupal.behaviors.xxx_form = &#123;</span><br><span class="line">  attach: <span class="function"><span class="keyword">function</span> (<span class="params">context, settings</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//js here</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$.fn.xxx_form_alter_attach_behaviors = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  Drupal.attachBehaviors(document);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;)(jQuery);</span><br></pre></td></tr></table></figure>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/04/04/hook_form%E4%B8%AD%E4%BD%BF%E7%94%A8drupalattachbehaviors/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/03/11/macvim%E5%A4%84%E7%90%86%E4%B8%AD%E6%96%87%E6%97%B6%E5%8D%A1%E9%A1%BF%E3%80%81cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/03/11/macvim%E5%A4%84%E7%90%86%E4%B8%AD%E6%96%87%E6%97%B6%E5%8D%A1%E9%A1%BF%E3%80%81cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">MacVim处理中文时卡顿、CPU占用过高问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2014-03-11 09:58:29" itemprop="dateCreated datePublished" datetime="2014-03-11T09:58:29+08:00">2014-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:33:23" itemprop="dateModified" datetime="2015-06-24T13:33:23+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="升级到vim-7-4以后情况有点好转。"><a href="#升级到vim-7-4以后情况有点好转。" class="headerlink" title="升级到vim 7.4以后情况有点好转。"></a>升级到vim 7.4以后情况有点好转。</h2><hr>
<p>我一般使用vim编程。但是输入中文和&amp;符号时时比较痛苦。经常出现卡顿。</p>
<p>偶然发现，在Preferences对话框中选择Advanced选项卡，去掉Use Core Text renderer选项的勾勾，输入大段中文也不会造成卡顿，至此问题解决。</p>
<p>但是这样会导致屏幕上下滚动的时候有点晃眼。难道是要我抛弃vim的节奏？</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/03/11/macvim%E5%A4%84%E7%90%86%E4%B8%AD%E6%96%87%E6%97%B6%E5%8D%A1%E9%A1%BF%E3%80%81cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/01/20/Drupal7%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E6%97%B6%E5%87%BA%E7%8E%B0%E9%9D%9E%E6%B3%95%E9%80%89%E9%A1%B9%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/01/20/Drupal7%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E6%97%B6%E5%87%BA%E7%8E%B0%E9%9D%9E%E6%B3%95%E9%80%89%E9%A1%B9%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">drupal7表单提交时出现非法选项解决方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2014-01-20 20:44:22" itemprop="dateCreated datePublished" datetime="2014-01-20T20:44:22+08:00">2014-01-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:42:11" itemprop="dateModified" datetime="2015-06-24T13:42:11+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有的使用ajax操作表单时，提交时会出现“在请选择xxx元素中的非法选项1。(An illegal choice has been detected ajax call!)”，解决办法很简单，如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">form[<span class="string">&#x27;my_dynamic_select&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">  … </span><br><span class="line">  <span class="string">&#x27;#type&#x27;</span> =&gt; <span class="string">&#x27;select&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;#validated&#x27;</span> =&gt; <span class="literal">TRUE</span>, <span class="comment">// 表单元素添加该行即可。</span></span><br><span class="line">  …</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>为什么要加’#validated’ =&gt; TRUE呢？<br>由于我们使用ajax取得的值，页面加载时并不存在，Drupal会认为这个值时非法的。所以我们要重置表单验证项永远为真，即可完美解决此问题。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/01/20/Drupal7%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E6%97%B6%E5%87%BA%E7%8E%B0%E9%9D%9E%E6%B3%95%E9%80%89%E9%A1%B9%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2014/01/11/phantomjs%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2014/01/11/phantomjs%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">phantomjs中文问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2014-01-11 11:15:08" itemprop="dateCreated datePublished" datetime="2014-01-11T11:15:08+08:00">2014-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-12-01 13:14:20" itemprop="dateModified" datetime="2015-12-01T13:14:20+08:00">2015-12-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index"><span itemprop="name">javascript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>用phantomjs去截取中文页面的网站可能会出现乱码的情况，也就是截图中中文的位置全是方框。<br>解决办法就是安装字体。<br>在centos中执行：yum install bitmap-fonts bitmap-fonts-cjk<br>在ubuntu/debian中执行：sudo apt-get install xfonts-wqy<br>这样再去截图中文的页面就不会出现一堆的方框了。</p>
<p>如果需要使用微软雅黑字体，可以这样操作：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/share/fonts/win/ </span><br><span class="line">  下载微软雅黑字体: </span><br><span class="line">  wget https://nipao.googlecode.com/files/msyh.ttf -O /usr/share/fonts/win/msyh.ttf </span><br><span class="line">  建立字体索引，更新字体缓存: </span><br><span class="line">  <span class="built_in">cd</span> /usr/share/fonts/win/ </span><br><span class="line">  mkfontscale </span><br><span class="line">  mkfontdir </span><br><span class="line">  fc-cache</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2014/01/11/phantomjs%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/31/drupal-error-cannot-call-overloaded-function-for-non-object/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/31/drupal-error-cannot-call-overloaded-function-for-non-object/" class="post-title-link" itemprop="url">Drupal error - Cannot call overloaded function for non-object</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-12-31 13:35:34" itemprop="dateCreated datePublished" datetime="2013-12-31T13:35:34+08:00">2013-12-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-05-07 14:34:00" itemprop="dateModified" datetime="2015-05-07T14:34:00+08:00">2015-05-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天在测试API的时候，apache总是会莫名其妙的报</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP Fatal <span class="built_in">error</span>: Cannot call overloaded <span class="function"><span class="keyword">function</span> <span class="title">for</span> <span class="title">non</span>-<span class="title">object</span> <span class="title">in</span> /<span class="title">var</span>/<span class="title">www</span>/<span class="title">html</span>/<span class="title">includes</span>/<span class="title">database</span>/<span class="title">query</span>.<span class="title">inc</span> <span class="title">on</span> <span class="title">line</span> 331</span></span><br></pre></td></tr></table></figure>
<p>找了很久的资料，发现可以配置apache的CoreDumpDirectory命令，其实就是把apache的内核目录放到其他目录下。如/tmp/apache_core，并给apache_core文件给予chown apache:apache /tmp/apache_core的权限。这样可以解决问题。</p>
<p>但是需要注意：<br>该命令会导致tmp文件越来越大。</p>
<p>使用以下命里进行调试<br>gdb /usr/bin/httpd /tmp/apache_core/core</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/31/drupal-error-cannot-call-overloaded-function-for-non-object/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/11/%E6%88%91%E7%9A%84vim%E9%85%8D%E8%89%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/11/%E6%88%91%E7%9A%84vim%E9%85%8D%E8%89%B2/" class="post-title-link" itemprop="url">我的vim配色</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-12-11 20:04:03" itemprop="dateCreated datePublished" datetime="2013-12-11T20:04:03+08:00">2013-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:34:46" itemprop="dateModified" datetime="2015-06-24T13:34:46+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">&quot; Vim color file - blank</span></span><br><span class="line"><span class="string">&quot;</span> Generated by http:<span class="comment">//bytefluent.com/vivify 2013-09-24</span></span><br><span class="line">set background=dark</span><br><span class="line"><span class="keyword">if</span> version &gt; <span class="number">580</span></span><br><span class="line">	hi clear</span><br><span class="line">	<span class="keyword">if</span> exists(<span class="string">&quot;syntax_on&quot;</span>)</span><br><span class="line">		syntax reset</span><br><span class="line">	<span class="keyword">endif</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line">set t_Co=<span class="number">256</span></span><br><span class="line">let g:colors_name = <span class="string">&quot;blank&quot;</span></span><br><span class="line"></span><br><span class="line">hi IncSearch guifg=<span class="comment">#C4BE89 guibg=#000000 guisp=#000000 gui=NONE ctermfg=186 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi WildMenu guifg=<span class="comment">#66D9EF guibg=#000000 guisp=#000000 gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi SignColumn guifg=<span class="comment">#A6E22E guibg=#232526 guisp=#232526 gui=NONE ctermfg=112 ctermbg=235 cterm=NONE</span></span><br><span class="line">hi SpecialComment guifg=<span class="comment">#465457 guibg=NONE guisp=NONE gui=bold ctermfg=240 ctermbg=NONE cterm=bold</span></span><br><span class="line">hi Typedef guifg=<span class="comment">#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Title guifg=<span class="comment">#ef5939 guibg=NONE guisp=NONE gui=NONE ctermfg=209 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Folded guifg=<span class="comment">#00CD00 guibg=NONE  guisp=NONE gui=NONE ctermfg=240 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi PreCondit guifg=<span class="comment">#A6E22E guibg=NONE guisp=NONE gui=bold ctermfg=112 ctermbg=NONE cterm=bold</span></span><br><span class="line">hi <span class="keyword">Include</span> guifg=<span class="comment">#A6E22E guibg=NONE guisp=NONE gui=NONE ctermfg=112 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi <span class="keyword">Float</span> guifg=<span class="comment">#AE81FF guibg=NONE guisp=NONE gui=NONE ctermfg=141 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi StatusLineNC guifg=<span class="comment">#cccccc guibg=#1874CD guisp=#145b7d gui=NONE ctermfg=8 ctermbg=232 cterm=NONE</span></span><br><span class="line"><span class="string">&quot;hi CTagsMember -- no settings --</span></span><br><span class="line"><span class="string">hi NonText guifg=#BCBCBC guibg=#3B3A32 guisp=#3B3A32 gui=NONE ctermfg=250 ctermbg=237 cterm=NONE</span></span><br><span class="line"><span class="string">&quot;</span>hi CTagsGlobalConstant -- no settings --</span><br><span class="line">hi DiffText guifg=NONE guibg=<span class="comment">#4C4745 guisp=#4C4745 gui=bold,italic ctermfg=NONE ctermbg=239 cterm=bold</span></span><br><span class="line">hi ErrorMsg guifg=<span class="comment">#F92672 guibg=#232526 guisp=#232526 gui=bold ctermfg=197 ctermbg=235 cterm=bold</span></span><br><span class="line">hi Ignore guifg=<span class="comment">#808080 guibg=#272822 guisp=#272822 gui=NONE ctermfg=8 ctermbg=235 cterm=NONE</span></span><br><span class="line">hi Debug guifg=<span class="comment">#BCA3A3 guibg=NONE guisp=NONE gui=bold ctermfg=138 ctermbg=NONE cterm=bold</span></span><br><span class="line">hi PMenuSbar guifg=NONE guibg=<span class="comment">#080808 guisp=#080808 gui=NONE ctermfg=NONE ctermbg=232 cterm=NONE</span></span><br><span class="line">hi Identifier guifg=<span class="comment">#FD971F guibg=NONE guisp=NONE gui=NONE ctermfg=208 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi SpecialChar guifg=<span class="comment">#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold</span></span><br><span class="line">hi Conditional guifg=<span class="comment">#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold</span></span><br><span class="line">hi StorageClass guifg=<span class="comment">#FD971F guibg=NONE guisp=NONE gui=italic ctermfg=208 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Todo guifg=<span class="comment">#FFFF00 guibg=#272822 guisp=#272822 gui=bold ctermfg=15 ctermbg=235 cterm=bold</span></span><br><span class="line">hi Special guifg=<span class="comment">#66D9EF guibg=#272822 guisp=#272822 gui=italic ctermfg=81 ctermbg=235 cterm=NONE</span></span><br><span class="line">hi LineNr guifg=<span class="comment">#BCBCBC guibg=#3B3A32 guisp=#3B3A32 gui=NONE ctermfg=250 ctermbg=237 cterm=NONE</span></span><br><span class="line">hi StatusLine guifg=<span class="comment">#455354 guibg=#F8F8F2 guisp=#F8F8F2 gui=NONE ctermfg=240 ctermbg=230 cterm=NONE</span></span><br><span class="line">hi Normal guifg=<span class="comment">#F8F8F2 guibg=#272822 guisp=#272822 gui=NONE ctermfg=230 ctermbg=235 cterm=NONE</span></span><br><span class="line">hi Label guifg=<span class="comment">#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">&quot;hi CTagsImport -- no settings --</span></span><br><span class="line"><span class="string">hi PMenuSel guifg=NONE guibg=#808080 guisp=#808080 gui=NONE ctermfg=NONE ctermbg=8 cterm=NONE</span></span><br><span class="line"><span class="string">hi Search guifg=#ffffff guibg=#fcaf17 guisp=#fcaf17 gui=NONE ctermfg=15 ctermbg=240 cterm=NONE</span></span><br><span class="line"><span class="string">&quot;</span>hi CTagsGlobalVariable -- no settings --</span><br><span class="line">hi Delimiter guifg=<span class="comment">#8F8F8F guibg=NONE guisp=NONE gui=NONE ctermfg=245 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Statement guifg=<span class="comment">#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold</span></span><br><span class="line"><span class="string">&quot;hi SpellRare -- no settings --</span></span><br><span class="line"><span class="string">&quot;</span>hi EnumerationValue -- no settings --</span><br><span class="line">hi Comment guifg=<span class="comment">#b8a969 guibg=NONE guisp=NONE gui=NONE ctermfg=143 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Character guifg=<span class="comment">#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">&quot;hi TabLineSel -- no settings --</span></span><br><span class="line"><span class="string">hi Number guifg=#AE81FF guibg=NONE guisp=NONE gui=NONE ctermfg=141 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi Boolean guifg=#AE81FF guibg=NONE guisp=NONE gui=NONE ctermfg=141 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi Operator guifg=#F92672 guibg=NONE guisp=NONE gui=NONE ctermfg=197 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi CursorLine guifg=NONE guibg=#3E3D32 guisp=#3E3D32 gui=NONE ctermfg=NONE ctermbg=237 cterm=NONE</span></span><br><span class="line"><span class="string">&quot;</span>hi Union -- no settings --</span><br><span class="line"><span class="string">&quot;hi TabLineFill -- no settings --</span></span><br><span class="line"><span class="string">hi Question guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi WarningMsg guifg=#FFFFFF guibg=#333333 guisp=#333333 gui=bold ctermfg=15 ctermbg=236 cterm=bold</span></span><br><span class="line"><span class="string">hi VisualNOS guifg=NONE guibg=#403D3D guisp=#403D3D gui=NONE ctermfg=NONE ctermbg=238 cterm=NONE</span></span><br><span class="line"><span class="string">hi DiffDelete guifg=#960050 guibg=#1E0010 guisp=#1E0010 gui=NONE ctermfg=89 ctermbg=53 cterm=NONE</span></span><br><span class="line"><span class="string">hi ModeMsg guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi CursorColumn guifg=NONE guibg=#3E3D32 guisp=#3E3D32 gui=NONE ctermfg=NONE ctermbg=237 cterm=NONE</span></span><br><span class="line"><span class="string">hi Define guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi Function guifg=#A6E22E guibg=NONE guisp=NONE gui=NONE ctermfg=112 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi FoldColumn guifg=#465457 guibg=#000000 guisp=#000000 gui=NONE ctermfg=240 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi PreProc guifg=#A6E22E guibg=NONE guisp=NONE gui=NONE ctermfg=112 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">&quot;</span>hi EnumerationName -- no settings --</span><br><span class="line">hi Visual guifg=NONE guibg=<span class="comment">#403D3D guisp=#403D3D gui=NONE ctermfg=NONE ctermbg=238 cterm=NONE</span></span><br><span class="line">hi MoreMsg guifg=<span class="comment">#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">&quot;hi SpellCap -- no settings --</span></span><br><span class="line"><span class="string">hi VertSplit guifg=#CCCCCC guibg=#080808 guisp=#080808 gui=bold ctermfg=8 ctermbg=232 cterm=bold</span></span><br><span class="line"><span class="string">hi Exception guifg=#A6E22E guibg=NONE guisp=NONE gui=bold ctermfg=112 ctermbg=NONE cterm=bold</span></span><br><span class="line"><span class="string">hi Keyword guifg=#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold</span></span><br><span class="line"><span class="string">hi Type guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi DiffChange guifg=#89807D guibg=#4C4745 guisp=#4C4745 gui=NONE ctermfg=245 ctermbg=239 cterm=NONE</span></span><br><span class="line"><span class="string">hi Cursor guifg=#000000 guibg=#F8F8F0 guisp=#F8F8F0 gui=NONE ctermfg=NONE ctermbg=230 cterm=NONE</span></span><br><span class="line"><span class="string">&quot;</span>hi SpellLocal -- no settings --</span><br><span class="line">hi <span class="built_in">Error</span> guifg=<span class="comment">#960050 guibg=#1E0010 guisp=#1E0010 gui=NONE ctermfg=89 ctermbg=53 cterm=NONE</span></span><br><span class="line">hi PMenu guifg=<span class="comment">#66D9EF guibg=#000000 guisp=#000000 gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi SpecialKey guifg=<span class="comment">#66D9EF guibg=NONE guisp=NONE gui=italic ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Constant guifg=<span class="comment">#AE81FF guibg=NONE guisp=NONE gui=bold ctermfg=141 ctermbg=NONE cterm=bold</span></span><br><span class="line"><span class="string">&quot;hi DefinedName -- no settings --</span></span><br><span class="line"><span class="string">hi Tag guifg=#F92672 guibg=NONE guisp=NONE gui=italic ctermfg=197 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi String guifg=#E6DB74 guibg=NONE guisp=NONE gui=NONE ctermfg=185 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi PMenuThumb guifg=#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line"><span class="string">hi MatchParen guifg=#000000 guibg=#FD971F guisp=#FD971F gui=bold ctermfg=NONE ctermbg=208 cterm=bold</span></span><br><span class="line"><span class="string">&quot;</span>hi LocalVariable -- no settings --</span><br><span class="line">hi Repeat guifg=<span class="comment">#F92672 guibg=NONE guisp=NONE gui=bold ctermfg=197 ctermbg=NONE cterm=bold</span></span><br><span class="line"><span class="string">&quot;hi SpellBad -- no settings --</span></span><br><span class="line"><span class="string">&quot;</span>hi CTagsClass -- no settings --</span><br><span class="line">hi <span class="built_in">Directory</span> guifg=<span class="comment">#A6E22E guibg=NONE guisp=NONE gui=bold ctermfg=112 ctermbg=NONE cterm=bold</span></span><br><span class="line">hi Structure guifg=<span class="comment">#66D9EF guibg=NONE guisp=NONE gui=NONE ctermfg=81 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Macro guifg=<span class="comment">#C4BE89 guibg=NONE guisp=NONE gui=italic ctermfg=186 ctermbg=NONE cterm=NONE</span></span><br><span class="line">hi Underlined guifg=<span class="comment">#808080 guibg=NONE guisp=NONE gui=underline ctermfg=8 ctermbg=NONE cterm=underline</span></span><br><span class="line">hi DiffAdd guifg=NONE guibg=<span class="comment">#13354A guisp=#13354A gui=NONE ctermfg=NONE ctermbg=23 cterm=NONE</span></span><br><span class="line"><span class="string">&quot;hi TabLine -- no settings --</span></span><br><span class="line"><span class="string">&quot;</span>hi clear -- no settings --</span><br><span class="line"></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/11/%E6%88%91%E7%9A%84vim%E9%85%8D%E8%89%B2/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/11/drupal-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9Eip/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/11/drupal-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9Eip/" class="post-title-link" itemprop="url">Drupal 获取客户端真实IP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-12-11 18:01:12" itemprop="dateCreated datePublished" datetime="2013-12-11T18:01:12+08:00">2013-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:40:57" itemprop="dateModified" datetime="2015-06-24T13:40:57+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如果网站走CDN。必须在settings.php设置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$conf</span>[<span class="string">&#x27;reverse_proxy&#x27;</span>] = <span class="literal">TRUE</span>;</span><br></pre></td></tr></table></figure>
<p>这样才可以获取到客户端的真实IP。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/11/drupal-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9Eip/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/11/Drupal-apc%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E7%AD%96%E7%95%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/11/Drupal-apc%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E7%AD%96%E7%95%A5/" class="post-title-link" itemprop="url">Drupal apc缓存配置策略</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2013-12-11 17:38:28 / Modified: 17:43:01" itemprop="dateCreated datePublished" datetime="2013-12-11T17:38:28+08:00">2013-12-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天发现在如果开起来 apc缓存。并开启缓存页面（不从数据库拿）,匿名用户会返回500。。。。<br>配置代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$conf</span>[<span class="string">&#x27;page_cache_without_database&#x27;</span>] = <span class="literal">TRUE</span>;</span><br></pre></td></tr></table></figure>

<p>通过追踪代码，发现drupal针对匿名用户并没有设置缓存。那用apc缓存了当然会有问题，修改代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="variable">$conf</span>[<span class="string">&#x27;cache_backends&#x27;</span>] = <span class="keyword">array</span>(<span class="string">&#x27;sites/all/modules/apc/drupal_apc_cache.inc&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// Use APC by default (cache everything.)</span></span><br><span class="line">    <span class="variable">$conf</span>[<span class="string">&#x27;cache_default_class&#x27;</span>] = <span class="string">&#x27;DrupalAPCCache&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// Page cache without database and module hooks (approx twice as fast.)</span></span><br><span class="line">      <span class="variable">$conf</span>[<span class="string">&#x27;page_cache_invoke_hooks&#x27;</span>] = <span class="literal">FALSE</span>;</span><br><span class="line">      <span class="variable">$conf</span>[<span class="string">&#x27;page_cache_without_database&#x27;</span>] = <span class="literal">TRUE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Use APC for &quot;cache&quot; and &quot;bootstrap&quot; only.</span></span><br><span class="line">    <span class="variable">$conf</span>[<span class="string">&#x27;cache_class_cache&#x27;</span>] = <span class="string">&#x27;DrupalAPCCache&#x27;</span>;</span><br><span class="line">    <span class="variable">$conf</span>[<span class="string">&#x27;cache_class_cache_bootstrap&#x27;</span>] = <span class="string">&#x27;DrupalAPCCache&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>问题解决. </p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/11/Drupal-apc%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E7%AD%96%E7%95%A5/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/11/Drupal%E5%AF%BC%E5%85%A5%E7%BF%BB%E8%AF%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/11/Drupal%E5%AF%BC%E5%85%A5%E7%BF%BB%E8%AF%91/" class="post-title-link" itemprop="url">Drupal导入翻译</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-12-11 17:19:06" itemprop="dateCreated datePublished" datetime="2013-12-11T17:19:06+08:00">2013-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-03-21 15:10:25" itemprop="dateModified" datetime="2015-03-21T15:10:25+08:00">2015-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有的时候po文件太大，导入的时候会出现503错误。这是因为php请求超时了。还好，有drush,用drush 导入文件非常简单。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush dl drush_language</span><br></pre></td></tr></table></figure>

<p>Usage</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">drush language-add &lt;langcode&gt;</span><br><span class="line">&gt; Add <span class="keyword">and</span> import a <span class="keyword">new</span> language definition.</span><br><span class="line">drush language-enable &lt;langcode&gt;</span><br><span class="line">&gt; Enable an existing language.</span><br><span class="line">drush language-disable &lt;langcode&gt;</span><br><span class="line">&gt; Disable an enabled language.</span><br><span class="line">drush language-<span class="keyword">default</span> &lt;langcode&gt;</span><br><span class="line">&gt; Assign an enabled language <span class="keyword">as</span> <span class="keyword">default</span>.</span><br><span class="line">drush language-import &lt;langcode&gt; &lt;file.po&gt; [--replace] [--group=&lt;text-group&gt;]</span><br><span class="line">&gt; Import a .po file to a language.</span><br><span class="line">drush language-export &lt;langcode&gt; &lt;file.po&gt; [--group=&lt;text-group&gt;]</span><br><span class="line">&gt; Export a language to a .po file.</span><br></pre></td></tr></table></figure>

<p>比如导入一个翻译文件，命令如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush language-import zh-hans xxxx/drupal-<span class="number">7.22</span>.zh-hans.po </span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/11/Drupal%E5%AF%BC%E5%85%A5%E7%BF%BB%E8%AF%91/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/11/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/11/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/" class="post-title-link" itemprop="url">Drush的安装配置和应用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-12-11 16:50:14" itemprop="dateCreated datePublished" datetime="2013-12-11T16:50:14+08:00">2013-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2015-06-24 13:33:51" itemprop="dateModified" datetime="2015-06-24T13:33:51+08:00">2015-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Drupal/" itemprop="url" rel="index"><span itemprop="name">Drupal</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>###安装方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pear channel-update pear.php.net</span><br><span class="line">pear channel-discover pear.drush.org</span><br><span class="line">pear install drush/drush</span><br></pre></td></tr></table></figure>

<p>用drush help即可查看相关命令。</p>
<p>###经常使用的几个命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">drush cc all: 清除缓存</span><br><span class="line">drush updb: 更新数据库.</span><br><span class="line">drush up或者 drush pm-update更新核心代码或者模块.</span><br><span class="line"></span><br><span class="line">drush up的备份代码默认在 ~/drush-backups </span><br><span class="line">cd  ~/drush-backups 即可看到原来的代码</span><br></pre></td></tr></table></figure>

<p>###打印Drupal函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush ev <span class="string">&quot;print_r(module_implements(&#x27;menu&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>

<p>###执行php代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush php-<span class="keyword">eval</span> <span class="string">&#x27;print_r(file(&quot;/xxxx.log&quot;));&#x27;</span> </span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/11/Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://verynil.com/2013/12/11/php%E8%8E%B7%E5%8F%96raw-post-data%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="www.verynil.com">
      <meta itemprop="description" content="记录生活，分享知识，传播乐趣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lau's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/12/11/php%E8%8E%B7%E5%8F%96raw-post-data%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">PHP获取Raw POST Data数据</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2013-12-11 16:05:05 / Modified: 16:41:29" itemprop="dateCreated datePublished" datetime="2013-12-11T16:05:05+08:00">2013-12-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>通常在做网站开发的时候，接收POST数组通过$_POST即可获取，但是如果把一段 XML 文本直接作为POST DATA提交到服务器时，$_POST是一个空数组，如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//www.example.com -H &quot;Accept:application/json&quot; -d &#x27;&#123;&quot;ip&quot;:&quot;8.8.4.4&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>如何解决这个问题呢，PHP提供了解析Raw POST data的方法，见<a target="_blank" rel="noopener" href="http://www.php.net/manual/en/reserved.variables.httprawpostdata.php%EF%BC%8C%E7%94%A8%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A">http://www.php.net/manual/en/reserved.variables.httprawpostdata.php，用法如下：</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$postdata</span> = file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>解释一下，php://input 是一个资源标识，用 file_get_contents 从这个资源中获取的内容，就是原始的 Raw POST Data。</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2013/12/11/php%E8%8E%B7%E5%8F%96raw-post-data%E6%95%B0%E6%8D%AE/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">www.verynil.com</p>
  <div class="site-description" itemprop="description">记录生活，分享知识，传播乐趣</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">81</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">www.verynil.com</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
