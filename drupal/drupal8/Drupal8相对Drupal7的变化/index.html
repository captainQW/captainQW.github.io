
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="law">
      
      
        <link rel="canonical" href="https://www.verynil.com/drupal/drupal8/Drupal8%E7%9B%B8%E5%AF%B9Drupal7%E7%9A%84%E5%8F%98%E5%8C%96/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.3">
    
    
      
        <title>Drupal8相对Drupal7的变化 - 记录技术，分享知识，传播乐趣</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="记录技术，分享知识，传播乐趣" class="md-header__button md-logo" aria-label="记录技术，分享知识，传播乐趣" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            记录技术，分享知识，传播乐趣
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Drupal8相对Drupal7的变化
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/captainQW/captainQW.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    verynil.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../algorithm/%E7%AE%97%E6%B3%95%E7%9A%84%E6%97%B6%E9%97%B4%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" class="md-tabs__link">
        Algorithm
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../golang/fmt.Printf%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" class="md-tabs__link">
        Golang
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Drupal-apc%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E7%AD%96%E7%95%A5/" class="md-tabs__link md-tabs__link--active">
        Drupal
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../javascript/%3Bfunction%28%24%2Cundefined%29-%E5%89%8D%E9%9D%A2%E7%9A%84%E5%88%86%E5%8F%B7%E9%87%8A%E7%96%91/" class="md-tabs__link">
        Javascript
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/" class="md-tabs__link">
        Vue
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/" class="md-tabs__link">
        Other
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="记录技术，分享知识，传播乐趣" class="md-nav__button md-logo" aria-label="记录技术，分享知识，传播乐趣" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    记录技术，分享知识，传播乐趣
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/captainQW/captainQW.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    verynil.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1">
          Algorithm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Algorithm" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithm/%E7%AE%97%E6%B3%95%E7%9A%84%E6%97%B6%E9%97%B4%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" class="md-nav__link">
        算法的时间与空间复杂度
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Golang
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Golang" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Golang
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../golang/fmt.Printf%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" class="md-nav__link">
        Go 字符串格式化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../golang/%E6%96%B9%E6%B3%95%E4%B8%8E%E5%87%BD%E6%95%B0/" class="md-nav__link">
        Go 方法与函数
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Drupal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Drupal" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Drupal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Drupal-apc%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E7%AD%96%E7%95%A5/" class="md-nav__link">
        Drupal apc缓存配置策略
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Drupal%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/" class="md-nav__link">
        Drupal动静分离
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Drupal%E7%9A%84gitignore%E6%96%87%E4%BB%B6/" class="md-nav__link">
        Drupal的.gitignore文件
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Drush%E7%9A%84%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%92%8C%E5%BA%94%E7%94%A8/" class="md-nav__link">
        Drush的安装配置和应用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SQLite-database-disk-image-is-malformed-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="md-nav__link">
        Drupal SQLite: database disk image is malformed 解决方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal%20code%20review/" class="md-nav__link">
        Drupal code review
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal-error-cannot-call-overloaded-function-for-non-object/" class="md-nav__link">
        Drupal error - Cannot call overloaded function for non-object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal-%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9Eip/" class="md-nav__link">
        Drupal 获取客户端真实IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hook_form%E4%B8%AD%E4%BD%BF%E7%94%A8drupalattachbehaviors/" class="md-nav__link">
        hook_form中使用Drupal.attachBehaviors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../windows%E4%B8%8B%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEdrupalconsole/" class="md-nav__link">
        windows下安装配置drupalconsole
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11" type="checkbox" id="__nav_3_11" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_11">
          Drupal7
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Drupal7" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_11">
          <span class="md-nav__icon md-icon"></span>
          Drupal7
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal7/Converting-7-x-modules-to-8-x/" class="md-nav__link">
        Converting 7.x modules to 8.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal7/Drupal7-WEB%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="md-nav__link">
        Drupal7 WEB性能优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal7/Drupal7%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        Drupal7生产环境的一些配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drupal7/Drupal7%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E6%97%B6%E5%87%BA%E7%8E%B0%E9%9D%9E%E6%B3%95%E9%80%89%E9%A1%B9%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="md-nav__link">
        Drupal7表单提交时出现非法选项解决方案
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_12" type="checkbox" id="__nav_3_12" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_12">
          Drupal8
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Drupal8" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_12">
          <span class="md-nav__icon md-icon"></span>
          Drupal8
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-Configuration-Schema/" class="md-nav__link">
        Drupal8 configuration schema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-Content-Entity/" class="md-nav__link">
        Drupal8 Content Entity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-Controller/" class="md-nav__link">
        Drupal8 Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-Cron-Queue/" class="md-nav__link">
        Drupal8 Cron Queue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-Javascript/" class="md-nav__link">
        Drupal8 javascript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-Service-DependencyInjection/" class="md-nav__link">
        Drupal8-Service-DependencyInjection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-angularJS/" class="md-nav__link">
        Drupal8中使用AngularJS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-configuration-Entity/" class="md-nav__link">
        Drupal8 Configuration Entity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-css-guide/" class="md-nav__link">
        Drupal8-css-guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-drush/" class="md-nav__link">
        Drush for Drupal8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-form/" class="md-nav__link">
        Drupal8表单(form)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8-routing/" class="md-nav__link">
        Drupal8 Routing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E4%B8%BB%E9%A2%98-theme/" class="md-nav__link">
        Drupal8主题(theme)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        Drupal8功能测试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        Drupal8单元测试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-Namespace/" class="md-nav__link">
        Drupal8命名空间(Namespace)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E5%AE%9E%E4%BD%93-entity/" class="md-nav__link">
        Drupal8实体(entity)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E6%95%B0%E6%8D%AE%E5%BA%93-database/" class="md-nav__link">
        Drupal8数据库(database)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-twig/" class="md-nav__link">
        Drupal8模板引擎-twig
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        Drupal8注解(Annotations)语法
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Drupal8相对Drupal7的变化
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Drupal8相对Drupal7的变化
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1、概述
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2、目录结构
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2、配置文件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3、路由方式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4、主题
  </a>
  
    <nav class="md-nav" aria-label="4、主题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1、模板引擎的变化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    4.2、主题配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43jscss" class="md-nav__link">
    4.3、引入js、css
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5、表单
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6drupal-8" class="md-nav__link">
    6、钩子机制在Drupal 8中的变化及实现
  </a>
  
    <nav class="md-nav" aria-label="6、钩子机制在Drupal 8中的变化及实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1、调用钩子的替代与实现
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62info" class="md-nav__link">
    6.2、info类钩子的替换与实现
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7drupal-8" class="md-nav__link">
    7、Drupal 8中的新增机制
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/" class="md-nav__link">
        Drupal8面向对象(OOP)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Drupal%E5%AF%BC%E5%85%A5%E7%BF%BB%E8%AF%91/" class="md-nav__link">
        Drupal导入翻译
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../drupal8%E4%B8%AD%E4%BD%BF%E7%94%A8vue/" class="md-nav__link">
        Drupal8中使用vue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-drupal8/" class="md-nav__link">
        understanding Drupal8-Drupal8初窥
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Javascript
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Javascript" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Javascript
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../javascript/%3Bfunction%28%24%2Cundefined%29-%E5%89%8D%E9%9D%A2%E7%9A%84%E5%88%86%E5%8F%B7%E9%87%8A%E7%96%91/" class="md-nav__link">
        ;function($,undefined) 前面的分号释疑
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../javascript/%E4%BD%BF%E7%94%A8safari%E5%AF%B9webview%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95/" class="md-nav__link">
        使用safari对webview进行调试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../javascript/%E5%86%99%E4%B8%AA%E8%84%9A%E6%9C%AC%E5%8E%8B%E7%BC%A9JS-CSS/" class="md-nav__link">
        写个脚本压缩JS,CSS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Vue
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Vue" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Vue
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../vue/Vue%E8%B7%AF%E7%94%B1%E5%85%A5%E9%97%A8/" class="md-nav__link">
        Vue路由入门
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../vue/Vue%E8%B7%AF%E7%94%B1%E8%BF%9B%E9%98%B6/" class="md-nav__link">
        Vue路由进阶
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../vue/vue%E5%9C%A8drupal%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/" class="md-nav__link">
        vue在drupal中的模块化开发
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../vue/%E4%BB%8E%E7%AE%80%E5%8D%95%E7%9A%84%E5%88%97%E8%A1%A8%E9%A1%B5%E6%B5%85%E8%B0%88Vue%E7%BB%84%E4%BB%B6/" class="md-nav__link">
        从简单的列表页浅谈Vue组件
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/CentOS6-4%E5%AE%89%E8%A3%85oracle-10g%E6%95%99%E7%A8%8B/" class="md-nav__link">
        CentOS6.4安装oracle 10g教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/Haproxy-web%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" class="md-nav__link">
        Haproxy web负载均衡
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/MacOS-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E6%83%85%E5%86%B5/" class="md-nav__link">
        MacOS 查看网络端口情况
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/Mariadb-ColumnStore%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        Mariadb ColumnStore数据库测试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/MySQL-5-7-x-%E5%AE%89%E8%A3%85/" class="md-nav__link">
        mysql-5.7.x安装
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/MySQL%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" class="md-nav__link">
        MySQL互联网业务数据库设计规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" class="md-nav__link">
        MySQL数据库设计规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/PHP-Trait%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E7%9A%84%E5%AE%9E%E7%8E%B0/" class="md-nav__link">
        PHP Trait多重继承的实现
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/centos6-6%E5%AE%89%E8%A3%85Percona-Tokudb/" class="md-nav__link">
        centos6.6安装Percona Tokudb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/centos6-6%E5%AE%89%E8%A3%85mariadb10-Tokudb/" class="md-nav__link">
        centos6.6安装mariadb10 Tokudb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/git%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/" class="md-nav__link">
        git自动化部属
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/infiniDB%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        infiniDB安装配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/infinidb%E4%B8%8Eclickhouse%E5%AF%B9%E6%AF%94/" class="md-nav__link">
        infiniDB与clickhouse对比
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/kubernetes%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/" class="md-nav__link">
        kubernetes安装部署实战
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/macvim%E5%A4%84%E7%90%86%E4%B8%AD%E6%96%87%E6%97%B6%E5%8D%A1%E9%A1%BF%E3%80%81cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/" class="md-nav__link">
        MacVim处理中文时卡顿、CPU占用过高问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/mariaDB%E5%92%8CPercona%E7%9A%84%E5%BC%95%E6%93%8Etokudb%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        MariaDB和Percona的引擎tokudb性能对比测试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/phantomjs%E4%B8%AD%E6%96%87%E9%97%AE%E9%A2%98/" class="md-nav__link">
        phantomjs中文问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/php-extension%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        PHP Extension开发基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/php%E8%8E%B7%E5%8F%96raw-post-data%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        PHP获取Raw POST Data数据
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/rsync%E4%B8%BB%E5%A4%87%E4%BB%A3%E7%A0%81%E5%90%8C%E6%AD%A5/" class="md-nav__link">
        rsync主备代码同步
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/sublime-text%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E6%B3%A8%E9%87%8A%E4%BF%A1%E6%81%AF/" class="md-nav__link">
        sublime text创建快捷注释信息
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/sysbench%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/" class="md-nav__link">
        sysbench测试mysql性能
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/tpcc%E6%B5%8B%E8%AF%95mysql%E6%80%A7%E8%83%BD/" class="md-nav__link">
        tpcc测试mysql性能
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/web%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" class="md-nav__link">
        web开发规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/yum-errno-14-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="md-nav__link">
        yum Errno 14 解决方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E4%B8%80%E4%BA%9B%E6%BA%90%EF%BC%9Aepel%2Crpmforge%2Cremi%E6%BA%90/" class="md-nav__link">
        一些源：epel,RPMForge,Remi源
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3%E5%90%84%E7%A7%8Die%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/" class="md-nav__link">
        一行代码解决各种IE兼容问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E4%BD%BF%E7%94%A8gdb%E8%B0%83%E8%AF%95php-fpm/" class="md-nav__link">
        使用gdb调试php-fpm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E5%AE%89%E8%A3%85php7/" class="md-nav__link">
        安装php7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C/" class="md-nav__link">
        并发与并行
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E6%88%91%E7%9A%84vim%E9%85%8D%E8%89%B2/" class="md-nav__link">
        我的vim配色
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%E4%BA%86swap/" class="md-nav__link">
        查看哪些进程占用了swap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/%E9%AB%98%E6%80%A7%E8%83%BDmysql%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%8F%8AMHA%E9%AB%98%E5%8F%AF%E7%94%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" class="md-nav__link">
        高性能mysql主从架构及MHA高可用负载均衡
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../about/">About</a>
          
        </div>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1、概述
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2、目录结构
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2、配置文件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3、路由方式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4、主题
  </a>
  
    <nav class="md-nav" aria-label="4、主题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1、模板引擎的变化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    4.2、主题配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43jscss" class="md-nav__link">
    4.3、引入js、css
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5、表单
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6drupal-8" class="md-nav__link">
    6、钩子机制在Drupal 8中的变化及实现
  </a>
  
    <nav class="md-nav" aria-label="6、钩子机制在Drupal 8中的变化及实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1、调用钩子的替代与实现
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62info" class="md-nav__link">
    6.2、info类钩子的替换与实现
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7drupal-8" class="md-nav__link">
    7、Drupal 8中的新增机制
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/captainQW/captainQW.github.io/edit/master/docs/drupal/drupal8/Drupal8相对Drupal7的变化.md" title="编辑此页" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Drupal8相对Drupal7的变化</h1>

<h3 id="1">1、概述<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>Drupal 8已经正式发布，与Drupal 7相比，Drupal 8在实现机制上发生了根本性的改变。最本质的改变，应该就是从主要以面向过程的编码方式转为了主要以面向对象的编码方式。虽然Drupal 8仍然保留了部分面向过程的文件，比如.module文件，但是可以预见，在Drupal 9中，这些面向过程的代码将被全部移除，所以在使用Drupal 8做开发的时候，应该尽量避免引用面向过程的代码，以免从Drupal 8升级到Drupal 9的过程中增加不必要的麻烦。</p>
<p>本文将从模块开发的角度（而非其他角度，比如网站编辑、性能优劣等）讨论Drupal 8 与Drupal 7的不同之处，通过对Drupal 8的研究，我将Drupal 8模块开发与Drupal 7的不同点概括为以下几点：</p>
<ol>
<li>目录结构；</li>
<li>配置文件；</li>
<li>路由方式；</li>
<li>主题；</li>
<li>表单；</li>
<li>钩子机制在Drupal 8中的变化及实现；</li>
<li>Drupal 8中的新增机制。</li>
</ol>
<p>下面将详细论述这些不同点。</p>
<h3 id="2">2、目录结构<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>Drupal 7的目录结构为：</p>
<div class="highlight"><pre><span></span><code>|-includes
|-misc
|-modules
|-scripts
|-sites
|  |-all
|  |  |-modules
|  |  |-themes
|  |-default
|-themes
</code></pre></div>
<p>Drupal 8的目录结构为：</p>
<div class="highlight"><pre><span></span><code>|-core
|  |-assets
|  |-config
|  |-includes
|  |-lib
|  |-misc
|  |-modules
|  |-profiles
|  |-scripts
|  |-themes
|-modules
|-sites
|  |-default
|-themes
|-vendor
</code></pre></div>
<p>可以看出，Drupal 8与Drupal 7的目录结构大不相同，在Drupal7中核心的代码都直接放在根目录下，比如includes等，核心模块放在根目录下的modules目录下，核心主题放在根目录下的themes目录下。用户自定义或者第三方的模块放在sites\all\modules、主题放在sites\all\themes目录下。</p>
<p>而在Drupal 8里面，核心的东西都被移到根目录下的core目录下，原来用来放核心模块和主题的modules、themes目录分别用来放用户自定义的模块和主题。按照约定俗称的规则，一般在modules目录下新建contrib和custom目录，分别用来放贡献和自定义模块。</p>
<h3 id="2_1">2、配置文件<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h3>
<p>在Drupal模块开发中，很多功能的实现都要靠配置文件来实现，比如模块的基本信息在Drupal 7中就必须配置在*.info文件中。在Drupal 8中，配置文件的使用得到了进一步的扩充，可以说，Drupal 8的几乎所有功能都离不开配置文件。</p>
<p>但是同时配置文件的格式也与Drupal 7有所不同。Drupal 7中的配置文件主要是.info文件，.info文件采用使用等号隔开的键值对的形式配置信息，例如模块信息的配置文件demo.info：</p>
<div class="highlight"><pre><span></span><code>core            = &quot;7.x&quot;
description     = &quot;Demo Module&quot;
dependencies[] = system 
name            = &quot;demo&quot;
package         = &quot;demo&quot;
version = &quot;7.x-1.0&quot;
</code></pre></div>
<p>Drupal 8中配置文件广泛使用yaml格式的文件，例如模块信息的配置文件demo.info.yml:</p>
<div class="highlight"><pre><span></span><code>name: demo
type: module
description: &quot;demo module&quot;
package: demo
core: 8.x
dependencies:
  - rest
</code></pre></div>
<p>对比Drupal 7和Drupal 8的配置文件，不难看出，里面的内容基本一致，所不同的只是文件格式的不同。需要注意的是Drupal 8的配置文件后缀名都是.yml，表明这是一个yaml文件。Drupal 8的模块配置信息比Drupal 7的多一项type: module，这是因为Drupal 8的主题也是用同样格式的配置文件，为了区分这是一个主题还是模块，该项是必须的。</p>
<p>Drupal 8 不仅需要模块信息配置文件，还需要各种其他的配置文件，比如后面将要讲到的路由配置文件*.routing.yml、服务配置文件*.services.yml等。</p>
<h3 id="3">3、路由方式<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>Drupal 7和Drupal 8的路由也存在很大的区别。Drupal 7 使用Hook的方式，而Drupal 8使用Symfony框架的路由配置文件的方式。本文只讨论Drupal 8和Drupal 7 的不同之处，更深入的介绍请参考<a href="http://verynull.com/2015/12/23/Drupal8-routing/" title="Drupal8路由">http://verynull.com/2015/12/23/Drupal8-routing/</a>和<a href="http://verynull.com/2015/12/23/Drupal8-Controller/" title="Drupal8控制器">http://verynull.com/2015/12/23/Drupal8-Controller/</a></p>
<p>Drupal 7需要在module_name.module中实现hook_menu钩子来将某个url和请求处理方法关联起来，示例代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="x">function demo_menu() {</span>
<span class="x">  $items = array();</span>

<span class="x">  $items[&#39;demo&#39;] = array(</span>
<span class="x">    &#39;title&#39; =&gt; &#39;示例&#39;,</span>
<span class="x">    &#39;page callback&#39; =&gt; &#39;theme&#39;,</span>
<span class="x">    &#39;page arguments&#39; =&gt; array(&#39;demo&#39;),</span>
<span class="x">    &#39;access callback&#39; =&gt; &#39;user_is_logged_in&#39;,</span>
<span class="x">    &#39;type&#39; =&gt; MENU_CALLBACK</span>
<span class="x">  );</span>
<span class="x">  return $items;</span>
<span class="x">}</span>
</code></pre></div>
<p>上述代码表示，当用户访问/demo路径时。调用theme方法渲染demo主题，主题需要在hook_theme中注册，这一点Drupal 8没有变化。</p>
<p>实现同样的功能，Drupal 8 首先需要配置module_name.routing.yml，将路径和控制器中的某个action关联起来，然后编写控制器，实现里面的action。这里需要提到一个概念MVC，MVC全名是Model View Controller，是模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范，用一种业务逻辑、数据、界面显示分离的方法组织代码。Drupal 8里面的控制器就是MVC中controller，用于衔接界面（view）和数据（model），即在控制器里面，接收参数，然后读取数据，传递给界面，最后返回给终端用户。</p>
<p>example.rounting.yml格式如下：</p>
<div class="highlight"><pre><span></span><code>example.demo:
  path: &#39;/demo/{name}&#39;
  defaults:
    _controller: &#39;\Drupal\example\Controller\ExampleController::demo&#39;
    _title: &#39;test drupal 8 routing&#39;
  requirements:
    _permission: &#39;access content&#39;
</code></pre></div>
<p>example.demo为路由的机读名称，格式为"模块名.路由"，path是实际的url路径，其中{name}，表示参数，该参数会传递给action，参数名称就是name。</p>
<p>defaults下有的_controller: '\Drupal\example\Controller\ExampleController::demo'表示控制器为\Drupal\example\Controller\ExampleController，action为demo方法。</p>
<p>defaults下的_title: 'test drupal 8 routing'表示页面标题为：test drupal 8 routing。</p>
<p>requirements下的_permission表示可以访问该路径的权限。</p>
<p>ExampleController的代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Contains ExampleController</span>
<span class="sd"> */</span>

<span class="k">namespace</span> <span class="nx">Drupal\example\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Drupal\Core\Controller\ControllerBase</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * Provides route responses for example.module.</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">ExampleController</span> <span class="k">extends</span> <span class="nx">ControllerBase</span> <span class="p">{</span>
  <span class="sd">/**</span>
<span class="sd">   * 展示hello {name}.</span>
<span class="sd">   * @param $name</span>
<span class="sd">   *</span>
<span class="sd">   * @return array</span>
<span class="sd">   *</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">demo</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;#markup&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Hello &#39;</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>当完成上述代码后，清除缓存，在浏览器中访问http://yourdomain/demo/World，界面就会显示Hello World。example.info.yml、example.routing.yml和ExampleController就构成了Drupal 8中的一个最基本模块，一般来说，这三类文件是必须的。</p>
<h3 id="4">4、主题<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p>Drupal 8和Drupal 7相比，主题上也发生了本质的变化，首先是主题引擎的变化，其次是配置方式的变化，最后是js、css引入方式的变化。本文只讨论Drupal 8 与Drupal 7主题的不同之处，主题更深入的介绍请参考<a href="http://verynull.com/2015/11/19/Drupal8主题-theme/" title="Drupal8主题">http://verynull.com/2015/11/19/Drupal8主题-theme/</a>和<a href="http://verynull.com/2015/11/18/Drupal8模板引擎-twig/" title="Drupal8的模板引擎-twig">http://verynull.com/2015/11/18/Drupal8模板引擎-twig/</a>。</p>
<h4 id="41">4.1、模板引擎的变化<a class="headerlink" href="#41" title="Permanent link">&para;</a></h4>
<p>Drupal 7使用的模板引擎是PHPTemplate，该模板引擎的特点是模板里面可以写php代码。这种模板的缺点显而易见，可能会产生XSS和SQL注入等攻击，如下代码：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nv">$name</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>如果$name = '&lt;script&gt;js语句&lt;/script&gt;'，这样输出到页面中就会执行script标签中的js代码，这样就会被黑客利用来攻击网站。</p>
<p>而Drupal 8则使用twig模板引擎，twig模板相对于PHPTemplate引擎，主要有以下有点：</p>
<ol>
<li>快速：Twig把模板编译成为优化后的PHP代码。相对普通PHP代码来说，其额外开销非常轻微。</li>
<li>安全：Twig会使用一个沙箱模式来运行不信任的模板代码。这使得Twig可以在用户可以修改模板设计的应用中工作良好。</li>
<li>弹性：Twig试用了弹性的词法和语法分析器。开发者可以定义自己的标记和过滤，并创建自己的DSL。</li>
</ol>
<p>可以看出，twig里面不能写php代码，他有一套自己的语法，并且最终被编译为php，运行在安全沙箱中，一句话，就是安全。像上面的输出变量，在twig中如下：</p>
<div class="highlight"><pre><span></span><code>{{ name }}
</code></pre></div>
<p>这样会自动把不安全的字符过滤掉。下面来比较PHPTemplate和twig的典型的不同之处。</p>
<p>1.后缀名</p>
<p>PHPTemplate的后缀名是.tpl.php，twig的后缀名为.html.twig.</p>
<p>2.变量</p>
<p>输出一个变量</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="x">&lt;div class=&quot;content&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nv">$content</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/div&gt;</span>
</code></pre></div>
<p>Twig:
<div class="highlight"><pre><span></span><code>&lt;div class=&quot;content&quot;&gt;{{ content }}&lt;/div&gt;
</code></pre></div></p>
<p>输出一个哈希键值</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">&#39;#item&#39;</span><span class="p">][</span><span class="s1">&#39;alt&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{{ item[&#39;#item&#39;].alt }}
</code></pre></div>
<p>变量赋值</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="nv">$custom_var</span> <span class="o">=</span> <span class="nv">$content</span><span class="o">-&gt;</span><span class="na">comments</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{% set custom_var = content.comments %}
</code></pre></div>
<p>数组初始化</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
  <span class="nv">$args</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;!author&#39;</span> <span class="o">=&gt;</span> <span class="nv">$author</span><span class="p">,</span> <span class="s1">&#39;!date&#39;</span> <span class="o">=&gt;</span> <span class="nv">$created</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{% set args = {&#39;!author&#39;: author, &#39;!date&#39;: created} 
</code></pre></div>
<p>3.条件判断</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$content</span><span class="o">-&gt;</span><span class="na">comments</span><span class="p">)</span><span class="o">:</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{% if content.comments %} {% endif %}
</code></pre></div>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$content</span><span class="o">-&gt;</span><span class="na">comments</span><span class="p">))</span><span class="o">:</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:
<div class="highlight"><pre><span></span><code>{% if content.comments is not empty %} {% endif %}
</code></pre></div></p>
<p>PHPTemplate:</p>
<p><div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$content</span><span class="o">-&gt;</span><span class="na">comments</span><span class="p">))</span><span class="o">:</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
Twig:</p>
<div class="highlight"><pre><span></span><code>{% if content.comments is defined %} {% endif %}
</code></pre></div>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">:</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{% if count &gt; 0 %} {% endif %}
</code></pre></div>
<p>4.控制结构</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$users</span> <span class="k">as</span> <span class="nv">$user</span><span class="p">)</span> <span class="p">{}</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{% for user in users %} {% endfor %}
</code></pre></div>
<p>5.过滤</p>
<p>check_plain：</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nx">check_plain</span><span class="p">(</span><span class="nv">$title</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{{ title|striptags }}
</code></pre></div>
<p>Translate：</p>
<p>PHPTemplate:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Home&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>Twig:</p>
<div class="highlight"><pre><span></span><code>{{ &#39;Home&#39;|t }}
</code></pre></div>
<p>更深入的介绍请参考上述文章。</p>
<h4 id="42">4.2、主题配置<a class="headerlink" href="#42" title="Permanent link">&para;</a></h4>
<p>Drupal 7的主题配置文件bartik.info格式如下：</p>
<div class="highlight"><pre><span></span><code>name = Bartik
description = A flexible, recolorable theme with many regions.
package = Core
version = VERSION
core = 7.x

stylesheets[all][] = css/layout.css
stylesheets[all][] = css/style.css
stylesheets[all][] = css/colors.css
stylesheets[print][] = css/print.css

regions[header] = Header
regions[help] = Help
regions[page_top] = Page top
regions[page_bottom] = Page bottom
regions[highlighted] = Highlighted

regions[featured] = Featured
regions[content] = Content
regions[sidebar_first] = Sidebar first
regions[sidebar_second] = Sidebar second

regions[triptych_first] = Triptych first
regions[triptych_middle] = Triptych middle
regions[triptych_last] = Triptych last

regions[footer_firstcolumn] = Footer first column
regions[footer_secondcolumn] = Footer second column
regions[footer_thirdcolumn] = Footer third column
regions[footer_fourthcolumn] = Footer fourth column
regions[footer] = Footer

settings[shortcut_module_link] = 0
</code></pre></div>
<p>本文第二章节已经提到，Drupal 8 的配置文件都是用yaml文件，bartik.info.yml：</p>
<div class="highlight"><pre><span></span><code>name: Bartik
type: theme
base theme: classy
description: &#39;A flexible, recolorable theme with many regions and a responsive, mobile-first layout.&#39;
package: Core
# version: VERSION
# core: 8.x
libraries:
  - bartik/global-styling
ckeditor_stylesheets:
  - css/base/elements.css
  - css/components/captions.css
  - css/components/table.css
regions:
  header: Header
  primary_menu: &#39;Primary menu&#39;
  secondary_menu: &#39;Secondary menu&#39;
  page_top: &#39;Page top&#39;
  page_bottom: &#39;Page bottom&#39;
  highlighted: Highlighted
  featured_top: &#39;Featured top&#39;
  breadcrumb: Breadcrumb
  content: Content
  sidebar_first: &#39;Sidebar first&#39;
  sidebar_second: &#39;Sidebar second&#39;
  featured_bottom_first: &#39;Featured bottom first&#39;
  featured_bottom_second: &#39;Featured bottom second&#39;
  featured_bottom_third: &#39;Featured bottom third&#39;
  footer_first: &#39;Footer first&#39;
  footer_second: &#39;Footer second&#39;
  footer_third: &#39;Footer third&#39;
  footer_fourth: &#39;Footer fourth&#39;
  footer_fifth: &#39;Footer fifth&#39;
</code></pre></div>
<p>从以上可以看出，Drupal 7 和Drupal 8 的主题配置文件大致相同，只是格式不一致，主要的不同有两点：</p>
<p>1.Drupal 8的配置文件多了type: theme，这是用来表明这是一个主题，而不是模块。</p>
<p>2.js、css的全局引入，Drupal 7可以直接引入单个js、css文件，而Drupal 8需要先将css、js设置成library，然后在主题配置文件中引入library，如上例中的：
    libraries:
      - bartik/global-styling</p>
<p>表示引入bartik主题下的global-styling库。library库是在theme_name.libraries.yml文件中定义的，bartik.libraries.yml的部分代码如下:</p>
<div class="highlight"><pre><span></span><code>color.preview:
  version: VERSION
  css:
    theme:
      color/preview.css: {}
  js:
    color/preview.js: {}
  dependencies:
    - color/drupal.color

maintenance_page:
  version: VERSION
  css:
    theme:
      css/maintenance-page.css: {}
  dependencies:
    - system/maintenance
    - bartik/global-styling
</code></pre></div>
<p>其中color.preview、maintenance_page就表示一个library，每个library下可以有css、js、dependencies等键，分别表示引入css、引入js和引入依赖的库。</p>
<h4 id="43jscss">4.3、引入js、css<a class="headerlink" href="#43jscss" title="Permanent link">&para;</a></h4>
<p>在4.2节中已经提到，Drupal 8中引入js和css必须使用library，不能单独引入单个js或css文件。在主题配置文件中引入全局的库也已经在4.2节中阐述，那在单个页面中引入js和css有何不同呢？</p>
<p>我们在Drupal 7中通常通过drupal_add_js和drupal_add_css来引入js和css，例如：</p>
<div class="highlight"><pre><span></span><code><span class="x">drupal_add_js(drupal_get_path(&#39;module&#39;, &#39;demo&#39;) . &#39;/js/demo.js&#39;);</span>
<span class="x">drupal_add_css(drupal_get_path(&#39;module&#39;, &#39;demo&#39;) . &#39;/css/demo.css&#39;);</span>
</code></pre></div>
<p>在Drupal 8中，我们首先将js、css配置成库，如demo.libraries.yml:</p>
<div class="highlight"><pre><span></span><code>base:
  version: VERSION
  css:
    theme:
      css/demo.css: {}
  js:
    js/demo.js: {}
  dependencies:
    - core/jquery
</code></pre></div>
<p>上面配置了一个base库，Drupal 8中除了要配置库，还要在渲染数组中使用#attached才能将库加到页面中：</p>
<div class="highlight"><pre><span></span><code><span class="x">return array(</span>
<span class="x">  &#39;#theme&#39; =&gt; &#39;example_demo&#39;,</span>
<span class="x">  &#39;#attached&#39; =&gt; array(</span>
<span class="x">    &#39;library&#39; =&gt; array(</span>
<span class="x">      &#39;example/base&#39;</span>
<span class="x">    )</span>
<span class="x">  )</span>
<span class="x">);</span>
</code></pre></div>
<p>上述代码表示，渲染example_demo主题，并且加载example/base'库。</p>
<h3 id="5">5、表单<a class="headerlink" href="#5" title="Permanent link">&para;</a></h3>
<p>我们将以一个简单的示例来分析Drupal 7和Drupal 8表单的异同。
在Drupal 7中要实现表单的展示、提交，首先需要配置菜单，将路径和表单函数关联起来在hook_menu中定义如下菜单：</p>
<div class="highlight"><pre><span></span><code><span class="x">$items[&#39;demo/form&#39;] = array(</span>
<span class="x">  &#39;title&#39; =&gt; &#39;Create demo form&#39;,</span>
<span class="x">  &#39;page callback&#39; =&gt; &#39;drupal_get_form&#39;,</span>
<span class="x">  &#39;page arguments&#39; =&gt; array(&#39;demo_form&#39;),</span>
<span class="x">  &#39;access callback&#39; =&gt; &#39;access content&#39;,</span>
<span class="x">  &#39;type&#39; =&gt; MENU_LOCAL_TASK,</span>
<span class="x">);</span>
</code></pre></div>
<p>接下来，定义表单函数demo_form：</p>
<div class="highlight"><pre><span></span><code><span class="x">function demo_form($form, &amp;$form_state) {</span>
<span class="x">  $form[&#39;name&#39;] = array(</span>
<span class="x">    &#39;#type&#39; =&gt; &#39;textfield&#39;,</span>
<span class="x">    &#39;#title&#39; =&gt; &#39;姓名&#39;</span>
<span class="x">  );</span>
<span class="x">  $form[&#39;actions&#39;][&#39;#type&#39;] = &#39;actions&#39;;</span>
<span class="x">  $form[&#39;actions&#39;][&#39;submit&#39;] = array(</span>
<span class="x">    &#39;#type&#39; =&gt; &#39;submit&#39;,</span>
<span class="x">    &#39;#value&#39; =&gt; $this-&gt;t(&#39;Save&#39;),</span>
<span class="x">    &#39;#button_type&#39; =&gt; &#39;primary&#39;,</span>
<span class="x">  );</span>
<span class="x">  $form[&#39;#validate&#39;][] = &#39;demo_validate&#39;;</span>
<span class="x">  $form[&#39;#submit&#39;][] = &#39;demo_submit&#39;;</span>
<span class="x">  return $form;</span>
<span class="x">}</span>
</code></pre></div>
<p>上述代码表明表单有一个文本框，一个提交按钮，表单的验证函数书demo_validate，提交处理函数是demo_submit。</p>
<p>下面实现demo_validate、demo_submit：</p>
<div class="highlight"><pre><span></span><code><span class="x">function demo_validate($form, &amp;$form_state) {</span>
<span class="x">  $name = $form_state[&#39;value&#39;][&#39;name&#39;];</span>
<span class="x">  if($name != &#39;world&#39;) {</span>
<span class="x">    form_set_error(&#39;name&#39;, &#39;参数错误&#39;);</span>
<span class="x">  }</span>
<span class="x">}</span>

<span class="x">function demo_submit($form, &amp;$form_state) {</span>
<span class="x">  $name = $form_state[&#39;value&#39;][&#39;name&#39;];</span>
<span class="x">  drupal_set_message(&#39;Hello&#39; . $name);</span>
<span class="x">}</span>
</code></pre></div>
<p>到这里，我们就可以访问demo/form了，在文本框中输入world，则界面就会显示Hello world，但是输入其他的文本，则会报错“参数错误”。</p>
<p>接下来，我们来看一下Drupal 8中的表单是如何实现的，首先我们要配置一个路由指向表单，</p>
<div class="highlight"><pre><span></span><code>example.demo_form:
  path: &#39;/demo/form&#39;
  defaults:
    _form: &#39;\Drupal\example\Form\ExampleForm&#39;
    _title: &#39;test drupal 8 form&#39;
  requirements:
    _permission: &#39;access content&#39;
</code></pre></div>
<p>path：'/demo/form'表示表单路径是/demo/form，_form: '\Drupal\example\Form\ExampleForm'表示表单类是\Drupal\example\Form\ExampleForm，那么下面就来实现这个类：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
    <span class="sd">/**</span>
<span class="sd">     * @file</span>
<span class="sd">     * contains Drupal\example\Form\ExampleForm</span>
<span class="sd">     */</span>

    <span class="k">namespace</span> <span class="nx">Drupal\example\Form</span><span class="p">;</span>


    <span class="k">use</span> <span class="nx">Drupal\Core\Form\FormBase</span><span class="p">;</span>
    <span class="k">use</span> <span class="nx">Drupal\Core\Form\FormStateInterface</span><span class="p">;</span>

    <span class="k">class</span> <span class="nc">ExampleForm</span> <span class="k">extends</span> <span class="nx">FormBase</span>
    <span class="p">{</span>
      <span class="sd">/**</span>
<span class="sd">       * @inheritdoc</span>
<span class="sd">       */</span>
      <span class="k">public</span> <span class="k">function</span> <span class="nf">getFormId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;example_form&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="sd">/**</span>
<span class="sd">       * @inheritdoc</span>
<span class="sd">       */</span>
      <span class="k">public</span> <span class="k">function</span> <span class="nf">buildForm</span><span class="p">(</span><span class="k">array</span> <span class="nv">$form</span><span class="p">,</span> <span class="nx">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;textfield&#39;</span><span class="p">,</span>
          <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;姓名&#39;</span>
        <span class="p">);</span>
        <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">][</span><span class="s1">&#39;#type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;actions&#39;</span><span class="p">;</span>
        <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">][</span><span class="s1">&#39;submit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;submit&#39;</span><span class="p">,</span>
          <span class="s1">&#39;#value&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">t</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">),</span>
          <span class="s1">&#39;#button_type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span>
        <span class="p">);</span>
        <span class="k">return</span> <span class="nv">$form</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="sd">/**</span>
<span class="sd">       * @inheritdoc</span>
<span class="sd">       */</span>
      <span class="k">public</span> <span class="k">function</span> <span class="nf">validateForm</span><span class="p">(</span><span class="k">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="nx">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">validateForm</span><span class="p">(</span><span class="nv">$form</span><span class="p">,</span> <span class="nv">$form_state</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$form_state</span><span class="o">-&gt;</span><span class="na">getValue</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;world&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
          <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="na">setErrorByName</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;参数错误&#39;</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="sd">/**</span>
<span class="sd">       * @inheritdoc</span>
<span class="sd">       */</span>
      <span class="k">public</span> <span class="k">function</span> <span class="nf">submitForm</span><span class="p">(</span><span class="k">array</span> <span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="nx">FormStateInterface</span> <span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$form_state</span><span class="o">-&gt;</span><span class="na">getValue</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
        <span class="nx">drupal_set_message</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
<p>可见，Drupal 8中的表单就是一个类，继承自formBase，需要覆写父类的四个方法：getFormId、buildForm、validateForm和submitForm。</p>
<p>1.getFormId</p>
<p>返回表单ID，对应于Drupal 7中的表单的方法名；</p>
<p>2.buildForm</p>
<p>构造并返回表单，对应于Drupal 7中的表单函数。</p>
<p>3.validateForm</p>
<p>表单验证方法，对应于Drupal 7中的$form['#validate'][] = 'demo_validate'中指定的方法</p>
<p>4.submitForm
表单提交处理方法，对应于Drupal 7 中$form['#submit'][] = 'demo_submit'中指定的方法。</p>
<p>通过对比可以发现，Drupal 8将表单的各个元素组织在一个类里面，结构清晰，逻辑分明，相对于Drupal 7松散的代码是很大的进步。</p>
<h3 id="6drupal-8">6、钩子机制在Drupal 8中的变化及实现<a class="headerlink" href="#6drupal-8" title="Permanent link">&para;</a></h3>
<p>钩子机制在Drupal 7中起着举足轻重的作用，主要体现在两个方面：</p>
<p>一是info类的钩子，例如hook_menu、hook_theme、hook_services_resources等，起到关联信息的作用，比如hook_menu告诉系统URL路径和处理方法的对应关系以便用户访问某个路径的时候找到正确的函数来处理；</p>
<p>二是调用类钩子，例如hook_user_delete等，调用类钩子的作用是系统在做了某个操作之后通过module_invoke_all来调用其他模块中实现的钩子函数。比如，删除某个用户之后，可能需要删除该用户关联的其他资源，则模块需要通过实现hook_user_delete钩子。</p>
<p>Drupal 8中这两类钩子都有了相应的替代方法，info类型的钩子大部分被插件（Plugin）代替，调用类型的钩子则被事件（Event）代替。下面分别针对两种钩子选择具有代表性的功能做分析。</p>
<h4 id="61">6.1、调用钩子的替代与实现<a class="headerlink" href="#61" title="Permanent link">&para;</a></h4>
<p>调用钩子在Drupal 7 中最有代表性的应用是用户的删除，实现需要分两步：</p>
<p>1.实现hook_user_delete方法，以demo模块为例：</p>
<div class="highlight"><pre><span></span><code><span class="x">function demo_user_delete($account) {</span>
<span class="x">  db_delete(&#39;user_demo&#39;, &#39;ud&#39;)</span>
<span class="x">  -&gt;condition(&#39;ud.uid&#39;, $account-&gt;uid)</span>
<span class="x">  -&gt;execute();</span>
<span class="x">} </span>
</code></pre></div>
<p>2.在用户删除的方法里面通过module_invoke_all来调用钩子：</p>
<div class="highlight"><pre><span></span><code><span class="x">module_invoke_all(&#39;user_delete&#39;, $account);</span>
</code></pre></div>
<p>只需要两步就实现了用户删除之后，删除关联资源的功能。</p>
<p>Drupal 8里面的事件的三个要素：事件、事件监听和事件触发。</p>
<p>要实现事件机制，首先我们必须先定义一个事件（Event），比如站点配置保存事件，其次有了这个事件后，需要有订阅者来监听这个事件，最后在某个时间点触发这个事件，将事件传递给所有监听这个事件的订阅者。</p>
<p>我们以站点配置保存事件为例，介绍事件订阅的实现：</p>
<p>1.定义事件</p>
<p>Drupal 8的核心模块Config模块中定义了ConfigEvent，代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Contains \Drupal\Core\Config\ConfigEvents.</span>
<span class="sd"> */</span>

<span class="k">namespace</span> <span class="nx">Drupal\Core\Config</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * Defines events for the configuration system.</span>
<span class="sd"> *</span>
<span class="sd"> * @see \Drupal\Core\Config\ConfigCrudEvent</span>
<span class="sd"> */</span>
<span class="k">final</span> <span class="k">class</span> <span class="nc">ConfigEvents</span> <span class="p">{</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of the event fired when saving a configuration object.</span>
<span class="sd">   *</span>
<span class="sd">   * This event allows modules to perform an action whenever a configuration</span>
<span class="sd">   * object is saved. The event listener method receives a</span>
<span class="sd">   * \Drupal\Core\Config\ConfigCrudEvent instance.</span>
<span class="sd">   *</span>
<span class="sd">   * See hook_update_N() documentation for safe configuration API usage and</span>
<span class="sd">   * restrictions as this event will be fired when configuration is saved by</span>
<span class="sd">   * hook_update_N().</span>
<span class="sd">   *</span>
<span class="sd">   * @Event</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigCrudEvent</span>
<span class="sd">   * @see \Drupal\Core\Config\Config::save()</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigFactory::onConfigSave()</span>
<span class="sd">   * @see hook_update_N()</span>
<span class="sd">   *</span>
<span class="sd">   * @var string</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">SAVE</span> <span class="o">=</span> <span class="s1">&#39;config.save&#39;</span><span class="p">;</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of the event fired when deleting a configuration object.</span>
<span class="sd">   *</span>
<span class="sd">   * This event allows modules to perform an action whenever a configuration</span>
<span class="sd">   * object is deleted. The event listener method receives a</span>
<span class="sd">   * \Drupal\Core\Config\ConfigCrudEvent instance.</span>
<span class="sd">   *</span>
<span class="sd">   * See hook_update_N() documentation for safe configuration API usage and</span>
<span class="sd">   * restrictions as this event will be fired when configuration is deleted by</span>
<span class="sd">   * hook_update_N().</span>
<span class="sd">   *</span>
<span class="sd">   * @Event</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigCrudEvent</span>
<span class="sd">   * @see \Drupal\Core\Config\Config::delete()</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigFactory::onConfigDelete()</span>
<span class="sd">   * @see hook_update_N()</span>
<span class="sd">   *</span>
<span class="sd">   * @var string</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">DELETE</span> <span class="o">=</span> <span class="s1">&#39;config.delete&#39;</span><span class="p">;</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of the event fired when renaming a configuration object.</span>
<span class="sd">   *</span>
<span class="sd">   * This event allows modules to perform an action whenever a configuration</span>
<span class="sd">   * object&#39;s name is changed. The event listener method receives a</span>
<span class="sd">   * \Drupal\Core\Config\ConfigRenameEvent instance.</span>
<span class="sd">   *</span>
<span class="sd">   * See hook_update_N() documentation for safe configuration API usage and</span>
<span class="sd">   * restrictions as this event will be fired when configuration is renamed by</span>
<span class="sd">   * hook_update_N().</span>
<span class="sd">   *</span>
<span class="sd">   * @Event</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigRenameEvent</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigFactoryInterface::rename()</span>
<span class="sd">   * @see hook_update_N()</span>
<span class="sd">   *</span>
<span class="sd">   * @var string</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">RENAME</span> <span class="o">=</span> <span class="s1">&#39;config.rename&#39;</span><span class="p">;</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of the event fired when validating imported configuration.</span>
<span class="sd">   *</span>
<span class="sd">   * This event allows modules to perform additional validation operations when</span>
<span class="sd">   * configuration is being imported. The event listener method receives a</span>
<span class="sd">   * \Drupal\Core\Config\ConfigImporterEvent instance.</span>
<span class="sd">   *</span>
<span class="sd">   * @Event</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigImporterEvent</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigImporter::validate().</span>
<span class="sd">   * @see \Drupal\Core\EventSubscriber\ConfigImportSubscriber::onConfigImporterValidate().</span>
<span class="sd">   *</span>
<span class="sd">   * @var string</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">IMPORT_VALIDATE</span> <span class="o">=</span> <span class="s1">&#39;config.importer.validate&#39;</span><span class="p">;</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of the event fired when importing configuration to target storage.</span>
<span class="sd">   *</span>
<span class="sd">   * This event allows modules to perform additional actions when configuration</span>
<span class="sd">   * is imported. The event listener method receives a</span>
<span class="sd">   * \Drupal\Core\Config\ConfigImporterEvent instance.</span>
<span class="sd">   *</span>
<span class="sd">   * @Event</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigImporterEvent</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigImporter::import().</span>
<span class="sd">   * @see \Drupal\Core\EventSubscriber\ConfigSnapshotSubscriber::onConfigImporterImport().</span>
<span class="sd">   *</span>
<span class="sd">   * @var string</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">IMPORT</span> <span class="o">=</span> <span class="s1">&#39;config.importer.import&#39;</span><span class="p">;</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of event fired when missing content dependencies are detected.</span>
<span class="sd">   *</span>
<span class="sd">   * Events subscribers are fired as part of the configuration import batch.</span>
<span class="sd">   * Each subscribe should call</span>
<span class="sd">   * \Drupal\Core\Config\MissingContentEvent::resolveMissingContent() when they</span>
<span class="sd">   * address a missing dependency. To address large amounts of dependencies</span>
<span class="sd">   * subscribers can call</span>
<span class="sd">   * \Drupal\Core\Config\MissingContentEvent::stopPropagation() which will stop</span>
<span class="sd">   * calling other events and guarantee that the configuration import batch will</span>
<span class="sd">   * fire the event again to continue processing missing content dependencies.</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigImporter::processMissingContent()</span>
<span class="sd">   * @see \Drupal\Core\Config\MissingContentEvent</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">IMPORT_MISSING_CONTENT</span> <span class="o">=</span> <span class="s1">&#39;config.importer.missing_content&#39;</span><span class="p">;</span>

  <span class="sd">/**</span>
<span class="sd">   * Name of event fired to collect information on all config collections.</span>
<span class="sd">   *</span>
<span class="sd">   * This event allows modules to add to the list of configuration collections</span>
<span class="sd">   * retrieved by \Drupal\Core\Config\ConfigManager::getConfigCollectionInfo().</span>
<span class="sd">   * The event listener method receives a</span>
<span class="sd">   * \Drupal\Core\Config\ConfigCollectionInfo instance.</span>
<span class="sd">   *</span>
<span class="sd">   * @Event</span>
<span class="sd">   *</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigCollectionInfo</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigManager::getConfigCollectionInfo()</span>
<span class="sd">   * @see \Drupal\Core\Config\ConfigFactoryOverrideBase</span>
<span class="sd">   *</span>
<span class="sd">   * @var string</span>
<span class="sd">   */</span>
  <span class="k">const</span> <span class="no">COLLECTION_INFO</span> <span class="o">=</span> <span class="s1">&#39;config.collection_info&#39;</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></div>
<p>该事件类中定义了一系列的事件，例如const SAVE = 'config.save'的意思即定义了配置保存事件，当配置保存完成后触发该事件。</p>
<p>有了事件之后，我们就需要有事件订阅者来监听这个事件，一旦配置保存，则执行相应的代码。我们仍然以demo模块为例，假设配置保存后，我们的demo模块需要记录一条日志，那demo模块需要实现相应的事件订阅类：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Contains \Drupal\demo\EventSubscriber\ConfigSubscriber.</span>
<span class="sd"> */</span>

<span class="k">namespace</span> <span class="nx">Drupal\demo\EventSubscriber</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Drupal\Core\Config\ConfigFactoryInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Drupal\Core\Config\ConfigCrudEvent</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Drupal\Core\Config\ConfigEvents</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\EventDispatcher\EventSubscriberInterface</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * 记录日志，如果配置保存了</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">ConfigSubscriber</span> <span class="k">implements</span> <span class="nx">EventSubscriberInterface</span> <span class="p">{</span>

  <span class="sd">/**</span>
<span class="sd">   * 日志记录</span>
<span class="sd">   *</span>
<span class="sd">   *</span>
<span class="sd">   * @param ConfigCrudEvent $event</span>
<span class="sd">   *   The configuration event.</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">onConfigSave</span><span class="p">(</span><span class="nx">ConfigCrudEvent</span> <span class="nv">$event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$saved_config</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getConfig</span><span class="p">();</span>
    <span class="nv">$logger</span> <span class="o">=</span> <span class="nx">\Drupal</span><span class="o">::</span><span class="na">logger</span><span class="p">(</span><span class="s1">&#39;config save&#39;</span><span class="p">);</span>
    <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">notice</span><span class="p">(</span><span class="nv">$saved_config</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">.</span> <span class="s1">&#39;保存了&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">   * {@inheritdoc}</span>
<span class="sd">   */</span>
  <span class="k">static</span> <span class="k">function</span> <span class="nf">getSubscribedEvents</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$events</span><span class="p">[</span><span class="nx">ConfigEvents</span><span class="o">::</span><span class="na">SAVE</span><span class="p">][]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;onConfigSave&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$events</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>这个事件订阅类实现了EventSubscriberInterface，这个接口只有一个方法getSubscribedEvents，这个方法返回事件对用的处理方法，比如$events[ConfigEvents::SAVE][] = array('onConfigSave', 0)表示ConfigEvents::SAVE事件的处理方法为onConfigSave，后面的第二个参数0表示优先级，越大越先执行。</p>
<p>实现了这个订阅类之后，为了让事件调度器（event dispacher）知道这个订阅者，我们需要把这个订阅类配置成服务，在demo.services.yml中我们增加如下代码：</p>
<div class="highlight"><pre><span></span><code>demo.config_subscriber:
  class: Drupal\demo\EventSubscriber\ConfigSubscriber
  arguments: []
  tags:
    - { name: event_subscriber }
</code></pre></div>
<p>到此事件订阅的工作就完成了，要触发事件，必须要在配置保存的时候使用事件调度器将事件传递给订阅者，代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="x">public function save($has_trusted_data = FALSE) {</span>
<span class="x">    // Validate the configuration object name before saving.</span>
<span class="x">    static::validateName($this-&gt;name);</span>

<span class="x">    // If there is a schema for this configuration object, cast all values to</span>
<span class="x">    // conform to the schema.</span>
<span class="x">    if (!$has_trusted_data) {</span>
<span class="x">      if ($this-&gt;typedConfigManager-&gt;hasConfigSchema($this-&gt;name)) {</span>
<span class="x">        // Ensure that the schema wrapper has the latest data.</span>
<span class="x">        $this-&gt;schemaWrapper = NULL;</span>
<span class="x">        foreach ($this-&gt;data as $key =&gt; $value) {</span>
<span class="x">          $this-&gt;data[$key] = $this-&gt;castValue($key, $value);</span>
<span class="x">        }</span>
<span class="x">      }</span>
<span class="x">      else {</span>
<span class="x">        foreach ($this-&gt;data as $key =&gt; $value) {</span>
<span class="x">          $this-&gt;validateValue($key, $value);</span>
<span class="x">        }</span>
<span class="x">      }</span>
<span class="x">    }</span>

<span class="x">    $this-&gt;storage-&gt;write($this-&gt;name, $this-&gt;data);</span>
<span class="x">    if (!$this-&gt;isNew) {</span>
<span class="x">      Cache::invalidateTags($this-&gt;getCacheTags());</span>
<span class="x">    }</span>
<span class="x">    $this-&gt;isNew = FALSE;</span>
<span class="x">    $this-&gt;eventDispatcher-&gt;dispatch(ConfigEvents::SAVE, new ConfigCrudEvent($this));</span>
<span class="x">    $this-&gt;originalData = $this-&gt;data;</span>
<span class="x">    // Potentially configuration schema could have changed the underlying data&#39;s</span>
<span class="x">    // types.</span>
<span class="x">    $this-&gt;resetOverriddenData();</span>
<span class="x">    return $this;</span>
<span class="x">}</span>
</code></pre></div>
<p>上述代码为Config模块中配置保存的方法，其中的<span class="arithmatex"><span class="MathJax_Preview">this-&gt;eventDispatcher-&gt;dispatch(ConfigEvents::SAVE, new ConfigCrudEvent(</span><script type="math/tex">this->eventDispatcher->dispatch(ConfigEvents::SAVE, new ConfigCrudEvent(</script></span>this))这句代码就是讲事件传递给所有监听了ConfigEvents::SAVE事件的订阅者，当然也包括我们demo模块里面的订阅者。</p>
<p>关于自定义事件的实现请参考<a href="http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/" title="自定义事件">http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/</a></p>
<h4 id="62info">6.2、info类钩子的替换与实现<a class="headerlink" href="#62info" title="Permanent link">&para;</a></h4>
<p>info类钩子的一个重要应用是web services。在Drupal 7中，内核不带rest，需要第三方模块。而在drupal8中，核心自带rest，除了rest界面管理模块（rest UI）外，不需要第三方模块。</p>
<p>Drupal 7中实现一个web services需要以下几步：</p>
<p>1.下载Services、REST Server、Chaos tools、OAuth Authentication第三方模块放入相应目录，进入后台-&gt;模块，勾选这几个模块保存启用。</p>
<p>2.实现hook_services_resources,代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="x">/**</span>
<span class="x"> * Implements hook_services_resources().</span>
<span class="x"> */</span>
<span class="x">function demo_services_resources() {  </span>
<span class="x">  return array(</span>
<span class="x">    &#39;demo&#39; =&gt; array(</span>
<span class="x">      &#39;actions&#39; =&gt; array(</span>
<span class="x">        &#39;add&#39; =&gt; array(</span>
<span class="x">          &#39;help&#39; =&gt; &#39;创建示例&#39;,</span>
<span class="x">          &#39;file&#39; =&gt; array(&#39;file&#39; =&gt; &#39;inc&#39;, &#39;module&#39; =&gt; &#39;demo&#39;, &#39;name&#39; =&gt; &#39;demo.apis&#39;),</span>
<span class="x">          &#39;callback&#39; =&gt; &#39;demo_add_resources&#39;,</span>
<span class="x">          &#39;access arguments&#39; =&gt; array(&#39;access_to_demo_api&#39;),</span>
<span class="x">          &#39;args&#39; =&gt; array(</span>
<span class="x">            array(</span>
<span class="x">              &#39;name&#39; =&gt; &#39;data&#39;,</span>
<span class="x">              &#39;source&#39; =&gt; &#39;data&#39;,</span>
<span class="x">              &#39;type&#39; =&gt; &#39;array&#39;,</span>
<span class="x">              &#39;optional&#39; =&gt; FALSE,</span>
<span class="x">            ),</span>
<span class="x">          ),</span>
<span class="x">        ),</span>
<span class="x">      ),           </span>
<span class="x">    ),</span>
<span class="x">  );</span>
<span class="x">}</span>
</code></pre></div>
<p>其中数组的第一层表示接口地址的第一个参数，actions下的每一个键表示一个接口，同时也是接口地址的第二个参数，例如上面的例子表示demo/add接口，callback表示接口的处理函数。file表示接口方法所在的文件。</p>
<p>接下来，我们就要实现demo_add_resources方法：</p>
<div class="highlight"><pre><span></span><code><span class="x">function demo_add_resources($data) {</span>
<span class="x">  $return = array(</span>
<span class="x">    &#39;code&#39; =&gt; 0,</span>
<span class="x">    &#39;message&#39; =&gt; &#39;操作失败&#39;</span>
<span class="x">  );</span>
<span class="x">  return $return;</span>
<span class="x">}</span>
</code></pre></div>
<p>最后我们要进入系统管理界面-》结构-》services添加一个端点，我们将机读名称设置为api，服务器选择rest，端点路径设为API，保存，则端点新建成功。点击编辑，将我们刚才新建的接口勾选，保存。这时，接口就发布成功，访问路径为API/demo/add。</p>
<p>Drupal 8中，web services用插件的形式实现，具体步骤：</p>
<p>1.下载rest UI第三方模块，放入相应目录，进入后台-》扩展，勾选rest UI、RESTful Web Services、Serialization、HAL、HTTP Basic Authentication，保存。</p>
<p>2.新建一个自定义的反序列化类。因为Drupal 8 在处理web service的请求时，首先将接收的数据反序列化为某个类，然后处理数据，最后将返回值序列化为json或者xml等数据返回给客户端。所以必须要有反序列化和序列化的类。但是Drupal 8核心中的反序列化类只支持将数据反序列化为entity，这样，对于写接口会非常不便，比如，某个API传递的参数可能并不能和某个entity对应，这样这个接口就没法实现，所以必须要自定义一个反序列化的类，比如可以将数据反序列化为数组。代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Contains \Drupal\demo\Normalizer\CustomNormalizer.</span>
<span class="sd"> */</span>

<span class="k">namespace</span> <span class="nx">Drupal\demo\Normalizer</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CustomNormalizer</span> <span class="k">extends</span> <span class="nx">AbstractNormalizer</span> <span class="p">{</span>

  <span class="sd">/**</span>
<span class="sd">   * {@inheritdoc}</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">supportsNormalization</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$format</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">   * {@inheritdoc}</span>
<span class="sd">   *</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">normalize</span><span class="p">(</span><span class="nv">$object</span><span class="p">,</span> <span class="nv">$format</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$context</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="sd">/**</span>
<span class="sd">   * {@inheritdoc}</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">supportsDenormalization</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$type</span><span class="p">,</span> <span class="nv">$format</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$type</span> <span class="o">==</span> <span class="s1">&#39;Array&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">   * {@inheritdoc}</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">denormalize</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$class</span><span class="p">,</span> <span class="nv">$format</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$context</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="nv">$array</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$data</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>实现上述类之后，我们需要将该类定义为service，在demo.services.yml中添加如下代码：</p>
<div class="highlight"><pre><span></span><code>demo.normalizer.custom:
  class: Drupal\demo\Normalizer\CustomNormalizer
  tags:
    - { name: normalizer }
</code></pre></div>
<p>接下来，再实现插件，插件其实是一个类，该类继承自该种插件的基类，并且需要用注解表明该类的插件性质。</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Contains \Drupal\demo\Plugin\rest\resource\ExampleResource</span>
<span class="sd"> */</span>

<span class="k">namespace</span> <span class="nx">Drupal\demo\Plugin\rest\resource</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Drupal\rest\Plugin\ResourceBase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Drupal\rest\ResourceResponse</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * Represents demo as resources.</span>
<span class="sd"> *</span>
<span class="sd"> * @RestResource(</span>
<span class="sd"> *   id = &quot;demo&quot;,</span>
<span class="sd"> *   label = @Translation(&quot;Demo Resource&quot;),</span>
<span class="sd"> *   serialization_class = &quot;Array&quot;,</span>
<span class="sd"> *   uri_paths = {</span>
<span class="sd"> *     &quot;canonical&quot; = &quot;/API/demo&quot;,</span>
<span class="sd"> *     </span>
<span class="sd"> *   }</span>
<span class="sd"> * )</span>
<span class="sd"> *</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">ExampleResource</span> <span class="k">extends</span> <span class="nx">ResourceBase</span> <span class="p">{</span>

  <span class="sd">/**</span>
<span class="sd">   * Responds to GET requests.</span>
<span class="sd">   *</span>
<span class="sd">   * @param array $data</span>
<span class="sd">   * @param Symfony\Component\HttpFoundation\Request $request</span>
<span class="sd">   *</span>
<span class="sd">   * @return \Drupal\rest\ResourceResponse</span>
<span class="sd">   *   The response containing the entity with its accessible fields.</span>
<span class="sd">   *</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">get</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$logger</span> <span class="o">=</span> <span class="nx">\Drupal</span><span class="o">::</span><span class="na">logger</span><span class="p">(</span><span class="s1">&#39;rest_get&#39;</span><span class="p">);</span>
    <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">notice</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;sid&#39;</span><span class="p">));</span>
    <span class="nv">$return</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;message&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;这是get方法&#39;</span><span class="p">,</span>
    <span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ResourceResponse</span><span class="p">(</span><span class="nv">$return</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">   * Responds to POST requests.</span>
<span class="sd">   *</span>
<span class="sd">   * @param array $data</span>
<span class="sd">   * @param Symfony\Component\HttpFoundation\Request $request</span>
<span class="sd">   *</span>
<span class="sd">   * @return \Drupal\rest\ResourceResponse</span>
<span class="sd">   *   The response containing the entity with its accessible fields.</span>
<span class="sd">   *</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">post</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$logger</span> <span class="o">=</span> <span class="nx">\Drupal</span><span class="o">::</span><span class="na">logger</span><span class="p">(</span><span class="s1">&#39;rest_post&#39;</span><span class="p">);</span>
    <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">notice</span><span class="p">(</span><span class="s1">&#39;&lt;pre&gt;&#39;</span> <span class="o">.</span> <span class="nb">print_r</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">)</span><span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">);</span>
    <span class="nv">$return</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;message&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;这是post方法&#39;</span><span class="p">,</span>
      <span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="nv">$data</span>
    <span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ResourceResponse</span><span class="p">(</span><span class="nv">$return</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">   * Responds to DELETE requests.</span>
<span class="sd">   *</span>
<span class="sd">   * @param array $data</span>
<span class="sd">   * @param Symfony\Component\HttpFoundation\Request $request</span>
<span class="sd">   *</span>
<span class="sd">   * @return \Drupal\rest\ResourceResponse</span>
<span class="sd">   *   The response containing the entity with its accessible fields.</span>
<span class="sd">   *</span>
<span class="sd">   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">delete</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$logger</span> <span class="o">=</span> <span class="nx">\Drupal</span><span class="o">::</span><span class="na">logger</span><span class="p">(</span><span class="s1">&#39;rest_delete&#39;</span><span class="p">);</span>
    <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">notice</span><span class="p">(</span><span class="s1">&#39;&lt;pre&gt;&#39;</span> <span class="o">.</span> <span class="nb">print_r</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">)</span><span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">);</span>
    <span class="nv">$return</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;message&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;这是delete方法&#39;</span><span class="p">,</span>
      <span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="nv">$data</span>
    <span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ResourceResponse</span><span class="p">(</span><span class="nv">$return</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>下面我们来分析一下上述代码，</p>
<p>1.@RestResource注解表示该类是RestResource类型的插件，也就是该类实现rest web services；</p>
<p>2.注解中的ID是该插件的ID，label是插件的名称；</p>
<p>3.serialization_class就是序列化和反序列化的类，我们这里设置为“Array”，则代码会自动调用我们的自定义的反序列化类来反序列化数据；</p>
<p>4."canonical" = "/API/demo"表示api的路径是/API/demo；"<a href="https://www.drupal.org/link-relations/create">https://www.drupal.org/link-relations/create</a>" = "/API/demo"，表示POST方法提交时的路径，当用POST方法提交时，会覆盖canonical指定路径。</p>
<p>这个web services插件内部实现了三个方法，get、post、delete，分别对应以get方法、post方法和delete方法提交的处理方法。换句话说，如果我以get方法访问API/demo，则调用get，以post方法访问API/demo，则调用post，以delete方法访问API/demo则调用delete。</p>
<p>到目前为止，我们的代码就全部写完，要使用该API，需要进入后台-》配置-》rest，启用这个api，您可以选择性的启用get、post和delete方法，同时选择请求和返回的数据格式，比如hal_json、json、xml，点击保存后，您就可以访问该api了。</p>
<h3 id="7drupal-8">7、Drupal 8中的新增机制<a class="headerlink" href="#7drupal-8" title="Permanent link">&para;</a></h3>
<p>Drupal 8采用了面向对象的方法，自然也会引入很多面向对象的新特性，比如依赖注入、服务容器，本文只是提出这些新特性，更深入的介绍请参考相应的文章。</p>
<ol>
<li>依赖注入和服务容器，请参考<a href="http://verynull.com/2015/12/15/Drupal8-Service-DependencyInjection/" title="依赖注入和服务容器">http://verynull.com/2015/12/15/Drupal8-Service-DependencyInjection/</a></li>
<li>注解，请参考<a href="http://verynull.com/2015/12/12/Drupal8注解-Annotations-语法/" title="注解">http://verynull.com/2015/12/12/Drupal8注解-Annotations-语法/</a></li>
<li>content entity，请参考<a href="http://verynull.com/2015/12/22/Drupal8-Content-Entity/" title="content entity">http://verynull.com/2015/12/22/Drupal8-Content-Entity/</a></li>
<li>configuration entity，请参考<a href="http://verynull.com/2015/12/21/Drupal8-configuration-Entity/" title="Configuration Entity">http://verynull.com/2015/12/21/Drupal8-configuration-Entity/</a></li>
</ol>
<p>参考文献</p>
<ol>
<li><a href="http://drupalchina.cn/node/3122">http://drupalchina.cn/node/3122</a></li>
<li><a href="https://www.drupal.org/node/2216195">https://www.drupal.org/node/2216195</a></li>
<li><a href="https://drupalize.me/blog/201409/unravelling-drupal-8-plugin-system">https://drupalize.me/blog/201409/unravelling-drupal-8-plugin-system</a></li>
<li><a href="http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/">http://www.sitepoint.com/drupal-8-hooks-symfony-event-dispatcher/</a></li>
<li><a href="http://drupalchina.cn/node/3353">http://drupalchina.cn/node/3353</a></li>
<li><a href="https://dev.acquia.com/blog/introduction-restful-web-services-drupal-8">https://dev.acquia.com/blog/introduction-restful-web-services-drupal-8</a></li>
</ol>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            回到页面顶部
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="页脚" >
      
        
        <a href="../Drupal8%E6%B3%A8%E8%A7%A3-Annotations-%E8%AF%AD%E6%B3%95/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Drupal8注解(Annotations)语法" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              Drupal8注解(Annotations)语法
            </div>
          </div>
        </a>
      
      
        
        <a href="../Drupal8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-OOP/" class="md-footer__link md-footer__link--next" aria-label="下一页: Drupal8面向对象(OOP)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              Drupal8面向对象(OOP)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>